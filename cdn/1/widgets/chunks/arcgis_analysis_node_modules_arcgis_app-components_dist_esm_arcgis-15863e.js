/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-15863e.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-15863e"],{65349:(e,i,s)=>{s.r(i),s.d(i,{arcgis_smart_mapping_relationship_color_slider:()=>u,arcgis_smart_mapping_relationship_focus_button:()=>c,arcgis_smart_mapping_relationship_legend:()=>h});var t=s(7263),o=(s(77040),s(70506),s(82646)),l=s(95875),a=s(13521),n=s(43025),r=s(93143);s(99004),s(58233),s(28926),s(78613),s(62159),s(11935),s(1991);const u=class{constructor(e){(0,t.r)(this,e),this.arcgisSmartMappingRelationshipColorSliderChange=(0,t.c)(this,"arcgisSmartMappingRelationshipColorSliderChange",7),this.arcgisSmartMappingRelationshipColorSliderError=(0,t.c)(this,"arcgisSmartMappingRelationshipColorSliderError",7),this.currentBreakValues=[],this.fieldPos=void 0,this.histogramStatus=o.h.MISSING,this.statisticsStatus=o.h.MISSING}async updateStatistics(){var e;this.statisticsStatus=o.h.MISSING,this.statistics=null,this.histogramStatus=o.h.MISSING,this.histogram=null,null===(e=this.colorSlider)||void 0===e||e.destroy(),this.colorSlider=void 0,this.getStatistics()}componentWillLoad(){this.flowItemNode=(0,o.f)(this.hostElement,"calcite-flow-item"),this.getStatistics()}componentDidLoad(){const{config:e}=o.s;this.hostElement.shadowRoot.firstElementChild.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${e.jsapiUrl}/themes/light/main.css" />`)}render(){var e;const{statisticsStatus:i}=this,{strings:s}=o.s,l=(0,o.b)().authoringInfo;if(i!==o.h.FAILED&&i!==o.h.MISSING){if(this.statisticsStatus===o.h.IN_PROGRESS||this.histogramStatus===o.h.IN_PROGRESS&&!this.colorSlider)return this.renderColorSliderLoading();{const e=this.prepareColorSlider(),i=0===this.fieldPos?l.field1.classBreakInfos:l.field2.classBreakInfos;return this.currentBreakValues=i.map((e=>({min:e.minValue,max:e.maxValue}))),(e||this.colorSlider)&&this.colorSlider.min!==this.colorSlider.max?(0,t.h)("div",{class:"slider-box"},(0,t.h)("calcite-label",null,s.panels.relationship.dataRange),(0,t.h)("div",{ref:e=>{e&&this.afterColorSliderCreate(e)}})):this.colorSlider&&this.colorSlider.min===this.colorSlider.max?null:this.renderColorSliderLoading()}}null===(e=this.colorSlider)||void 0===e||e.destroy(),this.colorSlider=void 0}renderColorSliderLoading(){const{strings:e}=o.s;return(0,t.h)("div",{class:"slider-box"},(0,t.h)("calcite-loader",{label:e.loading}))}afterColorSliderCreate(e){if(this.colorSlider.container)e.append(this.colorSlider.container);else{const i=document.createElement("div");i.classList.add("slider-container"),e.append(i),this.colorSlider.container=i}}createColorSliderChangeEvents(){this.colorSlider&&(this.colorSlider.on("min-change",(e=>{e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.colorSlider.slider.max):this.onMinMaxChange(e.value,this.colorSlider.slider.max)})),this.colorSlider.on("max-change",(e=>{e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.colorSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min):this.onMinMaxChange(this.colorSlider.slider.min,e.value)})),this.colorSlider.on("thumb-change",(()=>{this.updateRendererBreaks(this.colorSlider.breaks)})),this.colorSlider.on("thumb-drag",(()=>{this.updateRendererBreaks(this.colorSlider.breaks)})))}getClassBreaksColors(){const{modules:e}=o.s,i=(0,o.b)(),s=i.authoringInfo,t=(0===this.fieldPos?s.field1.classBreakInfos:s.field2.classBreakInfos).map((e=>({min:e.minValue,max:e.maxValue})));let l=new e.esriColor([0,0,0,1]),a=new e.esriColor([0,0,0,1]);i.uniqueValueGroups[0].classes.forEach((e=>{"HH"===e.values[0].value?l=(0,o.Q)(e.symbol):"LL"===e.values[0].value&&(a=(0,o.Q)(e.symbol))}));let n=(l.r+l.g+l.b)/3;const r=(a.r+a.g+a.b)/3;if(2===t.length)t[1].color=new e.esriColor([n,n,n,1]),t[0].color=new e.esriColor([r,r,r,1]);else if(3===t.length)t[2].color=new e.esriColor([n,n,n,1]),n=(n+r)/2,t[1].color=new e.esriColor([n,n,n,1]),t[0].color=new e.esriColor([r,r,r,1]);else{t[3].color=new e.esriColor([n,n,n,1]);let i=n+(r-n)/3;t[2].color=new e.esriColor([i,i,i,1]),i=n+2*(r-n)/3,t[1].color=new e.esriColor([i,i,i,1]),t[0].color=new e.esriColor([r,r,r,1])}return t}getHistogram(e,i,s,t,l){var a;const{layer:n,useFeatureReduction:r,mapView:u,modules:c}=o.s,d=n;(s=s||this.statistics)&&0!==s.count&&(this.histogramStatus=o.h.IN_PROGRESS,c.histogram({layer:d,view:u,field:e.field,numBins:50,minValue:null!=t?t:s.min,maxValue:null!=l?l:s.max,normalizationField:i,forBinning:"featureReduction"in d&&"binning"===(null===(a=d.featureReduction)||void 0===a?void 0:a.type)&&r}).then((e=>{this.histogram=e,this.histogramStatus=o.h.SUCCESS}),(e=>{console.log("error-histogram",e),this.histogramStatus=o.h.FAILED})))}getStatistics(){var e;const{layer:i,useFeatureReduction:s,mapView:t,modules:l}=o.s,a=i,n=(0,o.b)().authoringInfo,r=0===this.fieldPos?n.field1:n.field2,u=r.classBreakInfos;if(!u||this.statistics)return;const c={field:r.field,simpleFieldType:o.w.NUMBER},d=r.normalizationField;let h=u[0].minValue,f=u[u.length-1].maxValue;this.statisticsStatus=o.h.IN_PROGRESS,l.summaryStatistics({layer:a,view:t,field:r.field,normalizationField:d,forBinning:"featureReduction"in a&&"binning"===(null===(e=a.featureReduction)||void 0===e?void 0:e.type)&&s}).then((e=>{if(0===e.count)e.min=0,e.max=100,e.avg=(f+h)/2;else if(!(0,o.O)(e.avg)||!(0,o.O)(e.min)||!(0,o.O)(e.max))return void(this.statisticsStatus=o.h.FAILED);e=(0,o.aG)(e),h=null!=h?h:e.min,f=null!=f?f:e.max,this.statistics=e,this.statisticsStatus=o.h.SUCCESS,this.getHistogram(c,d,e,h,f)}),(e=>{console.log("error-summaryStatistics",e),this.statisticsStatus=o.h.FAILED}))}onMinMaxChange(e,i){const{statistics:s}=this,t=(0,o.b)(),a=t.authoringInfo,u=0===this.fieldPos?a.field1:a.field2,c=u.normalizationField,d={field:u.field,simpleFieldType:o.w.NUMBER},h=0===this.fieldPos?a.field1.classBreakInfos:a.field2.classBreakInfos;h[0].minValue=e,h[h.length-1].maxValue=i,(0,l.r)((0,r.u)(),this.flowItemNode).then((t=>{(0,o.u)(t),this.getHistogram(d,c,s,e,i),(0,n.u)(this.colorSlider,this.colorSliderBars,this.getClassBreaksColors(),this.histogram)})),t.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingRelationshipColorSliderChange.emit()}prepareColorSlider(){var e,i;const{statistics:s,histogram:t,histogramStatus:l}=this,{modules:r}=o.s,u=(0,o.b)().authoringInfo,c=0===this.fieldPos?u.field1.classBreakInfos:u.field2.classBreakInfos;if(!c||l===o.h.IN_PROGRESS)return!1;let d=c[0].minValue,h=c[c.length-1].maxValue;if(({min:d,max:h}=(0,o.aG)({min:d,max:h})),this.colorSlider){const e=this.colorSlider;if("dragging"===(null===(i=e.slider)||void 0===i?void 0:i.state))return!0;const o={histogramConfig:{bins:null==t?void 0:t.bins,average:Math.round(10*s.avg)/10,standardDeviation:s.stddev,standardDeviationCount:1},min:null!=d?d:s.min,max:null!=h?h:s.max};o.breaks=this.getClassBreaksColors(),o.precision=(0,a.g)(o.breaks),o.histogramConfig.barCreatedFunction=t&&n.b.bind(this,o.breaks,t,this.colorSliderBars),(0,n.u)(e,this.colorSliderBars,o.breaks,t),this.colorSlider.set(o)}else{const i=this.getClassBreaksColors(),s={histogramConfig:{bins:null===(e=this.histogram)||void 0===e?void 0:e.bins,average:Math.round(10*this.statistics.avg)/10,standardDeviation:this.statistics.stddev,standardDeviationCount:1},min:null!=d?d:this.statistics.min,max:null!=h?h:this.statistics.max,breaks:i};this.colorSliderBars=[],s.precision=(0,a.g)(s.breaks),s.histogramConfig.barCreatedFunction=this.histogram&&n.b.bind(this,s.breaks,this.histogram,this.colorSliderBars),(0,n.u)(this.colorSlider,this.colorSliderBars,s.breaks,this.histogram),this.colorSlider=new r.ClassedColorSlider(s),this.colorSlider.min===this.colorSlider.max&&this.colorSlider.set(s),this.createColorSliderChangeEvents()}return(0,o.O)(this.colorSlider)}updateRendererBreaks(e){const i=(0,o.b)().authoringInfo,s=0===this.fieldPos?i.field1:i.field2;i.classificationMethod="manual",s.classBreakInfos&&(s.classBreakInfos.forEach(((i,t)=>{i.minValue===e[t].min&&i.maxValue===e[t].max||(s.classBreakInfos[t].minValue=e[t].min,s.classBreakInfos[t].maxValue=e[t].max,this.currentBreakValues[t].min=e[t].min,this.currentBreakValues[t].max=e[t].max)})),(0,l.r)((0,r.u)(),this.flowItemNode).then((e=>{(0,o.u)(e),(0,n.u)(this.colorSlider,this.colorSliderBars,this.getClassBreaksColors(),this.histogram)})),this.arcgisSmartMappingRelationshipColorSliderChange.emit())}get hostElement(){return(0,t.d)(this)}};u.style=".slider-box{height:310px;margin-top:6px}.esri-classed-color-slider{min-width:200px}.esri-classed-color-slider__histogram-container{width:70px}.esri-classed-color-slider .esri-slider .esri-slider__content{height:200px}.esri-classed-color-slider .esri-slider .esri-slider__label,.esri-classed-color-slider .esri-slider .esri-slider__min,.esri-classed-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.esri-classed-color-slider .esri-slider .esri-slider__label:hover,.esri-classed-color-slider .esri-slider .esri-slider__min:hover,.esri-classed-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-container{overflow:hidden}";const c=class{constructor(e){(0,t.r)(this,e),this.arcgisSmartMappingRelationshipFocusButtonChange=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonChange",7),this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonBeforeOpen",7),this.arcgisSmartMappingRelationshipFocusButtonError=(0,t.c)(this,"arcgisSmartMappingRelationshipFocusButtonError",7),this.open=!1,this.flowItemNode=void 0,this.selectedFocusInfo=void 0}async setFocus(){this.buttonNode.focus()}componentWillLoad(){const{strings:e}=o.s,i=(0,o.b)();this.focusInfos=[{focus:"HH",title:e.relationshipFocusButton.focusHighHigh,msg:e.relationshipFocusButton.focusHighHighMsg,selected:!1,iconPath:null},{focus:"HL",title:e.relationshipFocusButton.focusHighLow,msg:e.relationshipFocusButton.focusHighLowMsg,selected:!1,iconPath:null},{focus:"LH",title:e.relationshipFocusButton.focusLowHigh,msg:e.relationshipFocusButton.focusLowHighMsg,selected:!1,iconPath:null},{focus:"LL",title:e.relationshipFocusButton.focusLowLow,msg:e.relationshipFocusButton.focusLowLowMsg,selected:!1,iconPath:null},{focus:"none",title:e.relationshipFocusButton.none,msg:e.relationshipFocusButton.focusNoneMsg,selected:!this.selectedFocusInfo,iconPath:null}],this.setSelectedFocus(i.authoringInfo.focus||"none")}render(){const{strings:e}=o.s;return(0,t.h)(t.H,{key:"71ce67b5bad168c9e406b62af378d26b11a5b4e8"},(0,t.h)("calcite-label",{key:"093a67f5b9269406df850fcaafa10210d7aecf92",class:"focus-margin"},e.relationshipFocusButton.focus,(0,t.h)("div",{key:"7be0557c1ebe06e23c80cb23c1e213f07a38beb1",class:"focus-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.relationshipFocusButton.focus,ref:e=>{e&&(this.buttonNode=e)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openFocusDropdown())},onClick:()=>this.openFocusDropdown()},(0,t.h)("div",{key:"c7e6d19b4e5dcd6851a8d64486112ea981f9888a",class:"focus-content"},(0,t.h)("div",{key:"3cd86d1de3fee3c415ce4fcd98850d5066d1dae0",class:"focus-button-text"},(0,t.h)("div",{key:"a96c7b9a37fee73f1a140d64d6f1ba95cbca6b53",class:"focus-button-title"},this.selectedFocusInfo.title),(0,t.h)("div",{key:"5ac475355b6cc0de518ec9fcbe434a57fe10ff9d",class:"focus-button-msg"},this.selectedFocusInfo.msg)),(0,t.h)("div",{key:"ae4056b9c7ad24efb0b3d04cc600a9946b53180a"},(0,t.h)("calcite-icon",{key:"25102a620413c29a3a41db98d9165e1a0e4c65be",scale:"s",icon:"chevron-down"}))))))}closePopover(){var e;this.open=!1,this.dropdownNode&&(null===(e=this.dropdownNode.parentNode)||void 0===e||e.removeChild(this.dropdownNode),this.dropdownNode=null,this.buttonNode.classList.remove("active"))}openFocusDropdown(){if(this.open)this.open=!1;else{this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen.emit();const e=document.createElement("arcgis-smart-mapping-dropdown");e.buttonNode=this.buttonNode,e.infos=this.focusInfos,this.dropdownNode=e,e.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closePopover(),"Escape"===e.detail&&this.setFocus()})),e.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setNewFocus(e.detail))),e.addEventListener("arcgisSmartMappingDropdownDisconnected",(()=>this.closePopover())),this.buttonNode.classList.add("active"),document.body.appendChild(e),this.open=!0}}setNewFocus(e){const i=(0,o.b)().authoringInfo.focus,s=e.focus;if(s===i)return this.closePopover(),void setTimeout((()=>this.setFocus()),300);(0,l.r)((0,r.u)({focus:s}),this.flowItemNode).then((i=>{this.setSelectedFocus(e.focus);(0,o.b)().uniqueValueInfos.forEach((e=>{i.uniqueValueInfos.find((i=>e.value===i.value)).label=e.label})),(0,o.u)(i),setTimeout((()=>this.setFocus()),300),this.arcgisSmartMappingRelationshipFocusButtonChange.emit()})),this.closePopover()}setSelectedFocus(e){this.focusInfos.forEach((i=>{i.focus===e?(this.selectedFocusInfo=i,i.selected=!0):i.selected=!1}))}get hostElement(){return(0,t.d)(this)}};var d;c.style=".focus-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:2px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.focus-button:active{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.focus-button:focus{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.focus-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.focus-content{justify-content:space-between;display:flex;align-items:center;width:100%}.focus-button-text{display:inline-block;padding:0 10px}.focus-button-title{font-weight:bold}.focus-button-msg{font-size:80%;line-height:16px}.focus-margin{margin:12px 0}",function(e){e.focusUp16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M1.71,8 L5.93,3.78 L8,5.85 L10.07,3.78 L14.29,8 L8,14.29 L1.71,8 Z",e.focusRight16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M1.71,8 L8,1.71 L12.22,5.93 L10.15,8 L12.22,10.07 L8,14.29 L1.71,8 Z",e.focusLeft16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M3.78,10.07 L5.85,8 L3.78,5.93 L8,1.71 L14.29,8 L8,14.29 L3.78,10.07 Z",e.focusDown16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M8,1.71 L14.29,8 L10.07,12.22 L8,10.15 L5.93,12.22 L1.71,8 L8,1.71 Z",e.code16="M6.865 13.965l-.957-.29 3.213-10.62.957.29zM15.19 8.45l-3.837-3.805-.704.71 3.131 3.104-3.135 3.19.712.702zm-9.833 3.2L2.221 8.458l3.13-3.104-.703-.71L.811 8.45l3.833 3.9z",e.fields16="M10.578 1A2.425 2.425 0 0 1 13 3.422V6c0 .552.448 1 1 1v1c-.552 0-1 .448-1 1v2.578A2.425 2.425 0 0 1 10.578 14H10v-1h.578c.785 0 1.421-.637 1.422-1.422V9c0-.574.247-1.121.679-1.5A1.995 1.995 0 0 1 12 6V3.422c0-.785-.637-1.421-1.422-1.422H10V1h.578zM6 1v1h-.578C4.637 2 4.001 2.637 4 3.422V6c0 .574-.247 1.121-.679 1.5.432.379.68.926.679 1.5v2.578c0 .785.637 1.421 1.422 1.422H6v1h-.578A2.425 2.425 0 0 1 3 11.578V9c0-.552-.448-1-1-1V7c.552 0 1-.448 1-1V3.422A2.425 2.425 0 0 1 5.422 1H6z"}(d||(d={}));const h=class{constructor(e){(0,t.r)(this,e),this.arcgisSmartMappingRelationshipLegendFocusChange=(0,t.c)(this,"arcgisSmartMappingRelationshipLegendFocusChange",7),this.arcgisSmartMappingRelationshipLegendError=(0,t.c)(this,"arcgisSmartMappingRelationshipLegendError",7),this.valueTextNodes=[]}componentWillLoad(){this.flowItemNode=(0,o.f)(this.hostElement,"calcite-flow-item")}disconnectedCallback(){o.s.selectedValue=void 0}render(){const{strings:e}=o.s;return(0,t.h)("calcite-block",{key:"f6d16a76c18442b0a45938ecd03bf487f1c68206",open:!0,heading:e.relationshipLegend.legend,collapsible:!0},this.renderContent())}renderContent(){return(0,t.h)("div",null,(0,t.h)("div",{class:"attributes"},this.renderAttribute(0),this.renderAttribute(1)),this.renderFocus(),this.renderLabels())}renderAttribute(e){const i=(0,o.b)().authoringInfo,s=0===e?i.field1:i.field2,l=(0,o.t)(s.field);let a=this.getColorOrder(e);return(0,t.h)("div",{class:"attribute"},(0,t.h)("div",{class:"attribute-color-icon","aria-hidden":"true"},a.map(((e,i)=>this.getSwatch(a[i])))),(0,t.h)("div",{class:"attribute-name"},l.label))}renderFocus(){return(0,t.h)("arcgis-smart-mapping-relationship-focus-button",{flowItemNode:this.flowItemNode,onArcgisSmartMappingRelationshipFocusButtonBeforeOpen:()=>(0,o.m)(),onArcgisSmartMappingRelationshipFocusButtonChange:()=>{this.arcgisSmartMappingRelationshipLegendFocusChange.emit(),(0,t.f)(this.hostElement)},onArcgisSmartMappingRelationshipFocusButtonError:({detail:e})=>this.arcgisSmartMappingRelationshipLegendError.emit(e)})}renderLabels(){const{strings:e}=o.s,i=(0,o.b)().authoringInfo.numClasses;return(0,t.h)("calcite-label",null,e.relationshipLegend.labels,(0,t.h)("calcite-list",null,this.renderLabel(0),this.renderLabel(i-1),this.renderLabel(i*i-i),this.renderLabel(i*i-1)))}renderLabel(e){const i=(0,o.b)().authoringInfo,s=i.numClasses,l=i.focus,a=0===e?d.focusUp16:e===("LH"===l||"HL"===l?s*s-s:s-1)?d.focusLeft16:e===("LH"===l||"HL"===l?s-1:s*s-s)?d.focusRight16:d.focusDown16;return(0,t.h)("calcite-list-item",null,this.renderIconNode(a),this.renderTextNode(e))}renderIconNode(e){const i=!(0,o.b)().authoringInfo.focus;return(0,t.h)("div",{slot:"actions-start",class:"label-icon"},(0,t.h)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",class:""+(i?"rotate-45":"")},(0,t.h)("path",{d:e})))}renderTextNode(e){const{strings:i}=o.s,s=(0,o.b)(),l=s.authoringInfo,a=l.numClasses,n=l.focus,r=s.uniqueValueInfos[e],u=0===e?i.relationshipLegend.accessibility.editLabelForTop:e===("LH"===n||"HL"===n?a*a-a:a-1)?i.relationshipLegend.accessibility.editLabelForLeft:e===("LH"===n||"HL"===n?a-1:a*a-a)?i.relationshipLegend.accessibility.editLabelForRight:i.relationshipLegend.accessibility.editLabelForBottom;return this.selectedLabelText===e?(0,t.h)("calcite-input",{slot:"content",scale:"s",value:r.label,onFocusout:i=>{const s=i.target;this.handleLabelTextChange(e,s.value)},onKeyDown:i=>{if(i.stopPropagation(),"Escape"===i.key||"Enter"===i.key){const s=i.target;this.handleLabelTextChange(e,s.value)}},ref:e=>null==e?void 0:e.setFocus()}):(0,t.h)("div",{class:"label",slot:"content",tabIndex:0,"aria-label":u,onClick:()=>this.handleLabelTextClick(e),onKeyUp:i=>{" "!==i.key&&"Enter"!==i.key||this.handleLabelTextClick(e)},ref:i=>this.valueTextNodes[e]=i},r.label)}getColorOrder(e){const i=(0,o.b)().authoringInfo||{};let s=[];if(2===i.numClasses)switch(i.focus){case"HH":default:s=0===e?[3,1]:[3,2];break;case"HL":s=0===e?[2,0]:[2,3];break;case"LH":s=0===e?[1,3]:[1,0];break;case"LL":s=0===e?[0,2]:[0,1]}else if(3===i.numClasses)switch(i.focus){case"HH":default:s=0===e?[8,5,2]:[8,7,6];break;case"HL":s=0===e?[6,3,0]:[6,7,8];break;case"LH":s=0===e?[2,5,8]:[2,1,0];break;case"LL":s=0===e?[0,3,6]:[0,1,2]}else switch(i.focus){case"HH":default:s=0===e?[15,11,7,3]:[15,14,13,12];break;case"HL":s=0===e?[12,8,4,0]:[12,13,14,15];break;case"LH":s=0===e?[3,7,11,15]:[3,2,1,0];break;case"LL":s=0===e?[0,4,8,12]:[0,1,2,3]}return s}getSwatch(e){const i=(0,o.b)();return(0,t.h)("div",{class:"attribute-color-icon-selection",ref:s=>{if(s){const t=(0,o.Q)(i.uniqueValueInfos[e].symbol);s.style.width=100/i.authoringInfo.numClasses+"px",s.style.backgroundColor=(null==t?void 0:t.toHex())||"#ffffff"}}})}handleLabelTextClick(e){o.s.selectedValue=e,this.selectedLabelText=e,(0,t.f)(this.hostElement)}handleLabelTextChange(e,i){(0,o.b)().uniqueValueInfos[e].label=i,this.selectedLabelText=void 0,(0,o.u)(),(0,t.f)(this.hostElement),setTimeout((()=>{var i;o.s.selectedValue===e&&(null===(i=this.valueTextNodes[e])||void 0===i||i.focus(),o.s.selectedValue=void 0)}),300)}get hostElement(){return(0,t.d)(this)}};h.style=".attribute{display:flex;padding-bottom:6px}.attributes{margin:12px 0}.attribute-name{padding:0 10px;width:calc(100% - 45px);word-break:break-all}.attribute-color-icon{width:45px;height:16px;overflow:hidden;border-radius:3px;display:flex;align-self:center}.attribute-color-icon-selection{height:16px;display:inline-block}.label{display:flex;padding:6px 0;align-items:center}.label div{display:flex}.label-icon{color:rgba(50, 50, 50, 0.4);display:flex;flex-direction:column;justify-content:center;cursor:default}.label-icon .rotate-45{transform:rotate(45deg)}"},95875:(e,i,s)=>{let t,o;function l(e){e.loading=!1}function a(e,i){return function(e){e.loading=!0,o=!1,t&&clearTimeout(t),t=setTimeout((()=>{l(e),o=!0}),6e4)}(i),e.then((e=>(l(i),o?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(l(i),Promise.reject(e))))}s.d(i,{r:()=>a})},13521:(e,i,s)=>{s.d(i,{a:()=>n,b:()=>a,g:()=>d,u:()=>l});var t=s(1991),o=s(82646);s(70506);function l(e){const{modules:i}=o.s,s=(0,o.b)(),l=i.esriLang.clone(s.classBreakInfos);s.classBreakInfos=[],l.forEach(((i,a)=>{i=function(e,i,s,l){if((0,t.i)(i))if(0===i);else if(i<1){const t=Math.round(1/i);e.minValue="first"===l?Math.floor(e.minValue/i)/t:Math.round(e.minValue/i)/t,e.maxValue="last"===l?Math.ceil(e.maxValue/i)/t:Math.round(e.maxValue/i)/t,e.label=`${s>0?"> ":""}${e.minValue.toLocaleString(o.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(o.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===l?Math.floor(e.minValue/i)*i:Math.round(e.minValue/i)*i,e.maxValue="last"===l?Math.ceil(e.maxValue/i)*i:Math.round(e.maxValue/i)*i,e.label=(s>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(i,e,a,0===a?"first":a===l.length-1?"last":void 0),s.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function a(e){const i=(0,o.b)().classBreakInfos;let s=e,t=1/0;i.forEach((e=>{s||(s=Math.max(r(e.minValue),r(e.maxValue))),t=Math.min(t,e.maxValue-e.minValue)}));const l=[];return t>1e7?(l.push(1e7),l.push(1e6),l.push(1e5),l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):t>1e6?(l.push(1e6),l.push(1e5),l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):t>1e5?(l.push(1e5),l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):t>1e4?(l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):t>1e3?(l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001)):t>100?(l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5)):t>10?(l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):t>1?(s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):t>.1?(s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):t>.01?(s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):t>.001?(s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6),s>7&&l.push(1e-7)):t>1e-4?(s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6),s>7&&l.push(1e-7),s>8&&l.push(1e-8)):t>1e-5&&(s>5&&l.push(1e-5),s>6&&l.push(1e-6),s>7&&l.push(1e-7),s>8&&l.push(1e-8),s>9&&l.push(1e-9)),l}function n(){const e=(0,o.b)();let i=1e10;return e.classBreakInfos.forEach((e=>{i=Math.min(i,u(e.minValue)),i=Math.min(i,u(e.maxValue))})),i}function r(e){let i=1;for(;Math.round(e*i)/i!==e;)i*=10;return Math.log(i)/Math.LN10}function u(e){let i=1e-8;for(;c(Math.round(e/i)*i)===e;)i*=10;return i/10}function c(e){return parseFloat(e.toPrecision(12))}function d(e){var i,s,o,l,a,n,u,d;let h=0;e.forEach((e=>{(0,t.i)(e.value)?h=Math.max(r(c(e.value)),h):((0,t.i)(e.minValue)&&(h=Math.max(r(c(e.minValue)),h)),(0,t.i)(e.maxValue)&&(h=Math.max(r(c(e.maxValue)),h)),(0,t.i)(e.min)&&(h=Math.max(r(c(e.min)),h)),(0,t.i)(e.max)&&(h=Math.max(r(c(e.max)),h)))})),h=Math.min(h,3);const f=e[0],m=e[e.length-1],p=Math.min(null!==(s=null!==(i=f.minValue)&&void 0!==i?i:f.min)&&void 0!==s?s:f.value,null!==(l=null!==(o=m.minValue)&&void 0!==o?o:m.min)&&void 0!==l?l:m.value),g=Math.max(null!==(n=null!==(a=f.maxValue)&&void 0!==a?a:f.max)&&void 0!==n?n:f.value,null!==(d=null!==(u=m.maxValue)&&void 0!==u?u:m.max)&&void 0!==d?d:m.value)-p;return g/e.length<2e-7?h=8:g/e.length<2e-6?h=7:g/e.length<2e-5?h=6:g/e.length<2e-4?h=5:g/e.length<.002?h=4:g/e.length<.02?h=3:g/e.length<.2?h=Math.max(h,2):g/e.length<2&&(h=Math.max(h,1)),Math.round(h)}},93143:(e,i,s)=>{s.d(i,{a:()=>a,c:()=>l,u:()=>n});var t=s(1991),o=s(82646);s(70506);function l(e){var i,s;const{layer:l,useFeatureReduction:a,mapImageSublayer:n,mapView:r,modules:u}=o.s,c=l,d=(0,o.a)();let h=e.relationshipScheme;if(!h&&["relationship","relationship-size"].indexOf(d)>-1&&(h=(0,o.a4)()),e=e||{},"relationship-size"===d){const s=(0,o.b)().clone(),t=s.authoringInfo;if(t&&(null===(i=e.fieldInfos)||void 0===i?void 0:i.length)>1&&e.fieldInfos[0].field==t.field1.field&&e.fieldInfos[1].field==t.field2.field){if(s.visualVariables=(0,o.T)(s,"size"),s.authoringInfo.visualVariables=(0,o.U)(s,"size"),(0,o.D)()){const e=(0,o.q)(),i=s.uniqueValueInfos.slice();i.map((i=>{const s=(0,o.Q)(i.symbol);i.symbol=e.clone(),(0,o.W)(i.symbol,s)})),s.uniqueValueInfos=i}return Promise.resolve({renderer:s})}}const f=(0,o.p)((0,o.b)()),m={layer:c,view:r,field1:{field:e.fieldInfos[0].field},field2:{field:e.fieldInfos[1].field},classificationMethod:"quantile",numClasses:3,focus:"HH",relationshipScheme:h,outlineOptimizationEnabled:!n&&(!(0,t.i)(e.outlineOptimizationEnabled)||e.outlineOptimizationEnabled),sizeOptimizationEnabled:!n&&(!(0,t.i)(e.sizeOptimizationEnabled)||e.sizeOptimizationEnabled),legendOptions:e.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===(null===(s=c.featureReduction)||void 0===s?void 0:s.type)&&a};return u.RelationshipCreator.createRenderer(m).then((e=>((0,o.o)(f,e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function a(e){var i;const{layer:s,useFeatureReduction:l,mapImageSublayer:a,mapView:n,modules:r}=o.s,u=s;e=e||{};const c=(0,o.b)(),d=(0,o.a)(),h=c.authoringInfo,f=(0,o.d)(c,"size");if(e.fieldInfos&&e.fieldInfos.length>1&&e.fieldInfos[0].field==h.field1.field&&e.normalizationField1===h.field1.normalizationField&&e.fieldInfos[1].field==h.field2.field&&e.normalizationField2===h.field2.normalizationField&&(delete e.fieldInfos,delete e.normalizationField1,delete e.normalizationField2,(0,o.V)(e)&&!f))return Promise.resolve({renderer:c.clone()});let m=e.relationshipScheme;!m&&["relationship","relationship-size"].indexOf(d)>-1&&(m=(0,o.a4)());const p=(0,o.p)(c);let g=e.fieldInfos?e.fieldInfos[0]:{field:h.field1.field,simpleFieldType:o.w.NUMBER},b=e.fieldInfos?e.fieldInfos[1]:{field:h.field2.field,simpleFieldType:o.w.NUMBER};const v=void 0!==e.normalizationField1?e.normalizationField1:h.field1.normalizationField,S=void 0!==e.normalizationField2?e.normalizationField2:h.field2.normalizationField,x=c.uniqueValueInfos&&c.uniqueValueInfos.length?c.uniqueValueInfos[0].symbol:null,L=c.defaultSymbol,C=c.defaultLabel,I=e.numClasses?e.numClasses:h.numClasses,M={layer:u,view:n,field1:{field:g?g.field:c.field,normalizationField:v},field2:{field:b?b.field:c.field,normalizationField:S},classificationMethod:e.classificationMethod?e.classificationMethod:"manual"!==h.classificationMethod?h.classificationMethod:"quantile",numClasses:I,focus:e.focus?e.focus:h.focus,relationshipScheme:m,outlineOptimizationEnabled:!a&&((0,t.i)(e.outlineOptimizationEnabled)?e.outlineOptimizationEnabled:!!p.sizeOutlineVisVar),sizeOptimizationEnabled:!a&&((0,t.i)(e.sizeOptimizationEnabled)?e.sizeOptimizationEnabled:!!p.sizeAutoVisVar),legendOptions:e.legendOptions?e.legendOptions:c.legendOptions,defaultSymbolEnabled:(0,t.i)(e.defaultSymbolEnabled)?e.defaultSymbolEnabled:!!c.defaultSymbol,forBinning:"binning"===(null===(i=u.featureReduction)||void 0===i?void 0:i.type)&&l};return r.RelationshipCreator.createRenderer(M).then((e=>{if((0,o.o)(p,e.renderer),x){e.renderer.uniqueValueInfos.forEach((e=>{const i=x.clone();(0,o.W)(i,(0,o.Q)(e.symbol)),e.symbol=i}))}return(0,o.b)().uniqueValueInfos.forEach((i=>{const s=e.renderer.uniqueValueInfos.find((e=>i.value===e.value));s&&(s.label=i.label)})),L&&(e.renderer.defaultSymbol=L,e.renderer.defaultLabel=C),Promise.resolve(e)}),(e=>Promise.reject(e)))}function n(e){const{modules:i}=o.s;e=e||{};const s=(0,o.b)(),t=s.authoringInfo;return i.RelationshipCreator.updateRenderer({field1:t.field1,field2:t.field2,numClasses:e.numClasses?e.numClasses:t.numClasses,focus:e.focus?"none"===e.focus?null:e.focus:t.focus,colors:e.colors,renderer:s})}},43025:(e,i,s)=>{s.d(i,{b:()=>o,u:()=>l});s(77040),s(70506);var t=s(82646);function o(e,i,s,t,o){const l=(null==e?void 0:e.length)?n(e,i.bins[t]):a(e.stops,i.bins[t]);l&&o.setAttribute("fill",l.toHex()),l&&o.setAttribute("opacity",`${Math.max(l.a,.2)}`),s.push(o)}function l(e,i,s,t){null==i||i.forEach(((i,o)=>{const l=(t||e.histogramConfig).bins[o],r=e.breaks?n(s||e.breaks,l):a((s||e).stops,l);r&&i.setAttribute("fill",r.toHex()),r&&i.setAttribute("opacity",`${Math.max(r.a,.2)}`)}))}function a(e,i){const{modules:s}=t.s;if(!i)return;const o=(i.maxValue-i.minValue)/2+i.minValue;let l=e[0],a=e[e.length-1];const n=l.value,r=a.value;if(o<n)return l.color;if(o>r)return a.color;const u=e.filter((e=>e.value===o));if(u.length>0)return u[0].color;l=null,a=null,e.forEach(((i,s)=>{!l&&!a&&i.value>=o&&(l=e[s-1],a=i)}));const c=(o-l.value)/(a.value-l.value);return s.esriColor.blendColors(l.color,a.color,c)}function n(e,i){if(!i)return;const s=(i.maxValue-i.minValue)/2+i.minValue;let t=e[0],o=e[e.length-1];if(s<t.min||s>o.max)return;const l=e.filter((e=>e.min===s));return l.length>0?l[0].color:(t=e[e.length-1],o=null,e.forEach(((i,l)=>{!o&&i.min>=s&&(t=e[l-1],o=i)})),t.color)}}}]);