/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_common-b19abb.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_common-b19abb"],{77040:(e,t,n)=>{var i,r,a,o,l,s;n.d(t,{L:()=>s,a:()=>l,f:()=>r,i:()=>i,l:()=>a,s:()=>o}),function(e){e.sourceUrl="sourceUrl",e.title="title",e.caption="caption",e.linkUrl="linkUrl",e.altText="altText"}(i||(i={})),function(e){e.expression="expression/",e.relationship="relationships/",e.raster="Raster."}(r||(r={})),function(e){e.feature="feature",e.cluster="cluster",e.mapNotes="mapNotes"}(a||(a={})),function(e){e.feature="feature",e.mapImage="map-image",e.scene="scene",e.ogcFeature="ogc-feature",e.imagery="imagery",e.wfs="wfs",e.wms="wms",e.csv="csv",e.geojson="geojson",e.stream="stream",e.imageryTile="imagery-tile",e.tile="tile",e.subtype="subtype",e.orientedImagery="oriented-imagery",e.catalog="catalog",e.catalogFootprint="catalog-footprint"}(o||(o={})),function(e){e.integer="integer",e.smallInteger="small-integer",e.bigInteger="big-integer",e.single="single",e.double="double",e.long="long",e.string="string",e.date="date",e.dateOnly="date-only",e.timeOnly="time-only",e.timestampOffset="timestamp-offset",e.oid="oid",e.guid="guid",e.globalId="global-id",e.number="number"}(l||(l={})),function(e){e.default="default",e.display="display",e.type="type",e.field="field"}(s||(s={}))},1991:(e,t,n)=>{n.d(t,{a:()=>F,b:()=>f,c:()=>a,d:()=>c,e:()=>l,f:()=>o,g:()=>m,h:()=>h,i:()=>w,j:()=>p,k:()=>y,l:()=>g,m:()=>b,n:()=>s,o:()=>I,p:()=>d,q:()=>v,t:()=>N});var i=n(77040),r=n(28926);function a(e,t){if(-1!==e.fieldName.indexOf(i.f.expression)){const n=t.get(e.fieldName);return(null==n?void 0:n.title)?n.title:e.fieldName}return e.label?e.label:e.fieldName}function o(e){const t=new Map;return(null==e?void 0:e.expressionInfos)&&e.expressionInfos.forEach((e=>{const n=`${i.f.expression}${e.name}`;t.set(n,e)})),t}async function l(e){return new Map((await y(e)).filter((e=>e.visible)).map((e=>[e.name,e])))}async function s(e,t){var n,r,a,o,l,s,d,y,p;try{const f=c(e);if(f===i.s.mapImage&&e.layer.version>=10.5&&!(null===(r=null===(n=e.layer.capabilities)||void 0===n?void 0:n.operations)||void 0===r?void 0:r.supportsQuery)&&(null===(o=null===(a=e.layer.capabilities)||void 0===a?void 0:a.operations)||void 0===o?void 0:o.supportsIdentify)){return{features:[await h(e,t)||await u(e,t)]}}if(f===i.s.scene&&!(null===(s=null===(l=e.capabilities)||void 0===l?void 0:l.operations)||void 0===s?void 0:s.supportsQuery)){return{features:[await u(e,t)]}}const m=f===i.s.ogcFeature||f===i.s.stream?await t.whenLayerView(e):e,g=m.createQuery();g.where=m.definitionExpression||"1=1",g.outFields=["*"],g.returnM="hasM"in e&&e.hasM,g.returnZ="hasZ"in e&&e.hasZ,((null===(y=null===(d=m.sourceJSON)||void 0===d?void 0:d.advancedQueryCapabilities)||void 0===y?void 0:y.supportsPagination)||f===i.s.ogcFeature)&&(g.start=0,g.num=1),g.outSpatialReference=t.spatialReference;const v=await m.queryFeatures(g);return(null===(p=null==v?void 0:v.features)||void 0===p?void 0:p.length)||(v.features[0]=await u(e,t)),v}catch(e){console.error(e)}}async function u(e,t){return new Promise(((n,i)=>{(0,r.l)(["esri/Graphic","esri/geometry/Multipoint","esri/geometry/Polygon","esri/geometry/Polyline","esri/geometry/Mesh"]).then((([i,r,a,o,l])=>{var s;const u=new i;if(null===(s=e.fields)||void 0===s?void 0:s.length){const t={};e.fields.forEach((e=>{t[e.name]=e.defaultValue})),u.attributes=t}const c=t.extent;let d;"polygon"===e.geometryType?d=a.fromExtent(c):"point"===e.geometryType?d=c.center.clone():"multipoint"===e.geometryType?d=new r({points:[[c.center.x,c.center.y]],spatialReference:c.center.spatialReference.clone()}):"polyline"===e.geometryType?(d=new o({spatialReference:t.spatialReference.clone()}),d.addPath([[c.xmin,c.ymin],[c.xmax,c.ymax]])):"mesh"===e.geometryType&&(d=l.createBox(c.center.clone(),{size:{width:50,height:50,depth:50}})),u.geometry=d,n(u)}),(e=>{i(e)}))}))}function c(e){var t,n,r;return"map-image"===(null===(t=null==e?void 0:e.layer)||void 0===t?void 0:t.type)?i.s.mapImage:"subtype-sublayer"===(null==e?void 0:e.type)?i.s.subtype:"tile"===(null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.type)?i.s.tile:"scene"===(null==e?void 0:e.type)?i.s.scene:"ogc-feature"===(null==e?void 0:e.type)?i.s.ogcFeature:"imagery"===(null==e?void 0:e.type)?i.s.imagery:"imagery-tile"===(null==e?void 0:e.type)?i.s.imageryTile:"wfs"===(null==e?void 0:e.type)?i.s.wfs:"wms"===(null===(r=null==e?void 0:e.layer)||void 0===r?void 0:r.type)?i.s.wms:"csv"===(null==e?void 0:e.type)?i.s.csv:"geojson"===(null==e?void 0:e.type)?i.s.geojson:"stream"===(null==e?void 0:e.type)?i.s.stream:"oriented-imagery"===(null==e?void 0:e.type)?i.s.orientedImagery:"catalog"===(null==e?void 0:e.type)?i.s.catalog:"catalog-footprint"===(null==e?void 0:e.type)?i.s.catalogFootprint:i.s.feature}function d(e){const t=c(e);let n;return t===i.s.wms||t===i.s.mapImage?n=null==e?void 0:e.layer.version:t!==i.s.imagery&&t!==i.s.feature&&t!==i.s.scene||(n=e.version),Number.parseFloat(n)}async function y(e){return new Promise((async(t,n)=>{var r,a,o,l;switch(c(e)){case i.s.feature:case i.s.ogcFeature:case i.s.stream:t(e.fields);break;case i.s.mapImage:if((null===(r=null==e?void 0:e.layer)||void 0===r?void 0:r.portalItem)&&(null===(a=e.layer)||void 0===a?void 0:a.url.indexOf("https://demographics"))>-1&&(null===(o=e.layer)||void 0===o?void 0:o.url.indexOf(".arcgis.com"))>-1)try{const n=await(null===(l=e.layer.portalItem)||void 0===l?void 0:l.fetchData());if(null==n?void 0:n.thematicGroup){const i=new Map(e.fields.map((e=>[e.name,e]))),r=n.thematicGroup.fieldNames,a=[];r.forEach((e=>{i.has(e)&&a.push(i.get(e))})),t(a)}else t(e.fields)}catch(e){n(e)}else t(e.fields);break;case i.s.imagery:const s=e;t((s.fields||[]).concat(s.rasterFields||[]));break;case i.s.imageryTile:t(e.rasterFields);break;default:t("fields"in e&&e.fields)}}))}async function p(e){return new Promise((async t=>{var n,r,a,o,l;if(c(e)===i.s.stream)t("point");else if(e.geometryType)t(e.geometryType);else if(c(e)===i.s.mapImage&&(null===(r=null===(n=null==e?void 0:e.layer)||void 0===n?void 0:n.sourceJSON)||void 0===r?void 0:r.layers)){const n=null===(o=null===(a=e.layer.sourceJSON.layers.find((t=>{if(t.id===e.id)return t})))||void 0===a?void 0:a.geometryType)||void 0===o?void 0:o.toLowerCase();if(n)n.indexOf("point")>-1?t("point"):n.indexOf("line")>-1?t("polyline"):n.indexOf("polygon")>-1?t("polygon"):t(n);else{const n=null===(l=null==e?void 0:e.layer)||void 0===l?void 0:l.findSublayerById(e.id);n?await(null==n?void 0:n.createFeatureLayer().then((async e=>{const n=await(null==e?void 0:e.load());t(null==n?void 0:n.geometryType)}))):t(null)}}else t(null)}))}function f(e,t,n){let i="";if(/^raster.(item|service)pixelvalue/i.test(e))i="number";else if(t.has(e)){const n=t.get(e);i=n.type?n.type.toLowerCase():""}else if(n.has(e)){const t=n.get(e);i=t.returnType?t.returnType.toLowerCase():""}else i="number";return i}async function m(e,t){return"feature"!==e.type||e.url?"feature"===e.type||"csv"===e.type||"scene"===e.type||"wfs"===e.type||"geojson"===e.type||"oriented-imagery"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"catalog"===e.type||"catalog-footprint"===e.type?await e.queryFeatureCount():!t||"stream"!==e.type&&"ogc-feature"!==e.type?void 0:async function(e,t){const n=await t.whenLayerView(e);return n.queryFeatureCount()}(e,t):async function(e){var t;const n=e.createQuery();n.outFields=["*"];const i=await e.queryFeatures(n);if(null===(t=i.features)||void 0===t?void 0:t.length)return i.features.length;throw new Error("could not get feature count")}(e)}const g=(e,t)=>{let n=[];return null==e||e.fieldInfos.forEach((e=>{e.fieldName.includes(i.f.expression)?t&&n.push({name:e.fieldName.slice(i.f.expression.length),alias:e.fieldName.slice(i.f.expression.length),type:"string"}):n.push({name:e.fieldName,alias:e.label,type:"string"})})),n};function v(e,t){let n=0===t.indexOf("#"),i=0===t.indexOf(".");for((i||n)&&(t=t.slice(1));e;){if(n){if(e.id===t)return e}else if(i){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement}return null}function w(e){return null!=e}const h=async(e,t)=>{var n,i;const[a,o]=await(0,r.l)(["esri/rest/identify","esri/rest/support/IdentifyParameters"]),l=new o;l.geometry=t.extent,l.mapExtent=t.extent,l.returnGeometry=!0,l.tolerance=6,l.layerOption="popup",l.width=t.width,l.height=t.height,l.layerIds=[e.id];const s=null===(n=await a.identify(e.layer.url,l))||void 0===n?void 0:n.results;return null===(i=null==s?void 0:s[0])||void 0===i?void 0:i.feature},b=async(e,t,n)=>{var i;const r=await e.whenLayerView(t),a=await r.queryAggregates();return await x(n,null===(i=a.features)||void 0===i?void 0:i[0])},x=async(e,t)=>{const[n,i]=await(0,r.l)(["esri/Graphic","esri/geometry/Point"]);let a;if(t)a=t.clone();else{a=new n;const t=g(e,!1);if(null==t?void 0:t.length){const e={};t.forEach((t=>{e[t.name]=""})),a.attributes=e}const r=new i;a.geometry=r}return a};function I(e){var t;if(!e)return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return null===(t=e.extent)||void 0===t?void 0:t.center;default:return null}}function F(e){return Number((100*(1-e)).toFixed(1))}function N(e){return Number((1-e/100).toFixed(3))}}}]);