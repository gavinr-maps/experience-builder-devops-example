/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_fieldA-67fb4f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_fieldA-67fb4f"],{31670:(e,r,i)=>{i.d(r,{c:()=>o,o:()=>t});const n=(0,i(11935).c)({portal:null,user:null,api:4,scale:"m"}),o=n.state,t=n.onChange},96536:(e,r,i)=>{i.d(r,{F:()=>u,a:()=>c,c:()=>d});var n=i(7263),o=i(77040),t=i(2174),s=i(11246),l=i(28926),a=i(94788);const u=({fieldType:e})=>e===o.a.oid||e===o.a.guid||e===o.a.globalId?(0,n.h)("calcite-icon",{scale:"s",icon:"key"}):e===o.a.integer||e===o.a.smallInteger||e===o.a.bigInteger?(0,n.h)("calcite-icon",{scale:"s",icon:"integer"}):e===o.a.single||e===o.a.double||e===o.a.long||e===o.a.number?(0,n.h)("calcite-icon",{scale:"s",icon:"number"}):e===o.a.string?(0,n.h)("calcite-icon",{scale:"s",icon:"string"}):e===o.a.date?(0,n.h)("calcite-icon",{scale:"s",icon:"date-time"}):e===o.a.dateOnly?(0,n.h)("calcite-icon",{scale:"s",icon:"calendar"}):e===o.a.timestampOffset?(0,n.h)("calcite-icon",{scale:"s",icon:"time-zone"}):e===o.a.timeOnly?(0,n.h)("calcite-icon",{scale:"s",icon:"clock"}):(0,n.h)("calcite-icon",{scale:"s",icon:"string"});async function d(e){var r,i,n;const o="feature"===e.type||"oriented-imagery"===e.type,s=null==e?void 0:e.portalItem,l=e.sourceJSON;if(!o||!s)return Promise.resolve(!1);const a=s.portal;if(!(null==a?void 0:a.user))return Promise.resolve(!1);if((0,t.f)(s))return Promise.resolve(!1);if(!(0,t.h)(s))return Promise.resolve(!1);if((0,t.l)(s))return Promise.resolve(!1);if((0,t.p)(l))return Promise.resolve(!1);const u=(0,t.u)(s,a.user),d=null!==(r=await(0,t.j)(e))&&void 0!==r?r:[],c=null!==(i=await(0,t.k)(e))&&void 0!==i?i:[],v=(0,t.m)(d,c);if(!u&&!v)return Promise.resolve(!1);const f=await(0,t.n)(s.id,a,{relationshipType:"Service2Service"});if(null===(n=null==f?void 0:f.data)||void 0===n?void 0:n.relatedItems){if(f.data.relatedItems.some((e=>["WMTS","Map Service","Vector Tile Service"].includes(e.type))))return Promise.resolve(!1)}return Promise.resolve(!0)}async function c(e,r,i){var n,o,s,u,d,c,p;if(!i)return Promise.resolve(!1);const g="feature"===r.type||"oriented-imagery"===r.type,y=r.portalItem,h=r.sourceJSON;if(!g||!y)return Promise.resolve(!1);if(!y.portal.user)return Promise.resolve(!1);if(!(0,t.h)(y))return Promise.resolve(!1);if((0,t.f)(y))return Promise.resolve(!1);if((0,t.l)(y))return Promise.resolve(!1);if((0,t.p)(h))return Promise.resolve(!1);if(y.portal.isPortal&&(0,t.o)(y))return Promise.resolve(!1);if(["oid","global-id","geometry"].indexOf(i.type)>-1)return Promise.resolve(!1);const w=r.sourceJSON.geometryProperties;if([null==w?void 0:w.shapeLengthFieldName,null==w?void 0:w.shapeAreaFieldName].includes(i.name))return Promise.resolve(!1);const P=r.editFieldsInfo;if(P&&(P.creationDateField===i.name||P.creatorField===i.name||P.editDateField===i.name||P.editorField===i.name))return Promise.resolve(!1);if(r.objectIdField===i.name||r.displayField===i.name)return Promise.resolve(!1);if(r.typeIdField===i.name)return Promise.resolve(!1);if(r.subtypeField===i.name)return Promise.resolve(!1);if(r.timeInfo&&(r.timeInfo.startField===i.name||r.timeInfo.endField===i.name||r.timeInfo.trackIdField===i.name))return Promise.resolve(!1);const[S]=await(0,l.l)(["esri/layers/support/fieldUtils"]),b=await S.getRendererFields(r.renderer,r.fieldsIndex);if(null==b?void 0:b.includes(i.name))return Promise.resolve(!1);if(r.featureReduction){const e=await S.getRendererFields(r.featureReduction.renderer);if(f(r.featureReduction,e).includes(i.name))return Promise.resolve(!1);if((await m(r,r.featureReduction,e,S)).includes(i.name))return Promise.resolve(!1)}const I=null===(n=r.labelingInfo)||void 0===n?void 0:n.map((e=>{var r;return null===(r=e.labelExpressionInfo)||void 0===r?void 0:r.expression}));if(I){const e=await S.getExpressionFields(r,I);if(null==e?void 0:e.includes(i.name))return Promise.resolve(!1);if(await v(r,i,"layer"))return Promise.resolve(!1)}if(r.featureReduction){const e=null===(o=r.featureReduction.labelingInfo)||void 0===o?void 0:o.map((e=>{var r;return null===(r=e.labelExpressionInfo)||void 0===r?void 0:r.expression}));if(e){const[n]=await(0,l.l)(["esri/support/arcadeUtils"]),o=[],t=null===(s=r.featureReduction.fields)||void 0===s?void 0:s.map((e=>e.name));await Promise.all(e.map((async e=>{(await n.extractFieldNames(e,t)).forEach((e=>{o.includes(e)||o.push(e)}))})));if(f(r.featureReduction,o).includes(i.name))return Promise.resolve(!1);if((await m(r,r.featureReduction,o,S)).includes(i.name))return Promise.resolve(!1);if(await v(r,i,"featureReduction"))return Promise.resolve(!1)}}if(r.definitionExpression){const[e]=await(0,l.l)(["esri/core/sql"]);if(null===(u=(await e.parseWhereClause(r.definitionExpression)).fieldNames)||void 0===u?void 0:u.includes(i.name))return Promise.resolve(!1)}const F=await async function(e,r){var i;const n=e.portalItem;if(!n)return Promise.resolve(!1);const o=`${(0,a.g)(n.portal)}content/items/${n.id}/data`,[t]=await(0,l.l)(["esri/request"]);return await t(o,{query:{f:"json"},method:"get",responseType:"json",token:null===(i=n.portal.credential)||void 0===i?void 0:i.token}).then((async i=>{var n,o,t,s,a,u,d;const c=i.data;if(!c)return Promise.resolve(!1);if(null==c?void 0:c.layers){const[i,v]=await(0,l.l)(["esri/layers/support/fieldUtils","esri/renderers/support/jsonUtils"]),p=c.layers.find((r=>r.id===e.layerId)),g=null===(o=null===(n=null==p?void 0:p.layerDefinition)||void 0===n?void 0:n.drawingInfo)||void 0===o?void 0:o.renderer,y=null===(a=null===(s=null===(t=null==p?void 0:p.layerDefinition)||void 0===t?void 0:t.featureReduction)||void 0===s?void 0:s.drawingInfo)||void 0===a?void 0:a.renderer;if(!g&&!y)return Promise.resolve(!1);if(g){const n=v.fromJSON(g),o=await i.getRendererFields(n,e.fieldsIndex);if(null==o?void 0:o.includes(r.name))return Promise.resolve(!0);const t=null===(u=null==p?void 0:p.layerDefinition)||void 0===u?void 0:u.definitionExpression;if(t){const[e]=await(0,l.l)(["esri/core/sql"]);if(null===(d=(await e.parseWhereClause(t)).fieldNames)||void 0===d?void 0:d.includes(r.name))return Promise.resolve(!0)}}if(y){const n=v.fromJSON(y),o=await i.getRendererFields(n),[t]=await(0,l.l)(["esri/layers/support/FeatureReductionBinning"]),s=t.fromJSON(p.layerDefinition.featureReduction);if(f(s,o).includes(r.name))return Promise.resolve(!0);if((await m(e,s,o,i)).includes(r.name))return Promise.resolve(!0)}}return Promise.resolve(!1)}),(()=>Promise.resolve(!1)))}(r,i);if(F)return Promise.resolve(!1);const k=await async function(e,r){var i,n,o;const t=e.sourceJSON,s=null===(i=null==t?void 0:t.drawingInfo)||void 0===i?void 0:i.renderer,a=null===(o=null===(n=null==t?void 0:t.featureReduction)||void 0===n?void 0:n.drawingInfo)||void 0===o?void 0:o.renderer;if(!s&&!a)return Promise.resolve(!1);const[u,d]=await(0,l.l)(["esri/layers/support/fieldUtils","esri/renderers/support/jsonUtils"]);if(s){const e=d.fromJSON(s),i=await u.getRendererFields(e);if(null==i?void 0:i.includes(r.name))return Promise.resolve(!0)}if(a){const i=d.fromJSON(a),n=await u.getRendererFields(i),[o]=await(0,l.l)(["esri/layers/support/FeatureReductionBinning"]),s=o.fromJSON(t.featureReduction);if(f(s,n).includes(r.name))return Promise.resolve(!0);if((await m(e,s,n,u)).includes(r.name))return Promise.resolve(!0)}return Promise.resolve(!1)}(r,i);if(k)return Promise.resolve(!1);const R=function(e,r,i){var n,o,t,s,l;const a=null===(t=null===(o=null===(n=e.map)||void 0===n?void 0:n.applicationProperties)||void 0===o?void 0:o.viewing)||void 0===t?void 0:t.search;if(a){const e=null===(s=a.layers)||void 0===s?void 0:s.find((e=>e.id===r.id));if(e){const r=null===(l=null==e?void 0:e.field)||void 0===l?void 0:l.name;if(r)return r===i.name}}return!1}(e,r,i);if(R)return Promise.resolve(!1);const T=r.relationships;if((null==T?void 0:T.map((e=>e.keyField))).includes(i.name))return Promise.resolve(!1);const $=(0,t.u)(y,y.portal.user),x=null!==(d=await(0,t.j)(r))&&void 0!==d?d:[],O=null!==(c=await(0,t.k)(r))&&void 0!==c?c:[],N=(0,t.m)(x,O);if(!$&&!N)return Promise.resolve(!1);const j=await(0,t.n)(y.id,y.portal,{relationshipType:"Service2Service"});if(null===(p=null==j?void 0:j.data)||void 0===p?void 0:p.relatedItems){if(j.data.relatedItems.some((e=>["WMTS","Map Service","Vector Tile Service"].includes(e.type))))return Promise.resolve(!1)}return Promise.resolve(!0)}async function v(e,r,i){var n,o;const[t]=await(0,l.l)(["esri/core/sql"]),a="layer"===i?null===(n=e.labelingInfo)||void 0===n?void 0:n.filter((e=>(0,s.i)(e.where))):null===(o=e.featureReduction.labelingInfo)||void 0===o?void 0:o.filter((e=>(0,s.i)(e.where)));if(!(null==a?void 0:a.length))return Promise.resolve(!1);const u=[...await Promise.all(a.map((async e=>{if(e.where)return await t.parseWhereClause(e.where)})))];let d=!1;for(let n=0;n<u.length;n++){const o="layer"===i?u[n].fieldNames:f(e.featureReduction,u[n].fieldNames);if(!d&&(null==o?void 0:o.includes(r.name))){d=!0;break}}return Promise.resolve(d)}function f(e,r){return e.fields.filter((e=>r.includes(e.name)||r.includes(e.name.toLowerCase()))).map((e=>e.onStatisticField))}async function m(e,r,i,n){const o=i.map((e=>{var i;return null===(i=r.fields.find((r=>r.name.toLowerCase()===e.toLowerCase())).onStatisticExpression)||void 0===i?void 0:i.expression})),t=await n.getExpressionFields(e,o);return Promise.resolve(t)}},11246:(e,r,i)=>{i.d(r,{a:()=>u,b:()=>v,c:()=>o,d:()=>n,e:()=>t,f:()=>d,g:()=>f,i:()=>s,m:()=>l,t:()=>a,u:()=>c});const n=(e,r)=>{let i,n="idle";const o=(...o)=>new Promise((t=>{switch(n){case"flushed":n="idle",i?(clearTimeout(i),t(e(...o))):t(null);break;case"invoked":clearTimeout(i),n="idle",t(e(...o));break;case"cancelled":clearTimeout(i),n="idle",t(null);break;default:i&&clearTimeout(i),n="pending",i=setTimeout((()=>(n="idle",t(e(...o)))),r)}}));return o.flush=function(...e){return n="flushed",o(...e)},o.invoke=function(...e){return n="invoked",o(...e)},o.cancel=function(...e){return n="cancelled",o(...e)},o.getStatus=function(){return n},o},o=(e,r)=>{let i;return(...n)=>new Promise((o=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,o(e(...n))}),r))}))};function t(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function s(e){return null!=e}async function l(e,r){return await Promise.all([e,a(r)]),e}function a(e){return new Promise((r=>setTimeout(r,e)))}const u=(e,r)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:n}=r(e);return[i,n]}))),d=(e,r)=>e.length===r.length&&e.reduce(((e,i)=>e&&r.indexOf(i)>-1),!0);function c(e,r){const i=[],n={};return e.forEach((e=>{const o=r(e);null==n[o]&&(n[o]=e,i.push(e))})),i}function v(e){const r={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let n=typeof e;return n in r?!r[n].hasOwnProperty(e)&&(r[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const f=(e,r)=>[...Array(Math.ceil(e.length/r))].map(((i,n)=>e.slice(r*n,r+r*n)))},11935:(e,r,i)=>{i.d(r,{c:()=>a});var n=i(7263);const o=e=>!("isConnected"in e)||e.isConnected,t=((e,r)=>{let i;return(...n)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...n)}),r)}})((e=>{for(let r of e.keys())e.set(r,e.get(r).filter(o))}),2e3),s=e=>"function"==typeof e?e():e,l=(e,r)=>{const i=e.indexOf(r);i>=0&&(e[i]=e[e.length-1],e.length--)},a=(e,r)=>{const i=((e,r=((e,r)=>e!==r))=>{const i=s(e);let n=new Map(Object.entries(null!=i?i:{}));const o={dispose:[],get:[],set:[],reset:[]},t=()=>{var r;n=new Map(Object.entries(null!==(r=s(e))&&void 0!==r?r:{})),o.reset.forEach((e=>e()))},a=e=>(o.get.forEach((r=>r(e))),n.get(e)),u=(e,i)=>{const t=n.get(e);r(i,t,e)&&(n.set(e,i),o.set.forEach((r=>r(e,i,t))))},d="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,r)=>a(r),ownKeys:e=>Array.from(n.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,r)=>n.has(r),set:(e,r,i)=>(u(r,i),!0)}),c=(e,r)=>(o[e].push(r),()=>{l(o[e],r)});return{state:d,get:a,set:u,on:c,onChange:(r,i)=>{const n=c("set",((e,n)=>{e===r&&i(n)})),o=c("reset",(()=>i(s(e)[r])));return()=>{n(),o()}},use:(...e)=>{const r=e.reduce(((e,r)=>(r.set&&e.push(c("set",r.set)),r.get&&e.push(c("get",r.get)),r.reset&&e.push(c("reset",r.reset)),r.dispose&&e.push(c("dispose",r.dispose)),e)),[]);return()=>r.forEach((e=>e()))},dispose:()=>{o.dispose.forEach((e=>e())),t()},reset:t,forceUpdate:e=>{const r=n.get(e);o.set.forEach((i=>i(e,r,r)))}}})(e,r);return i.use((()=>{if("function"!=typeof n.g)return{};const e=new Map;return{dispose:()=>e.clear(),get:r=>{const i=(0,n.g)();i&&((e,r,i)=>{const n=e.get(r);n?n.includes(i)||n.push(i):e.set(r,[i])})(e,r,i)},set:r=>{const i=e.get(r);i&&e.set(r,i.filter(n.f)),t(e)},reset:()=>{e.forEach((e=>e.forEach(n.f))),t(e)}}})()),i}},2174:(e,r,i)=>{i.d(r,{a:()=>l,b:()=>s,c:()=>d,d:()=>c,e:()=>v,f:()=>p,g:()=>I,h:()=>g,i:()=>a,j:()=>w,k:()=>P,l:()=>y,m:()=>b,n:()=>S,o:()=>m,p:()=>h,q:()=>f,u:()=>u});var n=i(28926),o=i(94788);function t(e){var r;return!!(null===(r=e.owner)||void 0===r?void 0:r.toLowerCase().includes("esri"))}function s(e){var r;return t(e)&&!!(null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("Requires Credits"))}function l(e){var r;return t(e)&&!!(null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("Requires Subscription"))}function a(e,r){return e.owner===r.username}function u(e,r){return a(e,r)||function(e,r){var i;if(null!=e.isAdmin)return!!e.isAdmin;const n=e.owner,o="admin"===e.itemControl,t=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(i=e.portal)||void 0===i?void 0:i.isPortal)&&!a(e,r)&&o&&n.includes("esri_")&&!t.includes(n))return!1;return o}(e,r)}const d=(e,r)=>!!r.orgId&&e.every((e=>e.isOrgItem)),c=(e,r)=>`${(0,o.a)(r)}item.html?id=${e}`,v=(e,r)=>`${(0,o.g)(r)}/content/users/${e}`,f=e=>e.reduce(((e,r)=>(e[r.owner]=e[r.owner]?[...e[r.owner],r.id]:[r.id],e)),{});function m(e){var r;return null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("Spatiotemporal")}function p(e){var r;return null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("View Service")}function g(e){var r;return null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("Hosted Service")}function y(e){var r;return null===(r=e.typeKeywords)||void 0===r?void 0:r.includes("Multi Services View")}function h(e){return(null==e?void 0:e.hasViews)&&!e.sourceSchemaChangesAllowed}async function w(e){var r;const i=null==e?void 0:e.portalItem;if(!i)return Promise.resolve(null);const t=i.portal,[s]=await(0,n.l)(["esri/request"]);if(null==t?void 0:t.user){return s(`${(0,o.g)(t)}community/users/${t.user.username}`,{query:{f:"json",token:null===(r=i.portal.credential)||void 0===r?void 0:r.token},responseType:"json"}).then((e=>{var r,i;const n=null!==(i=null===(r=e.data)||void 0===r?void 0:r.groups)&&void 0!==i?i:[];return Promise.resolve(n)}),(()=>Promise.reject()))}return Promise.resolve(null)}async function P(e){var r;const i=null==e?void 0:e.portalItem;if(!i)return Promise.resolve(null);const t=i.portal,[s]=await(0,n.l)(["esri/request"]);return s(`${(0,o.g)(t)}content/items/${i.id}/groups`,{query:{f:"json",token:null===(r=i.portal.credential)||void 0===r?void 0:r.token},responseType:"json"}).then((e=>{var r,i,n,o,t,s;const l=[...null!==(i=null===(r=e.data)||void 0===r?void 0:r.admin)&&void 0!==i?i:[],...null!==(o=null===(n=e.data)||void 0===n?void 0:n.member)&&void 0!==o?o:[],...null!==(s=null===(t=e.data)||void 0===t?void 0:t.other)&&void 0!==s?s:[]];return Promise.resolve(l)}),(()=>Promise.reject()))}async function S(e,r,{relationshipType:i,direction:t}){const s=`${(0,o.g)(r)}content/items/${e}/relatedItems`,[l]=await(0,n.l)(["esri/request"]);return await l(s,{query:{f:"json",relationshipType:i,direction:t},method:"get",responseType:"json"})}function b(e,r){return null==e?void 0:e.some((e=>null==r?void 0:r.some((r=>e.id===r.id&&e.capabilities.includes("updateitemcontrol")))))}const I=(e,r)=>`${r}/content/items/${e}`},94788:(e,r,i)=>{i.d(r,{a:()=>f,b:()=>v,c:()=>h,d:()=>w,e:()=>p,f:()=>t,g:()=>y,h:()=>s,i:()=>g,p:()=>c,r:()=>a,s:()=>o,t:()=>m,v:()=>u});var n=i(31670);const o=/\+|\?|\/|\(|\)|\\|\!|\#|\"|\||\*|\:|<|>|\%|\$|\@|\'|\^|\[|\]|\,|\=|\;/gi,t=/(\.|outputFormat=)json|geojson$/i,s=/\/ags\//gi,l="MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|SceneServer|VectorTileServer|StreamServer|WorkspaceServer|GeoenrichmentServer|VideoServer",a=new RegExp(`http.+/(${l})`),u="/arcgis/rest/services|/rest/services|/arcgis/services|/arcgis/rest",d=new RegExp(`(?<server>http.+(?:${u})(?:/?.*/(?<name>.*)/(?<type>${l})))(?!.*/${l})/?(?<soe>\\d+)?.*`,"i"),c=e=>{const r=e.match(d);if(!r){return e.match(s)?{baseServerUrl:e,serverName:null,serverType:"MapServer",index:null}:null}const[,i,n,o,t]=r,l=parseInt(t);return{baseServerUrl:i,serverName:n,serverType:o,index:isNaN(l)?null:l}},v=e=>{if(!e)return null;if(!e.match(u))return null;const r=e.split("/rest");return r.length<2?null:`${r[0]}/rest/`},f=e=>e&&"/"!==e.charAt(e.length-1)?`${e}/`:e,m=({path:e,url:r})=>{const i=r.split("/"),n=e.split("/");return i.slice(0,i.length-n.length).join("/")};function p(e){const{customBaseUrl:r,portalHostname:i,urlKey:n}=e,{protocol:o}=window.location;return`${o}//${n?`${n}.${r}`:i}`}function g(e){var r,i;return null!==(r=null==e?void 0:e.isWebTierAuth)&&void 0!==r?r:null===(i=e.sourceJSON)||void 0===i?void 0:i.isWebTierAuth}function y(e){var r;const{portal:i,config:o}=n.c||{};return null!==(r=f(null==o?void 0:o.restBaseUrl))&&void 0!==r?r:h(e||i)}function h(e){var r;return f(null!==(r=e.restUrl)&&void 0!==r?r:e.portalUrl)}function w(e){var r,i,n;return(null===(i=null===(r=null==e?void 0:e.user)||void 0===r?void 0:r.sourceJSON)||void 0===i?void 0:i.culture)||(null===(n=null==e?void 0:e.sourceJSON)||void 0===n?void 0:n.culture)||navigator.language||"en-US"}}}]);