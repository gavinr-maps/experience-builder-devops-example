/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d9f5e2.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-d9f5e2"],{1612:(e,t,i)=>{i.r(t),i.d(t,{arcgis_sketch_layer_editor:()=>F,arcgis_sketch_layer_editor_content:()=>R,arcgis_sketch_layer_editor_shortcuts:()=>V,arcgis_sketch_layer_editor_snapping:()=>N,arcgis_sketch_layer_editor_tools:()=>U});var o=i(7263),l=i(62159),s=i(58233),n=i(28926),r=i(81457),a=i(11246),c=i(94278),h=i(11935),d=i(77040),p=i(1991),u=i(84537);i(70506),i(78613),i(99004);const g=["#ff4040","#ff8202","#faa83e","#ffd159","#73b566","#008977","#33e3c8","#43abeb","#4b64c9","#9868ed","#b055e6","#db5181","#e03b99","#2b2b2b","#bdbdbd","#ffffff"],m=["#ffffff","#bdbdbd","#2b2b2b","#e03b99","#db5181","#b055e6","#9868ed","#4b64c9","#43abeb","#33e3c8","#008977","#73b566","#ffd159","#faa83e","#ff8202","#ff4040"];function y(e){var t,i;switch(null===(t=null==e?void 0:e.geometry)||void 0===t?void 0:t.type){case"point":return"text"===(null===(i=null==e?void 0:e.symbol)||void 0===i?void 0:i.type)?"text":"point";case"polyline":return"polyline";default:return"polygon"}}const f=(e,t)=>{const i=[...new Set([...e.featureSources.filter((e=>e.enabled)).map((e=>e.layer.id))])],o={enabled:e.enabled,selfEnabled:e.selfEnabled,featureEnabled:e.featureEnabled,featureSourcesIds:i};(0,r.b)(t,o,!0)},b=async(e,t)=>{const i=await async function(e){const[t]=await(0,n.l)(["esri/core/CollectionFlattener"]),{map:i}=e,{allLayers:o}=i,l=new t({getCollections:()=>[o],getChildrenFunction:e=>"layers"in e?e.layers:"sublayers"in e?e.sublayers:null,itemFilterFunction:e=>!e.isTable});return[...new Set(l.toArray())]}(e);return i.filter((e=>t.includes(e.id))).map((e=>({layer:e,enabled:!0})))},S=e=>e&&((0,r.a)(e.webmap,!0)||(0,r.a)(e.current,!0))||null;class k{constructor(e,t,i,o,l,s,n){this.mapNotesLayer=e,this.mapView=t,this.sketchViewModelPoint=new i({layer:this.mapNotesLayer.pointLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:o,tooltipOptions:l}),this.sketchViewModelPoint.on("create",(e=>s(e,this.sketchViewModelPoint))),this.sketchViewModelPoint.on("update",(e=>n(e))),this.sketchViewModelLine=new i({layer:this.mapNotesLayer.polylineLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:o,tooltipOptions:l}),this.sketchViewModelLine.on("create",(e=>s(e,this.sketchViewModelLine))),this.sketchViewModelLine.on("update",(e=>n(e))),this.sketchViewModelPolygon=new i({layer:this.mapNotesLayer.polygonLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:o,tooltipOptions:l}),this.sketchViewModelPolygon.on("create",(e=>s(e,this.sketchViewModelPolygon))),this.sketchViewModelPolygon.on("update",(e=>n(e))),this.sketchViewModelText=new i({layer:this.mapNotesLayer.textLayer,view:this.mapView,defaultCreateOptions:{hasZ:!1,mode:"hybrid"},updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},snappingOptions:o,tooltipOptions:l}),this.sketchViewModelText.on("create",(e=>s(e,this.sketchViewModelText))),this.sketchViewModelText.on("update",(e=>n(e)))}delete(){this._deletePoint(),this._deleteLine(),this._deletePolygon(),this._deleteText()}cancel(){this._cancelPoint(),this._cancelLine(),this._cancelPolygon(),this._cancelText()}duplicate(){this._duplicatePoint(),this._duplicateLine(),this._duplicatePolygon(),this._duplicateText()}updateOnGraphic(e,t){var i;null===(i=this.hitTestHandle)||void 0===i||i.remove(),e&&(this.hitTestHandle=this.mapView.on("click",(async e=>{const i=(await this.mapView.hitTest(e,{include:this.mapNotesLayer})).results;if(i.length){const e=["point","polyline","polygon"];i.sort((function(t,i){return e.indexOf(t.graphic.geometry.type)-e.indexOf(i.graphic.geometry.type)}));const t=i[0].graphic;switch(t.layer){case this.mapNotesLayer.pointLayer:this.updatePoint([t]);break;case this.mapNotesLayer.textLayer:this.updateText([t]);break;case this.mapNotesLayer.polylineLayer:this.updateLine([t]);break;case this.mapNotesLayer.polygonLayer:this.updatePolygon([t]);default:return}}else t&&t({state:"complete"})})))}destroy(){this._destroyPoint(),this._destroyLine(),this._destroyPolygon(),this._destroyText()}getPointSVM(){return this.sketchViewModelPoint}getPoint(){return this.sketchViewModelPoint.pointSymbol}setPoint(e){this.sketchViewModelPoint.pointSymbol=e}createPoint(){this.sketchViewModelPoint.create("point")}updatePoint(e){this.sketchViewModelPoint.update(e)}_deletePoint(){this.sketchViewModelPoint.delete()}_cancelPoint(){this.sketchViewModelPoint.cancel()}_duplicatePoint(){this.sketchViewModelPoint.duplicate()}_destroyPoint(){this.sketchViewModelPoint.destroy()}getLineSVM(){return this.sketchViewModelLine}getLine(){return this.sketchViewModelLine.polylineSymbol}setLine(e){this.sketchViewModelLine.polylineSymbol=e}createLine(){this.sketchViewModelLine.create("polyline")}updateLine(e){this.sketchViewModelLine.update(e)}_deleteLine(){this.sketchViewModelLine.delete()}_cancelLine(){this.sketchViewModelLine.cancel()}_duplicateLine(){this.sketchViewModelLine.duplicate()}_destroyLine(){this.sketchViewModelLine.destroy()}getPolygonSVM(){return this.sketchViewModelPolygon}getPolygon(){return this.sketchViewModelPolygon.polygonSymbol}setPolygon(e){this.sketchViewModelPolygon.polygonSymbol=e}createPolygon(e){this.sketchViewModelPolygon.create(e)}updatePolygon(e){this.sketchViewModelPolygon.update(e)}_deletePolygon(){this.sketchViewModelPolygon.delete()}_cancelPolygon(){this.sketchViewModelPolygon.cancel()}_duplicatePolygon(){this.sketchViewModelPolygon.duplicate()}_destroyPolygon(){this.sketchViewModelPolygon.destroy()}getTextSVM(){return this.sketchViewModelText}getText(){return this.sketchViewModelText.pointSymbol}setText(e){this.sketchViewModelText.pointSymbol=e}createText(){this.sketchViewModelText.create("point")}updateText(e){this.sketchViewModelText.update(e)}_deleteText(){this.sketchViewModelText.delete()}_cancelText(){this.sketchViewModelText.cancel()}_duplicateText(){this.sketchViewModelText.duplicate()}_destroyText(){this.sketchViewModelText.destroy()}}function v(e){if(!function(e){var t,i,o,l,s,n;const r=e.data.symbol.symbolLayers;if(1===r.length){const e=r[0];if("CIMVectorMarker"!==e.type||e.colorLocked)return!1;const o=null===(i=null===(t=e.markerGraphics[0])||void 0===t?void 0:t.symbol)||void 0===i?void 0:i.symbolLayers;return 1===e.markerGraphics.length&&E(o)}if(2===r.length){const e=r[0],t=r[1];if("CIMVectorMarker"!==e.type||"CIMVectorMarker"!==t.type||e.colorLocked||e.size>t.size)return!1;const i=null===(l=null===(o=e.markerGraphics[0])||void 0===o?void 0:o.symbol)||void 0===l?void 0:l.symbolLayers,a=null===(n=null===(s=t.markerGraphics[0])||void 0===s?void 0:s.symbol)||void 0===n?void 0:n.symbolLayers;return 1===e.markerGraphics.length&&1===t.markerGraphics.length&&E(i)&&function(e){return function(e){return null==e?void 0:e.find((e=>"CIMSolidFill"===e.type))}(e)&&L(e)}(a)}return!1}(e))return;const t=e.data.symbol.symbolLayers;return t[t.length-1].markerGraphics[0].symbol.symbolLayers.find((e=>"CIMSolidStroke"===e.type))}function w(e){return"cim"===e.type?c.e.cimSymbolUtils.getCIMSymbolSize(e):"text"===e.type?e.font.size:(0,a.i)(e.size)?e.size:e.width}function C(e,t){if("cim"===e.type)!function(e){return"CIMPolygonSymbol"===e.data.symbol.type}(e)?c.e.cimSymbolUtils.scaleCIMSymbolTo(e,t):function(e,t){var i;null===(i=e.data.symbol.symbolLayers)||void 0===i||i.forEach((e=>{["CIMSolidStroke","CIMPictureStroke"].indexOf(e.type)>-1&&(e.width=t)}))}(e,t);else if((0,a.i)(e.size))e.size=t;else{const i=e.height/e.width;e.width=t,e.height=e.width*i}}function I(e){return"cim"===e.type?c.e.cimSymbolUtils.getCIMSymbolRotation(e,!0):["simple-marker","picture-marker"].indexOf(e.type)>-1?e.angle:void 0}function P(e,t){(0,a.i)(t)&&("cim"===e.type?c.e.cimSymbolUtils.applyCIMSymbolRotation(e,t,!0):["simple-marker","picture-marker"].indexOf(e.type)>-1&&(e.angle=t))}function T(e){var t,i;return"cim"===(null==e?void 0:e.type)?c.e.Color.fromJSON(null===(t=c.e.cimSymbolUtils.getCIMSymbolColor(e))||void 0===t?void 0:t.toJSON()):"simple-marker"===(null==e?void 0:e.type)&&["x","cross"].indexOf(null==e?void 0:e.style)>-1?null===(i=null==e?void 0:e.outline)||void 0===i?void 0:i.color:null==e?void 0:e.color}function M(e){return"cim"===(null==e?void 0:e.type)?function(e){var t;if("picture-marker"===e.type)return;return"CIMPolygonSymbol"===(null===(t=e.data.symbol)||void 0===t?void 0:t.type)?function(e){const t=e.data.symbol.symbolLayers;return t.find((e=>"CIMSolidStroke"===e.type))}(e):void 0}(e):null==e?void 0:e.outline}function E(e){return function(e){return null==e?void 0:e.find((e=>"CIMSolidFill"===e.type&&!e.colorLocked))}(e)&&L(e)}function L(e){return null==e?void 0:e.find((e=>"CIMSolidStroke"===e.type))}const x=(e,t)=>{const i={enabled:e.enabled};(0,r.b)(t,i,!0)},O=e=>e&&((0,r.a)(e.webmap,!0)||(0,r.a)(e.current,!0))||null,A=(0,h.c)({mapView:null,portal:null,layer:null,strings:null,currentLanguage:"",sketchMessage:"",svModel:null,snappingOptions:null,sketchTooltipOptions:null,snappingSessionStorageIds:null,sketchTooltipSessionStorageIds:null}).state,F=class{constructor(e){(0,o.r)(this,e),this.sketchUpdated=(0,o.c)(this,"sketchUpdated",7),this.arcgisSketchDismissedChange=(0,o.c)(this,"arcgisSketchDismissedChange",7),this.arcgisSketchCopyToNewSketchLayer=(0,o.c)(this,"arcgisSketchCopyToNewSketchLayer",7),this.arcgisRecentColorsUpdate=(0,o.c)(this,"arcgisRecentColorsUpdate",7),this.internalSketchUpdated=(0,o.c)(this,"internalSketchUpdated",7),this.closeSketchPopovers=(0,o.c)(this,"closeSketchPopovers",7),this.closePopupPopovers=(0,o.c)(this,"closePopupPopovers",7),this.sketchContentReRender=(0,o.c)(this,"sketchContentReRender",7),this.disableSketchPanel=(0,o.c)(this,"disableSketchPanel",7),this.closeSketchSnappingPopovers=(0,o.c)(this,"closeSketchSnappingPopovers",7),this.sketchActionOnSelectFeatures=(0,o.c)(this,"sketchActionOnSelectFeatures",7),this.sketchMode="update",this.escKey=!1,this.keepSelectionMessage="",this.keepSelectionTool=null,this.deleteInProgress=!1,this.needsMapViewHandles=!1,this.onGraphicUpdate=e=>{var t,i;if("start"===e.state)if(this.mapView.closePopup(),this.multipleSelectedGraphics.length<=1&&this.newSketchLayerFeatures.length<=1&&1===e.graphics.length)this.currentSketchInfo.graphics=[e.graphics[0]],this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,!this.multipleSelectedGraphics.length&&this.multipleSelectedGraphics.push(this.currentSketchInfo.graphics[0]),this.currentSketchInfo.tool=y(this.currentSketchInfo.graphics[0]),this.currentSketchInfo.popup=this.currentSketchInfo.graphics[0].popupTemplate,this.currentSketchInfo.title=(null===(t=this.currentSketchInfo.graphics[0].attributes)||void 0===t?void 0:t.title)||this.defaultGraphicTitle(),this.sketchContentReRender.emit(),this.showSketchContent=!0;else if(this.multipleSelectedGraphics.length||this.newSketchLayerFeatures.length){this.currentSketchInfo.graphics=this.multipleSelectedGraphics.length?this.multipleSelectedGraphics:this.newSketchLayerFeatures,this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=y(this.currentSketchInfo.graphics[0]);const e=(null===(i=this.currentSketchInfo.graphics[0].attributes)||void 0===i?void 0:i.title)||this.defaultGraphicTitle(),t=this.currentSketchInfo.graphics.every((t=>{var i;return(null===(i=t.attributes)||void 0===i?void 0:i.title)===e})),o=this.currentSketchInfo.graphics[0].popupTemplate,l=this.currentSketchInfo.graphics.every((e=>JSON.stringify(e.popupTemplate)===JSON.stringify(o)));this.currentSketchInfo.title=t?e:null,this.currentSketchInfo.popup=l?o:null,this.sketchContentReRender.emit(),this.showSketchContent=!0}else this.sketchMessageHandler(null);if("complete"===e.state){const{keepSelectionTool:e}=this;this.newSketchLayerFeatures=[];const t=e!==this.sketchToolsEl.activeSelectTool;!e||t?(this.currentSketchInfo.graphics=null,this.multipleSelectedGraphics=[],this.closeSketchPopovers.emit(),this.internalSketchUpdated.emit(),this.sketchContentReRender.emit()):!this.deleteInProgress&&this.keepSelectToolSelection()}},this.mapView=void 0,this.layer=void 0,this.portal=void 0,this.dismissible=!1,this.snappingSessionStorageIds=void 0,this.sketchTooltipSessionStorageIds=void 0,this.activeSketchTool=void 0,this.sketchToolsToHide=[],this.hideSelectionTools=!1,this.selectedSketchFeaturesFeatures=void 0,this.mapNotesFeature=null,this.showSketchToolsOnly=!1,this.sketchToolsReferenceElement=void 0,this.currentSketchInfo={tool:null,symbol:null,graphics:null,popup:null,title:null,sourceIds:{}},this.multipleSelectedGraphics=[],this.newSketchLayerFeatures=[],this.showSketchContent=!0}async componentWillLoad(){var e;[this.strings,this.currentLanguage]=await(0,l.g)(this.hostElement),await this.loadAllModules(),await this.initializeSessionStorageOptions(),this.initializeSVModel(),A.svModel=this.svModel,A.mapView=this.mapView,A.layer=this.layer,A.portal=this.portal,A.strings=this.strings,A.currentLanguage=this.currentLanguage,A.snappingOptions=this.snappingOptions,A.sketchTooltipOptions=this.sketchTooltipOptions,A.snappingSessionStorageIds=this.snappingSessionStorageIds,A.sketchTooltipSessionStorageIds=this.sketchTooltipSessionStorageIds,this.mapNotesFeature&&(this.selectedSketchFeaturesFeatures=[this.mapNotesFeature]),(null===(e=this.selectedSketchFeaturesFeatures)||void 0===e?void 0:e.length)&&(this.multipleSelectedGraphics=this.selectedSketchFeaturesFeatures.filter((e=>(0,a.i)(e))),this.currentSketchInfo.graphics=this.multipleSelectedGraphics,this.updateCurrentSketchInfo())}componentDidLoad(){this.needsMapViewHandles&&(this.mapView.focus(),this.watchDeleteOnMapView(!0),this.watchEscapeOnMapView(!0)),this.mapView.popupEnabled=!1,this.createSketchTools()}disconnectedCallback(){var e;this.watchEscapeOnMapView(!1),this.watchDeleteOnMapView(!1),this.svModel.updateOnGraphic(!1),this.removeSketchShortcuts(),null===(e=this.selectorOperation)||void 0===e||e.cancel(),this.removeSketchShortcutsTooltip()}arcgisSketchActiveSymbolChangeHandler(){this.sketchContentReRender.emit()}closeSketchPopoversHandler(){this.closePopupPopovers.emit(),this.sketchToolsEl.activeSelectTool&&"select"!==this.sketchToolsEl.activeSelectTool&&this.sketchMessageHandler(null),this.showSketchContent=!1,this.closeSketchSnappingPopovers.emit(),this.removeSketchShortcuts(),this.setFocus()}closeSketchSnappingPopoversHandler(){this.sketchSnappingEl&&(document.body.removeChild(this.sketchSnappingEl),this.sketchSnappingEl=null,this.disableSketchPanel.emit(!1)),this.setFocus()}disableSketchPanelHandler(e){e.stopPropagation(),this.sketchFlowItemEl.disabled=e.detail}internalSketchUpdatedHandler(e){e.stopPropagation(),this.sketchUpdated.emit()}sketchGraphicUpdatesHandler(e){var t,i,o,l,s;e.stopPropagation();const n=e.detail;if(n.update){if("symbol"===n.type&&n.symbolSwitchFromRecent){const e=null===(t=T(this.currentSketchInfo.symbol.clone()))||void 0===t?void 0:t.toHex();e&&this.arcgisRecentColorsUpdate.emit(e)}if("update"===this.sketchMode&&(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)){const e=this.currentSketchInfo.graphics.length>1,t=this.currentSketchInfo.graphics[0].symbol.clone(),i=this.currentSketchInfo.symbol.clone(),s=w(t),r=I(t),h=T(t),d=M(t),p=null===(o=t.outline)||void 0===o?void 0:o.style,u=t.style,g=t.marker,m=w(i),y=I(i),f=T(i),b=M(i),S=null===(l=i.outline)||void 0===l?void 0:l.style,k=i.style,v=i.marker;this.currentSketchInfo.graphics.forEach(((t,i)=>{if("title"===n.type&&(t.attributes?this.currentSketchInfo.graphics[i].attributes.title=this.currentSketchInfo.title:this.currentSketchInfo.graphics[i].attributes={title:this.currentSketchInfo.title}),"popup"===n.type&&(this.currentSketchInfo.graphics[i].popupTemplate=this.currentSketchInfo.popup),"symbol"===n.type)if(!e||n.symbolSwitchFromRecent){const e=this.currentSketchInfo.symbol.clone();"recent-text"===n.textProp&&(e.text=this.currentSketchInfo.graphics[i].symbol.clone().text),this.currentSketchInfo.graphics[i].symbol=e}else if(n.symbolSwitch){const e=this.currentSketchInfo.symbol.clone(),t=this.currentSketchInfo.graphics[i].symbol.clone();(0,a.i)(w(t))&&(0,a.i)(w(e))&&C(e,w(t)),(0,a.i)(I(t))&&(0,a.i)(I(e))&&P(e,I(t)),this.currentSketchInfo.graphics[i].symbol=e}else{const e=this.currentSketchInfo.graphics[i].symbol.clone(),t=this.currentSketchInfo.symbol.clone();if(s!==m&&C(e,w(t)),r!==y&&P(e,I(t)),JSON.stringify(h)!==JSON.stringify(f)){const i=T(e),s=T(t);h.a===f.a?(i.r=s.r,i.g=s.g,i.b=s.b):i.a=s.a,l=i,"picture-marker"!==(o=e).type&&("cim"===o.type?c.e.cimSymbolUtils.applyCIMSymbolColor(o,l):"simple-marker"===o.type&&o.style&&["cross","x"].indexOf(o.style)>-1?(o.outline||(o.outline=new __esri.SimpleLineSymbol),o.outline.color=l):o.color=l)}if((0,a.i)(d)&&(0,a.i)(b)&&JSON.stringify(d)!==JSON.stringify(b)){const i=M(e),o=M(t),l=d.color.a===b.color.a;d.width===b.width?l?(i.color.r=o.color.r,i.color.g=o.color.g,i.color.b=o.color.b):i.color.a=o.color.a:i.width=o.width,function(e,t){"cim"===e.type?e.data.symbol.symbolLayers.forEach(((i,o)=>{"CIMSolidStroke"===i.type&&(e.data.symbol.symbolLayers[o]=t)})):e.outline=t}(e,i)}if(JSON.stringify(p)!==JSON.stringify(S)&&e.outline&&(e.outline.style=S),JSON.stringify(u)!==JSON.stringify(k)&&(e.style=k),JSON.stringify(g)!==JSON.stringify(v)&&(e.marker=v),n.textProp)switch(n.textProp){case"text":e.text=t.text;break;case"font":e.font.family=t.font.family,e.font.weight=t.font.weight,e.font.style=t.font.style;break;case"font-size":e.font.size=t.font.size;break;case"color":e.color.r=t.color.r,e.color.g=t.color.g,e.color.b=t.color.b;break;case"color-transparency":e.color.a=t.color.a;break;case"rotation":e.angle=t.angle;break;case"halo":e.haloColor=t.haloColor,e.haloSize=t.haloSize;break;case"halo-color":e.haloColor?(e.haloColor.r=t.haloColor.r,e.haloColor.g=t.haloColor.g,e.haloColor.b=t.haloColor.b):e.haloColor=t.haloColor;break;case"halo-color-transparency":e.haloColor&&(e.haloColor.a=t.haloColor.a);break;case"halo-size":e.haloSize=t.haloSize;break;case"background":e.backgroundColor=t.backgroundColor,e.borderLineColor=t.borderLineColor,e.borderLineSize=t.borderLineSize;break;case"background-color":e.backgroundColor?(e.backgroundColor.r=t.backgroundColor.r,e.backgroundColor.g=t.backgroundColor.g,e.backgroundColor.b=t.backgroundColor.b):e.backgroundColor=t.backgroundColor;break;case"background-color-transparency":e.backgroundColor&&(e.backgroundColor.a=t.backgroundColor.a);break;case"border-line-color":e.borderLineColor?(e.borderLineColor.r=t.borderLineColor.r,e.borderLineColor.g=t.borderLineColor.g,e.borderLineColor.b=t.borderLineColor.b):(e.backgroundColor=t.backgroundColor,e.borderLineColor=t.borderLineColor,e.borderLineSize=t.borderLineSize);break;case"border-line-color-transparency":e.borderLineColor&&(e.borderLineColor.a=t.borderLineColor.a);break;case"border-line-size":e.borderLineSize=t.borderLineSize}this.currentSketchInfo.graphics[i].symbol=e}var o,l}))}else this.tempCreatedGraphic&&(this.tempCreatedGraphic.attributes?this.tempCreatedGraphic.attributes.title=this.currentSketchInfo.title:this.tempCreatedGraphic.attributes={title:this.currentSketchInfo.title},this.tempCreatedGraphic.popupTemplate=this.currentSketchInfo.popup,this.tempCreatedGraphic.symbol=this.currentSketchInfo.symbol);this.mapView.popup.features=[null===(s=this.currentSketchInfo.graphics)||void 0===s?void 0:s[0]],this.setCurrentSketchSymbol()}n.close&&(this.clearHighlightAndPopup(),this.closeSketchPopovers.emit(),this.svModel.cancel(),this.svModel.updateOnGraphic(!1),this.setFocus()),this.internalSketchUpdated.emit()}async sketchActionOnDrawFeaturesHandler({detail:{tool:e,sketchMessage:t}}){switch(this.clearHighlightAndPopup(),this.watchEscapeOnMapView(!0),this.watchDeleteOnMapView(!1),"update"===this.sketchMode&&this.closeSketchPopovers.emit(),this.sketchMessageHandler(t),this.sketchMode="continuous",this.svModel.cancel(),this.svModel.updateOnGraphic(!1),this.tempCreatedGraphic=null,this.currentSketchInfo.graphics=null,this.currentSketchInfo.tool=e,e){case"point":this.svModel.setPoint(await(async(e,t,i)=>{const o=await i.getBackgroundColorTheme(t);return new e({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,colorLocked:!0,anchorPoint:{x:0,y:-1.75},anchorPointUnits:"Relative",size:5.7,frame:{xmin:0,ymin:0,xmax:84.3,ymax:84.3},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[83.2,32.5],[84.3,40.7],[83.8,48.9],[81.7,56.9],[78.1,64.3],[73,70.9],[66.9,76.4],[59.7,80.5],[51.9,83.2],[43.7,84.3],[35.4,83.8],[27.4,81.7],[20,78],[13.4,73],[7.9,66.8],[3.8,59.7],[1.1,51.9],[0,43.7],[.5,35.4],[2.6,27.4],[6.3,20],[11.3,13.4],[17.5,7.9],[24.7,3.8],[32.5,1.1],[39.8,.1],[47.1,.3],[54.3,1.8],[61.1,4.5],[67.4,8.4],[72.9,13.3],[77.4,19.1],[80.9,25.5],[83.2,32.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:"light"===o?[242,242,242,255]:[255,255,255,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,rotation:0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-.5},anchorPointUnits:"Relative",size:15,frame:{xmin:0,ymin:0,xmax:197.7,ymax:294.7},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[98.9,0],[119.4,23.2],[139.4,49.3],[156.8,75.2],[171.2,100.8],[182.4,125.3],[190.6,148.8],[195.7,171.4],[197.7,192.9],[197.7,195.8],[197.7,200.3],[197.6,202.5],[197.5,204.8],[197.3,207.1],[197,209.4],[196.7,211.7],[196.4,214.1],[196,216.4],[195.5,218.7],[195,221.1],[194.4,223.4],[193.7,225.8],[193,228.1],[192.2,230.5],[191.4,232.8],[190.5,235.1],[189.5,237.5],[188.5,239.7],[187.4,242],[186.2,244.3],[185,246.5],[183.7,248.7],[182.4,250.9],[181,253.1],[179.5,255.2],[178,257.3],[176.4,259.4],[174.7,261.4],[173.1,263.3],[171.3,265.3],[169.5,267.2],[167.7,269],[165.8,270.8],[163.9,272.5],[161.9,274.2],[159.9,275.8],[157.8,277.4],[155.7,278.9],[153.6,280.4],[151.4,281.7],[149.2,283.1],[147,284.4],[144.8,285.6],[142.5,286.7],[140.3,287.8],[138,288.8],[135.7,289.8],[133.4,290.7],[131,291.5],[128.7,292.3],[126.4,293],[124,293.6],[121.7,294.2],[119.4,294.7],[117,295.2],[114.7,295.6],[112.4,296],[110.1,296.3],[107.8,296.5],[105.5,296.7],[103.3,296.8],[101.1,296.9],[98.8,296.9],[83.1,295.7],[67.8,292],[53.3,285.9],[39.9,277.5],[28.1,267.2],[18,255.1],[10,241.5],[4.2,226.9],[.9,211.5],[0,195.8],[.1,192.9],[2.1,171.4],[7.2,148.8],[15.4,125.3],[26.6,100.8],[41,75.2],[58.4,49.3],[78.4,23.2],[98.9,0]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:"light"===o?[17,26,40,255]:[186,186,186,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,rotation:0}],scaleX:1,angleAlignment:"Display",angle:0}}})})(this.CIMSymbol,this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.svModel.getPoint(),this.svModel.createPoint();break;case"polyline":this.svModel.setLine(await(async(e,t)=>({type:"simple-line",color:"light"===await t.getBackgroundColorTheme(e)?[0,0,0]:[255,255,255],width:.75}))(this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.svModel.getLine(),this.svModel.createLine();break;case"polygon":case"rectangle":case"circle":this.svModel.setPolygon(await(async(e,t)=>{const i=await t.getBackgroundColorTheme(e);return{type:"simple-fill",color:"light"===i?[0,0,0,.25]:[255,255,255,.25],style:"solid",outline:{color:"light"===i?[0,0,0]:[255,255,255],width:.75}}})(this.mapView,this.ColorUtils)),this.currentSketchInfo.symbol=this.svModel.getPolygon(),this.svModel.createPolygon(e);break;case"text":this.svModel.setText(await(async(e,t,i,o)=>{const l=await t.getBackgroundColor(e),s=await t.getBackgroundColorTheme(e);return new i({text:o,color:"light"===s?[0,0,0]:"dark"===s?[255,255,255]:l||[0,0,0],haloColor:null,haloSize:.75,font:{size:16.5,family:"Arial",weight:"bold"},lineWidth:512})})(this.mapView,this.ColorUtils,this.TextSymbol,this.strings.text)),this.currentSketchInfo.symbol=this.svModel.getText(),this.svModel.createText()}this.currentSketchInfo.popup=null,this.currentSketchInfo.title=this.defaultGraphicTitle(),this.sketchContentReRender.emit(e),this.showSketchContent=!0}async sketchActionOnSelectFeaturesHandler({detail:{sketchMessage:e,multipleSelectTool:t}}){var i,o;this.keepSelectionMessage=e,this.keepSelectionTool=t,this.clearHighlightAndPopup(),this.watchEscapeOnMapView(!1),this.closeSketchPopovers.emit(),this.tempCreatedGraphic=null,this.currentSketchInfo.graphics=null,this.currentSketchInfo.symbol=null,this.currentSketchInfo.tool=null,(null===(i=this.selectedSketchFeaturesFeatures)||void 0===i?void 0:i.length)||(this.watchDeleteOnMapView(!1),this.multipleSelectedGraphics=[]),this.svModel.cancel(),this.sketchMode="update",this.sketchMessageHandler(this.keepSelectionMessage),this.sketchContentReRender.emit(),this.keepSelectionTool?this.actionOnMultipleSelections(this.keepSelectionTool):(null===(o=this.selectorOperation)||void 0===o||o.cancel(),this.svModel.updateOnGraphic(!0))}arcgisSketchPanelLoaderHandler(e){e.stopPropagation(),this.sketchFlowItemEl.loading=e.detail}async done(){var e,t,i;this.removeHighlight(),(null===(e=this.snappingSessionStorageIds)||void 0===e?void 0:e.current)&&f(this.snappingOptions,this.snappingSessionStorageIds.current),(null===(t=this.sketchTooltipSessionStorageIds)||void 0===t?void 0:t.current)&&x(this.sketchTooltipOptions,this.sketchTooltipSessionStorageIds.current),this.closeSketchPopovers.emit(),this.svModel.destroy(),null===(i=this.sketchToolsEl)||void 0===i||i.remove(),this.sketchToolsEl=void 0,this.removeSketchShortcuts(),this.mapView.popupEnabled=!0}async activateLayer(e,t){var i,o;if(null===(i=this.svModel)||void 0===i||i.destroy(),this.layer=e,this.initializeSessionStorageOptions(),this.initializeSVModel(),t&&(this.newSketchLayerFeatures=t.map((e=>e.clone()))),null===(o=this.newSketchLayerFeatures)||void 0===o?void 0:o.length){let e=[],t=[],i=[],o=[];this.newSketchLayerFeatures.forEach((l=>{switch(y(l)){case"polyline":l.layer=this.layer.polylineLayer,t=[...t,l];break;case"polygon":l.layer=this.layer.polygonLayer,i=[...i,l];break;case"text":l.layer=this.layer.textLayer,o=[...o,l];break;default:l.layer=this.layer.pointLayer,e=[...e,l]}})),this.currentSketchInfo.graphics=this.newSketchLayerFeatures,this.updateCurrentSketchInfo(),setTimeout((()=>{e.length&&this.svModel.updatePoint(e),t.length&&this.svModel.updateLine(t),i.length&&this.svModel.updatePolygon(i),o.length&&this.svModel.updateText(o),this.sketchMode="update"}),300)}}async setFocus(e){var t;"dismiss-button"!==e||null===(t=this.dismissButtonEl)||void 0===t||t.setFocus()}async clearHighlights(){this.removeHighlight()}async initializeSessionStorageOptions(){var e;this.snappingOptions=await(async(e,t,i,o)=>{const l=S(e)||{enabled:!0,selfEnabled:!0,featureEnabled:!0,featureSourcesIds:[t.id]};return new o({enabled:l.enabled,selfEnabled:l.selfEnabled,featureEnabled:l.featureEnabled,featureSources:await b(i,l.featureSourcesIds)})})(this.snappingSessionStorageIds,this.layer,this.mapView,this.SnappingOptions),this.sketchTooltipOptions=(e=this.sketchTooltipSessionStorageIds,new(0,this.SketchTooltipOptions)({enabled:(O(e)||{enabled:!1}).enabled}))}initializeSVModel(){this.svModel=new k(this.layer,this.mapView,this.SketchViewModel,this.snappingOptions,this.sketchTooltipOptions,((e,t)=>this.onGraphicCreate(e,t)),this.onGraphicUpdate)}updateCurrentSketchInfo(){var e;this.currentSketchInfo.symbol=this.currentSketchInfo.graphics[0].symbol,this.currentSketchInfo.tool=y(this.currentSketchInfo.graphics[0]);const t=(null===(e=this.currentSketchInfo.graphics[0].attributes)||void 0===e?void 0:e.title)||this.defaultGraphicTitle(),i=this.currentSketchInfo.graphics.every((e=>{var i;return(null===(i=e.attributes)||void 0===i?void 0:i.title)===t})),o=this.currentSketchInfo.graphics[0].popupTemplate,l=this.currentSketchInfo.graphics.every((e=>JSON.stringify(e.popupTemplate)===JSON.stringify(o)));this.currentSketchInfo.title=i?t:null,this.currentSketchInfo.popup=l?o:null,this.showSketchContent=!0,this.svModel.updateOnGraphic(!0,this.onGraphicUpdate),this.needsMapViewHandles=!0}async updateSketchTools(){this.sketchToolsEl&&(this.sketchToolsEl.sketchToolsToHide=this.sketchToolsToHide,this.sketchToolsEl.hideSelectionTools=this.hideSelectionTools,this.sketchToolsEl.activeSketchTool=this.activeSketchTool)}createSketchTools(){var e;this.sketchToolsEl=document.createElement("arcgis-sketch-layer-editor-tools"),this.sketchToolsEl.sketchToolsToHide=this.sketchToolsToHide,this.sketchToolsEl.activeSketchTool=this.activeSketchTool,this.sketchToolsEl.hideSelectionTools=this.hideSelectionTools,this.sketchToolsEl.refElement=null!==(e=this.sketchToolsReferenceElement)&&void 0!==e?e:this.hostElement,this.selectedSketchFeaturesFeatures&&(this.sketchToolsEl.mapNotesFeatures=this.selectedSketchFeaturesFeatures,this.sketchToolsEl.activeSelectTool=1===this.multipleSelectedGraphics.length?"select":"rectangle"),document.body.appendChild(this.sketchToolsEl),this.sketchContentEl&&!this.sketchContentEl.symbolStylerRefElement&&(this.sketchContentEl.symbolStylerRefElement=this.dismissButtonEl)}async loadAllModules(){[this.SketchViewModel,this.TextSymbol,this.ColorUtils,this.CIMSymbol,this.SnappingOptions,this.SketchTooltipOptions,this.SelectionOperation,this.drawUtils]=await(0,n.l)(["esri/widgets/Sketch/SketchViewModel","esri/symbols/TextSymbol","esri/views/support/colorUtils","esri/symbols/CIMSymbol","esri/views/interactive/snapping/SnappingOptions","esri/views/interactive/sketch/SketchTooltipOptions","esri/widgets/support/Selector2D/SelectionOperation","esri/views/draw/support/drawUtils"])}setCurrentSketchSymbol(){"point"===this.currentSketchInfo.tool?this.svModel.setPoint(this.currentSketchInfo.symbol):"text"===this.currentSketchInfo.tool?this.svModel.setText(this.currentSketchInfo.symbol):"polyline"===this.currentSketchInfo.tool?this.svModel.setLine(this.currentSketchInfo.symbol):["circle","polygon","rectangle"].indexOf(this.currentSketchInfo.tool)>-1&&this.svModel.setPolygon(this.currentSketchInfo.symbol)}removeSketchShortcuts(){this.arcgisSketchShortcuts&&(this.arcgisSketchShortcuts.removeEventListener("arcgisSketchShortcutsDismissedChange",(()=>this.removeSketchShortcuts())),document.body.removeChild(this.arcgisSketchShortcuts),this.arcgisSketchShortcuts=null)}onGraphicCreate(e,t){if("start"===e.state&&(this.tempCreatedGraphic=null,this.removeHighlight()),"cancel"===e.state&&this.escKey){this.escKey=!1;const e="text"===this.currentSketchInfo.tool?"point":this.currentSketchInfo.tool;t.create(e)}if("complete"===e.state){this.internalSketchUpdated.emit(),e.graphic&&(e.graphic.popupTemplate=this.currentSketchInfo.popup,e.graphic.attributes={title:this.currentSketchInfo.title},this.currentSketchInfo.graphics=[e.graphic],this.tempCreatedGraphic=e.graphic,this.highlightGraphic(e.graphic));const i="text"===this.currentSketchInfo.tool?"point":this.currentSketchInfo.tool;t.create(i)}}watchEscapeOnMapView(e){var t;e&&!this.watchEscapeHandle?this.watchEscapeHandle=this.mapView.on("key-down",(e=>{"Escape"!==e.key||"active"!==this.svModel.getPointSVM().state&&"active"!==this.svModel.getLineSVM().state&&"active"!==this.svModel.getPolygonSVM().state&&"active"!==this.svModel.getTextSVM().state||(e.stopPropagation(),this.escKey=!0,this.svModel.cancel())})):(null===(t=this.watchEscapeHandle)||void 0===t||t.remove(),this.watchEscapeHandle=void 0)}watchDeleteOnMapView(e){var t;e&&!this.watchDeleteHandle?this.watchDeleteHandle=this.mapView.on("key-down",(e=>{"Delete"!==e.key&&"Backspace"!==e.key||(this.deleteInProgress=!0,this.svModel.delete(),this.deleteInProgress=!1,this.keepSelectToolSelection())})):(null===(t=this.watchDeleteHandle)||void 0===t||t.remove(),this.watchDeleteHandle=void 0)}defaultGraphicTitle(){switch(this.currentSketchInfo.tool){case"point":default:return this.strings.point;case"polyline":return this.strings.line;case"polygon":return this.strings.polygon;case"rectangle":return this.strings.rectangle;case"circle":return this.strings.circle;case"text":return this.strings.text}}clearHighlightAndPopup(){this.removeHighlight(),this.mapView.closePopup()}actionOnMultipleSelections(e){this.selectedSketchFeaturesFeatures=null;const t=[this.layer.pointLayer,this.layer.polylineLayer,this.layer.polygonLayer,this.layer.textLayer],i="rectangle"===e?{createTool:"rectangle"}:{createTool:"polygon",mode:"freehand"};(this.selectorOperation=new this.SelectionOperation({view:this.mapView,sources:t,options:i})).once("complete",(e=>{const{selection:t}=e;if(this.clearHighlightAndPopup(),!e.aborted&&t.length){let e=[],i=[],o=[],l=[];t.forEach((t=>{switch(y(t)){case"point":default:e=[...e,t];break;case"polyline":i=[...i,t];break;case"polygon":o=[...o,t];break;case"text":l=[...l,t]}})),this.multipleSelectedGraphics=[...e,...i,...o,...l],e.length&&this.svModel.updatePoint(e),i.length&&this.svModel.updateLine(i),o.length&&this.svModel.updatePolygon(o),l.length&&this.svModel.updateText(l),this.watchDeleteOnMapView(!0)}})),this.svModel.updateOnGraphic(!1)}sketchMessageHandler(e){A.sketchMessage=e}highlightGraphic(e){var t;this.removeHighlight();const i=null===(t=this.mapView.allLayerViews)||void 0===t?void 0:t.items.find((({layer:e})=>e===this.layer));this.createdGraphicHighlightHandle=null==i?void 0:i.highlight(e)}removeHighlight(){var e;null===(e=this.createdGraphicHighlightHandle)||void 0===e||e.remove(),this.createdGraphicHighlightHandle=void 0}keepSelectToolSelection(){this.sketchToolsEl.activeSelectTool&&this.sketchActionOnSelectFeatures.emit({sketchMessage:this.keepSelectionMessage,multipleSelectTool:this.keepSelectionTool})}addSketchShortcutsTooltip(){const e=this.sketchShortcutsTooltipEl=document.createElement("calcite-tooltip");e.referenceElement=this.sketchShortcutsEl,e.open=!0,e.innerHTML=this.strings.sketchShortcuts,document.body.append(e)}removeSketchShortcutsTooltip(){var e;this.sketchShortcutsTooltipEl&&(null===(e=this.sketchShortcutsTooltipEl.parentElement)||void 0===e||e.removeChild(this.sketchShortcutsTooltipEl),this.sketchShortcutsTooltipEl=null)}offsetDuplicatedFeatures(){this.multipleSelectedGraphics.forEach((e=>this.drawUtils.move(e.geometry,15*this.mapView.resolution,15*this.mapView.resolution)));let e=[],t=[],i=[],o=[];this.selectedSketchFeaturesFeatures=this.multipleSelectedGraphics,this.multipleSelectedGraphics.forEach((l=>{switch(y(l)){case"polyline":t=[...t,l];break;case"polygon":i=[...i,l];break;case"text":o=[...o,l];break;default:e=[...e,l]}})),this.currentSketchInfo.graphics=this.multipleSelectedGraphics,e.length&&this.svModel.updatePoint(e),t.length&&this.svModel.updateLine(t),i.length&&this.svModel.updatePolygon(i),o.length&&this.svModel.updateText(o)}renderSketchFlowPanel(){var e,t,i,l;const n=(0,o.h)("calcite-action",{text:"close",scale:"m",icon:"x",slot:"header-actions-end",ref:e=>this.dismissButtonEl=e,onClick:e=>{e.stopPropagation(),this.sketchMessageHandler(null),this.svModel.cancel(),this.clearHighlightAndPopup(),this.arcgisSketchDismissedChange.emit()}}),r=(0,o.h)("calcite-label",{alignment:"center",for:"multiple-selection-buttons"},(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)<=1?this.strings.singleFeatureSelected:this.strings.featuresSelected.replace("${number}",null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t.length.toString())),a=(0,o.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"trash",kind:"danger",width:"full",onClick:e=>{e.stopPropagation(),this.deleteInProgress=!0,this.svModel.delete(),this.deleteInProgress=!1,this.multipleSelectedGraphics=[],this.keepSelectToolSelection()}},this.strings.delete),c=(0,o.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"copy",kind:"neutral",width:"full",onClick:e=>{e.stopPropagation(),this.newSketchLayerFeatures=this.currentSketchInfo.graphics.map((e=>e.clone())),this.arcgisSketchCopyToNewSketchLayer.emit({features:this.newSketchLayerFeatures})}},this.strings.copyToNewSketchLayer),h=(0,o.h)("calcite-button",{appearance:"outline-fill",alignment:"center",iconStart:"duplicate",kind:"neutral",width:"full",onClick:e=>{e.stopPropagation(),this.svModel.duplicate(),this.offsetDuplicatedFeatures()}},this.strings.duplicate),d=(0,o.h)("div",{class:"snapping",ref:e=>this.shortcutSnappingDiv=e},(0,o.h)("calcite-button",{appearance:"outline-fill",class:"sketch-keyboard-button",kind:"neutral",iconStart:"keyboard",scale:"l",label:this.strings.sketchShortcuts,onClick:()=>{this.removeSketchShortcutsTooltip(),this.arcgisSketchShortcuts||(this.arcgisSketchShortcuts=document.createElement("arcgis-sketch-layer-editor-shortcuts"),this.arcgisSketchShortcuts.refElement=this.shortcutSnappingDiv,document.body.appendChild(this.arcgisSketchShortcuts),this.arcgisSketchShortcuts.addEventListener("arcgisSketchShortcutsDismissedChange",(()=>this.removeSketchShortcuts())))},onMouseOver:()=>this.addSketchShortcutsTooltip(),onMouseOut:()=>this.removeSketchShortcutsTooltip(),ref:e=>this.sketchShortcutsEl=e}),(0,o.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",width:"full",iconStart:"gear",iconEnd:"chevron-down",scale:"l",label:this.strings.settings,onClick:e=>{e.stopPropagation(),this.sketchSnappingEl||(this.sketchSnappingEl=document.createElement("arcgis-sketch-layer-editor-snapping"),this.sketchSnappingEl.refElement=this.shortcutSnappingDiv,document.body.appendChild(this.sketchSnappingEl),this.disableSketchPanel.emit(!0))}},this.strings.settings)),p=(0,o.h)("div",{class:A.sketchMessage&&"sketch-message"},(0,o.h)("calcite-notice",{width:"full",open:!(!A.sketchMessage||(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)>1)},(0,o.h)("div",{slot:"message"},A.sketchMessage)));return(0,o.h)("calcite-flow",{ref:e=>this.flowEl=e,dir:(0,s.g)(this.hostElement),class:"rtl"===(0,s.g)(this.hostElement)?s.C.rtl:""},(0,o.h)("calcite-flow-item",{ref:e=>this.sketchFlowItemEl=e,heading:this.strings.sketch,disabled:!this.layer.capabilities.operations.supportsMapNotesEditing},this.dismissible&&n,d,p,(null===(l=this.currentSketchInfo.graphics)||void 0===l?void 0:l.length)?(0,o.h)("div",{class:"multiple-selection"},r,(0,o.h)("div",{id:"multiple-selection-buttons",class:"buttons"},h,c,a)):null,this.showSketchContent&&(0,o.h)("arcgis-sketch-layer-editor-content",{currentSketchInfo:this.currentSketchInfo,flowEl:this.flowEl,symbolStylerRefElement:this.dismissButtonEl,ref:e=>this.sketchContentEl=e})))}render(){return(0,o.h)(o.H,{key:"a649bdeb92b3ea3fabf462fc3fee11b119c946af",class:"calcite-match-height"},!this.showSketchToolsOnly&&this.renderSketchFlowPanel())}get hostElement(){return(0,o.d)(this)}};F.style=":host{display:flex;flex:1 1 auto;overflow:hidden}.sketch-delete-button{padding:var(--arcgis-app-cap-spacing-third)}.snapping{display:flex;padding:var(--arcgis-app-cap-spacing-half);background-color:var(--arcgis-app-background)}.sketch-message{padding:var(--arcgis-app-cap-spacing-half)}.sketch-keyboard-button{margin-right:0.3em}.multiple-selection{margin:1.3em}.multiple-selection calcite-button{margin-top:0.3em}.arcgis--rtl .sketch-keyboard-button{margin-right:unset;margin-left:0.3em}";const R=class{constructor(e){(0,o.r)(this,e),this.sketchGraphicUpdates=(0,o.c)(this,"sketchGraphicUpdates",7),this.arcgisSketchPanelLoader=(0,o.c)(this,"arcgisSketchPanelLoader",7),this.disableSketchPanel=(0,o.c)(this,"disableSketchPanel",7),this.arcgisSketchActiveSymbolChange=(0,o.c)(this,"arcgisSketchActiveSymbolChange",7),this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();this.narrow=t.contentRect.width<=275,this.reRender=!this.reRender})),this.divNodes=[],this.symbolNodes=[],this.suggestedFillColors=[],this.savedColors=[],this.percentLabelFlip=!1,this.narrow=!1,this.storePointStyler=e=>{e&&(this.pointStyler=e,this.startPointEdit())},this.storePolylineStyler=e=>{e&&(this.polylineStyler=e,this.startPolylineEdit())},this.storePolygonStyler=e=>{e&&(this.polygonStyler=e,this.startPolygonEdit())},this.openFontPopover=()=>{var e;this.arcgisFontPicker||(this.disableSketchPanel.emit(!0),this.arcgisFontPicker=document.createElement("arcgis-font-picker"),this.arcgisFontPicker.fontMap=u.f,this.arcgisFontPicker.font=null===(e=this.currentSketchInfo.symbol)||void 0===e?void 0:e.font,this.arcgisFontPicker.popoverProps={refElement:this.hostElement},this.arcgisFontPicker.addEventListener("arcgisFontPickerDismissed",this.closeFontPopover),this.arcgisFontPicker.addEventListener("arcgisFontPickerChange",this.changeFont),document.body.appendChild(this.arcgisFontPicker))},this.closeFontPopover=()=>{this.arcgisFontPicker&&(this.disableSketchPanel.emit(!1),document.body.removeChild(this.arcgisFontPicker),this.arcgisFontPicker=null)},this.changeFont=e=>{var t;const i=e.detail;if(i){const e=null===(t=this.currentSketchInfo.symbol)||void 0===t?void 0:t.clone();e.font.family=i.family,e.font.weight=i.weight,e.font.style=i.style,this.updateSymbol(e,!1,!1,"font"),this.reRender=!this.reRender}},this.updateRotation=(0,a.d)((()=>{if(!this.rotationEl)return;clearTimeout(this.rotationValueHandle);const e=parseInt(this.rotationEl.value);!e||e<this.rotationEl.min||e>this.rotationEl.max?this.rotationValueHandle=setTimeout((()=>this.handleTextPropChange(this.rotationEl,"rotation")),3e3):this.handleTextPropChange(this.rotationEl,"rotation")}),500),this.currentSketchInfo=void 0,this.flowEl=void 0,this.symbolStylerRefElement=void 0,this.storageId=void 0,this.reRender=!0}async componentWillLoad(){this.arcgisSketchPanelLoader.emit(!0),await this.loadAllModules(),g.forEach((e=>this.suggestedFillColors.push(new this.Color(e)))),m.forEach((e=>this.savedColors.push(new this.Color(e)))),this.mapView=A.mapView,this.strings=A.strings,this.currentLanguage=A.currentLanguage,this.portal=A.portal,this.flowEl||(this.flowEl=(0,p.q)(this.hostElement,"calcite-flow"));const e=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols",t=(0,r.g)(e,!0);t&&(this.recentSymbols=[...t]);const i=(0,s.g)(this.hostElement),o=new Intl.NumberFormat(this.currentLanguage,{style:"percent"}).format(0);this.percentLabelFlip="rtl"===i?o.endsWith("%"):o.startsWith("%")}componentDidLoad(){this.arcgisSketchPanelLoader.emit(!1),this.flowEl&&this.resizeObserver.observe(this.flowEl)}disconnectedCallback(){clearTimeout(this.fontSizeValueHandle),clearTimeout(this.rotationValueHandle),clearTimeout(this.haloSizeValueHandle),clearTimeout(this.borderLineSizeValueHandle),this.flowEl&&this.resizeObserver.unobserve(this.flowEl)}calciteFlowItemBackHandler(e){e.stopPropagation(),this.mapView.closePopup(),this.sketchPopupFlowItem=null}sketchContentReRenderHandler(e){e.stopPropagation(),(0,a.i)(e.detail)&&(this.storageId=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(e.detail)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${e.detail}-symbols`:"arcgis-sketch-recent-point-symbols",this.recentSymbols=(0,r.g)(this.storageId,!0)),this.reRender=!this.reRender,this.sketchPopupFlowItem&&(this.flowEl.back(),this.sketchPopupFlowItem=null);const{tool:t}=this.currentSketchInfo;"point"===t?this.startPointEdit():"polyline"===t?this.startPolylineEdit():["circle","polygon","rectangle"].includes(t)&&this.startPolygonEdit()}popupUpdatedHandler({detail:{mapNotesPopuptemplate:e}}){this.currentSketchInfo.popup=e,this.sketchGraphicUpdates.emit({type:"popup",update:!0,close:!1})}async loadAllModules(){[this.Color,this.cimSymbolUtils,this.symbolUtils,this.CIMSymbol,this.SimpleLineSymbol,this.SimpleFillSymbol,this.PictureMarkerSymbol,this.PictureFillSymbol,this.TextSymbol]=await(0,n.l)(["esri/Color","esri/symbols/support/cimSymbolUtils","esri/symbols/support/symbolUtils","esri/symbols/CIMSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/PictureMarkerSymbol","esri/symbols/PictureFillSymbol","esri/symbols/TextSymbol"])}updateSymbol(e,t,i,o,l,s){var n;const c=this.currentSketchInfo.symbol.clone(),h=e.clone(),d=w(this.currentSketchInfo.symbol)!==w(e);if(this.currentSketchInfo.symbol=e.clone(),"recent-text"===o&&(this.currentSketchInfo.symbol.text=c.text),this.sketchGraphicUpdates.emit({type:"symbol",update:!0,close:!1,symbolSwitch:t,symbolSwitchFromRecent:i,textProp:o}),l)this.arcgisSketchActiveSymbolChange.emit();else if((!d||t||i)&&!s){"text"===h.type&&(h.text=this.strings.textPreview);const e=null===(n=this.recentSymbols)||void 0===n?void 0:n.filter((e=>JSON.stringify(e)!==JSON.stringify(h))),t=(0,a.i)(e)?[h,...e].slice(0,5):[h],i=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols";(0,r.s)(i,t,!0),this.recentSymbols=t,this.arcgisSketchActiveSymbolChange.emit()}}applyCimOutline(e,t){const i=v(e);if(!i)return;const o=t.color.toRgba();o[3]*=255,i.color=o,i.width=t.size}getCimOutlineProps(e){var t;const i=v(e);return{color:new this.Color(null==i?void 0:i.color),size:null!==(t=null==i?void 0:i.width)&&void 0!==t?t:1}}getPopoverProps(e){var t;const i=null===(t=this.flowEl)||void 0===t?void 0:t.getBoundingClientRect();return{placement:e?"bottom-start":"bottom-end",offsetDistance:10,offsetSkidding:e?3:-3,overlayPositioning:"fixed",maxHeight:i&&i.height-65+"px",refElement:this.symbolStylerRefElement}}startPointEdit(){var e,t;const i="cim"===this.currentSketchInfo.symbol.type,o=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1;null===(t=this.pointStyler)||void 0===t||t.edit(this.currentSketchInfo.symbol.clone(),{sections:{marker:{open:!0,symbolsOpen:!0,sizeOpen:!1,rotationOpen:!1,markerType:["cim:vector","custom"],keepChoice:!0,parts:{size:{autoSizeAdjust:!1},color:i&&o,transparency:i&&o}},fill:i&&{type:"color",optional:!0,suggestedColors:this.suggestedFillColors,savedColors:this.savedColors,open:!1,suggestedColorsOpen:!0},stroke:i&&{optional:!0,open:!1,type:"color",suggestedColors:this.suggestedFillColors,savedColors:this.savedColors}},marker:{size:i?this.cimSymbolUtils.getCIMSymbolSize(this.currentSketchInfo.symbol):"picture-marker"===this.currentSketchInfo.symbol.type?this.currentSketchInfo.symbol.width:25},fill:{color:i&&this.cimSymbolUtils.getCIMSymbolColor(this.currentSketchInfo.symbol)||this.suggestedFillColors[0]},stroke:i&&this.getCimOutlineProps(this.currentSketchInfo.symbol),fillEnabled:i,strokeEnabled:i,portal:this.createPortalProp()})}startPolylineEdit(){var e,t,i,o,l,s;const n="cim"===this.currentSketchInfo.symbol.type,r=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1;null===(t=this.polylineStyler)||void 0===t||t.edit(this.currentSketchInfo.symbol.clone(),{sections:{stroke:{type:"color",open:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!0,autoStrokeAdjust:!1}},marker:{parts:{size:{autoSizeAdjust:!1},color:n&&r,transparency:n&&r}}},stroke:{color:(null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.color)||this.savedColors[1],size:(null===(o=this.currentSketchInfo.symbol)||void 0===o?void 0:o.width)||10,style:(null===(l=this.currentSketchInfo.symbol)||void 0===l?void 0:l.style)||"solid",marker:null===(s=this.currentSketchInfo.symbol)||void 0===s?void 0:s.marker},portal:this.createPortalProp()})}createPortalProp(){return{portal:this.portal,before:async(e,t)=>{await e.load(),t.originalStylesGroupQuery2d=e.stylesGroupQuery2d,e.stylesGroupQuery2d=e.isPortal?'title:"Esri Sketch Styles" AND owner:esri_webstyles':'title:"Esri Sketch Styles" AND owner:esri_en'},after:async(e,t)=>{e.stylesGroupQuery2d=t.originalStylesGroupQuery2d}}}startPolygonEdit(){var e,t,i,o,l,s,n;const r="cim"===this.currentSketchInfo.symbol.type,c=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,h=!(null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t.every((e=>(0,a.i)(M(e.symbol)))));null===(i=this.polygonStyler)||void 0===i||i.edit(this.currentSketchInfo.symbol.clone(),{sections:{fill:{type:"color",open:!0,optional:!0,suggestedColorsOpen:!0,transparencyOpen:!1,suggestedColors:this.suggestedFillColors},stroke:{type:"color",open:!1,optional:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!h,autoStrokeAdjust:!1}},marker:{parts:{size:{autoSizeAdjust:!1},color:r&&c,transparency:r&&c}}},fill:{color:this.currentSketchInfo.symbol.color||this.suggestedFillColors[0]},stroke:{color:(null===(o=this.currentSketchInfo.symbol.outline)||void 0===o?void 0:o.color)||this.suggestedFillColors[0],size:(null===(l=this.currentSketchInfo.symbol.outline)||void 0===l?void 0:l.width)||10,style:(null===(s=this.currentSketchInfo.symbol.outline)||void 0===s?void 0:s.style)||"solid",autoAdjusted:!1},fillEnabled:!!this.currentSketchInfo.symbol.color,strokeEnabled:!!(null===(n=this.currentSketchInfo.symbol)||void 0===n?void 0:n.outline),portal:this.createPortalProp()})}handleTextPropChange(e,t){var i;if(!e)return;let l=parseInt(e.value);isNaN(l)||l<e.min?l=e.min:l>e.max&&(l=e.max),e.value=`${l}`;const s=null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.clone();switch(t){case"font-size":s.font.size=.75*l;break;case"halo-size":s.haloSize=.75*l;break;case"rotation":s.angle=l;break;default:s.borderLineSize=.75*l}this.updateSymbol(s,!1,!1,t,!1,"rotation"!==t),(0,o.f)(this.hostElement)}handleRotationSliderValueChange(e,t){var i;const o=null===(i=this.currentSketchInfo.symbol)||void 0===i?void 0:i.clone();o.angle=e,this.updateSymbol(o,!1,!1,"rotation",t)}render(){var e,t,i,l,n,a,c,h,g,m,y,f,b,S,k,v,w,C,I,P,T,M,E,L;const x="rtl"===(0,s.g)(this.hostElement),O=(null===(e=this.currentSketchInfo.graphics)||void 0===e?void 0:e.length)>1,A=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0].geometry.type,F=null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.every((e=>A===e.geometry.type)),R=null===(l=this.currentSketchInfo.graphics)||void 0===l?void 0:l[0].symbol.type,V=null===(n=this.currentSketchInfo.graphics)||void 0===n?void 0:n.every((e=>R===e.symbol.type)),N=(null===(a=this.currentSketchInfo.graphics)||void 0===a?void 0:a.some((e=>"text"===e.symbol.type)))&&!(null===(c=this.currentSketchInfo.graphics)||void 0===c?void 0:c.every((e=>"text"===e.symbol.type))),U=(0,o.h)("arcgis-symbol-styler",{displaySymbolsSelectionOnly:O&&F&&!V,mode:O?"minimal":"default",key:"point-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.pointSourceId,ref:this.currentSketchInfo.symbol&&this.storePointStyler,popoverProps:this.getPopoverProps(x),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.pointSourceId=e}),z=(0,o.h)("arcgis-symbol-styler",{displaySymbolsSelectionOnly:O&&F&&!V,mode:O?"minimal":"default",key:"polyline-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.polylineSourceId,ref:this.currentSketchInfo.symbol&&this.storePolylineStyler,popoverProps:this.getPopoverProps(x),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polylineSourceId=e}),B=(0,o.h)("arcgis-symbol-styler",{displaySymbolsSelectionOnly:O&&F&&!V,mode:O?"minimal":"default",key:"polygon-styler",lang:this.currentLanguage,initialSourceId:this.currentSketchInfo.sourceIds.polygonSourceId,ref:this.currentSketchInfo.symbol&&this.storePolygonStyler,popoverProps:this.getPopoverProps(x),onArcgisSymbolStylerEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSymbolStylerSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polygonSourceId=e}),D=this.currentSketchInfo.symbol;let H,G;this.textContentEl&&(H=null==D?void 0:D.text,G=null===(h=this.currentSketchInfo.graphics)||void 0===h?void 0:h.every((e=>H===e.symbol.text)));const _=(0,o.h)("calcite-label",null,this.strings.content,(0,o.h)("calcite-text-area",{resize:"vertical",placeholder:this.strings.textContentPlaceholder,value:G?null==D?void 0:D.text:"",onCalciteTextAreaInput:e=>{e.stopPropagation();const t=null==D?void 0:D.clone();t.text=e.target.value,this.updateSymbol(t,!1,!1,"text")},ref:e=>this.textContentEl=e})),J=(0,o.h)("calcite-label",null,this.strings.font,(0,o.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",label:(0,u.b)((null==D?void 0:D.font)||{family:"Arial",style:"normal",weight:"normal"}),width:"full",scale:"m",onClick:this.openFontPopover},(0,u.b)(null==D?void 0:D.font))),$=(0,o.h)("calcite-label",null,this.strings.size,(0,o.h)("calcite-input-number",{scale:"s",min:5,max:125,value:`${(null===(g=null==D?void 0:D.font)||void 0===g?void 0:g.size)/.75||0}`,onCalciteInputNumberInput:e=>{clearTimeout(this.fontSizeValueHandle),e.stopPropagation();const t=parseInt(this.fontSizeEl.value);!t||t<this.fontSizeEl.min||t>this.fontSizeEl.max?this.fontSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.fontSizeEl,"font-size")),3e3):this.handleTextPropChange(this.fontSizeEl,"font-size")},ref:e=>this.fontSizeEl=e})),W=(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,this.strings.color,(0,o.h)("arcgis-color-input",{color:(null===(m=null==D?void 0:D.color)||void 0===m?void 0:m.toHex())||"#ffffff",popoverProps:this.getPopoverProps(x),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,i;const o=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.color)||void 0===t?void 0:t.a)&&void 0!==i?i:1;o.color=new this.Color(e.target.color),o.color.a=l,this.updateSymbol(o,!1,!1,"color",!1,!0)},onArcgisColorInputPopoverClose:e=>{var t,i;const o=e.detail;if(o){const e=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.color)||void 0===t?void 0:t.a)&&void 0!==i?i:1;e.color=new this.Color(o),e.color.a=l,this.updateSymbol(e,!1,!1,"color")}},onArcgisColorInputSwatchUpdate:e=>{var t,i;const o=e.detail;if(o){const e=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.color)||void 0===t?void 0:t.a)&&void 0!==i?i:1;e.color=new this.Color(o),e.color.a=l,this.updateSymbol(e,!1,!1,"color")}}})),(0,o.h)("calcite-label",null,this.strings.transparency,(0,o.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(f=null===(y=null==D?void 0:D.color)||void 0===y?void 0:y.a)&&void 0!==f?f:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,p.t)(t),o=null==D?void 0:D.clone();o.color.a=i,this.updateSymbol(o,!1,!1,"color-transparency")},withSteppers:!this.narrow,label:this.strings.transparency}))),j=(0,o.h)("calcite-label",null,this.strings.rotation,(0,o.h)("div",{class:"rotation"},(0,o.h)("calcite-slider",{min:0,max:360,value:(null==D?void 0:D.angle)||0,step:1,onCalciteSliderInput:e=>this.handleRotationSliderValueChange(e.target.value,!0),onCalciteSliderChange:e=>this.handleRotationSliderValueChange(e.target.value,!1)}),(0,o.h)("calcite-input-number",{scale:"s",min:0,max:360,suffixText:x?"":"\xba",prefixText:x?"\xba":"",step:1,value:`${(null==D?void 0:D.angle)||0}`,onCalciteInputNumberInput:this.updateRotation,ref:e=>this.rotationEl=e}))),K=(0,o.h)("calcite-block-section",{ref:e=>this.haloBlockSection=e,text:this.strings.halo,toggleDisplay:"switch",open:!!(null==D?void 0:D.haloColor),onCalciteBlockSectionToggle:e=>{e.stopPropagation();const t=null==D?void 0:D.clone();this.haloBlockSection.open?(t.haloColor=this.tempHaloColor||new this.Color("white"),t.haloSize=(null==t?void 0:t.haloSize)||.75):(this.tempHaloColor=t.haloColor,t.haloColor=null),this.updateSymbol(t,!1,!1,"halo")}},(0,o.h)("div",{class:"halo-block"},(0,o.h)("calcite-label",null,this.strings.color,(0,o.h)("arcgis-color-input",{color:(null===(b=null==D?void 0:D.haloColor)||void 0===b?void 0:b.toHex())||"#ffffff",popoverProps:this.getPopoverProps(x),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,i;const o=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.haloColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;o.haloColor=new this.Color(e.target.color),o.haloColor.a=l,this.updateSymbol(o,!1,!1,"halo-color")}})),(0,o.h)("calcite-label",null,this.strings.transparency,(0,o.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(k=null===(S=null==D?void 0:D.haloColor)||void 0===S?void 0:S.a)&&void 0!==k?k:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,p.t)(t),o=null==D?void 0:D.clone();o.haloColor.a=i,this.updateSymbol(o,!1,!1,"halo-color-transparency")},withSteppers:!this.narrow,label:this.strings.transparency})),(0,o.h)("calcite-label",null,this.strings.size,(0,o.h)("calcite-input-number",{scale:"s",min:1,max:10,value:`${(null==D?void 0:D.haloSize)/.75||0}`,onCalciteInputNumberInput:e=>{clearTimeout(this.haloSizeValueHandle),e.stopPropagation();const t=parseInt(this.haloSizeEl.value);!t||t<this.haloSizeEl.min||t>this.haloSizeEl.max?this.haloSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.haloSizeEl,"halo-size")),3e3):this.handleTextPropChange(this.haloSizeEl,"halo-size")},ref:e=>this.haloSizeEl=e})))),Z=(0,o.h)("calcite-block-section",{ref:e=>this.backgroundColorSection=e,text:this.strings.background,toggleDisplay:"switch",open:!!(null==D?void 0:D.backgroundColor),onCalciteBlockSectionToggle:e=>{var t;e.stopPropagation();const i=null==D?void 0:D.clone();this.backgroundColorSection.open?(i.backgroundColor=this.tempBackgroundColor||new this.Color("white"),i.borderLineColor=this.tempBorderLineColor||new this.Color("white"),i.borderLineSize=null!==(t=this.tempBorderLineSize)&&void 0!==t?t:.75):(this.tempBackgroundColor=i.backgroundColor,this.tempBorderLineColor=i.borderLineColor,this.tempBorderLineSize=i.borderLineSize,i.backgroundColor=null,i.borderLineColor=null,i.borderLineSize=null),this.updateSymbol(i,!1,!1,"background")}},(0,o.h)("div",{class:"background-color-block"},(0,o.h)("calcite-label",null,this.strings.color,(0,o.h)("arcgis-color-input",{color:(null===(v=null==D?void 0:D.backgroundColor)||void 0===v?void 0:v.toHex())||"#ffffff",popoverProps:this.getPopoverProps(x),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,i;const o=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;o.backgroundColor=new this.Color(e.target.color),o.backgroundColor.a=l,this.updateSymbol(o,!1,!1,"background-color",!1,!0)},onArcgisColorInputPopoverClose:e=>{var t,i;const o=e.detail;if(o){const e=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;e.backgroundColor=new this.Color(o),e.backgroundColor.a=l,this.updateSymbol(e,!1,!1,"background-color")}},onArcgisColorInputSwatchUpdate:e=>{var t,i;const o=e.detail;if(o){const e=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.backgroundColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;e.backgroundColor=new this.Color(o),e.backgroundColor.a=l,this.updateSymbol(e,!1,!1,"background-color")}}})),(0,o.h)("calcite-label",null,this.strings.transparency,(0,o.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(C=null===(w=null==D?void 0:D.backgroundColor)||void 0===w?void 0:w.a)&&void 0!==C?C:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,p.t)(t),o=null==D?void 0:D.clone();o.backgroundColor.a=i,this.updateSymbol(o,!1,!1,"background-color-transparency")},withSteppers:!this.narrow,label:this.strings.transparency})),(0,o.h)("calcite-label",null,this.strings.outlineColor,(0,o.h)("arcgis-color-input",{color:(null===(I=null==D?void 0:D.borderLineColor)||void 0===I?void 0:I.toHex())||"#ffffff",popoverProps:this.getPopoverProps(x),storageId:"arcgis-symbol-styler-storage-colors",onArcgisColorInputChange:e=>{var t,i;const o=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.borderLineColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;o.borderLineColor=new this.Color(e.target.color),o.borderLineColor.a=l,this.updateSymbol(o,!1,!1,"border-line-color",!1,!0)},onArcgisColorInputPopoverClose:e=>{var t,i;const o=e.detail;if(o){const e=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.borderLineColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;e.borderLineColor=new this.Color(o),e.borderLineColor.a=l,this.updateSymbol(e,!1,!1,"border-line-color")}},onArcgisColorInputSwatchUpdate:e=>{var t,i;const o=e.detail;if(o){const e=null==D?void 0:D.clone(),l=null!==(i=null===(t=null==D?void 0:D.borderLineColor)||void 0===t?void 0:t.a)&&void 0!==i?i:1;e.borderLineColor=new this.Color(o),e.borderLineColor.a=l,this.updateSymbol(e,!1,!1,"border-line-color")}}})),(0,o.h)("calcite-label",null,this.strings.outlineTransparency,(0,o.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,p.a)(null!==(T=null===(P=null==D?void 0:D.borderLineColor)||void 0===P?void 0:P.a)&&void 0!==T?T:1)),onArcgisSliderInputValueChange:e=>{const t=e.detail,i=(0,p.t)(t),o=null==D?void 0:D.clone();o.borderLineColor.a=i,this.updateSymbol(o,!1,!1,"border-line-color-transparency")},withSteppers:!this.narrow,label:this.strings.outlineTransparency})),(0,o.h)("calcite-label",null,this.strings.outlineWidth,(0,o.h)("calcite-input-number",{scale:"s",min:0,max:18,value:`${null!==(M=(null==D?void 0:D.borderLineSize)/.75)&&void 0!==M?M:1}`,onCalciteInputNumberInput:e=>{clearTimeout(this.borderLineSizeValueHandle),e.stopPropagation();const t=parseInt(this.borderLineSizeEl.value);isNaN(t)||t<this.borderLineSizeEl.min||t>this.borderLineSizeEl.max?this.borderLineSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.borderLineSizeEl,"border-line-size")),3e3):this.handleTextPropChange(this.borderLineSizeEl,"border-line-size")},ref:e=>this.borderLineSizeEl=e})))),Q=(0,o.h)("div",null,_,J,$,W,j,K,Z);let q;switch(this.divNodes=[],this.symbolNodes=[],this.currentSketchInfo.tool){case"point":q=this.strings.point;break;case"polyline":q=this.strings.line;break;case"text":q=this.strings.text;break;default:q=this.strings.polygon}q=q.toLocaleLowerCase();const X=(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,this.strings.recentSymbols),(0,o.h)("div",{class:"container",ref:e=>this.recentSymbolsContainerEl=e},(null===(E=this.recentSymbols)||void 0===E?void 0:E.length)?this.recentSymbols.map(((e,t)=>e?(0,o.h)("div",{key:"symbol",class:"symbol",tabindex:"0",onClick:()=>this.handleRecentSymbolSelect(t),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleRecentSymbolSelect(t))},ref:i=>{i&&(this.divNodes[t]=i,this.afterCreateDiv(i,e,t))}}):null)):(0,o.h)("div",{key:"no-recent-symbol",class:"no-recent-symbols"},this.strings.noRecentSymbols.replace("${tool}",q))),(0,o.h)("calcite-button",{scale:"s",class:"clear-recent-button",width:"half",disabled:!(null===(L=this.recentSymbols)||void 0===L?void 0:L.length),onClick:()=>{const e=this.currentSketchInfo.tool?["circle","rectangle"].indexOf(this.currentSketchInfo.tool)>-1?"arcgis-sketch-recent-polygon-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols";this.recentSymbols=[],(0,r.s)(e,this.recentSymbols,!0),(0,o.f)(this.hostElement)}},this.strings.clear)),Y=(0,o.h)("calcite-label",{class:"sketch-title"},this.strings.title,(0,o.h)("calcite-inline-editable",{scale:"m"},(0,o.h)("calcite-input",{alignment:"start",placeholder:this.strings.enterTitlePlaceholder,type:"text",value:this.currentSketchInfo.title,onBlur:e=>{this.currentSketchInfo.title=e.target.value,this.sketchGraphicUpdates.emit({type:"title",update:!0,close:!1})}}))),ee=(0,o.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:x?"chevron-left":"chevron-right",label:this.strings.popup,width:"full",scale:"l",class:"sketch-popup-button",onClick:e=>{var t,i;if(e.stopPropagation(),!this.sketchPopupFlowItem){this.sketchPopupFlowItem=document.createElement("calcite-flow-item"),this.sketchPopupFlowItem.heading=this.strings.sketch,this.sketchPopupFlowItem.description=this.strings.popup;const e=document.createElement("calcite-fab");e.icon="plus",e.slot="fab",e.scale="s",e.appearance="outline-fill",e.kind="neutral",e.label=this.strings.addContent,e.text=this.strings.addContent,e.textEnabled=!0,this.sketchPopupFlowItem.appendChild(e);const o=document.createElement("arcgis-popup");if(o.lang=this.currentLanguage,o.mapView=this.mapView,o.layerDisplayType=d.l.mapNotes,o.mapNotesGraphic=null===(t=this.currentSketchInfo.graphics)||void 0===t?void 0:t[0],o.mapNotesPopupTemplate=this.currentSketchInfo.popup,o.calciteFlowProps={flow:this.flowEl,calciteFab:e,calciteFlowItem:this.sketchPopupFlowItem},this.sketchPopupFlowItem.appendChild(o),this.flowEl.appendChild(this.sketchPopupFlowItem),O){o.multiplePopupsSelected=!0,o.disableEditing=!0;const e=document.createElement("calcite-button");e.label=this.strings.applyChanges,e.innerHTML=this.strings.applyChanges,e.scale="l",e.slot="footer",this.sketchPopupFlowItem.append(e),e.addEventListener("click",(()=>{var t;this.alertEl&&(null===(t=this.alertEl.parentElement)||void 0===t||t.removeChild(this.alertEl),this.alertEl=null),o.disableEditing=!1,o.update(),e.kind="neutral",e.disabled=!0,this.alertEl=document.createElement("calcite-alert"),this.alertEl.kind="success",this.alertEl.icon="check-circle";const i=document.createElement("div");i.slot="message",i.innerHTML=this.strings.changesApplied,this.alertEl.append(i),this.alertEl.open=!0,document.body.append(this.alertEl),this.alertEl.addEventListener("calciteAlertClose",(()=>{var e;null===(e=this.alertEl.parentElement)||void 0===e||e.removeChild(this.alertEl),this.alertEl=null}))})),o.addEventListener("bulkPopupUpdated",(()=>{e.kind="brand",e.disabled=!1}))}this.sketchPopupFlowItem.setFocus(),this.sketchPopupFlowItem.beforeBack=async()=>await o.done(),this.mapView.closePopup(),(null===(i=this.currentSketchInfo.graphics)||void 0===i?void 0:i.length)&&this.currentSketchInfo.popup&&this.mapView.openPopup({features:[this.currentSketchInfo.graphics[0]],location:(0,p.o)(this.currentSketchInfo.graphics[0].geometry)})}}},this.strings.popup);return(0,o.h)(o.H,null,(0,o.h)("div",{dir:(0,s.g)(this.hostElement)},(!O||F&&!N)&&(0,o.h)("div",{class:"recent-symbols"},X),(0,o.h)("div",{class:"sketch-content"},Y,ee,(()=>{if(!O||F&&!N)switch(this.currentSketchInfo.tool){case"point":return U;case"text":return Q;case"polyline":return z;case"polygon":case"rectangle":case"circle":return B;default:return null}})())))}handleRecentSymbolSelect(e){this.updateSymbol(this.symbolNodes[e],!0,!0,this.textContentEl?"recent-text":void 0),this.divNodes[0].focus()}async afterCreateDiv(e,t,i){var o;let l;if(["simple-line","simple-fill","picture-marker","picture-fill","text","cim"].indexOf(t.type)>-1)"text"===t.type&&(t.text=this.strings.textPreview),l=t;else switch(t.type){case"CIMSymbolReference":l=this.CIMSymbol.fromJSON(t);break;case"esriSLS":l=this.SimpleLineSymbol.fromJSON(t);break;case"esriSFS":l=this.SimpleFillSymbol.fromJSON(t);break;case"esriPMS":l=this.PictureMarkerSymbol.fromJSON(t);break;case"esriPFS":l=this.PictureFillSymbol.fromJSON(t);break;case"esriTS":l=this.TextSymbol.fromJSON(t)}for(;null===(o=null==e?void 0:e.childNodes)||void 0===o?void 0:o.length;)e.removeChild(e.childNodes[0]);const s=l.clone();"text"===s.type&&(s.haloSize=Math.min(2,s.haloSize)),"simple-line"===s.type&&(s.width=Math.min(2,s.width));const n={maxSize:"text"===s.type?16:24,scale:!0,size:"simple-line"===s.type?{width:this.recentSymbolsContainerEl.clientWidth/9}:{width:"text"===s.type?16:24,height:"text"===s.type?16:24}};s&&await this.symbolUtils.renderPreviewHTML(s,n).then((t=>{t&&(e.append(t),this.symbolNodes[i]=l)}))}get hostElement(){return(0,o.d)(this)}};R.style=".sketch-content{display:flex;flex-direction:column;background-color:var(--arcgis-app-background);padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing-half)}.sketch-title calcite-inline-editable{border:1px solid;border-color:var(--calcite-color-border-input);padding:var(--arcgis-app-cap-spacing-third)}.rotation{display:flex;align-items:center;justify-content:space-between;position:relative}.rotation calcite-slider{width:50%}.rotation calcite-input-number{width:45%;font-size:var(--arcgis-app-font-size-0);font-family:var(--arcgis-app-font-family)}.sketch-popup-button{margin-bottom:0.4em}.recent-symbols{display:flex;flex-direction:column;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing-half)}.container{background-color:var(--arcgis-app-background);box-shadow:0px 1px 10px 2px rgba(0, 0, 0, 0.1);padding:8px 12px;display:flex;align-items:center;justify-content:space-evenly}.symbol{height:32px;display:flex;align-items:center;cursor:pointer}.symbol:focus{outline:2px solid var(--calcite-ui-brand);outline-offset:2px}.no-recent-symbols{min-height:32px;display:flex;align-items:center}.clear-recent-button{padding-top:8px;margin:auto}.halo-block,.background-color-block{padding-top:6px}";const V=class{constructor(e){(0,o.r)(this,e),this.arcgisSketchShortcutsDismissedChange=(0,o.c)(this,"arcgisSketchShortcutsDismissedChange",7),this.refElement=void 0,this.isOpen=!1}componentWillLoad(){this.strings=A.strings}componentDidLoad(){this.isOpen=!0}async reposition(){var e;null===(e=this.sketchShortcutsPopover)||void 0===e||e.reposition()}render(){const e="rtl"===(0,s.g)(this.hostElement)?"trailing-start":"leading-start";return(0,o.h)(o.H,{key:"36fb7a30b456ec4e5de138a092eef49916b828c2",class:"js-app-flyout"},(0,o.h)("calcite-popover",{key:"917652b7dcecf494a623ef39ee6a58276d768f50",dir:(0,s.g)(this.hostElement),class:"popover "+("rtl"===(0,s.g)(this.hostElement)?s.C.rtl:""),ref:e=>this.sketchShortcutsPopover=e,placement:e,open:this.isOpen,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:this.strings.sketchShortcuts},(0,o.h)("calcite-panel",{key:"a1698550f0edcddbde67a1902a109ef3a6d1a0c4",heading:this.strings.sketchShortcuts,closable:!0,style:{width:`${Math.max(this.refElement.getBoundingClientRect().width,375)}px`},onCalcitePanelClose:()=>this.arcgisSketchShortcutsDismissedChange.emit()},(0,o.h)("div",{key:"b9aee48831c369bf4d84472c87c741c38c250cb4",class:"sketch-shortcut"},(0,o.h)("calcite-chip",{key:"53d1f5765d690bb1c6438089f0302d0a8affd228",class:"sketch-shortcut-chip",value:"Ctrl",scale:"m"},"Ctrl"),(0,o.h)("calcite-label",{key:"ea652e69cfa2fad94edb55d0f7026a778baf681f",class:"sketch-shortcut-label"},this.strings.ctrlShortcut),(0,o.h)("calcite-chip",{key:"7142f351e1ddfde088604f9edb19272407c59507",class:"sketch-shortcut-chip",value:"Enter",scale:"m"},"Enter"),(0,o.h)("calcite-label",{key:"b1f7d39ffc3e5ed28d3adb2eb7924236cfd2f51f",class:"sketch-shortcut-label"},this.strings.cShortcut),(0,o.h)("calcite-chip",{key:"e4bceb5aa2696d9de69cc3fe5001dededbf5b8b3",class:"sketch-shortcut-chip",value:"Z",scale:"m"},"Z"),(0,o.h)("calcite-label",{key:"6b9e502ff55aec4589be9bd796e54a4d02d46b7b",class:"sketch-shortcut-label"},this.strings.zShortcut),(0,o.h)("calcite-chip",{key:"d4f18e481b837fcb4866b73cb6dba4d01a5085b5",class:"sketch-shortcut-chip",value:"R",scale:"m"},"R"),(0,o.h)("calcite-label",{key:"f321180aa958bf62814673bd25bebf751b2dfde1",class:"sketch-shortcut-label"},this.strings.rShortcut),(0,o.h)("calcite-chip",{key:"815c4e5859706be9cf7d690c69356cb741d675fe",class:"sketch-shortcut-chip",value:"Esc",scale:"m"},"Esc"),(0,o.h)("calcite-label",{key:"f10e797f5ffa3d46fc69ad087445cb273624eebe",class:"sketch-shortcut-label"},this.strings.escShortcut),(0,o.h)("calcite-chip",{key:"4252da65e7a13bb05b2947c1d14ac5071f8f7a83",class:"sketch-shortcut-chip",value:"Tab",scale:"m"},"Tab"),(0,o.h)("calcite-label",{key:"2f789809de335fea1e8538da771e91ec42987d81",class:"sketch-shortcut-label"},this.strings.tabShortcut)))))}get hostElement(){return(0,o.d)(this)}};V.style=".sketch-shortcut{background-color:var(--arcgis-app-background);display:grid;grid-template-columns:21% auto;row-gap:var(--arcgis-app-cap-spacing-half);padding:var(--arcgis-app-cap-spacing-half)}.sketch-shortcut-chip{margin-right:var(--arcgis-app-cap-spacing-half)}.sketch-shortcut-label{align-self:center}.popover{z-index:100}.arcgis--rtl .sketch-shortcut{max-height:40vh}.arcgis--rtl .sketch-shortcut-chip{margin-left:var(--arcgis-app-cap-spacing-half);margin-right:0}";const N=class{constructor(e){(0,o.r)(this,e),this.closeSketchSnappingPopovers=(0,o.c)(this,"closeSketchSnappingPopovers",7),this.refElement=void 0}async componentWillLoad(){this.strings=A.strings,this.mapView=A.mapView,this.snappingOptions=A.snappingOptions,this.snappingSessionStorageIds=A.snappingSessionStorageIds,this.sketchTooltipOptions=A.sketchTooltipOptions,this.sketchTooltipSessionStorageIds=A.sketchTooltipSessionStorageIds,await this.loadAllModules(),this.addSnappingWidget(),this.addTooltipsWidget()}componentDidLoad(){this.snappingControls.container=this.snappingControlDiv,this.sketchTooltipControls.container=this.sketchTooltipControlDiv}disconnectedCallback(){var e,t;null===(e=this.snappingControls)||void 0===e||e.destroy(),null===(t=this.sketchTooltipControls)||void 0===t||t.destroy()}async reposition(){var e;null===(e=this.sketchSnappingPopover)||void 0===e||e.reposition()}async loadAllModules(){const[e,t]=await(0,n.l)(["esri/widgets/support/SnappingControls","esri/widgets/support/SketchTooltipControls"]);this.SnappingControls=e,this.SketchTooltipControls=t}addSnappingWidget(){this.snappingControls=new this.SnappingControls({view:this.mapView,snappingOptions:A.snappingOptions,visibleElements:{header:!1}})}addTooltipsWidget(){this.sketchTooltipControls=new this.SketchTooltipControls({view:this.mapView,tooltipOptions:A.sketchTooltipOptions,visibleElements:{tooltipsToggle:!0,labelsToggle:!1}}),this.sketchTooltipControls.sketchOptions.tooltips=A.sketchTooltipOptions}render(){return(0,o.h)(o.H,{key:"2f5ca42f31e7622f710ed2227f5dad9879b7a49c",class:"js-app-flyout"},(0,o.h)("calcite-popover",{key:"eda93784827cf4801964f856ff73b50c97b4416a",dir:(0,s.g)(this.hostElement),placement:"leading-start",ref:e=>this.sketchSnappingPopover=e,open:!0,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:this.strings.settings,style:{zIndex:"100"}},(0,o.h)("calcite-panel",{key:"a98af74ba49c32b52e6d085581189c0776602ba9",closable:!0,headingLevel:2,heading:this.strings.settings,style:{width:`${this.refElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>{var e,t;(null===(e=this.snappingSessionStorageIds)||void 0===e?void 0:e.current)&&f(this.snappingOptions,this.snappingSessionStorageIds.current),(null===(t=this.sketchTooltipSessionStorageIds)||void 0===t?void 0:t.current)&&x(this.sketchTooltipOptions,this.sketchTooltipSessionStorageIds.current),this.closeSketchSnappingPopovers.emit()}},(0,o.h)("div",{key:"38cb2d0aac100e6a89ea5560cc0149a600d2a3b4",class:"content"},(0,o.h)("div",{key:"126f138cc58bbbf0e800ab225a1e71da34bec0d5",ref:e=>this.sketchTooltipControlDiv=e}),(0,o.h)("div",{key:"dda6fa577838962a65e8644dc5d58a5b81e9abad",ref:e=>this.snappingControlDiv=e})))))}get hostElement(){return(0,o.d)(this)}};N.style=".content{max-height:60vh}";const U=class{constructor(e){(0,o.r)(this,e),this.sketchActionOnDrawFeatures=(0,o.c)(this,"sketchActionOnDrawFeatures",7),this.sketchActionOnSelectFeatures=(0,o.c)(this,"sketchActionOnSelectFeatures",7),this.refElement=void 0,this.mapNotesFeatures=null,this.sketchToolsToHide=[],this.activeSketchTool=void 0,this.hideSelectionTools=!1,this.activeSelectTool=void 0,this.isOpen=!1}componentWillLoad(){this.strings=A.strings,this.svModel=A.svModel,this.layer=A.layer,this.isOpen=!0}componentDidLoad(){var e;if(null===(e=this.mapNotesFeatures)||void 0===e?void 0:e.length){let e=[],t=[],i=[],o=[];this.mapNotesFeatures.forEach((l=>{switch(y(l)){case"polyline":t=[...t,l];break;case"polygon":i=[...i,l];break;case"text":o=[...o,l];break;default:e=[...e,l]}})),this.activeSelectTool&&("select"===this.activeSelectTool?this.actionOnSelectFeatures(this.strings.selectText,this.sketchSelectElement):this.actionOnSelectFeatures(this.strings.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")),e.length&&this.svModel.updatePoint(e),t.length&&this.svModel.updateLine(t),i.length&&this.svModel.updatePolygon(i),o.length&&this.svModel.updateText(o)}else{const e={point:this.sketchPointElement,polygon:this.sketchPolygonElement,polyline:this.sketchPolyLineElement,circle:this.sketchCircleElement,rectangle:this.sketchRectangleElement,text:this.sketchTextElement};let t,i;if(this.activeSketchTool)t=this.activeSketchTool,i=e[t];else{let o=["point","polyline","polygon","rectangle","circle","text"];o=o.filter((e=>!this.sketchToolsToHide.includes(e))),t=o.length?o[0]:"point",i=e[t]}this.actionOnDrawFeatures(t,this.strings.addStamp,i)}}async reposition(){var e;null===(e=this.sketchToolsPopoverElement)||void 0===e||e.reposition()}actionOnDrawFeatures(e,t,i){this.clearActiveSelection(),this.activeSelectTool=null,i.active=!0,this.sketchActionOnDrawFeatures.emit({tool:e,sketchMessage:t})}actionOnSelectFeatures(e,t,i){const{active:o=!1}=t;this.clearActiveSelection(),t.active=!o,this.activeSelectTool=t.active?null!=i?i:"select":null,this.svModel.cancel(),this.sketchActionOnSelectFeatures.emit({sketchMessage:o?"":e,multipleSelectTool:!o&&i||null})}clearActiveSelection(){[this.sketchPointElement,this.sketchPolyLineElement,this.sketchPolygonElement,this.sketchRectangleElement,this.sketchCircleElement,this.sketchTextElement,this.sketchSelectElement,this.sketchRectangleSelectElement,this.sketchLassoSelectElement].forEach((e=>{e&&(e.active=!1)}))}render(){const e=(0,o.h)("calcite-action-group",{key:"0e55898b3e1f503b6d07409ece67955405e96d71",label:this.strings.drawFeatures},!this.sketchToolsToHide.includes("point")&&(0,o.h)("calcite-action",{key:"d0fb2b5239d3d135909e41c610aa8cfc74d6ae53",ref:e=>this.sketchPointElement=e,text:this.strings.stamp,label:this.strings.stamp,title:this.strings.stamp,icon:"pin",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("point",this.strings.addStamp,this.sketchPointElement)}}),!this.sketchToolsToHide.includes("polyline")&&(0,o.h)("calcite-action",{key:"28e15f4ff019990686201db920d0f555b63b3486",ref:e=>this.sketchPolyLineElement=e,text:this.strings.line,label:this.strings.line,title:this.strings.line,icon:"line",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("polyline",this.strings.startFinishDrawing,this.sketchPolyLineElement)}}),!this.sketchToolsToHide.includes("polygon")&&(0,o.h)("calcite-action",{key:"eaad31b724820de0fe42aa748824be4ec6648a86",ref:e=>this.sketchPolygonElement=e,text:this.strings.polygon,label:this.strings.polygon,title:this.strings.polygon,icon:"polygon",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("polygon",this.strings.startFinishDrawing,this.sketchPolygonElement)}}),!this.sketchToolsToHide.includes("rectangle")&&(0,o.h)("calcite-action",{key:"caa1748e024eb3ea27d208fa52fa5ed1bbf3738a",ref:e=>this.sketchRectangleElement=e,text:this.strings.rectangle,label:this.strings.rectangle,title:this.strings.rectangle,icon:"rectangle",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("rectangle",this.strings.addRectangle,this.sketchRectangleElement)}}),!this.sketchToolsToHide.includes("circle")&&(0,o.h)("calcite-action",{key:"8c5d8b8f831bf24dc683cdafde374219606af2d7",ref:e=>this.sketchCircleElement=e,text:this.strings.circle,label:this.strings.circle,title:this.strings.circle,icon:"circle",scale:"m",alignment:"center",onClick:()=>{this.actionOnDrawFeatures("circle",this.strings.addCircle,this.sketchCircleElement)}}),!this.sketchToolsToHide.includes("text")&&(0,o.h)("calcite-action",{key:"24974c56b893faeed6f1ff41a2396d2854fc449f",ref:e=>this.sketchTextElement=e,text:this.strings.text,label:this.strings.text,title:this.strings.text,icon:"text",scale:"m",alignment:"center",onClick:async()=>{this.actionOnDrawFeatures("text",this.strings.addText,this.sketchTextElement)}})),t=(0,o.h)("calcite-action-group",{key:"d188a57ff8454c1483970a689e4d7f92dd4460ba",label:this.strings.selectFeatures},(0,o.h)("calcite-action",{key:"5afb6bc67101a5d98b00895d5d109afb90a823a8",ref:e=>this.sketchSelectElement=e,text:this.strings.select,label:this.strings.select,title:this.strings.select,icon:"cursor",scale:"m",alignment:"center",onClick:()=>{this.actionOnSelectFeatures(this.strings.selectText,this.sketchSelectElement)}}),(0,o.h)("calcite-action",{key:"75e870cbc07d8642a8847bc215934eb36776197f",ref:e=>this.sketchRectangleSelectElement=e,text:this.strings.rectangleSelect,label:this.strings.rectangleSelect,title:this.strings.rectangleSelect,icon:"cursor-marquee",scale:"m",alignment:"center",onClick:()=>{this.actionOnSelectFeatures(this.strings.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")}}),(0,o.h)("calcite-action",{key:"1aeb8ea3f82b28eba1ced5f6e01e6a74cd7e8575",ref:e=>this.sketchLassoSelectElement=e,text:this.strings.lassoSelect,label:this.strings.lassoSelect,title:this.strings.lassoSelect,icon:"lasso",scale:"m",alignment:"center",onClick:()=>{this.actionOnSelectFeatures(this.strings.rectangleLassoSelect,this.sketchLassoSelectElement,"lasso")}}));return(0,o.h)(o.H,{key:"f1573d05faaeae01d1bb72026ff8cfa8767a1038",class:"js-app-flyout"},(0,o.h)("calcite-popover",{key:"ad44a94c1d940ee268a1a0f6a66b9b073f4edcf8",dir:(0,s.g)(this.hostElement),ref:e=>this.sketchToolsPopoverElement=e,placement:"leading-start",open:this.isOpen,referenceElement:this.refElement,offsetDistance:15,pointerDisabled:!0,focusTrapDisabled:!0,triggerDisabled:!0,label:this.strings.sketch,class:"popover",onCalcitePopoverBeforeClose:()=>this.sketchToolsPopoverElement.open=!0},(0,o.h)("calcite-action-pad",{key:"9aad8b840e7c3460ba03e00700b21b71e8408aab",position:"start",layout:"vertical",expandDisabled:!0},e,!this.hideSelectionTools&&t)))}get hostElement(){return(0,o.d)(this)}};U.style=".popover{z-index:100}"},84537:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>r,f:()=>s,m:()=>n,p:()=>o});const o=["above-center","above-left","above-right","below-center","below-left","below-right","center-center","center-left","center-right"],l=["above-along","center-along","below-along"],s=new Map;s.set("Abril Fatface Regular",{font:{family:"Abril Fatface",style:"normal",weight:"normal"}}),s.set("Alegreya Bold",{font:{family:"Alegreya",style:"normal",weight:"bold"}}),s.set("Alegreya Bold Italic",{font:{family:"Alegreya",style:"italic",weight:"bold"}}),s.set("Alegreya Italic",{font:{family:"Alegreya",style:"italic",weight:"normal"}}),s.set("Alegreya Regular",{font:{family:"Alegreya",style:"normal",weight:"normal"}}),s.set("Alegreya Sans Italic",{font:{family:"Alegreya Sans",style:"italic",weight:"normal"}}),s.set("Alegreya SC Bold",{font:{family:"Alegreya SC",style:"normal",weight:"bold"}}),s.set("Alegreya SC Italic",{font:{family:"Alegreya SC",style:"italic",weight:"normal"}}),s.set("Alegreya SC Regular",{font:{family:"Alegreya SC",style:"normal",weight:"normal"}}),s.set("Amarante Regular",{font:{family:"Amarante",style:"normal",weight:"normal"}}),s.set("Amatic SC Bold",{font:{family:"Amatic SC",style:"normal",weight:"bold"}}),s.set("Arial Bold",{font:{family:"Arial",style:"normal",weight:"bold"}}),s.set("Arial Bold Italic",{font:{family:"Arial",style:"italic",weight:"bold"}}),s.set("Arial Italic",{font:{family:"Arial",style:"italic",weight:"normal"}}),s.set("Arial Regular",{font:{family:"Arial",style:"normal",weight:"normal"}}),s.set("Arial Unicode MS Bold",{font:{family:"Arial Unicode MS",style:"normal",weight:"bold"}}),s.set("Arial Unicode MS Regular",{font:{family:"Arial Unicode MS",style:"normal",weight:"normal"}}),s.set("Atomic Age Regular",{font:{family:"Atomic Age",style:"normal",weight:"normal"}}),s.set("Audiowide Regular",{font:{family:"Audiowide",style:"normal",weight:"normal"}}),s.set("Avenir Next LT Pro Bold",{font:{family:"Avenir Next LT Pro",style:"normal",weight:"bold"}}),s.set("Avenir Next LT Pro Bold Italic",{font:{family:"Avenir Next LT Pro",style:"italic",weight:"bold"}}),s.set("Avenir Next LT Pro Demi Italic",{font:{family:"Avenir Next LT Pro Demi",style:"italic",weight:"normal"}}),s.set("Avenir Next LT Pro Italic",{font:{family:"Avenir Next LT Pro",style:"italic",weight:"normal"}}),s.set("Avenir Next LT Pro Light Italic",{font:{family:"Avenir Next LT Pro Light",style:"italic",weight:"normal"}}),s.set("Avenir Next LT Pro Regular",{font:{family:"Avenir Next LT Pro",style:"normal",weight:"normal"}}),s.set("Avenir Next LT Pro Light Italic",{font:{family:"Avenir Next LT Pro Light",style:"italic",weight:"normal"}}),s.set("Avenir Next LT Pro Light Regular",{font:{family:"Avenir Next LT Pro Light",style:"normal",weight:"normal"}}),s.set("Avenir Next LT Pro Medium Bold",{font:{family:"Avenir Next LT Pro Medium",style:"normal",weight:"bold"}}),s.set("Avenir Next LT Pro Medium Bold Italic",{font:{family:"Avenir Next LT Pro Medium",style:"italic",weight:"bold"}}),s.set("Avenir Next LT Pro Regular Bold",{font:{family:"Avenir Next LT Pro Regular",style:"normal",weight:"bold"}}),s.set("Avenir Next LT Pro Regular Bold Italic",{font:{family:"Avenir Next LT Pro Regular",style:"italic",weight:"bold"}}),s.set("Avenir Next LT Pro Regular Italic",{font:{family:"Avenir Next LT Pro Regular",style:"italic",weight:"normal"}}),s.set("Avenir Next LT Pro Regular Regular",{font:{family:"Avenir Next LT Pro Regular",style:"normal",weight:"normal"}}),s.set("Belleza Regular",{font:{family:"Belleza",style:"normal",weight:"normal"}}),s.set("BellTopo Sans Bold",{font:{family:"BellTopo Sans",style:"normal",weight:"bold"}}),s.set("BellTopo Sans Bold Italic",{font:{family:"BellTopo Sans",style:"italic",weight:"bold"}}),s.set("BellTopo Sans Italic",{font:{family:"BellTopo Sans",style:"italic",weight:"normal"}}),s.set("BellTopo Sans Regular",{font:{family:"BellTopo Sans",style:"normal",weight:"normal"}}),s.set("Black Ops One Regular",{font:{family:"Black Ops One",style:"normal",weight:"normal"}}),s.set("Cabin Sketch Bold",{font:{family:"Cabin Sketch",style:"normal",weight:"bold"}}),s.set("Cabin Sketch Regular",{font:{family:"Cabin Sketch",style:"normal",weight:"normal"}}),s.set("Coming Soon Regular",{font:{family:"Coming Soon",style:"normal",weight:"normal"}}),s.set("FGDC GeoAge Regular",{font:{family:"FGDC GeoAge",style:"normal",weight:"normal"}}),s.set("Homemade Apple Regular",{font:{family:"Homemade Apple",style:"normal",weight:"normal"}}),s.set("IM FELL DW Pica PRO Italic",{font:{family:"IM FELL DW Pica PRO",style:"italic",weight:"normal"}}),s.set("IM FELL DW Pica PRO Regular",{font:{family:"IM FELL DW Pica PRO",style:"normal",weight:"normal"}}),s.set("Josefin Sans Regular",{font:{family:"Josefin Sans",style:"normal",weight:"normal"}}),s.set("Josefin Sans Semibold Italic",{font:{family:"Josefin Sans Semibold",style:"italic",weight:"normal"}}),s.set("Josefin Slab Bold",{font:{family:"Josefin Slab",style:"normal",weight:"bold"}}),s.set("Josefin Slab Bold Italic",{font:{family:"Josefin Slab",style:"italic",weight:"bold"}}),s.set("Josefin Slab Italic",{font:{family:"Josefin Slab",style:"italic",weight:"normal"}}),s.set("Josefin Slab Light Italic",{font:{family:"Josefin Slab Light",style:"italic",weight:"normal"}}),s.set("Josefin Slab Regular",{font:{family:"Josefin Slab",style:"normal",weight:"normal"}}),s.set("Josefin Slab Semibold Italic",{font:{family:"Josefin Slab Semibold",style:"italic",weight:"normal"}}),s.set("Josefin Slab Thin Italic",{font:{family:"Josefin Slab Thin",style:"italic",weight:"normal"}}),s.set("Just Another Hand Regular",{font:{family:"Just Another Hand",style:"normal",weight:"normal"}}),s.set("Kranky Regular",{font:{family:"Kranky",style:"normal",weight:"normal"}}),s.set("Life Savers Bold",{font:{family:"Life Savers",style:"normal",weight:"bold"}}),s.set("Loved By The King Regular",{font:{family:"Loved By The King",style:"normal",weight:"normal"}}),s.set("Merriweather Bold",{font:{family:"Merriweather",style:"normal",weight:"bold"}}),s.set("Merriweather Bold Italic",{font:{family:"Merriweather",style:"italic",weight:"bold"}}),s.set("Merriweather Italic",{font:{family:"Merriweather",style:"italic",weight:"normal"}}),s.set("Merriweather Regular",{font:{family:"Merriweather",style:"normal",weight:"normal"}}),s.set("Montserrat Bold",{font:{family:"Montserrat",style:"normal",weight:"bold"}}),s.set("Montserrat Italic",{font:{family:"Montserrat",style:"italic",weight:"normal"}}),s.set("Montserrat Medium Italic",{font:{family:"Montserrat Medium",style:"italic",weight:"normal"}}),s.set("Montserrat Regular",{font:{family:"Montserrat",style:"normal",weight:"normal"}}),s.set("Montserrat Semibold Italic",{font:{family:"Montserrat Semibold",style:"italic",weight:"normal"}}),s.set("Noto Sans Bold",{font:{family:"Noto Sans",style:"normal",weight:"bold"}}),s.set("Noto Sans Bold Italic",{font:{family:"Noto Sans",style:"italic",weight:"bold"}}),s.set("Noto Sans Italic",{font:{family:"Noto Sans",style:"italic",weight:"normal"}}),s.set("Noto Sans Regular",{font:{family:"Noto Sans",style:"normal",weight:"normal"}}),s.set("Noto Serif Bold",{font:{family:"Noto Serif",style:"normal",weight:"bold"}}),s.set("Noto Serif Bold Italic",{font:{family:"Noto Serif",style:"italic",weight:"bold"}}),s.set("Noto Serif Italic",{font:{family:"Noto Serif",style:"italic",weight:"normal"}}),s.set("Noto Serif Regular",{font:{family:"Noto Serif",style:"normal",weight:"normal"}}),s.set("Old Standard TT Bold",{font:{family:"Old Standard TT",style:"normal",weight:"bold"}}),s.set("Old Standard TT Italic",{font:{family:"Old Standard TT",style:"italic",weight:"normal"}}),s.set("Old Standard TT Regular",{font:{family:"Old Standard TT",style:"normal",weight:"normal"}}),s.set("Orbitron Bold",{font:{family:"Orbitron",style:"normal",weight:"bold"}}),s.set("Orbitron Regular",{font:{family:"Orbitron",style:"normal",weight:"normal"}}),s.set("Oregano Italic",{font:{family:"Oregano",style:"italic",weight:"normal"}}),s.set("Oregano Regular",{font:{family:"Oregano",style:"normal",weight:"normal"}}),s.set("Oswald Bold",{font:{family:"Oswald",style:"normal",weight:"bold"}}),s.set("Oswald Regular",{font:{family:"Oswald",style:"normal",weight:"normal"}}),s.set("Pacifico Regular",{font:{family:"Pacifico",style:"normal",weight:"normal"}}),s.set("Palatino Linotype Regular",{font:{family:"Palatino Linotype",style:"normal",weight:"normal"}}),s.set("Playfair Display Black Regular",{font:{family:"Playfair Display Black",style:"normal",weight:"normal"}}),s.set("Playfair Display Bold",{font:{family:"Playfair Display",style:"normal",weight:"bold"}}),s.set("Playfair Display Bold Italic",{font:{family:"Playfair Display",style:"italic",weight:"bold"}}),s.set("Playfair Display Italic",{font:{family:"Playfair Display",style:"italic",weight:"normal"}}),s.set("Playfair Display Regular",{font:{family:"Playfair Display",style:"normal",weight:"normal"}}),s.set("Playfair Display SC Bold",{font:{family:"Playfair Display SC",style:"normal",weight:"bold"}}),s.set("Playfair Display SC Regular",{font:{family:"Playfair Display SC",style:"normal",weight:"normal"}}),s.set("Redressed Regular",{font:{family:"Redressed",style:"normal",weight:"normal"}}),s.set("Risque Regular",{font:{family:"Risque",style:"normal",weight:"normal"}}),s.set("Roboto Condensed Italic",{font:{family:"Roboto Condensed",style:"italic",weight:"normal"}}),s.set("Roboto Condensed Light Italic",{font:{family:"Roboto Condensed Light",style:"italic",weight:"normal"}}),s.set("Rye Regular",{font:{family:"Rye",style:"normal",weight:"normal"}}),s.set("Special Elite Regular",{font:{family:"Special Elite",style:"normal",weight:"normal"}}),s.set("Syncopate Bold",{font:{family:"Syncopate",style:"normal",weight:"bold"}}),s.set("Syncopate Regular",{font:{family:"Syncopate",style:"normal",weight:"normal"}}),s.set("Tangerine Regular",{font:{family:"Tangerine",style:"normal",weight:"normal"}}),s.set("Ubuntu Bold",{font:{family:"Ubuntu",style:"normal",weight:"bold"}}),s.set("Ubuntu Bold Italic",{font:{family:"Ubuntu",style:"italic",weight:"bold"}}),s.set("Ubuntu Condensed Regular",{font:{family:"Ubuntu Condensed",style:"normal",weight:"normal"}}),s.set("Ubuntu Italic",{font:{family:"Ubuntu",style:"italic",weight:"normal"}}),s.set("Ubuntu Light Bold",{font:{family:"Ubuntu Light",style:"normal",weight:"bold"}}),s.set("Ubuntu Light Bold Italic",{font:{family:"Ubuntu Light",style:"italic",weight:"bold"}}),s.set("Ubuntu Light Italic",{font:{family:"Ubuntu Light",style:"italic",weight:"normal"}}),s.set("Ubuntu Light Regular",{font:{family:"Ubuntu Light",style:"normal",weight:"normal"}}),s.set("Ubuntu Medium Italic",{font:{family:"Ubuntu Medium",style:"italic",weight:"normal"}}),s.set("Ubuntu Mono Bold",{font:{family:"Ubuntu Mono",style:"normal",weight:"bold"}}),s.set("Ubuntu Mono Bold Italic",{font:{family:"Ubuntu Mono",style:"italic",weight:"bold"}}),s.set("Ubuntu Mono Italic",{font:{family:"Ubuntu Mono",style:"italic",weight:"normal"}}),s.set("Ubuntu Mono Regular",{font:{family:"Ubuntu Mono",style:"normal",weight:"normal"}}),s.set("Ubuntu Regular",{font:{family:"Ubuntu",style:"normal",weight:"normal"}}),s.set("UnifrakturCook Bold",{font:{family:"UnifrakturCook",style:"normal",weight:"bold"}}),s.set("Vast Shadow Regular",{font:{family:"Vast Shadow",style:"normal",weight:"normal"}}),s.set("Walter Turncoat Regular",{font:{family:"Walter Turncoat",style:"normal",weight:"normal"}});const n=new Map;function r(e){return e?"normal"===e.style&&"normal"===e.weight?`${e.family} Regular${"BellTopo Sans"===e.family?"(Beta)":""}`:"normal"===e.style&&"bold"===e.weight?`${e.family} Bold`:"italic"===e.style&&"normal"===e.weight?`${e.family} Italic`:"italic"===e.style&&"bold"===e.weight?`${e.family} Bold Italic`:"Arial Regular":""}n.set("Arial Bold",{font:{family:"Arial",style:"normal",weight:"bold"}}),n.set("Arial Bold Italic",{font:{family:"Arial",style:"italic",weight:"bold"}}),n.set("Arial Italic",{font:{family:"Arial",style:"italic",weight:"normal"}}),n.set("Arial Regular",{font:{family:"Arial",style:"normal",weight:"normal"}}),n.set("Arial Unicode MS Bold",{font:{family:"Arial Unicode MS",style:"normal",weight:"bold"}}),n.set("Arial Unicode MS Bold Italic",{font:{family:"Arial Unicode MS",style:"italic",weight:"bold"}}),n.set("Arial Unicode MS Italic",{font:{family:"Arial Unicode MS",style:"italic",weight:"normal"}}),n.set("Arial Unicode MS Regular",{font:{family:"Arial Unicode MS",style:"normal",weight:"normal"}}),n.set("Avenir Bold",{font:{family:"Avenir",style:"normal",weight:"bold"}}),n.set("Avenir Bold Italic",{font:{family:"Avenir",style:"italic",weight:"bold"}}),n.set("Avenir Italic",{font:{family:"Avenir",style:"italic",weight:"normal"}}),n.set("Avenir Regular",{font:{family:"Avenir",style:"normal",weight:"normal"}}),n.set("Times New Roman Bold",{font:{family:"Times New Roman",style:"normal",weight:"bold"}}),n.set("Times New Roman Bold Italic",{font:{family:"Times New Roman",style:"italic",weight:"bold"}}),n.set("Times New Roman Italic",{font:{family:"Times New Roman",style:"italic",weight:"normal"}}),n.set("Times New Roman Regular",{font:{family:"Times New Roman",style:"normal",weight:"normal"}}),n.set("Verdana Bold",{font:{family:"Verdana",style:"normal",weight:"bold"}}),n.set("Verdana Bold Italic",{font:{family:"Verdana",style:"italic",weight:"bold"}}),n.set("Verdana Italic",{font:{family:"Verdana",style:"italic",weight:"normal"}}),n.set("Verdana Regular",{font:{family:"Verdana",style:"normal",weight:"normal"}})},11246:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>p,c:()=>l,d:()=>o,e:()=>s,f:()=>h,g:()=>u,i:()=>n,m:()=>r,t:()=>a,u:()=>d});const o=(e,t)=>{let i,o="idle";const l=(...l)=>new Promise((s=>{switch(o){case"flushed":o="idle",i?(clearTimeout(i),s(e(...l))):s(null);break;case"invoked":clearTimeout(i),o="idle",s(e(...l));break;case"cancelled":clearTimeout(i),o="idle",s(null);break;default:i&&clearTimeout(i),o="pending",i=setTimeout((()=>(o="idle",s(e(...l)))),t)}}));return l.flush=function(...e){return o="flushed",l(...e)},l.invoke=function(...e){return o="invoked",l(...e)},l.cancel=function(...e){return o="cancelled",l(...e)},l.getStatus=function(){return o},l},l=(e,t)=>{let i;return(...o)=>new Promise((l=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,l(e(...o))}),t))}))};function s(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function r(e,t){return await Promise.all([e,a(t)]),e}function a(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:o}=t(e);return[i,o]}))),h=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function d(e,t){const i=[],o={};return e.forEach((e=>{const l=t(e);null==o[l]&&(o[l]=e,i.push(e))})),i}function p(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let o=typeof e;return o in t?!t[o].hasOwnProperty(e)&&(t[o][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const u=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,o)=>e.slice(t*o,t+t*o)))},11935:(e,t,i)=>{i.d(t,{c:()=>a});var o=i(7263);const l=e=>!("isConnected"in e)||e.isConnected,s=((e,t)=>{let i;return(...o)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...o)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(l))}),2e3),n=e=>"function"==typeof e?e():e,r=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},a=(e,t)=>{const i=((e,t=((e,t)=>e!==t))=>{const i=n(e);let o=new Map(Object.entries(null!=i?i:{}));const l={dispose:[],get:[],set:[],reset:[]},s=()=>{var t;o=new Map(Object.entries(null!==(t=n(e))&&void 0!==t?t:{})),l.reset.forEach((e=>e()))},a=e=>(l.get.forEach((t=>t(e))),o.get(e)),c=(e,i)=>{const s=o.get(e);t(i,s,e)&&(o.set(e,i),l.set.forEach((t=>t(e,i,s))))},h="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>a(t),ownKeys:e=>Array.from(o.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>o.has(t),set:(e,t,i)=>(c(t,i),!0)}),d=(e,t)=>(l[e].push(t),()=>{r(l[e],t)});return{state:h,get:a,set:c,on:d,onChange:(t,i)=>{const o=d("set",((e,o)=>{e===t&&i(o)})),l=d("reset",(()=>i(n(e)[t])));return()=>{o(),l()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(d("set",t.set)),t.get&&e.push(d("get",t.get)),t.reset&&e.push(d("reset",t.reset)),t.dispose&&e.push(d("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{l.dispose.forEach((e=>e())),s()},reset:s,forceUpdate:e=>{const t=o.get(e);l.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof o.g)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,o.g)();i&&((e,t,i)=>{const o=e.get(t);o?o.includes(i)||o.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(o.f)),s(e)},reset:()=>{e.forEach((e=>e.forEach(o.f))),s(e)}}})()),i}},81457:(e,t,i)=>{i.d(t,{a:()=>h,b:()=>c,c:()=>d,d:()=>s,e:()=>l,g:()=>r,r:()=>a,s:()=>n});var o=i(11246);function l(e,t,i,o){!function(e,t,i){i=i||{};let o=null==i?void 0:i.expires;if("number"==typeof o){const e=new Date,t=24*o*60*60*1e3;e.setTime(Date.now()+t),o=i.expires=e}"string"!=typeof o&&(null==o?void 0:o.toUTCString)&&(i.expires=o.toUTCString());let l,s=`${e}=${encodeURIComponent(t)}`;for(l in i){s+=`; ${l}`;const e=i[l];!0!==e&&(s+=`=${e}`)}document.cookie=s}(e,o?JSON.stringify(t):t,i)}function s(e,t){const i=function(e){const t=document.cookie,i=new RegExp(`(?:^|; )${(0,o.e)(e)}=([^;]*)`),l=t.match(i);return l?decodeURIComponent(l[1]):void 0}(e);return i&&t?JSON.parse(i):i}function n(e,t,i){window.localStorage.setItem(e,i?JSON.stringify(t):t)}function r(e,t){const i=window.localStorage.getItem(e);return i&&t?JSON.parse(i):i}function a(e){window.localStorage.removeItem(e)}function c(e,t,i){window.sessionStorage.setItem(e,i?JSON.stringify(t):t)}function h(e,t){const i=window.sessionStorage.getItem(e);return i&&t?JSON.parse(i):i}function d(e){window.sessionStorage.removeItem(e)}},94278:(e,t,i)=>{i.d(t,{a:()=>r,b:()=>h,c:()=>c,d:()=>a,e:()=>s,f:()=>u,g:()=>l,h:()=>p,i:()=>n,j:()=>d});var o=i(28926);function l(e){return"cim"===e.type?"CIMLineSymbol"===e.data.symbol.type?"line":"CIMPolygonSymbol"===e.data.symbol.type?"polygon":"point":"simple-marker"===e.type||"picture-marker"===e.type?"point":"simple-line"===e.type?"line":"polygon"}const s={loaded:!1,async load(){if(this.loaded)return;const[e,t,i,l,s,n,r,a,c,h,d,p,u,g,m,y,f]=await(0,o.l)(["esri/core/screenUtils","esri/Color","esri/portal/Portal","esri/symbols/CIMSymbol","esri/symbols/WebStyleSymbol","esri/core/devEnvironmentUtils","esri/core/promiseUtils","esri/core/urlUtils","esri/portal/PortalItem","esri/symbols/support/previewSymbol2D","esri/symbols/support/gfxUtils","esri/symbols/support/jsonUtils","esri/symbols/support/styleUtils","esri/symbols/support/svgUtils","esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/symbols/support/webStyleSymbolUtils"]);this.Color=t,this.Portal=i,this.CIMSymbol=l,this.WebStyleSymbol=s,this.devEnvironmentUtils=n,this.previewSymbol2D=h,this.promiseUtils=r,this.urlUtils=a,this.PortalItem=c,this.gfxUtils=d,this.jsonUtils=p,this.screenUtils=e,this.styleUtils=u,this.svgUtils=g,this.symbolUtils=m,this.cimSymbolUtils=y,this.webStyleSymbolUtils=f,this.loaded=!0}};function n(e){return"cim"===(null==e?void 0:e.type)}function r(e){return"simple-marker"===(null==e?void 0:e.type)}function a(e){return"picture-marker"===(null==e?void 0:e.type)}function c(e){return"simple-line"===(null==e?void 0:e.type)}function h(e){return"simple-fill"===(null==e?void 0:e.type)}function d(e){return"CIMPointSymbol"===e.data.symbol.type}function p(e){return"CIMLineSymbol"===e.data.symbol.type}function u(e){return"CIMPolygonSymbol"===e.data.symbol.type}}}]);