/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-fcb6a6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-fcb6a6"],{76301:(e,t,i)=>{i.r(t),i.d(t,{arcgis_item_browser:()=>z,arcgis_item_browser_actions:()=>G,arcgis_item_browser_bucket_select:()=>H,arcgis_item_browser_card:()=>N,arcgis_item_browser_card_sublayer_select:()=>W,arcgis_item_browser_card_thumbnail:()=>q,arcgis_item_browser_content:()=>V,arcgis_item_browser_filter_categories:()=>K,arcgis_item_browser_filter_collaborations:()=>Q,arcgis_item_browser_filter_content_status:()=>J,arcgis_item_browser_filter_date:()=>Y,arcgis_item_browser_filter_extent:()=>X,arcgis_item_browser_filter_folder:()=>Z,arcgis_item_browser_filter_group:()=>ee,arcgis_item_browser_filter_industry:()=>ie,arcgis_item_browser_filter_item_type:()=>se,arcgis_item_browser_filter_location:()=>ae,arcgis_item_browser_filter_region:()=>le,arcgis_item_browser_filter_sharing:()=>ne,arcgis_item_browser_filter_tags:()=>ce,arcgis_item_browser_filters:()=>de,arcgis_item_browser_pagination:()=>he,arcgis_item_browser_preview:()=>ue,arcgis_item_browser_preview_copy:()=>me,arcgis_item_browser_preview_field_details:()=>pe,arcgis_item_browser_search:()=>ge,arcgis_item_browser_sort:()=>be,arcgis_item_browser_table:()=>ye,arcgis_item_browser_table_row:()=>Ie,arcgis_item_browser_top_bar:()=>ke,arcgis_item_browser_view:()=>xe});var s=i(7263),r=i(11935),o=i(31670),a=i(78613),l=i(73596),n=i(11246),c=i(62159),d=i(5157),h=i(12166),u=i(98604),m=i(83364),p=i(50858),g=i(59296),v=i(62827),b=i(71695),f=i(58233),w=i(43539),y=i(46581),I=i(28926),k=i(43780),x=i(29259),S=i(69773),C=i(33317),F=i(7652),B=i(58407),E=i(28944),_=i(94788),T=i(96601),A=i(80549),O=i(46227),L=i(79238),D=i(84121),P=i(89209),U=i(15437);i(86537),i(65215),i(79714),i(49038),i(2174),i(66488),i(31141),i(93816),i(22783),i(17300),i(50852),i(51325),i(71700),i(99907),i(70506),i(99004),i(59673),i(67575);function $(e){return{point:"point",polyline:"line",polygon:"polygon",nonspatial:"table",multipoint:"layer-points"}[e]||"table"}const R={esriGeometryPoint:"point",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultipoint:"multipoint",none:"nonspatial",table:"nonspatial"};function M(e){const{description:t,geometryType:i,fieldAliases:s,title:r,id:o}=e;return{description:t,fieldAliases:Array.isArray(s)?s.join(","):s,geometryType:R[i]||"nonspatial",id:o,title:r}}const z=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserUpdate=(0,s.c)(this,"arcgisItemBrowserUpdate",7),this.arcgisItemBrowserLoading=(0,s.c)(this,"arcgisItemBrowserLoading",7),this.arcgisItemBrowserSelect=(0,s.c)(this,"arcgisItemBrowserSelect",7),this.arcgisItemBrowserPreview=(0,s.c)(this,"arcgisItemBrowserPreview",7),this.arcgisItemBrowserShareUpdate=(0,s.c)(this,"arcgisItemBrowserShareUpdate",7),this.arcgisItemBrowserSublayerPreview=(0,s.c)(this,"arcgisItemBrowserSublayerPreview",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.liveRegionUpdate=(0,s.c)(this,"liveRegionUpdate",7),this.arcgisItemBrowserCardSelectError=(0,s.c)(this,"arcgisItemBrowserCardSelectError",7),this.allowFetch=!1,this.currentResults=[],this.updateFiltersEmpty=()=>{var e;this.store.state.filtersEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="filters"]'))},this.updateTopbarEmpty=()=>{var e;this.store.state.topbarEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="top-bar"]'))},this.updateSortEmpty=()=>{var e;this.store.state.sortEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="sort"]'))},this.filterMutationObserver=new MutationObserver(this.updateFiltersEmpty),this.topbarMutationObserver=new MutationObserver(this.updateTopbarEmpty),this.sortMutationObserver=new MutationObserver(this.updateSortEmpty),this.fetchItems=(0,n.d)((async e=>{var t,i,s;if(e||(this.loading=!0,this.arcgisItemBrowserLoading.emit()),this.currentResults=[],this.store.state.preview=null,!this.portal||!this.allowFetch)return;let r=this.getQuery();this.preflight&&(r=await this.preflight(r));const{response:a,error:l}=await(0,n.m)(this.queryItems(r),e?0:500);if(l||!(null==a?void 0:a.results))return;0===(null===(t=null==a?void 0:a.results)||void 0===t?void 0:t.length)&&a.start>a.total&&a.total>0&&this.updatePage({start:1,total:a.total,num:a.num});const c=await(0,u.f)(this.portal,this.store.state.userContentGroups,null==a?void 0:a.results);c.result&&(this.store.state.groupSharing=Object.assign({},c.result));const{selectedItems:d}=this,h=e?(0,m.u)({selectedItems:d,items:a.results}):d;this.arcgisItemBrowserUpdate.emit(Object.assign(Object.assign(Object.assign({},a),{selectedItems:h,filters:(0,u.c)({filters:Object.assign({},this.store.state.filters),bucket:this.bucket}),searchTerm:this.searchTerm,recycleBin:this.store.state.recycleBin}),this.sort)),this.store.state.activeFocus=[0,0],h!==d&&(this.selectedItems=h,this.arcgisItemBrowserSelect.emit(h)),this.currentResponse=a,this.currentResults=a.results,this.store.state.knownTags=(0,u.g)(a,this.store.state.knownTags,null===(s=null===(i=this.store.state.filters)||void 0===i?void 0:i.tags)||void 0===s?void 0:s.tags),this.store.state.highlights=(0,u.a)(a,o.c.config),await(0,n.t)(100),this.loading=!1}),150),this.resize=()=>{var e,t;const i=this.el.clientWidth||(null===(e=this.el.parentElement)||void 0===e?void 0:e.clientWidth)||0,s=this.el.clientHeight||(null===(t=this.el.parentElement)||void 0===t?void 0:t.clientHeight)||0;this.formFactor=i>d.b.md?"large":"small";const r=this.store.state.width>d.b.md?"large":"small";"large"===r&&"small"===this.formFactor&&(this.store.state.panel=this.usePanelLayout,this.store.state.filtersExpanded=!1),"small"===r&&"large"===this.formFactor&&(this.store.state.panel=!1,this.store.state.filtersExpanded=!0),this.store.state.width=i,this.store.state.height=s},this.renderSelectedItem=e=>{const t=(0,m.i)(e),i=(0,m.g)(e).id;if(t){const t=e.task;return(0,s.h)("arcgis-selected-item",{key:i,heading:t,onArcgisSelectedItemRemove:()=>{this.selectedItems=(0,m.d)({item:o,task:t,selectedItems:this.selectedItems}),this.arcgisItemBrowserSelect.emit(this.selectedItems)}},(0,s.h)("calcite-icon",{slot:"content-start",icon:"pushpin",scale:"s"}))}const r=(0,m.a)(e),o=r?e.item:e,a=r?e.sublayer:null,l=r?a.title:null;return(0,s.h)("arcgis-selected-item",{heading:o.title,description:l,key:i,onArcgisSelectedItemRemove:()=>{this.selectedItems=(0,m.d)({item:o,sublayer:a,selectedItems:this.selectedItems}),this.arcgisItemBrowserSelect.emit(this.selectedItems),this.arcgisItemBrowserInternalUIAction.emit({category:"deselect",attribute:"selection dropdown"})}},r?(0,s.h)("calcite-icon",{slot:"content-start",icon:$(e.sublayer.geometryType),scale:"s"}):(0,s.h)("arcgis-item-type",{slot:"content-start",item:o,portal:this.portal,scale:"s",showText:!1}))},this.api=void 0,this.portal=void 0,this.user=void 0,this.contentUser=void 0,this.subscriptionInfo=void 0,this.userLicensedItems=void 0,this.config=void 0,this.groupId=void 0,this.selection="none",this.retainSelection=void 0,this.selectedItems=[],this.allowedGeometries=void 0,this.allowedSubscriptionContentTypes=void 0,this.view="list",this.bucket=void 0,this.num=20,this.q="",this.filter="",this.height="full",this.preflight=void 0,this.fetch=void 0,this.showFieldStatistics=!1,this.store=(0,r.c)({filters:{},type:"item-browser"}),this.hidePreviewFooters=!1,this.hideContentTop=!1,this.contentPaddedBottom=!1,this.usePanelLayout=!1,this.baseUrls={},this.showHiddenItems=void 0,this.searchTerm="",this.sort=void 0,this.page={num:this.num,start:1,nextStart:-1},this.loading=!0,this.formFactor=void 0,this.previewItem=void 0,this.currentResponse=void 0,this.selectedSizeForRecycleBin=0,this.showHosted=void 0,this.previousSort=void 0}async refresh(e){this.fetchItems(e)}async refreshSharing(e){const t=(await(0,u.b)(this.portal,e)).result,i=await(0,u.f)(this.portal,this.store.state.userContentGroups,t);this.store.state.groupSharing=Object.assign(Object.assign({},this.store.state.groupSharing),e.reduce(((e,t)=>{var s;return Object.assign(Object.assign({},e),{[t]:(null===(s=i.result)||void 0===s?void 0:s[t])||[]})}),{}));const s=Object.assign(Object.assign({},this.currentResponse),{results:this.currentResults.map((e=>t.find((t=>t.id===e.id))||e))});this.arcgisItemBrowserUpdate.emit(Object.assign(Object.assign(Object.assign({},s),{selectedItems:this.selectedItems,filters:this.store.state.filters,searchTerm:this.searchTerm,recycleBin:this.store.state.recycleBin}),this.sort)),this.currentResponse=s,this.currentResults=s.results}async componentWillLoad(){const{el:e,groupId:t,view:i,bucket:s,allowedGeometries:r,selectedItems:o,showFieldStatistics:l,allowedSubscriptionContentTypes:n}=this,d=await(0,c.g)(e);this.i18n=d[0],s&&(this.store.state.bucket=s),this.store.state.contentUser=this.contentUser,t&&(this.store.state.groupId=t),this.store.state.i18n=d[0],this.store.state.lang=d[1],this.store.state.view=i,this.store.state.selection=this.selection,this.store.state.selectedItems=o,this.store.state.allowedGeometries=r,this.store.state.allowedSubscriptionContentTypes=n,this.store.state.showFieldStatistics=l,this.store.state.interaction="keyboard",this.initializeConfig(),this.store.state.width=420,this.store.state.filtersExpanded=!1,this.formFactor="small",this.filterMutationObserver.observe(e,{childList:!0}),this.topbarMutationObserver.observe(e,{childList:!0}),this.sortMutationObserver.observe(e,{childList:!0}),this.updateUserGroups(),this.updateFiltersEmpty(),this.updateTopbarEmpty(),this.updateSortEmpty(),this.resize(),this.resizeHandler=()=>requestAnimationFrame(this.resize),window.addEventListener("resize",this.resizeHandler);const h=this.usePanelLayout||!!(0,a.c)(this.el,"calcite-shell-panel");h&&(this.store.state.filtersExpanded=!1),this.store.state.panel=h,this.calculateSelectedSizeForRecycleBin(),(0,p.o)(this.store,this.calculateSelectedSizeForRecycleBin.bind(this)),(0,p.a)(this.store,this.calculateSelectedSizeForRecycleBin.bind(this))}disconnectedCallback(){var e;null===(e=this.store.state.resizeObserver)||void 0===e||e.unobserve(this.el),this.filterMutationObserver.disconnect(),this.topbarMutationObserver.disconnect(),this.sortMutationObserver.disconnect(),this.filterClearHandler(!1),window.removeEventListener("resize",this.resizeHandler)}updateLoading(e){this.store.state.loading=e}updateUser(e){var t;null!==(t=o.c.user)&&void 0!==t||(o.c.user=e),this.updateUserGroups()}updateContentUser(e){var t,i;null!==(t=(i=this.store.state).contentUser)&&void 0!==t||(i.contentUser=e),this.updateUserGroups()}updateUserLicensedItems(e){var t;null!==(t=o.c.userLicensedItems)&&void 0!==t||(o.c.userLicensedItems=e)}updateSubscriptionInfo(e){var t;null!==(t=o.c.subscriptionInfo)&&void 0!==t||(o.c.subscriptionInfo=e)}updatePortal(e){var t;null!==(t=o.c.portal)&&void 0!==t||(o.c.portal=e),this.updateUserGroups()}updateAPI(e){var t;null!==(t=o.c.api)&&void 0!==t||(o.c.api=e)}updateConfig(e){var t;null!==(t=o.c.config)&&void 0!==t||(o.c.config=e)}updateSelection(e){this.store.state.selection=e}updateGroupID(e){this.store.state.groupId=e}updateSublayerSelectionGeometryTypes(e){this.store.state.allowedGeometries=e}updateSelectedItems(e){this.store.state.selectedItems=e}updateFieldStatistics(e){this.store.state.showFieldStatistics=e}updateView(e){this.store.state.view=e}updateBucket(e,t){var i,s,r,o;this.store.state.bucket=e,this.store.state.filters=(0,u.c)({bucket:e,oldBucket:t,filters:this.store.state.filters,keepSpecialFilters:!0,switchingBucket:!0});const a="my"===e&&"recycle"===(null===(s=null===(i=this.store.state.filters)||void 0===i?void 0:i.folder)||void 0===s?void 0:s.folder),l="org"===e&&"recycle"===(null===(o=null===(r=this.store.state.filters)||void 0===r?void 0:r.contentType)||void 0===o?void 0:o.contentType);this.store.state.recycleBin=a||l,this.retainSelection||(this.selectedItems=[],this.arcgisItemBrowserSelect.emit(this.selectedItems)),this.resetPagination(),this.fetchItems()}updateQ(){this.resetPagination(),this.fetchItems()}async componentDidLoad(){this.resize(),this.initializeConfig(),await(0,n.t)(400),this.allowFetch=!0,o.c.portal?this.fetchItems():(0,o.o)("portal",(()=>{this.initializeConfig(),this.fetchItems()}))}filterHandler(e){var t,i;this.loading=!0;const s=Object.assign(Object.assign({},this.store.state.filters),{[e.detail.id]:e.detail});if(e.detail.value){const t=Object.keys((0,u.c)({filters:s,bucket:this.bucket}));this.allowFetch&&this.arcgisItemBrowserInternalUIAction.emit({category:"filter",action:e.detail.id,attribute:t.join(","),count:t.length})}else delete s[e.detail.id];"folder"===(null===(t=e.detail)||void 0===t?void 0:t.id)&&"my"===this.store.state.bucket&&(this.store.state.recycleBin="recycle"===e.detail.folder),"contentType"===(null===(i=e.detail)||void 0===i?void 0:i.id)&&"org"===this.store.state.bucket&&(this.store.state.recycleBin="recycle"===e.detail.contentType),this.store.state.recycleBin&&((0,p.r)(s),this.searchTerm=""),this.store.state.filters=s,this.resetPagination(),this.fetchItems()}filterRemoveHandler(e){if(!e.detail)return;this.loading=!0;const t=Object.assign({},this.store.state.filters);delete t[e.detail],this.store.state.filters=t,this.resetPagination(),this.fetchItems()}filterClearHandler(e=!0){this.loading=e;const t={},i=this.store.state.filters;"my"===this.bucket&&(null==i?void 0:i.folder)&&(t.folder=i.folder),"group"===this.bucket&&(null==i?void 0:i.group)&&(t.group=i.group),this.store.state.filters=t,this.resetPagination(),e&&this.fetchItems()}genericFilterClearHandler(){this.filterClearHandler()}searchHandler(e){this.arcgisItemBrowserInternalUIAction.emit({category:"search",label:e.detail}),this.loading=!0;const t=this.searchTerm,i=e.detail;this.searchTerm=i;return!(this.searchTerm&&this.store.state.recycleBin)&&this.resetPagination(),!t&&i&&this.sort&&!this.store.state.recycleBin?(this.previousSort=this.sort,void this.updateSort({sortField:"relevance",sortOrder:"desc"})):t&&!i&&this.previousSort?(this.updateSort(this.previousSort),void(this.previousSort=null)):void(i?this.fetchItems():this.fetchItems.invoke())}bucketHandler(e){this.loading=!0,this.store.state.bucket=e.detail,this.bucket=e.detail,this.store.state.recycleBin=!1,this.resetPagination(),this.store.state.filters=(0,u.c)({bucket:e.detail,filters:this.store.state.filters,keepSpecialFilters:!0,switchingBucket:!0}),this.fetchItems()}sortHandler(e){this.updateSort(e.detail),this.previousSort&&(this.previousSort=e.detail)}viewHandler(e){this.view=e.detail,this.store.state.view=e.detail}async pageHandler(e){this.updatePage(e.detail)}selectHandler(e){const t=this.selectedItems,{selected:i,item:s,task:r,sublayer:o}=e.detail;switch(i||this.arcgisItemBrowserInternalUIAction.emit({category:"deselect",attribute:"item card"}),this.selection){case"single":case"single-sublayer":this.selectedItems=(0,m.s)({item:s,sublayer:o,task:r,selectedItems:[]});break;case"multiple":case"multiple-sublayer":this.selectedItems=i?(0,m.s)({item:s,sublayer:o,task:r,selectedItems:t}):(0,m.d)({item:s,sublayer:o,task:r,selectedItems:t})}this.arcgisItemBrowserSelect.emit(this.selectedItems)}async togglePreview({detail:e,target:t}){this.store.state.filtersExpanded=!1,this.store.state.recycleBin||(e&&this.store.state.preview!==e.id?(t.showItemTypeHosted&&(this.showHosted=!0),this.restoreFocusElement=document.activeElement,this.store.state.preview=e.id,this.previewItem=Object.assign({},e),this.arcgisItemBrowserPreview.emit(Object.assign({},e))):(this.store.state.preview=null,this.previewItem=null,this.arcgisItemBrowserPreview.emit(),this.arcgisItemBrowserSublayerPreview.emit(),this.arcgisItemBrowserCardSelectError.emit(),this.restoreFocus()),this.arcgisItemBrowserInternalUIAction.emit({action:this.previewItem?"open panel":"close panel",category:"card action"}))}tileSelectHandler(e){const{item:t}=e.detail;this.arcgisItemBrowserSelect.emit([t])}columnUpdateHandler(e){this.store.state.columns=e.detail}async sharingUpdateHandler({detail:e}){this.arcgisItemBrowserShareUpdate.emit(e)}handleMove(){this.store.state.interaction="mouse"}handleTouch(){this.store.state.interaction="touch"}handleKey(){this.store.state.interaction="keyboard"}calculateSelectedSizeForRecycleBin(){var e;this.selectedSizeForRecycleBin=this.store.state.recycleBin?null===(e=this.selectedItems)||void 0===e?void 0:e.reduce(((e,t)=>e+("size"in t?t.size:0)),0):void 0}updateSort(e){this.loading=!0,this.sort=e,this.store.state.sort=e,this.fetchItems()}async initializeConfig(){var e,t,i,s;null!==(e=o.c.api)&&void 0!==e||(o.c.api=this.api),null!==(t=o.c.user)&&void 0!==t||(o.c.user=this.user),null!==(i=o.c.portal)&&void 0!==i||(o.c.portal=this.portal),null!==(s=o.c.config)&&void 0!==s||(o.c.config=this.config)}async updatePage(e){var t;this.page=e,this.allowFetch&&(await this.fetchItems(),await(0,n.t)(400),null===(t=this.el.shadowRoot.querySelector(".scrolling"))||void 0===t||t.scrollTo({behavior:"smooth",top:0}))}resetPagination(){this.page.start=1,this.page.total=0}getQuery(){return Object.assign(Object.assign({filters:this.store.state.filters,searchTerm:this.searchTerm,baseQuery:this.q,baseFilter:this.filter,bucket:this.bucket,allowedGeometries:this.allowedGeometries},this.sort),this.page)}async queryItems(e){var t,i;let s;if(this.fetch)s=await this.fetch(e);else{const{portal:t,user:i,contentUser:r,store:o,groupId:a,config:l,showHiddenItems:n}=this;try{s=await(0,u.q)({portal:t,query:e,user:i,contentUser:r,store:o,groupId:a,config:l,userContentGroups:this.store.state.userContentGroups,showHiddenItems:n})}catch(e){return{error:e}}}return await(0,u.i)(this.portal,null===(t=this.store)||void 0===t?void 0:t.state.bucket)&&(null===(i=null==s?void 0:s.results)||void 0===i||i.forEach((({id:e})=>{this.baseUrls[e]="arcgis.com"}))),{response:s}}restoreFocus(){if(this.restoreFocusElement){const e=this.restoreFocusElement;e.restoreFocus?e.restoreFocus():e.setFocus?e.setFocus():e.focus&&e.focus()}}async updateUserGroups(){var e,t;const i=(null===(e=this.contentUser)||void 0===e?void 0:e.username)||(null===(t=this.user)||void 0===t?void 0:t.username),s=this.portal||o.c.portal;if(!i||!s)return;const r=await(0,h.f)(i,s);this.store.state.userContentGroups=r.groups}renderSelected(){var e,t,i,r,o,a;const n=(null===(e=this.currentResults)||void 0===e?void 0:e.length)&&(null===(t=this.currentResults)||void 0===t?void 0:t.every((e=>(0,m.b)({item:e,selectedItems:this.selectedItems})))),c=null===(i=this.selectedItems)||void 0===i?void 0:i.length,h=this.selectedSizeForRecycleBin,u=this.store.state.width<d.b.md;return(0,s.h)("arcgis-selected",{slot:"selection",loading:this.loading,total:null===(r=this.currentResults)||void 0===r?void 0:r.length,totalSelected:null===(o=this.store.state.selectedItems)||void 0===o?void 0:o.length,hideSelectedText:this.store.state.width<960,heading:"multiple-sublayer"===this.selection?this.i18n.itemBrowser.selectedLayers:this.i18n.itemBrowser.selectedItems,emptyText:"multiple-sublayer"===this.selection?this.i18n.itemBrowser.noSelectedLayers:this.i18n.itemBrowser.noSelectedItems,selectedText:h?this.i18n.itemBrowser[u?"selectedMultipleWithSizeSmall":"selectedMultipleWithSize"].replace("${totalSize}",(0,l.f)(h)).replace("${num}",`${c}`):void 0,checked:n,indeterminate:!n&&!!c,hideCheckbox:"multiple-sublayer"===this.selection,onArcgisSelectedDeselectAll:()=>{this.selectedItems=[],this.arcgisItemBrowserSelect.emit(this.selectedItems)},onArcgisSelectedSelectPage:()=>{var e;let t=[...this.selectedItems];null===(e=this.currentResults)||void 0===e||e.forEach((e=>{t=(0,m.s)({item:e,selectedItems:t})})),this.selectedItems=t,this.arcgisItemBrowserSelect.emit(this.selectedItems)}},null===(a=this.store.state.selectedItems)||void 0===a?void 0:a.map(this.renderSelectedItem))}renderSlot(e,t){return(0,s.h)("div",{slot:e},(0,s.h)("slot",{name:e},t))}renderEmptyTextSlot(e,t){return(0,s.h)("div",{slot:e,class:"empty-text-slot"},(0,s.h)("slot",{name:e},(0,s.h)("p",{class:"empty-text-slot__default"},t)))}render(){var e,t;const{previewItem:i,loading:r,hideContentTop:o,i18n:a,selectedItems:l,selection:n,currentResponse:c,store:d,api:h,renderSlot:u,renderEmptyTextSlot:m,searchTerm:p,formFactor:g,view:v,height:b}=this;return(0,s.h)(s.H,{key:"0d33269e999fe2124134b9922f010fdf72888fe6"},(0,s.h)("arcgis-browser",{key:"d8629b5e505d44e745ccc5dc125b43208eead478",preview:!!i,loading:r,hideContentTop:o,selected:l,alwaysShowSelection:null==n?void 0:n.includes("multiple"),alwaysShowContent:"table"===v,hideFilters:"subscription content"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket),response:c,store:d,api:h,formFactor:g,searchTerm:p,height:b},u("top-bar"),u("view"),u("sort"),this.store.state.preview&&(0,s.h)("arcgis-item-browser-preview",{slot:"preview",item:this.previewItem,portal:this.portal,user:this.user,key:this.store.state.preview,onArcgisItemBrowserPreviewClose:()=>{this.store.state.preview=null,this.arcgisItemBrowserPreview.emit(),this.arcgisItemBrowserSublayerPreview.emit(),this.restoreFocus()},showHosted:this.showHosted,onArcgisInternalItemBrowserSublayer:e=>{e.stopPropagation(),this.arcgisItemBrowserSublayerPreview.emit(e.detail)},hidePreviewFooters:this.hidePreviewFooters},(0,s.h)("div",{key:"29e82a99457e39cb7d427bf31f8eea5f51c75bb4",slot:"summary-top"},(0,s.h)("slot",{key:"d223fce92fca788c79d51e18eda0fa54bdeb7b91",name:"preview-summary-top"})),(0,s.h)("div",{key:"17ffd1ccfaca64d05bcd0f74d93f01aa498b9344",slot:"footer"},(0,s.h)("slot",{key:"dc5e989d4166460f9837df5ef2178e616f510b70",name:"preview-footer"})),(0,s.h)("div",{key:"da59fc06ebe3d3266232a27dd88f61928ef7c494",slot:"sublayer-footer"},(0,s.h)("slot",{key:"9031bdd0d76e3f51a0d994f9786046f110839baa",name:"sublayer-preview-footer"}))),this.renderSelected(),u("actions"),u("content-start"),(0,s.h)("div",{key:"72717f83d5cae5a9125ac2942f1704ee593c948f",slot:"content",class:{"content--padded-bottom":this.contentPaddedBottom}},(0,s.h)("slot",{key:"04142c53f32955c0bbb241a6e3343b2454599fa8",name:"content"})),u("content-end"),u("pagination"),u("filters-top"),u("filters"),u("scroll-end"),m("no-results",a.content.noResults),m("no-content",a.content.noContent)))}get el(){return(0,s.d)(this)}static get watchers(){return{loading:["updateLoading"],user:["updateUser"],contentUser:["updateContentUser"],userLicensedItems:["updateUserLicensedItems"],subscriptionInfo:["updateSubscriptionInfo"],portal:["updatePortal"],api:["updateAPI"],config:["updateConfig"],selection:["updateSelection"],groupId:["updateGroupID"],allowedGeometries:["updateSublayerSelectionGeometryTypes"],selectedItems:["updateSelectedItems","calculateSelectedSizeForRecycleBin"],showFieldStatistics:["updateFieldStatistics"],view:["updateView"],bucket:["updateBucket"],q:["updateQ"],filter:["updateQ"]}}};z.style=":host{position:relative;display:flex;height:100%;min-height:100%;width:100%;flex-direction:column;overflow-y:auto;overflow-x:hidden;background-color:var(--calcite-color-background);--item-browser-max-width:100%;--item-browser-pane-width:18.75rem;--item-browser-pane-z-index:11;--item-browser-top-bar-background:var(--calcite-color-foreground-1)}:host([height=auto]){display:flex;height:auto;flex-direction:column}arcgis-browser{--arcgis-browser-max-width:var(--item-browser-max-width);--arcgis-browser-pane-width:var(--item-browser-pane-width);--arcgis-browser-pane-z-index:var(--item-browser-pane-z-index);--arcgis-browser-top-bar-background:var(--item-browser-top-bar-background)}.content--padded-bottom{padding-bottom:1.5rem}::slotted([slot=no-results]){width:100%}::slotted([slot=no-content]){width:100%}.empty-text-slot{display:flex;height:100%;width:100%;justify-content:center}.empty-text-slot__default{margin-left:auto;margin-right:auto;max-width:32rem;padding-left:1.5rem;padding-right:1.5rem;padding-bottom:4rem;margin-top:min(8rem, 30vh)}@media screen and (max-width: 640px){:host{--item-browser-pane-width:100%}}";const G=class{constructor(e){(0,s.r)(this,e),this.actions=[]}async componentWillLoad(){this.store=(0,p.g)(this.el)}render(){return(0,s.h)(s.H,{key:"5eddc402c147613f1cff4a90ed10096b54b64097"},(0,s.h)("arcgis-browser-actions",{key:"1a6d5e78fa1d0b189ccc8c2e8c7e5b200bc3a37a",actions:this.actions,selection:this.store.state.selectedItems,store:this.store}))}get el(){return(0,s.d)(this)}};async function j(e,t,i,s){var r,o;if(!e)return[];const a=await(0,v.e)(e),l=null!==(r=(null==i?void 0:i.includes("subscription content"))&&await(0,u.d)(t,e))&&void 0!==r?r:[],n=null==a?void 0:a.portalConfigProperties,c=null===(o=null==n?void 0:n.portalLivingAtlasConfigEnabled)||void 0===o||o,d=t&&(null==l?void 0:l.length)&&(await(0,u.h)(e,t,s)).total>0;return i.filter((i=>t||"org"!==i?!(!t&&["my","favorites","group","org"].includes(i))&&(!(t&&!(0,b.l)(t)&&!(0,b.n)(t)&&"my"===i)&&((!t||!(0,g.a)(t)||"org"!==i)&&(!("subscription content"===i&&!d)&&!(!(c||"living atlas"!==i&&"living atlas analysis"!==i)||!function(e,t,i){var s,r,o,a,l;return t.isPortal?null===(r=null===(s=null==e?void 0:e.portalConfigProperties)||void 0===s?void 0:s.searchArcGISOnlineEnabled)||void 0===r||r:!(i&&!(0,g.c)(i))||null===(l=null!==(a=null===(o=t.sourceJSON)||void 0===o?void 0:o.canSearchPublic)&&void 0!==a?a:t.canSearchPublic)||void 0===l||l}(a,e,t)&&"all"===i)))):"public"===(null==e?void 0:e.access)))}const H=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserBucketSelect=(0,s.c)(this,"arcgisItemBrowserBucketSelect",7),this.selectOption=e=>{this.bucket=e,this.validBucket=e,this.arcgisItemBrowserBucketSelect.emit(e),this.store.state.filtersExpanded=!1},this.optionLabel=e=>{var t;return"org"!==e||o.c.user?this.i18n[e]:null===(t=o.c.portal)||void 0===t?void 0:t.name},this.options=["my","favorites","group","org","living atlas","all"],this.bucket="my",this.validBucket=void 0,this.validOptions=void 0}updateOptions(e){this.updateValidOptions(e)}async updateValidOptions(e,t){var i,s;const r=this.validBucket,{user:a,portal:l}=o.c;this.validOptions=await j(l,a,e,null===(s=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===s?void 0:s.allowedSubscriptionContentTypes),this.validBucket=this.validOptions.includes(this.bucket)?this.bucket:this.validOptions[0],(r!==this.validBucket||t)&&this.arcgisItemBrowserBucketSelect.emit(this.validBucket)}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.bucketSelect,await this.updateValidOptions(this.options,!0),(0,o.o)("user",(()=>{this.updateValidOptions(this.options)})),(0,o.o)("portal",(()=>{this.updateValidOptions(this.options)}))}render(){const{validOptions:e,validBucket:t,selectOption:i,optionLabel:r}=this;return(0,s.h)(s.H,{key:"61e466b2601e7982451448e1531b6d0ae6afc4db"},(0,s.h)("div",{key:"13faa9deb3c555f53831e060e9f5eed15b76e6fc",class:{large:this.store.state.width>=d.b.sm}},(null==e?void 0:e.length)>0&&(0,s.h)("calcite-dropdown",{key:"172198a6f2a07026a3077ebdb15ecc31741c0956",placement:"bottom-start",scale:"m",widthScale:"m",type:"click"},(0,s.h)("calcite-button",{key:"bafea713b59e4cb941723a314f8a7191d581952c",class:"button",kind:"neutral",appearance:"transparent","icon-end":"chevron-down",slot:"trigger"},r(t)),(0,s.h)("calcite-dropdown-group",{key:"fcb3bb6fd02841d0f2f217007b29914443f6f634",selectionMode:"single"},e.map((e=>(0,s.h)("calcite-dropdown-item",{selected:t===e,onCalciteDropdownItemSelect:()=>i(e)},r(e))))))))}get el(){return(0,s.d)(this)}static get watchers(){return{options:["updateOptions"]}}};H.style=":host{display:block}.large{border-inline-end:1px solid var(--calcite-color-border-3)}.button{padding:0.5rem;--calcite-font-weight-normal:500}";const N=class{constructor(e){var t;(0,s.r)(this,e),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.arcgisItemBrowserActionsOpen=(0,s.c)(this,"arcgisItemBrowserActionsOpen",7),this.arcgisItemBrowserCardSelect=(0,s.c)(this,"arcgisItemBrowserCardSelect",7),this.updateActionsStartEmpty=()=>{var e;this.actionsStartEmpty=!(null===(e=this.el)||void 0===e?void 0:e.querySelector('[slot="actions-start"]'))},this.actionsStartMutationObserver=new MutationObserver(this.updateActionsStartEmpty),this.handleResizeEvent=e=>{e.stopPropagation(),this.width=e.detail.width},this.item=void 0,this.portal=void 0,this.user=void 0,this.api=4,this.baseUrl=null===(t=null===o.c||void 0===o.c?void 0:o.c.config)||void 0===t?void 0:t.baseUrl,this.link=void 0,this.newTab=void 0,this.selected=void 0,this.selection=void 0,this.name=void 0,this.preview=void 0,this.showOwner=!0,this.showDateUpdated=!0,this.showItemType=!0,this.showItemTypeHosted=!1,this.showSummary=!1,this.showBadges=!0,this.showAccess=void 0,this.allowSharing=void 0,this.showFavorite=void 0,this.showThumbnail=!0,this.disableSelection=void 0,this.actions=[],this.hover=void 0,this.formFactor=void 0,this.updatedText="",this.shortUpdatedText="",this.loaded=void 0,this.noSpaceForDate=!0,this.width=void 0,this.actionsStartEmpty=!1}async restoreFocus(){this.link&&this.linkEl?this.linkEl.focus():"top"===this.preview&&this.sectionEl&&this.sectionEl.focus()}async componentWillLoad(){var e,t,i,s,r;this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.card,null!==(e=this.formFactor)&&void 0!==e||(this.formFactor=(null===(t=this.store)||void 0===t?void 0:t.state.panel)?"xs":"lg"),(0,d.s)(this.store).observe(this.el),this.el.addEventListener("arcgisBrowserResize",this.handleResizeEvent),this.actionsStartMutationObserver.observe(this.el,{childList:!0}),this.updateActionsStartEmpty();const a=(0,f.a)(this.item.modified);this.updatedText=this.i18n.lastUpdated.replace("${date}",a),this.shortUpdatedText=a,this.portal=null!==(i=this.portal)&&void 0!==i?i:o.c.portal,this.user=null!==(s=this.user)&&void 0!==s?s:o.c.user,this.api=null!==(r=this.api)&&void 0!==r?r:o.c.api}async componentDidLoad(){await(0,n.t)(100),this.loaded=!0}disconnectedCallback(){var e,t,i,s;null===(i=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.resizeObserver)||void 0===i||i.unobserve(this.el),this.actionsStartMutationObserver.disconnect(),null===(s=this.el)||void 0===s||s.removeEventListener("arcgisBrowserResize",this.handleResizeEvent)}render(){var e,t,i;const{item:r,baseUrl:o,user:a,portal:l,showDateUpdated:n,showFavorite:c,showItemType:h,showItemTypeHosted:u,showOwner:m,showBadges:p,showSummary:g,showThumbnail:v,link:b,newTab:f,showAccess:w,actions:y}=this,I=(null===(e=this.store)||void 0===e?void 0:e.state)||{};return(0,s.h)(s.H,{key:"dc65310f8e41e57b1baaa32db693835d659dc3bf"},(0,s.h)("arcgis-item-card",{key:"bfb892a0458ff1efa482b4924a5885e540f05ec3",item:r,portal:l,user:a,baseUrl:o,link:b,newTab:f,selection:I.selection,name:this.name,preview:this.preview,previewActive:I.preview===r.id,showOwner:m,showDateUpdated:n,showItemType:h,showItemTypeHosted:u,showSummary:g,showBadges:p,showAccess:w,showFavorite:c,showThumbnail:v,useProduction:"all"===this.store.state.bucket&&this.portal.isPortal,actions:y,recycleBin:I.recycleBin,selectedItems:I.selectedItems,panel:I.panel,view:I.view,width:this.width,watchResize:!1,groups:null===(t=I.groupSharing)||void 0===t?void 0:t[r.id],userGroups:I.userContentGroups,allowSharingEdit:this.allowSharing,hideActionsStart:this.actionsStartEmpty,disableSelection:this.disableSelection,onArcgisItemCardInternalUIAction:e=>{e.stopPropagation(),this.arcgisItemBrowserInternalUIAction.emit(e.detail)},onArcgisItemCardActionsOpen:e=>{e.stopPropagation(),this.arcgisItemBrowserActionsOpen.emit(e.detail)},onArcgisItemCardSelect:e=>{e.stopPropagation(),this.arcgisItemBrowserCardSelect.emit(e.detail)}},(0,s.h)("div",{key:"9d6db7c45c7cce2be49193b6655f211410ad3511",slot:"content-top"},(0,s.h)("slot",{key:"6ddefd7eaf086a63d040f0ad20bdaaa7d1de58a5",name:"content-top"})),(0,s.h)("div",{key:"d886d6ae8965745f14de36cb9f9cd442bc7b5d84",slot:"content-end"},(0,s.h)("slot",{key:"c6ea92cfd73d1c419d8442df7b0adb9c713003c9",name:"content-end"})),(0,s.h)("div",{key:"6f03c29018e7be711e7dfdfb250df320afb88d0d",slot:"actions-start"},(0,s.h)("slot",{key:"18d8ac42d196815fbb1dd5d43c6913a2ca460e4c",name:"actions-start"})),this.allowSharing&&(0,s.h)("arcgis-item-share-summary-editable",{key:"7a689c5e67261051bec364e86513c1c47e4b8934",slot:"share-summary",item:r,class:"item-browser-card__access",scale:this.width<d.b.xxs?"s":"m",showText:!1,user:a,allowEdit:!0,groups:null===(i=I.groupSharing)||void 0===i?void 0:i[r.id],userGroups:I.userContentGroups,onClick:e=>{e.stopPropagation(),this.arcgisItemBrowserInternalUIAction.emit({category:"card action",action:"share"})}}),(0,s.h)("div",{key:"2aaf080357ee6cb912003cada7ef620a5834332d",slot:"actions-end"},(0,s.h)("slot",{key:"1fa72c8631534f834cbf690a821d0d4dc3e0ed8a",name:"actions-end"}))))}get el(){return(0,s.d)(this)}};N.style=":host{display:block;min-width:0px}";const W=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserCardSelect=(0,s.c)(this,"arcgisItemBrowserCardSelect",7),this.arcgisItemBrowserCardSelectError=(0,s.c)(this,"arcgisItemBrowserCardSelectError",7),this.ALERT_ANIMATION=300,this.renderSublayer=e=>{const{item:t,store:i}=this,r=!this.isAllowedGeometry(e.geometryType);return(0,s.h)("calcite-dropdown-item",Object.assign({iconStart:$(e.geometryType),selected:(0,m.b)({item:t,sublayer:e,selectedItems:i.state.selectedItems})},r?{ariaDisabled:!0,tabIndex:-1,className:"dropdown-item-disabled"}:{},{ref:e=>{r&&(e.tabIndex=-1)},onCalciteDropdownItemSelect:t=>{const i=t.currentTarget.selected,{item:s}=this;this.arcgisItemBrowserCardSelect.emit({item:s,sublayer:e,selected:"single"===this.selection||!i})}}),(0,s.h)("span",{class:"title"},e.title))},this.renderTask=e=>{const{item:t,store:i}=this;return(0,s.h)("calcite-dropdown-item",{selected:(0,m.b)({item:t,task:e,selectedItems:i.state.selectedItems}),onCalciteDropdownItemSelect:t=>{const i=t.currentTarget.selected,{item:s}=this;this.arcgisItemBrowserCardSelect.emit({item:s,task:e,selected:"single"===this.selection||!i})}},(0,s.h)("span",{class:"title"},e))},this.isAllowedGeometry=e=>{var t,i,s,r,o,a;return(null===(s=null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.allowedGeometries)||void 0===s?void 0:s.includes(e))||!(null===(a=null===(o=null===(r=this.store)||void 0===r?void 0:r.state)||void 0===o?void 0:o.allowedGeometries)||void 0===a?void 0:a.length)},this.sortSublayers=(e,t)=>{const i=this.isAllowedGeometry(e.geometryType);return i===this.isAllowedGeometry(t.geometryType)?t.id-e.id:i?-1:1},this.renderSelectText=e=>{var t,i,s;const{selection:r,item:o,i18n:a}=this;if(this.isTask)return 1===(null==e?void 0:e.length)?null===(t=a.selectedTask)||void 0===t?void 0:t.replace("${task}",e[0].task):a.selectTask;const l="multiple"===r;if(o&&!o.sublayers)return(0,m.b)({item:o,selectedItems:null===(i=this.store)||void 0===i?void 0:i.state.selectedItems})?a.selectedSingle:a.select;if(0===(null==e?void 0:e.length))return l?a.selectLayers:a.select;if(l)return a.selectedLayers.replace("${num}",`${e.length}`);const n=e[0];return a.selectedName.replace("${name}",null===(s=n.sublayer)||void 0===s?void 0:s.title)},this.item=void 0,this.user=void 0,this.portal=void 0,this.width="auto",this.appearance="outline",this.selection=void 0,this.sublayers=void 0,this.tasks=void 0,this.loading=!1,this.fetched=!1,this.alertActive=!1,this.showErrors=!1}clearAlert(){this.closeAlert()}async componentWillLoad(){var e,t;if(this.store=(0,p.g)(this.el),this.i18n=null===(e=this.store)||void 0===e?void 0:e.state.i18n.cardSublayerSelect,this.sublayers=null===(t=this.item)||void 0===t?void 0:t.sublayers,this.item)if("Geoprocessing Service"!==this.item.type)if(this.item.sublayers)this.sublayers=this.item.sublayers;else{const e=(0,y.i)("serviceInfo",this.item.id);(null==e?void 0:e.result)&&this.processResponse(e)}else this.isTask=!0}async closeAlert(){this.showErrors&&(this.alertActive=!1,await(0,n.t)(this.ALERT_ANIMATION),this.showErrors=!1)}async fetchTasks(){var e;if(this.arcgisItemBrowserCardSelectError.emit(this.item.id),!this.tasks){this.loading=!0;try{const[t]=await(0,I.l)(["esri/request"]),i=await t(this.item.url,{query:{f:"json"}}),s=null===(e=null==i?void 0:i.data)||void 0===e?void 0:e.tasks;if(!s)throw new Error;1===(null==s?void 0:s.length)&&(this.arcgisItemBrowserCardSelect.emit({item:this.item,task:s[0],selected:!0}),this.dropdown&&(this.dropdown.open=!1,await(0,n.t)(200))),this.tasks=s}catch(e){await(0,n.t)(this.ALERT_ANIMATION),this.showErrors=!0,await(0,n.t)(this.ALERT_ANIMATION),this.alertActive=!0}this.loading=!1}}processResponse(e){var t;if(null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.sublayers){const t=e.result.sublayers.map(M).sort(this.sortSublayers);this.sublayers=t,this.item.sublayers=t,this.fetched=!0}else e.error&&(this.alertActive=!0)}async attemptLoad(){var e;this.loading=!0,this.alertActive=!1;const t=await(0,y.f)((()=>(0,w.f)({item:this.item,portal:this.portal,layers:null,isSecure:!1})),"serviceInfo",this.item.id);return this.processResponse(t),await(0,n.t)(100),this.dropdown&&(this.dropdown.open=!0),this.loading=!1,!!(null===(e=this.sublayers)||void 0===e?void 0:e.length)}render(){var e,t,i,r;const{store:o,width:a,appearance:l,loading:n,i18n:c,alertActive:d,isTask:h,item:u}=this;if(!o||!u)return null;const p=null==o?void 0:o.state.selectedItems,g=(0,m.f)({item:u,selectedItems:p}),v=(0,m.b)({item:u,selectedItems:p});return(0,s.h)(s.H,null,(null===(e=null==u?void 0:u.sublayers)||void 0===e?void 0:e.length)||h?(0,s.h)("calcite-dropdown",{class:"dropdown",widthScale:"l",placement:"solid"===l?"top":"bottom-end",scale:"m",closeOnSelectDisabled:!h,overlayPositioning:"fixed",ref:e=>this.dropdown=e},(0,s.h)("calcite-button",{loading:n,disabled:n,slot:"trigger",scale:"m",appearance:(null==g?void 0:g.length)||"solid"===l?"solid":"outline",kind:"neutral",iconEnd:"chevron-down",width:a,onClick:()=>{h&&!this.tasks&&this.fetchTasks()}},this.renderSelectText(g)),(0,s.h)("calcite-dropdown-group",{selectionMode:this.selection,class:"dropdown-group",groupTitle:!n&&this.isTask&&(null===(t=this.tasks)||void 0===t?void 0:t.length)?c.selectTaskFrom.replace("${title}",u.title):""},h?null===(i=this.tasks)||void 0===i?void 0:i.map(this.renderTask):null===(r=this.sublayers)||void 0===r?void 0:r.sort(this.sortSublayers).map(this.renderSublayer))):(0,s.h)("calcite-button",{loading:n,disabled:n||d,class:"dropdown",slot:"trigger",scale:"m",appearance:(null==g?void 0:g.length)?"solid":"outline",kind:"neutral",width:a,onClick:async()=>{if(this.item&&!this.sublayers&&"Image Service"!==this.item.type&&!this.fetched){if(await this.attemptLoad()||this.alertActive)return}this.arcgisItemBrowserCardSelect.emit({item:u,selected:!v})}},this.renderSelectText(g)),this.showErrors&&(0,s.h)("arcgis-tunnel",{reference:this.el},(0,s.h)("calcite-alert",{label:c.errorTitle,icon:!0,kind:"danger",onCalciteAlertClose:()=>{this.alertActive=!1},open:!!d,tabIndex:d?null:-1,style:{"--calcite-z-index-toast":"999",zIndex:"999"}},(0,s.h)("div",{slot:"title"},c.errorTitle),(0,s.h)("div",{slot:"message",class:"alert__message"},c.errorBody),!h&&(0,s.h)("calcite-link",{slot:"link",onClick:async()=>{(0,y.c)("serviceInfo",this.item.id),await this.attemptLoad()}},c.retry))))}get el(){return(0,s.d)(this)}};W.style=".title{max-width:32rem;word-wrap:break-word;word-break:break-word}.dropdown-item-disabled{pointer-events:none;opacity:var(--calcite-opacity-disabled)}.dropdown{display:block}.dropdown-group{max-height:10rem}";const q=class{constructor(e){(0,s.r)(this,e),this.item=void 0,this.user=void 0,this.portal=void 0,this.useProduction=!1}async componentWillLoad(){var e,t;this.store=(0,p.g)(this.el),this.useProduction=await(0,u.i)(this.portal,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket),(0,p.a)(this.store,(async()=>{var e,t;this.useProduction=await(0,u.i)(this.portal,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)}))}async handlePortalChange(e){var t,i;this.useProduction=await(0,u.i)(e,null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.bucket)}render(){const{item:e,user:t,portal:i,useProduction:r}=this;return(0,s.h)(s.H,{key:"843ff91154ef2c7df4960229dab81cc10c8dd0d1"},(0,s.h)("arcgis-item-thumbnail",{key:"1586674660c60758816b8a94c033122806c388b3",item:e,user:t,portal:i,useProduction:r}))}get el(){return(0,s.d)(this)}static get watchers(){return{portal:["handlePortalChange"]}}},V=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.actionElement=void 0,this.actions=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el)}getColumnCount(e){if("grid"!==this.store.state.view)return 1;const t=this.store.state.filtersEmpty?1:0;switch(!0){case e<d.b.xs:return 1;case e<d.b.sm:case e<d.b.md:return 2;case e<d.b.xl:return 2+t;default:return 3+t}}async updateActionsMenu(e){var t;const{actions:i,el:s}=e.detail;if(s===this.actionElement&&(null===(t=this.popoverElement)||void 0===t?void 0:t.open))return this.popoverElement.open=!1,void this.focusAction();this.actions=i,this.actionElement=s,await(0,n.t)(100),this.popoverElement&&(this.popoverElement.open=!0)}async handleCardOpen(e){this.updateActionsMenu(e)}async focusAction(){var e,t,i,s;null===(t=null===(e=this.actionElement)||void 0===e?void 0:e.focus)||void 0===t||t.call(e),null===(s=null===(i=this.actionElement)||void 0===i?void 0:i.setFocus)||void 0===s||s.call(i)}render(){var e;const t=this.store.state.view,i=this.getColumnCount(this.store.state.width);return(0,s.h)(s.H,{key:"7b410b06170ddc6ca14797f3f1367b55a691cf27"},(0,s.h)("div",{key:"d187dff5f2b4edf9c3f297fdf9649be0950c0e5d",class:{["grid"===t?"grid-container":t]:!0,[`columns-${i}`]:!0,"no-space":this.store.state.width<d.b.xs&&this.store.state.panel}},(0,s.h)("slot",{key:"279f44c7460393d96958bbeae298aa6101e53c0b"})),(0,s.h)("calcite-popover",{key:"4442e0621842b91264ebe1f702bcd3ad4d15b588",referenceElement:this.actionElement,label:this.store.state.i18n.card.moreOptions,placement:"bottom-end",scale:"m",overlayPositioning:"fixed",pointerDisabled:!0,autoClose:!0,triggerDisabled:!0,onCalcitePopoverClose:()=>{this.focusAction()},ref:async e=>{this.popoverElement=e}},(0,s.h)("calcite-dropdown-group",{key:"2e8d9f03da87b43dabd728688343aed21d812922",selectionMode:"none",onKeyDown:e=>{e.stopPropagation()}},null===(e=this.actions)||void 0===e?void 0:e.map((({text:e,newTab:t,link:i,id:r,action:o})=>(0,s.h)("calcite-dropdown-item",Object.assign({onClick:t=>{this.arcgisItemBrowserInternalUIAction.emit({category:"card action",action:"more options",attribute:r||e}),o&&(this.popoverElement.open=!1,t.preventDefault(),o())},key:e},!o&&i?Object.assign(Object.assign({},t?{target:"_blank",rel:"noopener noreferrer"}:{}),{href:i}):{}),e))))))}get el(){return(0,s.d)(this)}};V.style=":host{--arcgis-item-browser-content-spacing:0.5rem}.grid-container slot,.list slot{display:grid;grid-gap:var(--arcgis-item-browser-content-spacing)}.columns-1 slot{grid-template-columns:repeat(1, 1fr)}.columns-2 slot{grid-template-columns:repeat(2, 1fr)}.columns-3 slot{grid-template-columns:repeat(3, 1fr)}.columns-4 slot{grid-template-columns:repeat(4, 1fr)}.no-space slot{gap:0.25rem}";const K=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserCategorySchemaUpdate=(0,s.c)(this,"arcgisItemBrowserCategorySchemaUpdate",7),this.arcgisItemBrowserCategoryEditSuccess=(0,s.c)(this,"arcgisItemBrowserCategoryEditSuccess",7),this.refetchCategories=async()=>{(null===o.c||void 0===o.c?void 0:o.c.portal)&&await this.fetchCategories(o.c.portal,!1)},this.displayNames={},this.fetchCategories=async(e,t=!1)=>{var i,s,r,a,l,n,c,d,h,u;const m="living atlas"===(null===(s=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===s?void 0:s.bucket),p="group"===(null===(a=null===(r=this.store)||void 0===r?void 0:r.state)||void 0===a?void 0:a.bucket)||!(null===(n=null===(l=this.store)||void 0===l?void 0:l.state)||void 0===n?void 0:n.bucket)&&(null===(d=null===(c=this.store)||void 0===c?void 0:c.state)||void 0===d?void 0:d.groupId),g=this.groupId;if(this.isAllGroups())return this.schema=null,void this.arcgisItemBrowserCategorySchemaUpdate.emit(null);const v=m?await(0,k.a)(e,"LivingAtlas",t):g&&"all"!==g&&p?await(0,k.b)(g,e,t):await(0,k.f)(e,null===o.c||void 0===o.c?void 0:o.c.user,t),b=null===(u=null===(h=null==v?void 0:v.categorySchema)||void 0===h?void 0:h[0])||void 0===u?void 0:u.categories;this.setSchema(b),this.loading=!1},this.setSchema=e=>{this.schema=e,this.arcgisItemBrowserCategorySchemaUpdate.emit(e)},this.renderSchemaEditor=()=>{const{groupId:e,allowEdit:t,isEditing:i,handleEditSchemaComplete:r,setSchema:a,isCategorizingGroup:l}=this,{user:n,portal:c}=o.c;return t?(0,s.h)("arcgis-tunnel",{reference:this.el},(0,s.h)("arcgis-item-category-schema-editor",{isActive:i,group:l()?{id:e}:void 0,user:n,config:o.c.config,portal:c,onWorkflowCancel:async e=>{e.detail?(r(e.detail.hasChangeSinceLastOpen),e.detail.hasChangeSinceLastOpen&&this.arcgisItemBrowserCategoryEditSuccess.emit()):this.isEditing=!1},onNewSchemaWorkflowComplete:async({detail:e})=>{this.isEditing=!1,a(e.newSchema),this.arcgisItemBrowserCategoryEditSuccess.emit()},onDeleteAllSchema:async()=>{r(!0),this.arcgisItemBrowserCategoryEditSuccess.emit()}})):null},this.handleEditSchemaComplete=async e=>{this.isEditing=!1,e&&await this.refetchCategories();const{category:t,schema:i,clearFilter:s,checkSchemaFilterStillValid:r}=this;t&&!r(i,t,x.U)&&s()},this.checkSchemaFilterStillValid=(e,t,i)=>(null!=e?e:[]).some((e=>{var s;const r=(0,x.b)(i,e,!1);return r===t||!!(null===(s=e.categories)||void 0===s?void 0:s.length)&&this.checkSchemaFilterStillValid(e.categories,t,r)})),this.clearFilter=()=>{this.category=null,this.emitFilterEvent()},this.isCategorizingGroup=()=>{var e;const t=null===(e=this.store)||void 0===e?void 0:e.state.bucket,i=this.groupId;return(!t||"group"===t)&&i&&"all"!==i},this.category=void 0,this.expanded=void 0,this.groupId=void 0,this.allowEdit=void 0,this.loading=void 0,this.schema=[],this.isEditing=!1,this.canEdit=!1,this.tooltipReferenceElement=void 0}updateCanEdit(){this.checkAllowEdit()}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterCategories,this.store.state.groupId&&(this.groupId=this.store.state.groupId),(null===o.c||void 0===o.c?void 0:o.c.portal)?(await this.fetchCategories(o.c.portal),await this.checkAllowEdit()):(0,o.o)("portal",(e=>{this.fetchCategories(e)})),(0,S.b)(this.store,(()=>{this.groupId=this.store.state.groupId,this.fetchCategories(o.c.portal)})),(0,S.a)("categories",this.store,(()=>this.category=null)),(0,p.a)(this.store,(()=>{this.fetchCategories(o.c.portal)}))}isAllGroups(){var e,t;const i=this.groupId;return"group"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&(!i||"all"===i)}async checkAllowEdit(){const{allowEdit:e,groupId:t}=this,{user:i,portal:s}=o.c;this.canEdit=!!e&&((!t||"all"!==t)&&await(async({groupId:e,portal:t,user:i})=>{var s;const r=!i,o=(0,g.a)(i),a=(0,g.e)(i),l=(0,g.c)(i),n=!!e,c=n?await(0,C.f)(e,t):null,d=null==c?void 0:c.owner,h=n?await(0,F.h)(d,t):null,u=!o&&i.orgId===(null==h?void 0:h.orgId),m=null===(s=null==c?void 0:c.userMembership)||void 0===s?void 0:s.memberType,p=!r&&("owner"===m||"admin"===m||u&&(0,g.f)(i)),v=!r&&!o&&(l||a&&(0,g.g)(i));return c?p:v})({user:i,portal:s,groupId:t}))}async componentDidLoad(){this.category&&this.emitFilterEvent(),this.store.onChange("bucket",(()=>this.refetchCategories())),this.store.onChange("groupId",(()=>{this.refetchCategories(),this.checkAllowEdit()}))}emitFilterEvent(){const{category:e,i18n:t,displayNames:i}=this,s=e?JSON.stringify([e]):"",r="_none_"===e?t.uncategorized:i[e]||(null==e?void 0:e.replace("/Categories/","")),o=t.category.replace("${category}",r);this.arcgisItemBrowserFilter.emit({id:"categories",param:"categories",value:s,label:o,category:e})}renderNestedCategories(e,t){return e.map((e=>{var i;const r=t?`${t}/${e.title}`:`/Categories/${e.title}`;this.displayNames[r]=e.displayName||e.title;const o=!!(null===(i=e.categories)||void 0===i?void 0:i.length);return(0,s.h)("calcite-tree-item",{"data-value":r,"data-displayName":e.displayName||e.title,"data-children":o,selected:this.category===r,key:`${r}--${o}`},(0,s.h)("a",{class:"category-link"},(0,s.h)("span",{id:`${r}-toggle`},e.displayName||e.title)),Boolean(e.description)&&(0,s.h)("calcite-tooltip",{referenceElement:`${r}-toggle`},e.description),o&&(0,s.h)("calcite-tree",{slot:"children",selectionMode:"children"},this.renderNestedCategories(e.categories,r)))}))}render(){var e;const{loading:t,schema:i,allowEdit:r,canEdit:a,i18n:l,renderSchemaEditor:n,groupId:c,isCategorizingGroup:d}=this,h=null===(e=this.store)||void 0===e?void 0:e.state.bucket,u=(null==i?void 0:i.length)>0;if(t||!u&&!r||this.isAllGroups()||(0,g.a)(o.c.user)&&"group"!==h)return null;const m=d();return(0,s.h)(s.F,null,(0,s.h)("arcgis-browser-filter",{heading:this.i18n.categories,expanded:this.expanded,active:!!this.category,filterID:"categories",onArcgisBrowserFilterRemove:()=>{this.category=null}},u?(0,s.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const s=e.target,r=null===(i=null===(t=null==s?void 0:s.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==r?void 0:r.value)||"";this.category===o?this.category=null:this.category=o,this.emitFilterEvent()}},!!c&&"group"===h&&(0,s.h)("calcite-tree-item",{"data-value":"_none_",selected:"_none_"===this.category},(0,s.h)("a",{class:"category-link"},l.uncategorized)),this.renderNestedCategories(i)):(0,s.h)("div",null,(0,s.h)("p",{class:"no-category-title"},l[m?"noGroupCategoriesTitle":"noCategoriesTitle"]),(0,s.h)("p",{class:"no-category-description"},l[m?"noGroupCategories":"noCategories"]),a&&(0,s.h)("calcite-button",{class:"add-category-button",appearance:"outline",color:"blue",onClick:()=>this.isEditing=!0},l[m?"setupGroupCategories":"setupCategories"])),u&&r&&a&&"living atlas"!==h&&(0,s.h)(s.F,null,(0,s.h)("calcite-button",{iconStart:"pencil",appearance:"transparent",kind:"neutral",slot:"action","aria-label":l.configureCategories,onClick:()=>this.isEditing=!0,ref:e=>this.tooltipReferenceElement=e}),(0,s.h)("calcite-tooltip",{referenceElement:this.tooltipReferenceElement},l.configureCategories))),n())}get el(){return(0,s.d)(this)}static get watchers(){return{allowEdit:["updateCanEdit"]}}};K.style=".no-category-title{margin-bottom:0.25rem;margin-top:1rem;font-size:1rem}.no-category-description{overflow-wrap:break-word}.no-category-description:not(:last-child){margin-bottom:1rem;margin-top:0px}.add-category-button{max-width:100%;overflow-wrap:break-word}.category-link{padding-top:0.25rem;padding-bottom:0.25rem}";const Q=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.loadCollaborations=async()=>{const{portal:e,user:t,config:i,subscriptionInfo:s}=null!==o.c&&void 0!==o.c?o.c:{};!this.collaborations&&e&&t&&!(0,g.a)(t)&&(0,g.h)(i,t,e,s)&&(this.collaborations=await(0,u.j)(o.c.portal),this.collaboration&&this.emitEvent())},this.collaboration=void 0,this.participant=void 0,this.collaborationName=void 0,this.expanded=void 0,this.collaborations=void 0}componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterCollaborations}async componentDidLoad(){this.loadCollaborations(),(0,o.o)("portal",this.loadCollaborations),(0,o.o)("user",this.loadCollaborations),(0,o.o)("subscriptionInfo",this.loadCollaborations),(0,S.a)("collaborations",this.store,(()=>this.collaboration=null))}async getEventDetail(){var e,t,i;const{collaboration:s,participant:r,i18n:o}=this;if(!s)return{id:"collaborations",param:"q",value:"",label:"",collaboration:{id:"",name:""}};this.collaborations||await this.loadCollaborations();const a=null==s?void 0:s.split("__"),l=a[0],n=r||a[1],c=null===(e=this.collaborations)||void 0===e?void 0:e.find((e=>e.collaborationId===l)),d=n?null===(i=null===(t=c.participants)||void 0===t?void 0:t.find((e=>e[n])))||void 0===i?void 0:i[n]:c.collaborationName,h=n?`__${n}`:"";return{id:"collaborations",param:"q",value:"_temp_",label:d?o.label.replace("${name}",d):"",collaboration:{id:s,name:d},additionalParams:{origin:`${s}${h}`}}}async emitEvent(){const e=await this.getEventDetail();this.arcgisItemBrowserFilter.emit(e)}renderParticipant(e,t){var i;const[r,o]=Object.entries(e)[0],a=`${t}/${r}`;return(0,s.h)("calcite-tree-item",{"data-id":a,"data-name":o,selected:null===(i=this.collaboration)||void 0===i?void 0:i.includes(a)},(0,s.h)("a",null,o))}render(){const{config:e,user:t,portal:i,subscriptionInfo:r}=o.c,{collaborations:a}=this;return t&&(0,g.h)(e,t,i,r)&&(null==a?void 0:a.length)?(0,s.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.collaboration,filterID:"collaborations",onArcgisBrowserFilterRemove:()=>{this.collaboration=null}},(0,s.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const s=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0],[r,o]=null!==(i=null==s?void 0:s.dataset.id.split("/"))&&void 0!==i?i:[],a=null==s?void 0:s.dataset.name;a&&(this.collaboration!==r||o&&o!==this.participant?(this.collaboration=r,this.collaborationName=a,this.participant=o):(this.collaboration=null,this.collaborationName=null,this.participant=null),this.emitEvent())}},a.map((({collaborationId:e,collaborationName:t,participants:i})=>{var r;return(0,s.h)("calcite-tree-item",{"data-id":e,"data-name":t,selected:null===(r=this.collaboration)||void 0===r?void 0:r.includes(e)},(0,s.h)("a",null,t),(null==i?void 0:i.length)&&(0,s.h)("calcite-tree",{slot:"children"},(i||[]).map((t=>this.renderParticipant(t,e)))))})))):null}get el(){return(0,s.d)(this)}},J=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.contentStatus=void 0,this.expanded=void 0}componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterContentStatus}componentDidLoad(){this.contentStatus&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,S.a)("contentStatus",this.store,(()=>this.contentStatus=null))}getEventDetail(){var e;const{contentStatus:t,i18n:i}=this,{user:s,portal:r}=o.c,a=r&&!r.isPortal?` orgid:${r.id}`:"";return{id:"contentStatus",param:"q",value:null!==(e={authoritative:s&&!(0,g.a)(s)?`((contentstatus:org_authoritative${a}) OR contentstatus:public_authoritative)`:"contentstatus:public_authoritative",deprecated:"contentstatus:deprecated"}[t])&&void 0!==e?e:"",label:t?i.label.replace("${contentStatus}",i[t]):"",contentStatus:t}}render(){return(0,s.h)("arcgis-browser-filter",{key:"146daf1ee49d3121893a83fb250e95c802ae2962",heading:this.i18n.title,expanded:this.expanded,active:!!this.contentStatus,filterID:"contentStatus",onArcgisBrowserFilterRemove:()=>{this.contentStatus=null}},(0,s.h)("calcite-tree",{key:"820dde524a741c992e537f7273516c919d4ad0e9",selectionMode:"single",scale:"m",onCalciteTreeSelect:e=>{var t;const i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0],s=null==i?void 0:i.dataset.contentStatus;this.contentStatus===s?this.contentStatus=null:this.contentStatus=s,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},["authoritative","deprecated"].map((e=>(0,s.h)("calcite-tree-item",{"data-content-status":e,selected:e===this.contentStatus},(0,s.h)("a",null,this.i18n[e]))))))}get el(){return(0,s.d)(this)}},Y=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.property="modified",this.range=void 0,this.start=void 0,this.end=void 0,this.expanded=void 0}componentWillLoad(){this.store=(0,p.g)(this.el)}getEventDetail(e){return Object.assign({param:"q"},e)}render(){const{property:e,range:t,start:i,end:r,store:o,expanded:a}=this;return(0,s.h)("arcgis-browser-filter-date",{key:"6642ba84466bebb0db207b931e71139e0cebb9ed",serverProperty:"modified"===e?e:"uploaded",property:this.property,store:o,start:i,end:r,range:t,expanded:a,onArcgisBrowserFilter:e=>{this.arcgisItemBrowserFilter.emit(this.getEventDetail(e.detail))}})}get el(){return(0,s.d)(this)}},X=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.extent=void 0,this.checked=void 0}emitCheckedChange(){this.arcgisItemBrowserFilter.emit(this.getEventDetail())}emitExtentChange(){this.checked&&this.arcgisItemBrowserFilter.emit(this.getEventDetail())}componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterExtent}componentDidLoad(){this.extent&&this.checked&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,S.a)("extent",this.store,(()=>this.checked=!1))}getEventDetail(){const{extent:e,checked:t,i18n:i}=this;return{id:"extent",param:"bbox",value:t&&e?e:"",label:e&&t?i.label:"",extent:e}}render(){var e,t;return(0,s.h)(s.H,{key:"5df8d6e489ff0e56ca1ba38ba9c2f55dfaf54028"},(0,s.h)("div",{key:"5c37e244f257132219025e530010ff00c0470f32",class:{"filter-extent":!0,"filter-extent--padded":null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.panel}},(0,s.h)("calcite-label",{key:"9f3cf9dc26c266596672fc03d5a36060785f0e8a",layout:"inline",class:"filter-extent__wrap"},(0,s.h)("span",{key:"0c585022157c8426a2eea2f4d54519fc4d2aa81f",class:"filter-extent__label"},this.i18n.title),(0,s.h)("calcite-switch",{key:"9562f21b82c3fc108e4d1951449c2baedbae29e2",class:"filter-extent__switch",checked:this.checked,onCalciteSwitchChange:e=>{this.checked=e.target.checked}}))))}get el(){return(0,s.d)(this)}static get watchers(){return{checked:["emitCheckedChange"],extent:["emitExtentChange"]}}};X.style=".filter-extent{margin-bottom:0.5rem;display:flex;width:100%}.filter-extent__wrap{width:100%}.filter-extent__label{flex:1 1 0%}.filter-extent__switch{padding-left:0.25rem;padding-right:0.25rem}.filter-extent--padded{box-sizing:border-box;padding-left:0.5rem;padding-right:0.5rem;padding-bottom:0px;padding-top:1rem;margin-bottom:-1px;border-bottom:1px solid var(--calcite-color-border-2)}";const Z=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserFolderDelete=(0,s.c)(this,"arcgisItemBrowserFolderDelete",7),this.arcgisItemBrowserFolderDeleteFail=(0,s.c)(this,"arcgisItemBrowserFolderDeleteFail",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.hovered=!1,this.folder="all",this.showRecycle=void 0,this.allowEdits=void 0,this.expanded=void 0,this.folders=[],this.currentEdit=void 0,this.deleteFolderId=void 0,this.createOpen=void 0,this.createClosing=void 0,this.createTitle="",this.deleteOpen=void 0,this.deleteClosing=void 0,this.processing=void 0,this.tooltip=void 0,this.tooltipReferenceElement=void 0,this.deleteItemsModalRef=void 0,this.deleteFolderContent=void 0,this.createFolderError=null,this.tooltipElement=void 0,this.editFolderError=null}async updateFolders(){this.fetchUserFolders(this.user)}navigateToFolder(){var e;(null===(e=this.folders)||void 0===e?void 0:e.length)&&this.arcgisItemBrowserFilter.emit(this.getEventDetail())}componentWillLoad(){var e;this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterFolder,this.user=this.store.state.contentUser||o.c.user,this.specialFolders={all:{id:"all",created:new Date,title:this.store.state.contentUser?this.i18n.allContentUser.replace("${username}",this.user.username):this.i18n.all,username:""},recycle:{created:"now",id:"recycle",title:this.i18n.recycleBin,username:null===(e=this.user)||void 0===e?void 0:e.username}},"recycle"!==this.folder||o.c.portal.recycleBinEnabled||(this.folder="all"),this.user?this.fetchUserFolders(this.user):((0,p.b)(this.store,(e=>{this.user=e,this.fetchUserFolders(e)})),(0,o.o)("user",(e=>{this.user||(this.fetchUserFolders(e),this.user=e)})))}async componentDidLoad(){var e,t,i,s;if((null===(i=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.filters)||void 0===i?void 0:i.folder)&&(this.folder=this.store.state.filters.folder.folder),this.folder&&"all"!==this.folder){this.arcgisItemBrowserFilter.emit(this.getEventDetail()),await(0,n.t)(100);const e=Array.from(null===(s=this.el)||void 0===s?void 0:s.querySelectorAll("calcite-list-item")).find((e=>e.dataset.id===this.folder));e&&e.scrollIntoView({block:"center",inline:"nearest",behavior:"smooth"})}this.expanded&&this.accordionItem&&(this.accordionItem.expanded=!0),(0,S.a)("folder",this.store,(()=>this.folder="all"))}getEventDetail(){var e;const{user:t}=this,i=this.folder||"all",s=i===t.username?"root":i,r=null===(e=this.folders)||void 0===e?void 0:e.find((e=>e.id===i)),o=(null==r?void 0:r.title)||"";return{id:"folder",param:"q",value:"all"!==i?`ownerfolder:${s}`:"",label:this.i18n.label.replace("${folder}",o),folder:i,folderData:r}}emitInternalAction(e){this.arcgisItemBrowserInternalUIAction.emit({category:"folder action",action:e})}async refreshFilteredItems(){const e=this.listElement.filterText;e&&(this.listElement.filterText="",await(0,n.t)(10),this.listElement.filterText=e)}resetEdit(){this.inlineEdit=null,this.currentEdit=null,this.editFolderError=null}async resetCreate(){this.createClosing=!0,await(0,n.t)(250),this.createOpen=!1,this.createClosing=!1,this.processing=!1,this.createTitle="",this.createFolderError=null}async resetDelete(){this.deleteClosing=!0,await(0,n.t)(250),this.deleteOpen=!1,this.deleteClosing=!1,this.processing=!1,this.deleteFolderId=""}async setTooltip(e,t,i){i&&(await(0,n.t)(40),!t.matches(`${t.tagName}:hover`))||(this.tooltip=e,this.tooltipReferenceElement=t,requestAnimationFrame((()=>{!this.tooltipElement||i&&!t.matches(`${t.tagName}:hover`)||(this.tooltipElement.open=!0,this.tooltipReferenceElement.addEventListener("mouseout",(async()=>{await(0,n.t)(200),this.tooltipReferenceElement===t&&(this.tooltipElement.open=!1)})),this.tooltipReferenceElement.addEventListener("keydown",(e=>{"Escape"===e.key&&(this.tooltipElement.open=!1)})))})))}async createFolder(){var e;const{createTitle:t,i18n:i}=this;this.emitInternalAction("create folder"),this.createFolderError=null;const s=(0,B.g)(t,this.folders);if(s)return void(this.createFolderError=null===(e=this.i18n.error[s])||void 0===e?void 0:e.replace("${folder}",t));this.processing=!0;const{error:r}=await(0,F.c)(t,this.user);if(r){const e="folderNameExists"===r.code?"folderAlreadyExists":"errorCreatingFolder";return this.createFolderError=i.error[e].replace("${folder}",t).replace("${folderName}",t),void(this.processing=!1)}this.resetCreate(),this.fetchUserFolders(this.user),this.refreshFilteredItems()}async updateFolder(e){const t=await(0,F.u)(e.id,this.currentEdit.title,this.user);(null==t?void 0:t.error)?this.editFolderError=this.i18n.error.errorCreatingFolder.replace("${folderName}",this.currentEdit.title):(this.folders=this.folders.map((t=>(t.id==e.id&&(t.title=this.currentEdit.title),t))),this.resetEdit()),this.refreshFilteredItems()}async fetchUserFolders(e){const{specialFolders:t}=this,i=await(0,F.a)(e);this.folders=[t.all,...i],this.folder&&![...this.folders,t.recycle].some((e=>e.id===this.folder))&&(this.folder="all",this.arcgisItemBrowserFilter.emit(this.getEventDetail()))}canEditFolder(){var e,t;return!(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.contentUser)||(0,g.c)(null===o.c||void 0===o.c?void 0:o.c.user)&&!(0,g.e)(null===o.c||void 0===o.c?void 0:o.c.user)}renderListItem(e){var t,i;const{i18n:r}=this,{title:o,id:a}=e,l=["all",null===(t=this.user)||void 0===t?void 0:t.username,"recycle"];return(0,s.h)("calcite-list-item",{class:{folder:!0,"recycle-bin":"recycle"===a},label:o,value:o,key:a,"data-id":a,onCalciteListItemSelect:()=>{this.resetEdit(),this.folder=a,this.emitInternalAction("select folder")},selected:this.folder===a},(0,s.h)("calcite-icon",{icon:(0,B.a)({folderId:a,currentUsername:null===(i=this.user)||void 0===i?void 0:i.username,selectedFolderId:this.folder}),slot:"content-start",scale:"s"}),!l.includes(a)&&this.allowEdits&&this.canEditFolder()&&(0,s.h)(s.F,null,(0,s.h)("calcite-action",{class:"folder-action",icon:"pencil",text:r.editFolder,slot:"content-end",scale:"s",onClick:t=>{t.stopPropagation(),this.resetEdit(),this.currentEdit=Object.assign({},e),this.emitInternalAction("edit folder")},onMouseOver:e=>{this.setTooltip(r.editFolder,e.target,!0)},onFocus:e=>{this.setTooltip(r.editFolder,e.target)},id:`${a}-edit-button`}),(0,s.h)("calcite-action",{icon:"trash",text:r.deleteFolder,slot:"actions-end",class:"folder-action",scale:"s",id:`${a}-delete-button`,onMouseEnter:e=>{this.setTooltip(r.deleteFolder,e.target,!0)},onFocus:e=>{this.setTooltip(r.deleteFolder,e.target)},onClick:async()=>{this.emitInternalAction("delete folder"),this.deleteFolderId=e.id,this.deleteOpen=!0}})))}renderEdit(e){const{i18n:t}=this;return(0,s.h)(s.F,null,(0,s.h)("form",{class:"folder-edit",onSubmit:t=>{var i,s;t.preventDefault();const r=null===(i=this.currentEdit)||void 0===i?void 0:i.title;(null==r?void 0:r.trim())===e.title&&this.resetEdit(),this.editFolderError=null;const o=(0,B.g)(r,this.folders);if(o)return console.log(o),void(this.editFolderError=null===(s=this.i18n.error[o])||void 0===s?void 0:s.replace("${folder}",r));this.editFolderError=null,this.updateFolder(e)}},(0,s.h)("input",{class:"folder-edit__input",value:e.title,onInput:e=>{this.currentEdit.title=e.target.value},onKeyDown:e=>{if(["Home","End"].includes(e.key)){e.preventDefault();const t=e.target,i=t.value.length,s="Home"===e.key?0:i;t.setSelectionRange(s,s)}["ArrowDown","ArrowUp"].includes(e.key)&&e.stopPropagation(),"Escape"===e.key&&this.resetEdit()},maxLength:124,ref:e=>{!this.inlineEdit&&this.currentEdit&&(this.inlineEdit=e,requestAnimationFrame((()=>{null==e||e.focus()})))}}),(0,s.h)("calcite-icon",{icon:"folder",class:"folder-edit__icon",scale:"s"}),(0,s.h)("calcite-button",{iconStart:"x",label:t.cancel,appearance:"outline",kind:"neutral",scale:"m",onClick:()=>this.resetEdit(),onMouseEnter:e=>{this.setTooltip(t.cancel,e.target,!0)},onFocus:e=>{this.setTooltip(t.cancel,e.target)}}),(0,s.h)("calcite-button",{iconStart:"check",label:t.save,appearance:"solid",kind:"brand",scale:"m",type:"submit",onMouseEnter:e=>{this.setTooltip(t.save,e.target,!0)},onFocus:e=>{this.setTooltip(t.save,e.target)}})),(0,s.h)("calcite-notice",{open:!!this.editFolderError,kind:"danger",scale:"s",closable:!0,onCalciteNoticeClose:()=>{this.editFolderError=null}},(0,s.h)("div",{slot:"message"},this.editFolderError)))}renderCreate(){const{i18n:e,el:t,createFolderError:i}=this;return(0,s.h)("arcgis-tunnel",{reference:t,key:"create-modal"},(0,s.h)("calcite-modal",{open:!this.createClosing,onCalciteModalClose:()=>this.resetCreate(),outsideCloseDisabled:!0,scale:"m",widthScale:"s"},(0,s.h)("h2",{slot:"header",class:"header"},e.createAFolder),(0,s.h)("div",{slot:"content"},(0,s.h)("calcite-label",null,e.folderName,(0,s.h)("calcite-input",{maxLength:124,onCalciteInputInput:e=>{this.createTitle=e.target.value},onKeyDown:e=>{this.createTitle&&"Enter"===e.key&&(e.preventDefault(),this.createFolder())}})),(0,s.h)("calcite-alert",{icon:!0,label:i,open:!!i,kind:"danger",onCalciteAlertClose:()=>this.createFolderError=null},(0,s.h)("div",{slot:"message"},i))),(0,s.h)("calcite-button",{slot:"secondary",appearance:"outline-fill","data-id":"cancelButton",onClick:()=>this.resetCreate(),width:"full"},e.cancel),(0,s.h)("calcite-button",{slot:"primary",appearance:"solid",kind:"brand",loading:this.processing,onClick:()=>this.createFolder(),width:"full",disabled:!this.createTitle},e.save)))}renderDelete(){var e,t,i,r;const{el:a}=this;return(0,s.h)("arcgis-tunnel",{reference:a,key:"delete-modal"},(0,s.h)("arcgis-delete-folder",{folder:null===(e=this.folders)||void 0===e?void 0:e.find((e=>e.id===this.deleteFolderId)),portal:o.c.portal,user:null!==(r=null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.contentUser)&&void 0!==r?r:this.user,active:!this.deleteClosing,onArcgisDeleteFolderClose:async()=>{var e;this.resetDelete(),await this.fetchUserFolders(this.user);(null===(e=this.folders)||void 0===e?void 0:e.find((e=>e.id===this.folder)))||(this.folder="all",this.arcgisItemBrowserFilter.emit(this.getEventDetail()))},onArcgisDeleteFolderSuccess:e=>{this.arcgisItemBrowserFolderDelete.emit(e.detail)},onArcgisDeleteFolderFail:e=>{this.arcgisItemBrowserFolderDeleteFail.emit(e.detail)}}))}render(){var e;const{portal:t}=o.c,i=this.store.state.bucket,{i18n:r,folders:a,deleteOpen:l,createOpen:n,tooltip:c,tooltipReferenceElement:d,showRecycle:h}=this,u=!this.user||!a||i&&"my"!==i;return(0,s.h)(s.H,{key:"2bf9221a512f70c7394971c4e96556231ed91d25"},(0,s.h)("arcgis-browser-filter",{key:"92b4253720d12ffe3780e7ef6f493463254faf1d",heading:r.folders,expanded:this.expanded,noPadding:!0,class:{hide:u},onMouseOver:()=>{this.hovered=!0},onMouseOut:()=>{this.hovered=!1},primary:"primary"===this.el.getAttribute("slot")},(0,s.h)("calcite-list",{key:"a0e8ec6be1a46993ba5bb0b9d819fb820d0f47f6",filterEnabled:!0,selectionAppearance:"border",selectionMode:"single-persist",loading:!a,class:"folders",ref:e=>{var t;this.listElement=e;const i=null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("calcite-filter");i&&(i.style.setProperty("--calcite-color-foreground-1","var(--calcite-color-background)"),i.style.position="absolute",i.style.top="-48px")},onCalciteListFilter:()=>{this.emitInternalAction("search folder")},onFocus:()=>{this.currentEdit=null}},a.map((e=>{var t;return this.currentEdit&&(null===(t=this.currentEdit)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)?this.renderEdit(e):this.renderListItem(e)})),h&&!(0,g.a)(this.user)&&!(null==t?void 0:t.isPortal)&&this.renderListItem(this.specialFolders.recycle)),this.allowEdits&&this.canEditFolder()&&(0,s.h)("calcite-button",{key:"28d8693ed002049f277c89cccf0a4044f3a76952",id:"create-folder-button",iconStart:"folder-plus",appearance:"transparent",kind:"neutral",slot:"action",onClick:()=>{this.createOpen=!0},onMouseEnter:async e=>{this.setTooltip(r.createFolder,e.target,!0)},onFocus:e=>{this.setTooltip(r.createFolder,e.target)}})),n&&this.renderCreate(),l&&this.renderDelete(),!!c&&d&&(0,s.h)("calcite-tooltip",{key:"20b2e82a73bc4787e03134112652375248a661f8",overlayPositioning:(null===(e=this.store.state)||void 0===e?void 0:e.panel)?"absolute":"fixed",referenceElement:this.tooltipReferenceElement,placement:"bottom-end",ref:e=>{this.tooltipElement||(this.tooltipElement=e,e.open=!0)}},c))}get el(){return(0,s.d)(this)}static get watchers(){return{folder:["navigateToFolder"]}}};Z.style=".hide.sc-arcgis-item-browser-filter-folder{display:none}.folders.sc-arcgis-item-browser-filter-folder{max-height:16.5rem;min-height:4rem;position:relative;z-index:0;overflow:auto;padding-top:2.5rem}.folder-action.sc-arcgis-item-browser-filter-folder{opacity:0;margin:2px}.folder.sc-arcgis-item-browser-filter-folder:hover .folder-action.sc-arcgis-item-browser-filter-folder,.folder.sc-arcgis-item-browser-filter-folder:focus-within .folder-action.sc-arcgis-item-browser-filter-folder{opacity:1}calcite-list-item.sc-arcgis-item-browser-filter-folder:not([selected]){--calcite-color-foreground-1:var(--calcite-color-background)}.recycle-bin.sc-arcgis-item-browser-filter-folder{position:sticky;bottom:0px;border-top:1px solid var(--calcite-color-border-2)}.tooltip.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px}.folder-edit.sc-arcgis-item-browser-filter-folder{position:relative;display:flex}.folder-edit__input.sc-arcgis-item-browser-filter-folder{position:relative;z-index:0;box-sizing:border-box;display:block;height:2.5rem;width:100%;border-style:none;padding-top:1rem;padding-bottom:1rem;padding-inline-end:0.5rem;padding-inline-start:3.5rem;font-size:0.75rem;color:var(--calcite-color-text-1);--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-duration:150ms;outline-color:transparent;border:1px solid var(--calcite-color-border-1);margin-inline-end:-1px;background-color:transparent;font-family:inherit}.folder-edit__input.sc-arcgis-item-browser-filter-folder:focus{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);outline:2px solid var(--calcite-color-brand);outline-offset:-2px}.folder-edit__icon.sc-arcgis-item-browser-filter-folder{position:absolute;inset:0px;margin-left:1rem;margin-right:1rem;margin-top:0.75rem;margin-bottom:0.75rem}.header.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px;font-size:1.25rem;font-weight:400;color:var(--calcite-color-text-1)}.headline.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px;padding-bottom:0.5rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1)}.description.sc-arcgis-item-browser-filter-folder{margin:0px;padding:0px;font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-2)}";const ee=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserGroupFetched=(0,s.c)(this,"arcgisItemBrowserGroupFetched",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.group="all",this.allowEdits=void 0,this.expanded=void 0,this.groups=[]}componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterGroup,this.group&&"all"!==this.group&&(this.store.state.groupId=this.group),o.c.user&&o.c.portal?this.fetchUserGroups():((0,o.o)("user",(()=>this.fetchUserGroups())),(0,o.o)("portal",(()=>this.fetchUserGroups()))),(0,p.a)(this.store,(e=>{var t;"group"===e&&(null===(t=this.groups)||void 0===t?void 0:t.length)>u.M&&("all"===this.group&&(this.group=this.groups[0].id),this.arcgisItemBrowserFilter.emit(this.getEventDetail()))}))}componentDidLoad(){this.expanded&&this.accordionItem&&(this.accordionItem.expanded=!0),(0,S.a)("group",this.store,(()=>this.group="all"))}getEventDetail(){var e,t;const{group:i}=this,s=null===(e=this.groups)||void 0===e?void 0:e.find((e=>e.id===i)),r=(null==s?void 0:s.title)||"";return{id:"group",param:"q",value:"all"!==i?`group:${i}`:`group:(${null===(t=this.groups)||void 0===t?void 0:t.map((({id:e})=>e)).join(" OR ")})`,label:this.i18n.label.replace("${group}",r),group:i}}async fetchUserGroups(){var e,t,i,s;if(o.c.user&&o.c.portal){const r=await(0,F.b)(o.c.user,null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.lang);this.arcgisItemBrowserGroupFetched.emit(r.map((e=>e.id)));const a=r.length>u.M;a&&"all"===this.group&&(this.group=r[0].id),this.groups=[...a?[]:[{id:"all",title:this.i18n.all}],...r],"group"===(null===(s=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===s?void 0:s.bucket)&&this.arcgisItemBrowserFilter.emit(this.getEventDetail())}}render(){const{user:e}=o.c,t=this.store.state.bucket,{i18n:i,groups:r}=this,a=!e||!r||t&&"group"!==t;return(0,s.h)(s.H,{key:"657a6829efaf52087507270b9d896fda9d9924f4"},(0,s.h)("arcgis-browser-filter",{key:"3966c89949c2e53278841009f24d93457ee9e1a8",heading:i.groups,expanded:this.expanded,noPadding:!0,class:{hide:a},primary:"primary"===this.el.getAttribute("slot")},(0,s.h)("calcite-list",{key:"2dc185892f7be3f8bb7ab6e339346e79f178accc",filterEnabled:!0,selectionAppearance:"border",selectionMode:"single-persist",loading:!r,class:"groups",ref:e=>{var t;const i=null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("calcite-filter");i&&(i.style.setProperty("--calcite-color-foreground-1","var(--calcite-color-background)"),i.style.position="absolute",i.style.top="-48px")},onCalciteListFilter:()=>{this.arcgisItemBrowserInternalUIAction.emit({category:"group action",action:"search group"})}},null==r?void 0:r.map((e=>(0,s.h)("calcite-list-item",{class:"group",label:e.title,value:e.id,key:e.id,onCalciteListItemSelect:()=>{this.group=e.id,this.store.state.groupId=e.id,this.arcgisItemBrowserFilter.emit(this.getEventDetail()),this.arcgisItemBrowserInternalUIAction.emit({category:"group action",action:"select group"})},selected:this.group===e.id},"all"===e.id?(0,s.h)("calcite-icon",{icon:"users",slot:"content-start",scale:"s"}):(0,s.h)("arcgis-group-thumbnail",{slot:"content-start",class:"group-thumbnail",group:e,portal:o.c.portal,tooltip:!1,scale:"s"})))))))}get el(){return(0,s.d)(this)}};ee.style=".hide.sc-arcgis-item-browser-filter-group{display:none}.groups.sc-arcgis-item-browser-filter-group{max-height:16.5rem;min-height:4rem;position:relative;z-index:0;overflow:auto;padding-top:2.5rem}calcite-list-item.sc-arcgis-item-browser-filter-group:not([selected]){--calcite-color-foreground-1:var(--calcite-color-background)}.group-thumbnail.sc-arcgis-item-browser-filter-group{margin-left:0.5rem;margin-right:0.5rem}";const te=["Agriculture","Electric Utilities","Environment","Forestry","Gas Utilities","General","Natural Resources","Petroleum","Public Safety","Telecommunications","Transportation","Water Utilities"],ie=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.industry=void 0,this.expanded=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterIndustry}async componentDidLoad(){this.industry&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,S.a)("industry",this.store,(()=>this.industry=null))}getEventDetail(){const{industry:e}=this;return{id:"industry",param:"filter",value:e?`typekeywords: "${e}"`:"",label:this.i18n.Industry.replace("${industry}",this.i18n[e]),industry:e}}render(){return(0,s.h)("arcgis-browser-filter",{key:"d8bd5dc0c1f69578e8e6bf4eb287d07d19c2d481",heading:this.i18n.title,expanded:this.expanded,active:!!this.industry,filterID:"industry",onArcgisBrowserFilterRemove:()=>{this.industry=null}},(0,s.h)("calcite-tree",{key:"a984c916250c8db0a127bdc22728dcb152ea171c",selectionMode:"single",scale:"s",onCalciteTreeSelect:e=>{var t,i;const s=(null===(i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset.industry)||"";this.industry===s?this.industry=null:this.industry=s,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},te.map((e=>(0,s.h)("calcite-tree-item",{"data-industry":e,selected:e===this.industry},(0,s.h)("a",null,this.i18n[e]))))))}get el(){return(0,s.d)(this)}},se=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.renderItemType=([e,t])=>{const{itemType:i,allowedItemTypes:r}=this,a=!(null==r?void 0:r.includes(e)),l=r&&a&&t.children&&Object.keys(t.children).some((e=>r.includes(e)));return a&&!l||t.show&&!t.show(o.c.portal,o.c.userLicensedItems)?null:a&&l?(0,s.h)(s.F,null,Object.entries(t.children).map(this.renderItemType)):(0,s.h)("calcite-tree-item",{"data-item-type":e,"data-children":!!t.children,selected:e===i},(0,s.h)("a",null,C.a[e]),t.children&&(0,s.h)("calcite-tree",{slot:"children",selectionMode:"children"},Object.entries(t.children).map(this.renderItemType)))},this.itemType=void 0,this.allowedItemTypes=C.d,this.expanded=void 0}componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterItemType}componentDidLoad(){var e;if(this.itemType){this.arcgisItemBrowserFilter.emit(this.getEventDetail());let t=null===(e=this.el)||void 0===e?void 0:e.querySelector(`calcite-tree-item[data-item-type="${this.itemType}"]`);for(;t;)t.expanded=!0,t=t.parentElement.closest("calcite-tree-item"),(null==t?void 0:t.closest("arcgis-item-browser-filter-item-type"))||(t=null)}(0,S.a)("itemType",this.store,(()=>this.itemType=null))}getEventDetail(){const{itemType:e}=this,t=(0,C.g)(e);return{id:"itemType",param:"q",value:(null==t?void 0:t.q)?`(${t.q})`:"",label:t?this.i18n.itemType.replace("${itemType}",C.a[e]):"",itemType:e}}render(){return(0,s.h)("arcgis-browser-filter",{key:"50da8d36ef36ccc4922c50786f97ed622154bf30",heading:this.i18n.title,expanded:this.expanded,active:!!this.itemType,filterID:"itemType",onArcgisBrowserFilterRemove:()=>{this.itemType=null}},(0,s.h)("calcite-tree",{key:"0bb7f34fceb24234e3bbc6af719cc2f396a3458c",selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const s=e.target,r=null===(i=null===(t=null==s?void 0:s.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==r?void 0:r.itemType)||"";this.itemType===o?this.itemType=null:this.itemType=o,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},Object.entries(C.i).map(this.renderItemType)))}get el(){return(0,s.d)(this)}};function re(e){return!(!(e.singleLineFieldName||(0,E.i)(e.url)||e.enableSuggestions)||!e.placefinding)}function oe(e,t,i,s){var r;const o=null!==(r=null==t?void 0:t.geocodeAutoComplete)&&void 0!==r&&r,a=function(e,t,i){var s;let r=[...(e.helperServices||{}).geocode||[]];const o=null!==(s=t.geocodeAutoComplete)&&void 0!==s&&s;return r.filter(re).map((e=>{const t=!(!0!==e.suggest||!o),s=(0,E.i)(e.url);return Object.assign(Object.assign({},e),{name:s?"ArcGIS Geocoding service":e.name,enableSuggestions:t,categories:s?["Populated Place","Coordinate System"]:null,placefinding:!!s||e.placefinding,outFields:s?["Match_addr","Addr_type","StAddr","City"]:null,placeholder:e.placeholder||i.findLocationText,singleLineFieldName:e.singleLineFieldName||"SingleLine",highlightSymbol:null,localSearchOptions:{minScale:3e5,distance:5e4}})}))}(e,t,i),l={suggestionsEnabled:o,minSuggestCharacters:3,maxResults:5,searchTerm:s||null,activeSourceIndex:"all",sources:[].concat(a),popupEnabled:!1,portal:e};return 1===l.sources.length&&delete l.activeSourceIndex,l}const ae=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.arcgisItemBrowserSort=(0,s.c)(this,"arcgisItemBrowserSort",7),this.suggest=e=>{this.loadingSuggestions=!0,(null==e?void 0:e.length)>2?this.searchViewModel.suggest(e):(this.loadingSuggestions=!1,this.suggestions=[])},this.debouncedSuggest=(0,n.d)(this.suggest.bind(this),1e3),this.updateSuggest=e=>{(null==e?void 0:e.length)>2&&(this.loadingSuggestions=!0),this.debouncedSuggest(e)},this.location=void 0,this.extent=void 0,this.expanded=void 0,this.loading=void 0,this.searching=void 0,this.suggestions=[],this.loadingSuggestions=void 0,this.searchTerm=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterLocation,(0,S.a)("location",this.store,(()=>{var e;this.location=null,this.extent=null,null===(e=this.searchViewModel)||void 0===e||e.clear(),this.searchTerm=""}))}async componentDidLoad(){this.location&&this.extent&&(this.searchTerm=this.location,this.emitFilterEvent()),(null===o.c||void 0===o.c?void 0:o.c.portal)?this.setupSearch():(0,o.o)("portal",(()=>{this.setupSearch()}))}async setupSearch(){const e=oe(o.c.portal,o.c.config,this.i18n,this.location),[t]=await(0,I.l)(["esri/widgets/Search/SearchViewModel"]);this.searchViewModel=new t(Object.assign(Object.assign({},e),{allPlaceholder:this.i18n.findLocationText,showInfoWindowOnSelect:!1})),this.searchViewModel.on("suggest-start",(()=>{this.loadingSuggestions=!0})),this.searchViewModel.on("suggest-complete",(async e=>{this.suggestions=[...e.results],this.loadingSuggestions=!1})),this.searchViewModel.on("search-start",(()=>{this.loadingSuggestions=!1,this.searching=!0,this.suggestPopover.open=!1})),this.searchViewModel.on("search-complete",(()=>{this.searching=!1})),this.searchViewModel.on("select-result",this.handleLocationChange.bind(this)),this.searchViewModel.on("search-clear",(()=>{this.extent&&this.location&&(this.location=null,this.extent=null,this.emitFilterEvent())}))}handleLocationChange(e){this.location=e.result.name;const t=e.result.extent;this.extent=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`,this.emitFilterEvent()}emitFilterEvent(){const{location:e,extent:t}=this,i=this.i18n.label.replace("${location}",e);this.arcgisItemBrowserFilter.emit({id:"location",param:"bbox",value:null!=t?t:"",label:i,location:e,extent:t}),t&&this.arcgisItemBrowserSort.emit({sortField:"relevance",sortOrder:"desc"})}handleSuggestSelect(e){var t;this.searchViewModel.search(e),this.searchTerm=e.text,null===(t=this.input)||void 0===t||t.setFocus()}hasResults(){var e;return null===(e=this.suggestions)||void 0===e?void 0:e.some((e=>{var t;return null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.length}))}renderSuggestions(e){var t;return null===(t=null==e?void 0:e.results)||void 0===t?void 0:t.map((e=>(0,s.h)("calcite-list-item",{class:"location-filter__suggestion",key:e.key,label:e.text,onClick:()=>this.handleSuggestSelect(e),onKeyPress:t=>{"Enter"===t.key&&this.handleSuggestSelect(e)}})))}render(){var e,t;return 3===(null===o.c||void 0===o.c?void 0:o.c.api)?null:(0,s.h)("arcgis-browser-filter",{heading:this.i18n.location,expanded:this.expanded,active:!!this.location,filterID:"location",onArcgisBrowserFilterRemove:()=>{this.location=null,this.extent=null}},(0,s.h)("div",{class:"location-filter__container"},(0,s.h)("calcite-input",{loading:this.searching||this.loadingSuggestions,type:"text",value:this.searchTerm,"aria-label":this.i18n.findLocationText,placeholder:this.i18n.findLocationText,scale:"m",class:"location-filter__input",ref:e=>this.input=e,clearable:!0,onKeyPress:e=>{const t=e.target.value;if("Enter"===e.key&&e.target===e.currentTarget)return this.searchTerm=t,void this.searchViewModel.suggest(t)},onKeyDown:e=>{var t,i;"ArrowDown"===e.key&&!this.loadingSuggestions&&(null===(t=this.suggestions)||void 0===t?void 0:t.length)&&(e.preventDefault(),e.stopPropagation(),null===(i=this.el.querySelector("calcite-list-item"))||void 0===i||i.setFocus())},onCalciteInputInput:e=>{const t=e.target.value;this.searchTerm=t,this.updateSuggest(t)}},(0,s.h)("calcite-button",{class:"location-filter__button",label:"search",slot:"action",kind:"neutral",appearance:"outline-fill",iconStart:"search",scale:"m",ref:e=>this.searchButton=e,onClick:()=>{this.suggest(this.searchTerm)},onKeyPress:e=>{"Enter"!==e.key&&" "!==e.key||this.suggest(this.searchTerm)},disabled:!this.searchTerm})),!this.loadingSuggestions&&(null===(e=this.searchTerm)||void 0===e?void 0:e.length)>2&&(0,s.h)("calcite-popover",{label:this.i18n.suggestions,referenceElement:this.searchButton,ref:e=>this.suggestPopover=e,autoClose:!0,pointerDisabled:!0,offsetDistance:0,overlayPositioning:"fixed",open:!0,placement:"bottom-end",flipPlacements:["top-end"]},this.hasResults()?(0,s.h)("calcite-list",{key:this.searchTerm,class:"location-filter__suggestions"},null===(t=this.suggestions)||void 0===t?void 0:t.map((e=>this.renderSuggestions(e)))):(0,s.h)("div",{class:"location-filter__suggestions"},(0,s.h)("p",{class:"location-filter__no-results"},this.i18n.noResults.replace("${searchTerm}",this.searchTerm))))))}get el(){return(0,s.d)(this)}};ae.style=".location-filter__container{box-sizing:border-box;display:flex;width:100%}.location-filter__input{flex:1 1 0%;--calcite-color-border-input:var(--calcite-color-border-3)}.location-filter__button{margin-inline-start:-1px}.location-filter__suggestions{box-sizing:border-box;height:8rem;overflow-y:auto;border-top:1px solid var(--calcite-color-border-1);border-bottom:1px solid var(--calcite-color-border-1);width:calc(var(--item-browser-pane-width) - 2.5rem)}.location-filter__no-results{margin-top:3rem;margin-bottom:0px;padding-top:0.5rem;padding-bottom:0px;text-align:center;color:var(--calcite-color-text-3)}";const le=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.regions=[],this.region=void 0,this.expanded=void 0,this.loading=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterRegion,(null===o.c||void 0===o.c?void 0:o.c.portal)?this.fetchRegions(o.c.portal):(0,o.o)("portal",(e=>this.fetchRegions(e))),(0,S.a)("region",this.store,(()=>this.region=null))}async fetchRegions(e){this.regions=await async function(e){const t=(0,_.d)(e);return(0,y.r)(`${(0,_.g)(e)}portals/regions`,{culture:t})}(e),this.loading=!1}async componentDidLoad(){this.region&&this.emitFilterEvent()}emitFilterEvent(){var e;const{region:t,i18n:i}=this,s=t?`/region/${t.toLowerCase()}`:"",r=t?JSON.stringify([s]):"",o=null===(e=this.regions)||void 0===e?void 0:e.find((e=>e.region===t)),a=i.region.replace("${region}",(null==o?void 0:o.localizedName)||(null==o?void 0:o.name)||"");this.arcgisItemBrowserFilter.emit({id:"region",param:"categories",categoryValue:s,value:r,label:a,region:t})}render(){var e,t;const{loading:i,regions:r,store:a}=this;return i||!(null==r?void 0:r.length)||"living atlas"!==(null===(e=a.state)||void 0===e?void 0:e.bucket)||(null===(t=null===o.c||void 0===o.c?void 0:o.c.portal)||void 0===t?void 0:t.isPortal)?null:(0,s.h)("arcgis-browser-filter",{heading:this.i18n.regions,expanded:this.expanded,active:!!this.region,filterID:"region",onArcgisBrowserFilterRemove:()=>{this.region=null}},(0,s.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t,i;const s=e.target,r=null===(i=null===(t=null==s?void 0:s.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==r?void 0:r.value)||"";this.region===o?this.region=null:this.region=o,this.emitFilterEvent()}},r.map((({name:e,region:t,localizedName:i})=>(0,s.h)("calcite-tree-item",{"data-value":t,selected:this.region===t},(0,s.h)("a",null,i||e))))))}get el(){return(0,s.d)(this)}},ne=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.filterLevel=e=>"org"!==e||!(0,g.a)(o.c.user),this.sharingLevels=[["owner",["private","shared"]],"org","public"],this.renderLevel=e=>{const[t,i]=Array.isArray(e)?e:[e];return(0,s.h)("calcite-tree-item",{"data-sharing":t,selected:(null==i?void 0:i.includes(this.sharing))||t===this.sharing},(0,s.h)("a",null,this.i18n[t]),i&&(0,s.h)("calcite-tree",{slot:"children",selectionMode:"children"},i.map(this.renderLevel)))},this.sharing=void 0,this.expanded=void 0}componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterSharing}componentDidLoad(){this.sharing&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,S.a)("sharing",this.store,(()=>this.sharing=null))}getEventDetail(){const{sharing:e,i18n:t}=this;return{id:"sharing",param:"q",value:e?"owner"===e?"(access:private OR access:shared)":`(access: ${e})`:"",label:e?t.label.replace("${sharing}",t[e]):"",sharing:e}}render(){var e,t;return"all"!==(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&o.c.user?(0,s.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.sharing,filterID:"sharing",onArcgisBrowserFilterRemove:()=>{this.sharing=null}},(0,s.h)("calcite-tree",{selectionMode:"children",scale:"m",onCalciteTreeSelect:e=>{var t;const i=null===(t=e.target.selectedItems)||void 0===t?void 0:t[0],s=null==i?void 0:i.dataset.sharing;this.sharing===s?this.sharing=null:this.sharing=s,this.arcgisItemBrowserFilter.emit(this.getEventDetail())}},this.sharingLevels.filter(this.filterLevel).map((e=>this.renderLevel(e))))):null}get el(){return(0,s.d)(this)}},ce=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserFilter=(0,s.c)(this,"arcgisItemBrowserFilter",7),this.deselectAllTags=()=>{this.tags=[],this.el.querySelectorAll("calcite-combobox-item[selected]").forEach((e=>{e.selected=!1}))},this.tags=void 0,this.expanded=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.filterTags}async componentDidLoad(){this.tags&&this.arcgisItemBrowserFilter.emit(this.getEventDetail()),(0,S.a)("tags",this.store,(()=>{this.tags=null,this.deselectAllTags()}))}getEventDetail(){const{tags:e}=this,t=(null==e?void 0:e.length)?`tags:(${e.map((e=>`"${e}"`)).join(" OR ")})`:"",i=(null==e?void 0:e.length)?this.i18n.label.replace("${tags}",e.join(", ")):"";return{id:"tags",param:"filter",value:t,tags:e,label:i}}componentDidRender(){const e=this.el.querySelectorAll("calcite-combobox-item"),t=[];e.forEach((e=>{t.includes(e.value)?e.parentElement.removeChild(e):t.push(e.value)}))}render(){var e,t;const{i18n:i}=this,r=this.store.state.knownTags||[];return(0,s.h)("arcgis-browser-filter",{key:"9cd959387eadd2d46cb7895da3e65ba1318829d6",heading:i.title,expanded:this.expanded,active:!!(null===(e=this.tags)||void 0===e?void 0:e.length),onArcgisBrowserFilterRemove:()=>{this.deselectAllTags()}},(0,s.h)("calcite-combobox",{key:"3207d0652c3d7ee32f26086571b317b8d30aca6e",class:"item-browser-tags-filter",label:i.title,overlayPositioning:"fixed",placeholder:i.selectTags,scale:"s",maxItems:5,allowCustomValues:!0,clearDisabled:!0,onCalciteComboboxChange:e=>{var t;this.tags=null===(t=e.target.selectedItems)||void 0===t?void 0:t.map((e=>e.value)),this.arcgisItemBrowserFilter.emit(this.getEventDetail())},style:{marginBottom:"1rem","--tag-item-max-width":(null===(t=this.store.state)||void 0===t?void 0:t.panel)?"100%":"calc(var(--item-browser-pane-width) - 3rem)"},ref:e=>{var t;const i=e.shadowRoot.querySelector("div");i&&(null===(t=this.store.state)||void 0===t?void 0:t.panel)&&i.insertAdjacentHTML("beforeend","<style>\n              .floating-ui-container--active {\n                visibility: visible !important;\n                pointer-events: auto !important;\n                position: absolute !important;\n              }\n              </style>")}},r.map((e=>{var t;return(0,s.h)("calcite-combobox-item",{key:e,value:e,textLabel:e,selected:null===(t=this.tags)||void 0===t?void 0:t.includes(e)})}))))}get el(){return(0,s.d)(this)}};ce.style=".item-browser-tags-filter calcite-combobox-item{max-width:var(--tag-item-max-width)}";const de=class{constructor(e){(0,s.r)(this,e)}async componentWillLoad(){this.store=(0,p.g)(this.el)}render(){var e,t,i,r,o,a,l,n;return(0,s.h)("arcgis-browser-filters",{key:"cf6e145f2bec1ea09666309c35a6989121dc673e",store:this.store,style:"subscription content"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)?{display:"none"}:{}},(0,s.h)("div",{key:"36e70dc54ea37f8a22a38a675b002dde0f2207aa",slot:"top"},(0,s.h)("slot",{key:"17d3beb410d20b2e3a7ad6a42c81a491bfccd2b4",name:"top"})),(0,s.h)("div",{key:"85339b0049b728a6fe56f959161e75f3957f433a",slot:"primary"},(0,s.h)("slot",{key:"c388ba77a0f762acae030d2f0198d606435f6dba",name:"primary"})),(0,s.h)("div",{key:"4aec7b667dd3127689460466da81100ba7aba089",slot:"title"},!(null===(r=null===(i=this.store)||void 0===i?void 0:i.state)||void 0===r?void 0:r.recycleBin)&&(0,s.h)("h2",{key:"a3d3264b32274aff58867b32b32fbc1e6f78e6b6",class:"title"},(null===(n=null===(l=null===(a=null===(o=this.store)||void 0===o?void 0:o.state)||void 0===a?void 0:a.i18n)||void 0===l?void 0:l.itemBrowser)||void 0===n?void 0:n.filters)||""),(0,s.h)("slot",{key:"dad6d114bf0cf671076882d0ea2eacbe4c0f9e30",name:"before-filters"})),(0,s.h)("slot",{key:"5e4a583209cf80fabbac12e4934e7bcc68e07d8c"}),(0,s.h)("div",{key:"ece22dc3facf036aaab7547d8244eac317c262aa",slot:"bottom"},(0,s.h)("slot",{key:"47105b243f7e20927f651978ccf24c9874dd5a78",name:"bottom"})))}get el(){return(0,s.d)(this)}};de.style=".title{margin:0px;padding-left:0.5rem;padding-right:0.5rem;padding-top:1rem;padding-bottom:1rem;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1);line-height:1;margin-bottom:-1px;border-bottom:1px solid var(--calcite-color-border-2)}";const he=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserPage=(0,s.c)(this,"arcgisItemBrowserPage",7),this.total=void 0,this.start=void 0,this.num=60}async nextPage(){this.paginationRef.nextPage()}async componentWillLoad(){this.store=(0,p.g)(this.el);const{start:e,total:t,num:i}=this;this.arcgisItemBrowserPage.emit({start:e,total:t,num:i})}render(){const{start:e,total:t,num:i,store:r}=this;return(0,s.h)("arcgis-browser-pagination",{key:"abb893c7124ae3d03e0c7a4f27c0da5089f603c5",ref:e=>this.paginationRef=e,start:e,total:t,num:i,store:r,onArcgisBrowserPage:e=>this.arcgisItemBrowserPage.emit(e.detail)})}get el(){return(0,s.d)(this)}},ue=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserPreviewClose=(0,s.c)(this,"arcgisItemBrowserPreviewClose",7),this.arcgisInternalItemBrowserSublayer=(0,s.c)(this,"arcgisInternalItemBrowserSublayer",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.arcgisItemBrowserCardSelectError=(0,s.c)(this,"arcgisItemBrowserCardSelectError",7),this.sortSublayers=(e,t)=>{const i=this.layerMatches(e);return i===this.layerMatches(t)?t.id-e.id:i?-1:1},this.layerMatches=e=>{var t,i,s,r,o;return null===(o=null===(r=null===(s=null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.highlights)||void 0===s?void 0:s[this.item.id])||void 0===r?void 0:r.sublayers)||void 0===o?void 0:o.includes(e.id)},this.renderField=e=>{if("OBJECTID"!==e.name)return(0,s.h)("arcgis-item-browser-preview-field-details",{field:e,item:this.item,sublayer:this.sublayer,api:o.c.api,showFieldStatistics:this.store.state.showFieldStatistics})},this.handleLayerClick=e=>{this.sublayer=e,this.fetchSublayer(),this.arcgisItemBrowserInternalUIAction.emit({action:"click",category:"panel action",details:"sublayer"}),this.arcgisInternalItemBrowserSublayer.emit(Object.assign({},e))},this.renderLayer=e=>{const t=this.layerMatches(e),{icon:i}=(0,A.g)({geometry:e.geometryType,type:e.type});return(0,s.h)("calcite-list-item",{onClick:()=>this.handleLayerClick(e),onKeyDown:t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),this.handleLayerClick(e))},class:"sublayer-item"},(0,s.h)("calcite-icon",{icon:i,flipRtl:!0,scale:"s",slot:"content-start"}),(0,s.h)("span",{slot:"content",class:"sublayer-item__content"},(0,s.h)("span",{class:{"sublayer-item__title":!0,"sublayer-item__title--matched":t}},e.title||e.name),t&&(0,s.h)("span",{class:"sublayer-item__description"},this.i18n.matched)),(0,s.h)("calcite-icon",{scale:"s",slot:"content-end",icon:"chevron-right",flipRtl:!0,style:{display:"flex",justifyContent:"flex-end"}}))},this.item=void 0,this.portal=void 0,this.user=void 0,this.hidePreviewFooters=!1,this.showHosted=void 0,this.fullItem=void 0,this.formattedViews=void 0,this.loadingLayers=!0,this.layerError=void 0,this.layers=[],this.serviceInfo=void 0,this.sublayer=void 0,this.fullSublayer=void 0,this.showLayers=void 0,this.userInfo=void 0,this.tab="fields",this.itemError=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.preview,this.layerTypes=this.store.state.i18n.layerTypes,this.lang=await(0,c.a)(this.el),this.init(),this.guid=(0,O.g)()}updatePreview(){this.init()}async fetchItem(){return this.itemError=null,(0,u.k)(this.item,this.portal,this.user,this.store)}async init(){var e,t,i,s,r,a;if(!this.item)return;const{item:l,portal:c,lang:d}=this;this.fullItem=null,this.shouldExpandOverview=!0,this.loadingLayers=!0;const u=await(0,n.m)(this.fetchItem(),600);if(u.error)return void(this.itemError="disabledSubscription"===u.error.code?this.i18n.itemError.subscription:this.i18n.itemError.unhandled);this.fullItem=u.result,this.formattedViews=await(0,f.f)(l.numViews||0,{api:o.c.api,places:0,type:"decimal"}),this.userInfo=await(0,h.a)(l,c,d),null===(e=this.flowItem)||void 0===e||e.setFocus();if(this.showLayers=["Feature Service","Layer Template","Feature Collection"].includes(l.type)&&!(null===(t=l.typeKeywords)||void 0===t?void 0:t.includes("Route Layer")),this.showLayers||"Image Service"===l.type)if("Layer Template"===l.type&&(null===(i=l.typeKeywords)||void 0===i?void 0:i.map((e=>e.toLowerCase())).includes("service template"))){const e=await(0,y.r)(`${(0,_.g)(this.portal)}content/items/${this.item.id}/data`);this.layers=[...null!==(s=e.layers)&&void 0!==s?s:[],...null!==(r=e.tables)&&void 0!==r?r:[]]}else{const e=await(0,w.f)({item:this.fullItem,portal:o.c.portal,layers:null,isSecure:!1});e.result?(this.serviceInfo=e.result.serviceInfo,this.layers=null===(a=e.result.sublayers)||void 0===a?void 0:a.sort(this.sortSublayers)):e.error&&(this.layerError=this.i18n.layerError,"serviceNotExist"===e.error.code&&(this.layerError.message=this.i18n.noServiceMessage))}this.loadingLayers=!1}handleAccordionItemClick(e,t){this.arcgisItemBrowserInternalUIAction.emit({action:e.expanded?"expand":"collapse",category:"panel action",details:t})}async fetchSublayer(){const e=await(0,w.a)(this.portal,this.sublayer.id,this.item.url);this.fullSublayer=null==e?void 0:e.result}closePreview(){this.sublayer=null,this.fullItem=null,this.arcgisItemBrowserCardSelectError.emit(),this.arcgisItemBrowserInternalUIAction.emit({action:"close panel",category:"panel action"}),this.arcgisItemBrowserPreviewClose.emit()}renderHeader(){var e;return(0,s.h)("div",{slot:"header-content",class:"preview__header"},(0,s.h)("h3",{class:"preview__title"},null===(e=this.item)||void 0===e?void 0:e.title),(0,s.h)("arcgis-item-type",{item:this.item,portal:this.portal,user:this.user,scale:"m",serviceInfo:this.serviceInfo,showHosted:this.showHosted}))}renderLayers(){var e;return this.loadingLayers?(0,s.h)("calcite-loader",{label:this.i18n.loading,scale:"s"}):this.layerError?(0,s.h)("div",{class:"section"},(0,s.h)("calcite-notice",{icon:!0,open:!0,scale:"s",width:"full",kind:"warning"},(0,s.h)("div",{slot:"title"},this.layerError.title),(0,s.h)("div",{slot:"message"},this.layerError.message))):(0,s.h)("div",{class:"section section--tight"},(0,s.h)("calcite-list",{"selection-mode":"none",loading:this.loadingLayers,ref:e=>{var t;const i=null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.querySelector("table");i&&(i.style.borderSpacing="0")}},null===(e=this.layers)||void 0===e?void 0:e.map(this.renderLayer)))}isAccordionItem(e){return"CALCITE-ACCORDION-ITEM"===e.tagName}handleSublayerSectionChange(e){this.tab=e,this.arcgisItemBrowserInternalUIAction.emit({action:"click",category:"panel action",details:`sublayer ${e}`})}renderSublayerPreview(){var e,t,i,r;const{sublayer:o,item:l,i18n:n,fullSublayer:c,guid:d}=this,{geometryType:h,title:u,name:m,description:p}=o,{type:g,isGeometry:v}=(0,A.g)({geometry:h,type:o.type}),b=this.layerTypes[g];return(0,s.h)("calcite-flow-item",{key:`flow-sublayer-${d}`,closable:!0,onCalciteFlowItemBack:e=>{e.stopPropagation(),this.arcgisInternalItemBrowserSublayer.emit(),this.sublayer=null},onCalciteFlowItemClose:e=>{e.stopPropagation(),this.closePreview()}},this.renderHeader(),(0,s.h)("div",{class:"sublayer__header"},(0,s.h)("arcgis-sublayer-type",{name:m||u,geometry:o.geometryType,type:o.type,showType:!1,scale:"s"})),(0,s.h)("calcite-tabs",{position:"top",scale:"m",layout:"center",class:{sublayer__tabs:!0,"sublayer__tabs--white":"fields"===this.tab}},(0,s.h)("calcite-tab-nav",{slot:"title-group",class:"sublayer__tab-nav"},(0,s.h)("calcite-tab-title",{onClick:()=>this.handleSublayerSectionChange("fields"),selected:"fields"===this.tab},n.fields),(0,s.h)("calcite-tab-title",{onClick:()=>this.handleSublayerSectionChange("overview"),selected:"overview"===this.tab},n.overview)),(0,s.h)("calcite-tab",null,(0,s.h)("div",{class:"sublayer__content"},o.fields?o.fields.map(this.renderField):(0,s.h)("p",{class:"details-text details-text--empty"},n.noFields))),(0,s.h)("calcite-tab",null,(0,s.h)("div",{class:"sublayer__content sublayer__content--overview"},this.renderDetail(v?n.geometryTypeTitle:n.layerTypeTitle,b),(0,s.h)("h4",{class:"details-title"},n.description),p?(0,s.h)("div",{class:"details-text description",innerHTML:(0,a.s)((0,a.d)(p))}):(0,s.h)("p",{class:"details-text details-text--empty"},n.noDescription),!(null===(e=this.portal)||void 0===e?void 0:e.isPortal)&&this.renderDetail(n.dataUpdated,(0,f.a)(null===(t=null==c?void 0:c.editingInfo)||void 0===t?void 0:t.dataLastEditDate)),!(null===(i=this.portal)||void 0===i?void 0:i.isPortal)&&this.renderDetail(n.schemaUpdated,(0,f.a)(null===(r=null==c?void 0:c.editingInfo)||void 0===r?void 0:r.schemaLastEditDate)),l.url&&(0,s.h)("arcgis-item-browser-preview-copy",{text:`${l.url}/${o.id}`,heading:n.URL})))),!this.hidePreviewFooters&&(0,s.h)("div",{slot:"footer",class:"footer-actions"},this.renderSublayerSelect(),(0,s.h)("slot",{name:"sublayer-footer"})))}renderDetail(e,t,i,r){const o=!i||t?r?(0,s.h)("p",{class:"details-text",innerHTML:(0,a.s)(t)}):(0,s.h)("p",{class:"details-text"},t):(0,s.h)("p",{class:"details-text details-text--empty"},i);return[(0,s.h)("h4",{class:"details-title"},e),o]}renderSublayerSelect(){var e,t,i;return(null===(t=null===(e=this.store)||void 0===e?void 0:e.state.selection)||void 0===t?void 0:t.includes("sublayer"))?(0,s.h)("arcgis-item-browser-card-sublayer-select",{item:this.item,user:this.user,portal:this.portal,selection:"multiple-sublayer"===(null===(i=this.store)||void 0===i?void 0:i.state.selection)?"multiple":"single",appearance:"solid",width:"full"}):null}render(){var e,t,i,r,c,d,h,u,m;const{item:p,fullItem:g,i18n:v,user:b,sublayer:w,userInfo:y,portal:I,itemError:k,guid:x}=this,S=null!==(e=null==p?void 0:p.owner)&&void 0!==e?e:"",C="public_authoritative"===(0,T.g)(g)?this.i18n.itemManagedBy.replace("${username}",S):S,F=(null===(t=this.layers)||void 0===t?void 0:t.length)?v.layersCount.replace("${count}",`${(null===(i=this.layers)||void 0===i?void 0:i.length)||0}`):v.layers,B=null===(d=null===(c=null===(r=this.store)||void 0===r?void 0:r.state.highlights)||void 0===c?void 0:c[null==p?void 0:p.id])||void 0===d?void 0:d.sublayers,E=(null==B?void 0:B.length)&&!this.loadingLayers?v.matchedNumber.replace("${num}",`${B.length}`):null;return(0,s.h)(s.H,{key:"88b75f000e9c333cb308d44488a77dce56e3ef19"},(0,s.h)("calcite-flow",{key:`flow-${x}`},(0,s.h)("calcite-flow-item",{key:`flow-preview-${x}`,closable:!0,loading:!g&&!k,onCalciteFlowItemClose:e=>{e.stopPropagation(),this.closePreview()},ref:e=>this.flowItem=e},this.renderHeader(),!!k&&(0,s.h)("div",{key:"ad5b0b5640f05217251ccf194578bfe97460c185",class:"error-container"},(0,s.h)("calcite-notice",{key:"15117535fb0324ff1cc692b636ead97ebc43e6dd",kind:"danger",open:!0,scale:"s"},(0,s.h)("div",{key:"ae5db468c4324f047c86712e9bee8861cbfb99be",slot:"title"},this.i18n.itemError.title),(0,s.h)("div",{key:"428c229d0fee256c64e446783df5d52978f9cdc1",slot:"message"},k))),g&&(0,s.h)("div",{key:"ec0d0d1b04033e1bbfc8d8e75f256c42e6277cbf",class:"content"},(0,s.h)("calcite-accordion",{"icon-position":"start",appearance:"transparent",key:p.id,class:"accordion",onClick:async e=>{const t=e.target;this.isAccordionItem(t)&&(await(0,n.t)(300),t.expanded&&t.scrollIntoView({behavior:"smooth",block:"start"}))}},(0,s.h)("calcite-accordion-item",{key:"e8dfef4f0dd40ede64a86d51a5eeda3a8588758a",heading:v.thumbnail,ref:e=>{this.thumbnailElement=e},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.thumbnailElement,"thumbnail")},(0,s.h)("div",{key:"55a1687fc1f15c98364b80f33ff2df4950c9427f",class:"section section--tight"},(0,s.h)("arcgis-item-browser-card-thumbnail",{key:"84840f3725401cee7c1fdd514a4dec78cc0ba494",item:p,user:b,portal:I}))),(0,s.h)("calcite-accordion-item",{key:"0a93dba6a72dfbd38f7a85575dd0d037720e045a",heading:v.overview,ref:e=>{this.overviewElement=e,this.shouldExpandOverview&&(e.expanded=!0,this.shouldExpandOverview=!1)},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.overviewElement,"overview")},(0,s.h)("div",{key:"7f162c302fad018a9491fb77b8d64cf459aaba81",class:"section"},(0,s.h)("slot",{key:"313e147ae4cd2129eb9776ddcd40d0a6b4a5c020",name:"summary-top"}),this.renderDetail(v.summary,g.snippet,v.noSummary),!!(null===(h=(0,T.a)(p,I,b))||void 0===h?void 0:h.length)&&[(0,s.h)("h4",{key:"488416be19af93d12ee83a636363e9a7dd13eee2",class:"details-title"},v.itemStatus),(0,s.h)("arcgis-item-badges",{key:"75628c301ace729fc66af7bdb897865028a30daa",class:"badges",item:p,portal:I,user:b,scale:"s",width:"full"})],(0,s.h)("h4",{key:"8a4f4c5fc5bc7468afa8685b511c3b2a7d086dd7",class:"details-title"},v.owner),(null===(u=this.store)||void 0===u?void 0:u.state.panel)?(0,s.h)("arcgis-user-avatar",{user:y,scale:"s",portal:I,showName:!0,description:C}):(0,s.h)("arcgis-user-popup",{baseUrl:o.c.config.baseUrl,portal:I,item:g}),(0,s.h)("h4",{key:"2f6ffa087071f79c0e1daaaadd9f10922cfd8a7a",class:"details-title"},v.shared),(0,s.h)("arcgis-item-share-summary",{key:"f5884986dfa0a6844c7edb4d8477bf6d972386b7",item:g,scale:"m",user:b,groups:this.store.state.groupSharing[p.id]}),this.renderDetail(v.updated,(0,f.a)(g.modified)),!!b&&(0,s.h)("arcgis-item-favorite",{key:"9b63913011770f8c16b9c49f6f987ffcafd5f1db",class:"favorite",user:b,portal:I,item:g,width:"full",onArcgisItemFavoriteUpdate:e=>{const t=e.detail.favorite?"add to fav":"remove from fav";this.arcgisItemBrowserInternalUIAction.emit({action:"click",details:t})}}))),(0,s.h)("calcite-accordion-item",{heading:v.description,key:"description",ref:e=>{this.descriptionElement=e},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.descriptionElement,"description")},(0,s.h)("div",{key:"ac1b6709c33547d2fa12c30deff6326a071cf849",class:"section"},g.description?(0,s.h)("div",{class:"description",innerHTML:(0,a.s)(g.description)}):(0,s.h)("p",{class:"details-text details-text--empty"},v.noDescription))),(0,s.h)("calcite-accordion-item",{key:"5c4d536c04cb1280b14a087b06e63056b6cb2fbf",heading:v.details,ref:e=>{this.detailsElement=e},onClick:e=>this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.detailsElement,"details")},(0,s.h)("div",{key:"b77e0989c098fd0771413c6598655948e38de565",class:"section"},this.renderDetail(v.created,(0,f.a)(g.created)),this.renderDetail(v.viewCount,this.formattedViews),"Dashboard"===p.type&&this.renderDetail(v.dashboardViews,(null===(m=p.typeKeywords)||void 0===m?void 0:m.includes("Mobile"))?v.dashboardMobile:v.dashboardDesktop),!!g.size&&this.renderDetail(v.fileSize,(0,l.f)(g.size)),(0,s.h)("arcgis-item-browser-preview-copy",{key:"8c97f9e75f75d049cb9bba96c0a0661b4385f11d",text:g.id,heading:v.ID}),g.url&&(0,s.h)("arcgis-item-browser-preview-copy",{key:"b08f34f1525be5b1d5cc555ce30f8af16980b9f1",text:g.url,heading:v.URL}),this.renderDetail(v.credits,g.accessInformation,v.noCredits),this.renderDetail(v.termsOfUse,g.licenseInfo,v.noTermsOfUse,!0))),this.showLayers&&(0,s.h)("calcite-accordion-item",{key:"7a7fdd27f366b48de6c6f5bbfa1e9695019d6936",heading:F,description:E,ref:e=>{this.layersElement=e},onClick:async e=>{this.isAccordionItem(e.target)&&this.handleAccordionItemClick(this.layersElement,"layers")}},this.renderLayers()))),!this.hidePreviewFooters&&(0,s.h)("div",{key:"9967636e2ee814ba2096214f2fdf9ea638aad733",slot:"footer",class:"footer-actions"},this.renderSublayerSelect(),(0,s.h)("slot",{key:"ab3a690853819cab7788142cb54127eb89ec2529",name:"footer"}))),!!w&&this.renderSublayerPreview()))}get el(){return(0,s.d)(this)}static get watchers(){return{item:["updatePreview"]}}};ue.style=":host{display:flex;height:100%;width:100%;flex:1 1 0%;flex-direction:column;background-color:var(--calcite-color-background)}.preview__header{margin-inline-start:0.75rem}.preview__title{margin:0px;overflow-wrap:break-word;padding:0px;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1);line-height:1.375}.title{margin-top:0.75rem;margin-bottom:0.75rem;padding:0px;font-size:1.125rem;font-weight:500;color:var(--calcite-color-text-1);word-wrap:break-word;word-break:break-word}.badges{margin-bottom:1rem;display:block}.badges[empty]{display:none}calcite-accordion-item{--calcite-accordion-item-padding:1rem 1rem;--calcite-accordion-item-background:var(--calcite-color-foreground-1);width:100%;box-sizing:border-box;border-bottom:1px solid var(--calcite-color-border-2)}.section{background-color:var(--calcite-color-background);padding-left:1rem;padding-right:1rem;padding-top:1rem;padding-bottom:1rem;margin:0rem -1rem calc(-1rem - 1px) -1rem;line-height:1.35}.section--tight{padding-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px}.details-title{margin-top:1rem;margin-bottom:0px;padding-bottom:0.25rem;padding-top:0px;font-size:0.75rem;font-weight:500;color:var(--calcite-color-text-3);--calcite-label-margin-bottom:0}.details-title:first-of-type{margin-top:0px}.details-title--label{padding-bottom:0px}.details-text{margin:0px;overflow-wrap:break-word;padding:0px;font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-1)}.details-text a{color:var(--calcite-color-text-link)}.details--text-empty{font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-3)}.description{width:100%;overflow:auto;overflow-wrap:break-word;padding-bottom:0.25rem;line-height:1.35}.description *{max-width:100%;font-size:0.875rem !important}.description{--item-browser-table-border:1px solid var(--calcite-color-border-2)}.description table{width:100%;border-collapse:collapse;--tw-border-spacing-x:0px;--tw-border-spacing-y:0px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);overflow:auto;background-color:var(--calcite-color-foreground-1);text-align:start;font-size:0.75rem;border:var(--item-browser-table-border)}.description table>thead{background-color:var(--calcite-color-foreground-1);font-weight:400;border-bottom:var(--item-browser-table-border)}.description table>tbody{width:100%;overflow:auto}.description table>tfoot{border-top:var(--item-browser-table-border)}.description table th,.description table td{padding:0.5rem;text-align:start;font-weight:300;border-left:var(--item-browser-table-border);border-right:var(--item-browser-table-border)}.description table tr{text-align:start;border-bottom:var(--item-browser-table-border)}.description table tr:last-child{border-bottom:none}.favorite{display:block;padding-top:1.5rem}.copy-input{--calcite-color-background:var(--calcite-color-foreground-1)}.sublayer-item{--tw-shadow:none}.sublayer__tabs{flex:1 1 auto;background-color:var(--calcite-color-background)}.sublayer__tabs--white{background-color:var(--calcite-color-foreground-1)}.sublayer-item__content{max-width:10.875rem;display:flex;min-width:0px;flex-direction:column}.sublayer-item__title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0.5rem;padding-bottom:0.5rem;font-size:0.875rem;color:var(--calcite-color-text-2);text-decoration-line:underline}.sublayer-item__title--matched{padding-top:0px;padding-bottom:0px}.sublayer-item__description{font-size:0.75rem;color:var(--calcite-color-text-3)}.sublayer__header{display:flex;background-color:var(--calcite-color-foreground-1);padding-left:1rem;padding-right:1rem;padding-top:1rem;padding-bottom:0.5rem;font-weight:500;color:var(--calcite-color-text-1)}.sublayer__header__title{min-width:0px;overflow-wrap:break-word}.sublayer__tab-nav{background-color:var(--calcite-color-foreground-1);padding-left:1rem;padding-right:1rem}.sublayer__content{height:100%;background-color:var(--calcite-color-foreground-1);margin-top:-0.5rem}.sublayer__content--overview{box-sizing:border-box;background-color:var(--calcite-color-background);padding-top:2rem;padding-bottom:2rem;padding-left:1.25rem;padding-right:1.25rem}.footer-actions{display:grid;width:100%;grid-template-columns:repeat(1, minmax(0, 1fr));gap:0.5rem}.error-container{display:flex;height:100%;padding:1rem}";const me=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.heading=void 0,this.text=void 0,this.copied=!1}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.copy}async handleCopy(e){navigator.clipboard.writeText(e),this.copied=!0;const t=this.el.parentElement.classList.contains("sublayer__content");this.arcgisItemBrowserInternalUIAction.emit({action:"copy",category:"panel action",details:t?"layers":"details"}),await(0,n.t)(1e4),this.copied=!1}render(){const{heading:e,text:t,i18n:i}=this;return(0,s.h)(s.H,{key:"b37a3e15dfac9a064bb77ddfb147761bef2dba36"},(0,s.h)("calcite-label",{key:"5d287991820c2e492301897209f864f40d264047",class:"label",scale:"s"},(0,s.h)("h4",{key:"363702acefafef7b0d4b4b5c4912b76e2132ab45",class:"heading"},e),(0,s.h)("calcite-input",{key:"af62724892ed670cd6aa1b00e591ad607781145c",value:t,readOnly:!0,alignment:"start",type:"text",label:e,scale:"s",class:"input"},(0,s.h)("div",{key:"c473319493533444d5a582738a851316e51a3a55",slot:"action",class:"action"},(0,s.h)("calcite-button",{key:"deda4999699d14b00a8faa9e5ad863b0155a5dcd",class:"button",slot:"action",iconStart:"copy-to-clipboard",id:"copy-button",kind:"neutral",scale:"s",onClick:()=>this.handleCopy(t),onMouseOut:async()=>{await(0,n.t)(200),this.copied=!1}}),(0,s.h)("div",{key:"67fe69e79897aefcf4764f53f141cc1a31ab4ab1",class:"tooltip"},this.copied?null==i?void 0:i.copied:null==i?void 0:i.copy)))))}get el(){return(0,s.d)(this)}};me.style=".heading{margin-top:1rem;margin-bottom:0px;padding-bottom:0.25rem;padding-top:0px;font-size:0.75rem;font-weight:500;color:var(--calcite-color-text-3);--calcite-label-margin-bottom:0}.label{padding-bottom:0px}.input{--calcite-color-background:var(--calcite-color-foreground-1)}.action{position:relative}.tooltip{position:absolute;white-space:nowrap;border-radius:var(--calcite-border-radius);background-color:var(--calcite-color-foreground-1);padding-top:0.5rem;padding-bottom:0.5rem;padding-left:0.75rem;padding-right:0.75rem;font-size:0.75rem;font-weight:500;color:var(--calcite-color-text-1);opacity:0;--tw-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);--tw-shadow-colored:0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-duration:150ms;transform:translateY(-8px);top:calc(100% + 4px);inset-inline-end:0;width:auto;border:1px solid var(--calcite-color-border-3);line-height:1.375}.button:hover+.tooltip,.button:focus+.tooltip{opacity:1;transform:translateY(0)}";const pe=class{constructor(e){(0,s.r)(this,e),this.field=void 0,this.item=void 0,this.sublayer=void 0,this.showFieldStatistics=void 0,this.api=4,this.layer=void 0}async getFieldData(){if(!this.layer){const[e]=await(0,I.l)(["esri/layers/FeatureLayer"]),t=new e({url:this.item.url,layerId:this.sublayer.id});await t.load(),this.layer=t}}render(){const{field:e,showFieldStatistics:t,api:i}=this;return e?(0,s.h)(s.H,null,(0,s.h)("calcite-block",{heading:e.alias||e.name,description:e.name,headingLevel:5,collapsible:t&&4===i&&"Feature Service"===this.item.type,onCalciteBlockToggle:()=>{this.getFieldData()}},(0,s.h)("calcite-icon",{slot:"icon",icon:L.f[e.type]||"string",scale:"s",class:"layer-icon"}),!!this.layer&&(0,s.h)("arcgis-field-info",{layer:this.layer,fieldName:e.name}))):null}get el(){return(0,s.d)(this)}},ge=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserSearch=(0,s.c)(this,"arcgisItemBrowserSearch",7),this.arcgisItemBrowserSearchInput=(0,s.c)(this,"arcgisItemBrowserSearchInput",7),this.computeDefaultPlaceholder=()=>{var e,t,i,s,r;const a=this.i18n,{bucket:l,contentUser:n,filters:c,panel:d}=this.store.state;if(d)return a.searchName.replace("${searchName}","");let h;switch(l){case"my":const l=!!n,d=n||o.c.user,u=!(null===(e=c.folder)||void 0===e?void 0:e.folder)||"all"===c.folder.folder,m=null===(i=null===(t=c.folder)||void 0===t?void 0:t.folderData)||void 0===i?void 0:i.title,p=d.username;if(u){h=l?a.searchAllUserContent.replace("${username}",p):a.searchAllContent;break}h=a.searchName.replace("${searchName}",null!=m?m:p);break;case"favorites":h=a.searchFavoritesContent;break;case"group":const g=null===(s=c.group)||void 0===s?void 0:s.label;h="all"!==(null===(r=c.group)||void 0===r?void 0:r.group)&&g?a.searchName.replace("${searchName}",g):a.searchGroupsContent;break;case"living atlas":h=a.searchLivingAtlasContent;break;case"org":h=a.searchOrganizationsContent}this.defaultPlaceholder=h},this.term=void 0,this.placeholder=void 0,this.defaultPlaceholder=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.search,(0,p.a)(this.store,this.computeDefaultPlaceholder),(0,p.c)(this.store,this.computeDefaultPlaceholder),this.computeDefaultPlaceholder()}render(){var e,t;const{term:i,placeholder:r,defaultPlaceholder:o}=this;return(0,s.h)(s.H,{key:"c58424b5ddc112bf6365b34dfc639516b0554eb1"},"subscription content"!==(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&(0,s.h)("arcgis-browser-search",{key:"b8412f9ce52b4108b9576a703d6731e5081f2c6d",term:i,placeholder:null!=r?r:o,onArcgisBrowserSearch:e=>this.arcgisItemBrowserSearch.emit(e.detail),onArcgisBrowserSearchInput:e=>this.arcgisItemBrowserSearchInput.emit(e.detail)}))}get el(){return(0,s.d)(this)}},ve={my:{sortField:"modified",sortOrder:"desc"},favorites:{sortField:"modified",sortOrder:"desc"},group:{sortField:"modified",sortOrder:"desc"},org:{sortField:"modified",sortOrder:"desc"},"subscription content":{sortField:"relevance",sortOrder:"asc"},"living atlas":{sortField:"relevance",sortOrder:"asc"},"living atlas analysis":{sortField:"relevance",sortOrder:"asc"},all:{sortField:"relevance",sortOrder:"asc"}},be=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserSort=(0,s.c)(this,"arcgisItemBrowserSort",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.options=["title","relevance","modified"],this.field=void 0,this.order=void 0,this.activeField=void 0,this.activeOrder=void 0,this.userSetSort=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el);const{field:e,options:t}=this;if(e)this.userSetSort=!0,this.activeField=e,this.activeOrder=this.order||(0,D.a)(e);else{const e=this.store.state.bucket&&ve[this.store.state.bucket];this.activeField=e?e.sortField:(null==t?void 0:t[0])||"relevance",this.activeOrder=(0,D.a)(this.activeField)}(0,p.d)(this.store,(e=>{this.activeField=e.sortField,this.activeOrder=e.sortOrder}))}updateOptions(e){var t,i;if(!e.includes(this.activeField)){const s=(null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.bucket)&&ve[this.store.state.bucket];this.activeField=s?s.sortField:null==e?void 0:e[0],this.activeOrder=(0,D.a)(this.activeField),this.arcgisItemBrowserSort.emit({sortField:this.activeField,sortOrder:this.activeOrder})}}componentDidLoad(){this.arcgisItemBrowserSort.emit({sortField:this.field||this.activeField,sortOrder:this.order||(this.field?(0,D.a)(this.field):this.activeOrder)})}emitInternal(){this.arcgisItemBrowserInternalUIAction.emit({category:"sort",action:`${this.activeField} ${"asc"===this.activeOrder?"ascending":"descending"}`})}updateSortField(e){this.activeField=e,this.activeOrder=(0,D.a)(e),this.arcgisItemBrowserSort.emit({sortField:this.activeField,sortOrder:this.activeOrder}),this.emitInternal()}updateSortOrder(e){this.activeOrder=e,this.arcgisItemBrowserSort.emit({sortField:this.activeField,sortOrder:this.activeOrder}),this.emitInternal()}render(){var e,t;const{activeField:i,activeOrder:r,field:o,order:a,options:l}=this,n=i||(l.includes(o)?o:l[0]),c=r||a;return(0,s.h)(s.H,{key:"896d71e96a577cf6b7968e6b8f945c417f673f16"},"subscription content"!==(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)&&(0,s.h)("arcgis-browser-sort",{key:"c0deac06eeca84e9896f928d86ffc755464f1559",store:this.store,field:n,order:c,options:l,onArcgisBrowserSortFieldChange:e=>this.updateSortField(e.detail),onArcgisBrowserSortOrderChange:e=>this.updateSortOrder(e.detail)}))}get el(){return(0,s.d)(this)}static get watchers(){return{options:["updateOptions"]}}},fe={title:{width:{default:"minmax(0, 7fr)"},header:!0},type:{width:{default:"minmax(0, 5fr)",md:"2.5rem"}},modified:{width:{default:"7.5rem"},header:!0,hide:860},badges:{width:{default:"6rem"},hide:1300},owner:{width:{useTextWidth:"owner",default:"minmax(0, 3fr)"},header:!0,hide:900},sharing:{width:{default:"5rem"},hide:1150},size:{width:{default:"minmax(0, 2fr)"},header:!0,hide:714},deleted:{width:{default:"12rem"},header:!0,hide:860},details:{width:{useTextWidth:"details",default:"8rem"},hide:1050},favorite:{width:{default:"3rem"},hide:1150},actions:{width:{default:"3rem"}}};function we(e,t){const{hide:i}=fe[e];return!i||t>i}const ye=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserColumnUpdate=(0,s.c)(this,"arcgisItemBrowserColumnUpdate",7),this.arcgisItemBrowserSort=(0,s.c)(this,"arcgisItemBrowserSort",7),this.rows=[],this.getColumnWidthId=e=>"details"!==e?e:this.store.state.recycleBin?"restore":"action"===this.store.state.tableRowPreview?"preview":"details",this.columns=["title","type","modified","badges","owner","sharing","details","actions"],this.textWidths=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.table,(0,p.e)(this.store,(e=>{var t;if(!e&&this.store.state.activeFocus){const[e,i]=this.store.state.activeFocus;this.updateRows();const s=null===(t=this.rows)||void 0===t?void 0:t[e];null==s||s.focusColumn(i)}})),this.calculateTextWidths()}async componentDidLoad(){this.arcgisItemBrowserColumnUpdate.emit(this.columns)}updateColumns(e){this.arcgisItemBrowserColumnUpdate.emit(e),this.calculateTextWidths(!0)}async attemptMove([e,t],i){const s=this.rows[e];if(await s.canFocusColumn(t))this.store.state.activeFocus=[e,t],requestAnimationFrame((()=>s.focusColumn(t)));else switch(i){case"right":return this.moveRight([e,t]);case"left":return this.moveLeft([e,t]);case"up":return this.moveUp([e,t]);case"down":return this.moveDown([e,t])}}updateRows(){var e;this.rows=null===(e=this.rowSlot)||void 0===e?void 0:e.assignedElements()}measureText(e,t){const i=e.measureText(t).width;return Math.ceil(i)}calculateTextWidths(e){var t,i,s;const{measureText:r}=this;if((null===(i=null===(t=this.store)||void 0===t?void 0:t.state)||void 0===i?void 0:i.i18n)&&this.columns&&(!this.textWidths||e)){null!==(s=this.canvas)&&void 0!==s||(this.canvas=document.createElement("canvas"));const e=this.canvas.getContext("2d");e.font="14px 'Avenir Next'",this.textWidths=this.columns.reduce(((t,i)=>{const{width:s}=fe[i];if(s.useTextWidth){let o=this.store.state.i18n.table.headers[s.useTextWidth];return"details"===s.useTextWidth&&(t=Object.assign(Object.assign({},t),{restore:r(e,this.store.state.i18n.tableRow.restore),preview:r(e,this.store.state.i18n.card.openDetails)}),o=this.store.state.i18n.tableRow.details),Object.assign(Object.assign({},t),{[i]:r(e,o)})}return t}),{})}}getLastColumnIndex(){const e="multiple"===this.store.state.selection;return this.columns.filter((e=>we(e,this.store.state.width))).length-(e?0:1)}getLastRowIndex(){return this.rows.length-1}async moveRight([e,t]){const i=t>=this.getLastColumnIndex()?0:t+1;this.attemptMove([e,i],"right")}async moveLeft([e,t]){const i=t<1?this.getLastColumnIndex():t-1;this.attemptMove([e,i],"left")}async moveUp([e,t]){const i=e<1?this.getLastRowIndex():e-1;this.attemptMove([i,t],"up")}async moveDown([e,t]){const i=e+1>this.getLastRowIndex()?0:e+1;this.attemptMove([i,t],"down")}handleKeyboard(e){const{key:t}=e,i=this.store.state.activeFocus||[0,0];switch(this.updateRows(),t){case"ArrowDown":return e.preventDefault(),this.moveDown(i);case"ArrowUp":return e.preventDefault(),this.moveUp(i);case"ArrowLeft":return e.preventDefault(),this.moveLeft(i);case"ArrowRight":return e.preventDefault(),this.moveRight(i)}}renderColumn(e){const t=this.i18n.headers[e],{header:i}=fe[e],{recycleBin:r}=this.store.state,o=i&&!(r&&"title"===e),{sortField:a,sortOrder:l}=this.store.state.sort||{},n="deleted"===e?"modified":e,c=a===n;return i&&o?(0,s.h)("div",{class:{"column-header":!0,"column-header--sorted":c}},!("title"!==e||"multiple"!==this.store.state.selection)&&(0,s.h)("div",{role:"columnheader",class:"screen-reader-only"},(0,s.h)("span",null,this.i18n.selection)),(0,s.h)("div",{role:"columnheader","aria-sort":"asc"===l?"ascending":"descending"},(0,s.h)("calcite-button",{width:"full",alignment:"icon-end-space-between",scale:"m",appearance:"transparent",kind:c?"brand":"neutral","icon-end":c&&"asc"===l?"caret-up":"caret-down",onClick:()=>{c?this.arcgisItemBrowserSort.emit({sortField:n,sortOrder:"asc"===l?"desc":"asc"}):this.arcgisItemBrowserSort.emit({sortField:n,sortOrder:(0,D.a)(n)})}},(0,s.h)("span",{class:{button__text:!0,"button__text--sorted":c}},t)))):(0,s.h)("div",{role:"columnheader",class:"column-header"},i?(0,s.h)("calcite-button",{tabindex:-1,class:"column-header--inactive",alignment:"start",width:"full",scale:"m",appearance:"transparent",kind:"neutral"},(0,s.h)("span",{class:"button__text"},t)):(0,s.h)("span",{class:"screen-reader-only"},t))}render(){const{loading:e}=this.store.state,t="multiple"===this.store.state.selection,i=this.columns.filter((e=>we(e,this.store.state.width)));return(0,s.h)(s.H,{key:"5601e1c9f1c725e538574ec4524ca4169078231b",style:{"--item-browser-table-columns":`${i.map((e=>{var t;return function(e,t,i){const s=fe[e],{default:r,md:o,useTextWidth:a}=s.width;if(a&&i>0)return`${i+(42+(s.header?18:0))}px`;return t&&t<=d.b.md&&o?o:r}(e,this.store.state.width,null===(t=this.textWidths)||void 0===t?void 0:t[this.getColumnWidthId(e)])})).join(" ")}`}},(0,s.h)("div",Object.assign({key:"0cc66ff146af344c6174ce08b01ab7dc2d7d7f74",class:"table","aria-label":this.i18n.caption,role:"grid","aria-readonly":"true"},t?{"aria-multiselectable":"true"}:{},{onKeyDown:e=>this.handleKeyboard(e)}),(0,s.h)("div",{key:"0d75a06c008d16c227af748a42f819cfbb90e12d",role:"rowgroup"},(0,s.h)("div",{key:"c887ff8720e429b1b4e73f485451e6bc4ffd7172",role:"row",class:"header"},i.map((e=>this.renderColumn(e))))),e?(0,s.h)("calcite-loader",{label:this.i18n.loading}):(0,s.h)("div",null,(0,s.h)("slot",{ref:e=>this.rowSlot=e}))))}get el(){return(0,s.d)(this)}static get watchers(){return{columns:["updateColumns"]}}};ye.style=".table{background-color:var(--calcite-color-foreground-1)}.header{display:grid;grid-template-columns:var(--item-browser-table-columns)}.button__text--sorted{font-weight:500}.column-header{border-bottom:1px solid var(--calcite-color-border-2);margin-bottom:1px}.column-header--sorted{border-bottom-color:var(--calcite-color-brand)}.column-header--inactive{pointer-events:none}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const Ie=class{constructor(e){var t;(0,s.r)(this,e),this.arcgisItemBrowserColumnUpdate=(0,s.c)(this,"arcgisItemBrowserColumnUpdate",7),this.arcgisItemBrowserCardSelect=(0,s.c)(this,"arcgisItemBrowserCardSelect",7),this.arcgisItemBrowserCardPreview=(0,s.c)(this,"arcgisItemBrowserCardPreview",7),this.arcgisItemBrowserActionsOpen=(0,s.c)(this,"arcgisItemBrowserActionsOpen",7),this.arcgisItemBrowserRestoreItem=(0,s.c)(this,"arcgisItemBrowserRestoreItem",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.columnRefs={},this.item=void 0,this.portal=void 0,this.index=void 0,this.user=void 0,this.api=4,this.baseUrl=null===(t=null===o.c||void 0===o.c?void 0:o.c.config)||void 0===t?void 0:t.baseUrl,this.link=void 0,this.newTab=void 0,this.name=void 0,this.preview=void 0,this.allowSharing=void 0,this.actions=[],this.showItemTypeHosted=!1,this.hasMouse=void 0,this.mouseOverColumn=void 0}async componentWillLoad(){var e,t,i;this.store=(0,p.g)(this.el),this.i18n=null===(i=null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.i18n)||void 0===i?void 0:i.tableRow,this.updateDetailsText(this.preview)}updateDetailsText(e){var t;this.store&&e&&(null===(t=this.store.state)||void 0===t?void 0:t.tableRowPreview)!==e&&(this.store.state.tableRowPreview=e)}async canFocusColumn(e){var t;const i=(this.store.state.columns||[]).filter((e=>we(e,this.store.state.width))),s=this.getColumnNumber(e),r=i[s];return"badges"===r?!this.badges.empty:!!(null===(t=this.columnRefs[r])||void 0===t?void 0:t.method)||s<0}async focusColumn(e){var t;let i=e;if("multiple"===this.store.state.selection){if(0===e)return void(null===(t=this.checkbox)||void 0===t||t.setFocus());i=e-1}const s=(this.store.state.columns||[]).filter((e=>we(e,this.store.state.width))),{el:r,method:o}=this.columnRefs[s[i]]||{};r[o]()}getColumnNumber(e){return"multiple"===this.store.state.selection?e-1:e}isSimpleColumn(e){return!["owner","details","favorite","actions"].includes(e)}clampColumn(e){return["title"].includes(e)}onClick(e){return{onClick:()=>{e()},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||e()}}}emitInternalAction(e){this.arcgisItemBrowserInternalUIAction.emit({category:"card action",action:e})}renderTitle(e){var t,i,r,o;const{item:a}=this,l=null!==(i=null===(t=this.store.state.activeFocus)||void 0===t?void 0:t[1])&&void 0!==i?i:0,n=(null!==(o=null===(r=this.store.state.activeFocus)||void 0===r?void 0:r[0])&&void 0!==o?o:0)===this.index,c=l<2,d=this.link&&"action"===this.preview,h=d?"a":"div";return(0,s.h)("div",{class:"checkbox-wrap",onMouseOver:()=>{this.mouseOverColumn=0},key:"title"},(0,s.h)("div",{role:"gridcell",class:"cell cell--end-2 cell--hoverable",onClick:()=>{if(this.checkbox){const e=!this.checkbox.checked;this.checkbox.checked=e,this.arcgisItemBrowserCardSelect.emit({item:a,selected:e})}}},(0,s.h)("calcite-checkbox",Object.assign({},n&&c||this.hasMouse&&0===this.mouseOverColumn?{}:{inert:!0},{class:"checkbox",checked:e,ref:e=>{this.checkbox=e},onClick:e=>{e.stopPropagation(),this.store.state.activeFocus=[this.index,0]},onCalciteCheckboxChange:()=>{this.arcgisItemBrowserCardSelect.emit({item:a,selected:!e})},value:a.id}),(0,s.h)("span",{class:"screen-readers-only"},a.title))),(0,s.h)(h,Object.assign({onMouseOver:()=>{this.mouseOverColumn=0},role:"gridcell",class:{"cell cell--narrow cell--start-2 cell--end-2 checkbox__title title":!0,"cell--hoverable":"title"===this.preview&&!this.store.state.recycleBin,"cell--hoverable--active":"title"===this.preview&&this.store.state.preview===a.id,"cell--link":this.link&&"title"!==this.preview},id:`row-${a.id}`,tabindex:1===l&&n?0:-1},d?{href:`${(0,U.h)(this.baseUrl)}/item.html?id=${a.id}`}:this.onClick((()=>{"title"!==this.preview||this.store.state.recycleBin||this.arcgisItemBrowserCardPreview.emit(a),this.store.state.activeFocus=[this.index,1]})),{ref:e=>{this.columnRefs.title={el:e,method:"focus"}}}),(0,s.h)("span",{class:"cell--clamp"},this.item.title)))}renderDeleted(){const{item:e,i18n:t,store:i}=this,r=function(e){const t=new Date(e),i=new Date(t.setDate(t.getDate()+P.D));return Math.max(Math.ceil((i.valueOf()-Date.now())/864e5),1)}(e.modified),o=r<2?t.deletesTomorrow:(0,f.b)(i.state.lang,t.deletes,r);return(0,s.h)("div",null,(0,s.h)("span",{class:"date-deleted"},(0,f.a)(e.modified)),(0,s.h)("span",{class:"deletes-in"},o))}renderColumn(e,t,i){var r,a,n,c,h,u,m;const{item:p,api:g,portal:v,baseUrl:b,user:w,actions:y}=this,I=null!==(a=null===(r=this.store.state.activeFocus)||void 0===r?void 0:r[1])&&void 0!==a?a:0,k=this.isSimpleColumn(e),{header:x}=fe[e],S=(null!==(c=null===(n=this.store.state.activeFocus)||void 0===n?void 0:n[0])&&void 0!==c?c:0)===this.index,C=t===this.getColumnNumber(I);if("title"===e&&"multiple"===this.store.state.selection)return this.renderTitle(i);const F={tabIndex:C&&S?0:-1},B=["owner"].includes(e),E=this.link&&"title"===e,_="action"===this.preview,T=_?"button":"a",A=E?"a":"div";return(0,s.h)(A,Object.assign({key:e},k?F:{},{role:"gridcell",class:{cell:!0,"cell--overflow":B,"cell--start-2":!x,"cell--end-2":!x,"cell--hoverable":"title"===e&&"title"===this.preview,"cell--hoverable--active":"title"===e&&this.store.state.preview===p.id&&!E,"cell--link":"title"===e&&this.link&&"title"!==this.preview},ref:t=>{k&&(this.columnRefs[e]={el:t,method:"focus"})}},E?{href:this.link}:{onClick:()=>{setTimeout((()=>{const i="multiple"===this.store.state.selection?t+1:t;C&&S||(this.store.state.activeFocus=[this.index,i]),"title"!==e||"title"!==this.preview||this.store.state.recycleBin||this.arcgisItemBrowserCardPreview.emit(p)}),100)}},{onMouseOver:()=>{this.mouseOverColumn=t}}),(0,s.h)("span",{class:{"cell--clamp":this.clampColumn(e),"cell__inner-container":!0}},"title"===e&&(0,s.h)("span",{class:"title"},this.item.title),"type"===e&&(0,s.h)("arcgis-item-type",{item:p,portal:this.portal,showHosted:this.showItemTypeHosted,user:w,class:"item-type",scale:"m",showText:this.store.state.width>d.b.md}),"modified"===e&&(0,f.a)(p.modified),"deleted"===e&&this.renderDeleted(),"size"===e&&(0,l.f)(p.size),"badges"===e&&(0,s.h)("arcgis-item-badges",{ref:e=>this.badges=e,showTooltips:!0,item:p,user:w,portal:v,width:"narrow",scale:"s",tabIndex:-1}),"sharing"===e&&(0,s.h)("arcgis-item-share-summary-editable",{user:w,showText:!1,item:p,scale:"m",allowEdit:this.allowSharing,groups:this.store.state.groupSharing[p.id],userGroups:this.store.state.userContentGroups,ref:e=>{this.allowSharing&&(this.columnRefs.sharing={el:e,method:"setFocus"})},portal:v,config:o.c.config,tabIndex:-1,onClick:()=>{this.emitInternalAction("share")}}),"owner"===e&&(0,s.h)("arcgis-user-popup",{item:p,underline:!0,api:g,portal:v,baseUrl:b,scale:"m",class:"user-popup",showName:this.store.state.width>d.b.lg,showAvatar:this.store.state.width<=d.b.lg,wrap:!0,ref:e=>{this.columnRefs.owner={el:e,method:"setFocus"}},onArcgisUserPopupInternalUIAction:e=>{var t;this.emitInternalAction(null===(t=e.detail)||void 0===t?void 0:t.action)},tabIndex:-1}),"details"===e&&(this.store.state.recycleBin?(0,s.h)("button",Object.assign({},F,{class:"button",ref:e=>{this.columnRefs.details={el:e,method:"focus"}},onClick:()=>{this.arcgisItemBrowserRestoreItem.emit(this.item)}}),this.i18n.restore):(0,s.h)(T,Object.assign({},F,_?{}:{href:`${(0,U.h)(this.baseUrl)}/item.html?id=${p.id}`},{class:{button:!0,"button--active":_&&this.store.state.preview===p.id},ref:e=>{this.columnRefs.details={el:e,method:"focus"}},onClick:()=>{"action"!==this.preview||this.store.state.recycleBin||this.arcgisItemBrowserCardPreview.emit(p),this.store.state.activeFocus=[this.index,1],this.emitInternalAction("view details")}}),_?null===(m=null===(u=null===(h=this.store)||void 0===h?void 0:h.state)||void 0===u?void 0:u.i18n)||void 0===m?void 0:m.card.openDetails:this.i18n.details)),"favorite"===e&&(0,s.h)("arcgis-item-favorite",{item:p,portal:v,user:w||(null===o.c||void 0===o.c?void 0:o.c.user),iconOnly:!0,ref:e=>{this.columnRefs.favorite={el:e,method:"setFocus"}},onArcgisItemFavoriteUpdate:e=>{this.emitInternalAction(e.detail.favorite?"add to fav":"remove from fav")},showTooltip:!0,tabIndex:-1}),"actions"===e&&(0,s.h)("span",null,y.length>0&&(0,s.h)("button",Object.assign({},F,{class:"button button--transparent","aria-label":this.i18n.moreOptions,"aria-haspopup":"true",slot:"trigger",ref:e=>{this.columnRefs.actions={el:e,method:"focus"}},onClick:e=>{this.arcgisItemBrowserActionsOpen.emit({el:e.target,actions:y})}}),(0,s.h)("calcite-icon",{icon:"ellipsis",scale:"s",class:"button__icon"})))))}render(){var e,t;const{item:i,store:r,i18n:o}=this;if(!i||!r||!o)return;const a=(this.store.state.columns||[]).filter((e=>we(e,this.store.state.width))),l=null===(e=this.store)||void 0===e?void 0:e.state.selection,n=["single","multiple"].includes(l)&&(0,m.b)({item:i,selectedItems:null===(t=this.store)||void 0===t?void 0:t.state.selectedItems});return(0,s.h)(s.H,Object.assign({},n?{"data-selected":!0}:{},{onMouseOver:()=>{this.hasMouse=!0},onMouseOut:()=>{this.hasMouse=!1}}),(0,s.h)("div",Object.assign({class:{row:!0,"row--selected":n,"row--first":0===this.index},role:"row"},n?{ariaSelected:!0}:{},{"aria-labelledby":`row-${i.id}`}),a.map(((e,t)=>this.renderColumn(e,t,n)))))}get el(){return(0,s.d)(this)}static get watchers(){return{preview:["updateDetailsText"]}}};Ie.style=":host{display:block;--item-browser-table-row-active-background:var(--calcite-color-foreground-1)}@media (forced-colors: active){calcite-checkbox{border:1px solid var(--calcite-color-border-1)}}.row{display:grid;background-color:var(--calcite-color-foreground-1);grid-template-columns:var(--item-browser-table-columns);border:1px solid var(--calcite-color-foreground-1);border-top:1px solid var(--calcite-color-border-2);margin-top:-1px}.row--first{border-top-color:var(--calcite-color-foreground-1)}.row--selected{position:relative;border-color:var(--calcite-color-brand);background-color:var(--item-browser-table-row-active-background)}.row--selected-last{border-top-color:var(--item-browser-table-row-active-background)}.cell{display:flex;align-items:center;justify-content:flex-start;padding-top:0.5rem;padding-bottom:0.5rem;padding-inline-start:0.75rem;padding-inline-end:0.25rem;font-size:0.875rem;color:var(--calcite-color-text-1);transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;outline-color:transparent;line-height:1.35}.cell:focus{outline:2px solid var(--calcite-color-brand);outline-offset:-2px}.cell--clamp{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.cell--link{background-color:transparent;text-decoration-line:none;transition-property:all;transition-duration:150ms}.cell--link:hover,.cell--link:focus{background-color:var(--calcite-color-background);text-decoration-line:underline;text-decoration-style:solid}.cell--start-2{padding-inline-start:0.5rem}.cell--end-2{padding-inline-end:0.5rem}.cell--overflow{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-wrap:break-word}.cell--hoverable{background-color:transparent;transition-property:all;transition-duration:150ms}.cell--hoverable:hover,.cell--hoverable--active{cursor:pointer;background-color:var(--calcite-color-foreground-2);text-decoration-line:underline;text-underline-offset:2px;transition:background-color text-decoration 200ms linear}.cell__inner-container{width:100%}.checkbox-wrap{display:flex}.checkbox__title{flex:1 1 0%}.title{word-break:break-all}.user-popup{width:100%}.item-type{display:flex}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.date-deleted{display:block;padding-bottom:0.25rem;font-size:0.875rem;font-weight:400;color:var(--calcite-color-text-1)}.deletes-in{display:block;font-size:0.75rem;font-weight:400;color:var(--calcite-color-text-2)}.button{border:1px solid var(--calcite-color-foreground-3);font-family:inherit;font-size:inherit;line-height:1;box-sizing:border-box;display:flex;max-width:100%;cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;align-items:center;background-color:var(--calcite-color-foreground-1);padding-left:0.75rem;padding-right:0.75rem;padding-top:0.5rem;padding-bottom:0.5rem;color:var(--calcite-color-text-1);text-decoration-line:none;outline-color:transparent;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s}.button:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.button:focus{outline:2px solid var(--calcite-color-brand);outline-offset:2px}.button--active{background-color:var(--calcite-color-foreground-3)}.button--transparent{border:1px solid transparent;background:transparent;padding-left:0.5rem;padding-right:0.5rem}.button--transparent:hover{background-color:var(--calcite-color-foreground-2);box-shadow:none}.button__icon{pointer-events:none}";const ke=class{constructor(e){(0,s.r)(this,e)}async componentWillLoad(){this.store=(0,p.g)(this.el)}render(){var e,t;return(0,s.h)(s.H,{key:"70a83a10ba40411438b3052c7a7b475eedf67e3c"},(0,s.h)("arcgis-browser-top-bar",{key:"629c8bfc90c36cd6f987acaf680d781ea1b1d763",store:this.store,filtersDisabled:"subscription content"===(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.bucket)},(0,s.h)("div",{key:"0b58dc6645233b72967b4a62e1d006ca27ca9221",slot:"content-start"},(0,s.h)("slot",{key:"7d065e619f98c9d5377f94ac723ca7969f243117",name:"content-start"})),(0,s.h)("div",{key:"a1b682affcd65aaa3cbdbe6f5fc152592d6a95c6",slot:"bucket"},(0,s.h)("slot",{key:"b34d74127f603d426299f00b618d3e31c886507a",name:"bucket"})),(0,s.h)("div",{key:"f2e7fb547b629780d1d457c5db95b2002086072f",slot:"search"},(0,s.h)("slot",{key:"e0d5f3fd847b6d2b036918b82d402146a91e4722",name:"search"})),(0,s.h)("div",{key:"dde418ef65f58c475e7d4851218a72f421a0b034",slot:"content-end"},(0,s.h)("slot",{key:"cf3cd64ac9567badb93c0a3b4d2dbe4df25e6427",name:"content-end"}))))}get el(){return(0,s.d)(this)}},xe=class{constructor(e){(0,s.r)(this,e),this.arcgisItemBrowserView=(0,s.c)(this,"arcgisItemBrowserView",7),this.arcgisItemBrowserInternalUIAction=(0,s.c)(this,"arcgisItemBrowserInternalUIAction",7),this.options=["grid","list"],this.view=void 0}async componentWillLoad(){this.store=(0,p.g)(this.el),this.i18n=this.store.state.i18n.view;const{view:e}=this;e||(this.view=this.store.state.view||"list"),(0,p.f)(this.store,(e=>{this.view=e}))}syncStore(e){this.store.state.view=e}componentDidLoad(){this.arcgisItemBrowserView.emit(this.view)}renderOption(e){return(0,s.h)("calcite-dropdown-item",{key:e,selected:e===this.view,onCalciteDropdownItemSelect:()=>{this.arcgisItemBrowserView.emit(e),this.arcgisItemBrowserInternalUIAction.emit({category:"switch view",action:e})},iconStart:e,iconFlipRtl:"start"},this.i18n[e])}renderButton(){var e,t;const{i18n:i,view:r}=this,o={class:"button",slot:"trigger",scale:"m",appearance:"outline-fill",kind:"neutral",iconStart:r,iconFlipRtl:"start",ariaLabel:`${i.view}: ${i[r]}`};return(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.width)>d.D?(0,s.h)("calcite-button",Object.assign({},o),i[r]):(0,s.h)("calcite-button",Object.assign({},o))}render(){var e,t;if(!(null===(t=null===(e=this.store)||void 0===e?void 0:e.state)||void 0===t?void 0:t.recycleBin))return(0,s.h)(s.H,null,(0,s.h)("calcite-dropdown",{placement:"bottom-end",scale:"m",overlayPositioning:"fixed",widthScale:"s"},this.renderButton(),(0,s.h)("calcite-dropdown-group",{selectionMode:"single"},this.options.map((e=>this.renderOption(e))))))}get el(){return(0,s.d)(this)}static get watchers(){return{view:["syncStore"]}}}},29259:(e,t,i)=>{i.d(t,{U:()=>s,a:()=>a,b:()=>r,g:()=>o});const s="/Categories",r=(e,t,i=!0)=>{const s=null!=e?e:"";return`${s}${s.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function o(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||s}const a=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},43780:(e,t,i)=>{i.d(t,{a:()=>m,b:()=>h,c:()=>u,d:()=>g,f:()=>d,g:()=>c,u:()=>p});var s=i(46581),r=i(29259),o=i(31670),a=i(59673),l=i(59296),n=i(94788);const c=async({portal:e,user:t,group:i,useCache:s=!1})=>{var r;try{const o=await(i?h(i.id,e,s):d(e,t,s));return{result:null!==(r=null==o?void 0:o.categorySchema)&&void 0!==r?r:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function d(e,t,i=!0){if(null!=e||(e=o.c.portal),null!=t||(t=o.c.user),!(null==e?void 0:e.id)||t&&(0,l.a)(t))return null;const r=()=>(0,s.r)(`${(0,n.g)(e)}portals/${e.id}/categorySchema`);return i?(0,s.f)(r,"categorySchema",e.id):r()}async function h(e,t,i=!0){if(null!=t||(t=null===o.c||void 0===o.c?void 0:o.c.portal),!e||!t)return null;const r=()=>(0,s.r)(`${(0,a.a)(t,{id:e})}categorySchema`);return i?(0,s.f)(r,"categorySchema",e):r()}async function u(e,t,i=!0){if(null!=e||(e=o.c.portal),null!=t||(t=o.c.user),!(null==e?void 0:e.id)||t&&(0,l.a)(t))return null;const r=()=>(0,s.r)(`${(0,n.g)(e)}portals/${e.id}/memberCategorySchema`);return i?(0,s.f)(r,"memberCategorySchema",e.id):r()}async function m(e,t,i=!0){const r=()=>async function(e,t){var i;const r=(0,n.g)(e),o=(0,n.d)(e),l=await(0,s.r)(`${r}portals/self?culture=${o}`),c=await(0,s.r)(`${r}community/groups?q=${l.contentCategorySetsGroupQuery}`),d=null===(i=null==c?void 0:c.results)||void 0===i?void 0:i[0],h=(await(0,s.r)((0,a.g)(e,d),{q:`typekeywords: ${t}`})).results[0];return(0,s.r)(`${r}content/items/${h.id}/data`)}(e,t);return i?(0,s.f)(r,"categorySchema",t):r()}async function p({categories:e,itemIds:t,portal:i}){try{const r=`${(0,n.g)(i)}/content/updateItems`,o=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,s.r)(r,{items:o},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const g=async({path:e,portal:t,group:i,updateInfo:s})=>{try{const o=(await v({category:e,portal:t,group:i,num:1})).total;if(0===o)return console.warn(`No items found with category ${e} when updating schema`),{};const a=100,l=Math.ceil(o/a),n=[];for(let o=0;o<l;o++)n.push(v({category:e,portal:t,group:i,start:o*a,num:a}).then((({results:t})=>{const i={};return t.forEach((t=>{const o="change-title"===s.type?t.categories.map((t=>{const i=(0,r.a)(e,s.newTitle);return t===e?i:t.replace(`${e}/`,`${i}/`)})):t.categories.filter((t=>!t.startsWith(e)));i[t.id]=o})),i})));const c=await Promise.all(n);return await Promise.all(c.map((e=>p({categories:e,itemIds:Object.keys(e),portal:t})))),{}}catch(t){return console.error(`Error ${s.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},v=({category:e,num:t=100,start:i=0,portal:r,group:o})=>{const l={start:i,num:t,categories:JSON.stringify([e])},c=o?(0,a.g)(r,o):`${(0,n.g)(r)}search`;return(0,s.r)(c,Object.assign(Object.assign({},l),{q:o?void 0:`orgid: ${r.id}`}))}},89209:(e,t,i)=>{i.d(t,{D:()=>s,M:()=>r});const s=14,r=5},73596:(e,t,i)=>{i.d(t,{a:()=>o,f:()=>c,g:()=>n,s:()=>a,v:()=>l});var s=i(86537),r=i(46227);function o(e,t){const i=/(?:\.([^.]+))?$/;let s=null==e?void 0:e.replace(/^.*(\\|\/|:)/,""),o=s&&i.exec(s)[1]?i.exec(s)[1].toLowerCase():"",a="";if(s.indexOf(".rft.")>-1){const[e,t]=s.split(".rft.");o=`rft.${t}`,a=e}return s&&!a&&(a=-1===s.lastIndexOf(".")?s:s.substring(0,s.lastIndexOf("."))),a=a.replace(/\.|-/g,"_"),t&&(a=function(e){return`${e}_${(0,r.g)()}`}(a),s=`${a}.${o}`),{title:a,fileName:s,extension:o}}function a(e,t){return o(e.name,!!t)}function l(e,t){let i=e;const s=e.lastIndexOf("\\");return s>-1&&(i=i.substring(s+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function n(e){return s.a[e]?s.a[e]:s.a[Object.keys(s.a).find((t=>s.a[t].type===e))]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},46227:(e,t,i)=>{i.d(t,{g:()=>s});const s=()=>[2,1,1,1,3].map((e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")},83364:(e,t,i)=>{function s(e){const t=e;return!(!(null==t?void 0:t.item)||!t.sublayer)}function r(e){const t=e;return!(!(null==t?void 0:t.item)||!t.task)}function o({item:e,sublayer:t,task:i,selectedItem:o}){var a,l,n;return r(o)&&i?(null==e?void 0:e.id)===(null===(a=o.item)||void 0===a?void 0:a.id)&&i===o.task:s(o)&&t?(null==e?void 0:e.id)===(null===(l=o.item)||void 0===l?void 0:l.id)&&t.id===(null===(n=o.sublayer)||void 0===n?void 0:n.id):(null==e?void 0:e.id)===o.id}function a({item:e,sublayer:t,task:i,selectedItems:s}){return(s||[]).some((s=>o({item:e,sublayer:t,task:i,selectedItem:s})))}function l({item:e,sublayer:t,task:i,selectedItems:s}){return(s||[]).filter((s=>!o({item:e,sublayer:t,task:i,selectedItem:s})))}function n({item:e,sublayer:t,task:i,selectedItems:s}){const r=i?{item:e,task:i}:t?{item:e,sublayer:t}:e;return a({item:e,sublayer:t,task:i,selectedItems:s})?[...s]:[...s,r]}function c({item:e,selectedItems:t}){return t.filter((t=>{var i;return(null===(i=t.item)||void 0===i?void 0:i.id)===(null==e?void 0:e.id)}))}function d(e){return r(e)||s(e)?e.item:e}function h({selectedItems:e,items:t}){let i=!1;const o=e.map((e=>{const o=d(e),a=t.find((e=>e.id===o.id));return a&&(i=!0),function(e,t){return r(t)||s(t)?Object.assign(Object.assign({},t),{item:e}):e}(a,e)}));return i?o:e}i.d(t,{a:()=>s,b:()=>a,d:()=>l,f:()=>c,g:()=>d,i:()=>r,s:()=>n,u:()=>h})},50858:(e,t,i)=>{i.d(t,{a:()=>n,b:()=>l,c:()=>c,d:()=>u,e:()=>h,f:()=>a,g:()=>o,o:()=>d,r:()=>m});var s=i(69773),r=i(80619);function o(e){return(0,s.g)(e,"arcgis-item-browser")}const a=(e,t)=>{e.onChange("view",(e=>{t(e)}))},l=(e,t)=>{e.onChange("contentUser",(e=>{t(e)}))},n=(e,t)=>{e.onChange("bucket",(e=>{t(e)}))},c=(e,t)=>{e.onChange("filters",(e=>{t(e)}))},d=(e,t)=>{e.onChange("recycleBin",(e=>{t(e)}))},h=(e,t)=>{e.onChange("preview",(e=>{t(e)}))},u=(e,t)=>{e.onChange("sort",(e=>{t(e)}))},m=e=>(Object.keys(e).forEach((t=>{r.I.includes(t)||delete e[t]})),e)},79238:(e,t,i)=>{i.d(t,{a:()=>s,e:()=>r,f:()=>o});const s={point:"point",line:"line",polygon:"polygon",multipatch:"cube",table:"table",multipoint:"layer-points"},r={esriGeometryPoint:"point",esriGeometryPolyline:"line",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"cube",esriGeometryMultipoint:"point",none:"table"},o={esriFieldTypeOID:"key",esriFieldTypeBoolean:"boolean",esriFieldTypeString:"string",esriFieldTypeSingle:"number",esriFieldTypeDouble:"number",esriFieldTypeInteger:"integer",esriFieldTypeSmallInteger:"integer",esriFieldTypeGlobalID:"key",esriFieldTypeDate:"date-time",esriFieldTypeBigInteger:"integer",esriFieldTypeDateOnly:"calendar",esriFieldTypeTimeOnly:"clock",esriFieldTypeTimestampOffset:"time-zone",esriFieldTypeGUID:"key"}},80549:(e,t,i)=>{function s({geometry:e,type:t}){switch(t){case"Catalog Layer":return{icon:"catalog-dataset",type:"catalog",isGeometry:!1};case"Parcel Layer":return{icon:"parcel-layer",type:"parcel",isGeometry:!1};case"Oriented Imagery Layer":return{icon:"oriented-imagery-layer",type:"oriented imagery",isGeometry:!1};case"Table":return{icon:"table",type:"table",isGeometry:!0}}switch(e){case"point":case"esriGeometryPoint":return{type:"point",icon:"point",isGeometry:!0};case"esriGeometryMultipoint":case"multipoint":return{type:"multipoint",icon:"layer-points",isGeometry:!0};case"line":case"polyline":case"esriGeometryPolyline":return{type:"line",icon:"line",isGeometry:!0};case"polygon":case"esriGeometryPolygon":return{type:"polygon",icon:"polygon",isGeometry:!0};case"multipatch":case"esriGeometryMultiPatch":return{type:"multipatch",icon:"cube",isGeometry:!0};default:return{type:"table",icon:"table",isGeometry:!0}}}i.d(t,{g:()=>s})},58407:(e,t,i)=>{function s(e,t){return e&&0!==e.trim().length?function(e,t){return null==t?void 0:t.some((t=>t.title===e))}(e,t)?"folderAlreadyExists":!(!e.includes(">")&&!e.includes("<"))&&"invalidCharacters":"noName"}function r(e){const{folderId:t,currentUsername:i,selectedFolderId:s}=e;switch(t){case"all":return"folders";case i:return"home";case"recycle":return"recycle-bin";default:return t===s?"folder-open":"folder"}}i.d(t,{a:()=>r,g:()=>s})}}]);