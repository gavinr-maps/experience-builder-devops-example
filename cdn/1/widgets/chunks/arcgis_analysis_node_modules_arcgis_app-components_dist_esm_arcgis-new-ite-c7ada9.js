/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-c7ada9.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-c7ada9"],{27968:(e,i,a)=>{a.r(i),a.d(i,{arcgis_new_item_pages_data_upload:()=>p});var t=a(7263),s=a(31670),r=a(73596),l=a(51325),n=a(5992),o=a(71700),c=a(99907),d=a(7380),h=a(7652);a(11935),a(86537),a(39274),a(94788),a(49712),a(90079),a(57399),a(65215),a(50852),a(2174),a(28926),a(70506),a(99004),a(46581),a(66488),a(67575),a(15437),a(91253),a(43780),a(59673),a(59296),a(24125),a(11163),a(28944),a(71695),a(76173);const p=class{constructor(e){(0,t.r)(this,e),this.newItemUpdatePage=(0,t.c)(this,"newItemUpdatePage",7),this.workflowComplete=(0,t.c)(this,"workflowComplete",7),this.allowedExtensions=null,this.loading=!1,this.loaderMessage=void 0,this.loaderType="indeterminate",this.error=void 0}componentWillLoad(){const{existingItem:e,fileName:i}=o.a,a=e.type;switch(this.i18n=c.u.i18n.appendUpload,this.item=e,a){case"Vector Tile Service":this.header=this.i18n.editStyle;break;case"Vector Tile Package":case"Layer Package":case"Tile Package":this.header=this.i18n.updatePackages.replace("${type}",a.toLowerCase()).replace("${hostedLayerName}",i);break;case"Microsoft Powerpoint":case"Microsoft Word":case"PDF":this.header=this.i18n.uploadStaticFiles.replace("${fileName}",i);break;default:this.header=this.i18n.sameFileNameDescription.replace("${fileName}",i)}"Vector Tile Service"===a&&(this.allowedExtensions=["json"])}async fileSelectHandler(e){var i;this.sourceName=(null===(i=o.a.existingItem.sourceData)||void 0===i?void 0:i.name)||o.a.existingItem.name;const a=e.detail.file,t=o.a.existingItem.type,{title:s,fileName:n,extension:c}=(0,r.s)(a);if("Vector Tile Service"===t){if("json"!==c)return void this.handleError({code:"invalidExtension"})}else if(n!==this.sourceName)return void this.handleError({code:"useSameFileName"});l.i.title=s,o.a.file=a,o.a.fileName=n,o.a.newItemMode="file",o.a.extension=c;const h=(0,d.f)(c);if(1===h.length){const e=h[0].type;o.a.type=e}"Layer Package"===t?this.newItemUpdatePage.emit("appendSelectUpdate"):"Vector Tile Service"===t?this.handleUpdateStyle():this.handleUpdate()}async handleUpdate(){this.loading=!0,this.loaderMessage=c.u.i18n.append.appendLoadingMessages.updating;const e=await(0,n.b)(o.a.existingItem,(0,h.g)({username:this.item.owner},s.c.portal),{file:o.a.file,overwrite:!0,keepDescription:!0,fileName:o.a.fileName});e.success?this.workflowComplete.emit({success:e.success}):this.handleError({code:"unhandledError"})}async handleUpdateStyle(){this.loading=!0,this.loaderMessage=c.u.i18n.append.appendLoadingMessages.updating;const{result:e,error:i}=await(0,n.c)(o.a.existingItem,(0,h.g)({username:this.item.owner},s.c.portal),{file:o.a.file});e.success&&this.workflowComplete.emit({success:e.success}),i&&this.handleError({code:i.code})}async handleError(e){let i=this.i18n.errors.errorWhileUpload;switch(this.loading=!1,e.code){case"invalidExtension":i=this.i18n.errors.invalidStyleFileExtension;case"useSameFileName":i=this.i18n.errors.sameFileName.replace("${x}",this.sourceName);break;case"unhandledError":i=this.i18n.errors.errorUpdate}this.error={title:c.u.i18n.error,description:i}}render(){const{header:e,loaderType:i,loading:a,loaderMessage:r,error:l,allowedExtensions:n}=this,{portal:o,config:c,user:d}=s.c;return(0,t.h)(t.H,{key:"78637b8e873c94086ce21d5bd6a1b9260353f1a2"},(0,t.h)("arcgis-new-item-loader",{key:"7e6afa03d297dabb604ac276cf4635a8ad369652",type:i,active:a,text:r}),(0,t.h)("arcgis-new-item-description",{key:"e994f7a4738d4f185923ea4936e916fd434c6170",header:e}),(0,t.h)("arcgis-file-browser",{key:"2a978fcf53c86ee925faf93e4d52d567303838c8",class:"arcgis-file-browser",cloud:!1,insideModal:!0,fullHeight:!0,portal:o,config:c,user:d,allowedExtensions:n}),(0,t.h)("arcgis-new-item-alert",{key:"5b517ca1f7a097490cc89b5c3677a7ddfcc069c5",heading:null==l?void 0:l.title,description:null==l?void 0:l.description,link:{href:null==l?void 0:l.link,title:null==l?void 0:l.linkText},active:!!l,onAlertDismiss:()=>this.error=null}))}};p.style=".arcgis-file-browser{display:block;height:95%}"},7380:(e,i,a)=>{a.d(i,{a:()=>o,f:()=>r,i:()=>n,m:()=>l});var t=a(11246),s=a(86537);function r(e,i){let a;a=i?i.map((e=>e.type)):Object.keys(s.a);let t=[];return a.forEach((i=>{var a;(null===(a=s.a[i].fileExt)||void 0===a?void 0:a.indexOf(e))>=0&&t.push(s.a[i])})),t}function l(e){return e?(0,t.b)(e.flatMap((e=>{var i;return null===(i=s.a[e])||void 0===i?void 0:i.fileExt})).filter((e=>!!e))):null}const n=e=>e/1024/1024>50,o=e=>e/1024/1024>20}}]);