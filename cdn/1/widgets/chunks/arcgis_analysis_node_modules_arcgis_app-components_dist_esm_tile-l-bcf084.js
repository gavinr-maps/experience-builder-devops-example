/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_tile-l-bcf084.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_tile-l-bcf084"],{11163:(e,l,a)=>{a.d(l,{D:()=>n,T:()=>t,a:()=>u,b:()=>v,c:()=>f,d:()=>s,e:()=>o,f:()=>r,g:()=>c,p:()=>d,t:()=>i});const r=["standard","custom"],i=["IntegratedMesh","3DObject"],n=i[0],s=["vector","raster","3dTiles"],t=147914382,o=0,c=[{level:0,label:"1:591,657,528",scale:591657527.591555},{level:1,label:"1:295,828,764",scale:295828763.795777},{level:2,label:"1:147,914,382",scale:147914381.897889},{level:3,label:"1:73,957,191",scale:73957190.948944},{level:4,label:"1:36,978,595",scale:36978595.474472},{level:5,label:"1:18,489,298",scale:18489297.737236},{level:6,label:"1:9,244,649",scale:9244648.868618},{level:7,label:"1:4,622,324",scale:4622324.434309},{level:8,label:"1:2,311,162",scale:2311162.217155},{level:9,label:"1:1,155,581",scale:1155581.108577},{level:10,label:"1:577,791",scale:577790.554289},{level:11,label:"1:288,895",scale:288895.277144},{level:12,label:"1:144,448",scale:144447.638572},{level:13,label:"1:72,224",scale:72223.819286},{level:14,label:"1:36,112",scale:36111.909643},{level:15,label:"1:18,056",scale:18055.954822},{level:16,label:"1:9,028",scale:9027.977411},{level:17,label:"1:4,514",scale:4513.988705},{level:18,label:"1:2,257",scale:2256.994353},{level:19,label:"1:1,128",scale:1128.497176},{level:20,label:"1:564",scale:564.248588},{level:21,label:"1:282",scale:282.124294},{level:22,label:"1:141",scale:141.062147}],u={spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-20037508.342787,y:20037508.342787},rows:256,cols:256,dpi:96,preciseDpi:96,lods:[{level:0,resolution:156543.033928,scale:591657527.591555},{level:1,resolution:78271.5169639999,scale:295828763.795777},{level:2,resolution:39135.7584820001,scale:147914381.897889},{level:3,resolution:19567.8792409999,scale:73957190.948944},{level:4,resolution:9783.93962049996,scale:36978595.474472},{level:5,resolution:4891.96981024998,scale:18489297.737236},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147}]},d={spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-20037508.342787,y:20037508.342787},rows:512,cols:512,dpi:96,preciseDpi:96,lods:[{level:0,resolution:78271.51696399994,scale:295828763.795777},{level:1,resolution:39135.75848200009,scale:147914381.897889},{level:2,resolution:19567.87924099992,scale:73957190.948944},{level:3,resolution:9783.93962049996,scale:36978595.474472},{level:4,resolution:4891.96981024998,scale:18489297.737236},{level:5,resolution:2445.98490512499,scale:9244648.868618},{level:6,resolution:1222.992452562495,scale:4622324.434309},{level:7,resolution:611.4962262813797,scale:2311162.217155},{level:8,resolution:305.74811314055756,scale:1155581.108577},{level:9,resolution:152.87405657041106,scale:577790.554289},{level:10,resolution:76.43702828507324,scale:288895.277144},{level:11,resolution:38.21851414253662,scale:144447.638572},{level:12,resolution:19.10925707126831,scale:72223.819286},{level:13,resolution:9.554628535634155,scale:36111.909643},{level:14,resolution:4.77731426794937,scale:18055.954822},{level:15,resolution:2.388657133974685,scale:9027.977411},{level:16,resolution:1.1943285668550503,scale:4513.988705},{level:17,resolution:.5971642835598172,scale:2256.994353},{level:18,resolution:.29858214164761665,scale:1128.497176},{level:19,resolution:.14929107082380833,scale:564.248588},{level:20,resolution:.07464553541190416,scale:282.124294},{level:21,resolution:.03732276770595208,scale:141.062147},{level:22,resolution:.01866138385297604,scale:70.5310735},{level:23,resolution:.009330691929342804,scale:35.265536760789715}]},v={format:"indexedVector",compressionQuality:0,antialiasing:!1},f={format:"PNG32",compressionQuality:0,antialiasing:!0}},60420:(e,l,a)=>{a.d(l,{a:()=>f,b:()=>b,c:()=>p,d:()=>m,e:()=>y,f:()=>O,g:()=>h,h:()=>v,l:()=>g,p:()=>S});var r=a(31670),i=a(28926),n=a(94788),s=a(11163),t=a(50852),o=a(8045),c=a(39274),u=a(46581),d=function(e,l){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&l.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)l.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(a[r[i]]=e[r[i]])}return a};const v=(e,l)=>{let a=!1;return l&&(null==e?void 0:e.length)>0&&(a=!e.some((e=>!function(e,l,a){if("Feature Layer"!==e.type||!e.drawingInfo)return!1;if("scenes"===a)return function(e,l){var a,r,i;const n=e.drawingInfo.renderer,s=e.drawingInfo.labelingInfo,t=e.featureReduction,o=e.fields;if(-1===["esriGeometryPoint","esriGeometryMultiPatch"].indexOf(e.geometryType))return!1;if(n.observationRenderer||n.latestObservationRenderer)return!1;if("heatmap"===n.type)return!1;if(null===(a=n.valueExpression)||void 0===a?void 0:a.length)return!1;if(null===(r=n.visualVariables)||void 0===r?void 0:r.some((e=>e.valueExpression.length)))return!1;const c=o.filter((e=>"esriFieldTypeDate"===e.type)).map((e=>e.name));if(c.length){if(c.indexOf(n.field)>-1||c.indexOf(n.field1)>-1)return!1;if(null===(i=n.visualVariables)||void 0===i?void 0:i.some((e=>e.field&&c.indexOf(e.field)>-1)))return!1}if(t)return!1;if(!l&&(null==s?void 0:s.length))return!1;return!0}(e,l);return f(e,l)}(e,!1,"tiles")))),a};function f(e,l){var a,r;if("esriGeometryMultiPatch"===e.geometryType)return!1;const i=null===(a=e.drawingInfo)||void 0===a?void 0:a.renderer,n=null===(r=e.drawingInfo)||void 0===r?void 0:r.labelingInfo,s=e.fields;return!g(e)&&(!(i&&e.geometryType&&(null==s?void 0:s.length)>0&&!p(i,e.geometryType,s))&&!(!l&&(null==n?void 0:n.length)))}const g=e=>{var l,a;const r=null!==(l=e.featureReduction)&&void 0!==l?l:null===(a=e.layerDefinition)||void 0===a?void 0:a.featureReduction;return!!r&&Object.keys(r).length>0},p=(e,l,a)=>{var r;if("heatmap"===e.type)return!1;if("esriGeometryPolygon"===l&&e.uniqueValueInfos&&e.visualVariables&&e.visualVariables.some((e=>{if("sizeInfo"===e.type&&!e.target)return!0})))return!1;const i=a.filter((e=>"esriFieldTypeDate"===e.type)).map((e=>e.name));if(i.length){if(i.indexOf(e.field)>-1||i.indexOf(e.field1)>-1)return!1;if(null===(r=e.visualVariables)||void 0===r?void 0:r.some((e=>i.indexOf(e.field)>-1)))return!1}return!0};const m=(e,l,a)=>{const{publishType:r,cacheOnDemand:i,tileInfo:n,cacheOnDemandMinScale:t,scale:c,layers:u}=l,{maxScale:v,minScale:f}=c,g={storageFormat:a||"vectorTiles"===l.publishType?"esriMapCacheStorageModeCompactV2":"esriMapCacheStorageModeExploded",packetSize:128},p=Object.assign(Object.assign({},"vectorTiles"===r?s.p:s.a),n);p.dpi&&!p.preciseDpi&&(p.preciseDpi=p.dpi),p.lods=p.lods.map((e=>d(e,["label"])));const m="vectorTiles"===r?Object.assign({},s.b):Object.assign({},s.c);let b={name:(0,o.a)(e.title),tilingSchema:{tileCacheInfo:p,tileImageInfo:m,cacheStorageInfo:g},minScale:f,maxScale:v};u&&(b.layers=u.map((({layerDefinition:e,id:l,drawingInfo:a})=>(null==e?void 0:e.drawingInfo)?{id:l,drawingInfo:Object.assign(Object.assign({},a),e.drawingInfo)}:{id:l,drawingInfo:a}))),"vectorTiles"!==r&&(b.cacheOnDemand=i,i&&(b=Object.assign(Object.assign({},b),{capabilities:"Map,ChangeTracking",cacheOnDemandMinScale:t})));return{publishContent:{itemId:e.id,filetype:"featureService",outputType:r,publishParameters:JSON.stringify(b),buildInitialCache:!1},publishParameters:b}},b=async(e,l)=>{if(!e.includes(l?"/VectorTileServer":"/MapServer"))return{error:{code:"invalidUrl"}};try{const r=await(0,u.r)(e,{},{addTokenManually:!1});return r&&r.singleFusedMapCache&&r.tileInfo?{result:(a=r.tileInfo,Object.assign(Object.assign({},a),{lods:(a.lods||[]).map((e=>Object.assign(Object.assign({},e),{label:`1:${Math.round(e.scale).toLocaleString("en-EN",{maximumFractionDigits:0})}`})))}))}:r&&l&&r.tileInfo?{result:r.tileInfo}:{error:{code:"noTilingSchemeFound"}}}catch(e){return console.error(e),{error:{code:"mapServiceError",message:JSON.stringify(e)}}}var a},y=async(e,l,a,r)=>{let n=null,t=s.T;const o={constraints:e,minScale:e.minScale,maxScale:e.maxScale||18055.954822};if(!r)return{maxSupportedMinScale:n,cacheOnDemandMinScale:t,calculatedScale:o};try{const c=await Promise.allSettled(a.map((({id:e})=>(async e=>{try{const[l]=await(0,i.l)(["esri/layers/FeatureLayer"]),a=new l(e),r=await a.addPlugin("esri/plugins/FeatureLayerStatistics");return{result:await r.target.statisticsPlugin.getSuggestedScaleRange({sampleSize:100,forPublishingTiles:!0})}}catch(e){return"string"==typeof e&&e.toLowerCase().includes("sampling returned 0 features")?{result:null,error:null}:(console.error(e),{error:{code:"unhandledError",message:JSON.stringify(e)}})}})(`${r}/${e}`))));let u=0,d=1/0;c.forEach((e=>{if("rejected"===e.status)return;const l=e.value.result;if(!l)return;const{maxScale:a,minScale:r}=l;u=null==r||r<=u?u:r,d=null==a||a>=d?d:a,t=null==r||r>=t?t:r})),n=e.minScale||s.T,t||(t=u),o.minScale=t||e.minScale,o.maxScale=d||o.maxScale,o.minScale>e.minScale&&e.minScale>0&&(o.minScale=e.minScale),o.maxScale>=o.minScale&&o.minScale>0&&(o.maxScale=((e,l,a)=>{var r,i;if(e<=l&&(null==a?void 0:a.length)>0){let n=-1;for(let l=a.length-1;l>=0;l--)if(e<a[l].scale){n=l+2;break}return n=n>a.length-1?a.length-1:n,null!==(i=null===(r=a[n])||void 0===r?void 0:r.scale)&&void 0!==i?i:l}return l})(o.minScale,o.maxScale,l))}catch(l){console.error(l),o.minScale=e.minScale}return{maxSupportedMinScale:n,cacheOnDemandMinScale:t,calculatedScale:o}},S=async(e,l,a)=>{var i;const{publishType:n,user:s,folder:d,title:v,tags:f,snippet:g,categories:p}=l;let m=Object.assign({},e);if(v){const e=JSON.parse(m.publishParameters);e.name=(0,o.a)(v),m.publishParameters=JSON.stringify(e)}const b=`${s.userContentUrl}/publish`,{services:y}=await(0,u.r)(b,m,{},"post"),{jobId:S,serviceItemId:h,serviceurl:O,error:I,type:w}=y[0]||{};if(I)throw console.error(I),I;return await(0,c.g)(h,{jobId:S,success:!0}),"scenes"!==n&&await(0,t.u)(h,{title:v,tags:f,snippet:g,categories:p}),a&&await(0,t.u)(h,{text:JSON.stringify(a)}),d.id!==(null===(i=r.c.initialFolder)||void 0===i?void 0:i.id)&&await(0,t.m)(h,(0,t.o)(d)?"/":d.id),{id:h,jobId:S,serviceType:w,serviceUrl:O}},h=async e=>{const l=r.c.portal,a=`${`${(0,n.g)(l)}portals/${l.id}`}/datastores/getServers`,i={datastoreId:e,f:"json"};try{return{result:(await(0,u.r)(a,i,{},"post")).servers}}catch(e){return console.error(e),{error:{code:"unhandledError",message:JSON.stringify(e)}}}},O=async({itemId:e,itemUrl:l,portal:a,publishType:r,fullLayers:i})=>{try{const{result:n}=await(0,t.p)(e,a),s=((null==n?void 0:n.layers)||[]).map(((a,n)=>{var s,t,o,c;if(!a)return null;const u=null!==(s=a.id)&&void 0!==s?s:n;let d=Object.assign(Object.assign({},a),{id:u,layerUrl:`${l}/${u}`,layerItemId:e,layerDefinition:a.layerDefinition});"vector"===r&&delete d.popupInfo,a.popupInfo&&(d=Object.assign(Object.assign({},d),{popupInfo:a.popupInfo})),null!=a.showLegend&&(d=Object.assign(Object.assign({},d),{showLegend:a.showLegend}));const v=i.find((e=>e.id===u));return d=Object.assign(Object.assign({},d),{drawingInfo:Object.assign(Object.assign(Object.assign({},null==v?void 0:v.drawingInfo),a.drawingInfo),{renderer:null!==(o=null===(t=a.drawingInfo)||void 0===t?void 0:t.renderer)&&void 0!==o?o:null===(c=null==v?void 0:v.drawingInfo)||void 0===c?void 0:c.renderer})}),d})).filter((e=>null!=e));return{result:Object.assign(Object.assign({},n),{layers:s})}}catch(e){return console.error(e),{error:{code:"unhandledError",message:JSON.stringify(e)}}}}}}]);