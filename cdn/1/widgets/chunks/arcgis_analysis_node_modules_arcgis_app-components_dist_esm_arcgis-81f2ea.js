/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81f2ea.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-81f2ea"],{9259:(e,t,a)=>{a.r(t),a.d(t,{arcgis_smart_mapping_panels_raster_class_breaks:()=>m,arcgis_smart_mapping_panels_raster_colormap:()=>p,arcgis_smart_mapping_panels_raster_flow:()=>g,arcgis_smart_mapping_panels_raster_rgb:()=>f,arcgis_smart_mapping_panels_raster_shaded_relief:()=>N,arcgis_smart_mapping_panels_raster_stretch:()=>k,arcgis_smart_mapping_panels_raster_unique_value:()=>I,arcgis_smart_mapping_panels_raster_vector_field:()=>R});var s=a(7263),n=(a(77040),a(70506),a(82646)),i=a(95875),l=a(32756),r=a(12234),o=a(42648),c=a(58233),d=a(11246),h=a(22601),u=a(39062);a(99004),a(62159),a(78613),a(11935),a(1991),a(28926),a(64391),a(75002);const m=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterClassBreaksClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksClose",7),this.arcgisSmartMappingPanelsRasterClassBreaksBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksBackClick",7),this.arcgisSmartMappingPanelsRasterClassBreaksError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksError",7),this.symbolNodes=[],this.labelNodes=[],this.inputNodes=[],this.disconnected=!1,this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this;(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{modules:e}=n.s,t=(0,n.a9)();this.originalRendererObj=e.esriLang.clone((0,n.a9)()),this.defaultColorRamp=t.classBreakInfos.map((e=>e.symbol.color))}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.disconnected=!0,clearTimeout(this.definedIntervalChangeHandle),clearTimeout(this.classesChangeHandle)}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"9b3ac8654adb1473348e79aa3800829d5133e93c",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"bf77e2b5be807bc5cd61640c3732856477cd5061",heading:a.panels.classBreaks.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterClassBreaksBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"class-breaks-block",heading:e.panels.classBreaks.classBreaks,open:!0},this.renderFieldSelector(),this.renderMethod(),this.renderClasses(),this.renderDefinedInterval(),this.renderColorScheme(),this.renderColorSlider(),this.renderValues())}renderFieldSelector(){var e;const{strings:t}=n.s,a=(0,n.a9)().field||t.panels.classBreaks.value,i=(0,o.g)(),l=i.map((e=>({label:e.alias,layerField:e,simpleFieldType:n.w.STRING}))),r=i.find((e=>e.name===a));return(0,s.h)("arcgis-smart-mapping-attribute-input",{label:t.panels.classBreaks.field,fieldList:l,selectedField:{field:null!==(e=null==r?void 0:r.name)&&void 0!==e?e:t.panels.classBreaks.value,simpleFieldType:n.w.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderMethod(){const e=(0,n.a9)();return(0,s.h)("arcgis-smart-mapping-method-button",{key:e.authoringInfo.classificationMethod,showDefinedInterval:!0,onArcgisSmartMappingMethodButtonBeforeOpen:()=>(0,n.m)(),onArcgisSmartMappingMethodButtonChange:e=>{var t,a;const l=(0,n.a9)();if("manual"===e.detail){l.authoringInfo.classificationMethod="manual",(0,n.a8)(),(0,s.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300)}else{let n,r=(null===(t=null==l?void 0:l.authoringInfo)||void 0===t?void 0:t.numClasses)||(null===(a=l.classBreakInfos)||void 0===a?void 0:a.length);if("defined-interval"===e.detail){const e=l.classBreakInfos;n=(e[e.length-1].maxValue-e[0].minValue)/5,r=Math.ceil((l.classBreakInfos[r-1].maxValue-l.classBreakInfos[0].minValue)/n)}(0,i.r)((0,o.b)({classificationMethod:e.detail,numClasses:r,definedInterval:n}),this.flowItemNode).then((e=>{this.updateRasterClassBreaksRenderer(e.renderer),(0,s.f)(this.hostElement),setTimeout((()=>this.methodButtonNode.setFocus()),300)}),(e=>{(0,s.f)(this.methodButtonNode),this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}},ref:e=>{e&&(this.methodButtonNode=e)}})}renderClasses(){const{strings:e}=n.s,t=(0,n.a9)(),a=t.classBreakInfos.length,i=t.authoringInfo.classificationMethod;return(0,s.h)("calcite-label",null,e.panels.classBreaks.classifyClasses,(0,s.h)("calcite-input-number",{value:`${a}`,disabled:"defined-interval"===i,min:1,max:10,step:1,scale:"s",onCalciteInputNumberInput:(0,d.d)((()=>{if(this.disconnected)return;clearTimeout(this.classesChangeHandle);const e=parseInt(this.classesNode.value);e!==a&&(!e||e<this.classesNode.min||e>this.classesNode.max?this.classesChangeHandle=setTimeout((()=>this.handleClassesChange()),3e3):this.handleClassesChange())}),300),ref:e=>{e&&(this.classesNode=e)}}))}renderDefinedInterval(){const{strings:e}=n.s,t=(0,n.a9)();if("defined-interval"!==t.authoringInfo.classificationMethod)return null;const a=t.classBreakInfos[0].maxValue-t.classBreakInfos[0].minValue,i=Math.floor((t.classBreakInfos[t.classBreakInfos.length-1].maxValue-t.classBreakInfos[0].minValue)/9.1),l=t.classBreakInfos[t.classBreakInfos.length-1].maxValue-t.classBreakInfos[0].minValue;return(0,s.h)("calcite-label",null,e.panels.classBreaks.definedInterval,(0,s.h)("calcite-input-number",{value:""+Math.round(100*a)/100,min:i,max:l,step:.1,scale:"s",onCalciteInputNumberInput:e=>{clearTimeout(this.definedIntervalChangeHandle);const t=e.target,a=parseFloat(t.value);!t.value||a<t.min||a>t.max?this.definedIntervalChangeHandle=setTimeout((()=>this.handleDefinedIntervalChange()),3e3):this.handleDefinedIntervalChange()},ref:e=>this.definedIntervalNode=e}))}renderColorScheme(){const{strings:e}=n.s,t=(0,n.a9)().classBreakInfos.map((e=>(0,n.Q)(e.symbol)));return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:e.panels.classBreaks.colorScheme,type:"raster-class-breaks",rampType:"discrete",colors:t,onArcgisSmartMappingSymbolButtonSymbolChange:e=>{const t=e.target,a=(0,n.a9)();this.defaultColorRamp=a.classBreakInfos.map((e=>e.symbol.color)),(0,n.a8)(),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode),(0,s.f)(t)},ref:e=>this.symbolButtonNode=e})}renderColorSlider(){return(0,s.h)("arcgis-smart-mapping-class-breaks-color-slider",{onArcgisSmartMappingClassBreaksColorSliderChange:e=>{const t=(0,n.a9)(),a=e.detail;(null==a?void 0:a.updateValues)&&(t.authoringInfo.classificationMethod="manual"),(null==a?void 0:a.invertColors)&&(0,s.f)(this.symbolButtonNode),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode),this.defaultColorRamp=t.classBreakInfos.map((e=>e.symbol.color))},ref:e=>this.sliderNode=e})}renderValues(){const e=(0,n.a9)();return this.labelNodes=[],this.inputNodes=[],(0,s.h)("calcite-list",null,e.classBreakInfos.map(((e,t)=>this.renderValue(e,t))).reverse())}renderValue(e,t){return(0,s.h)("calcite-list-item",null,(0,s.h)("div",{class:"symbol-container",slot:"actions-start"},this.renderSymbolNode(e,t)),this.renderTextNode(e,t))}renderSymbolNode(e,t){const{strings:a}=n.s;let i=(0,n.a9)().classBreakInfos[t].symbol.clone();const l={"symbol-is-white":(0,n.ai)(i),symbol:!0};return(0,s.h)("div",{class:l,tabindex:"0","aria-label":a.panels.classBreaks.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&this.symbolNodes.unshift(e)},onClick:()=>{this.popoverNode?(this.symbolNodes[this.selectedPopoverIdx].classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.m)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleValueSymbolClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateValueSymbol(e,t)}}))}renderTextNode(e,t){const{strings:a}=n.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",slot:"content",tabindex:"0",ref:e=>{e&&this.labelNodes.unshift(e)},"aria-label":a.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",ref:e=>{e&&this.inputNodes.unshift(e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if(a.stopPropagation(),"Escape"===a.key||"Enter"===a.key){this.inputNodes[t].classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){const t=(0,n.a9)();(0,i.r)((0,o.b)({field:e}),this.flowItemNode).then((e=>this.updateRasterClassBreaksRenderer(e.renderer)),(e=>{this.fieldNode.value=t.field,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}handleDefinedIntervalChange(){const e=(0,n.a9)(),t=e.classBreakInfos[0].maxValue-e.classBreakInfos[0].minValue;let a=parseFloat(this.definedIntervalNode.value);a!==t&&(isNaN(a)||a<this.definedIntervalNode.min?a=this.definedIntervalNode.min:a>this.definedIntervalNode.max&&(a=this.definedIntervalNode.max),a=parseFloat(a.toFixed(2)),this.definedIntervalNode.value=`${a}`,(0,i.r)((0,o.b)({definedInterval:a}),this.flowItemNode).then((e=>this.updateRasterClassBreaksRenderer(e.renderer)),(e=>{this.definedIntervalNode.value=`${t}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)})))}handleClassesChange(){(0,n.m)();const e=(0,n.a9)(),t=e.classBreakInfos.length,{authoringInfo:a}=e||{};a.numClasses=this.classesNode.value?Number.parseInt(this.classesNode.value,10):0,"manual"===a.classificationMethod&&(a.classificationMethod="equal-interval");const s=Math.min(Math.max(parseInt(this.classesNode.value),1),10)||5;`${s}`!==this.classesNode.value&&(this.classesNode.value=`${s}`),(0,i.r)((0,o.b)({numClasses:s}),this.flowItemNode).then((e=>this.updateRasterClassBreaksRenderer(e.renderer)),(e=>{this.classesNode.value=`${t}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}afterCreateValueSymbol(e,t){var a;const{modules:s}=n.s;let i=(0,n.a9)().classBreakInfos[t].symbol.clone();for(-1===t&&i.outline&&(i.outline.width=0),(0,n.ai)(i)&&(i.outline=new s.SimpleLineSymbol({color:"#bdc3c7",width:.75}));null===(a=null==e?void 0:e.childNodes)||void 0===a?void 0:a.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:l}=s;i&&l.renderPreviewHTML(i,{size:(0,n.aj)(i),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>null==e?void 0:e.appendChild(t)))}handleValueSymbolClick(e){(0,n.m)();const{strings:t}=n.s,a=(0,r.c)({referenceElement:this.flowItemNode,heading:t.panels.classBreaks.colorScheme});a.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,r.r)(a),setTimeout((()=>{this.symbolNodes[e].focus(),this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),a.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,r.r)(a),setTimeout((()=>{this.popoverNode=null,this.symbolNodes[e].classList.remove("selected")}),300)})),n.s.classedSymbolSelectedIdx=e,(0,l.b)({popoverNode:a,onChange:()=>{(0,n.a8)(),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode)}}),this.popoverNode=a,this.symbolNodes[e].classList.add("selected")}handleValueTextChange(e,t){const a=(0,n.a9)(),i=t.currentTarget;if(a.classBreakInfos[e].label=i.value,""===i.value){const t=a.classBreakInfos[e];t.label=`${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`,this.inputNodes[e].value=this.labelNodes[e].textContent}(0,n.a8)(),(0,s.f)(this.hostElement)}handleInversionStatus(e){const{modules:t}=n.s;if(JSON.stringify(this.defaultColorRamp[0])!==JSON.stringify(e.classBreakInfos[0].symbol.color)){let a=e.classBreakInfos.map((e=>(0,n.Q)(e.symbol)||new t.esriColor({r:64,g:64,b:64,a:1})));a=a.reverse(),e.classBreakInfos.map(((e,t)=>{(0,n.Q)(e.symbol)&&(0,n.W)(e.symbol,a[t])}))}else this.defaultColorRamp=e.classBreakInfos.map((e=>e.symbol.color))}updateRasterClassBreaksRenderer(e){this.handleInversionStatus(e),(0,n.a8)(e),(0,s.f)(this.hostElement),(0,s.f)(this.sliderNode)}get hostElement(){return(0,s.d)(this)}};m.style=":host{width:100%}.flow-item{height:100%}.class-breaks-block{overflow-x:hidden;overflow-wrap:anywhere}.hidden{display:none}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.label,.symbol-container{padding-top:5px;padding-bottom:5px}.selected{outline:1px solid var(--calcite-color-brand)}";const p=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterColormapClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterColormapClose",7),this.arcgisSmartMappingPanelsRasterColormapBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterColormapBackClick",7),this.inputNodes=[],this.labelNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterColormapClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this;(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterColormapClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{modules:e}=n.s,t=(0,n.a9)();this.originalRendererObj=e.esriLang.clone((0,n.a9)()),t.colormapInfos.forEach(((e,a)=>{e.label||(t.colormapInfos[a].label=" ")})),(0,n.a8)()}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"b0a45e8d823640b4c37c185cdd550490600b6b9c",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"5f1820f687e96170e2052e21fa2a2f5e3befab51",heading:a.panels.colormap.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterColormapBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"colormap-block",heading:e.panels.colormap.colormap,open:!0},this.renderColormapTable())}renderColormapTable(){const{strings:e}=n.s,t=(0,n.a9)();this.labelNodes=[],this.inputNodes=[];const a=t.colormapInfos.map(((e,t)=>this.renderColormapRow(e,t)));return(0,s.h)("calcite-table",{class:"table",caption:e.panels.colormap.colormapTable},(0,s.h)("calcite-table-row",{slot:"table-header"},(0,s.h)("calcite-table-header",{heading:e.panels.colormap.color,alignment:"center"}),(0,s.h)("calcite-table-header",{heading:e.panels.colormap.value,alignment:"center"}),(0,s.h)("calcite-table-header",{heading:e.panels.colormap.label,alignment:"center"})),a)}renderColormapRow(e,t){return(0,s.h)("calcite-table-row",null,(0,s.h)("calcite-table-cell",{alignment:"center"},this.renderColorNode(e)),(0,s.h)("calcite-table-cell",{alignment:"center"},e.value),(0,s.h)("calcite-table-cell",{alignment:"center",class:"label-cell"},this.renderLabelNode(e,t)))}renderColorNode(e){return(0,s.h)("div",{class:"color",ref:t=>{t&&this.afterCreateColor(t,e)}})}renderLabelNode(e,t){const{strings:a}=n.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",tabindex:"0",ref:e=>{e&&(this.labelNodes[t]=e)},"aria-label":a.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){let a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,s.h)("calcite-input",{class:"hidden",ref:e=>{e&&(this.inputNodes[t]=e)},value:e.label,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if("Escape"===a.key||"Enter"===a.key){this.inputNodes[t].classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}afterCreateColor(e,t){var a;const{modules:s}=n.s;for(;null===(a=null==e?void 0:e.childNodes)||void 0===a?void 0:a.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:i}=s,l=i.renderColorRampPreviewHTML([t.color.clone()],{gradient:!1,width:20,height:20});l.classList.add("colorblock"),e.appendChild(l)}handleValueTextChange(e,t){const a=(0,n.a9)(),i=t.currentTarget;""===i.value?this.inputNodes[e].value=this.labelNodes[e].textContent:a.colormapInfos[e].label=i.value,(0,n.a8)(),(0,s.f)(this.hostElement)}get hostElement(){return(0,s.d)(this)}};p.style=":host{width:100%}.flow-item{height:100%}.colormap-block{overflow-x:hidden}.table{width:100%}.color{display:flex;justify-content:center}.colorblock{border:1px solid #000}.hidden{display:none}.label{padding-top:5px;padding-bottom:5px}.label:focus{outline:2px solid var(--calcite-color-brand)}.label-cell{overflow-wrap:anywhere}";const g=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterFlowClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowClose",7),this.arcgisSmartMappingPanelsRasterFlowBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowBackClick",7),this.arcgisSmartMappingPanelsRasterFlowError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowError",7),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterFlowClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t}=this,{layer:a}=n.s;a.effect=t,(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterFlowClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{layer:e}=n.s,t=e;this.originalRendererObj=(0,n.a9)(),this.originalEffect=t.effect}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"cfd77f606c081ded1b94819c618ddd6bd6d1659a",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"e81fd1295331ade717efcd4fb99b3a7c07e8173c",heading:a.panels.flow.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterFlowBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"flow-block",heading:e.panels.flow.flowStyle,open:!0},this.renderMode(),this.renderSpeed(),this.renderDensity(),this.renderLength(),this.renderWidth(),this.renderColor(),this.renderColorSlider(),this.renderDirection(),this.renderRoundCaps(),this.renderShowInLegend(),this.renderEffects())}renderMode(){const{strings:e}=n.s,t=(0,n.a9)(),a=t.authoringInfo,i=(null==a?void 0:a.flowTheme)?"wave-front"===(null==a?void 0:a.flowTheme):t.trailLength<1;return(0,s.h)("div",{class:"block-content-padding-large"},(0,s.h)("calcite-chip",{value:"flowline",appearance:i?"outline-fill":"solid",kind:i?"neutral":"brand",class:i?"mode-hover":"",scale:"s",onClick:()=>this.handleModeChange("flowline")},e.panels.flow.flowline),(0,s.h)("span",null,"\xa0"),(0,s.h)("calcite-chip",{value:"wavefront",appearance:i?"solid":"outline-fill",kind:i?"brand":"neutral",class:i?"":"mode-hover",scale:"s",onClick:()=>this.handleModeChange("wavefront")},e.panels.flow.wavefront))}renderSpeed(){const{strings:e}=n.s,t=(0,n.a9)(),a="wave-front"===t.authoringInfo.flowTheme,{flowSpeed:i}=t;return(0,s.h)("calcite-label",null,e.panels.flow.speed,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"speed",min:0,max:a?20:40,values:[i],precision:1,minLabel:e.panels.flow.slow,maxLabel:e.panels.flow.fast}))}renderDensity(){const{strings:e}=n.s,t=(0,n.a9)(),{density:a}=t;return(0,s.h)("calcite-label",null,e.panels.flow.density,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"density",min:.1,max:1,values:[a],precision:1,minLabel:e.panels.flow.low,maxLabel:e.panels.flow.high}))}renderLength(){const{strings:e}=n.s,t=(0,n.a9)(),a="wave-front"===t.authoringInfo.flowTheme,{trailLength:i}=t;return(0,s.h)("calcite-label",null,e.panels.flow.length,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"trail-length",min:a?.1:1,max:a?50:200,values:[i/.75],precision:a?1:0,minLabel:e.panels.flow.short,maxLabel:e.panels.flow.long}))}renderWidth(){const{strings:e}=n.s,t=(0,n.a9)(),a="wave-front"===t.authoringInfo.flowTheme,{trailWidth:i}=t,l=Math.round(i/.75*10)/10;return(0,s.h)("div",{class:"block-content-padding-large"},(0,s.h)("calcite-label",null,e.panels.flow.width),(0,s.h)("arcgis-smart-mapping-slider-input",{min:a?Math.min(5,Math.floor(l)):.1,max:a?Math.max(12,Math.ceil(l)):Math.max(5,Math.ceil(l)),values:[l],precision:1,suffixText:e.panels.flow.px,onArcgisSmartMappingSliderInputChange:e=>{const t=(0,n.a9)(),a=e.detail,{trailWidth:s}=t;a!==Math.round(s/.75*10)/10&&(t.trailWidth=.75*a,(0,n.a8)())}}))}renderColor(){const{strings:e}=n.s,t=(0,n.a9)(),a=(0,n.d)(t,"color");return(0,s.h)("calcite-radio-button-group",{class:"block-content-padding",name:"colorType",layout:"vertical",onCalciteRadioButtonGroupChange:e=>this.handleColorTypeChange(e.target.selectedItem.value)},(0,s.h)("div",null,(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{checked:!a,value:"singleColor",ref:e=>this.singleColorNode=e}),e.panels.flow.singleColor),!a&&this.renderSingleColor()),(0,s.h)("div",null,(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{checked:!!a,value:"colorRamp",ref:e=>this.colorRampNode=e}),e.panels.flow.colorRamp),a&&this.renderColorRamp()))}renderSingleColor(){const e=(0,n.a9)(),{color:t}=e,a=(0,n.ak)();return a.color=t,a.outline.color=t,(0,s.h)("div",{class:"symbol-button-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:a,hideLabel:!0,type:"raster-flow",rampType:"continuous",onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.a8)(),(0,s.f)(this.hostElement)}}))}renderColorRamp(){const e=(0,n.a9)(),t=(0,n.d)(e,"color");if(!t)return;const a=t.stops.map((e=>{const t=e.color.clone();return t.a=1,t}));return(0,s.h)("div",{class:"symbol-button-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{colors:a,hideLabel:!0,type:"raster-flow",rampType:"continuous",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.a8)(),(0,s.f)(this.hostElement),this.flowColorSliderNode&&(0,s.f)(this.flowColorSliderNode)}}))}renderColorSlider(){const e=(0,n.a9)();return(0,n.d)(e,"color")?(0,s.h)("arcgis-smart-mapping-flow-color-slider",{ref:e=>{e&&(this.flowColorSliderNode=e)},onArcgisSmartMappingFlowColorSliderChange:()=>{(0,s.f)(this.hostElement),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)},onArcgisSmartMappingFlowColorSliderError:e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e.detail)}):null}renderDirection(){const{strings:e}=n.s,t=(0,n.a9)(),{flowRepresentation:a}=t;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"block-content-padding"},e.panels.flow.flowDirection,(0,s.h)("calcite-segmented-control",{layout:"horizontal",appearance:"solid",onCalciteSegmentedControlChange:e=>this.handleDirectionChange(e.target.selectedItem.value)},(0,s.h)("calcite-segmented-control-item",{value:"to",checked:"flow-from"!==a},e.panels.flow.to),(0,s.h)("calcite-segmented-control-item",{value:"from",checked:"flow-from"===a},e.panels.flow.from)))}renderRoundCaps(){const{strings:e}=n.s,t=(0,n.a9)(),{trailWidth:a,authoringInfo:i}=t,l="flow-line"===i.flowTheme,r="round"===t.trailCap,o=Math.round(1e3*a)/1e3>3;return(0,s.h)("div",{class:"toggles block-content-padding"},(0,s.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},e.panels.flow.roundEndCaps,(0,s.h)("calcite-switch",{ref:e=>{e&&(this.roundCapToggleNode=e)},disabled:!o,scale:"s",checked:r,onCalciteSwitchChange:()=>this.handleRoundCapsToggle()})),l?(0,s.h)("div",{class:"hint-text "+(o?"":"disabled")},e.panels.flow.forWideLines):null)}renderShowInLegend(){const{strings:e}=n.s,t=(0,n.a9)(),a=(0,n.d)(t,"color");if(!a)return null;const i=a.legendOptions,l=!i||!1!==i.showLegend;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"toggle-text toggles block-content-padding"},e.panels.flow.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:l,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderEffects(){const{layer:e,strings:t}=n.s,a=e;return(0,s.h)("div",{class:"toggles block-content-padding"},(0,s.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.layerEffects,(0,s.h)("calcite-switch",{scale:"s",checked:!!a.effect,onCalciteSwitchChange:()=>this.handleEffectToggle()})),(0,s.h)("div",{class:"hint-text"},t.panels.flow.adjustEffects))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleModeChange(e){const t=(0,n.a9)().authoringInfo,a="wave-front"===t.flowTheme,l="wave-front"===t.flowTheme?"flow-line":"wave-front";(!a&&"wavefront"===e||a&&"flowline"===e)&&((0,n.m)(),(0,i.r)((0,h.a)({flowTheme:l}),this.flowItemNode).then((e=>{(0,n.a8)(e.renderer),this.roundCapToggleNode.checked=!1,(0,s.f)(this.hostElement)}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e))))}handleColorTypeChange(e){(0,n.m)();const t={includeColorVariable:"colorRamp"===e};"colorRamp"!==e?this.lastFlowTheme=(0,h.f)():this.lastFlowTheme&&(t.flowScheme=this.lastFlowTheme),(0,i.r)((0,h.a)(t),this.flowItemNode).then((e=>{(0,n.a8)(e.renderer),(0,s.f)(this.hostElement)}),(e=>{this.singleColorNode.checked?(this.singleColorNode.checked=!1,this.colorRampNode.checked=!0):(this.colorRampNode.checked=!1,this.singleColorNode.checked=!0),this.arcgisSmartMappingPanelsRasterFlowError.emit(e)}))}handleDirectionChange(e){(0,n.a9)().flowRepresentation="from"===e?"flow-from":"flow-to",(0,n.a8)()}handleRoundCapsToggle(){const e=(0,n.a9)();e.trailCap="round"===e.trailCap?"butt":"round",(0,n.a8)()}handleIncludeInLegendToggle(){const e=(0,n.a9)(),t=(0,n.d)(e,"color"),a=t.legendOptions;a&&!1===a.showLegend?a.title?a.showLegend=!0:t.legendOptions=void 0:(t.legendOptions=a||{},t.legendOptions.showLegend=!1),(0,n.a8)()}handleEffectToggle(){const{layer:e}=n.s,t=e,a=(0,n.a9)();if(t.effect)t.effect=void 0;else{const e=a.authoringInfo;(0,h.c)({flowTheme:e.flowTheme}).then((e=>{t.effect=e.layerEffect,(0,n.a8)()}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e)))}}get hostElement(){return(0,s.d)(this)}};var v;g.style=":host{width:100%}.flow-item{height:100%}.flow-block{overflow-x:hidden}.block-content-padding{padding-bottom:10px}.block-content-padding-large{padding-bottom:20px}.symbol-button-padding{padding-bottom:12px}.mode-hover{cursor:pointer}.toggles{padding-top:10px}.toggle-text{width:100%}.hint-text{font-size:smaller;margin-top:-8px}.hint-text.disabled{opacity:0.5}",function(e){e[e.ALL=-1]="ALL",e[e.RED=0]="RED",e[e.GREEN=1]="GREEN",e[e.BLUE=2]="BLUE"}(v||(v={}));const f=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterRgbClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbClose",7),this.arcgisSmartMappingPanelsRasterRgbBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbBackClick",7),this.arcgisSmartMappingPanelsRasterRgbError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbError",7),this.disconnected=!1,this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterRgbClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:a}=this,{layer:s}=n.s,i=s;i.effect=t,i.bandIds=a,(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterRgbClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){var e,t,a,s;const{layer:i,modules:l}=n.s,r=i,{statistics:o}=r.rasterInfo;r.bandIds||(r.bandIds=await(0,n.al)()),this.originalRendererObj=l.esriLang.clone((0,n.a9)()),this.originalEffect=r.effect,this.originalBandCombination=r.bandIds,this.originalStatistics=l.esriLang.clone(o),this.currentStatistics=[];for(let n=0;n<r.rasterInfo.bandCount;n++)if(r.bandIds.includes(n)){const s=r.bandIds.indexOf(n),i=l.esriLang.clone(null===(t=null===(e=this.originalRendererObj)||void 0===e?void 0:e.statistics)||void 0===t?void 0:t[s]);i?Array.isArray(i)?this.currentStatistics.push({min:i[0],max:i[1],avg:i[2],stddev:i[3]}):this.currentStatistics.push(i):(null===(a=this.originalStatistics)||void 0===a?void 0:a[n])?this.currentStatistics.push(l.esriLang.clone(this.originalStatistics[n])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1})}else(null===(s=this.originalStatistics)||void 0===s?void 0:s[n])?this.currentStatistics.push(l.esriLang.clone(this.originalStatistics[n])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1});this.rendererStatisticsSelection=r.bandIds[0],this.setGammaDisplay(),this.percentLabelFlip=(0,n.am)(this.hostElement)}componentDidLoad(){const e=(0,n.a9)(),{stretchType:t=n.ap.STRETCH_TYPE}=e||{},a=t===n.ao.PERCENT_CLIP,s=t===n.ao.NONE,{dynamicRangeAdjustment:i}=e;!i&&!(s||a)&&this.updateStatisticsDisplay(e.statistics[0]),requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.disconnected=!0,this.clearHandles()}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"055abbac514fd6021b334043d6f39c4b5f2ef668",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"5a65674f6b431020af83fb7ba10ea9095fd147cb",heading:a.panels.rgb.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterRgbBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"rgb-block",heading:e.panels.rgb.rgb,open:!0},this.renderRgbBandSelectors(),this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderGammaBlock(),this.renderIndividualGammaToggle(),this.renderRangeAdjustmentToggle(),this.renderStatistics())}renderRgbBandSelectors(){const{layer:e,strings:t}=n.s,a=e,{rasterInfo:i}=a,{bandInfos:l}=i,r=l.map((e=>e.name)),{red:o,green:c,blue:d}=t.panels.rgb,h=[o,c,d].map(((e,t)=>(0,s.h)("calcite-label",null,e,(0,s.h)("calcite-combobox",{overlayPositioning:"fixed",label:e,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:s=>{var i,l,o,c,d,h;const u=s.target,m=(0,n.a9)();a.bandIds[t]=r.indexOf(u.value);const p=a.bandIds[t],g=null===(i=this.currentStatistics)||void 0===i?void 0:i[a.bandIds[t]];(null===(l=m.statistics)||void 0===l?void 0:l.length)&&g&&(m.statistics[t]=Array.isArray(m.statistics[t])?[null!==(o=g.min)&&void 0!==o?o:0,null!==(c=g.max)&&void 0!==c?c:255,null!==(d=g.avg)&&void 0!==d?d:0,null!==(h=g.stddev)&&void 0!==h?h:1]:Object.assign({},g)),this.statisticsControlNode&&e!==this.statisticsControlNode.value||(this.rendererStatisticsSelection=p,this.updateStatisticsDisplay(Object.assign({},g))),(0,n.a8)()}},r.map(((e,a)=>this.renderBandOptions(e,a,t)))))));return(0,s.h)(s.F,null,h)}renderBandOptions(e,t,a){const{layer:i}=n.s,l=i.bandIds[a];return(0,s.h)("calcite-combobox-item",{textLabel:e,value:e,selected:l===t})}renderStretchTypeSelector(){const{layer:e}=n.s,t=e;return(0,s.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,n.m)(),onArcgisSmartMappingStretchTypeButtonChange:e=>{const a=e.target;(0,i.r)((0,n.an)({stretchType:e.detail}),this.flowItemNode).then((i=>{"none"===e.detail&&(i.renderer.dynamicRangeAdjustment=!1),this.rendererStatisticsSelection=t.bandIds[0],(0,n.a8)(i.renderer),(0,s.f)(this.hostElement),(0,s.f)(a)}),(e=>this.arcgisSmartMappingPanelsRasterRgbError.emit(e)))}})}renderStandardDeviationSection(){const{strings:e}=n.s,t=(0,n.a9)(),{stretchType:a=n.ap.STRETCH_TYPE}=t||{};if(!(a===n.ao.STANDARD_DEVIATION))return null;let{numberOfStandardDeviations:i}=t||{};return(0,n.O)(i)&&0!==i||(i=n.ap.STD_DEV),(0,s.h)("calcite-label",null,e.panels.rgb.stddev,(0,s.h)("calcite-input-number",{label:e.panels.rgb.stddev,scale:"s",min:1,max:100,step:.1,value:`${i}`,onCalciteInputNumberInput:e=>{clearTimeout(this.stddevHandle);const t=e.target,a=parseFloat(t.value);t.value&&a>=t.min&&a<=t.max?this.handlePercentOrStddevChange(t,"stddev"):this.stddevHandle=setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const e=(0,n.a9)(),{stretchType:t=n.ap.STRETCH_TYPE}=e||{};if(!(t===n.ao.PERCENT_CLIP))return null;let{minPercent:a,maxPercent:i}=e||{};return(!(0,n.O)(a)||a<=0||a>=100)&&(a=n.ap.MIN_PERCENT),(!(0,n.O)(i)||i<=0||i>=100)&&(i=n.ap.MAX_PERCENT),a=parseFloat(a.toFixed(1)),i=parseFloat(i.toFixed(1)),e.minPercent=a,e.maxPercent=i,(0,n.a8)(),(0,s.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",a),this.renderPercentClipSectionInput("max",i))}renderPercentClipSectionInput(e,t){const{percentLabelFlip:a}=this,{strings:i}=n.s;return(0,s.h)("div",{class:"percent-clip-section-input"},(0,s.h)("calcite-label",null,i.panels.rgb[e],(0,s.h)("calcite-input-number",{label:i.panels.rgb[e],scale:"s",min:.1,max:99.9,step:.1,prefixText:a?"%":void 0,suffixText:a?void 0:"%",value:`${t}`,onCalciteInputNumberInput:t=>{clearTimeout(this.percentClipHandle);const a=t.target,s=parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handlePercentOrStddevChange(a,e):this.percentClipHandle=setTimeout((()=>this.handlePercentOrStddevChange(a,e)),3e3)}})))}renderIndividualGammaToggle(){const{strings:e}=n.s;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"individual-gamma-label"},e.panels.rgb.individualGamma,(0,s.h)("calcite-switch",{scale:"s",checked:this.changeIndividualGamma,onCalciteSwitchChange:e=>this.handleGammaToggle(e)}))}renderGammaBlock(){const{strings:e}=n.s,t=(0,n.a9)(),{gamma:a=n.ap.GAMMA}=t||{},i=Array.isArray(t.gamma)?t.gamma[0]:t.gamma,l=a[v.RED]||i,r=a[v.GREEN]||i,o=a[v.BLUE]||i;return(0,s.h)("calcite-label",null,e.panels.rgb.gamma,this.changeIndividualGamma?(0,s.h)("div",{class:"individual-gamma-selection"},this.renderIndividualGamma(l,"red"),this.renderIndividualGamma(r,"green"),this.renderIndividualGamma(o,"blue")):(0,s.h)("arcgis-smart-mapping-gamma-slider",{gamma:Array.isArray(a)?a[0]:a,rendererType:"raster-rgb"}))}renderIndividualGamma(e,t){const{strings:a}=n.s;return(0,s.h)("div",{class:"individual-gamma-selection-value"},(0,s.h)("calcite-label",null,a.panels.rgb[t],(0,s.h)("calcite-input-number",{label:a.panels.rgb[t],numberButtonType:"none",scale:"s",value:`${e}`,min:.1,max:10,step:.1,onCalciteInputNumberInput:e=>{clearTimeout(this.individualGammaHandle);const a=e.target,s=parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handleIndividualGammaChange(a,t):this.individualGammaHandle=setTimeout((()=>this.handleIndividualGammaChange(a,t)),3e3)}})))}renderRangeAdjustmentToggle(){const{strings:e}=n.s,t=(0,n.a9)(),{dynamicRangeAdjustment:a}=t,{stretchType:i=n.ap.STRETCH_TYPE}=t||{};return i===n.ao.NONE?null:(0,s.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},e.panels.rgb.dynamicRangeAdjustment,(0,s.h)("calcite-switch",{scale:"s",checked:a,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,s.f)(this.hostElement)}}))}renderStatistics(){const{layer:e,strings:t}=n.s,a=e,i=(0,n.a9)(),{stretchType:l=n.ap.STRETCH_TYPE}=i||{},r=l===n.ao.PERCENT_CLIP,o=l===n.ao.NONE,{dynamicRangeAdjustment:c}=i;return!c&&!(o||r)?(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,t.panels.rgb.statistics,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const s=e.target.value,n=s===t.panels.rgb.red?a.bandIds[0]:s===t.panels.rgb.green?a.bandIds[1]:a.bandIds[2],i=this.currentStatistics[n];this.rendererStatisticsSelection=n,this.updateStatisticsDisplay(i)},ref:e=>this.statisticsControlNode=e},(0,s.h)("calcite-segmented-control-item",{value:t.panels.rgb.red,checked:this.rendererStatisticsSelection===a.bandIds[0]},t.panels.rgb.red),(0,s.h)("calcite-segmented-control-item",{value:t.panels.rgb.green,checked:this.rendererStatisticsSelection===a.bandIds[1]&&this.rendererStatisticsSelection!==a.bandIds[0]},t.panels.rgb.green),(0,s.h)("calcite-segmented-control-item",{value:t.panels.rgb.blue,checked:this.rendererStatisticsSelection===a.bandIds[2]&&this.rendererStatisticsSelection!==a.bandIds[0]&&this.rendererStatisticsSelection!==a.bandIds[1]},t.panels.rgb.blue))),this.renderStatisticsDisplay()):null}renderStatisticsDisplay(){var e,t,a,i,l,r,o,c,h,u,m,p,g,v;const{layer:f,strings:b}=n.s,S=f,C=(0,n.a9)(),{stretchType:y=n.ap.STRETCH_TYPE}=C||{},N=y===n.ao.PERCENT_CLIP,w=y===n.ao.STANDARD_DEVIATION,k=null!==S.rasterInfo.statistics,I=null!==(e=this.rendererStatisticsSelection)&&void 0!==e?e:0,R=(!k||N)&&!w,{min:T=(null!==(i=null===(a=null===(t=this.currentStatistics)||void 0===t?void 0:t[I])||void 0===a?void 0:a[0])&&void 0!==i?i:0),max:x=(null!==(o=null===(r=null===(l=this.currentStatistics)||void 0===l?void 0:l[I])||void 0===r?void 0:r[1])&&void 0!==o?o:255),avg:B=(null!==(u=null===(h=null===(c=this.currentStatistics)||void 0===c?void 0:c[I])||void 0===h?void 0:h[2])&&void 0!==u?u:0),stddev:F=(null!==(g=null===(p=null===(m=this.currentStatistics)||void 0===m?void 0:m[I])||void 0===p?void 0:p[3])&&void 0!==g?g:1)}=(null===(v=this.currentStatistics)||void 0===v?void 0:v[null!=I?I:0])||{};return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,b.panels.rgb.min,(0,s.h)("calcite-input-number",{label:b.panels.rgb.min,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.O)(T)?this.round(T):0}`,onCalciteInputNumberInput:(0,d.d)((()=>{var e,t,a,s;if(this.disconnected)return;clearTimeout(this.minStatisticHandle);const n=parseFloat(this.minNode.value),i=null!==(a=null===(t=null!==(e=S.bandIds)&&void 0!==e?e:[])||void 0===t?void 0:t.indexOf(this.rendererStatisticsSelection))&&void 0!==a?a:0;!isNaN(n)&&n<=(null!==(s=this.currentStatistics[i].max)&&void 0!==s?s:this.currentStatistics[i][1])?(this.minNode.value=`${n}`,this.handleStatisticsChange(n,i,"min")):this.minStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[i].min)&&void 0!==e?e:this.currentStatistics[i][0];this.minNode.value=`${this.round(t)}`}),3e3)}),300),ref:e=>{e&&(this.minNode=e)}})),(0,s.h)("calcite-label",null,b.panels.rgb.max,(0,s.h)("calcite-input-number",{label:b.panels.rgb.max,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.O)(x)?this.round(x):1}`,onCalciteInputNumberInput:(0,d.d)((()=>{var e,t,a,s;if(this.disconnected)return;clearTimeout(this.maxStatisticHandle);const n=parseFloat(this.maxNode.value),i=null!==(a=null===(t=null!==(e=S.bandIds)&&void 0!==e?e:[])||void 0===t?void 0:t.indexOf(this.rendererStatisticsSelection))&&void 0!==a?a:0;!isNaN(n)&&n>=(null!==(s=this.currentStatistics[i].min)&&void 0!==s?s:this.currentStatistics[i][0])?(this.maxNode.value=`${n}`,this.handleStatisticsChange(n,i,"max")):this.maxStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[i].max)&&void 0!==e?e:this.currentStatistics[i][1];this.maxNode.value=`${this.round(t)}`}),3e3)}),300),ref:e=>{e&&(this.maxNode=e)}})),(0,s.h)("calcite-label",null,b.panels.rgb.mean,(0,s.h)("calcite-input-number",{label:b.panels.rgb.mean,scale:"s",step:.1,disabled:R,numberButtonType:"none",value:`${(0,n.O)(B)?this.round(B):2}`,onCalciteInputNumberInput:(0,d.d)((()=>{var e,t,a;if(this.disconnected)return;clearTimeout(this.avgStatisticHandle);const s=parseFloat(this.avgNode.value),n=null!==(a=null===(t=null!==(e=S.bandIds)&&void 0!==e?e:[])||void 0===t?void 0:t.indexOf(this.rendererStatisticsSelection))&&void 0!==a?a:0;isNaN(s)?this.avgStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[n].avg)&&void 0!==e?e:this.currentStatistics[n][2];this.avgNode.value=`${this.round(t)}`}),3e3):(this.avgNode.value=`${s}`,this.handleStatisticsChange(s,n,"avg"))}),300),ref:e=>{e&&(this.avgNode=e)}})),(0,s.h)("calcite-label",null,b.panels.rgb.stddev,(0,s.h)("calcite-input-number",{label:b.panels.rgb.stddev,scale:"s",step:.1,disabled:R,numberButtonType:"none",value:`${(0,n.O)(F)?this.round(F):3}`,onCalciteInputNumberInput:(0,d.d)((()=>{var e,t,a;if(this.disconnected)return;clearTimeout(this.stddevStatisticHandle);const s=parseFloat(this.stddevNode.value),n=null!==(a=null===(t=null!==(e=S.bandIds)&&void 0!==e?e:[])||void 0===t?void 0:t.indexOf(this.rendererStatisticsSelection))&&void 0!==a?a:0;isNaN(s)?this.stddevStatisticHandle=setTimeout((()=>{var e;const t=null!==(e=this.currentStatistics[n].stddev)&&void 0!==e?e:this.currentStatistics[n][3];this.stddevNode.value=`${this.round(t)}`}),3e3):(this.stddevNode.value=`${s}`,this.handleStatisticsChange(s,n,"stddev"))}),300),ref:e=>{e&&(this.stddevNode=e)}})))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}setGammaDisplay(){const e=(0,n.a9)(),{gamma:t=n.ap.GAMMA}=e||{},a=Array.isArray(e.gamma)?e.gamma[0]:e.gamma,s=t[v.RED]||a,i=t[v.GREEN]||a,l=t[v.BLUE]||a;this.changeIndividualGamma=s!==i||s!==l||i!==l}handlePercentOrStddevChange(e,t){const a=(0,n.a9)();let s=parseFloat(e.value);isNaN(s)||s<e.min?s=e.min:s>e.max&&(s=e.max),s=parseFloat(s.toFixed(1)),e.value=`${s}`,"min"===t?a.minPercent=s:"max"===t?a.maxPercent=s:a.numberOfStandardDeviations=s,(0,n.a8)()}handleGammaToggle(e){const t=(0,n.a9)();this.changeIndividualGamma=!this.changeIndividualGamma;e.target.checked||(t.gamma=new Array(3).fill(t.gamma[0]),t.useGamma=!0),(0,n.a8)(),(0,s.f)(this.hostElement)}handleIndividualGammaChange(e,t){const a=(0,n.a9)();let s=parseFloat(e.value);isNaN(s)||s<e.min?s=e.min:s>e.max&&(s=e.max),s=parseFloat(s.toFixed(1)),e.value=`${s}`,"red"===t?a.gamma[v.RED]=s:"green"===t?a.gamma[v.GREEN]=s:a.gamma[v.BLUE]=s,a.useGamma=!0,(0,n.a8)()}handleDRAToggle(e){var t;const{layer:a}=n.s,s=a,i=(0,n.a9)();if(i.dynamicRangeAdjustment=e,e)i.statistics=[];else{const e=(null===(t=this.originalStatistics)||void 0===t?void 0:t.length)?s.bandIds.map((e=>{const{min:t,max:a,avg:s,stddev:n}=this.originalStatistics[e];return[t,a,s,n]})):[],a=s.bandIds.map((e=>{var t,a,s,n;const i=this.currentStatistics[e];return Array.isArray(i)?[...i]:[null!==(t=i.min)&&void 0!==t?t:0,null!==(a=i.max)&&void 0!==a?a:255,null!==(s=i.avg)&&void 0!==s?s:0,null!==(n=i.stddev)&&void 0!==n?n:1]}));i.statistics=JSON.stringify(a)===JSON.stringify(e)?[]:a}(0,n.a8)()}handleStatisticsChange(e,t,a){const{layer:s}=n.s,i=s,l=(0,n.a9)(),r=i.bandIds[t],o="min"===a?0:"max"===a?1:"avg"===a?2:3;(0,n.O)(this.currentStatistics[r][a])?this.currentStatistics[r][a]=e:this.currentStatistics[r][o]=e,l.statistics=i.bandIds.map((e=>{var t,a,s,n;const i=this.currentStatistics[e];return Array.isArray(i)?[...i]:[null!==(t=i.min)&&void 0!==t?t:0,null!==(a=i.max)&&void 0!==a?a:255,null!==(s=i.avg)&&void 0!==s?s:0,null!==(n=i.stddev)&&void 0!==n?n:1]})),(0,n.a8)()}updateStatisticsDisplay(e){var t,a,s,i;const{min:l=(null!==(t=e[0])&&void 0!==t?t:0),max:r=(null!==(a=e[1])&&void 0!==a?a:255),avg:o=(null!==(s=e[2])&&void 0!==s?s:0),stddev:c=(null!==(i=e[3])&&void 0!==i?i:1)}=e;this.minNode&&(this.minNode.value=`${(0,n.O)(l)?this.round(l):0}`,this.maxNode.value=`${(0,n.O)(r)?this.round(r):255}`,this.avgNode.value=`${(0,n.O)(o)?this.round(o):0}`,this.stddevNode.value=`${(0,n.O)(c)?this.round(c):1}`)}round(e){return Math.round(1e3*e)/1e3}clearHandles(){clearTimeout(this.stddevHandle),clearTimeout(this.percentClipHandle),clearTimeout(this.individualGammaHandle),clearTimeout(this.minStatisticHandle),clearTimeout(this.maxStatisticHandle),clearTimeout(this.avgStatisticHandle),clearTimeout(this.stddevStatisticHandle)}get hostElement(){return(0,s.d)(this)}};f.style=":host{width:100%}.flow-item{height:100%}.rgb-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.individual-gamma-label,.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}.individual-gamma-selection{display:flex;justify-content:space-between}.individual-gamma-selection-value{display:flex;flex-flow:column;justify-content:space-between;width:30%}";const b="traditional",S="multi-directional",C="none",y={azimuth:315,altitude:45,pixelSizePower:.664,pixelSizeFactor:.024,zFactor:1},N=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterShadedReliefClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefClose",7),this.arcgisSmartMappingPanelsRasterShadedReliefBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefBackClick",7),this.arcgisSmartMappingPanelsRasterShadedReliefError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefError",7),this.handles=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this;(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{modules:e}=n.s;this.originalRendererObj=e.esriLang.clone((0,n.a9)())}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.handles.forEach((e=>clearTimeout(e)))}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"2c5ea2734d89ad5a9099877444859a564c157042",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"cd23f1f8f136ce8bca58a40ea25f6721b3050e59",heading:a.panels.shadedRelief.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterShadedReliefBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"shaded-relief-block",heading:e.panels.shadedRelief.shadedRelief,open:!0},this.renderHillshadeTypeSelector(),this.renderColorScheme(),this.renderAzimuthSlider(),this.renderAltitudeSlider(),this.renderScalingSelector(),this.renderZFactorAndPixelInputs())}renderHillshadeTypeSelector(){return(0,s.h)("arcgis-smart-mapping-hillshade-type-button",{onArcgisSmartMappingHillshadeTypeButtonBeforeOpen:()=>(0,n.m)(),onArcgisSmartMappingHillshadeTypeButtonChange:e=>{const t=e.target,a=e.detail;(0,n.a9)().hillshadeType=a,(0,n.a8)(),(0,s.f)(this.hostElement),(0,s.f)(t)}})}renderColorScheme(){const{strings:e}=n.s,t=(0,n.a9)(),{colorRamp:a}=t||{},i=(0,n.aq)(a);return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:e.panels.shadedRelief.colorScheme,type:"raster-shaded-relief",rampType:"continuous",colors:i,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.a8)(),(0,s.f)(this.hostElement)}})}renderAzimuthSlider(){const{strings:e}=n.s,t=(0,n.a9)(),{hillshadeType:a=S,azimuth:i=y.azimuth}=t||{};return a===b?(0,s.h)("calcite-label",null,e.panels.shadedRelief.azimuth,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"azimuth",min:0,max:360,values:[i],precision:1,minLabel:"0",maxLabel:"360"})):null}renderAltitudeSlider(){const{strings:e}=n.s,t=(0,n.a9)(),{hillshadeType:a=S,altitude:i=y.altitude}=t||{};return a===b?(0,s.h)("calcite-label",null,e.panels.shadedRelief.altitude,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"altitude",min:0,max:90,values:[i],precision:1,minLabel:"0",maxLabel:"90"})):null}renderScalingSelector(){const{strings:e}=n.s,t=(0,n.a9)(),{scalingType:a=C}=t||{},i=e.panels.shadedRelief.scalingOptions;return(0,s.h)("calcite-label",null,e.panels.shadedRelief.scaling,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const t=e.target;this.handleScalingOptionChange(t.value)}},(0,s.h)("calcite-segmented-control-item",{value:"none",checked:"none"===a},i.none),(0,s.h)("calcite-segmented-control-item",{value:"adjusted",checked:"adjusted"===a},i.adjusted)))}renderZFactorAndPixelInputs(){const{strings:e}=n.s,t=(0,n.a9)(),{scalingType:a=C}=t||{},i=["zFactor"];return"adjusted"===a&&(i.push("pixelSizePower"),i.push("pixelSizeFactor")),(0,s.h)(s.F,null,i.map(((a,n)=>{var i;return(0,s.h)("calcite-label",null,e.panels.shadedRelief[a],(0,s.h)("calcite-input-number",{label:e.panels.shadedRelief[a],min:0,step:.1,scale:"s",value:`${null!==(i=t[a])&&void 0!==i?i:y[a]}`,onCalciteInputNumberInput:e=>{const t=e.target;""===t.value||parseFloat(t.value)<0?this.handles[n]=setTimeout((()=>this.handleZFactorOrPixelChange(t,a)),3e3):(clearTimeout(this.handles[n]),setTimeout((()=>this.handleZFactorOrPixelChange(t,a)),300))}}))})))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleScalingOptionChange(e){(0,n.a9)().scalingType=e,(0,n.a8)(),(0,s.f)(this.hostElement)}handleZFactorOrPixelChange(e,t){const a=(0,n.a9)();let s=parseFloat(e.value);(isNaN(s)||s<e.min)&&(s=e.min),e.value=`${s}`,a[t]=s,(0,n.a8)()}get hostElement(){return(0,s.d)(this)}};N.style=":host{width:100%}.flow-item{height:100%}.shaded-relief-block{overflow-x:hidden}";const w={min:0,max:255,avg:0,stddev:1},k=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterStretchClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchClose",7),this.arcgisSmartMappingPanelsRasterStretchBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchBackClick",7),this.arcgisSmartMappingPanelsRasterStretchError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchError",7),this.disconnected=!1,this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterStretchClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:a,originalStatistics:s}=this,{layer:i}=n.s,l=i;l.effect=t,l.bandIds=a,l.rasterInfo.statistics=s,(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterStretchClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){var e,t,a,s,i;const{layer:l,modules:r}=n.s,o=l,{statistics:c}=o.rasterInfo;this.originalRendererObj=r.esriLang.clone((0,n.a9)()),this.originalEffect=o.effect,this.originalBandCombination=o.bandIds,this.originalStatistics=r.esriLang.clone(c),1!==(null===(e=o.bandIds)||void 0===e?void 0:e.length)&&(o.bandIds=[0]),this.currentStatistics=[];for(let e=0;e<o.rasterInfo.bandCount;e++)if(e===o.bandIds[0]){const n=r.esriLang.clone(null===(a=null===(t=this.originalRendererObj)||void 0===t?void 0:t.statistics)||void 0===a?void 0:a[0]);n?Array.isArray(n)?this.currentStatistics.push({min:n[0],max:n[1],avg:n[2],stddev:n[3]}):this.currentStatistics.push(n):(null===(s=this.originalStatistics)||void 0===s?void 0:s[e])?this.currentStatistics.push(r.esriLang.clone(this.originalStatistics[e])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1})}else(null===(i=this.originalStatistics)||void 0===i?void 0:i[e])?this.currentStatistics.push(r.esriLang.clone(this.originalStatistics[e])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1})}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){this.disconnected=!0,this.clearHandles()}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"a288c91748149bad7d65eca3a57d3728c0c9baf4",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"a3233c3080a203b78df310655885a02a360b7ce2",heading:a.panels.stretch.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterStretchBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"stretch-block",heading:e.panels.stretch.stretch,open:!0},this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderBandSelector(),this.renderGammaSlider(),this.renderColorScheme(),this.renderRangeAdjustmentToggle(),this.renderStatisticsTable())}renderStretchTypeSelector(){const{layer:e}=n.s,t=e;return(0,s.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,n.m)(),onArcgisSmartMappingStretchTypeButtonChange:e=>{const a=e.target,l=e.detail;(0,i.r)((0,n.ar)({stretchType:l}),this.flowItemNode).then((e=>{var i;const r=null!==(i=t.bandIds[0])&&void 0!==i?i:n.at.BAND_INDEX;(0,n.O)(this.currentStatistics)&&(e.renderer.statistics=[this.currentStatistics[r]]),"none"===l&&(e.renderer.dynamicRangeAdjustment=!1,e.renderer.colorRamp=null),(0,n.a8)(e.renderer),(0,s.f)(this.hostElement),(0,s.f)(a)}),(e=>{(0,s.f)(a),this.arcgisSmartMappingPanelsRasterStretchError.emit(e)}))}})}renderStandardDeviationSection(){const{strings:e}=n.s,t=(0,n.a9)(),{stretchType:a=n.at.STRETCH_TYPE}=t||{};if(!(a===n.as.STANDARD_DEVIATION))return null;let{numberOfStandardDeviations:i}=t||{};return(0,n.O)(i)&&0!==i||(i=n.at.STD_DEV),(0,s.h)("calcite-label",null,e.panels.stretch.stddev,(0,s.h)("calcite-input-number",{label:e.panels.stretch.stddev,scale:"s",min:1,max:100,step:.1,value:`${i}`,onCalciteInputNumberInput:e=>{clearTimeout(this.stddevHandle);const t=e.target,a=parseFloat(t.value);t.value&&a>=t.min&&a<=t.max?this.handlePercentOrStddevChange(t,"stddev"):this.stddevHandle=setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const e=(0,n.a9)(),{stretchType:t=n.at.STRETCH_TYPE}=e||{};if(!(t===n.as.PERCENT_CLIP))return null;let{minPercent:a,maxPercent:i}=e||{};return(!(0,n.O)(a)||a<=0||a>=100)&&(a=n.at.MIN_PERCENT),(!(0,n.O)(i)||i<=0||i>=100)&&(i=n.at.MAX_PERCENT),a=parseFloat(a.toFixed(1)),i=parseFloat(i.toFixed(1)),e.minPercent=a,e.maxPercent=i,(0,n.a8)(),(0,s.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",a),this.renderPercentClipSectionInput("max",i))}renderPercentClipSectionInput(e,t){const{strings:a}=n.s;return(0,s.h)("div",{class:"percent-clip-section-input"},(0,s.h)("calcite-label",null,a.panels.stretch[e],(0,s.h)("calcite-input-number",{label:a.panels.stretch[e],scale:"s",min:.1,max:99.9,step:.1,suffixText:"%",value:`${t}`,onCalciteInputNumberInput:t=>{clearTimeout(this.percentClipHandle);const a=t.target,s=parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handlePercentOrStddevChange(a,e):this.percentClipHandle=setTimeout((()=>this.handlePercentOrStddevChange(a,e)),3e3)}})))}renderBandSelector(){const{layer:e,strings:t}=n.s,a=e,{bandCount:i}=a.rasterInfo;if(!(i>1))return null;const{bandInfos:l}=a.rasterInfo,r=l.map((e=>e.name));return(0,s.h)("calcite-label",null,t.panels.stretch.band,(0,s.h)("calcite-combobox",{overlayPositioning:"fixed",label:t.panels.stretch.band,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:e=>{var t,i,l,o,c,d;const h=e.target,u=(0,n.a9)();a.bandIds=[r.indexOf(h.value)];const m=null!==(t=a.bandIds[0])&&void 0!==t?t:n.at.BAND_INDEX;u.statistics=[null!==(i=this.currentStatistics[m])&&void 0!==i?i:w];const{min:p=(null!==(l=u.statistics[0][0])&&void 0!==l?l:0),max:g=(null!==(o=u.statistics[0][1])&&void 0!==o?o:255),avg:v=(null!==(c=u.statistics[0][2])&&void 0!==c?c:0),stddev:f=(null!==(d=u.statistics[0][3])&&void 0!==d?d:1)}=u.statistics[0],{stretchType:b=n.at.STRETCH_TYPE}=u||{},S=b===n.as.PERCENT_CLIP,C=b===n.as.NONE,{dynamicRangeAdjustment:y}=u;!y&&!(C||S)&&(this.minNode.value=`${(0,n.O)(p)?this.round(p):0}`,this.maxNode.value=`${(0,n.O)(g)?this.round(g):255}`,this.avgNode.value=`${(0,n.O)(v)?this.round(v):0}`,this.stddevNode.value=`${(0,n.O)(f)?this.round(f):1}`),(0,n.a8)(),(0,s.f)(this.hostElement)}},r.map(((e,t)=>this.renderBandOptions(e,t)))))}renderBandOptions(e,t){var a;const{layer:i}=n.s,l=null!==(a=i.bandIds[0])&&void 0!==a?a:n.at.BAND_INDEX;return(0,s.h)("calcite-combobox-item",{textLabel:e,value:e,selected:l===t})}renderGammaSlider(){var e;const{strings:t}=n.s,a=(0,n.a9)();let{gamma:i=n.at.GAMMA}=a||{};(0,n.O)(i)||(i=n.at.GAMMA),Array.isArray(i)&&(i=null!==(e=i[0])&&void 0!==e?e:n.at.GAMMA);const{stretchType:l=n.at.STRETCH_TYPE}=a||{};return l===n.as.NONE?null:(0,s.h)("calcite-label",null,t.panels.stretch.gamma,(0,s.h)("arcgis-smart-mapping-gamma-slider",{gamma:i,rendererType:"raster-stretch"}))}renderColorScheme(){const{strings:e}=n.s,t=(0,n.a9)(),{stretchType:a=n.at.STRETCH_TYPE}=t||{};if(a===n.as.NONE)return null;const{colorRamp:i}=t||{},l=(0,n.aq)(i);return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:e.panels.stretch.colorScheme,type:"raster-stretch",rampType:"continuous",colors:l,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.a8)(),(0,s.f)(this.hostElement)}})}renderRangeAdjustmentToggle(){const{strings:e}=n.s,t=(0,n.a9)(),{dynamicRangeAdjustment:a}=t,{stretchType:i=n.at.STRETCH_TYPE}=t||{};return i===n.as.NONE?null:(0,s.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},e.panels.stretch.dynamicRangeAdjustment,(0,s.h)("calcite-switch",{scale:"s",checked:a,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,s.f)(this.hostElement)}}))}renderStatisticsTable(){var e,t,a,i,l,r,o,c,h;const{originalStatistics:u}=this,{layer:m,modules:p,strings:g}=n.s,v=m,f=(0,n.a9)(),{stretchType:b=n.at.STRETCH_TYPE}=f||{},S=b===n.as.PERCENT_CLIP,C=b===n.as.NONE,y=b===n.as.STANDARD_DEVIATION,{dynamicRangeAdjustment:N}=f;if(!(!N&&!(C||S)))return null;const w=null!==v.rasterInfo.statistics;let{statistics:k}=f||{};(!k||Array.isArray(k)&&k.length<1)&&(k=p.esriLang.clone(u));const I=null!==(e=v.bandIds[0])&&void 0!==e?e:n.at.BAND_INDEX,R=(!w||S)&&!y,{min:T=(null!==(a=null===(t=null==k?void 0:k[0])||void 0===t?void 0:t[0])&&void 0!==a?a:0),max:x=(null!==(l=null===(i=null==k?void 0:k[0])||void 0===i?void 0:i[1])&&void 0!==l?l:255),avg:B=(null!==(o=null===(r=null==k?void 0:k[0])||void 0===r?void 0:r[2])&&void 0!==o?o:0),stddev:F=(null!==(h=null===(c=null==k?void 0:k[0])||void 0===c?void 0:c[3])&&void 0!==h?h:1)}=(null==k?void 0:k[0])||{};return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,g.panels.stretch.statistics),(0,s.h)("calcite-label",null,g.panels.stretch.min,(0,s.h)("calcite-input-number",{label:g.panels.stretch.min,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.O)(T)?this.round(T):0}`,onCalciteInputNumberInput:(0,d.d)((()=>{var e;if(this.disconnected)return;clearTimeout(this.minStatisticHandle);const t=parseFloat(this.minNode.value);!isNaN(t)&&t<=(null!==(e=this.currentStatistics[I].max)&&void 0!==e?e:this.currentStatistics[I][1])?(this.minNode.value=`${t}`,this.handleStatisticsChange(t,I,"min")):this.minStatisticHandle=setTimeout((()=>{var e;const t=this.round(null!==(e=this.currentStatistics[I].min)&&void 0!==e?e:this.currentStatistics[I][0]);this.minNode.value=`${t}`}),3e3)}),300),ref:e=>this.minNode=e})),(0,s.h)("calcite-label",null,g.panels.stretch.max,(0,s.h)("calcite-input-number",{label:g.panels.stretch.max,scale:"s",step:.1,numberButtonType:"none",value:`${(0,n.O)(x)?this.round(x):255}`,onCalciteInputNumberInput:(0,d.d)((()=>{var e;if(this.disconnected)return;clearTimeout(this.maxStatisticHandle);const t=parseFloat(this.maxNode.value);!isNaN(t)&&t>=(null!==(e=this.currentStatistics[I].min)&&void 0!==e?e:this.currentStatistics[I][0])?(this.maxNode.value=`${t}`,this.handleStatisticsChange(t,I,"max")):this.maxStatisticHandle=setTimeout((()=>{var e;const t=this.round(null!==(e=this.currentStatistics[I].max)&&void 0!==e?e:this.currentStatistics[I][1]);this.maxNode.value=`${t}`}),3e3)}),300),ref:e=>this.maxNode=e})),(0,s.h)("calcite-label",null,g.panels.stretch.mean,(0,s.h)("calcite-input-number",{label:g.panels.stretch.mean,scale:"s",step:.1,disabled:R,numberButtonType:"none",value:`${(0,n.O)(B)?this.round(B):0}`,onCalciteInputNumberInput:(0,d.d)((()=>{if(this.disconnected)return;clearTimeout(this.avgStatisticHandle);const e=parseFloat(this.avgNode.value);isNaN(e)?this.avgStatisticHandle=setTimeout((()=>{var e;const t=this.round(null!==(e=this.currentStatistics[I].avg)&&void 0!==e?e:this.currentStatistics[I][2]);this.avgNode.value=`${t}`}),3e3):(this.avgNode.value=`${e}`,this.handleStatisticsChange(e,I,"avg"))}),300),ref:e=>this.avgNode=e})),(0,s.h)("calcite-label",null,g.panels.stretch.stddev,(0,s.h)("calcite-input-number",{label:g.panels.stretch.stddev,scale:"s",step:.1,disabled:R,numberButtonType:"none",value:`${(0,n.O)(F)?this.round(F):1}`,onCalciteInputNumberInput:(0,d.d)((()=>{if(this.disconnected)return;clearTimeout(this.stddevStatisticHandle);const e=parseFloat(this.stddevNode.value);isNaN(e)?this.stddevStatisticHandle=setTimeout((()=>{var e;const t=this.round(null!==(e=this.currentStatistics[I].stddev)&&void 0!==e?e:this.currentStatistics[I][3]);this.stddevNode.value=`${t}`}),3e3):(this.stddevNode.value=`${e}`,this.handleStatisticsChange(e,I,"stddev"))}),300),ref:e=>this.stddevNode=e})))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handlePercentOrStddevChange(e,t){const a=(0,n.a9)();let s=parseFloat(e.value);isNaN(s)||s<e.min?s=e.min:s>e.max&&(s=e.max),s=parseFloat(s.toFixed(1)),e.value=`${s}`,"min"===t?a.minPercent=s:"max"===t?a.maxPercent=s:a.numberOfStandardDeviations=s,(0,n.a8)()}handleDRAToggle(e){var t;const{layer:a}=n.s,s=a,i=(0,n.a9)(),l=null!==(t=s.bandIds[0])&&void 0!==t?t:n.at.BAND_INDEX;i.dynamicRangeAdjustment=e,i.statistics=e?[]:[this.currentStatistics[l]],(0,n.a8)()}handleStatisticsChange(e,t,a){const s=(0,n.a9)(),i="min"===a?0:"max"===a?1:"avg"===a?2:3;(0,n.O)(this.currentStatistics[t][a])?this.currentStatistics[t][a]=e:this.currentStatistics[t][i]=e,s.statistics=[this.currentStatistics[t]],(0,n.a8)()}round(e){return Math.round(1e3*e)/1e3}clearHandles(){clearTimeout(this.stddevHandle),clearTimeout(this.percentClipHandle),clearTimeout(this.minStatisticHandle),clearTimeout(this.maxStatisticHandle),clearTimeout(this.avgStatisticHandle),clearTimeout(this.stddevStatisticHandle)}get hostElement(){return(0,s.d)(this)}};k.style=":host{width:100%}.flow-item{height:100%}.stretch-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}";const I=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterUniqueValueClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueClose",7),this.arcgisSmartMappingPanelsRasterUniqueValueBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueBackClick",7),this.arcgisSmartMappingPanelsRasterUniqueValueError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueError",7),this.inputNodes=[],this.labelNodes=[],this.colorNodes=[],this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this;(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){const{modules:e,strings:t}=n.s,a=(0,n.a9)(),s=(0,n.g)();n.s.lastDefault={defaultSymbol:a.defaultSymbol||(0,n.q)(s),defaultLabel:a.defaultLabel||t.panels.uniqueValue.other},this.originalRendererObj=e.esriLang.clone((0,n.a9)())}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()}))}disconnectedCallback(){(0,n.au)()}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"8d9e80d7c77b1a43e68fd183254f40062f1eafa6",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"b75c4d48cdda3b4d93d5ffd7234831733c1e3ce4",heading:a.panels.uniqueValue.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterUniqueValueBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"unique-value-block",heading:e.panels.uniqueValue.uniqueValue,open:!0},this.renderFieldSelector(),this.renderColorScheme(),this.renderValues())}renderFieldSelector(){var e;const{strings:t}=n.s,a=(0,n.a9)().field||t.panels.uniqueValue.value,i=(0,n.av)(),l=i.map((e=>({label:e.alias,layerField:e,simpleFieldType:n.w.STRING}))),r=i.find((e=>e.name===a));return(0,s.h)("arcgis-smart-mapping-attribute-input",{label:t.panels.uniqueValue.field,fieldList:l,selectedField:{field:null!==(e=null==r?void 0:r.name)&&void 0!==e?e:t.panels.uniqueValue.value,simpleFieldType:n.w.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderColorScheme(){var e;const{mapView:t,modules:a,strings:i}=n.s,l=(0,n.a9)(),r=l.uniqueValueInfos;if(!r.length)return null;const o=a.typeSchemes.getSchemes({basemap:t.map.basemap,geometryType:"polygon"}),c=(0,n.ad)(o,Math.min(r.length,10))[0].colors,d=[];return(null===(e=l.authoringInfo)||void 0===e?void 0:e.colorRamp)?d.push(...(0,n.aq)(l.authoringInfo.colorRamp)):d.push(...(null==r?void 0:r.length)?r.map(((e,t)=>(0,n.Q)(e.symbol)||new a.esriColor(c[t%c.length]))):[]),(0,s.h)("arcgis-smart-mapping-symbol-button",{label:i.panels.uniqueValue.colorScheme,type:"raster-unique-value",rampType:"continuous",colors:a.esriLang.clone(d).reverse(),onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,n.a8)(),(0,s.f)(this.hostElement),(0,s.f)(this.symbolButtonNode)},ref:e=>this.symbolButtonNode=e})}renderValues(){const e=(0,n.a9)();return this.labelNodes=[],this.inputNodes=[],(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,e.field),(0,s.h)("calcite-list",{group:"unique-value-items",class:"gray-border",dragEnabled:!0,onCalciteListOrderChange:t=>{if(t.detail.toEl){const a=t.detail.dragEl;if("other-values-list"===t.detail.toEl.id){const t=e.uniqueValueInfos.filter(((e,t)=>t!==parseInt(a.label)));e.uniqueValueInfos=t}}const a=Array.from(t.target.children);this.handleSortValues(a)}},e.uniqueValueInfos.map(((e,t)=>this.renderValue(e,t)))),this.renderDefaultValue(),(0,s.h)("calcite-list",{id:"other-values-list",dragEnabled:!0,group:"unique-value-items"}))}renderValue(e,t){return(0,s.h)("calcite-list-item",{key:`values-${e.value}`,value:`${e.value}`,label:`${t}`},(0,s.h)("div",{slot:"actions-start"},this.renderColorNode(e,t)),this.renderTextNode(e,t))}renderColorNode(e,t){const{strings:a}=n.s;let i=e.symbol.clone();const l={"symbol-is-white":(0,n.ai)(i),symbol:!0};return-1!==t&&this.colorNodes.length&&(this.colorNodes=[]),(0,s.h)("div",{class:l,tabindex:"0","aria-label":a.panels.uniqueValue.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&(-1===t?this.defaultColorNode=e:this.colorNodes.push(e))},onClick:()=>{if(this.popoverNode){(-1===this.selectedPopoverIdx?this.defaultColorNode:this.colorNodes[this.selectedPopoverIdx]).classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.m)(),this.popoverNode=null,this.selectedPopoverIdx=null):(this.selectedPopoverIdx=t,this.handleColorClick(t))}else this.selectedPopoverIdx=t,this.handleColorClick(t)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleColorClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateColorNode(e,t)}}))}renderTextNode(e,t){const{strings:a}=n.s;return(0,s.h)(s.F,null,(0,s.h)("div",{class:(-1===t?"default-label":"")+" label",slot:"content",tabindex:"0",ref:e=>{e&&(-1===t?this.defaultLabelNode=e:this.labelNodes[t]=e)},"aria-label":a.panels.uniqueValue.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>this.handleLabelEdit(t,e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleLabelEdit(t,e)}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",ref:e=>{var a;e&&(-1===t?this.defaultInputNode=e:this.inputNodes[t]=e,null===(a=this.defaultInputNode)||void 0===a||a.classList.add("default-input-padding"))},value:e.label,onCalciteInputChange:e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],s=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),s.classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],s=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),s.classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if("Escape"===a.key||"Enter"===a.key){(-1===t?this.defaultInputNode:this.inputNodes[t]).classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a);const n=-1===t?this.defaultLabelNode:this.labelNodes[t];n.classList.remove("hidden"),s.disabled=!1,setTimeout((()=>n.focus()),300)}}}))}renderDefaultValue(){const{strings:e}=n.s,t=(0,n.a9)(),a=(0,n.g)(),i={symbol:t.defaultSymbol||(0,n.q)(a),label:t.defaultLabel||e.panels.uniqueValue.other};return(0,s.h)("calcite-list",{class:"default-list-padding"},(0,s.h)("calcite-list-item",null,(0,s.h)("calcite-checkbox",{class:"checkbox",slot:"actions-start",tabIndex:0,checked:!!t.defaultSymbol,onClick:e=>this.handleCheckboxClick(e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleCheckboxClick(e))},onMouseOver:()=>(0,n.aw)(this.checkboxNode,e.panels.uniqueValue.otherTooltip),onMouseOut:()=>(0,n.au)(),onFocus:()=>(0,n.aw)(this.checkboxNode,e.panels.uniqueValue.otherTooltip),onFocusout:()=>(0,n.au)(),ref:e=>{e&&(this.checkboxNode=e)}}),(0,s.h)("div",{slot:"content-start",class:"symbol-container"},this.renderColorNode(i,-1)),this.renderTextNode(i,-1)))}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){var t;const a=(0,n.a9)();if(!a.uniqueValueInfos.length)return null;const l={field:e};!(0,n.a2)()&&(null===(t=a.authoringInfo)||void 0===t?void 0:t.colorRamp)&&(l.colorRamp=a.authoringInfo.colorRamp),(0,i.r)((0,n.ax)(l),this.flowItemNode).then((e=>{(0,n.a8)(e.renderer),(0,s.f)(this.hostElement)}),(e=>{this.fieldNode.value=a.field,this.arcgisSmartMappingPanelsRasterUniqueValueError.emit(e)}))}handleSortValues(e){const{modules:t,strings:a}=n.s,i=(0,n.g)(),l=(0,n.a9)();(0,n.m)();const r=e.map((e=>e.value)),o=l.uniqueValueInfos.map((e=>t.esriLang.clone(e)));o.sort(((e,t)=>r.indexOf(`${e.value}`)-r.indexOf(`${t.value}`))),o.length?l.uniqueValueInfos=o:(l.defaultSymbol=(0,n.q)(i),l.defaultLabel=a.panels.uniqueValue.other),(0,n.a8)(),(0,s.f)(this.hostElement)}afterCreateColorNode(e,t){var a;const{modules:s}=n.s,i=(0,n.a9)(),l=(0,n.g)(),r=-1===t?i.defaultSymbol||(0,n.q)(l):i.uniqueValueInfos[t].symbol.clone();for(-1===t&&r.outline&&(r.outline.width=0),(0,n.ai)(r)&&(r.outline=new s.SimpleLineSymbol({color:"#bdc3c7",width:.75}));null===(a=null==e?void 0:e.childNodes)||void 0===a?void 0:a.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:o}=s;r&&o.renderPreviewHTML(r,{size:(0,n.aj)(r),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>null==e?void 0:e.appendChild(t)))}handleColorClick(e){(0,n.m)();const{strings:t}=n.s,a=(0,r.c)({referenceElement:this.flowItemNode,heading:t.panels.uniqueValue.colorScheme});a.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>this.handleRemoveColorFocus(a,e,!1))),a.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>this.handleRemoveColorFocus(a,e,!0))),n.s.selectedValue=e,(0,l.a)({popoverNode:a,onChange:()=>{const a=(0,n.a9)();-1!==e||a.defaultLabel||(a.defaultLabel=t.panels.uniqueValue.other),(0,n.a8)(),(0,s.f)(this.hostElement),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)}}),this.popoverNode=a,-1===e?this.defaultColorNode.classList.add("selected"):this.colorNodes[e].classList.add("selected")}handleRemoveColorFocus(e,t,a){(0,r.r)(e),setTimeout((()=>{const e=-1===t?this.defaultColorNode:this.colorNodes[t];a||e.focus(),e.classList.remove("selected"),this.popoverNode=null}),300)}handleLabelEdit(e,t){const a=-1===e?this.defaultInputNode:this.inputNodes[e];a.classList.remove("hidden"),a.setFocus(),t.target.classList.add("hidden")}handleValueTextChange(e,t){const{strings:a}=n.s,i=(0,n.a9)();if(-1===e&&!i.defaultLabel)return this.defaultInputNode.value=a.panels.uniqueValue.other,this.defaultLabelNode.textContent=a.panels.uniqueValue.other,(0,n.a8)(),void(0,s.f)(this.hostElement);const l=t.target;-1===e?i.defaultLabel=l.value:i.uniqueValueInfos[e].label=l.value,""===l.value?-1===e?(i.defaultLabel=a.panels.uniqueValue.other,this.defaultInputNode.value=a.panels.uniqueValue.other,this.defaultLabelNode.textContent=a.panels.uniqueValue.other):(i.uniqueValueInfos[e].label=`${i.uniqueValueInfos[e].value}`,this.inputNodes[e].value=i.uniqueValueInfos[e].label):-1===e&&(this.defaultInputNode.value=i.defaultLabel,this.defaultLabelNode.textContent=i.defaultLabel),(0,n.a8)(),(0,s.f)(this.hostElement)}handleCheckboxClick(e){const{lastDefault:t,strings:a}=n.s,i=(0,n.a9)();(0,r.r)(this.popoverNode),this.popoverNode=null,(0,n.m)(),i.uniqueValueInfos.length?(i.defaultSymbol?(i.defaultSymbol=void 0,i.defaultLabel=void 0,this.defaultLabelNode.textContent=a.panels.uniqueValue.other,this.defaultInputNode.value=a.panels.uniqueValue.other):(i.defaultSymbol=t.defaultSymbol,i.defaultLabel=this.defaultLabelNode.textContent),(0,n.a8)(),(0,s.f)(this.hostElement)):e.target.checked=!0}get hostElement(){return(0,s.d)(this)}};I.style=":host{width:100%}.flow-item{height:100%}.unique-value-block{overflow-x:hidden;overflow-wrap:anywhere}.label{padding:5px auto}.symbol{width:19px;height:19px}.symbol:focus,.label:focus{outline:2px solid var(--calcite-color-brand)}.symbol-container{cursor:pointer}.selected{outline:1px solid var(--calcite-color-brand)}.hidden{display:none}.gray-border{border-top:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0}.checkbox{margin:0px 5.5px}.default-list-padding{padding-top:8px}";const R=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterVectorFieldClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldClose",7),this.arcgisSmartMappingPanelsRasterVectorFieldBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldBackClick",7),this.arcgisSmartMappingPanelsRasterVectorFieldError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldError",7),this.documentClickHandler=void 0,this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e}=this;(0,n.a8)(e),this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("cancel")},this.menuOpen=void 0,this.showBackButton=void 0,this.beforeBack=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}componentWillLoad(){this.originalRendererObj=(0,n.a9)(),this.speedUnitOptions=this.getSpeedUnitOptions()}componentDidLoad(){requestAnimationFrame((()=>{var e;return null===(e=this.flowItemNode)||void 0===e?void 0:e.setFocus()})),this.currentInput=this.inputUnitNode.value,this.currentOutput=this.outputUnitNode.value}render(){const{hideLayerTitle:e,layer:t,strings:a,isRTL:i}=n.s,l=t.title;return(0,s.h)(s.H,{key:"a59888875f57a0eae8cad129c46d07d75be7a259",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"3bbefa98f5058e664a63be92e353cc8cdca31515",heading:a.panels.vectorField.styleOptions,description:e?void 0:l,class:{"flow-item":!0,[c.C.rtl]:i},closable:(0,n.F)(this.hostElement),menuOpen:this.menuOpen,beforeBack:this.beforeBack,showBackButton:this.showBackButton,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterVectorFieldBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=n.s;return(0,s.h)("calcite-block",{class:"vector-field-block",heading:e.panels.vectorField.vectorField,open:!0},this.renderSymbolStyleSelector(),this.renderSymbolDensitySlider(),this.renderSymbolScalingSlider(),this.renderInvertSymbols(),this.renderMagnitudeRange(),this.renderUnitSelectors())}renderSymbolStyleSelector(){return(0,s.h)("arcgis-smart-mapping-vector-symbol-button",{ref:e=>this.selectNode=e,onArcgisSmartMappingSelectBeforeOpen:()=>{var e;null===(e=this.popoverNode)||void 0===e||e.parentElement.removeChild(this.popoverNode),this.popoverNode=null,this.popoverOpen=!1},onArcgisSmartMappingSelectChange:e=>{const t=(0,n.a9)();let a=e.detail;a.includes("beaufort")&&(a=this.getExactBeaufortUnit(t.outputUnit)),this.resetOutputUnit(a,t),(0,i.r)((0,o.d)({style:a}),this.flowItemNode).then((e=>{(0,n.a8)(e.renderer),(0,s.f)(this.hostElement),this.selectNode&&(0,s.f)(this.selectNode)}),(e=>{(0,s.f)(this.selectNode),this.arcgisSmartMappingPanelsRasterVectorFieldError.emit(e)}))}})}renderSymbolDensitySlider(){const{strings:e}=n.s,t=(0,n.a9)(),{symbolTileSize:a}=t||{},i=100/a;return(0,s.h)("calcite-label",null,e.panels.vectorField.symbolDensity,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"vector-field",type:"density",min:1,max:5,values:[Math.round(10*i)/10],precision:1,minLabel:e.panels.flow.low,maxLabel:e.panels.flow.high}))}renderSymbolScalingSlider(){const{strings:e}=n.s,t=(0,n.a9)(),a=(0,n.d)(t,"size"),{minSize:i,maxSize:l}=a;return(0,s.h)("calcite-label",null,e.panels.vectorField.symbolScaling,(0,s.h)("calcite-slider",{min:0,minValue:null!==i?i:20,max:100,maxValue:null!==l?l:80,step:1,labelHandles:!0,labelTicks:!0,precise:!0,snap:!0,onCalciteSliderInput:(0,d.d)((()=>{const e=this.symbolScalingSliderNode.minValue,t=this.symbolScalingSliderNode.maxValue;this.handleSymbolScaleChange(e,t)}),300),ref:e=>this.symbolScalingSliderNode=e}))}renderInvertSymbols(){const{isRTL:e,strings:t}=n.s;let a="flow-from"!==(0,n.a9)().flowRepresentation;return(0,s.h)("div",{class:"invert-symbol-wrapper"},(0,s.h)("calcite-label",{layout:"inline-space-between"},(0,s.h)("section",null,t.panels.vectorField.invertSymbols,(0,s.h)("calcite-button",{class:{"invert-symbol-margin":!0,[c.C.rtl]:e},"icon-start":"information",scale:"s",appearance:"transparent",kind:"neutral",onClick:()=>{this.popoverOpen?(this.removePopover(),this.buttonNode.setFocus()):this.togglePopover()},ref:e=>this.buttonNode=e}))),(0,s.h)("calcite-switch",{class:"invert-symbol-switch",scale:"s",label:t.panels.vectorField.invertSymbols,checked:a,onCalciteSwitchChange:e=>this.handleInvertSymbolsChange(e.currentTarget.checked?"flow-to":"flow-from")}))}renderMagnitudeRange(){const{strings:e}=n.s,t=(0,n.a9)(),a=(0,n.d)(t,"size"),{minDataValue:i,maxDataValue:l}=a,r=(0,d.i)(i)?Math.round(10*i)/10:void 0,o=(0,d.i)(l)?Math.round(10*l)/10:void 0;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,e.panels.vectorField.magnitudeRange),(0,s.h)("calcite-label",null,e.panels.vectorField.min,(0,s.h)("calcite-input-number",{label:e.panels.vectorField.min,scale:"s",min:r,max:o,value:`${null!=r?r:""}`,numberButtonType:"none",onCalciteInputNumberInput:()=>{const e=parseFloat(this.minRangeNode.value),t=isNaN(parseFloat(this.minRangeNode.value))?-1/0:parseFloat(this.minRangeNode.value),a=isNaN(parseFloat(this.maxRangeNode.value))?1/0:parseFloat(this.maxRangeNode.value);!isNaN(e)&&e>=t&&e<=a?(this.minRangeNode.value=`${e}`,this.handleMagnitudeRangeValuesChange(e,parseFloat(this.maxRangeNode.value))):(this.minRangeNode.value="",this.handleMagnitudeRangeValuesChange(void 0,parseFloat(this.maxRangeNode.value)))},ref:e=>this.minRangeNode=e})),(0,s.h)("calcite-label",null,e.panels.vectorField.max,(0,s.h)("calcite-input-number",{label:e.panels.vectorField.max,scale:"s",min:r,max:o,value:`${null!=o?o:""}`,numberButtonType:"none",onCalciteInputNumberInput:()=>{const e=parseFloat(this.maxRangeNode.value),t=isNaN(parseFloat(this.minRangeNode.value))?-1/0:parseFloat(this.minRangeNode.value),a=isNaN(parseFloat(this.maxRangeNode.value))?1/0:parseFloat(this.maxRangeNode.value);!isNaN(e)&&e>=t&&e<=a?(this.maxRangeNode.value=`${e}`,this.handleMagnitudeRangeValuesChange(parseFloat(this.minRangeNode.value),e)):(this.maxRangeNode.value="",this.handleMagnitudeRangeValuesChange(parseFloat(this.minRangeNode.value),void 0))},ref:e=>this.maxRangeNode=e})))}renderUnitSelectors(){const{strings:e}=n.s;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,e.panels.vectorField.convertMagnitude),(0,s.h)("calcite-label",null,e.panels.vectorField.inputUnits,this.renderUnitSelector("input")),(0,s.h)("calcite-label",null,e.panels.vectorField.outputUnits,this.renderUnitSelector("output")))}renderUnitSelector(e){const{strings:t}=n.s,a=(0,n.a9)(),i="output"===e&&["wind-barb","ocean-current-kn","ocean-current-m"].indexOf(a.style)>-1;return(0,s.h)("calcite-combobox",{disabled:i,key:"input"===e?a.inputUnit:a.outputUnit,label:"input"===e?t.panels.vectorField.inputUnits:t.panels.vectorField.outputUnits,clearDisabled:!0,scale:"s",selectionMode:"single",ref:t=>{t&&("output"===e?this.outputUnitNode=t:this.inputUnitNode=t)},onCalciteComboboxChange:()=>{"input"===e?(""===this.inputUnitNode.value?this.inputUnitNode.value=this.currentInput:this.currentInput=this.inputUnitNode.value,this.handleUnitSelectClick("input")):(""===this.outputUnitNode.value?this.outputUnitNode.value=this.currentOutput:this.currentOutput=this.outputUnitNode.value,this.handleUnitSelectClick("output"))}},this.speedUnitOptions.map((t=>this.renderUnitOption(e,t))))}renderUnitOption(e,t){const a=(0,n.a9)(),i=this.speedUnitOptions.find((t=>"input"===e?t.key===a.inputUnit:t.key===a.outputUnit));return(0,s.h)("calcite-combobox-item",{value:t.key,textLabel:t.title,selected:!!i&&t===i})}renderDoneButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=n.s;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}getExactBeaufortUnit(e){switch(e=null!=e?e:"meter-per-second"){case"knots":return"beaufort-kn";case"meter-per-second":return"beaufort-m";case"mile-per-hour":return"beaufort-mi";case"kilometer-per-hour":return"beaufort-km";case"feet-per-second":return"beaufort-ft"}}resetOutputUnit(e,t){let a;switch(e){case"ocean-current-kn":case"wind-barb":a="knots";break;case"ocean-current-m":a="meter-per-second"}a&&(t.outputUnit=a)}handleSymbolScaleChange(e,t){const a=(0,n.a9)(),s=(0,n.d)(a,"size");s.minSize=e,s.maxSize=t,(0,n.a8)()}handleInvertSymbolsChange(e){(0,n.a9)().flowRepresentation=e,(0,n.a8)()}handleUnitSelectClick(e){const t=(0,n.a9)();"input"===e?t.inputUnit=this.inputUnitNode.value:(t.outputUnit=this.outputUnitNode.value,t.style.includes("beaufort")&&(t.style=this.getExactBeaufortUnit(t.outputUnit))),(0,n.a8)()}handleMagnitudeRangeValuesChange(e,t){if("number"==typeof e&&isNaN(e)&&(e=""),"number"==typeof t&&isNaN(t)&&(t=""),e===this.minRangeNode.max&&t===this.maxRangeNode.min)return;const a=(0,n.a9)(),s=(0,n.d)(a,"size");""!==e&&(0,d.i)(e)?(e=Math.round(1e3*e)/1e3,s.minDataValue=e,this.minRangeNode.value=`${e}`,this.maxRangeNode.min=e+this.maxRangeNode.step):(s.minDataValue=null,this.minRangeNode.value=""),""!==t&&(0,d.i)(t)?(t=Math.round(1e3*t)/1e3,s.maxDataValue=t,this.maxRangeNode.value=`${t}`,this.minRangeNode.max=t-this.minRangeNode.step):(s.maxDataValue=null,this.maxRangeNode.value=""),(0,n.a8)()}togglePopover(){const{flowItemNode:e}=this,{strings:t}=n.s;this.popoverNode=document.createElement("arcgis-smart-mapping-info-popover"),this.popoverNode.props={title:t.panels.vectorField.invertSymbols,flowItemNode:e,moreInfo:t.panels.vectorField.invertSymbolsTip},this.popoverNode.referenceElement=this.buttonNode,this.popoverNode.addEventListener("arcgisSmartMappingInfoPopoverClose",(e=>{e.stopPropagation(),this.removePopover(),this.buttonNode.setFocus()})),document.body.appendChild(this.popoverNode),this.popoverNode.setOpen(!0),this.popoverOpen=!0,setTimeout((()=>{this.documentClickHandler=e=>{(0,u.i)(e.target)||this.removePopover()},document.addEventListener("click",this.documentClickHandler)}))}removePopover(){document.body.querySelectorAll(".arcgis-smart-mapping-popover").forEach((e=>document.body.removeChild(e))),this.popoverNode=null,this.popoverOpen=!1,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0)}getSpeedUnitOptions(){const{strings:e}=n.s,t=e.panels.vectorField.unitOptions;return[{key:"meter-per-second",title:t.esriMetersPerSecond,selected:!1},{key:"kilometer-per-hour",title:t.esriKilometersPerHour,selected:!1},{key:"knots",title:t.esriKnots,selected:!1},{key:"feet-per-second",title:t.esriFeetPerSecond,selected:!1},{key:"mile-per-hour",title:t.esriMilesPerHour,selected:!1}]}get hostElement(){return(0,s.d)(this)}};R.style=":host{width:100%}.flow-item{height:100%}.vector-field-block{overflow-x:hidden}.invert-symbol-wrapper{display:flex;justify-content:space-between}.invert-symbol-margin{margin-right:inherit;margin-left:0.35rem}.arcgis--rtl .invert-symbol-margin{margin-left:inherit;margin-right:0.35rem}.invert-symbol-switch{padding-top:6px}"},11246:(e,t,a)=>{a.d(t,{a:()=>c,b:()=>u,c:()=>n,d:()=>s,e:()=>i,f:()=>d,g:()=>m,i:()=>l,m:()=>r,t:()=>o,u:()=>h});const s=(e,t)=>{let a,s="idle";const n=(...n)=>new Promise((i=>{switch(s){case"flushed":s="idle",a?(clearTimeout(a),i(e(...n))):i(null);break;case"invoked":clearTimeout(a),s="idle",i(e(...n));break;case"cancelled":clearTimeout(a),s="idle",i(null);break;default:a&&clearTimeout(a),s="pending",a=setTimeout((()=>(s="idle",i(e(...n)))),t)}}));return n.flush=function(...e){return s="flushed",n(...e)},n.invoke=function(...e){return s="invoked",n(...e)},n.cancel=function(...e){return s="cancelled",n(...e)},n.getStatus=function(){return s},n},n=(e,t)=>{let a;return(...s)=>new Promise((n=>{a||(a=setTimeout((()=>{clearTimeout(a),a=void 0,n(e(...s))}),t))}))};function i(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(e){return null!=e}async function r(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:a,data:s}=t(e);return[a,s]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,a)=>e&&t.indexOf(a)>-1),!0);function h(e,t){const a=[],s={};return e.forEach((e=>{const n=t(e);null==s[n]&&(s[n]=e,a.push(e))})),a}function u(e){const t={boolean:{},number:{},string:{}},a=[];return e.filter((e=>{let s=typeof e;return s in t?!t[s].hasOwnProperty(e)&&(t[s][e]=!0):!(a.indexOf(e)>=0)&&a.push(e)}))}const m=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((a,s)=>e.slice(t*s,t+t*s)))},95875:(e,t,a)=>{let s,n;function i(e){e.loading=!1}function l(e,t){return function(e){e.loading=!0,n=!1,s&&clearTimeout(s),s=setTimeout((()=>{i(e),n=!0}),6e4)}(t),e.then((e=>(i(t),n?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(i(t),Promise.reject(e))))}a.d(t,{r:()=>l})},39062:(e,t,a)=>{function s(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===(null==e?void 0:e.tagName))return!0;{let t=null==e?void 0:e.parentElement;for(;t;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}a.d(t,{i:()=>s})},42648:(e,t,a)=>{a.d(t,{a:()=>i,b:()=>o,c:()=>r,d:()=>l,g:()=>c});a(77040),a(70506);var s=a(82646),n=a(32756);function i(){const{layer:e,modules:t}=s.s,a=e,n="imagery"===a.type?a.rasterFunction:void 0;return t.RasterVectorFieldCreator.createRenderer({layer:a,rasterFunction:n}).then((e=>(a.effect=void 0,(0,s.a8)(e.renderer),Promise.resolve(e))),(e=>Promise.reject(e)))}function l(e){const{layer:t,modules:a}=s.s,n=t,i=(0,s.a9)(),l="imagery"===n.type?n.rasterFunction:void 0;return e=e||{},a.RasterVectorFieldCreator.createRenderer({layer:n,rasterFunction:l,style:e.style||i.style}).then((e=>{e.renderer.symbolTileSize=i.symbolTileSize;const t=(0,s.d)(i,"size");return e.renderer.visualVariables=(0,s.T)(e.renderer,"size")||[],e.renderer.visualVariables.push(t),e.renderer.flowRepresentation=i.flowRepresentation,e.renderer.inputUnit=i.inputUnit,e.renderer.outputUnit=i.outputUnit,Promise.resolve(e)}),(e=>Promise.reject(e)))}function r(){const{layer:e,modules:t}=s.s,a=e,i="imagery"===a.type?a.rasterFunction:void 0,l=(0,n.c)([[245,245,0],[255,0,0]].map((e=>new t.esriColor(e))));return t.RasterClassBreaksCreator.createRenderer({layer:a,rasterFunction:i,colorRamp:l}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),Promise.resolve(e))))}function o(e){const{layer:t,modules:a}=s.s,n=t,i=(0,s.a9)(),l="imagery"===n.type?n.rasterFunction:void 0;return a.RasterClassBreaksCreator.createRenderer({layer:n,rasterFunction:l,field:e.field||i.field,classificationMethod:e.classificationMethod||i.authoringInfo.classificationMethod,numClasses:e.numClasses||i.classBreakInfos.length,colorRamp:i.authoringInfo.colorRamp,definedInterval:e.definedInterval}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),Promise.resolve(e))))}function c(){var e;const{layer:t,modules:a,strings:n}=s.s,i=t;let l;const{rasterInfo:r}=i,o=null===(e=null==r?void 0:r.attributeTable)||void 0===e?void 0:e.fields;return l=o?o.filter((e=>"oid"!==e.type&&"string"!==e.type)):[new a.Field({name:"value",alias:n.panels.classBreaks.value})],l}},22601:(e,t,a)=>{a.d(t,{a:()=>i,c:()=>n,f:()=>l});a(77040),a(70506);var s=a(82646);function n(e){const{layer:t,mapView:a,modules:n}=s.s,i=t;return e=e||{},n.RasterFlowCreator.createRenderer({layer:i,view:a,theme:e.flowTheme||"flow-line",includeColorVariable:e.includeColorVariable,legendOptions:e.legendOptions,flowRepresentation:e.flowRepresentation,flowScheme:e.flowScheme||l()}).then((t=>(t.layerEffect&&-1===t.layerEffect.indexOf("drop-shadow")&&(i.effect=t.layerEffect),t.renderer.color=t.renderer.color&&(e.color||t.renderer.color),Promise.resolve(t))),(e=>Promise.reject(e)))}function i(e){var t;const{layer:a,mapView:n,modules:i}=s.s,r=a;e=e||{};const o=(0,s.a9)(),c=(0,s.d)(o,"color"),d=o.authoringInfo,h=e.flowTheme||(null==d?void 0:d.flowTheme)||"flow-line";return i.RasterFlowCreator.createRenderer({layer:r,view:n,theme:h,includeColorVariable:null!==(t=e.includeColorVariable)&&void 0!==t?t:!!c,legendOptions:e.legendOptions||(null==c?void 0:c.legendOptions),flowRepresentation:e.flowRepresentation||o.flowRepresentation,flowScheme:e.flowScheme}).then((t=>{const a=(0,s.J)(o,"color"),n=(0,s.J)(t.renderer,"color");(null==a?void 0:a.minSliderValue)&&(null==a?void 0:a.maxSliderValue)&&n&&(n.minSliderValue=a.minSliderValue,n.maxSliderValue=a.maxSliderValue);const r=(0,s.d)((0,s.a9)(),"color"),c=(0,s.d)(t.renderer,"color");r&&c&&r.stops.forEach(((e,t)=>{c.stops[t].value=e.value})),t.renderer.color=t.renderer.color&&(e.color||o.color||t.renderer.color);return(e.flowScheme||l())&&r&&c&&r.stops.forEach(((e,t)=>{c.stops[t].color=new i.esriColor(e.color.toJSON())})),h===d.flowTheme&&(t.renderer.flowSpeed=o.flowSpeed,t.renderer.density=o.density,t.renderer.trailLength=o.trailLength,t.renderer.trailWidth=o.trailWidth,t.renderer.trailCap=o.trailCap),Promise.resolve(t)}),(e=>Promise.reject(e)))}function l(){const{mapView:e,modules:t}=s.s,a=(0,s.a9)(),n=(0,s.d)(a,"color");if(!n)return null;const i=n.stops.map((e=>e.color)),l=t.flowSchemes.getSchemes({basemap:e.map.basemap||"topo"}),r=[l.primaryScheme].concat(l.secondarySchemes),o=[];return r.forEach((e=>{let t=i.some(((t,a)=>!(0,s.aa)(e.colors[a],t)));t?(e.colors=e.colors.reverse(),t=i.some(((t,a)=>!(0,s.aa)(e.colors[a],t))),t||o.push(e)):o.push(e)})),o.length?o[0]:null}}}]);