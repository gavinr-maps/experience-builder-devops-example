/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-symbol--c97b9b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-symbol--c97b9b"],{85285:(e,i,t)=>{t.r(i),t.d(i,{arcgis_symbol_order:()=>a});var s=t(7263),n=t(62159),d=t(28926);t(78613),t(58233),t(70506),t(99004);const o="container";var r,l;!function(e){e.Ascending="sort-ascending-arrow",e.Descending="sort-descending-arrow"}(r||(r={})),function(e){e.AscendingDate="sortLeastRecent",e.AscendingNumber="smallToLarge",e.DescendingDate="sortMostRecent",e.DescendingNumber="largeToSmall"}(l||(l={}));const a=class{constructor(e){(0,s.r)(this,e),this.arcgisSymbolOrderChange=(0,s.c)(this,"arcgisSymbolOrderChange",7),this.fieldPickListChanges=e=>{var i,t;e.stopPropagation();const s=null===(t=null===(i=e.detail)||void 0===i?void 0:i.selectedFields)||void 0===t?void 0:t[0];s&&s!==this.selectedField.name&&(this.selectedField=s!==this.getRendererFieldName()?this.toPickListFieldInfo(this.findField(s)):this.getRendererFieldInfo()),this.onHideFieldPickList()},this.view=void 0,this.layer=void 0,this.open=!0,this.disabled=!1,this.fieldTypes=["integer","small-integer","big-integer","single","double","long","date"],this.objectIdFieldName="oid",this.ascending=!1,this.selectedField=void 0}async componentWillLoad(){var e;const[i]=await(0,n.g)(this.hostElement);this.strings=i;const{view:t,layer:s,pickListFields:d}=this;this.props={view:t,layer:s};const{type:o}=s,r=d||this.createPickListFields();if("catalog"!==o&&this.isRendererOrder())this.selectedField=this.getRendererFieldInfo();else{const{orderBy:i}=s,t=(null==i?void 0:i.length)?i[0]:i;this.ascending="ascending"===(null==t?void 0:t.mode);const n=this.orderByField=(null==t?void 0:t.field)||(null===(e=this.findOIDField(r))||void 0===e?void 0:e.name)||r[0];this.selectedField=this.toPickListFieldInfo(this.findField(n))}}async componentDidLoad(){const[e]=await(0,d.l)(["esri/intl"]);this.intl=e,this.intl.setLocale(document.documentElement.lang)}disconnectedCallback(){this.destroyFieldsPickList()}async done(){this.disableContainer(!1),this.destroyFieldsPickList()}render(){const{strings:e,open:i,disabled:t,layer:n}=this,{type:d}=n,r="feature"===d?e.orderByTooltip:e.orderByTooltipCatalogLayer,l="feature"===d?e.heading:e.headingCatalogLayer;return(0,s.h)(s.H,{key:"cfa330898ea04c0cf22890ade45a2b39fb2b90a4"},(0,s.h)("calcite-block",{key:"13b5c325aff6788afc3a41977c4fe6003a41bc3b",class:o,heading:l,collapsible:!0,disabled:t,open:i&&!t},(0,s.h)("p",{key:"2b5c397d48a2a94b2faae9dceda43d1bd81a206f",class:"information"},r),(0,s.h)("article",{key:"bab891520ee0a7ebe79ba83177d2dfe879d1beca"},this.renderFieldSelectionButton(),this.renderSortOrderAction())),(0,s.h)("calcite-tooltip",{key:"115378deac734782d84fd96ae306bfc957e045a7","reference-element":"sort-action",placement:"bottom-start",label:"",ref:e=>this.tooltipNode=e},this.getSortDirectionTooltip()))}renderFieldSelectionButton(){const{selectedField:e,strings:i}=this,t=this.createPickListFields();return(0,s.h)("calcite-label",{scale:"s"},i.orderBy,(0,s.h)("calcite-button",{key:"selected-field-button",appearance:"outline-fill",kind:"neutral",width:"full",alignment:"icon-end-space-between",scale:"s",disabled:t.length<=1,iconEnd:"chevron-down",onClick:e=>this.onShowFieldPickList(e),ref:e=>this.fieldSelectionNode=e},(null==e?void 0:e.alias)||t[0].alias))}renderSortOrderAction(){const{selectedField:e}=this,i="oid"===e.type||"renderer"===e.type;return(0,s.h)("section",null,(0,s.h)("calcite-action",{scale:"s",id:"sort-action",appearance:"transparent",alignment:"start",icon:this.getSortDirectionIcon(),onClick:e=>this.onToggleSortDirection(e),onMouseOver:()=>this.onShowTooltip(!0),onMouseOut:()=>this.onShowTooltip(!1),text:"",disabled:i}))}onChange(){const e=this.getValue(),i="renderer"===e;if(this.layer.orderBy=i?void 0:e,"feature"===this.layer.type){this.layer.renderer.orderByClassesEnabled=i||void 0}this.arcgisSymbolOrderChange.emit()}async onShowFieldPickList(e){e.stopPropagation(),this.disableContainer(!0),this.createFieldPickList()}async onHideFieldPickList(){this.disableContainer(!1),this.destroyFieldsPickList(),await this.fieldSelectionNode.setFocus(),this.onChange()}onToggleSortDirection(e){e.stopPropagation(),this.ascending=!this.ascending,this.onChange()}onShowTooltip(e){this.tooltipNode.open=e}createFieldPickList(){const{layer:e,pickListFields:i,view:t,strings:s}=this,n=i||this.createPickListFields(),d=this.fieldSelectionNode,o=this.createPopoverProps(d),r=this.selectedField||(this.isRendererOrder()?this.getRendererFieldInfo():n[0]),l=this.fieldPickList=document.createElement("arcgis-field-pick-list");return l.heading=s.orderBy,l.multiple=!1,l.showFieldInfo=!1,l.showFieldName=!0,l.mapView=t,l.layer=e,l.fields=n,l.selectedFields=[r.name],l.popoverProps=o,l.addEventListener("arcgisFieldPickListDismissed",this.fieldPickListChanges),document.body.appendChild(l),l}destroyFieldsPickList(){this.fieldPickList&&(document.body.removeChild(this.fieldPickList),this.fieldPickList=null)}createPopoverProps(e){return{placement:"bottom-end",offsetDistance:5,offsetSkidding:0,pointerDisabled:!0,popoverWidth:this.getPopoverWidth(),refElement:e}}createPickListFields(){let{pickListFields:e}=this;if(!e){const{layer:i,fieldTypes:t}=this,{fields:s}=i;e=this.pickListFields=s.filter((e=>t.indexOf(null==e?void 0:e.type)>-1)).map((e=>this.toPickListFieldInfo(e)));const n=this.toPickListFieldInfo(this.getOIDField());if(e.unshift(n),this.hasTypesOrPredominanceRenderer()){const i=this.getRendererFieldInfo();e.unshift(i)}}return e}toPickListFieldInfo(e){return{name:e.name,hideFieldName:"oid"===e.type,alias:this.getFieldAlias(e),type:e.type}}getPopoverWidth(){var e;return(null===(e=this.hostElement)||void 0===e?void 0:e.getBoundingClientRect().width)+30||280}getFieldAlias(e){const{strings:i}=this;if("oid"===e.type)return i.defaultDataOrder;{const i=this.findFieldInfoFromPopup(e);return(null==i?void 0:i.label)||e.alias||e.name}}findFieldInfoFromPopup(e){const{popupTemplate:i}=this.layer;return((null==i?void 0:i.fieldInfos)||[]).find((i=>i.fieldName===e.name))}getOIDField(){const{layer:e}=this,{fields:i}=e;return i.find((i=>i.name===e.objectIdField||"oid"===i.type))}findOIDField(e){const{layer:i}=this;return e.find((e=>e.name===i.objectIdField||"oid"===e.type))}findField(e){const{layer:i}=this,{fields:t}=i;return t.find((i=>i.name===e))||t[0]}getSortDirectionIcon(){return this.ascending?r.Ascending:r.Descending}getSortDirectionTooltip(){const{ascending:e,selectedField:i,strings:t}=this;let s="sortLeastRecent";return s="date"===(null==i?void 0:i.type)?e?l.AscendingDate:l.DescendingDate:e?l.AscendingNumber:l.DescendingNumber,t[s]}hasTypesOrPredominanceRenderer(){var e,i;const{layer:t}=this,{renderer:s}=t;return!!s&&("unique-value"===(null==s?void 0:s.type)&&(!(null===(e=null==s?void 0:s.authoringInfo)||void 0===e?void 0:e.type)||"predominance"===(null===(i=null==s?void 0:s.authoringInfo)||void 0===i?void 0:i.type)))}isRendererOrder(){const{layer:e}=this,{renderer:i}=e;return!!i&&(this.hasTypesOrPredominanceRenderer()&&!0===(null==i?void 0:i.orderByClassesEnabled))}getRendererFieldName(){const{layer:e}=this,{renderer:i}=e;return i&&this.hasTypesOrPredominanceRenderer()&&(i.field||i.valueExpressionTitle)||null}getRendererFieldInfo(){return{name:this.getRendererFieldName(),alias:this.strings.styleOrder,type:"renderer"}}disableContainer(e){const i=this.hostElement.closest("calcite-flow-item");i&&(i.disabled=e)}getValue(){const{selectedField:e}=this;return"oid"===e.type?null:"renderer"===e.type?"renderer":[{order:this.ascending?"ascending":"descending",field:this.selectedField.name}]}get hostElement(){return(0,s.d)(this)}};a.style="article{display:flex;align-items:center;flex-direction:row;grid-gap:0.5rem;gap:0.5rem}article calcite-action{margin-top:0.7em}article calcite-label{width:100%}.infoPopover{width:340px;font-size:12px}.information{margin:0 0 1em 0}"}}]);