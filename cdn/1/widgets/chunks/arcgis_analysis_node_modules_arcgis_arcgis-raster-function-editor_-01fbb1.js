"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-01fbb1"],{3755:(e,t,i)=>{function a(e){const{customBaseUrl:t,portalHostname:i,urlKey:a}=e,{protocol:r}=window.location;return`${r}//${void 0!==a?`${a}.${t}`:i}`}function r(e){const{helperServices:{rasterAnalytics:{url:t}},isPortal:i}=e;return i?t:t.replace("rasteranalysis","rasterutils")}function s(e){return r(e).replace("RasterAnalysisTools/GPServer","RasterRendering/ImageServer/validate")}function o(e){return r(e).replace("RasterAnalysisTools/GPServer","RasterRendering/ImageServer")}i.d(t,{a:()=>s,b:()=>o,g:()=>a})},56750:(e,t,i)=>{i.r(t),i.d(t,{rfx_color_picker:()=>f,rfx_dte_number_input:()=>w,rfx_dte_raster_input:()=>I,rfx_dtex_field_select:()=>_,rfx_grid:()=>$});var a=i(17002),r=i(56451),s=(i(5294),i(588),i(55448),i(2924),i(11840),i(52373),i(33752),i(440),i(66744),i(44345),i(19562)),o=(i(23795),i(17902),i(68852),i(71802),i(62559)),l=i(14385),n=i(38146),c=i(37757),d=i(15517),h=i(1409),u=i(15195),g=i(3755);i(63716),i(59799);const f=class{constructor(e){(0,a.r)(this,e),this.rfxColorPickerValueChange=(0,a.c)(this,"rfxColorPickerValueChange",7),this.onColorSwatchClick=e=>{const t=e.target.value;this.popoverElememt.open=!1,this.value=new r.default(t).toRgba(),this.rfxColorPickerValueChange.emit({value:this.value})},this.value=[0,0,0,255]}render(){const e=new r.default(this.value).toHex();return(0,a.h)("div",{key:"2d661a62ab178629a6dfdba61571f4e8063ba0c6"},(0,a.h)("calcite-color-picker-swatch",{key:"ec6fab1c9223d234df72026098bef03cdc453b1f",active:!1,color:e,id:"color-picker-swatch",scale:s.U.Scale,onClick:()=>{setTimeout((()=>requestAnimationFrame((()=>{this.popoverElememt.open=!0,this.popoverElememt?.setFocus()}))),1)},role:"button",ref:e=>{}}),(0,a.h)("calcite-popover",{key:"e788f72b67785c83a990cc3b0174ecb898b85aa9",autoClose:!0,pointerDisabled:!0,referenceElement:"color-picker-swatch",placement:"auto",overlayPositioning:s.a.fixed,scale:s.U.Scale,label:"color-picker-popover",ref:e=>{this.popoverElememt=e}},(0,a.h)("calcite-color-picker",{key:"05d8965ccd8cab88165b0a9cf23df5abad7b926c",scale:s.U.Scale,value:e,format:"auto",onCalciteColorPickerChange:this.onColorSwatchClick})))}get hostElement(){return(0,a.a)(this)}},p="invalidIntegerMessage",m="invalidDoubleMessage",v="requiredInputMessage",b="belowMinimumMessage",y="aboveMaximumMessage",x="strictlyMinimumMessage",C="strictlyMaximumMessage",k={errorMessage:"rfx-dte-number-input__error-message"},w=class{constructor(e){(0,a.r)(this,e),this.rfxNumberInputChange=(0,a.c)(this,"rfxNumberInputChange",7),this.rfxNumberInputValueChange=(0,a.c)(this,"rfxNumberInputValueChange",7),this.inputChanged=e=>{if(null!==e.target){const t=(e?.target).value;if(this.value=(0,c.p)(t),""===t)return;this.validate(),void 0===this.errorMessage&&this.rfxNumberInputChange.emit()}},this.inputValueChanged=e=>{if(null!==e?.target){const t=e.target.value;this.value=(0,c.p)(t),this.validate(),void 0===this.errorMessage&&this.rfxNumberInputValueChange.emit()}},this.validateNumber=(e,t)=>{const{required:i,isFloatType:a,excludeMinValue:r,excludeMaxValue:s,min:o,max:l}=t;let n;return(0,c.i)(e)?!1!==a||Number.isInteger(e)?void 0!==o&&void 0!==e&&(e<o||!0===r&&e<=o)?n=!0===r?x:b:void 0!==l&&void 0!==e&&(e>l||!0===s&&e>=l)&&(n=!0===s?C:y):n=p:void 0!==e?n=!0===a?m:p:!0===i&&(n=v),n},this.errorMessage=void 0,this.value=void 0,this.numberType=void 0,this.required=void 0,this.min=void 0,this.excludeMinValue=void 0,this.max=void 0,this.excludeMaxValue=void 0,this.numberButtonType="vertical",this.dependentFields=void 0,this.placeholder=void 0,this.isDisabled=!1}onRequiredChange(){this.validate()}onValidationChange(){this.errorMessage=void 0,!1===(0,l.o)(this.value)&&this.validate()}async checkValidity(){return Promise.resolve(void 0===this.errorMessage||""===this.errorMessage)}async componentWillLoad(){({strings:this.strings,locale:this.locale}=await(0,o.b)(this.hostElement,(0,a.g)(".")))}get isFloatType(){return(0,l.o)(this.numberType)||"float"===this.numberType}get formatOptions(){return{min:`${void 0!==this.dependentFields?.greaterThan?this.dependentFields.greaterThan:this.min??Number.MIN_SAFE_INTEGER}`,max:`${void 0!==this.dependentFields?.lessThan?this.dependentFields.lessThan:this.max??Number.MAX_SAFE_INTEGER}`}}validate(){const e=this.value,t=this.validateNumber(e,this.formatValidationOptions()),i=void 0!==t?(0,n.f)(this.strings[t],this.formatOptions):void 0;this.errorMessage=i}formatValidationOptions(){return{required:this.required,isFloatType:this.isFloatType,excludeMaxValue:this.excludeMaxValue,excludeMinValue:this.excludeMinValue,max:this.max??Number.MAX_SAFE_INTEGER,min:this.min??Number.MIN_SAFE_INTEGER}}render(){const e=void 0!==this.errorMessage;return(0,a.h)("host",{key:"856ca51cc9eff8416e453421911295ebe11c6f71"},(0,a.h)("calcite-input",{key:"38045b56ac0d00affa136888fa4941637acaa000",type:"number",value:(0,c.s)(this.value),step:this.isFloatType?"any":1,required:this.required||void 0,min:this.min,max:this.max,status:e?"invalid":"valid",scale:s.U.Scale,groupSeparator:!0,onCalciteInputInput:this.inputChanged,onCalciteInputChange:this.inputValueChanged,numberButtonType:this.numberButtonType,placeholder:this.placeholder??this.strings.placeholder,disabled:this.isDisabled,title:this.value?.toLocaleString(this.locale)}),(0,a.h)("calcite-input-message",{key:"6c1f90020bb5b0661d08b0c9956b17996558a6b9",class:k.errorMessage,status:e?"invalid":"valid",scale:s.U.Scale,hidden:!1===e,icon:"exclamationMarkTriangle"},this.errorMessage))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}static get watchers(){return{required:["onRequiredChange"],min:["onValidationChange"],max:["onValidationChange"],excludeMaxValue:["onValidationChange"],excludeMinValue:["onValidationChange"],numberType:["onValidationChange"]}}};w.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.rfx-dte-number-input__error-message{margin-top:0.5rem}";const L="rfx-dte-raster-input",V={layerInput:`${L}__layer-input`,layerLoadFail:`${L}__layer-load-fail`},I=class{constructor(e){(0,a.r)(this,e),this.rfxArgumentChange=(0,a.c)(this,"rfxArgumentChange",7),this.scalarValues=[],this.loaded=!1,this.layerLoadFailed=!1,this.inputLayers=void 0,this.value=void 0,this.allowScalar=!1,this.overlayPositioning=s.a.absolute,this.maxItems=5,this.rfxVariable=void 0,this.mode=void 0,this.portal=void 0,this.rfxBrowseLayerClick=void 0}async onRFxVariableChange(e){if(e.value)this.value=e.value;else if(this.argRFT=(0,h.o)(e),e.type===u.J.RASTER_FUNCTION_TEMPLATE)try{const e=(0,d.q)((0,g.b)(this.portal),this.argRFT);await e.load(),this.rasterRenderingLayer=e}catch(e){console.error(e?.details?.messages)}}async connectedCallback(){return await this.load(),this.loaded=!0,Promise.resolve()}async componentWillLoad(){({strings:this.strings}=await(0,o.b)(this.hostElement,(0,a.g)(".")))}async getSelectedLayer(){return!1===this.loaded&&await this.load(),void 0!==this.value&&"object"==typeof this.value?this._getSelectedLayer(this.value):this.rfxVariable.type===u.J.RASTER_FUNCTION_TEMPLATE?this.rasterRenderingLayer:Promise.resolve(void 0)}async updateBrowsedLayer(e){return e.forEach((e=>{0===this.inputLayers.filter((t=>e.url===t.url)).length&&this.inputLayers.push(e),this.value=(0,d.e)(e),this.rfxArgumentChange.emit({value:this.value})})),Promise.resolve(void 0)}async load(){(0,l.o)(this.rfxVariable)||await this.onRFxVariableChange(this.rfxVariable),(0,l.o)(this.value)||await this.processValueLayer()}async processValueLayer(){if("scalar"===this.value.type?.toLowerCase())return void this.scalarValues.push(this.value);const e=this.value?.url;if((0,l.o)(e))return;const t=(0,d.f)(this.value,this.inputLayers);if((0,l.o)(t)){const e=await(0,d.h)(this.value);if(void 0===e)return void(this.layerLoadFailed=!0);this.inputLayers=[...this.inputLayers,e]}const i=await this._getSelectedLayer(this.value);void 0!==i&&(this.value=(0,d.e)(i)),this.inputLayers=(0,n.a)(this.inputLayers,["title","url"])}async _handleComboBoxChange(e){this.layerLoadFailed=!1;const t=e.target.value;if((0,l.o)(t))this.value=void 0;else{if("browse"===t)return this.value=void 0,void this.rfxBrowseLayerClick({referenceElement:this.hostElement});if(-1!==t.indexOf("&layerName")){const e=await this._getSelectedLayer(this.getLayerNameAndUrlFromValue(t));void 0!==e&&(this.value=(0,d.e)(e))}else 1==this.allowScalar&&(this.value={type:"Scalar",value:t})}this.rfxArgumentChange.emit({value:this.value})}getLayerNameAndUrlFromValue(e){const t=e.split("&layerName=")[0];return{name:e.split("&layerName=")[1],url:t}}async _getSelectedLayer(e){const t=(0,d.g)(e.url);let i;if(void 0!==e.url&&void 0!==e.name&&(i=this.inputLayers.find((i=>i.url===t&&i.title===e.name))),i&&(await i.load(),(0,l.m)(i)))try{i.rasterInfo=await i.generateRasterInfo(i.rasterFunction)}catch(e){console.error(e)}return i}getFormattedValueFromVariable(){if(!(0,l.o)(this.argRFT)){const e=this.argRFT.function?.name;return`<${e}.${this.strings.outputRaster}>`}return this.mode===u.a.ANALYSIS?this.getDefaultPlaceHolder():`<${this.strings.rfxVariable}: ${this.rfxVariable.name}>`}getDefaultPlaceHolder(){return this.allowScalar?this.strings.allowScalar:this.strings.selectLayer}getPlaceHolderText(){return(0,l.o)(this.rfxVariable)?this.getDefaultPlaceHolder():this.getFormattedValueFromVariable()}getValueString(e){return`${e.url}&layerName=${e.title??e.name}`}renderInputOptions(e){let t=[];return this.inputLayers&&Array.isArray(this.inputLayers)&&(t=this.inputLayers.map(((t,i)=>{const r=this.getValueString(t);if(void 0!==t?.url)return(0,a.h)("calcite-combobox-item",{key:`layer-item-${i}`,value:r,selected:r===e,textLabel:t.title,icon:"imagery"===t.type?"image-layer":"tiled-imagery-layer"})}))),0!==this.scalarValues?.length&&this.scalarValues.forEach((e=>{t.push((0,a.h)("calcite-combobox-item",{key:`layer-item-${this.inputLayers.length+1}`,value:e.value,textLabel:e.value,selected:!0}))})),t}render(){const e=(0,d.g)(this.value?.url),t=(0,l.o)(this.value)?this.value:"Scalar"===this.value?.type?this.value.value:this.getValueString({url:e,name:this.value?.name});return(0,a.h)("div",{key:"d30e7dcc97f09c6e416930071f7087d3a12d1938",class:`esriRFxRasterInput ${V.layerInput}`},(0,a.h)("calcite-combobox",{key:"4790c617df138ffb6fd264874726c8786f54fa1f",label:"rfx-dte-raster-input-combobox",placeholder:this.getPlaceHolderText(),selectionMode:"single",scale:s.U.Scale,disabled:void 0!==this.argRFT,allowCustomValues:this.allowScalar,value:t,onCalciteComboboxChange:e=>this._handleComboBoxChange(e),overlayPositioning:this.mode===u.a.EDITOR?s.a.fixed:this.overlayPositioning,clearDisabled:!0,maxItems:this.mode===u.a.EDITOR?this.maxItems:0},(0,a.h)(a.F,{key:"efc45968137f252813fb60fb8ea457215106615a"},(0,a.h)("calcite-combobox-item",{class:"browse-layer",key:"layer-item-browse",value:"browse",textLabel:this.strings.browseLayer,icon:"search",filterDisabled:!0}),...this.renderInputOptions(t))),(0,a.h)("calcite-input-message",{key:"958e2dad8b18057bfa81dc4a34fa7dc06e4a7aa5",class:V.layerLoadFail,status:"invalid",scale:s.U.Scale,hidden:!1===this.layerLoadFailed,icon:"exclamationMarkTriangle"},this.strings.layerFailedToLoad))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}static get watchers(){return{rfxVariable:["onRFxVariableChange"]}}};I.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.rfx-dte-raster-input__layer-input{text-align:start}.rfx-dte-raster-input__layer-load-fail{margin-top:0.5rem;color:var(--calcite-color-status-danger)}.browse-layer{--calcite-color-text-1:var(--calcite-color-text-link);--calcite-color-text-3:var(--calcite-color-text-link)}";const _=class{constructor(e){(0,a.r)(this,e),this.rfxArgumentChange=(0,a.c)(this,"rfxArgumentChange",7),this.rfxFieldOptionsLoaded=(0,a.c)(this,"rfxFieldOptionsLoaded",7),this.handleFieldSelectChange=e=>{const t=e.target;this.value=t.value,this.rfxArgumentChange.emit({value:this.value})},this.layerArg=void 0,this.rasterInputVariable=void 0,this.otherOptions=void 0,this.value=void 0,this.options=void 0,this.fieldType=void 0,this.isInGrid=!1,this.inputLayers=void 0,this.mode=void 0,this.showDefaultFields=!0}onrasterInputVariableChange(){this.processLayerArg()}async componentWillLoad(){({strings:this.strings}=await(0,o.b)(this.hostElement,(0,a.g)("."))),await this.processLayerArg(),this.processDefaultValue()}render(){return(0,a.h)("div",{key:"3f8f499e2ada620e92ff05cde67ea9963a4594bb"},(0,a.h)("rfx-dtex-common-select",{key:"7ccb57c284d876a6bb678e2e86e32f672ddc15a9",isInGrid:this.isInGrid,mode:this.mode,options:this.options,value:this.value,placeHolderText:this.strings.selectField,onRfxArgumentChange:this.handleFieldSelectChange}))}async getSelectedRasterLayer(e){e=(0,d.g)(e);const t=this.inputLayers.find((t=>t.url===e));if(t&&(await t.load(),(0,l.m)(t)))try{t.rasterInfo=await t.generateRasterInfo(t.rasterFunction)}catch(e){console.error(e)}return t}async processLayerArg(){if((0,l.o)(this.rasterInputVariable))if((0,l.o)(this.layerArg))this.setDefaultFieldOptions();else{const e=this.layerArg.input;e?(await this.updateFields(),e.addEventListener("rfxArgumentChange",(async()=>{await this.updateFields()}))):this.setDefaultFieldOptions()}else await this.updateFields();this.rfxFieldOptionsLoaded.emit()}async updateFields(){let e;if((0,l.o)(this.rasterInputVariable?.value)){if(!(0,l.o)(this.layerArg)){const t=this.layerArg.input;e="function"==typeof t.getSelectedLayer?await t.getSelectedLayer():void 0}}else e=await this.getSelectedRasterLayer(this.rasterInputVariable?.value?.url);if(e){if((0,l.j)(e))this.options=this.convertFieldsToOptions(e.fields),this.otherOptions&&this.addOtherOptions();else if((0,l.m)(e)||(0,l.n)(e))if(e.sourceJSON?.hasRasterAttributeTable){const t=(0,l.m)(e)?e.serviceRasterInfo.attributeTable:e.rasterInfo.attributeTable;(0,l.o)(t?.fields)?this.setDefaultFieldOptions():this.setFieldOptions(t.fields)}else this.setDefaultFieldOptions()}else this.setDefaultFieldOptions();this.processDefaultValue()}addOtherOptions(){const e=[],t=this.options,i=this.otherOptions;Object.keys(i).forEach((function(t){const a={key:t,label:i[t]};e.push(a)})),t&&t.length>0?(e.forEach((function(e){t.some((function(t){if(t.key===e.key)return!0}))||t.push(e)})),this.options=t):this.options=e}setFieldOptions(e){const t=["esriFieldTypeString"],i=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].concat(t),a=this.fieldType;if(e?.length>0){const r=(e=JSON.parse(JSON.stringify(e))).filter((e=>"list"===a?t.indexOf(e.type)>-1:i.indexOf(e.type)>-1));this.options=this.convertFieldsToOptions(r)}else this.setDefaultFieldOptions()}setDefaultFieldOptions(){!0===this.showDefaultFields&&(this.options=this.isInGrid?[{key:"VALUE",label:this.strings.value}]:[{key:"VALUE",label:this.strings.value},{key:"COUNT",label:this.strings.count}])}convertFieldsToOptions(e){const t=[];return e.map((e=>{t.push({key:e.name,label:e.alias})})),t}processDefaultValue(){(0,l.o)(this.options)||this.options?.length<1||(void 0!==this.value&&null!==this.value||(this.value=this.options[0].key),this.isInGrid||this.options.some((e=>e.key===this.value))||(this.value=this.options[0].key),(0,l.o)(this.rasterInputVariable)&&(0,l.o)(this.layerArg)||this.rfxArgumentChange.emit({value:this.value}))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}static get watchers(){return{rasterInputVariable:["onrasterInputVariableChange"]}}},F="rfx-grid__grid-container",O="border",T="stacked",$=class{constructor(e){(0,a.r)(this,e),this.rfxGridOptionChange=(0,a.c)(this,"rfxGridOptionChange",7),this.rfxGridRowClick=(0,a.c)(this,"rfxGridRowClick",7),this.gridValueChange=e=>{e.stopImmediatePropagation();const t=e.type,i=e.target;let a,r,s;switch(t){case"calciteCheckboxChange":case"calciteSwitchChange":a=i.checked;break;default:a=i.value}if(i?.tagName===u.A.RFX_DTE_RASTER_INPUT){const e=(0,d.a)();e.value=(0,d.c)(a),r=e,s=i?.inputLayers,(0,l.o)(s)||(this.inputLayers=s)}const[o,n]=i.id.split("-");let c;this.gridOptions=this.gridOptions.map(((e,t)=>{if(e.id===Number.parseInt(n,10)){if(i.id.indexOf(o)>-1){this.gridLayout[o].uiType===u.G.select?e[o].value=r??a:e[o]=r??a}c=t}return e})),this.canAdd&&this.addRow(),this.rfxGridOptionChange.emit({gridOptions:this.gridOptions,rowIndex:c,columnName:o})},this.onRemoveClick=e=>{const t=e.target.id.split("-")[1],i=this.gridOptions.findIndex((e=>e.id===Number.parseInt(t,10)));this.gridOptions=this.gridOptions.filter((e=>e.id!==Number.parseInt(t,10))),this.rfxGridOptionChange.emit({gridOptions:this.gridOptions,rowIndex:i}),0===this.gridOptions.length&&(this.gridOptions=[{id:this.gridOptions.length}])},this.onGridRowClick=e=>{e.stopPropagation();const t=e.currentTarget.id.split("_")[2],i=this.gridOptions.findIndex((e=>e.id===Number.parseInt(t,10)));this.rfxGridRowClick.emit({gridOptions:this.gridOptions,rowIndex:i})},this.gridOptions=[],this.inputLayers=void 0,this.canAdd=!0,this.canRemove=!0,this.hasHeader=!0,this.isStacked=!1,this.gridLayout=void 0,this.hasIdColumn=!0,this.hasBorder=!1,this.rfxBrowseLayerClick=void 0,this.isEditable=!0}async componentWillLoad(){({strings:this.strings}=await(0,o.b)(this.hostElement,(0,a.g)(".")))}adjustValueListItemIds(){this.gridOptions.forEach(((e,t)=>{e.id=t}))}isLastRowEmpty(e){return!Object.keys(this.gridLayout).some((t=>{const i=this.gridLayout[t].uiType===u.G.select?e[t].value:e[t];return!(0,l.o)(i)}))}addRow(){const e=this.gridOptions[this.gridOptions.length-1];if(!!this.isLastRowEmpty(e))return;this.adjustValueListItemIds();const t={id:this.gridOptions.length};for(const e in this.gridLayout)if(this.gridLayout.hasOwnProperty(e)){const i=this.gridLayout[e].uiType===u.G.select,a=this.gridOptions[0][e];i&&(t[e]={...a,value:void 0})}this.gridOptions.push(t)}renderGridRow(e,t){const i=Number.parseInt(t,10)+1,r=Object.keys(this.gridLayout).map((t=>{const i=this.gridLayout[t];switch(i.uiType){case u.G.textInput:return(0,a.h)("td",null,(0,a.h)("calcite-input-text",{class:i.style,scale:s.U.Scale,key:`${t}-${e.id}`,id:`${t}-${e.id}`,value:e[t],onCalciteInputTextChange:this.gridValueChange,title:e[t]}));case u.G.text:return(0,a.h)("td",{key:`${t}_${e.id}`,class:i.style},i.constValue||e[t]);case u.G.raster:return(0,a.h)("td",null,(0,a.h)("rfx-dte-raster-input",{class:i.style,key:`${t}-${e.id}`,id:`${t}-${e.id}`,inputLayers:this.inputLayers,allowScalar:i.allowScalar,rfxVariable:e.rasterElement,value:e[t]?.value,overlayPositioning:s.a.fixed,onRfxArgumentChange:this.gridValueChange,rfxBrowseLayerClick:this.rfxBrowseLayerClick}));case u.G.number:const r=i.validationRule,o=`${t}Rule`,{min:l,max:n,numberType:c,excludeMaxValue:d,excludeMinValue:h,numberButtonType:g,required:f}=r??e[o]??{};return i.isEditable=this.isEditable,(0,a.h)("td",null,(0,a.h)("rfx-dte-number-input",{key:`${t}-${e.id}`,id:`${t}-${e.id}`,value:e[t],min:l,max:n,numberType:c,numberButtonType:g??"none",excludeMaxValue:d,excludeMinValue:h,required:f,onRfxNumberInputChange:this.gridValueChange,title:e[t],isDisabled:!i.isEditable}));case u.G.boolean:return(0,a.h)("td",null,(0,a.h)("calcite-checkbox",{key:`${t}-${e.id}`,id:`${t}-${e.id}`,checked:e[t],onCalciteCheckboxChange:this.gridValueChange}));case u.G.switch:return(0,a.h)("td",null,(0,a.h)("calcite-switch",{key:`${t}-${e.id}`,id:`${t}-${e.id}`,checked:e[t],onCalciteSwitchChange:this.gridValueChange}));case u.G.field:return(0,a.h)("td",null,(0,a.h)("rfx-dtex-field-select",{class:i.style,key:`${t}-${e.id}`,id:`${t}-${e.id}`,inputLayers:this.inputLayers,isInGrid:!0,rasterInputVariable:e.layer,value:e[t],onRfxArgumentChange:this.gridValueChange}));case u.G.color:return(0,a.h)("td",null,(0,a.h)("rfx-color-picker",{key:`${t}-${e.id}`,id:`${t}-${e.id}`,value:e[t],onRfxColorPickerValueChange:this.gridValueChange}));case u.G.select:return(0,a.h)("td",null,(0,a.h)("rfx-dtex-common-select",{class:i.style,key:`${t}-${e.id}`,id:`${t}-${e.id}`,options:e[t].options,value:e[t].value,allowCustomValues:i.allowCustomValues,isInGrid:!0,onRfxArgumentChange:this.gridValueChange}));case u.G.icon:return(0,a.h)("td",null,e[t]?(0,a.h)("calcite-icon",{class:i.style,key:`${t}-${e.id}`,id:`${t}-${e.id}`,icon:i.icon,scale:s.C.s,textLabel:i.label}):null)}}));return!0===this.hasIdColumn&&r.unshift((0,a.h)("td",null,(0,a.h)("div",{key:`idColumn_${e.id}`},i))),!0===this.canRemove&&r.push((0,a.h)("td",null,(0,a.h)("calcite-icon",{id:`remove-${e.id}`,key:`remove-${e.id}`,scale:s.U.Scale,icon:"x",onClick:i===this.gridOptions.length?void 0:this.onRemoveClick}))),r}renderHeader(){return(0,a.h)("thead",null,(0,a.h)("tr",null,!0===this.hasIdColumn&&(0,a.h)("th",null,this.strings.id),Object.keys(this.gridLayout).map((e=>{const t=this.gridLayout[e];return(0,a.h)("th",{class:`${t.style}`},t.label)})),!0===this.canRemove&&(0,a.h)("th",null," ")))}renderGridOptions(){return this.gridOptions.map(((e,t)=>(0,a.h)("tr",{id:`grid_row_${e.id}`,key:`grid_row_${e.id}`,onClick:t===this.gridOptions.length-1?void 0:this.onGridRowClick},this.renderGridRow(e,t))))}render(){return(0,a.h)(a.H,{key:"0ce6d0e9b92a6548dbc0e764cd05872270af158d"},(0,a.h)("table",{key:"88e56a0f9615df66b6f19294a55713ed02e4120b",class:`${F} ${this.hasBorder?O:""} ${this.isStacked?T:""}`},this.hasHeader&&this.renderHeader(),(0,a.h)("tbody",{key:"382248964b6be874c18a3f53f3df0cd0d4f936fc"},...this.renderGridOptions())))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,a.a)(this)}};$.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.rfx-grid__grid-container{width:100%;border-collapse:collapse}.rfx-grid__grid-container div{box-sizing:border-box}.rfx-grid__grid-container body{width:100%;height:100%;margin:0;padding:0}.rfx-grid__grid-container td{padding:0.5em;text-align:center}.rfx-grid__grid-container th{background:var(--calcite-color-foreground-2);padding:0.5em;border:1px solid var(--calcite-color-foreground-3);text-align:center;font-weight:normal}.rfx-grid__grid-container.border td{border:1px solid var(--calcite-color-foreground-3)}.rfx-grid__grid-container.stacked td,.rfx-grid__grid-container.stacked th{text-align:inherit;display:block;width:auto}"},37757:(e,t,i)=>{i.d(t,{a:()=>c,f:()=>n,i:()=>s,p:()=>l,s:()=>o});var a=i(62559),r=i(14385);function s(e){return null!=e&&!1===Number.isNaN(e)&&!0===Number.isFinite(e)}function o(e,t){let i;if(null!==e){const a="string"==typeof e?Number.parseFloat(e):e;s(a)?i=a:s(t)&&(i=t)}return void 0===i?"":`${i}`}function l(e){if(""!==e)return Number.parseFloat(e)}function n(e,t=3){if(!(0,r.o)(e))return Number.parseFloat(e.toFixed(t))}function c(e,t){let i="";if(!(0,r.o)(e)&&!Number.isNaN(e)){const r=(0,a.g)().locale;i=Intl.NumberFormat(r,t).format(Number(e))}return i}},19562:(e,t,i)=>{i.d(t,{C:()=>r,U:()=>a,a:()=>s});const a={Scale:"s",PopoverTimer:60},r={s:"s",m:"m",l:"l"},s={absolute:"absolute",fixed:"fixed"}}}]);