/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f2d6be.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f2d6be"],{46456:(e,t,r)=>{r.r(t),r.d(t,{arcgis_categorize_items:()=>u});var n=r(7263),o=r(43780),i=r(49038),a=r(29259),s=r(11246),l=r(62159),c=r(80619);r(46581),r(31670),r(11935),r(28926),r(70506),r(99004),r(94788),r(65215),r(59673),r(59296),r(2174),r(66488),r(31141),r(78613),r(58233);const u=class{constructor(e){(0,n.r)(this,e),this.arcgisCategorizeItemsCancel=(0,n.c)(this,"arcgisCategorizeItemsCancel",7),this.arcgisCategorizeItemsSubmit=(0,n.c)(this,"arcgisCategorizeItemsSubmit",7),this.closeDialog=()=>{this.arcgisCategorizeItemsCancel.emit()},this.handleCategorySelected=({paths:e,selected:t})=>{const{itemIds:r,itemToCategoriesLookup:n}=this,o=Object.assign({},this.categorySelectionCountMap);if(e.forEach((e=>{o[e]=t?[...r]:[]})),r.forEach((r=>{n[r]||(n[r]=[]);const o=n[r];n[r]=t?[...o,...e]:o.filter((t=>!e.includes(t)))})),t){const t=e.reduce(((e,t)=>{let r="";return t.split("/").filter(Boolean).forEach((n=>{r=`${r}/${n}`,r!==t&&e.push(r)})),e}),[]);t.forEach((e=>{o[e]=[]})),r.forEach((e=>{const r=n[e];n[e]=r.filter((e=>!t.includes(e)))}))}this.categorySelectionCountMap=o},this.handleItemCategoryChange=(e,t)=>{var r;const{itemToCategoriesLookup:n,categorySelectionCountMap:o,rootCategoryPath:i}=this,a=null!==(r=n[e])&&void 0!==r?r:[],l=t.map((e=>e.startsWith(i)?e:`${i}${e}`));(0,s.f)(a,l)||(a.forEach((t=>{const r=o[t];o[t]=(null!=r?r:[]).filter((t=>t!==e))})),l.forEach((t=>{const r=o[t];o[t]=[...null!=r?r:[],e]})),n[e]=[...l],this.categorySelectionCountMap=Object.assign({},o))},this.updateCategory=async()=>{const{itemIds:e,portal:t,itemToCategoriesLookup:r,i18n:n}=this;this.isLoading=!0;const{result:i,error:a}=await(0,o.u)({categories:r,itemIds:e,portal:t});if(this.isLoading=!1,i&&!a)return this.arcgisCategorizeItemsSubmit.emit(r),void(this.hasUnsavedChanges=!1);this.error=n.errorMessage},this.checkHasChange=()=>{const{itemIds:e,itemToCategoriesLookup:t,initialItemToCategoriesLookup:r}=this;this.hasUnsavedChanges=!!t&&!!r&&e.some((e=>!(0,s.f)(t[e],r[e])))},this.renderItemCard=e=>{const{portal:t,user:r,config:o,itemToCategoriesLookup:i,handleItemCategoryChange:a,categorySchema:s,rootCategoryPath:l}=this,c=i[e.id];return(0,n.h)("arcgis-item-browser-card",{key:e.id,item:e,portal:t,user:r,baseUrl:o.baseUrl,showItemType:!0},(0,n.h)("div",{slot:"content-end",class:"category-picker-container"},(0,n.h)("arcgis-categories-picker",{portal:t,categories:c,schema:s,rootCategoryPath:l,onArcgisCategoriesPickerChange:({detail:t})=>a(e.id,t),hideLabel:!0})))},this.isActive=void 0,this.items=void 0,this.user=void 0,this.portal=void 0,this.config=void 0,this.group=void 0,this.categorySchema=void 0,this.isLoading=!1,this.categorySelectionCountMap=void 0,this.itemToCategoriesLookup={},this.error=void 0,this.hasUnsavedChanges=!1,this.rootCategoryPath=void 0}async componentWillLoad(){const e=await(0,l.g)(this.el);this.i18n=e[0]}async componentDidLoad(){const{portal:e,user:t,group:r}=this;this.isLoading=!0;const n=this.items.map((e=>e.id)),{result:s,error:l}=await(0,i.c)(n,this.portal);this.items=s&&!l?s:this.items,this.updateInternalData(this.items);const{result:c,error:u}=await(0,o.g)({portal:e,user:t,group:r});!u&&c&&(this.categorySchema=c[0].categories,this.rootCategoryPath=(0,a.g)(c)),this.isLoading=!1}async updateInternalData(e){this.itemIds=e.map((e=>e.id)),this.isLoading=!0;const{result:t,error:r}=await(0,i.c)(this.itemIds,this.portal);this.isLoading=!1;const n=t&&!r?t:e;this.itemToCategoriesLookup=n.reduce(((e,t)=>(e[t.id]=t.categories,e)),{}),this.categorySelectionCountMap=(e=>{const t={};return e.forEach((({categories:e,id:r})=>{e.forEach((e=>{t[e]||(t[e]=[]),t[e].push(r)}))})),t})(n),this.initialItemToCategoriesLookup=structuredClone(this.itemToCategoriesLookup)}handleIsActiveChange(){this.isActive&&this.updateInternalData(this.items)}handleCountMapChange(){this.checkHasChange()}render(){const{items:e,categorySchema:t,categorySelectionCountMap:r,updateCategory:o,isLoading:i,i18n:a,closeDialog:s,isActive:l,renderItemCard:u,handleCategorySelected:d,error:p,hasUnsavedChanges:v,rootCategoryPath:g}=this,h=e.length;return(0,n.h)("calcite-modal",{key:"71ec7e054c3da93b19b7a573d216f5a8c58ccc07",open:l,onCalciteModalClose:s,scale:"m",class:"modal",outsideCloseDisabled:!0},i&&(0,n.h)("calcite-scrim",{key:"0ddcb77baa3502bec900ad5fc03829b75e6fbeee",loading:!0},a.loadingText),(0,n.h)("div",{key:"fd79c0f37085add8b807c212c1adfaa0608cce43",slot:"header"},a.modalTitle),(0,n.h)("div",{key:"1b61fafa4d16dc1f54ebe99296215943ad3e4804",slot:"content",class:"stage"},(0,n.h)("calcite-alert",{key:"6f1437819e01f066fcc7ce51297e714020e2e6f6",icon:!0,open:!!p,label:p,kind:"danger",onCalciteAlertClose:()=>this.error=null},(0,n.h)("div",{key:"546629268d7d5b478dac62a85cd50176463e95c2",slot:"message"},p)),(0,n.h)("arcgis-item-browser",{key:"53d5c901ce33b9ccd278c80e89444c480dcc1ead",fetch:async()=>({nextStart:0,num:h,results:e,start:1,total:h}),portal:this.portal,user:this.user,config:this.config,hideContentTop:!0,contentPaddedBottom:!0,hidePreviewFooters:!0,view:"list",selection:"none",num:c.a},(0,n.h)("arcgis-category-tree",{key:"8384e6ffc141459ec99d0ec6d6dec51a02d1bd07",slot:"filters",rootCategoryPath:g,categorySchema:t,categorySelectionCountMap:null!=r?r:{},total:h,onArcgisCategorizeCategorySelected:({detail:e})=>d(e)}),(0,n.h)("arcgis-item-browser-content",{key:"0054502d7901b927439c9068b778219c2a3698b8",slot:"content"},e.map((e=>u(e)))))),(0,n.h)("calcite-button",{key:"2860cedbaa096f0cf931d97f25e957fe6dee89a3",slot:"secondary",appearance:"outline","data-id":"cancelButton",onClick:s,width:"full"},a.cancel),(0,n.h)("calcite-button",{key:"9f4aaf5f3194cc2601f7cbefca53ae5f643610a5",slot:"primary",appearance:"solid","data-id":"nextButton",onClick:o,width:"full",disabled:!v},a.save))}get el(){return(0,n.d)(this)}static get watchers(){return{items:["updateInternalData"],isActive:["handleIsActiveChange"],categorySelectionCountMap:["handleCountMapChange"]}}};u.style=".stage{height:100%;overflow:hidden;--tw-translate-x:0px;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));background-color:var(--calcite-color-background)}@media screen and (min-width: 1080px){.stage{height:min(700px, 60vh)}}.modal{--calcite-modal-content-padding:0;--calcite-modal-width:1080px;z-index:900}.category-picker-container{margin-top:0.5rem}"},29259:(e,t,r)=>{r.d(t,{U:()=>n,a:()=>a,b:()=>o,g:()=>i});const n="/Categories",o=(e,t,r=!0)=>{const n=null!=e?e:"";return`${n}${n.endsWith("/")?"":"/"}${r?t.title.toLocaleLowerCase():t.title}`};function i(e){var t;let r=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return r&&"/"!==r.charAt(0)&&(r=`/${r}`),r||n}const a=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},43780:(e,t,r)=>{r.d(t,{a:()=>v,b:()=>d,c:()=>p,d:()=>h,f:()=>u,g:()=>c,u:()=>g});var n=r(46581),o=r(29259),i=r(31670),a=r(59673),s=r(59296),l=r(94788);const c=async({portal:e,user:t,group:r,useCache:n=!1})=>{var o;try{const i=await(r?d(r.id,e,n):u(e,t,n));return{result:null!==(o=null==i?void 0:i.categorySchema)&&void 0!==o?o:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function u(e,t,r=!0){if(null!=e||(e=i.c.portal),null!=t||(t=i.c.user),!(null==e?void 0:e.id)||t&&(0,s.a)(t))return null;const o=()=>(0,n.r)(`${(0,l.g)(e)}portals/${e.id}/categorySchema`);return r?(0,n.f)(o,"categorySchema",e.id):o()}async function d(e,t,r=!0){if(null!=t||(t=null===i.c||void 0===i.c?void 0:i.c.portal),!e||!t)return null;const o=()=>(0,n.r)(`${(0,a.a)(t,{id:e})}categorySchema`);return r?(0,n.f)(o,"categorySchema",e):o()}async function p(e,t,r=!0){if(null!=e||(e=i.c.portal),null!=t||(t=i.c.user),!(null==e?void 0:e.id)||t&&(0,s.a)(t))return null;const o=()=>(0,n.r)(`${(0,l.g)(e)}portals/${e.id}/memberCategorySchema`);return r?(0,n.f)(o,"memberCategorySchema",e.id):o()}async function v(e,t,r=!0){const o=()=>async function(e,t){var r;const o=(0,l.g)(e),i=(0,l.d)(e),s=await(0,n.r)(`${o}portals/self?culture=${i}`),c=await(0,n.r)(`${o}community/groups?q=${s.contentCategorySetsGroupQuery}`),u=null===(r=null==c?void 0:c.results)||void 0===r?void 0:r[0],d=(await(0,n.r)((0,a.g)(e,u),{q:`typekeywords: ${t}`})).results[0];return(0,n.r)(`${o}content/items/${d.id}/data`)}(e,t);return r?(0,n.f)(o,"categorySchema",t):o()}async function g({categories:e,itemIds:t,portal:r}){try{const o=`${(0,l.g)(r)}/content/updateItems`,i=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,n.r)(o,{items:i},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const h=async({path:e,portal:t,group:r,updateInfo:n})=>{try{const i=(await m({category:e,portal:t,group:r,num:1})).total;if(0===i)return console.warn(`No items found with category ${e} when updating schema`),{};const a=100,s=Math.ceil(i/a),l=[];for(let i=0;i<s;i++)l.push(m({category:e,portal:t,group:r,start:i*a,num:a}).then((({results:t})=>{const r={};return t.forEach((t=>{const i="change-title"===n.type?t.categories.map((t=>{const r=(0,o.a)(e,n.newTitle);return t===e?r:t.replace(`${e}/`,`${r}/`)})):t.categories.filter((t=>!t.startsWith(e)));r[t.id]=i})),r})));const c=await Promise.all(l);return await Promise.all(c.map((e=>g({categories:e,itemIds:Object.keys(e),portal:t})))),{}}catch(t){return console.error(`Error ${n.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},m=({category:e,num:t=100,start:r=0,portal:o,group:i})=>{const s={start:r,num:t,categories:JSON.stringify([e])},c=i?(0,a.g)(o,i):`${(0,l.g)(o)}search`;return(0,n.r)(c,Object.assign(Object.assign({},s),{q:i?void 0:`orgid: ${o.id}`}))}},49412:(e,t,r)=>{r.d(t,{a:()=>i,b:()=>o,i:()=>a});const n=["appExtensionError","forbiddenCredential","disabledSubscription","unauthorized","timeout","itemExists","exceedsFileSize","fileExists","emptyFile","unavailableGeocoder","dataNotAvailable","invalidShapefile","invalidFileGeodatabase","providePath","useSameFileName","invalidExtension","tokenRequired","invalidToken","invalid3DObjectFeatureClass","serviceNameInvalid","titleInvalid","titleRequired","titleInUseService","summaryInvalid","missingUserOrPortal","dataStoreTitleInvalid","serviceNameExists","folderNameExists","serviceNotExist","unsupportedWFSVersion","invalidWMTS","invalidSpatialRef","emptyFeatureLayer","invalidFeatureLayerUrl","invalidUrl","httpWarning","flowAborted","duplicateFieldNames","failToFetchText","mapServiceError","noTilingSchemeFound","noMatchSpatialRef","invalidDataStorePublishType","noRegisteredServersForDataStore","noContentInDataStore","failToPublishFromDataStore","failToListDataStoreContents","invalidUsernameOrPassword","invalidConnection","invalidCredentials","invalidBigQueryProjectId","invalidSnowflakeServer","invalidSnowflakeRole","invalidSnowflakeWarehouse","invalidSnowflakeSchema","invalidSnowflakeDatabase","invalidAWSBucket","invalidAzureContainer","invalidJSON","unknownAGSType","unhandledError","incompatibleGeometries","multiPatchRestriction","invalidUniqueIdentifier","cannotAddNullData","exceededMaxFieldLength","invalidFieldType"],o=e=>n.includes(null==e?void 0:e.code),i=e=>e&&e.hasOwnProperty("code")&&e.hasOwnProperty("message")&&e.hasOwnProperty("details")&&(!e.details||Array.isArray(e.details)),a=e=>{const t=e.toLocaleLowerCase();return t.includes("unexpected end of")||t.includes("did not match the expected pattern")}},59673:(e,t,r)=>{r.d(t,{a:()=>o,g:()=>i});var n=r(94788);const o=(e,t)=>(0,n.a)(`${(0,n.g)(e)}community/groups/${t.id}`),i=(e,t)=>`${((e,t)=>(0,n.a)(`${(0,n.g)(e)}content/groups/${t.id}`))(e,t)}search`},49038:(e,t,r)=>{r.d(t,{a:()=>p,b:()=>y,c:()=>d,f:()=>c,g:()=>u});var n=r(46581),o=r(49412),i=r(2174),a=r(94788),s=r(66488),l=r(31141);const c=async(e,t)=>{const{owningSystemUrl:r}=await(0,n.f)((async()=>(0,s.g)(e)),"portalInfo",e.id);return(await Promise.all(t.map((async e=>{try{const{owningSystemUrl:t}=await(0,s.a)(e);return{owningSystemUrl:t,url:e}}catch(t){return console.error(t),{owningSystemUrl:null,url:e}}})))).filter((({owningSystemUrl:e})=>e===r)).map((({url:e})=>e))};async function u(e,t,r){const{relationshipType:o,direction:i}=r,s=`${(0,a.g)(t)}content/items/${e}/relatedItems`;return await(0,n.r)(s,{relationshipType:o,direction:i,includeRecycleBin:!0})}const d=async(e,t)=>{try{return{result:(await(0,n.r)(`${(0,a.g)(t)}/search`,{filter:`id:(${e.join(" OR ")})`,num:100})).results}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},p=async(e,t)=>{try{const r=[],o=[],i=[];await Promise.all(e.map((async e=>{const{result:a,error:c}=await(0,n.f)((()=>(async(e,t)=>{var r;try{return{result:await(0,l.r)(e,t,{addTokenManually:!1})}}catch(e){const t="token required";return(null===(r=null==e?void 0:e.message)||void 0===r?void 0:r.toLowerCase().includes(t))?{error:{code:"tokenRequired"}}:(console.error(e),{error:{code:"unhandledError"}})}})(e,t)),"itemMetadata",`${e}--no-token`);if("tokenRequired"!==(null==c?void 0:c.code))if(v(a))r.push(g(a,e));else try{const t=await(0,s.a)(e);i.push(Object.assign(Object.assign({},a),{owningSystemUrl:t.owningSystemUrl}))}catch(c){console.warn(c)}else o.push(e)})));const a=await c(t,o),u=(await Promise.all(a.map((async e=>({response:await(0,l.r)(e,t,{addTokenManually:!0}),owningSystemUrl:(await(0,s.a)(e)).owningSystemUrl,url:e}))))).reduce(((e,{response:t,url:n,owningSystemUrl:o})=>v(t)?(r.push(g(t,n)),e):[...e,Object.assign(Object.assign({},t),{owningSystemUrl:o})]),[]),d=await Promise.all([...i,...u].map((async({serviceItemId:e,owningSystemUrl:t})=>{if(!e)return null;const{result:r}=await m({itemId:e,owningSystemUrl:t});return{item:r,owningSystemUrl:t}}))),{result:h}=r.length<=0?{result:[]}:await p(r,t);return{result:[...d.filter((e=>!!e)),...h]}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},v=e=>!!(null==e?void 0:e.sources),g=(e,t)=>{var r;const n=null===(r=Object.values(e.sources)[0])||void 0===r?void 0:r.url;return n?n.includes("..")?(0,a.t)({url:t,path:n}):n:null},h=e=>`${e}/sharing/rest`,m=async({itemId:e,owningSystemUrl:t,requestOptions:r})=>{try{const o=(0,i.g)(e,h(t));return{result:await(0,n.r)(o,{},Object.assign(Object.assign({},r),{addTokenManually:!1}))}}catch(e){return console.error(e),(0,o.a)(e)&&e.message.toLocaleLowerCase().includes("invalid token")?{error:{code:"invalidToken"}}:{error:{code:"unhandledError"}}}},y=async({itemId:e,owningSystemUrl:t,requestOptions:r})=>{try{const o=`${(0,i.g)(e,h(t))}/data`;return{result:await(0,n.r)(o,{},Object.assign(Object.assign({},r),{addTokenManually:!1}))}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}},2174:(e,t,r)=>{r.d(t,{a:()=>s,b:()=>a,c:()=>u,d:()=>d,e:()=>p,f:()=>h,g:()=>k,h:()=>m,i:()=>l,j:()=>w,k:()=>S,l:()=>y,m:()=>C,n:()=>b,o:()=>g,p:()=>f,q:()=>v,u:()=>c});var n=r(28926),o=r(94788);function i(e){var t;return!!(null===(t=e.owner)||void 0===t?void 0:t.toLowerCase().includes("esri"))}function a(e){var t;return i(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Credits"))}function s(e){var t;return i(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Subscription"))}function l(e,t){return e.owner===t.username}function c(e,t){return l(e,t)||function(e,t){var r;if(null!=e.isAdmin)return!!e.isAdmin;const n=e.owner,o="admin"===e.itemControl,i=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(r=e.portal)||void 0===r?void 0:r.isPortal)&&!l(e,t)&&o&&n.includes("esri_")&&!i.includes(n))return!1;return o}(e,t)}const u=(e,t)=>!!t.orgId&&e.every((e=>e.isOrgItem)),d=(e,t)=>`${(0,o.a)(t)}item.html?id=${e}`,p=(e,t)=>`${(0,o.g)(t)}/content/users/${e}`,v=e=>e.reduce(((e,t)=>(e[t.owner]=e[t.owner]?[...e[t.owner],t.id]:[t.id],e)),{});function g(e){var t;return null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Spatiotemporal")}function h(e){var t;return null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("View Service")}function m(e){var t;return null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Hosted Service")}function y(e){var t;return null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Multi Services View")}function f(e){return(null==e?void 0:e.hasViews)&&!e.sourceSchemaChangesAllowed}async function w(e){var t;const r=null==e?void 0:e.portalItem;if(!r)return Promise.resolve(null);const i=r.portal,[a]=await(0,n.l)(["esri/request"]);if(null==i?void 0:i.user){return a(`${(0,o.g)(i)}community/users/${i.user.username}`,{query:{f:"json",token:null===(t=r.portal.credential)||void 0===t?void 0:t.token},responseType:"json"}).then((e=>{var t,r;const n=null!==(r=null===(t=e.data)||void 0===t?void 0:t.groups)&&void 0!==r?r:[];return Promise.resolve(n)}),(()=>Promise.reject()))}return Promise.resolve(null)}async function S(e){var t;const r=null==e?void 0:e.portalItem;if(!r)return Promise.resolve(null);const i=r.portal,[a]=await(0,n.l)(["esri/request"]);return a(`${(0,o.g)(i)}content/items/${r.id}/groups`,{query:{f:"json",token:null===(t=r.portal.credential)||void 0===t?void 0:t.token},responseType:"json"}).then((e=>{var t,r,n,o,i,a;const s=[...null!==(r=null===(t=e.data)||void 0===t?void 0:t.admin)&&void 0!==r?r:[],...null!==(o=null===(n=e.data)||void 0===n?void 0:n.member)&&void 0!==o?o:[],...null!==(a=null===(i=e.data)||void 0===i?void 0:i.other)&&void 0!==a?a:[]];return Promise.resolve(s)}),(()=>Promise.reject()))}async function b(e,t,{relationshipType:r,direction:i}){const a=`${(0,o.g)(t)}content/items/${e}/relatedItems`,[s]=await(0,n.l)(["esri/request"]);return await s(a,{query:{f:"json",relationshipType:r,direction:i},method:"get",responseType:"json"})}function C(e,t){return null==e?void 0:e.some((e=>null==t?void 0:t.some((t=>e.id===t.id&&e.capabilities.includes("updateitemcontrol")))))}const k=(e,t)=>`${t}/content/items/${e}`},66488:(e,t,r)=>{r.d(t,{a:()=>p,b:()=>u,c:()=>s,d:()=>l,e:()=>v,f:()=>i,g:()=>d,h:()=>a,i:()=>g,q:()=>c});var n=r(46581),o=r(94788);function i(e){var t;return"ArcGISEnterpriseOnKubernetes"===(e.portalDeploymentType||(null===(t=e.sourceJSON)||void 0===t?void 0:t.portalDeploymentType))}function a(e){var t,r;return e.isPortal?"modern"===(null===(r=e.portalProperties)||void 0===r?void 0:r.homePage)||function(e){var t;return e.isPortal&&"modernOnly"===(null===(t=e.portalProperties)||void 0===t?void 0:t.homePage)}(e):"modern"===(null===(t=e.portalProperties)||void 0===t?void 0:t.homePage)||function(e){const t=new Date("June 30, 2020").getTime();return!e.isPortal&&e.created>=t}(e)}async function s(e){try{return{result:await(0,n.f)((()=>(0,n.r)(`${(0,o.g)(e)}portals/self/resources/home.page.json`)),"homePageConfig",e.id)}}catch(e){return{result:void 0}}}async function l(e){return(0,n.f)((()=>(0,n.r)(`${(0,o.g)(e)}portals/self/userDefaultSettings`)),"memberDefaults",e.id)}async function c(e={},t){return(0,n.r)(`${(0,o.g)(t)}/community/groups`,e)}const u=async(e,t)=>{var r;if(!e)return[];const i=`${(0,o.a)(null!==(r=t.restUrl)&&void 0!==r?r:t.portalUrl)}portals/self/servers`,a=await(0,n.f)((()=>(0,n.r)(i)),"selfServers",t.id);return null==a?void 0:a.servers},d=e=>p((0,o.c)(e)),p=e=>{var t;const r=`${(0,o.a)(null!==(t=(0,o.b)(e))&&void 0!==t?t:e)}info`;return(0,n.f)((()=>(0,n.r)(r,{},{addTokenManually:!1})),"portalInfo",r)};async function v(e,t){return!e.isPortal||await g(e,t)}async function g(e,t){if(!t||!e)return!1;if(!e.isPortal)return!0;const{result:r,error:o}=await(0,n.f)((()=>h(e,t)),"isPortalBackedBySDS",e.id);return!o&&r}const h=async(e,t)=>{if(e.isBackedBySDS)return{result:!0};if(!e.isPortal)return{result:!0};try{return{result:!!await m(t,e)}}catch(e){return console.error(e),{error:{code:"unhandledError",message:JSON.stringify(e)},result:!1}}},m=async(e,t)=>{var r;return(null!==(r=await u(e,t))&&void 0!==r?r:[]).filter((e=>e.isHosted))[0]}},59296:(e,t,r)=>{r.d(t,{a:()=>i,b:()=>v,c:()=>p,d:()=>d,e:()=>g,f:()=>m,g:()=>h,h:()=>P,i:()=>c,j:()=>l,k:()=>y,l:()=>O,m:()=>w,n:()=>S,o:()=>I,p:()=>C,q:()=>b,r:()=>k,s:()=>T,t:()=>u,u:()=>$,v:()=>a,w:()=>s});var n=r(2174);const o=e=>{var t,r,n;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(r=null!==(t=null==e?void 0:e.roleId)&&void 0!==t?t:null==e?void 0:e.id)&&void 0!==r?r:null===(n=null==e?void 0:e.sourceJSON)||void 0===n?void 0:n.id};function i(e){return e&&!e.orgId}function a(e,t){return(0,n.u)(e,t)||"update"===e.itemControl||(0,n.c)([e],t)&&p(t)}function s(e,t){const r=(0,n.c)([e],t),o=(0,n.u)(e,t)||p(t)&&r,i=g(t)&&f(t);return!!(o||r&&i)}const l=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageLicenses"))};function c(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function u(e){return["Developer Subscription"].includes(null==e?void 0:e.type)}const d=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("Developer")};function p(e){return"org_admin"===o(e)||"account_admin"===o(e)}function v(e){return["org_admin","account_admin"].includes(o(e))&&!(null==e?void 0:e.roleId)}function g(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function h(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItemCategorySchema"))}function m(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateGroups"))}function y(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:assignToGroups"))}const f=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:deleteItems"))};function w(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function S(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function b(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function C(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function k(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function I(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function P(e,t,r,n){const o=n&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(n.type),i=((null==t?void 0:t.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!t||!p(t)&&!i||!(null==r?void 0:r.isPortal)&&!o)}function $(e){return!!e&&(!g(e)||g(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const T=({items:e,user:t,portal:r})=>{const o=e[0],i=o.owner;if(r.isPortal&&i!==t.username&&i.includes("esri_")&&!["esri_livingatlas"].includes(i))return!1;const s=(0,n.u)(o,t),l=g(t),c=E(t),u=a(o,t)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(t)&&!l&&(function(e,t){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(t)||w(e)||S(e)||!!t.canSharePublic&&b(e)}(t,r)||E(t));return s||u||(0,n.c)(e,t)&&c};function E(e){return I(e)||C(e)||k(e)}function O(e){const t=["portal:user:createItem","portal:user:viewOrgItems","premium:publisher:createNotebooks","portal:publisher:createDataPipelines","features:user:edit","features:user:fullEdit","portal:admin:viewItems","portal:admin:updateItems","portal:admin:deleteItems"];return e.some((e=>t.includes(e)))}},31141:(e,t,r)=>{r.d(t,{r:()=>i});var n=r(46581),o=r(31670);const i=async(e,t,r={})=>{const{body:i,usePost:a,addTokenManually:s,api:l=(null===o.c||void 0===o.c?void 0:o.c.api),customToken:c}=r,u=new URLSearchParams;i&&Object.entries(i).forEach((([e,t])=>{void 0!==t&&u.append(e,t)}));const d=new URL(e);if(d.searchParams.append("f","json"),c)d.searchParams.append("token",c);else{const e=!1===s?null:await(0,n.g)(t,l);e&&d.searchParams.append("token",e)}const p=await fetch(d.toString(),{body:a?u:void 0,method:a?"POST":"GET"}),v=await p.json(),g=v.error;if(g)throw"string"==typeof g?new Error(g):g;return v}},80619:(e,t,r)=>{r.d(t,{I:()=>n,a:()=>o});const n=["folder","group","contentType"],o=99999}}]);