/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-96d103"],{93718:(e,t,i)=>{i.r(t),i.d(t,{arcgis_categories_picker:()=>b,arcgis_folder_picker:()=>w,arcgis_item_properties:()=>x,arcgis_summary_input:()=>F,arcgis_tags_picker:()=>C,arcgis_title_input:()=>I});var r=i(7263),o=i(43780),s=i(29259),l=i(31670),a=i(11246),n=i(62159),c=i(51325),d=i(7652),h=i(59296),u=i(58407),v=i(50852),g=i(8045),p=i(94788),m=i(46581),f=i(73596);i(59673),i(11935),i(78613),i(58233),i(28926),i(70506),i(99004),i(2174),i(65215),i(71700),i(99907),i(86537);const b=class{constructor(e){(0,r.r)(this,e),this.arcgisCategoriesPickerChange=(0,r.c)(this,"arcgisCategoriesPickerChange",7),this.renderCombobox=()=>{const{i18n:e,scale:t,schema:i,label:o}=this;return(0,r.h)("calcite-combobox",{label:null!=o?o:e.categories,maxItems:5,selectionMode:"ancestors",placeholder:e.assignCategories,scale:t,ref:e=>this.combobox=e},this.renderNestedCategories(i))},this.api=void 0,this.portal=void 0,this.scale=void 0,this.label=void 0,this.hideLabel=void 0,this.categories=void 0,this.schema=[],this.rootCategoryPath=s.U}async componentWillLoad(){var e,t,i,r;const o=await(0,n.g)(this.el);this.i18n=o[0],null!==(e=this.portal)&&void 0!==e||(this.portal=l.c.portal),null!==(t=this.scale)&&void 0!==t||(this.scale=l.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=l.c.api),null!==(r=this.categories)&&void 0!==r||(this.categories=c.i.categories),c.a.on("reset",(()=>{this.categories=c.i.categories}))}async componentDidLoad(){var e,t,i;const{portal:r,schema:l}=this;if(r&&!(null==l?void 0:l.length))if(r.categories)this.schema=null===(e=r.categories[0])||void 0===e?void 0:e.categories;else{const e=await(0,o.f)(r);this.schema=null===(i=null===(t=e.categorySchema)||void 0===t?void 0:t[0])||void 0===i?void 0:i.categories,this.rootCategoryPath=(0,s.g)(e.categorySchema)}}updateCategories(){this.arcgisCategoriesPickerChange.emit(this.categories)}categoriesPickerChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];(0,a.f)(r,this.categories)||(this.categories=r)}renderNestedCategories(e,t){return e.map((e=>{const i=t?`${t}/${e.title}`:`${this.rootCategoryPath}/${e.title}`;return(0,r.h)("calcite-combobox-item",{value:i,textLabel:e.title,selected:this.categories.some((e=>e===i||e.toLocaleLowerCase()===i.toLocaleLowerCase()))},e.categories&&this.renderNestedCategories(e.categories,i))}))}render(){const{i18n:e,scale:t,schema:i,hideLabel:o,label:s,renderCombobox:l}=this;return o?l():!!i&&(0,r.h)("calcite-label",{scale:t},(0,r.h)("p",{class:"label"},null!=s?s:e.categories),l())}get el(){return(0,r.d)(this)}static get watchers(){return{categories:["updateCategories"]}}};b.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}";const w=class{constructor(e){(0,r.r)(this,e),this.arcgisFolderPickerChange=(0,r.c)(this,"arcgisFolderPickerChange",7),this.arcgisFolderPickerLoad=(0,r.c)(this,"arcgisFolderPickerLoad",7),this.canCreateNewFolder=!1,this.capComboboxTagWidth=()=>{var e,t;const{comboboxElement:i,overlayPositioning:r}=this;if("fixed"!==r)return;const o=null!==(e=null==i?void 0:i.offsetWidth)&&void 0!==e?e:0,s=null===(t=i.shadowRoot)||void 0===t?void 0:t.querySelector(".list-container");s&&(s.style.maxWidth=`${o}px`)},this.renderItem=e=>{const{id:t,username:i,title:o}=e,{selectedFolder:s}=this,l=t===(null==s?void 0:s.id),a=(0,u.a)({folderId:t,currentUsername:i,selectedFolderId:null==s?void 0:s.id});return this.alwaysOpen?(0,r.h)("calcite-list-item",{key:t,value:t,selected:l,class:"list-item",label:o},(0,r.h)("calcite-icon",{slot:"content-start",scale:"s",icon:a})):(0,r.h)("calcite-combobox-item",{key:t,"data-id":t,value:t,textLabel:o,selected:l,icon:a})},this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.folder=void 0,this.folders=[],this.alwaysOpen=void 0,this.overlayPositioning=void 0,this.selectedFolder=void 0,this.newFolderActive=!1,this.emptyFilterList=!1,this.filterText=void 0,this.newFolderInput=void 0,this.createFolderText=void 0,this.showError=!1,this.errorString=void 0,this.newFolderInputElement=void 0,this.loading=!1,this.homeFolder=void 0}async componentWillLoad(){var e,t,i,r,o,s,a,d,u,v,g,p,m;const f=await(0,n.g)(this.el);this.i18n=f[0],null!==(e=this.portal)&&void 0!==e||(this.portal=l.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=l.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=l.c.scale),null!==(r=this.api)&&void 0!==r||(this.api=l.c.api);const b=null===(o=this.folder)||void 0===o?void 0:o.id;null!==(s=this.selectedFolder)&&void 0!==s||(this.selectedFolder=null!==(u=null!==(d=null!==(a=this.folders.find((e=>e.id===b)))&&void 0!==a?a:c.i.folder)&&void 0!==d?d:l.c.initialFolder)&&void 0!==u?u:null===(v=this.folders)||void 0===v?void 0:v[0]),this.createFolderText=this.i18n.createNewFolder,this.canCreateNewFolder=(0,h.b)(null===(g=this.portal)||void 0===g?void 0:g.user)||this.user&&(null===(p=this.portal)||void 0===p?void 0:p.user.username)===(null===(m=this.user)||void 0===m?void 0:m.username),c.a.on("reset",(()=>{var e,t,i;this.selectedFolder=null!==(t=null!==(e=c.i.folder)&&void 0!==e?e:l.c.initialFolder)&&void 0!==t?t:null===(i=this.folders)||void 0===i?void 0:i[0]}))}async componentDidLoad(){this.folders.length||await this.loadFolders(this.user),this.capComboboxTagWidth()}async handleUserChange(e,t){t&&e.username!==t.username&&(await this.loadFolders(e),this.selectedFolder=this.getHomeFolder())}handleFolderChange(){this.arcgisFolderPickerChange.emit(this.selectedFolder),this.folder=this.selectedFolder}async loadFolders(e){var t,i,r;if(this.loading=!0,this.folders=await(0,d.a)(e),this.arcgisFolderPickerLoad.emit([...this.folders]),!(null===(t=this.selectedFolder)||void 0===t?void 0:t.id)){const e=null===(i=this.folder)||void 0===i?void 0:i.id;this.selectedFolder=null!==(r=this.folders.find((t=>t.id===e)))&&void 0!==r?r:this.getHomeFolder()}this.loading=!1}getHomeFolder(){return this.folders.find((e=>e.title===e.id))}setNewFolderActive(){var e;null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),this.newFolderInputElement||(this.showError=!1,this.newFolderInput="")}checkForEmptySuggestions(e){var t,i;e.stopPropagation();const r=this.comboboxElement.shadowRoot.querySelector("input").value,{i18n:o}=this;this.emptyFilterList=(null===(t=this.comboboxElement.filteredItems)||void 0===t?void 0:t.length)<=1&&""!==r.trim(),this.createFolderText=this.emptyFilterList?o.noFoldersFoundCreate.replace("${folder}",r):o.createNewFolder,this.filterText=r,null===(i=this.createItem)||void 0===i||i.removeAttribute("hidden")}handleComboboxChange(e){var t,i,r;e.stopPropagation();const o=null===(t=this.comboboxElement)||void 0===t?void 0:t.value;if("create-folder"===o)return this.showError=!1,void(this.emptyFilterList?this.createNewFolder(this.filterText):this.newFolderActive=!0);this.selectedFolder=null!==(r=null!==(i=this.folders.find((e=>e.id===o)))&&void 0!==i?i:this.selectedFolder)&&void 0!==r?r:this.homeFolder}handleListChange(e){var t,i,r,o,s;e.stopPropagation();const l=null===(r=null===(i=null===(t=this.listElement)||void 0===t?void 0:t.selectedItems)||void 0===i?void 0:i[0])||void 0===r?void 0:r.value;this.selectedFolder=null!==(s=null!==(o=this.folders.find((e=>e.id===l)))&&void 0!==o?o:this.selectedFolder)&&void 0!==s?s:this.homeFolder}closeNewFolderInput(e){e.stopPropagation(),this.newFolderActive=!1}async saveActiveFolder(){if(!this.newFolderActive)return!0;try{await this.createNewFolder(this.newFolderInput)}catch(e){return this.errorString}return!this.showError}async setFocus(){this.comboboxElement&&(this.comboboxElement.setFocus(),this.comboboxElement.open=!0)}getFolderNameError(e){var t;const{i18n:i}=this,r=(0,u.g)(e,this.folders);return!!r&&(null===(t=i.error[r])||void 0===t?void 0:t.replace("${folder}",e))}async createNewFolder(e){var t,i;const r=(null==e?void 0:e.trim())||"",o=this.getFolderNameError(r);if(o)throw this.errorString=o,this.showError=!0,new Error;try{const{result:e}=await(0,d.c)(r,this.user);this.selectedFolder=null==e?void 0:e.folder,this.folders=[this.selectedFolder,...this.folders],l.c.folders=this.folders,this.newFolderActive=!1,this.showError=!1,await(0,a.t)(100);const o=null===(t=this.el.shadowRoot)||void 0===t?void 0:t.querySelector(`calcite-combobox-item[data-id="${null===(i=this.selectedFolder)||void 0===i?void 0:i.id}"]`);o&&(this.createItem&&(this.createItem.selected=!1),o.selected=!0)}catch(e){throw this.errorString=e.message,this.showError=!0,e}}renderError(){const{scale:e}=this;return(0,r.h)("calcite-input-message",{status:"invalid",hidden:!this.showError,icon:this.showError,scale:e},this.errorString)}renderNewFolder(){const{i18n:e,scale:t}=this;return(0,r.h)("calcite-inline-editable",{controls:!0,"editing-enabled":!0,afterConfirm:async()=>{var e;try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(t){throw null===(e=this.newFolderInputElement)||void 0===e||e.setFocus(),t}},scale:t},(0,r.h)("calcite-input",{placeholder:e.enterFolder,value:this.newFolderInput,maxLength:250,scale:t,onCalciteInputInput:e=>this.newFolderInput=e.target.value,onKeyDown:async e=>{var t;switch(e.stopPropagation(),this.showError=!1,e.key){case"Enter":try{await this.createNewFolder(this.newFolderInput),this.newFolderActive=!1}catch(e){null===(t=this.newFolderInputElement)||void 0===t||t.setFocus()}break;case"Escape":this.newFolderActive=!1,this.showError=!1}},ref:e=>this.newFolderInputElement=e,status:this.showError?"invalid":"idle"}))}renderCombobox(){var e;const{i18n:t,scale:i,overlayPositioning:o}=this;return(0,r.h)("calcite-label",{scale:i,class:"input-height"},(0,r.h)("p",{class:"label"},null!==(e=this.label)&&void 0!==e?e:t.folder),(0,r.h)("div",null,this.newFolderActive?this.renderNewFolder():(0,r.h)("div",{class:"combobox-wrapper"},this.loading&&(0,r.h)("calcite-progress",{type:"indeterminate",class:"progress"}),(0,r.h)("calcite-combobox",{label:t.folder,selectionMode:"single-persist",maxItems:5,placeholder:this.loading?t.loading:t.searchFolders,scale:i,overlayPositioning:o,ref:e=>this.comboboxElement=e,disabled:this.loading,clearDisabled:!0,onCalciteComboboxChange:e=>this.handleComboboxChange(e),onCalciteComboboxBeforeClose:()=>{var e;this.comboboxElement&&!(null===(e=this.comboboxElement.selectedItems)||void 0===e?void 0:e.length)&&(this.comboboxElement.value=this.selectedFolder.id)}},!this.loading&&(0,r.h)(r.F,null,this.user&&this.canCreateNewFolder&&(0,r.h)("calcite-combobox-item",{class:"create-folder",value:"create-folder",textLabel:this.createFolderText,selected:!1,icon:"folder-plus",filterDisabled:!0,key:"create",ref:e=>{this.createItem=e}}),this.folders.map(this.renderItem))))),this.renderError())}renderList(){const{i18n:e}=this;return(0,r.h)(r.F,null,(0,r.h)("calcite-list",{class:"list",selectionMode:"single-persist",selectionAppearance:"icon",ref:e=>this.listElement=e,onCalciteListChange:e=>{this.handleListChange(e)},filterPlaceholder:this.loading?e.loading:e.searchFolders,onCalciteListFilter:t=>{var i;const r=t.target;this.emptyFilterList=(null===(i=r.filteredItems)||void 0===i?void 0:i.length)<1,this.createFolderText=e.create.replace("${folder}",r.filterText),this.filterText=r.filterText},filterEnabled:!0},this.emptyFilterList&&(0,r.h)("div",{class:"no-folders-found"},e.noFoldersFound,this.user&&(0,r.h)("calcite-link",{class:"create-link",onClick:async()=>{this.showError=!1,await this.createNewFolder(this.filterText),this.listElement.filterText="",this.emptyFilterList=!1}},this.createFolderText)),this.folders.map(this.renderItem)),this.user&&this.canCreateNewFolder&&(0,r.h)("div",{class:"below"},this.newFolderActive?this.renderNewFolder():(0,r.h)("calcite-button",{iconStart:"folder-plus",appearance:"transparent",onClick:()=>{this.showError=!1,this.newFolderActive=!0}},e.createNewFolder),this.renderError()))}render(){return(0,r.h)(r.H,{key:"cee3e85545aa4769f71050e005cbb5697d86c6d3"},this.alwaysOpen?this.renderList():this.renderCombobox())}get el(){return(0,r.d)(this)}static get watchers(){return{user:["handleUserChange"],selectedFolder:["handleFolderChange"],newFolderInputElement:["setNewFolderActive"]}}};var y;w.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.create-folder{--calcite-color-text-1:var(--calcite-color-text-link);--calcite-color-text-3:var(--calcite-color-text-link)}.create-link{margin-left:0.25rem;margin-right:0.25rem}.combobox-wrapper{position:relative}.progress{position:absolute;top:0px;z-index:1}.below{margin-top:1.25rem}.list{max-height:15rem;overflow:auto;--tw-shadow:0 2px 12px -4px rgba(0, 0, 0, 0.2), 0 2px 4px -2px rgba(0, 0, 0, 0.16);--tw-shadow-colored:0 2px 12px -4px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.list-item{min-width:0px;max-width:100%;text-overflow:ellipsis}.no-folders-found{padding-top:0.5rem;padding-bottom:0.5rem;padding-left:3.5rem;padding-right:3.5rem;font-size:0.75rem;color:var(--calcite-color-text-1)}",function(e){e.arcgisTitleInputChange="title",e.arcgisFolderPickerChange="folder",e.arcgisSummaryInputChange="snippet",e.arcgisTagsPickerChange="tags",e.arcgisCategoriesPickerChange="categories"}(y||(y={}));const x=class{constructor(e){(0,r.r)(this,e),this.arcgisItemPropertiesChange=(0,r.c)(this,"arcgisItemPropertiesChange",7),this.portal=void 0,this.user=void 0,this.api=void 0,this.config=void 0,this.itemId=void 0,this.type=void 0,this.scale=void 0,this.resetStoreOnUnmount=!0}async resetItemPropertiesStore(){c.a.reset()}handleItemPropertiesChange(e){const{detail:t,type:i}=e;c.i[y[i]]=t,this.arcgisItemPropertiesChange.emit(Object.assign({},c.i))}async componentWillLoad(){var e,t;this.portal&&(l.c.portal=this.portal),this.user&&(l.c.user=this.user),this.api&&(l.c.api=this.api),this.config&&(l.c.config=this.config),this.itemId&&({result:c.i.item}=await(0,v.a)(this.itemId,this.portal)),this.type&&(c.i.type=null!==(e=this.type)&&void 0!==e?e:null===(t=c.i.item)||void 0===t?void 0:t.type),this.scale&&(l.c.scale=this.scale)}render(){return(0,r.h)(r.H,{key:"7bed31514246cec07a8d05ba624446f2757d3ce9"},(0,r.h)("slot",{key:"4dbcfafb3368c5f0976ead0530e1751192cf810d"}))}disconnectedCallback(){this.resetStoreOnUnmount&&c.a.reset()}get el(){return(0,r.d)(this)}},F=class{constructor(e){(0,r.r)(this,e),this.arcgisSummaryInputChange=(0,r.c)(this,"arcgisSummaryInputChange",7),this.updateLiveRegion=(0,a.d)((e=>{this.liveRegionText=this.getCharactersText(e)}),1500),this.scale=void 0,this.label=void 0,this.summary=void 0,this.liveRegionText=void 0,this.valid=!0}async getErrorMessage(){return this.valid?null:{code:"summaryInvalid",translatedMessage:this.i18n.invalid}}async componentWillLoad(){var e,t;const i=await(0,n.g)(this.el);this.i18n=i[0],null!==(e=this.scale)&&void 0!==e||(this.scale=l.c.scale),null!==(t=this.summary)&&void 0!==t||(this.summary=c.i.snippet),this.liveRegionText=this.getCharactersText(this.summary),c.a.on("reset",(()=>{this.summary=c.i.snippet}))}componentDidRender(){var e,t,i;const r=null===(i=null===(t=null===(e=this.el.shadowRoot)||void 0===e?void 0:e.querySelector("calcite-input"))||void 0===t?void 0:t.shadowRoot)||void 0===i?void 0:i.querySelector("textarea");r&&(r.style.resize="vertical")}getCharactersText(e){return this.i18n.charactersLeft.replace("${num}",""+(2048-e.length))}validate(){this.valid=!/>|</.test(this.summary)}render(){const{i18n:e,summary:t,label:i,scale:o,liveRegionText:s,valid:l}=this;return(0,r.h)("div",{key:"3334c11abae325561f1ba479aa6b99a28b3ca583",class:`container-${o}`},(0,r.h)("calcite-label",{key:"ce5743c0697d9979b5c6fe2a1ba2a9a51981e82d",scale:o,class:"label"},(0,r.h)("p",{key:"10c3097a97c3cb57e8a4b3b2901a8a15d80e3cd9",class:"label-text"},null!=i?i:e.summary),(0,r.h)("calcite-input",{key:"f93e9139a1a743876593b1391b1b6172ff564428",type:"textarea",id:"summary-input",placeholder:e.addSummary,value:t,maxLength:2048,scale:o,status:l?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation();const t=e.target;this.summary=t.value,this.arcgisSummaryInputChange.emit(this.summary),this.updateLiveRegion(t.value),this.validate()}}),(0,r.h)("calcite-input-message",{key:"698acb0f13f3dfbf8a745b4a42311670181c8be4",hidden:l,icon:!0,scale:o,status:l?"idle":"invalid"},e.invalid),(0,r.h)("span",{key:"77adb3446fa6da75bf7e38b4a94c6c4d5438b587",class:"screen-readers-only","aria-live":"polite"},s)),l&&(0,r.h)("span",{key:"487e3ec36a6d47f183acddbaf9fa07b0c88f5101",class:"count","aria-hidden":"true"},this.getCharactersText(t)))}get el(){return(0,r.d)(this)}};F.style=":host{--arcgis-label-margin-bottom:1rem}.container-s{margin-bottom:0.5rem}.container-m{margin-bottom:0.75rem}.container-l{margin-bottom:1rem}.label{--calcite-label-margin-bottom:0}.label-text{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}.count{font-size:0.75rem;color:var(--calcite-color-text-1);opacity:0.75}.screen-readers-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";async function T(e){null!=e||(e=l.c.user);const t=e.url+"/tags";try{return(await(0,m.r)(t)).tags}catch(e){console.error(e)}}const C=class{constructor(e){(0,r.r)(this,e),this.arcgisTagsPickerChange=(0,r.c)(this,"arcgisTagsPickerChange",7),this.isTag=e=>void 0!==e.tag&&void 0!==e.count,this.controlledTags=[],this.mapItemValue=e=>e.map((e=>e.value)),this.handleKeydown=e=>{var t;if(","===e.key){const i=e.target,r=null===(t=null==i?void 0:i.shadowRoot)||void 0===t?void 0:t.querySelector("input");if(null==r?void 0:r.value){e.preventDefault();const t=r.value.trim(),o=i.querySelector(`calcite-combobox-item[text-label="${t}"]`);if(o)o.selected=!0;else{const e=document.createElement("calcite-combobox-item");e.value=t,e.textLabel=t,e.selected=!0,null==i||i.appendChild(e)}r.value="";const s=new InputEvent("input",{data:""});r.dispatchEvent(s)}}},this.api=void 0,this.user=void 0,this.scale=void 0,this.activeTags=void 0,this.knownTags=[],this.label=void 0,this.placeholder=void 0,this.hideLabel=void 0}async componentWillLoad(){var e,t,i,r,o,s;const a=await(0,n.g)(this.el);this.i18n=a[0],null!==(e=this.user)&&void 0!==e||(this.user=l.c.user),null!==(t=this.scale)&&void 0!==t||(this.scale=l.c.scale),null!==(i=this.api)&&void 0!==i||(this.api=l.c.api),null!==(r=this.activeTags)&&void 0!==r||(this.activeTags=c.i.tags),this.activeTags=(0,g.f)(this.activeTags),this.knownTags=(0,g.f)([...null!==(o=this.knownTags)&&void 0!==o?o:[],...null!==(s=this.activeTags)&&void 0!==s?s:[]]),c.a.on("reset",(()=>{this.activeTags=c.i.tags}))}async componentDidLoad(){var e,t,i;const{user:r}=this;if(r){const o=null!==(e=r.contentTags)&&void 0!==e?e:r.tags;!(null==o?void 0:o.length)||(null==o?void 0:o.length)>0&&!this.isTag(o[0])?this.knownTags=[...this.knownTags,...(await T(r)).map((e=>e.tag))]:this.knownTags=[...this.knownTags,...o.map((e=>e.tag))],this.knownTags=(0,g.f)([...null!==(t=this.activeTags)&&void 0!==t?t:[],...null!==(i=this.knownTags)&&void 0!==i?i:[]])}}itemPropertiesTagsChangeHandler(e){var t;e.stopPropagation();const i=(null===(t=this.combobox)||void 0===t?void 0:t.value)||[],r=Array.isArray(i)?i:[i];this.arcgisTagsPickerChange.emit((0,g.f)(r));const o=Array.from(this.combobox.children),s=this.combobox.selectedItems;o.forEach((e=>{this.controlledTags.includes(e.value)||e.remove()})),this.knownTags=this.mapItemValue(o),this.activeTags=this.mapItemValue(s)}renderFormattedTags(){const{i18n:e,scale:t,handleKeydown:i,placeholder:o}=this;this.knownTags.forEach((e=>{this.controlledTags.includes(e)||this.controlledTags.push(e)}));const s=this.knownTags.map((e=>{var t;return(0,r.h)("calcite-combobox-item",{key:e,value:e,textLabel:e.length>36?`${e.slice(0,36)}...`:e,selected:(null===(t=this.activeTags)||void 0===t?void 0:t.indexOf(e))>=0})}));return(0,r.h)("calcite-combobox",{label:e.tags,maxItems:5,"allow-custom-values":!0,placeholder:null!=o?o:e.addTags,scale:t,onKeyDown:i,ref:e=>this.combobox=e},s)}async setFocus(){var e;null===(e=this.combobox)||void 0===e||e.setFocus()}render(){const{i18n:e,scale:t,hideLabel:i,label:o}=this;return(0,r.h)("calcite-label",{key:"7ffd4db86961d71fd7512eab3f1cb8689e2883f7",scale:t},(0,r.h)("p",{key:"7bf1e11d153cbb8947ec460db9c7c265d07b2c9e",class:{label:!0,"screen-reader-only":i}},null!=o?o:e.tags),this.renderFormattedTags())}get el(){return(0,r.d)(this)}};C.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}.screen-reader-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}";const I=class{constructor(e){(0,r.r)(this,e),this.arcgisTitleInputChange=(0,r.c)(this,"arcgisTitleInputChange",7),this.arcgisTitleInputValidation=(0,r.c)(this,"arcgisTitleInputValidation",7),this.debouncedInput=(0,a.d)((()=>this.handleTitleValidation()),400),this.api=void 0,this.portal=void 0,this.user=void 0,this.scale=void 0,this.label=void 0,this.itemTitle=void 0,this.currentFolder=void 0,this.type=void 0,this.update=!1,this.enablePublishing=void 0,this.titleError=void 0}async focusMainInput(){var e,t;null===(t=(e=this.mainInputRef).setFocus)||void 0===t||t.call(e)}async validateTitle(){return this.debouncedInput.invoke()}async handleTitleValidation(){const{type:e,itemTitle:t,enablePublishing:i,portal:r,user:o,update:s}=this,{extension:l}=(0,f.a)(t);if(e)return this.titleError=await async function({portal:e,user:t,title:i,itemType:r,folder:o,extension:s,enablePublishing:l=!1,update:a=!1}){if(!t||!e)return{code:"missingUserOrPortal"};if(!i||i.trim().length<=0)return{code:"titleRequired"};if("Data Store"===r&&(/[\s.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"dataStoreTitleInvalid"};if(!l&&(/<|>/gi.test(i)||i.length>250))return{code:"titleInvalid"};if(l&&(/[.@~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/g.test(i)||i.length>90))return{code:"serviceNameInvalid"};const n=l?function(e){switch(e){case"CSV":case"Microsoft Excel":case"GeoJson":case"Shapefile":case"File Geodatabase":case"Image Collection":case"GeoPackage":case"Service Definition":case"Feature Collection":return"Feature Service";case"Tile Package":return"Map Service";case"Vector Tile Package":return"Vector Tile Service";case"Scene Package":return"Scene Service";case"3DTiles Package":return"3DTiles Service"}return e}(r):r,{itemURLList:c}=await(0,v.s)(i,n,o,s,t,e)||{};if(c&&!a)return{code:"itemExists",itemUrl:c[0]};if(l){const t=await(0,m.r)(`${(0,p.g)(e)}portals/${e.id}/isServiceNameAvailable`,{name:i.replace(/\s/g,"_"),type:n});if(!(null==t?void 0:t.available))return{code:"titleInUseService",layerName:i}}return null}({portal:r,user:o,title:t,itemType:e,folder:this.currentFolder,extension:l,enablePublishing:i,update:s}),this.arcgisTitleInputValidation.emit({valid:!this.titleError}),this.getErrorMessage();console.error("No item type found. Skipping title validation")}getErrorMessage(){const{itemTitle:e,titleError:t,i18n:i}=this;return e||(this.titleError={code:"titleRequired",translatedMessage:this.i18n.validation.titleRequired}),t&&(t.translatedMessage=i.validation[this.titleError.code].replace("${name}",e)),t}async componentWillLoad(){var e,t,i,r,o,s,a;const d=await(0,n.g)(this.el);this.i18n=d[0],null!==(e=this.portal)&&void 0!==e||(this.portal=l.c.portal),null!==(t=this.user)&&void 0!==t||(this.user=l.c.user),null!==(i=this.scale)&&void 0!==i||(this.scale=l.c.scale),null!==(r=this.api)&&void 0!==r||(this.api=l.c.api),null!==(o=this.type)&&void 0!==o||(this.type=c.i.type),null!==(s=this.itemTitle)&&void 0!==s||(this.itemTitle=c.i.title),null!==(a=this.currentFolder)&&void 0!==a||(this.currentFolder=c.i.folder),this.itemTitle&&this.handleTitleValidation(),c.i.title=this.itemTitle,c.a.on("reset",(()=>{this.itemTitle=c.i.title}))}render(){var e;const{i18n:t,itemTitle:i,scale:o}=this,{translatedMessage:s,code:l}=this.titleError||{},a=!s;return(0,r.h)("calcite-label",{key:"83ad9032cfb103252fb51a865a27057b5594f9ad",scale:o},(0,r.h)("p",{key:"0456b31fc8e90b7e10657ec55501018b950efd8e",class:"label"},null!==(e=this.label)&&void 0!==e?e:t.title),(0,r.h)("calcite-input",{key:"16d613837aa50acc04c051b6474824491a9eabb3",id:"item-properties-title",placeholder:t.addTitle,value:i,scale:o,onInput:this.debouncedInput,max:250,ref:e=>this.mainInputRef=e,status:a?"idle":"invalid",onCalciteInputInput:e=>{e.stopPropagation(),this.itemTitle=e.target.value,this.arcgisTitleInputChange.emit(this.itemTitle)}}),(0,r.h)("calcite-input-message",{key:"3ef7b01d166222f21e70e3686f48b7e2cc289f78",icon:!0,hidden:a,status:a?"idle":"invalid"},s||t[l]||t.title))}get el(){return(0,r.d)(this)}static get watchers(){return{currentFolder:["handleTitleValidation"]}}};I.style=".label{margin-top:0px;margin-bottom:0px;font-weight:var(--arcgis-label-font-weight, 400)}calcite-input{--calcite-color-border-1:var(--calcite-color-border-input)}"},29259:(e,t,i)=>{i.d(t,{U:()=>r,a:()=>l,b:()=>o,g:()=>s});const r="/Categories",o=(e,t,i=!0)=>{const r=null!=e?e:"";return`${r}${r.endsWith("/")?"":"/"}${i?t.title.toLocaleLowerCase():t.title}`};function s(e){var t;let i=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return i&&"/"!==i.charAt(0)&&(i=`/${i}`),i||r}const l=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},43780:(e,t,i)=>{i.d(t,{a:()=>v,b:()=>h,c:()=>u,d:()=>p,f:()=>d,g:()=>c,u:()=>g});var r=i(46581),o=i(29259),s=i(31670),l=i(59673),a=i(59296),n=i(94788);const c=async({portal:e,user:t,group:i,useCache:r=!1})=>{var o;try{const s=await(i?h(i.id,e,r):d(e,t,r));return{result:null!==(o=null==s?void 0:s.categorySchema)&&void 0!==o?o:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function d(e,t,i=!0){if(null!=e||(e=s.c.portal),null!=t||(t=s.c.user),!(null==e?void 0:e.id)||t&&(0,a.a)(t))return null;const o=()=>(0,r.r)(`${(0,n.g)(e)}portals/${e.id}/categorySchema`);return i?(0,r.f)(o,"categorySchema",e.id):o()}async function h(e,t,i=!0){if(null!=t||(t=null===s.c||void 0===s.c?void 0:s.c.portal),!e||!t)return null;const o=()=>(0,r.r)(`${(0,l.a)(t,{id:e})}categorySchema`);return i?(0,r.f)(o,"categorySchema",e):o()}async function u(e,t,i=!0){if(null!=e||(e=s.c.portal),null!=t||(t=s.c.user),!(null==e?void 0:e.id)||t&&(0,a.a)(t))return null;const o=()=>(0,r.r)(`${(0,n.g)(e)}portals/${e.id}/memberCategorySchema`);return i?(0,r.f)(o,"memberCategorySchema",e.id):o()}async function v(e,t,i=!0){const o=()=>async function(e,t){var i;const o=(0,n.g)(e),s=(0,n.d)(e),a=await(0,r.r)(`${o}portals/self?culture=${s}`),c=await(0,r.r)(`${o}community/groups?q=${a.contentCategorySetsGroupQuery}`),d=null===(i=null==c?void 0:c.results)||void 0===i?void 0:i[0],h=(await(0,r.r)((0,l.g)(e,d),{q:`typekeywords: ${t}`})).results[0];return(0,r.r)(`${o}content/items/${h.id}/data`)}(e,t);return i?(0,r.f)(o,"categorySchema",t):o()}async function g({categories:e,itemIds:t,portal:i}){try{const o=`${(0,n.g)(i)}/content/updateItems`,s=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,r.r)(o,{items:s},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const p=async({path:e,portal:t,group:i,updateInfo:r})=>{try{const s=(await m({category:e,portal:t,group:i,num:1})).total;if(0===s)return console.warn(`No items found with category ${e} when updating schema`),{};const l=100,a=Math.ceil(s/l),n=[];for(let s=0;s<a;s++)n.push(m({category:e,portal:t,group:i,start:s*l,num:l}).then((({results:t})=>{const i={};return t.forEach((t=>{const s="change-title"===r.type?t.categories.map((t=>{const i=(0,o.a)(e,r.newTitle);return t===e?i:t.replace(`${e}/`,`${i}/`)})):t.categories.filter((t=>!t.startsWith(e)));i[t.id]=s})),i})));const c=await Promise.all(n);return await Promise.all(c.map((e=>g({categories:e,itemIds:Object.keys(e),portal:t})))),{}}catch(t){return console.error(`Error ${r.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},m=({category:e,num:t=100,start:i=0,portal:o,group:s})=>{const a={start:i,num:t,categories:JSON.stringify([e])},c=s?(0,l.g)(o,s):`${(0,n.g)(o)}search`;return(0,r.r)(c,Object.assign(Object.assign({},a),{q:s?void 0:`orgid: ${o.id}`}))}},73596:(e,t,i)=>{i.d(t,{a:()=>s,f:()=>c,g:()=>n,s:()=>l,v:()=>a});var r=i(86537),o=i(46227);function s(e,t){const i=/(?:\.([^.]+))?$/;let r=null==e?void 0:e.replace(/^.*(\\|\/|:)/,""),s=r&&i.exec(r)[1]?i.exec(r)[1].toLowerCase():"",l="";if(r.indexOf(".rft.")>-1){const[e,t]=r.split(".rft.");s=`rft.${t}`,l=e}return r&&!l&&(l=-1===r.lastIndexOf(".")?r:r.substring(0,r.lastIndexOf("."))),l=l.replace(/\.|-/g,"_"),t&&(l=function(e){return`${e}_${(0,o.g)()}`}(l),r=`${l}.${s}`),{title:l,fileName:r,extension:s}}function l(e,t){return s(e.name,!!t)}function a(e,t){let i=e;const r=e.lastIndexOf("\\");return r>-1&&(i=i.substring(r+1,i.length)),i.replace(/\ /g,"_")===t.replace(/\ /g,"_")}function n(e){return r.a[e]?r.a[e]:r.a[Object.keys(r.a).find((t=>r.a[t].type===e))]}function c(e){if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${Math.round(e/Math.pow(1024,t))} ${["B","KB","MB","GB","TB"][t]}`}},59673:(e,t,i)=>{i.d(t,{a:()=>o,g:()=>s});var r=i(94788);const o=(e,t)=>(0,r.a)(`${(0,r.g)(e)}community/groups/${t.id}`),s=(e,t)=>`${((e,t)=>(0,r.a)(`${(0,r.g)(e)}content/groups/${t.id}`))(e,t)}search`},46227:(e,t,i)=>{i.d(t,{g:()=>r});const r=()=>[2,1,1,1,3].map((e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t})).join("-")},59296:(e,t,i)=>{i.d(t,{a:()=>s,b:()=>v,c:()=>u,d:()=>h,e:()=>g,f:()=>m,g:()=>p,h:()=>I,i:()=>c,j:()=>n,k:()=>f,l:()=>$,m:()=>w,n:()=>y,o:()=>C,p:()=>F,q:()=>x,r:()=>T,s:()=>E,t:()=>d,u:()=>k,v:()=>l,w:()=>a});var r=i(2174);const o=e=>{var t,i,r;return"string"==typeof(null==e?void 0:e.role)&&(null==e?void 0:e.role)?null==e?void 0:e.role:null!==(i=null!==(t=null==e?void 0:e.roleId)&&void 0!==t?t:null==e?void 0:e.id)&&void 0!==i?i:null===(r=null==e?void 0:e.sourceJSON)||void 0===r?void 0:r.id};function s(e){return e&&!e.orgId}function l(e,t){return(0,r.u)(e,t)||"update"===e.itemControl||(0,r.c)([e],t)&&u(t)}function a(e,t){const i=(0,r.c)([e],t),o=(0,r.u)(e,t)||u(t)&&i,s=g(t)&&b(t);return!!(o||i&&s)}const n=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:manageLicenses"))};function c(e){return["Trial Developer","Developer","Developer Subscription"].includes(null==e?void 0:e.type)}function d(e){return["Developer Subscription"].includes(null==e?void 0:e.type)}const h=e=>{var t;return null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.includes("Developer")};function u(e){return"org_admin"===o(e)||"account_admin"===o(e)}function v(e){return["org_admin","account_admin"].includes(o(e))&&!(null==e?void 0:e.roleId)}function g(e){return!!(null==e?void 0:e.roleId)&&e.roleId.length>0}function p(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItemCategorySchema"))}function m(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:updateGroups"))}function f(e){var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:assignToGroups"))}const b=e=>{var t;return!!(null===(t=null==e?void 0:e.privileges)||void 0===t?void 0:t.includes("portal:admin:deleteItems"))};function w(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToGroup")}function y(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToOrg")}function x(e){return((null==e?void 0:e.privileges)||[]).includes("portal:user:shareToPublic")}function F(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToOrg")}function T(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToPublic")}function C(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:shareToGroup")}function I(e,t,i,r){const o=r&&!["Trial","Trial Press","Trial Developer","Developer Subscription","Evaluation"].includes(r.type),s=((null==t?void 0:t.privileges)||[]).includes("portal:admin:manageCollaborations");return!(!(null==e?void 0:e.collaborationsEnabled)||!t||!u(t)&&!s||!(null==i?void 0:i.isPortal)&&!o)}function k(e){return!!e&&(!g(e)||g(e)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:viewItems")}(e))}const E=({items:e,user:t,portal:i})=>{const o=e[0],s=o.owner;if(i.isPortal&&s!==t.username&&s.includes("esri_")&&!["esri_livingatlas"].includes(s))return!1;const a=(0,r.u)(o,t),n=g(t),c=P(t),d=l(o,t)&&function(e){return((null==e?void 0:e.privileges)||[]).includes("portal:admin:updateItems")}(t)&&!n&&(function(e,t){return!function(e){return!(!e.urlKey||!e.customBaseUrl)||!!e.isPortal}(t)||w(e)||y(e)||!!t.canSharePublic&&x(e)}(t,i)||P(t));return a||d||(0,r.c)(e,t)&&c};function P(e){return C(e)||F(e)||T(e)}function $(e){const t=["portal:user:createItem","portal:user:viewOrgItems","premium:publisher:createNotebooks","portal:publisher:createDataPipelines","features:user:edit","features:user:fullEdit","portal:admin:viewItems","portal:admin:updateItems","portal:admin:deleteItems"];return e.some((e=>t.includes(e)))}},58407:(e,t,i)=>{function r(e,t){return e&&0!==e.trim().length?function(e,t){return null==t?void 0:t.some((t=>t.title===e))}(e,t)?"folderAlreadyExists":!(!e.includes(">")&&!e.includes("<"))&&"invalidCharacters":"noName"}function o(e){const{folderId:t,currentUsername:i,selectedFolderId:r}=e;switch(t){case"all":return"folders";case i:return"home";case"recycle":return"recycle-bin";default:return t===r?"folder-open":"folder"}}i.d(t,{a:()=>o,g:()=>r})}}]);