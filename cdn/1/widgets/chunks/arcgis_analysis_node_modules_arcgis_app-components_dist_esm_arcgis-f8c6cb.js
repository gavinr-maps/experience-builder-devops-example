/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb"],{99004:(e,t,a)=>{a.d(t,{c:()=>i,g:()=>s});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self?self:{};function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},34815:(e,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_pages_data_store_database_credentials:()=>u});var i=a(7263),s=a(31670),r=a(73596),n=a(82752),o=a(71700),c=a(99907),l=a(79468),d=a(51325),h=a(48218);a(11935),a(86537),a(94788),a(31141),a(46581),a(28926),a(70506),a(99004),a(65215),a(50852),a(7652),a(2174),a(39274),a(49712),a(90079),a(57399),a(66488),a(67575),a(15437),a(91253),a(43780),a(59673),a(59296);const u=class{constructor(e){(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.handleFileInputChange=e=>{this.processFile(e.target.files[0])},this.authenticationType="serviceAuthentication",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.refreshToken=void 0,this.keyFileContents=void 0,this.projectId=void 0,this.defaultDataset=void 0,this.server=void 0,this.user=void 0,this.password=void 0,this.role=void 0,this.database=void 0,this.schema=void 0,this.warehouse=void 0,this.validJson=!0,this.invalidLogin=!1,this.emptyFieldsExist=!1,this.keyFileName=void 0,this.error=void 0}async handleNext(){o.a.authenticationType=this.authenticationType,o.a.refreshToken=this.refreshToken,o.a.projectID=this.projectId,o.a.defaultDataset=this.defaultDataset,o.a.snowflakeServer=this.server,o.a.snowflakeUsername=this.user,o.a.snowflakePassword=this.password,o.a.role=this.role,o.a.database=this.database,o.a.schema=this.schema,o.a.warehouse=this.warehouse,this.checkValidFields()?(o.a.databaseConnectionPath=this.createDatabaseConnectionPath(),await this.validateConnection()):this.handleError({code:"unhandledError"})}async componentWillLoad(){this.dataStoreConnectionType=o.a.databaseProvider,this.i18n=c.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{projectId:e,keyFileName:t,server:a,database:i,schema:s,warehouse:r,role:n,user:o,password:c,dataStoreConnectionType:l}=this,d="snowflake"===l?[a,i,s,r,n,o,c]:[t,e];return this.emptyFieldsExist=d.some((e=>!e)),!this.emptyFieldsExist}populateFields(){var e;this.server=o.a.snowflakeServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=o.a.authenticationType),this.projectId=o.a.projectID,this.defaultDataset=o.a.defaultDataset,this.role=o.a.role,this.database=o.a.database,this.schema=o.a.schema,this.warehouse=o.a.warehouse}createDatabaseConnectionPath(){const{dataStoreConnectionType:e,authenticationType:t,projectId:a,defaultDataset:i,server:s,user:r,role:n,database:c,schema:l,warehouse:d}=this;let h;switch(e){case"bigQuery":h=`${this.i18n.bigQuery}/${"serviceAuthentication"===t?this.i18n.serviceAuthentication:this.i18n.userAuthentication}/${a}/${i}`;break;case"snowflake":h=`${s}/${r}/${n}/${c}/${l}/${d}`}return o.a.databaseConnectionPath=h,h}async validateConnection(){const{dataStoreConnectionType:e,projectId:t,defaultDataset:a,keyFileContents:i,refreshToken:r,user:c,password:u,database:f,role:p,server:b,warehouse:v,schema:m}=this;let y;const{orgId:k}=s.c.user;this.invalidLogin=!1,this.loading=!0,this.loaderMessage=this.i18n.validating;const g=i||"",w=r||"";if("bigQuery"===e){const e=await(0,l.l)(t,a,g,w);if(null==e?void 0:e.error)return"invalidJSON"===e.error.code&&(this.validJson=!1),void this.handleError({code:e.error.code});y=e.result,o.a.jdbcConnection=Object.assign({},y.info.JDBCConnection)}else y=(0,l.m)({user:c,password:u,database:f,role:p,server:b,warehouse:v,schema:m}),o.a.jdbcConnection=Object.assign({},y.info.JDBCConnection),o.a.typeKeywords=[...o.a.typeKeywords,"CDW","snowflake"];const I="bigQuery"===e?t:f;d.i.title=(0,h.f)(e,I);const{result:F,error:x}=await(0,n.v)(k,s.c.portal,y);"success"===(null==F?void 0:F.status)?this.newItemUpdatePage.emit("itemProperties"):this.handleError({code:x.code})}processFile(e){if(!e)return;const{extension:t,fileName:a}=(0,r.s)(e);if(this.keyFileName=a,"json"!==t)return void(this.validJson=!1);this.validJson=!0;const i=new FileReader;i.onload=e=>{this.keyFileContents=String(e.target.result)},i.readAsText(e)}trimInput(e){return e.trim()}handleError(e){this.loading=!1;let t=this.i18n.errors.validationFailedTitle,a=this.i18n.errors.invalidConnection;switch(e.code){case"invalidJSON":t=c.u.i18n.itemProperties.invalidJSON.title,a=c.u.i18n.itemProperties.invalidJSON.description;break;case"invalidUsernameOrPassword":this.invalidLogin=!0;break;case"invalidSnowflakeServer":case"invalidSnowflakeWarehouse":case"invalidSnowflakeDatabase":case"invalidSnowflakeSchema":case"invalidSnowflakeRole":case"invalidBigQueryProjectId":case"invalidCredentials":a=this.i18n.errors[e.code]}this.error={title:t,description:a}}render(){const{dataStoreConnectionType:e,i18n:t,server:a,authenticationType:s,projectId:r,defaultDataset:n,role:o,database:c,schema:l,warehouse:d,validJson:h,error:u,invalidLogin:f}=this;return(0,i.h)("div",{key:"b2a95631719dd818e865f99d8492e8a58dc805e6"},(0,i.h)("arcgis-new-item-loader",{key:"b8dbfa719de9c7aaa3b24ee48a5958a351322592",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,i.h)("arcgis-new-item-description",{key:"058db2fd3948ef70ebb8550f2a42dbdc73db7f24",class:"header",header:t.dataStoreConnection,content:"bigQuery"===e?t.bigQuery:t.snowflake}),(0,i.h)("div",{key:"b6f26b548b761902c6e07bd424a097c14604d441",class:"configure-form"},"snowflake"===e&&(0,i.h)("calcite-label",{key:"083b250641d5389045397749a72903d200daa234",class:"field"},t.server,(0,i.h)("calcite-input",{key:"530e9ba8e47e43c285c53a7988d426742a0ed720",placeholder:"server_name.com",value:a,onInput:e=>{this.server=this.trimInput(e.target.value)},required:!0}),!this.server&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"89943881421da506a5c49fdce11f85fca01f7da0",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noServer)),(0,i.h)("calcite-label",{key:"d86806a916ecbd42dcc22e48a18cef9cf6476bec",class:"field"},t.authenticationType,(0,i.h)("calcite-select",{key:"c2c575c3eb47230ef50653558876740cc7532328",value:s,label:"authentication-type",disabled:!0,onCalciteSelectChange:e=>{this.authenticationType=e.target.selectedOption.value}},"bigQuery"===e?(0,i.h)("calcite-option",{value:"serviceAuthentication"},t.serviceAuthentication):(0,i.h)("calcite-option",{value:"userAuthentication"},t.userAuthentication))),"bigQuery"===e&&(0,i.h)("div",{key:"ddda7132f4704d918fbe4b97f4244f417558c965",class:"configureBigQuery"},"serviceAuthentication"===s?(0,i.h)("calcite-label",{class:"field keyFileInput"},t.keyFile,(0,i.h)("calcite-input",{status:!h||!this.keyFileName&&this.emptyFieldsExist?"invalid":"valid","read-only":!0,value:this.keyFileName,required:!0},(0,i.h)("calcite-button",{"icon-start":"folder",slot:"action",kind:"neutral",appearance:"outline",onClick:()=>{var e;return null===(e=this.inputFileElement)||void 0===e?void 0:e.click()}},t.selectKeyFile)),(0,i.h)("input",{class:"hidden",type:"file",id:"snowflake-key-file",accept:".json",onChange:this.handleFileInputChange,ref:e=>this.inputFileElement=e}),(0,i.h)("calcite-input-message",{icon:!h||!this.keyFileName&&this.emptyFieldsExist?"exclamation-mark-triangle":"information",status:!h||!this.keyFileName&&this.emptyFieldsExist?"invalid":"idle"},!this.keyFileName&&this.emptyFieldsExist?t.errors.noKeyFile:h?t.jsonOnly:t.notJson)):(0,i.h)("calcite-label",{class:"field refreshTokenInput"},t.refreshToken,(0,i.h)("calcite-input",{type:"password",status:"valid",onInput:e=>{this.refreshToken=e.target.value}})),(0,i.h)("calcite-label",{key:"55d19c139ccaed11569f3a1aaab7a2224649b911",class:"field"},t.projectId,(0,i.h)("calcite-input",{key:"9d06ad42b08221176eea93b7d313095d06886c7d",value:r,onInput:e=>{this.projectId=this.trimInput(e.target.value)},required:!0}),!this.projectId&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"75b74a331cf708414f582da3ba77e3ed59be6b6d",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noProjectId)),"userAuthentication"===s&&(0,i.h)("calcite-label",{key:"51ddfe4e5077ed144221b3866d627fadb7d5343a",class:"field"},t.defaultDataset,(0,i.h)("calcite-input",{key:"16f9fca0f6f3c3b7cfeeb2d3126cbdcef610cac4",value:n,onInput:e=>{this.defaultDataset=this.trimInput(e.target.value)}}))),"snowflake"===e&&(0,i.h)("div",{key:"19fbe106129932633fa21418ef894059c59042ea",class:"configureSnowflake"},(0,i.h)("div",{key:"483f49a1f0a53d3776e290cd0b5ce3f3f5f4a536",class:"field fill-credentials"},(0,i.h)("calcite-label",{key:"653a18e928a94e57b4b4cabe8d85c32eaa9ba8eb",class:"credentials"},(0,i.h)("div",{key:"7a64b2d7f1f40dbef60881ee778d59cb19bcaa7b",class:"username"},t.username," ",(!this.user&&this.emptyFieldsExist||f)&&(0,i.h)("span",{key:"f928b2a185388587d589cf318c915a1564ba0137",class:"asterisk"},"*")),(0,i.h)("calcite-input",{key:"2efb250b0b0e7b74157582e419ff9650314bd55e",onInput:e=>{this.user=this.trimInput(e.target.value)},required:!0}),((!this.user||!this.password)&&this.emptyFieldsExist||f)&&(0,i.h)("calcite-input-message",{key:"559697e1ac6d7f56a87e4e793c116c7bec70cc40",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.incorrectLogin)),(0,i.h)("calcite-label",{key:"30e1cb5644e5df83eb78547fd0cb8ae1d9401deb",class:"credentials"},(0,i.h)("div",{key:"3bd79ccc06b9190a7359fdadb43d9aca9e85471e",class:"password"},t.password," ",(!this.password&&this.emptyFieldsExist||f)&&(0,i.h)("span",{key:"f9945a1e8e690c68b08f55e531c7115a9c866416",class:"asterisk"},"*")),(0,i.h)("calcite-input",{key:"7634786c40187c78eb8814c4572b5ba869b97b1f",class:"credentials password",type:"password",onInput:e=>{this.password=this.trimInput(e.target.value)},required:!0}))),(0,i.h)("calcite-label",{key:"d1a55b0f92b6d08cf9dfe246bf4baecdea637c00",class:"field"},t.database,(0,i.h)("calcite-input",{key:"427d276cb5cb2d62224f62f684bb0af6e10e7bb7",value:c,onInput:e=>{this.database=this.trimInput(e.target.value)},required:!0}),!this.database&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"765aeb3864ffdf1a950f6e9a4179d70510a00b0b",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noDatabase)),(0,i.h)("calcite-label",{key:"5de8c6b3e25c3b55cba1bac61815e5a71ac8cf18",class:"field"},t.schema,(0,i.h)("calcite-input",{key:"d492950da50776abc90a86e541b74795b717c84b",value:l,onInput:e=>{this.schema=this.trimInput(e.target.value)},required:!0}),!this.schema&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"bd973a7242b2b0bfe8bc0cb24e16774915c13504",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noSchema)),(0,i.h)("calcite-label",{key:"c5cb1942235a945ccb117990c5a130aa58495c35",class:"field"},t.warehouse,(0,i.h)("calcite-input",{key:"fb8cd014f08be0b82a8f7fe9ff8758780cd032c8",value:d,onInput:e=>{this.warehouse=this.trimInput(e.target.value)},required:!0}),!this.warehouse&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"4948e8756ef8e88faef7fa7023d863b5e4c2bf19",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noWarehouse)),(0,i.h)("calcite-label",{key:"0575a8a03df5c7f4a3fbdd251f20d913dad0312d",class:"field"},t.role,(0,i.h)("calcite-input",{key:"81766bf9c25bb1121ddc08f981fd9b4024c9c1a6",value:o,onInput:e=>{this.role=this.trimInput(e.target.value)},required:!0}),!this.role&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"27820a4012e7c81340de2c1b389906e7b21103ac",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noRole)))),(0,i.h)("arcgis-new-item-alert",{key:"56027af638d7c347f49f312af92cfba14660ad3b",heading:null==u?void 0:u.title,description:null==u?void 0:u.description,active:!!u,onAlertDismiss:()=>this.error=null}))}};u.style=".configure-form{margin-top:1.5rem}.fill-credentials{display:flex}.credentials{flex:1 1 0%}.password{margin-inline-start:3rem}.info-icon{color:var(--calcite-color-brand)}.hidden{display:none}calcite-label{--calcite-label-margin-bottom:1.25rem}.asterisk{color:var(--calcite-color-status-danger)}"},48218:(e,t,a)=>{a.d(t,{f:()=>i});const i=(e,t)=>{let a;const i=null!=t?t:"";switch(e){case"amazon":a=`AmazonS3_${i}`;break;case"azure":a=`Microsoft_Azure_Storage_${i}`;break;case"bigQuery":a=`BigQuery_${i}`;break;case"snowflake":a=`Snowflake_${i}`}return a.replace(/ /g,"_").replace(/-/g,"_")}},70506:(e,t,a)=>{a.d(t,{e:()=>r});var i,s=a(99004),r={exports:{}};i=r.exports,s.c,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},a="4.24",i="next";function s(e){if(e.toLowerCase()===i)return i;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e=a),"https://js.arcgis.com/".concat(e,"/")}function n(e){void 0===e&&(e=a);var t=r(e),n=s(e);if(n!==i&&3===n.major){var o=n.minor<=10?"js/":"";return"".concat(t).concat(o,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function o(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function c(e,t){if(t){var a=document.querySelector(t);a.parentNode.insertBefore(e,a)}else document.head.appendChild(e)}function l(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function d(e){return!e||s(e)?n(e):e}function h(e,t){var a=d(e),i=l(a);return i||c(i=o(a),t),i}var u={};function f(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function p(e,t,a){var i;a&&(i=b(e,a));var s=function(){t(e),e.removeEventListener("load",s,!1),i&&e.removeEventListener("error",i,!1)};e.addEventListener("load",s,!1)}function b(e,t){var a=function(i){t(i.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",a,!1)};return e.addEventListener("error",a,!1),a}function v(e){void 0===e&&(e={}),u=e}function m(){return document.querySelector("script[data-esri-loader]")}function y(){var e=window.require;return e&&e.on}function k(e){void 0===e&&(e={});var a={};[u,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}));var i=a.version,s=a.url||r(i);return new t.Promise((function(e,t){var r=m();if(r){var n=r.getAttribute("src");n!==s?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(n,")."))):y()?e(r):p(r,e,t)}else if(y())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var o=a.css;o&&h(!0===o?i:o,a.insertCssBefore),p(r=f(s),(function(){r.setAttribute("data-esri-loader","loaded"),e(r)}),t),document.body.appendChild(r)}}))}function g(e){return new t.Promise((function(t,a){var i=window.require.on("error",a);window.require(e,(function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];i.remove(),t(e)}))}))}function w(e,t){if(void 0===t&&(t={}),y())return g(e);var a=m(),i=a&&a.getAttribute("src");return!t.url&&i&&(t.url=i),k(t).then((function(){return g(e)}))}e.utils=t,e.loadModules=w,e.getScript=m,e.isLoaded=y,e.loadScript=k,e.setDefaultOptions=v,e.loadCss=h,Object.defineProperty(e,"__esModule",{value:!0})}(i)},28926:(e,t,a)=>{a.d(t,{l:()=>s});var i=a(70506);const s=async(e,t)=>(await i.e.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))}}]);