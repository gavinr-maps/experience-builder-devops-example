/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-45036b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-45036b"],{87490:(e,t,i)=>{i.r(t),i.d(t,{arcgis_time_slider_config:()=>m});var s=i(7263),n=i(62159),a=i(77344),l=i(58233),o=i(28926),r=i(1991);i(78613),i(11935),i(70506),i(99004),i(77040);const d="base",u={base:d,tabs:`${d}__tabs`,infoMessage:`${d}__info-message`,enableTimeSlider:`${d}__enable-timeslider`},m=class{constructor(e){(0,s.r)(this,e),this.arcgisTimeDisplayModeChange=(0,s.c)(this,"arcgisTimeDisplayModeChange",7),this.arcgisFullTimeExtentChange=(0,s.c)(this,"arcgisFullTimeExtentChange",7),this.arcgisStopsChange=(0,s.c)(this,"arcgisStopsChange",7),this.arcgisPlayRateChange=(0,s.c)(this,"arcgisPlayRateChange",7),this.arcgisNoTimeEnabledLayersFound=(0,s.c)(this,"arcgisNoTimeEnabledLayersFound",7),this.arcgisTimeSliderEnableToggled=(0,s.c)(this,"arcgisTimeSliderEnableToggled",7),this._handleTimeDisplayModeChange=e=>{this._updateTimeDisplayMode(e.detail)},this._handleTimeSliderEnableToggled=e=>{const t=e.target.checked;t&&!1===this.timeSliderEnabled?(this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1,this._loadPersistedTimeSliderPropertiesFromSceneView().then((()=>this.arcgisTimeSliderEnableToggled.emit(t)))):this.arcgisTimeSliderEnableToggled.emit(t),this.timeSliderEnabled=t,a.t.timeSliderEnabled=t},this._handleFullTimeExtentChange=e=>{if(!(0,a.a)(a.t.fullTimeExtent,e.detail)){const t=this._validateFullTimeExtent(e.detail);this._updateFullTimeExtent(t)}},this._handleStopsChange=e=>{(0,a.b)(a.t.stops,e.detail)||this._updateStops(e.detail)},this._handlePlayRateChange=e=>{a.t.playRate!==e.detail&&this._updatePlayRate(e.detail)},this.view=void 0,this.timeSliderEnabled=!1,this.fullTimeExtent=void 0,this.timeDisplayMode=void 0,this.stops=void 0,this.playRate=a.d,this.noTimeAwareLayersAvailable=!1,this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1}viewChanged(){}async fulltimeExtentFromViewsInitializedChanged(){this.fullTimeExtentFromViewInitialized&&this._watchForLayerLoadedAndProperties()}async componentWillLoad(){[this._reactiveUtils,this._timeUtils,this._timeExtent]=await(0,o.l)(["esri/core/reactiveUtils","esri/support/timeUtils","esri/TimeExtent"]),await this._loadStore()}async componentDidLoad(){await this._loadPersistedTimeSliderPropertiesFromSceneView()}destroy(){var e,t;null===(e=this._watchLayerLoadedHandle)||void 0===e||e.remove(),null===(t=this._watchWidgetPropertiesHandle)||void 0===t||t.remove()}render(){var e,t,i,n,l;return this.noTimeAwareLayersAvailable?(0,s.h)("div",{class:`${u.base} ${u.infoMessage}`},(0,s.h)("calcite-notice",{open:!0,icon:"information"},(0,s.h)("div",{slot:"message"},a.t.strings.noTimeEnabledLayers))):(0,s.h)("div",{class:u.base},(0,s.h)("calcite-label",{layout:"inline",class:u.enableTimeSlider,alignment:"start"},(0,s.h)("calcite-switch",{label:a.t.strings.enableTimeSlider,name:a.t.strings.enableTimeSlider,checked:this.timeSliderEnabled,onCalciteSwitchChange:this._handleTimeSliderEnableToggled,"data-testId":"arcgis-time-slider-config-enable-timeslider"}),a.t.strings.enableTimeSlider),(0,s.h)("calcite-tabs",{class:u.tabs,layout:"center"},(0,s.h)("calcite-tab-nav",{slot:"title-group"},(0,s.h)("calcite-tab-title",{selected:!0,"data-testId":"arcgis-time-slider-config-tab-title-timeextent",disabled:!this.timeSliderEnabled},a.t.strings.startEndPoints.title),(0,s.h)("calcite-tab-title",{"data-testId":"arcgis-time-slider-config-tab-title-interval",disabled:!this.timeSliderEnabled},a.t.strings.timeInterval.title),(0,s.h)("calcite-tab-title",{disabled:!this.timeSliderEnabled,"data-testId":"arcgis-time-slider-config-tab-title-playback"},null===(t=null===(e=a.t.strings)||void 0===e?void 0:e.playback)||void 0===t?void 0:t.title)),(0,s.h)("calcite-tab",{selected:!0},(0,s.h)("arcgis-time-slider-config-time-extent",{timeDisplayMode:this.timeDisplayMode,start:null===(i=this.fullTimeExtent)||void 0===i?void 0:i.start,end:null===(n=this.fullTimeExtent)||void 0===n?void 0:n.end,timeZone:null===(l=this.view)||void 0===l?void 0:l.timeZone,timeSliderEnabled:this.timeSliderEnabled,onArcgisTimeExtentTimeDisplayModeChange:this._handleTimeDisplayModeChange,onArcgisTimeExtentFullExtentChange:this._handleFullTimeExtentChange})),(0,s.h)("calcite-tab",null,(0,s.h)("arcgis-time-slider-config-time-interval",{stops:this.stops,fullTimeExtent:this.fullTimeExtent,timeSliderEnabled:this.timeSliderEnabled,onArcgisIntervalStopsChange:this._handleStopsChange})),(0,s.h)("calcite-tab",null,(0,s.h)("arcgis-time-slider-config-time-playback",{playRate:this.playRate,timeSliderEnabled:this.timeSliderEnabled,onArcgisPlayRateSettingsChange:this._handlePlayRateChange}))))}_updateTimeDisplayMode(e){a.t.timeDisplayMode=e,this.timeDisplayMode=a.t.timeDisplayMode,this.arcgisTimeDisplayModeChange.emit(e)}_updateFullTimeExtent(e){a.t.fullTimeExtent=e,this.fullTimeExtent=a.t.fullTimeExtent,this.arcgisFullTimeExtentChange.emit(e)}_validateFullTimeExtent(e){var t,i;let s=null===(t=null==e?void 0:e.start)||void 0===t?void 0:t.getTime(),n=null===(i=null==e?void 0:e.end)||void 0===i?void 0:i.getTime();const l=s===n&&"instant"!==this.timeDisplayMode;return s=new Date(s||Date.now()).setSeconds(0,0),n=new Date(n+(l?6e4:0)||Date.now()+(l?6e4:0)).setSeconds(0,0),e.start=new Date(s),e.end=new Date(n),(null==e?void 0:e.end)&&(null==e?void 0:e.start)&&(null==e?void 0:e.end.getTime())-(null==e?void 0:e.start.getTime())<a.m&&this._fixFullTimeExtentForSmallTimeRanges(e),new this._timeExtent({start:new Date(s),end:new Date(n)})}_updateStops(e){a.t.stops=e,this.stops=a.t.stops,this.arcgisStopsChange.emit(a.t.stops)}_updatePlayRate(e){a.t.playRate=e,this.playRate=a.t.playRate,this.arcgisPlayRateChange.emit(a.t.playRate)}async _loadStore(){const[e,t]=await(0,n.g)(this.el);(0,a.c)(a.t),a.t.view=this.view,a.t.strings=e,a.t.locale=t,a.t.isRTL="rtl"===(0,l.g)(this.el)}async _loadPersistedTimeSliderPropertiesFromSceneView(){const e=this.view.map;if(e){const t=this._getModeFromViewExtent();let i;const s=await this._timeUtils.getTimeSliderSettingsFromWebDocument(e);s&&(s.stops&&this._updateStops(s.stops),s.fullTimeExtent&&this._updateFullTimeExtent(s.fullTimeExtent),s.playRate&&this._updatePlayRate(s.playRate),s.mode&&(i=s.mode)),(t||i)&&this._updateTimeDisplayMode(t||i)}this.fullTimeExtentFromViewInitialized=!0}_watchForLayerLoadedAndProperties(){var e;null===(e=this._watchLayerLoadedHandle)||void 0===e||e.remove(),this._watchLayerLoadedHandle=this._reactiveUtils.watch((()=>{var e;return Array.from(null===(e=this.view.map.allLayers)||void 0===e?void 0:e.filter((e=>(0,a.l)(e)||(0,a.e)(e))).map((e=>{var t,i,s;return{loadStatus:e.loadStatus,userViewTime:null==e?void 0:e.useViewTime,fullTimeExtent:null===(t=null==e?void 0:e.timeInfo)||void 0===t?void 0:t.fullTimeExtent,visibilityTimeExtentStart:null===(i=e.visibilityTimeExtent)||void 0===i?void 0:i.start,visibilityTimeExtentEnd:null===(s=e.visibilityTimeExtent)||void 0===s?void 0:s.end}})))}),(async e=>{e.some((e=>"loading"===e.loadStatus))||await this._checkFullTimeExtentOfLayers()}),{initial:!0})}async _checkFullTimeExtentOfLayers(){var e,t;const i=this.view.map.allLayers.filter((e=>(0,a.i)(e))),s=this.view.map.allLayers.filter((e=>(0,a.f)(e)));if(!i.length&&!s.length)return this.arcgisNoTimeEnabledLayersFound.emit(),void(this.noTimeAwareLayersAvailable=!0);this.noTimeAwareLayersAvailable=!1;const n=await this._timeUtils.getTimeExtentFromLayers([...i,...s],void 0),l=(0,a.a)(a.t.fullTimeExtent,n);if(!(0,r.i)(null===(e=a.t.fullTimeExtent)||void 0===e?void 0:e.start)&&!(0,r.i)(null===(t=a.t.fullTimeExtent)||void 0===t?void 0:t.end)||!l){const e=this._validateFullTimeExtent(n);(this.fulltimeExtentFromLayersInitialized||!this.fulltimeExtentFromLayersInitialized&&!(0,r.i)(this.fullTimeExtent))&&this._updateFullTimeExtent(e),!0!==this.fulltimeExtentFromLayersInitialized&&(this.fulltimeExtentFromLayersInitialized=!0)}}_getModeFromViewExtent(){var e;const t=null===(e=this.view)||void 0===e?void 0:e.timeExtent;if((0,r.i)(t))return(0,a.g)(t)}_fixFullTimeExtentForSmallTimeRanges(e){var t;e.end=new Date((null===(t=e.start)||void 0===t?void 0:t.getTime())+a.m)}get el(){return(0,s.d)(this)}static get watchers(){return{view:["viewChanged"],fullTimeExtentFromViewInitialized:["fulltimeExtentFromViewsInitializedChanged"]}}};m.style=":host{height:100%;width:100%;display:block}.base{height:100%}.base__tabs{height:calc(100% - var(--arcgis-app-cap-spacing-quarter) - 42px)}.base__tabs,.base__info-message,.base__enable-timeslider{padding:var(--arcgis-app-cap-spacing-eighth) var(--arcgis-app-side-spacing-eighth)}.base__enable-timeslider{--calcite-label-margin-bottom:0px;margin-top:var(--arcgis-app-cap-spacing);margin-bottom:var(--arcgis-app-cap-spacing-half);margin-inline-start:var(--arcgis-app-side-spacing-half);width:-moz-fit-content;width:fit-content}"},11935:(e,t,i)=>{i.d(t,{c:()=>r});var s=i(7263);const n=e=>!("isConnected"in e)||e.isConnected,a=((e,t)=>{let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...s)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(n))}),2e3),l=e=>"function"==typeof e?e():e,o=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},r=(e,t)=>{const i=((e,t=((e,t)=>e!==t))=>{const i=l(e);let s=new Map(Object.entries(null!=i?i:{}));const n={dispose:[],get:[],set:[],reset:[]},a=()=>{var t;s=new Map(Object.entries(null!==(t=l(e))&&void 0!==t?t:{})),n.reset.forEach((e=>e()))},r=e=>(n.get.forEach((t=>t(e))),s.get(e)),d=(e,i)=>{const a=s.get(e);t(i,a,e)&&(s.set(e,i),n.set.forEach((t=>t(e,i,a))))},u="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>r(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(d(t,i),!0)}),m=(e,t)=>(n[e].push(t),()=>{o(n[e],t)});return{state:u,get:r,set:d,on:m,onChange:(t,i)=>{const s=m("set",((e,s)=>{e===t&&i(s)})),n=m("reset",(()=>i(l(e)[t])));return()=>{s(),n()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(m("set",t.set)),t.get&&e.push(m("get",t.get)),t.reset&&e.push(m("reset",t.reset)),t.dispose&&e.push(m("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{n.dispose.forEach((e=>e())),a()},reset:a,forceUpdate:e=>{const t=s.get(e);n.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof s.g)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,s.g)();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(s.f)),a(e)},reset:()=>{e.forEach((e=>e.forEach(s.f))),a(e)}}})()),i}},77344:(e,t,i)=>{i.d(t,{a:()=>u,b:()=>p,c:()=>_,d:()=>r,e:()=>E,f:()=>y,g:()=>w,h:()=>c,i:()=>T,j:()=>m,k:()=>h,l:()=>f,m:()=>o,n:()=>l,o:()=>v,p:()=>d,q:()=>g,t:()=>x});var s=i(11935),n=i(1991);const a=[{value:"centuries",appliesTo:["centuries"]},{value:"decades",appliesTo:["centuries","decades"]},{value:"years",appliesTo:["centuries","decades","years"]},{value:"months",appliesTo:["decades","years","months","months-hours"]},{value:"weeks",appliesTo:["years","months","weeks","months-hours"]},{value:"days",appliesTo:["months","weeks","days","months-hours"]},{value:"hours",appliesTo:["weeks","days","hours","months-hours"]},{value:"minutes",appliesTo:["days","hours","minutes","seconds"]},{value:"seconds",appliesTo:["hours","minutes","seconds"]}],l=10,o=6e4,r=2e3,d=9999;function u(e,t){const i=null==e?void 0:e.start,s=null==e?void 0:e.end,n=null==t?void 0:t.start,a=null==t?void 0:t.end,l=i&&n&&(null==i?void 0:i.getTime())===(null==n?void 0:n.getTime()),o=s&&a&&(null==s?void 0:s.getTime())==(null==a?void 0:a.getTime());return!(i&&n||!o)||(!(s&&a||!l)||l&&o)}function m(e){if(!e)return null;const t=new Date(e.getTime()),i=t.getFullYear();let s=""+(t.getMonth()+1),n=""+t.getDate();return s.length<2&&(s="0"+s),n.length<2&&(n="0"+n),[i,s,n].join("-")}function c(e,t){if(!e)return null;const i=e?e.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",timeZone:"system"!==t&&"unknown"!==t?t:void 0}):"00:00:00";return 0===e.getHours()||i.indexOf("24:")>-1?i.replace("24:","00:"):i}function h(e,t,i){const s=function(e,t,i){if(i&&"system"!==i&&"unknown"!==i){const s=new Date(t.toLocaleString("en-US",{timeZone:i})),n=s.getTime()-t.getTime(),a=e.split(":")||["00","00"],l=parseInt(a[0]),o=parseInt(a[1]),r=parseInt(a[2]);return s.setHours(l),s.setMinutes(o),s.setSeconds(r),new Date(s.getTime()-n).toLocaleString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"})}return e}(t,e,i),n=s&&s.split(":")||["00","00","00"],a=n.length>0?parseInt(n[0]):0,l=n.length>1?parseInt(n[1]):0,o=n.length>2?parseInt(n[2]):0;return new Date(e.getFullYear(),e.getMonth(),e.getDate(),a,l,o)}function g(){return a.map((e=>e.value))}function v(e){const t=l,i=((null==e?void 0:e.end.getTime())-(null==e?void 0:e.start.getTime()))/t,s=31104e8;if(i>s)return b(i,s,"centuries");const n=31104e7;if(i>n)return b(i,n,"decades");const a=31104e6;if(i>a)return b(i,a,"years");const o=2592e6;if(i>o)return b(i,o,"months");const r=6048e5;if(i>r)return b(i,r,"weeks");const d=864e5;if(i>d)return b(i,d,"days");const u=36e5;if(i>u)return b(i,u,"hours");if(i>6e4)return b(i,6e4,"minutes");return i>1e3?b(i,1e3,"seconds"):b(i,1,"minutes")}function p(e,t){if(e&&t){const i=e.interval&&t.interval,s=e.count&&t.count;return!(!i&&!s)&&(!(!i||e.interval.value!==t.interval.value||e.interval.unit!==t.interval.unit)||!(!s||e.count!==t.count))}return!1}function T(e){var t,i,s,n;return f(e)&&e.useViewTime&&(null===(i=null===(t=null==e?void 0:e.timeInfo)||void 0===t?void 0:t.fullTimeExtent)||void 0===i?void 0:i.start)&&!isNaN(e.timeInfo.fullTimeExtent.start.getTime())&&(null===(n=null===(s=null==e?void 0:e.timeInfo)||void 0===s?void 0:s.fullTimeExtent)||void 0===n?void 0:n.end)&&!isNaN(e.timeInfo.fullTimeExtent.end.getTime())}function f(e){return"useViewTime"in e&&"timeInfo"in e}function y(e){var t,i,s,a,l,o;return E(e)&&(0,n.i)(null===(t=e.visibilityTimeExtent)||void 0===t?void 0:t.start)&&(0,n.i)(null===(i=e.visibilityTimeExtent)||void 0===i?void 0:i.end)&&!isNaN(null===(a=null===(s=null==e?void 0:e.visibilityTimeExtent)||void 0===s?void 0:s.start)||void 0===a?void 0:a.getTime())&&!isNaN(null===(o=null===(l=null==e?void 0:e.visibilityTimeExtent)||void 0===l?void 0:l.end)||void 0===o?void 0:o.getTime())}function E(e){return"visibilityTimeExtent"in e}function b(e,t,i){return{value:Math.round(e/t),unit:i}}function w(e){var t,i;return!(0,n.i)(e.start)&&(0,n.i)(e.end)?"cumulative-from-start":(null===(t=e.start)||void 0===t?void 0:t.getTime())===(null===(i=e.end)||void 0===i?void 0:i.getTime())?"instant":"time-window"}const x=(0,s.c)({isRTL:!1}).state;function _(e){e.view=void 0,e.fullTimeExtent=void 0,e.timeDisplayMode="time-window",e.stops=void 0,e.timeSliderEnabled=!1,e.playRate=r}}}]);