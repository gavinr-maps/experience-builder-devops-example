/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-abad1b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-abad1b"],{83044:(e,t,i)=>{i.r(t),i.d(t,{arcgis_floor_configuration:()=>v,arcgis_floor_configuration_add_layers:()=>m,arcgis_floor_configuration_add_layers_flow:()=>b,arcgis_floor_configuration_additional_layers:()=>L,arcgis_floor_configuration_field_list:()=>w,arcgis_floor_configuration_field_picker:()=>C,arcgis_floor_configuration_field_select:()=>F,arcgis_floor_configuration_layer_list:()=>k,arcgis_floor_configuration_layer_picker:()=>I,arcgis_floor_configuration_replace_field:()=>_,arcgis_floor_configuration_select_fields:()=>E});var s=i(7263),l=i(62159),n=i(28926);i(78613),i(58233),i(70506),i(99004);const a="container",r={facilityLayer:{facilityIdField:"FACILITY_ID",siteIdField:"SITE_ID",nameField:"NAME"},levelLayer:{levelIdField:"LEVEL_ID",facilityIdField:"FACILITY_ID",longNameField:"NAME",shortNameField:"NAME_SHORT",levelNumberField:"LEVEL_NUMBER",verticalOrderField:"VERTICAL_ORDER"},siteLayer:{siteIdField:"SITE_ID",nameField:"NAME"}};let o;const d=e=>{var t;const i=null==e?void 0:e.map;return o=o||(null==i?void 0:i.floorInfo)||Object.assign({},r),o.siteLayer=(null===(t=null==o?void 0:o.siteLayer)||void 0===t?void 0:t.layerId)?o.siteLayer:null,o},c=e=>{const t=null==e?void 0:e.map,i=d(e);t&&u(i)?t.set("floorInfo",i):h(e)},h=e=>{const t=null==e?void 0:e.map;t&&(t.floorInfo=null)},u=e=>{var t,i;return!(!(null===(t=null==e?void 0:e.facilityLayer)||void 0===t?void 0:t.layerId)||!(null===(i=null==e?void 0:e.levelLayer)||void 0===i?void 0:i.layerId)||(null==e?void 0:e.siteLayer)&&!(null==e?void 0:e.siteLayer.layerId))},f=e=>{const t=r[e];return Object.values(t)},g=e=>{const{map:t}=e,{allLayers:i}=t;let s=[];return i.forEach((e=>{const{type:t,floorInfo:i}=e;if("map-image"===t){const{allSublayers:t}=e;s=s.concat(t.filter((e=>e.fieldsIndex&&!(null==e?void 0:e.floorInfo))).toArray())}else!i&&["feature","oriented-imagery"].includes(t)&&s.push(e)})),s},p=e=>{try{e.loadAll?e.loadAll():e.load()}catch(e){}return e},y=e=>{let{layer:t,field:i}=e;"arcgis-field-list"!==(null==e?void 0:e.localName)&&"arcgis-floor-configuration-field-list"!==(null==e?void 0:e.localName)||(i=e.selection.values().next().value);const s=t.floorInfo||{};s.floorField=i.name,t.set("floorInfo",s)},v=class{constructor(e){(0,s.r)(this,e),this.floorInfoChange=(0,s.c)(this,"floorInfoChange",7),this.view=void 0,this.layer=void 0,this.open=!0,this.disabled=!1}async componentWillLoad(){const[e]=await(0,l.g)(this.hostElement);this.strings=e;const[t]=await(0,n.l)(["esri/core/reactiveUtils"]);this.reactiveUtils=t;const{view:i}=this;this.props={view:i,strings:e},this.disabled=this.disabled||await this.getDisabled()}async componentDidLoad(){const[e]=await(0,n.l)(["esri/intl"]);this.intl=e,this.intl.setLocale(document.documentElement.lang)}addMapFloorInfo(){c(this.view),this.floorInfoChange.emit()}removeFloorInfo(){h(this.view),this.floorInfoChange.emit()}updateFloorInfo(e){((e,t)=>{const i=d(t),{name:s}=e,l=e.layer,n=!!(null==l?void 0:l.layer);l?(i[s]=Object.assign({},r[s]),i[s].layerId=n?l.layer.id:l.id,i[s].sublayerId=n?l.id:void 0):i[s]=void 0,c(t)})(e,this.view),this.floorInfoChange.emit()}disableContainer(e){const{detail:t}=e,i=this.hostElement.closest("calcite-flow-item");i&&(i.disabled=t)}closeAllLayerPickers(){document.querySelectorAll("arcgis-floor-configuration-layer-picker").forEach((e=>e.open=!1))}async getDisabled(){const e=this.view;await this.reactiveUtils.whenOnce((()=>e.allLayerViews.every((e=>!e.updating))));const t=await(async e=>{const{map:t}=e,{allLayers:i}=t,s=i.map((async e=>await p(e))).filter((e=>"failed"!==(null==e?void 0:e.loadStatus))),l=await Promise.all(s);let n=[];return l.forEach((e=>{const{type:t,geometryType:i}=e;if("map-image"===t){const{allSublayers:t}=e;n=n.concat(t.filter((e=>{var t;return e.fieldsIndex&&"esriGeometryPolygon"===(null===(t=e.sourceJSON)||void 0===t?void 0:t.geometryType)})).toArray())}else"feature"===t&&"polygon"===i&&n.push(e)})),n})(e),i=["facilityLayer","levelLayer"].filter((e=>{var i;return null===(i=t.filter((t=>this.hasRequiredFields(t,f(e)))))||void 0===i?void 0:i.length}));return!(null==i?void 0:i.length)}hasRequiredFields(e,t){if(e){const{fieldsIndex:i}=e;return i&&t.every((e=>!!i.get(e)))||!1}return!1}render(){const{strings:e,open:t,disabled:i}=this;return(0,s.h)(s.H,{key:"2eeb91e4a629e057acc05d76a5f8a60e70e19f64"},(0,s.h)("calcite-block",{key:"0458e54037e34d96e2428732a55efe123c44d420",class:a,heading:e.heading,collapsible:!0,disabled:i,open:t&&!i},this.renderFloorConfiguration()))}renderFloorConfiguration(){const{strings:e,view:t}=this,i=t.map,l=!!(null==i?void 0:i.floorInfo);return(0,s.h)("calcite-block-section",{text:e.enable,open:l,"toggle-display":"switch",onCalciteBlockSectionToggle:e=>e.currentTarget.open?this.addMapFloorInfo():this.removeFloorInfo()},(0,s.h)("p",null,e.summary),this.renderLayerPicker("siteLayer"),this.renderLayerPicker("facilityLayer"),this.renderLayerPicker("levelLayer"),this.renderAdditionalLayers())}renderLayerPicker(e){const{strings:t,view:i}=this,l=((e,t)=>{var i,s;const l=t.map.allLayers,n=d(t),a=null===(i=null==n?void 0:n[e])||void 0===i?void 0:i.layerId,r=null===(s=null==n?void 0:n[e])||void 0===s?void 0:s.sublayerId;let o=a?null==l?void 0:l.find((e=>e.id===a)):null;return"map-image"===(null==o?void 0:o.type)&&(o=o.allSublayers.find((e=>e.id===r))),o})(e,i),n=f(e);return(0,s.h)("arcgis-floor-configuration-layer-picker",{view:this.view,label:t[e],strings:t,selectedLayer:l,requiredFields:n,onListChange:t=>this.updateFloorInfo({layer:(null==t?void 0:t.detail)?null==t?void 0:t.detail[0]:null,name:e})})}renderAdditionalLayers(){const{strings:e}=this;return(0,s.h)("calcite-block-section",{text:e.additionalLayers,open:!0},(0,s.h)("arcgis-floor-configuration-additional-layers",{view:this.view,strings:this.strings,onDisable:e=>this.disableContainer(e)}))}get hostElement(){return(0,s.d)(this)}},m=class{constructor(e){(0,s.r)(this,e),this.listChange=(0,s.c)(this,"listChange",7),this.view=void 0,this.layers=void 0,this.selection=new Map,this.strings=void 0}selectionChange(){this.listChange.emit(this.selection)}render(){return(0,s.h)(s.H,{key:"54b076229a77698cc121b8a22a8b3aeb7d68e0d1"},this.renderPanel())}renderPanel(){return(0,s.h)("section",null,(0,s.h)("arcgis-floor-configuration-layer-list",{layers:g(this.view),"filter-enabled":!0,multiple:!0,strings:this.strings,onListChange:e=>this.selection=e.detail}))}get el(){return(0,s.d)(this)}static get watchers(){return{selection:["selectionChange"]}}},b=class{constructor(e){(0,s.r)(this,e),this.done=(0,s.c)(this,"done",7),this.dismiss=(0,s.c)(this,"dismiss",7),this.view=void 0,this.strings=void 0,this.layers=void 0,this.selectedLayers=void 0,this.mode="create"}render(){return(0,s.h)(s.H,{key:"f85d9adfbe24a158f0c45cc32cd77b8c037555a4"},this.renderFlow())}renderFlow(){return(0,s.h)("calcite-flow",{ref:e=>this.createPanels(e)})}onCreate(e){e.stopPropagation(),this.done.emit()}onEdit(e){e.stopPropagation(),this.done.emit()}onDismiss(e){e.stopPropagation(),this.dismiss.emit()}createPanels(e){const{mode:t}=this;return"create"===t?this.createAddLayersPanel(e):"edit"===t?this.createReplaceFieldsPanel(e):void 0}createAddLayersPanel(e){const t=document.createElement("arcgis-floor-configuration-add-layers");t.strings=this.strings,t.view=this.view,t.classList.add("content"),t.addEventListener("listChange",(e=>{var t;return l.disabled=!(null===(t=e.detail)||void 0===t?void 0:t.length)}));const i=this.createPanel({heading:this.strings.addLayers});i.appendChild(t);const s=this.createButton({label:this.strings.cancel,appearance:"outline-fill",eventListener:this.onDismiss.bind(this)});i.appendChild(s);const l=this.createButton({label:this.strings.next,appearance:"solid",disabled:!0,eventListener:()=>{this.createSelectFloorFieldsPanel(t.selection,e)}});i.appendChild(l),e.appendChild(i)}createSelectFloorFieldsPanel(e,t){const i=document.createElement("arcgis-floor-configuration-select-fields");i.classList.add("content"),i.strings=this.strings,i.layers=e,i.view=this.view;const s=this.createPanel({heading:this.strings.selectFloorField});s.appendChild(i);const l=this.createButton({label:this.strings.cancel,appearance:"outline-fill",eventListener:this.onDismiss.bind(this)});s.appendChild(l);const n=this.createButton({label:this.strings.add,appearance:"solid",eventListener:async e=>{await i.commit(),this.onCreate(e)}});s.appendChild(n),t.appendChild(s)}createReplaceFieldsPanel(e){const t=this.layers[0],i=document.createElement("arcgis-floor-configuration-replace-field");i.classList.add("content"),i.strings=this.strings,i.view=this.view,i.layer=t;const s=this.createPanel({heading:t.title,summary:this.strings.replaceFloorField});s.appendChild(i);const l=this.createButton({label:this.strings.replace,width:"full",eventListener:async e=>{await i.commit(),this.onEdit(e)}});s.appendChild(l),e.appendChild(s)}createPanel(e){const t=document.createElement("calcite-flow-item");return t.heading=e.heading,t.description=e.summary,t.closable=!0,t.closed=!1,t.addEventListener("calciteFlowItemClose",this.onDismiss.bind(this)),t}createButton(e){const{appearance:t="solid",label:i,eventListener:s,width:l="half",disabled:n=!1}=e,a=document.createElement("calcite-button");a.slot="footer",a.appearance=t,a.disabled=n,a.width=l;const r=document.createTextNode(i);return a.appendChild(r),a.addEventListener("click",s),a}get el(){return(0,s.d)(this)}};b.style=".content{width:20vw;max-width:420px;min-width:240px;max-height:40vh}";const L=class{constructor(e){(0,s.r)(this,e),this.dismiss=(0,s.c)(this,"dismiss",7),this.disable=(0,s.c)(this,"disable",7),this.floorInfoChange=(0,s.c)(this,"floorInfoChange",7),this.reRender=void 0,this.view=void 0,this.strings=void 0,this.placement="bottom-start"}disconnectedCallback(){var e;const{popoverNode:t}=this;t&&(t.open=!1,null===(e=t.parentElement)||void 0===e||e.removeChild(t))}async setFocus(){var e;return null===(e=this.layerPanel)||void 0===e?void 0:e.setFocus()}open(){requestAnimationFrame((()=>this.popoverNode.open=!0))}close(e){this.disableContainer(!1);const{popoverNode:t}=this;t.open=!1,t.remove(),this.popoverNode=null,this.reRender=!this.reRender,e&&this.floorInfoChange.emit()}create(){const e=this.createPopover(),t=this.createAddLayersFlow("create");e.appendChild(t),this.open()}edit(e){const t=this.getSelectedLayer(e),i=this.createPopover(),s=this.createAddLayersFlow("edit");s.layers=[t],i.appendChild(s),this.open()}removeLayer(e){e.floorInfo=null,this.reRender=!this.reRender,this.floorInfoChange.emit()}render(){return(0,s.h)(s.H,{key:"076eb34d920b09509b7c774cb5c3daaa727560bd"},this.renderNotice(),this.renderPanel())}renderNotice(){const{strings:e}=this,t=this.getLayers();return(null==t?void 0:t.length)?null:(0,s.h)("calcite-notice",{scale:"s",width:"auto",open:!0},(0,s.h)("div",{slot:"message"},e.additionalLayersTip))}renderPanel(){const{strings:e}=this,t=g(this.view);return(0,s.h)("calcite-panel",{ref:e=>this.layerPanel=e},this.renderLayers(),(0,s.h)("calcite-fab",{slot:"fab",icon:"plus",appearance:"outline-fill",kind:"neutral","text-enabled":!0,label:e.addLayers,text:e.addLayers,disabled:0===t.length,scale:"s",ref:e=>this.triggerButton=e,onClick:()=>this.create()}))}renderLayers(){const e=this.getLayers();return(0,s.h)("calcite-value-list",{dir:"ltr",class:"calcite-mode-light",onClick:e=>this.edit(e)},e.map((e=>this.renderLayer(e))))}renderLayer(e){const{title:t,floorInfo:i,id:l}=e,{floorField:n}=i,a=`{${n}}`;return(0,s.h)("calcite-value-list-item",{label:t,description:a,value:l},(0,s.h)("calcite-action",{slot:"actions-end",text:this.strings.remove,icon:"x",onClick:t=>{t.stopPropagation(),this.removeLayer(e)}}))}disableContainer(e){const t=this.el.closest("calcite-block");t&&(t.disabled=e),this.disable.emit(e)}createAddLayersFlow(e){this.disableContainer(!0);const t=this.addLayersFlow=document.createElement("arcgis-floor-configuration-add-layers-flow");return t.strings=this.strings,t.view=this.view,t.mode=e,t.addEventListener("done",this.close.bind(this,!0)),t.addEventListener("dismiss",this.close.bind(this,!1)),t}createPopover(){const e=this.el,t=this.popoverNode=document.createElement("calcite-popover");return t.classList.add("js-app-primary-flyout"),t.referenceElement=e,t.offsetDistance=-550,t.offsetSkidding=0,t.label=this.strings.addLayers,t.placement="bottom-start",t.pointerDisabled=!0,document.body.appendChild(t),t}getSelectedLayer(e){var t,i,s,l,n;if("calcite-value-list-item"===(null===(t=e.target)||void 0===t?void 0:t.localName)||"calcite-value-list-item"===(null===(s=null===(i=e.target)||void 0===i?void 0:i.parentElement)||void 0===s?void 0:s.localName)){const t=null!==(l=e.target.value)&&void 0!==l?l:null===(n=e.target.parentElement)||void 0===n?void 0:n.value;return this.findLayer(t)}}getLayers(){const e=this.view,{map:t}=e,{allLayers:i}=t;let s=[];return i.forEach((e=>{const{type:t,floorInfo:i}=e;if("map-image"===t){const{allSublayers:t}=e;s=s.concat(t.filter((e=>e.fieldsIndex&&(null==e?void 0:e.floorInfo))).toArray())}else i&&s.push(e)})),s}findLayer(e){const t=this.getLayers();return null==t?void 0:t.find((t=>t.id===e))}get el(){return(0,s.d)(this)}};L.style=":host{height:100%}calcite-notice{margin-bottom:1em}";const w=class{constructor(e){(0,s.r)(this,e),this.listChange=(0,s.c)(this,"listChange",7),this.layer=void 0,this.selection=new Map,this.filterEnabled=!0,this.multiple=!1,this.strings=void 0,this.fieldType="string"}render(){return(0,s.h)(s.H,{key:"cb8ed449ef509a60a64a3a79eac93df994130967"},(0,s.h)("calcite-list",{key:"abd96375bf79573707375bf628d433d472255d07","filter-enabled":this.filterEnabled,"filter-placeholder":this.strings.filter,selectionMode:this.multiple?"multiple":"single",onClick:e=>this.onListChange(e)},this.renderFields()))}renderFields(){return(this.getFields()||[]).map((e=>this.renderField(e)))}renderField(e){const t=`{${e.name}}`;return(0,s.h)("calcite-list-item",{label:e.alias,description:t,selected:this.selection.has(e.name),value:e.name})}onListChange(e){const{selection:t}=this;this.updateSelection(e),this.listChange.emit(Array.from(t.values()))}updateSelection(e){var t,i,s,l,n;if("calcite-list-item"===(null===(t=e.target)||void 0===t?void 0:t.localName)||"calcite-list-item"===(null===(s=null===(i=e.target)||void 0===i?void 0:i.parentElement)||void 0===s?void 0:s.localName)){const{selection:t}=this,i=null!==(l=e.target.value)&&void 0!==l?l:null===(n=e.target.parentElement)||void 0===n?void 0:n.value,s=t.has(i),a=this.findField(i);this.multiple||t.clear(),s?this.selection.delete(a.name):this.selection.set(i,a)}}getFields(){const{layer:e,fieldType:t}=this,{fields:i}=e;return(null==i?void 0:i.length)?i.filter((e=>!t||(null==e?void 0:e.type)===t)):[]}findField(e){const{layer:t}=this;return t.fieldsIndex.get(e)}get el(){return(0,s.d)(this)}},C=class{constructor(e){(0,s.r)(this,e),this.iconEnd="pencil",this.label=void 0,this.layer=void 0,this.placement="auto",this.open=void 0}render(){var e;const t=(null===(e=this.layer)||void 0===e?void 0:e.title)||this.strings.none;return(0,s.h)(s.H,{key:"3c9b24b6604458fdca6cb5768d59dcdd7b334949"},(0,s.h)("calcite-label",{key:"fa68b013e1c788f2ebff61b810e0bd59b5f4af25"},this.label,(0,s.h)("calcite-button",{key:"cad6bd1408c99fac8439cb8f3efb7d82554de1a0",appearance:"outline-fill",kind:"neutral",scale:"m","icon-end":this.iconEnd,ref:e=>this.triggerButton=e,onClick:()=>this.open=!this.open},t)),(0,s.h)("calcite-popover",{key:"35a18d13ff26d3570098af18ee1498f3af45c5d3",label:this.label,pointerDisabled:!0,referenceElement:this.triggerButton,open:this.open,closable:!0,placement:this.placement},(0,s.h)("div",{key:"aabd364241cb74920d2d40c45fc731005ed2a41e",class:"content"},(0,s.h)("slot",{key:"c103f60730abd0285945033205b7acf260ab8b97"}))))}get el(){return(0,s.d)(this)}},F=class{constructor(e){(0,s.r)(this,e),this.layer=void 0,this.strings=void 0,this.field=void 0,this.fieldType="string"}async componentWillLoad(){this.onSelectChange()}findField(e){return this.layer.fieldsIndex.get(e)}onSelectChange(){const{select:e}=this,t=null==e?void 0:e.selectedOption;this.field=t?this.findField(t.value):this.field||this.getFields()[0]}render(){const{title:e}=this.layer,t=this.getFields();return(0,s.h)(s.H,{key:"b81be0b3ab9240b87a13243a7d748d5d89ad19c3"},(0,s.h)("calcite-label",{key:"40e48bdfd22ac004b7767b64724d349fc977e5d1"},e,(0,s.h)("calcite-select",{key:"4e8ab61d56c9192ea9ef01cff07f733f477065df",label:"select",ref:e=>this.select=e,onCalciteSelectChange:()=>this.onSelectChange()},t.map((e=>this.renderField(e))))))}renderField(e){return(0,s.h)("calcite-option",{label:e.alias,value:e.name})}getFields(){const{layer:e,fieldType:t}=this,{fields:i}=e;return(null==i?void 0:i.length)?i.filter((e=>!t||(null==e?void 0:e.type)===t)):[]}get el(){return(0,s.d)(this)}},k=class{constructor(e){(0,s.r)(this,e),this.listChange=(0,s.c)(this,"listChange",7),this.layers=void 0,this.selection=new Map,this.filterEnabled=!0,this.multiple=!1,this.strings=void 0}render(){return(0,s.h)(s.H,{key:"2bc2b07fcf100ed0648b44a7c0d53000ed1a679f"},(0,s.h)("calcite-list",{key:"d6d32e6b33e442024c7455788c864ce757a272d2","filter-enabled":this.filterEnabled,"filter-placeholder":this.strings.filter,selectionMode:this.multiple?"multiple":"single",onClick:e=>this.onListChange(e)},this.renderLayers()))}renderLayers(){const{layers:e,selection:t}=this;return(e||[]).map((e=>(0,s.h)("calcite-list-item",{label:e.title,description:this.getLayerType(e),selected:t.has(e.id),value:e.id})))}onListChange(e){const{selection:t}=this;this.updateSelection(e),this.listChange.emit(Array.from(t.values()))}updateSelection(e){var t,i,s,l,n;if("calcite-list-item"===(null===(t=e.target)||void 0===t?void 0:t.localName)||"calcite-list-item"===(null===(s=null===(i=e.target)||void 0===i?void 0:i.parentElement)||void 0===s?void 0:s.localName)){const{selection:t}=this,i=null!==(l=e.target.value)&&void 0!==l?l:null===(n=e.target.parentElement)||void 0===n?void 0:n.value,s=t.has(i),a=this.findLayer(i);this.multiple||t.clear(),s?this.selection.delete(a.id):this.selection.set(a.id,a)}}findLayer(e){const{layers:t}=this;return null==t?void 0:t.find((t=>t.id===e))}getLayerType(e){const{layerTypes:t}=this.strings,{geometryType:i="unknown",sourceJSON:s}=e;return"unknown"!==i?t[i]:t[this.jsonTypeToLayerType(null==s?void 0:s.geometryType)]}jsonTypeToLayerType(e){return"esriGeometryPolygon"===e?"polygon":"esriGeometryPoint"===e?"point":"esriGeometryPolyline"===e?"line":"unknown"}get el(){return(0,s.d)(this)}},I=class{constructor(e){(0,s.r)(this,e),this.listChange=(0,s.c)(this,"listChange",7),this.selectedLayer=void 0,this.view=void 0,this.iconEnd="pencil",this.label=void 0,this.placement="bottom-start",this.open=!1,this.strings=void 0,this.requiredFields=void 0,this.geometryType="polygon"}calcitePopoverCloseHandler(){this.open=!1}async setFocus(){return this.panel?this.panel.setFocus():Promise.resolve()}render(){const{selectedLayer:e}=this,t=(null==e?void 0:e.title)||this.strings.none,i=this.getLayers(),l=this.open||!(null==i?void 0:i.length),n=new Map;return e&&n.set(e.id,e),(0,s.h)(s.H,{key:"e8046d3ecc6b5a108b1adb3274deb24feb610305"},(0,s.h)("calcite-label",{key:"2a75452a09feee76edb19e65c3bab86858d1511b"},this.label,(0,s.h)("span",{key:"947eca1ce1e845529fca489c2dbabdafe1b98318"},(0,s.h)("calcite-button",{key:"796cc82bc24c72bad7b4af54c52ac81fb621faa2",appearance:"outline-fill",alignment:"icon-end-space-between",kind:"neutral",scale:"m","icon-end":"pencil",width:"full",disabled:l,ref:e=>this.triggerButton=e,onClick:()=>{this.open=!this.open,setTimeout((()=>this.setFocus()),25)}},t),(0,s.h)("calcite-action",{key:"13878e857656488a1a2cedcf7516a0260dee68f7",icon:"x",scale:"s",text:this.strings.clear,disabled:!this.selectedLayer,onClick:()=>{this.selectedLayer=null,this.listChange.emit()}}))),(0,s.h)("calcite-popover",{key:"f3e4e7dfff9b4f48ad288c86fbaedc5e3772aec5",label:this.label,pointerDisabled:!0,referenceElement:this.triggerButton,open:this.open,placement:this.placement,ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{key:"602ab44d3147d130137697fb2c8a98c3d1c221cd",heading:this.label,closed:!1,"width-scale":"m","height-scale":"m",ref:e=>this.panel=e},(0,s.h)("arcgis-floor-configuration-layer-list",{key:"d03c217f5085161a17c552508f4e48fe713e9482",strings:this.strings,layers:i,selection:n,onListChange:e=>this.selectedLayer=null==e?void 0:e.detail[0]}),(0,s.h)("calcite-button",{key:"2ba32a28cf195f8bb605bada5a37c91379a1e936",width:"full",slot:"footer",onClick:()=>this.open=!1},this.strings.done))))}getLayers(){const e=this.getCompatibleLayers();return(null==e?void 0:e.length)?e.filter((e=>this.checkRequiredFields(e))):[]}getCompatibleLayers(){const{geometryType:e}=this,{map:t}=this.view,{allLayers:i}=t;let s=[];return i.forEach((t=>{const{type:i}=t;if("map-image"===i){const{allSublayers:e}=t;s=s.concat(e.filter((e=>e.fieldsIndex)).toArray())}else("feature"===i&&!e||(null==t?void 0:t.geometryType)===e)&&s.push(t)})),s}checkRequiredFields(e){const{requiredFields:t}=this,{fieldsIndex:i}=e;return!t||!i||t.every((e=>i.get(e)))}get el(){return(0,s.d)(this)}};I.style="calcite-label span{width:100%;display:flex;justify-content:space-between}calcite-label span calcite-action{margin-left:0.3em}.arcgis--rtl calcite-label span calcite-action{margin-left:auto;margin-right:0.3em}";const _=class{constructor(e){(0,s.r)(this,e),this.view=void 0,this.layer=void 0,this.strings=void 0}async commit(){return new Promise((e=>{Array.from(this.el.shadowRoot.querySelectorAll("arcgis-floor-configuration-field-list")).map((e=>y(e))),e()}))}render(){return(0,s.h)(s.H,{key:"471fe601aace8224e2af8b3ef2b2819e9dbfbc5e"},this.renderPanel())}renderPanel(){const e=this.layer,t=this.findField(e.floorInfo.floorField),i=new Map;return i.set(t.name,t),(0,s.h)("section",null,(0,s.h)("arcgis-floor-configuration-field-list",{strings:this.strings,layer:e,selection:i}))}findField(e){return this.layer.fieldsIndex.get(e)}get el(){return(0,s.d)(this)}};_.style="section{padding:0.5rem 0.75rem;background-color:white}";const E=class{constructor(e){(0,s.r)(this,e),this.view=void 0,this.layers=void 0,this.strings=void 0}async commit(){return new Promise((async e=>{Array.from(this.el.shadowRoot.querySelectorAll("arcgis-floor-configuration-field-select")).forEach((e=>y(e))),e()}))}render(){return(0,s.h)(s.H,{key:"d631f79cb8b3916840b6a1596ca3218717a14756"},this.renderPanel())}renderPanel(){const{layers:e}=this;return(0,s.h)("section",null,(0,s.h)("p",null,this.strings.selectMessage),e.map((e=>this.renderSelect(e))))}renderSelect(e){return(0,s.h)("arcgis-floor-configuration-field-select",{strings:this.strings,layer:e})}get el(){return(0,s.d)(this)}};E.style="section{padding:0.5rem 0.75rem;background-color:white}"}}]);