/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-20cc51.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-20cc51"],{99004:(e,r,t)=>{t.d(r,{c:()=>s,g:()=>a});var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},40486:(e,r,t)=>{t.r(r),t.d(r,{arcgis_new_item_pages_data_store_select_server_list:()=>c});var s=t(7263),a=t(31670),i=t(82752),o=t(71700),n=t(99907),l=t(79468);t(11935),t(94788),t(31141),t(46581),t(28926),t(70506),t(99004),t(65215),t(50852),t(7652),t(2174),t(51325),t(86537),t(39274),t(49712),t(90079),t(57399),t(66488),t(67575),t(15437),t(73596),t(91253),t(43780),t(59673),t(59296);const c=class{constructor(e){(0,s.r)(this,e),this.newItemUpdatePage=(0,s.c)(this,"newItemUpdatePage",7),this.loading=!0,this.noValidServers=!0,this.serverTypes=[],this.item={bdfsType:o.a.bdfsType,allowServicesRestart:!1,publisherFolderPath:o.a.publisherFolderPath,publisherFolderPathHostname:o.a.publisherFolderPathHostname,serverFolderPath:o.a.serverFolderPath,newServerFolderPath:o.a.newServerFolderPath,nfsSharePath:o.a.nfsSharePath,nfsHostName:o.a.nfsHostName},this.serverStatusIcons={success:"check-circle-f",failure:"exclamation-mark-circle-f",error:"exclamation-mark-triangle-f",validating:"information"},this.selectedServers=[],this.serverList=[],this.allBoxesSelected=!1,this.error=null,this.requireRestart=!1,this.openRequireRestartModal=!1}async componentWillLoad(){this.i18n=n.u.i18n.serverSelection,this.dataStoreType=o.a.addDataStoreType,this.serverList=o.a.dataStoreSelectServerList||[],this.serverList=this.filterServers(!1,!1,!1,!1)}async componentDidLoad(){const e=await(0,i.e)({item:o.a,serverList:this.serverList,datastoreType:this.dataStoreType,portal:a.c.portal});this.serverList=[...e];const r=await(0,i.i)(this.serverList);this.openRequireRestartModal=e.some((e=>"RequiresServicesRestart"===(null==e?void 0:e.error))),this.serverList=[...r.servers],this.serverTypes=[...r.serverTypes],this.renderTable(),this.appendServerTypes(),this.loading=!1}filterServers(e,r,t,s){return(this.serverList||[]).filter((a=>{const i=(a.serverRole||"").toUpperCase(),o=["ARCGIS_NOTEBOOK_SERVER","ARCGIS_MISSION_SERVER","ARCGIS_VIDEO_SERVER"],n=a.serverFunction&&a.serverFunction.replace(/\s+/g,"").split(",")||[],c=["NOTEBOOKSERVER","WORKFLOWMANAGER","MISSIONSERVER","VIDEOSERVER"];let d="HOSTING_SERVER"===i;e&&-1===n.indexOf("GeoAnalytics")&&(o.push(i),d=!1),r&&-1===n.indexOf("KnowledgeServer")&&(o.push(i),d=!1),s&&(0,l.i)()&&(d=!0);let h=-1===o.indexOf(i);return t&&(h=!1),d||h&&(!n.length||n.some((function(e){return-1===c.indexOf(e.toUpperCase())})))}))}renderTable(){const e=this.dataStoreType,r="bdfs"===e,t="nosql"===e,s="nfsHostAndPath"===o.a.serverFolderPath&&"folder"===e,a=this.checkDatabaseClient();this.serverList=this.filterServers(r,t,a,s),s||["folder","fileshare"].includes(e)&&(this.serverList=this.filterServersByServerPath())}checkDatabaseClient(){const e=this.dataStoreType,r=o.a.publisherConnectionString;let t=!1;if("database"===e&&r){r.split(";").forEach((function(e){e.indexOf("DBCLIENT")>-1&&["bigquery","snowflake","redshift"].indexOf(e.split("=")[1])>-1&&(t=!0)}))}return t}filterServersByServerPath(){const e=o.a.addDataStoreType,r=("folder"===e?o.a.newServerFolderPath||o.a.publisherFolderPath:o.a.publisherFileShareFolderPath)[0].indexOf("/")>-1?"Linux":"Windows",t="nfsHostAndPath"===o.a.serverFolderPath&&"folder"===e;return this.serverList.filter((e=>!!this.serverTypes.find((s=>(s.name===e.adminUrl||s.name===`${e.adminUrl}/admin`)&&(t?e.isHosted:s.type===r)))))}appendServerTypes(){const{serverList:e,i18n:r}=this;e.map((e=>{const t=e.serverFunction&&e.serverFunction.replace(/\s+/g,"").split(",")||[];let s="";"HOSTING_SERVER"===e.serverRole&&(s+=r.types.hostedSetting),t.indexOf("NotebookServer")>-1&&(s+=(s&&", ")+r.types.notebookServerSetting),t.indexOf("GeoAnalytics")>-1&&(s+=(s&&", ")+r.types.geoAnalyticsServerSetting),t.indexOf("RasterAnalytics")>-1&&(s+=(s&&", ")+r.types.rasterAnalysisSetting),t.indexOf("ImageHosting")>-1&&(s+=(s&&", ")+r.types.imageHostingSetting),t.indexOf("MissionServer")>-1&&(s+=(s&&", ")+r.types.missionServerSetting),e.serverType=s}))}convertStatusDisplayText(e){const r=this.i18n,t=e.serverStatus;return{success:r.status.success,failure:r.status.failure,error:r.status.error,validating:r.status.validating}[t]}closeModal(){this.openRequireRestartModal=!1,this.newItemUpdatePage.emit("dataStoreSelectFolder")}async acceptRequireRestart(){this.loading=!0,this.openRequireRestartModal=!1,this.item.allowServicesRestart=!0,this.requireRestart=!0;const e=await(0,i.e)({item:this.item,serverList:this.serverList,datastoreType:this.dataStoreType,portal:a.c.portal});this.serverList=[...e];const r=await(0,i.i)(this.serverList);this.serverList=[...r.servers],this.serverTypes=[...r.serverTypes],this.renderTable(),this.appendServerTypes(),this.loading=!1}checkValidServers(){this.noValidServers=!this.serverList.some((e=>"success"===e.serverStatus))}checkAllBoxes(){this.selectedServers=[],this.allBoxesSelected||this.serverList.forEach((e=>{this.selectedServers=[...this.selectedServers,e.id]})),this.allBoxesSelected=!this.allBoxesSelected}handleNext(){const e=this.selectedServers||[];0!==e.length?(this.requireRestart&&(o.a.allowServicesRestart=!0),o.a.dataStoreSelectedServers=e,this.newItemUpdatePage.emit("itemProperties")):this.error="noServerSelected"}render(){const{i18n:e,error:r,serverList:t,dataStoreType:a,loading:i,allBoxesSelected:n,noValidServers:l}=this;return(0,s.h)("div",{key:"5d2e1de6526cade7fb145a0b3a88da3ee459861b"},(0,s.h)("arcgis-new-item-description",{key:"d8340c3906f87d0dd2a8be0b05777f047e3150c8",header:"bdfs"===a&&["fileshare","cloud"].includes(o.a.bdfsType)?e.dataStoreServerSelect.bdfsHeading:e.dataStoreServerSelect.heading}),(0,s.h)("p",{key:"c164cacb0b70e474d610e022f32efe6221ca0fc6",class:"sub-heading"},e.dataStoreServerSelect.subHeading),i?(0,s.h)("calcite-loader",{label:"server-loader",text:e.loader.validating}):(0,s.h)(s.F,null,(0,s.h)("div",{class:"row-wrapper"},(0,s.h)("div",{class:"half-row"},(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-checkbox",{disabled:l,checked:n,onCalciteCheckboxChange:()=>{this.checkAllBoxes()}}),e.list.title)),(0,s.h)("div",{class:"half-row"},(0,s.h)("calcite-label",{layout:"inline"},e.list.status))),t.map((e=>(0,s.h)("div",{class:"row-wrapper row-divider"},(0,s.h)("div",{class:"half-row"},(0,s.h)("calcite-label",{layout:"inline",class:"server-wrapper"},(0,s.h)("calcite-checkbox",{disabled:"success"!==e.serverStatus,value:e.id,onCalciteCheckboxChange:e=>{const r=e.target.value;-1===this.selectedServers.indexOf(r)?this.selectedServers=[...this.selectedServers,r]:this.selectedServers=this.selectedServers.filter((e=>e!==r))},checked:this.selectedServers.includes(e.id)}),e.url+(e.serverType&&` (${e.serverType})`))),(0,s.h)("div",{class:"half-row"},(0,s.h)("div",{class:"status-wrapper",title:e.errorMsg||e.serverStatus},(0,s.h)("calcite-icon",{class:{success:"success"===e.serverStatus,failure:"failure"===e.serverStatus,error:"error"===e.serverStatus,validating:"validating"===e.serverStatus},scale:"s",icon:this.serverStatusIcons[e.serverStatus]}),this.convertStatusDisplayText(e)))))),(0,s.h)("arcgis-new-item-alert",{heading:e.dataStoreServerSelect.noServerSelected.heading,description:e.dataStoreServerSelect.noServerSelected.description,active:null!==r&&!i,onAlertDismiss:()=>{this.error=null}})),(0,s.h)("calcite-modal",{key:"9a66e356b5ad3359e6cbb0182877e91467647b8b",open:this.openRequireRestartModal,class:"requireRestartModal",onCalciteModalClose:e=>e.stopPropagation()},(0,s.h)("div",{key:"d1407e027f99a730beaeff5c0af8beaeea33c23d",slot:"content"},"You are registering a folder data store that uses a new path and host that has not been registered with ArcGIS Enterprise. This will cause several of your system and utility services to restart. To avoid disruption, consider registering during off-peak hours.",(0,s.h)("br",{key:"ee6246e14b22864727c7f897582dc60ae3a1e0a5"}),(0,s.h)("br",{key:"bd237b1fabf6abc99c429588b596a42858a0448a"}),"Are you sure you want to proceed"),(0,s.h)("calcite-button",{key:"e7d4c07e486de6bf63b66bdd5bbcba35c045e65c",slot:"secondary",appearance:"outline",onClick:()=>this.closeModal()},"Cancel"),(0,s.h)("calcite-button",{key:"901a3f8efde71d66770a593c76896bdced4b4a08",slot:"primary",onClick:()=>this.acceptRequireRestart()},"OK")))}static get watchers(){return{serverList:["checkValidServers"]}}};c.style=".sub-heading{font-weight:400;color:var(--calcite-color-text-3)}.row-wrapper{margin-top:0.5rem;margin-bottom:0.5rem;display:flex;width:100%;padding-top:0.75rem}.row-divider{box-shadow:0 -1px 0 #eaeaea}.title{gap:0.5rem}.status-wrapper{display:flex;gap:0.5rem;line-height:1rem}.success{--calcite-ui-icon-color:var(--calcite-color-status-success)}.failure{--calcite-ui-icon-color:var(--calcite-color-status-danger)}.error{--calcite-ui-icon-color:var(--calcite-color-status-danger)}.validating{--calcite-ui-icon-color:var(--calcite-color-status-info)}.half-row{width:50%;padding-left:0.5rem;padding-right:0.5rem}.requireRestartModal{--calcite-modal-width:500px;--calcite-modal-height:400px}"},70506:(e,r,t)=>{t.d(r,{e:()=>i});var s,a=t(99004),i={exports:{}};s=i.exports,a.c,function(e){var r={Promise:"undefined"!=typeof window?window.Promise:void 0},t="4.24",s="next";function a(e){if(e.toLowerCase()===s)return s;var r=e&&e.match(/^(\d)\.(\d+)/);return r&&{major:parseInt(r[1],10),minor:parseInt(r[2],10)}}function i(e){return void 0===e&&(e=t),"https://js.arcgis.com/".concat(e,"/")}function o(e){void 0===e&&(e=t);var r=i(e),o=a(e);if(o!==s&&3===o.major){var n=o.minor<=10?"js/":"";return"".concat(r).concat(n,"esri/css/esri.css")}return"".concat(r,"esri/themes/light/main.css")}function n(e){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,r}function l(e,r){if(r){var t=document.querySelector(r);t.parentNode.insertBefore(e,t)}else document.head.appendChild(e)}function c(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function d(e){return!e||a(e)?o(e):e}function h(e,r){var t=d(e),s=c(t);return s||l(s=n(t),r),s}var u={};function v(e){var r=document.createElement("script");return r.type="text/javascript",r.src=e,r.setAttribute("data-esri-loader","loading"),r}function p(e,r,t){var s;t&&(s=f(e,t));var a=function(){r(e),e.removeEventListener("load",a,!1),s&&e.removeEventListener("error",s,!1)};e.addEventListener("load",a,!1)}function f(e,r){var t=function(s){r(s.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",t,!1)};return e.addEventListener("error",t,!1),t}function S(e){void 0===e&&(e={}),u=e}function g(){return document.querySelector("script[data-esri-loader]")}function m(){var e=window.require;return e&&e.on}function y(e){void 0===e&&(e={});var t={};[u,e].forEach((function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}));var s=t.version,a=t.url||i(s);return new r.Promise((function(e,r){var i=g();if(i){var o=i.getAttribute("src");o!==a?r(new Error("The ArcGIS API for JavaScript is already loaded (".concat(o,")."))):m()?e(i):p(i,e,r)}else if(m())r(new Error("The ArcGIS API for JavaScript is already loaded."));else{var n=t.css;n&&h(!0===n?s:n,t.insertCssBefore),p(i=v(a),(function(){i.setAttribute("data-esri-loader","loaded"),e(i)}),r),document.body.appendChild(i)}}))}function b(e){return new r.Promise((function(r,t){var s=window.require.on("error",t);window.require(e,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.remove(),r(e)}))}))}function w(e,r){if(void 0===r&&(r={}),m())return b(e);var t=g(),s=t&&t.getAttribute("src");return!r.url&&s&&(r.url=s),y(r).then((function(){return b(e)}))}e.utils=r,e.loadModules=w,e.getScript=g,e.isLoaded=m,e.loadScript=y,e.setDefaultOptions=S,e.loadCss=h,Object.defineProperty(e,"__esModule",{value:!0})}(s)},28926:(e,r,t)=>{t.d(r,{l:()=>a});var s=t(70506);const a=async(e,r)=>(await s.e.exports.loadModules(e,r)).map((e=>e.__esModule&&e.default?e.default:e))}}]);