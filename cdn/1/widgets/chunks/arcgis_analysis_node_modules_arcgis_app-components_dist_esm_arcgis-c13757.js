/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c13757.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c13757"],{45615:(e,t,a)=>{a.r(t),a.d(t,{arcgis_schema_editor_category:()=>l,arcgis_schema_editor_category_row:()=>d});var i=a(7263),r=a(96034),o=a(29259),n=a(11246),s=a(98525);const c="arcgis-schema-editor-category-row__drag-handle",l=class{constructor(e){(0,i.r)(this,e),this.arcgisSchemaEditorInternalDeleteClick=(0,i.c)(this,"arcgisSchemaEditorInternalDeleteClick",7),this.arcgisSchemaEditorInternalDragHandleInteract=(0,i.c)(this,"arcgisSchemaEditorInternalDragHandleInteract",7),this.listOrderChanged=(0,i.c)(this,"listOrderChanged",7),this.itemRefs={},this.isSpecialDepthState=null,this.isRoot=!1,this.SORTABLE_ANIMATION_TIME=200,this.handleHandleKeyboardEvent=async({event:e,category:t})=>{var a,i,r;const o=e.code;if(!["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(o))return;const s=t.path,{sortable:c,getParentSortable:l,category:d,SORTABLE_ANIMATION_TIME:g}=this,{category:h}=null!==(a=null==l?void 0:l())&&void 0!==a?a:{category:null},y=c.toArray(),u=y.indexOf(s);let p=!1,m=u;const C=d;let f=C;const v=t;switch(y.splice(u,1),o){case"ArrowDown":m=(u+1)%(y.length+1),y.splice(m,0,s);break;case"ArrowUp":m=u-1,m<0&&(m=y.length),y.splice(m,0,s);break;case"ArrowLeft":if(!h)return;p=!1,f=h,m=h.categories.findIndex((e=>e.path===d.path));break;case"ArrowRight":const e=d.categories,t=e.length;if(t<2)return;p=!1,m=(u+1)%t,f=e[m]}const b={fromCategory:C,toCategory:f,fromItemCategory:v,fromIndex:u,toIndex:m};(null===(r=null===(i=this.isMoveValid)||void 0===i?void 0:i.call(this,b))||void 0===r||r)&&(p&&(c.sort(y,!0),await(0,n.t)(g)),this.listOrderChanged.emit(b))},this.renderCategoryContainer=()=>{const{category:e,rootCategoryPath:t,canAddCategory:a,isRoot:r,isCollapsed:n,isAddingCategory:s,isBeingDragged:c,canEditCategory:l,saveNewTitle:d,saveNewCategory:g,maxDepth:h,i18n:y,isMoveValid:u,canDeleteCategory:p,newCategoryMode:m,isSpecialDepthState:C,isLastInList:f,handleHandleKeyboardEvent:v}=this,b=e.path,w=e.categories,I=w.length,_=I>0,E=!s,S=s||"max-depth"===C||c||!a||n,x=n||c||S&&E,k=!_||"next-depth-max"===C;return(0,i.h)("div",{class:{"arcgis-schema-editor-category__outer-category-container":!0,"arcgis-schema-editor-category__outer-category-container--last-in-list":f,"arcgis-schema-editor-category__outer-category-container--first-level":"first-level"===C,"arcgis-schema-editor-category__outer-category-container--hidden":x,"arcgis-schema-editor-category__outer-category-container--root":r}},_&&(0,i.h)("ul",{class:"arcgis-schema-editor-category__category-container",ref:e=>{this.dragContainerRef=e,this.sortable||this.initializeSortable()}},w.map(((e,r)=>{const o=e.path;return(0,i.h)("li",{class:"arcgis-schema-editor-category__row-container",key:o,"data-sortable-id":o},(0,i.h)("arcgis-schema-editor-category",{isLastInList:r===I-1,category:e,rootCategoryPath:t,newCategoryMode:m,canAddCategory:a,canDeleteCategory:p,canEditCategory:l,i18n:y,maxDepth:h,isMoveValid:u,saveNewTitle:d,saveNewCategory:g,getParentSortable:()=>({sortable:this.sortable,category:this.category,getParentSortable:this.getParentSortable}),ref:e=>this.itemRefs[o]=e,onArcgisSchemaEditorInternalDragHandleInteract:e=>{e.stopPropagation(),v(e.detail)}}))}))),(0,i.h)("arcgis-schema-editor-category-row",{class:{"arcgis-schema-editor-category__new-category--hide":E},category:{categories:[],count:0,path:(0,o.b)(b,{title:"new-category"}),title:""},isCollapsible:!1,isCollapsed:!0,isNewCategory:!0,canDeleteCategory:!1,canEditCategory:()=>!0,i18n:y,onArcgisSchemaEditorInternalCancelClick:()=>this.isAddingCategory=!1,saveNewTitle:async e=>{const t=await g(e);return t&&(this.isAddingCategory=!1),t},ref:e=>this.newCategoryRef=e}),(0,i.h)("div",{class:{"arcgis-schema-editor-category__add-category-btn":!0,"arcgis-schema-editor-category__add-category-btn--hide":S}},(0,i.h)("div",{class:{"arcgis-schema-editor-category__add-category-btn-divider":k}}),(0,i.h)("calcite-button",{appearance:"transparent",kind:"neutral",onClick:()=>this.isAddingCategory=!0,iconStart:"plus-circle",ref:e=>this.addCategoryButtonRef=e}),(0,i.h)("calcite-tooltip",{referenceElement:this.addCategoryButtonRef},(0,i.h)("div",null,r?y.categoryItem.addCategory:y.categoryItem.addSubcategory))))},this.category=void 0,this.rootCategoryPath=void 0,this.canAddCategory=void 0,this.canDeleteCategory=void 0,this.newCategoryMode=void 0,this.showInputByDefault=!1,this.canEditCategory=void 0,this.maxDepth=void 0,this.i18n=void 0,this.isMoveValid=void 0,this.saveNewTitle=void 0,this.saveNewCategory=void 0,this.getParentSortable=void 0,this.isLastInList=!1,this.isCollapsed=!1,this.isBeingDragged=!1,this.isAddingCategory=!1,this.addCategoryButtonRef=void 0}componentWillLoad(){const e=this.category.path;this.isRoot=null===e;const t=(0,s.h)(e,this.rootCategoryPath);this.isSpecialDepthState=t>this.maxDepth&&!this.isRoot?"max-depth":t===this.maxDepth?"next-depth-max":1===t?"first-level":null,this.isCollapsed=this.newCategoryMode&&!this.isRoot}componentDidLoad(){this.onShowInputByDefaultChange(),this.initializeSortable()}initializeSortable(){!this.sortable&&this.dragContainerRef&&(this.sortable=r.S.create(this.dragContainerRef,{group:"arcgis-schema-editor",dataIdAttr:"data-sortable-id",animation:this.SORTABLE_ANIMATION_TIME,handle:`.${c}`,chosenClass:"arcgis-schema-editor-category-row--dragging",onSort:e=>{var t,a;const{from:i,to:r,oldIndex:o,newIndex:n,item:s}=e,c={fromCategory:i.closest("arcgis-schema-editor-category").category,toCategory:r.closest("arcgis-schema-editor-category").category,fromItemCategory:s.querySelector("arcgis-schema-editor-category").category,fromIndex:o,toIndex:n},l=null===(a=null===(t=this.isMoveValid)||void 0===t?void 0:t.call(this,c))||void 0===a||a;null!==l&&(l?this.listOrderChanged.emit(c):i.insertBefore(s,i.children[o>n?o+1:o]))},setData:e=>{e.setData("foo","bar")}}))}onShowInputByDefaultChange(){this.isAddingCategory=this.newCategoryMode&&this.isRoot&&this.showInputByDefault}onIsAddingCategoryChange(){var e;null===(e=this.newCategoryRef)||void 0===e||e.reset()}async expandOrCollapseAll(e){this.isRoot||(this.isCollapsed=e),Object.values(this.itemRefs).forEach((t=>{null==t||t.expandOrCollapseAll(e)}))}async setIsBeingDragged(e){this.category.categories.length>0&&(this.isBeingDragged=e)}render(){const{category:e,canDeleteCategory:t,canEditCategory:a,isRoot:r,isCollapsed:o,i18n:n,renderCategoryContainer:s,saveNewTitle:c,isSpecialDepthState:l,arcgisSchemaEditorInternalDeleteClick:d,arcgisSchemaEditorInternalDragHandleInteract:g}=this;return(0,i.h)(i.H,{key:"917c36ff8e1330bda232b8c760f81e3b96e42a13"},!r&&(0,i.h)("arcgis-schema-editor-category-row",{key:"f3083b8b9415f6a070ddb1833404c755d5c05131",category:e,isCollapsible:"max-depth"!==l,isCollapsed:o,canDeleteCategory:t,canEditCategory:e=>a({category:e,parentCategory:this.category}),i18n:n,onArcgisSchemaEditorInternalDeleteClick:e=>{e.stopPropagation(),d.emit(e.detail)},onArcgisSchemaEditorInternalExpandClick:e=>this.isCollapsed=e.detail.isCollapsed,saveNewTitle:c,onArcgisSchemaEditorRowInternalDragHandleInteract:({detail:e})=>{g.emit(e)}}),s())}get el(){return(0,i.d)(this)}static get watchers(){return{showInputByDefault:["onShowInputByDefaultChange"],isAddingCategory:["onIsAddingCategoryChange"]}}};l.style=".arcgis-schema-editor-category__category-container{list-style-type:none;margin-top:0px;margin-bottom:0px;padding-inline-start:0px}.arcgis-schema-editor-category__outer-category-container{margin-top:0.5rem;padding-inline-start:1rem;padding-bottom:1rem;margin-inline-start:1rem;border-left:1px solid var(--calcite-color-border-2)}.arcgis-schema-editor-category__outer-category-container:not(:last-child){margin-bottom:1.5rem}.arcgis-schema-editor-category__outer-category-container--last-in-list{padding-bottom:0.5rem}.arcgis-schema-editor-category__outer-category-container--first-level{padding-bottom:1.5rem}.arcgis-schema-editor-category__outer-category-container--root{margin-left:0px;margin-right:0px;padding-left:0px;padding-right:0px;border-width:0px}.arcgis-schema-editor-category__outer-category-container--hidden{display:none}.arcgis-schema-editor-category__row-container:not(:last-child){margin-bottom:0.5rem}.arcgis-schema-editor-category__add-category-btn-divider{margin-inline-start:1rem;margin-top:0.5rem;height:0.75rem;border-left:1px solid var(--calcite-color-border-2)}.arcgis-schema-editor-category__add-category-btn--hide,.arcgis-schema-editor-category__new-category--hide{display:none}";const d=class{constructor(e){(0,i.r)(this,e),this.arcgisSchemaEditorRowInternalDragHandleInteract=(0,i.c)(this,"arcgisSchemaEditorRowInternalDragHandleInteract",7),this.arcgisSchemaEditorInternalDeleteClick=(0,i.c)(this,"arcgisSchemaEditorInternalDeleteClick",7),this.arcgisSchemaEditorInternalExpandClick=(0,i.c)(this,"arcgisSchemaEditorInternalExpandClick",7),this.arcgisSchemaEditorInternalCancelClick=(0,i.c)(this,"arcgisSchemaEditorInternalCancelClick",7),this.onCancelEdit=()=>{const{arcgisSchemaEditorInternalCancelClick:e,isNewCategory:t}=this;t||(this.isEditing=!1),this.editedCategoryTitle=this.category.title,e.emit()},this.onSaveEdit=async()=>{const{category:e,editInputRef:t,editedCategoryTitle:a,saveNewTitle:i,setInvalid:r,isNewCategory:o}=this;if(!a)return r(),!1;if(a===e.title&&!o)return this.isEditing=!1,!0;t.status="idle";try{return await i({newTitle:a.trim(),path:e.path,categoryCount:e.count})?(o||(this.isEditing=!1),!0):(r(),!1)}catch(e){return o||(this.isEditing=!1),console.error(e),!1}},this.setInvalid=()=>{const{editInputRef:e}=this;e.status="invalid",e.setFocus()},this.category=void 0,this.i18n=void 0,this.isNewCategory=!1,this.canEditCategory=void 0,this.canDeleteCategory=void 0,this.isCollapsible=void 0,this.isCollapsed=void 0,this.saveNewTitle=void 0,this.isEditing=this.isNewCategory,this.editedCategoryTitle=this.category.title,this.expandCollapseButtonRef=void 0,this.deleteButtonRef=void 0,this.editInputRef=void 0,this.cantEditIconRef=void 0,this.isInteracting=!1}async reset(){const{isNewCategory:e,category:t,canEditReason:a}=this;e&&!0===a&&(this.editedCategoryTitle=t.title,this.editInputRef.status="idle",this.isEditing=!1,await(0,n.t)(50),this.isEditing=!0,this.editInputRef.setFocus())}async setFocus(){this.editInputRef.setFocus()}componentWillLoad(){var e,t;this.canEditReason=null===(t=null===(e=this.canEditCategory)||void 0===e?void 0:e.call(this,this.category))||void 0===t||t}render(){const{category:e,isCollapsed:t,isEditing:a,isCollapsible:r,canDeleteCategory:o,canEditReason:n,i18n:s,editedCategoryTitle:l,onCancelEdit:d,onSaveEdit:g,arcgisSchemaEditorInternalExpandClick:h,isNewCategory:y}=this,u=e.count,p=a?l:`${l} ${u?`(${u})`:""}`,m=!0===n,C=m&&!a&&!y&&o;return(0,i.h)(i.H,{key:"55cc2ddc2b1aee42d3081d7c841820cc05bb031f"},(0,i.h)("div",{key:"1bd35c1a65071c03800031c0ff73d7a298e9a61a",class:"arcgis-schema-editor-category-row"},!y&&!a&&(0,i.h)("calcite-button",{key:"c7683e44fe1225d3095ec532c9ab5523bbdb2d6b",appearance:"transparent",kind:"neutral",iconStart:"drag",class:c,onFocus:()=>this.isInteracting=!0,onBlur:()=>this.isInteracting=!1,onKeyDown:t=>{this.isInteracting&&this.arcgisSchemaEditorRowInternalDragHandleInteract.emit({category:e,event:t})}}),r&&(0,i.h)(i.F,{key:"0055603a130518a6c470de5ff762f10f74875eaa"},(0,i.h)("calcite-button",{key:"763da2969b157c8ee5fe1bd13ace65337c56b794",appearance:"transparent",kind:"neutral",onClick:()=>h.emit({isCollapsed:!t}),iconStart:t||a?"chevron-up":"chevron-down",class:"cta",ref:e=>this.expandCollapseButtonRef=e}),(0,i.h)("calcite-tooltip",{key:"63beb9811b3c916d2458119402ed6c714d4d3ba7",referenceElement:this.expandCollapseButtonRef},(0,i.h)("div",{key:"2620f9a5b3a3d35a94dfc1b0aafaa8f51fa79c9e",class:"btn-popover"},t?s.categoryItem.expand:s.categoryItem.collapse))),m?(0,i.h)("calcite-inline-editable",{class:"arcgis-schema-editor-category-row__inline-input",controls:!0,onKeyDown:e=>{switch(e.key){case"Escape":d();break;case"Enter":g()}},editingEnabled:a,afterConfirm:async()=>{if(!1===await g())throw new Error},onCalciteInlineEditableEditCancel:e=>{e.stopPropagation(),d()},onCalciteInternalInlineEditableEnableEditingChange:()=>this.isEditing=!0},(0,i.h)("calcite-input",{value:p,onCalciteInputInput:e=>this.editedCategoryTitle=e.target.value,required:!0,ref:e=>this.editInputRef=e})):(0,i.h)(i.F,null,(0,i.h)("div",{class:"arcgis-schema-editor-category-row__inline-input"},p),(0,i.h)("calcite-action",{class:"arcgis-schema-editor-category-row__cant-edit-reason",icon:"exclamation-mark-triangle-f",appearance:"transparent",label:n,ref:e=>this.cantEditIconRef=e,text:"",textEnabled:!1}),(0,i.h)("calcite-tooltip",{referenceElement:this.cantEditIconRef},(0,i.h)("div",{class:"btn-popover"},n))),C&&(0,i.h)(i.F,{key:"44823ad65f7b82fd14afc1123b3098cd7f599b94"},(0,i.h)("calcite-button",{key:"1210b24ab63445e93d356840a535dc8eef538fdc",appearance:"transparent",kind:"danger",onClick:()=>this.arcgisSchemaEditorInternalDeleteClick.emit({path:e.path,categoryCount:u}),iconStart:"trash",class:"cta",ref:e=>this.deleteButtonRef=e}),(0,i.h)("calcite-tooltip",{key:"4da722e996098c53a2acb44cf568249cb2d5aa6f",referenceElement:this.deleteButtonRef},(0,i.h)("div",{key:"8067c791e5be04931e50298b494ea457edcfabf2",class:"btn-popover"},s.categoryItem.deleteCategory)))))}get el(){return(0,i.d)(this)}};d.style=".arcgis-schema-editor-category-row{display:flex;align-items:center;background-color:var(--calcite-color-foreground-1);height:2.5rem}.arcgis-schema-editor-category-row--editing{padding-left:0.5rem;padding-right:0.5rem}.arcgis-schema-editor-category-row__inline-input{font-size:0.875rem;width:100%}.arcgis-schema-editor-category-row__cta{display:flex;align-items:center;justify-content:center;height:100%;width:2.5rem}.arcgis-schema-editor-category-row__drag-handle{height:100%}.arcgis-schema-editor-category-row__btn-popover{white-space:nowrap;padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem}.arcgis-schema-editor-category-row__cant-edit-reason{--calcite-ui-icon-color:var(--calcite-color-status-warning)}.arcgis-schema-editor-category-row--dragging{opacity:0.25}"},29259:(e,t,a)=>{a.d(t,{U:()=>i,a:()=>n,b:()=>r,g:()=>o});const i="/Categories",r=(e,t,a=!0)=>{const i=null!=e?e:"";return`${i}${i.endsWith("/")?"":"/"}${a?t.title.toLocaleLowerCase():t.title}`};function o(e){var t;let a=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return a&&"/"!==a.charAt(0)&&(a=`/${a}`),a||i}const n=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},11246:(e,t,a)=>{a.d(t,{a:()=>l,b:()=>h,c:()=>r,d:()=>i,e:()=>o,f:()=>d,g:()=>y,i:()=>n,m:()=>s,t:()=>c,u:()=>g});const i=(e,t)=>{let a,i="idle";const r=(...r)=>new Promise((o=>{switch(i){case"flushed":i="idle",a?(clearTimeout(a),o(e(...r))):o(null);break;case"invoked":clearTimeout(a),i="idle",o(e(...r));break;case"cancelled":clearTimeout(a),i="idle",o(null);break;default:a&&clearTimeout(a),i="pending",a=setTimeout((()=>(i="idle",o(e(...r)))),t)}}));return r.flush=function(...e){return i="flushed",r(...e)},r.invoke=function(...e){return i="invoked",r(...e)},r.cancel=function(...e){return i="cancelled",r(...e)},r.getStatus=function(){return i},r},r=(e,t)=>{let a;return(...i)=>new Promise((r=>{a||(a=setTimeout((()=>{clearTimeout(a),a=void 0,r(e(...i))}),t))}))};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(e){return null!=e}async function s(e,t){return await Promise.all([e,c(t)]),e}function c(e){return new Promise((t=>setTimeout(t,e)))}const l=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:a,data:i}=t(e);return[a,i]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,a)=>e&&t.indexOf(a)>-1),!0);function g(e,t){const a=[],i={};return e.forEach((e=>{const r=t(e);null==i[r]&&(i[r]=e,a.push(e))})),a}function h(e){const t={boolean:{},number:{},string:{}},a=[];return e.filter((e=>{let i=typeof e;return i in t?!t[i].hasOwnProperty(e)&&(t[i][e]=!0):!(a.indexOf(e)>=0)&&a.push(e)}))}const y=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((a,i)=>e.slice(t*i,t+t*i)))},98525:(e,t,a)=>{a.d(t,{M:()=>C,a:()=>s,b:()=>m,c:()=>p,d:()=>l,e:()=>o,f:()=>n,g:()=>r,h:()=>c,i:()=>d,j:()=>u});var i=a(29259);const r=(e,{fromCategory:{path:t},toCategory:{path:a},fromIndex:i,toIndex:r},o)=>{const n=structuredClone(e),s=l(n,t,o);let c=s;t!==a&&(c=l(n,a,o));const[d]=s.targetCategory.categories.splice(i,1);return c.targetCategory.categories.splice(r,0,d),g(n)},o=(e,{newTitle:t,path:a},i)=>{const r=structuredClone(e);return l(r,a,i).targetCategory.title=t,g(r)},n=(e,{newTitle:t,path:a},i)=>{const r=structuredClone(e),o=a.replace(/\/[^/]+$/,"");if(o){const{targetCategory:e}=l(r,o,i);e.categories.push({title:t,categories:[],count:0,path:null})}else r.categories.push({title:t,categories:[],count:0,path:null});return g(r)},s=(e,{path:t},a)=>{const i=structuredClone(e),{targetIndex:r,parentCategory:o}=l(i,t,a);return null==o||o.categories.splice(r,1),g(i)},c=(e,t)=>{var a;return null!==(a=null==e?void 0:e.toLocaleLowerCase().replace(t.toLowerCase(),"").slice(1).split("/").length)&&void 0!==a?a:0},l=(e,t,a)=>{var r;const o=a.toLocaleLowerCase();if(null==t||t===o)return{targetCategory:e,targetIndex:1,parentCategory:null,originalPath:t};const n=t.slice(1).split("/");let s=0===t.toLocaleLowerCase().indexOf(o)?(0,i.b)("",{title:n.shift()}):"",c=null,l=e,d=0,g=s;do{s=(0,i.b)(s,{title:n.shift()}),c=l,d=l.categories.findIndex((e=>e.path.toLocaleLowerCase()===s.toLocaleLowerCase())),l=l.categories[d],g+=`/${null!==(r=null==l?void 0:l.title)&&void 0!==r?r:""}`}while(n.length>0&&l.categories.length);return g=g.replace(o,a),{targetCategory:l,targetIndex:d,parentCategory:c,originalPath:g}},d=({categoryAggregationData:e,categorySchema:t,rootCategoryPath:a})=>{var i,r;const o=a.toLocaleLowerCase();return{title:"",path:null,count:null!==(r=null===(i=e.fieldValues.find((e=>e.value===o)))||void 0===i?void 0:i.count)&&void 0!==r?r:0,categories:y({parentPath:null,categorySchema:t,categoryAggregationData:e,lowerCaseRootCategoryPath:o})}},g=e=>e.categories.map(h),h=e=>({title:e.title,categories:e.categories.map(h)}),y=({categoryAggregationData:e,categorySchema:t,parentPath:a,lowerCaseRootCategoryPath:r})=>t.map((t=>{var o,n,s;const c=(0,i.b)(null!=a?a:r,t),l=null===(o=e.fieldValues.find((e=>e.value===c)))||void 0===o?void 0:o.count,d=y({parentPath:c,categorySchema:null!==(n=t.categories)&&void 0!==n?n:[],categoryAggregationData:e,lowerCaseRootCategoryPath:r});return{title:null!==(s=t.displayName)&&void 0!==s?s:t.title,path:c,count:null!=l?l:0,categories:d}})),u=e=>e.reduce(((e,t)=>{var a;return e+1+u(null!==(a=t.categories)&&void 0!==a?a:[])}),0),p=({targetCategory:e,targetParentCategory:t})=>{var a;const i=null===(a=e.title.toLocaleLowerCase())||void 0===a?void 0:a.trim();return i?i.length>C?"maxCharacter":t.categories.some((t=>t.title.toLowerCase()===i&&t.path!==e.path))?"destinationHasSameName":null:"emptyTitle"},m=({rootCategoryPath:e,uiCategory:t,uiPath:a})=>l(t,a,e).originalPath,C=100}}]);