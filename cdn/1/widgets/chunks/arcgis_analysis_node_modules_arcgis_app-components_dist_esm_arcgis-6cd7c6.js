/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6cd7c6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-6cd7c6"],{38393:(e,l,o)=>{o.r(l),o.d(l,{arcgis_smart_mapping_flow_color_slider:()=>n});var r=o(7263),s=(o(77040),o(70506),o(82646)),i=o(95875),t=o(13521),a=o(22601);o(99004),o(58233),o(28926),o(78613),o(62159),o(11935),o(1991);const n=class{constructor(e){(0,r.r)(this,e),this.arcgisSmartMappingFlowColorSliderChange=(0,r.c)(this,"arcgisSmartMappingFlowColorSliderChange",7),this.arcgisSmartMappingFlowColorSliderError=(0,r.c)(this,"arcgisSmartMappingFlowColorSliderError",7),this.currentStopValues=[],this.styleSheetStatus="not-loaded"}componentDidLoad(){this.flowItemNode=(0,s.f)(this.hostElement,"calcite-flow-item")}render(){const{config:e}=s.s;return(0,r.h)(r.H,{key:"a349b5d6d6d426a1ddf4953f8121823f45706f2b"},(0,r.h)("link",{key:"b84e58616b71fae90f8ee9beda2cd6ed47a8fa1b",rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,r.f)(this.hostElement)},onError:()=>{this.styleSheetStatus="failed",(0,r.f)(this.hostElement)}}),"loaded"===this.styleSheetStatus?this.renderFlowColorSlider():"not-loaded"===this.styleSheetStatus?this.renderFlowColorSliderLoading():null)}renderFlowColorSlider(){var e,l;const{layer:o,strings:i}=s.s,t=o,a=(0,s.a9)(),n=(0,s.d)(a,"color");if(!n)return;const{sourceJSON:h}=t,{minValues:u,maxValues:d}=h,c=(0,s.J)(a,"color"),p=null!==(e=null==c?void 0:c.minSliderValue)&&void 0!==e?e:null==u?void 0:u[0],m=null!==(l=null==c?void 0:c.maxSliderValue)&&void 0!==l?l:null==d?void 0:d[0];if((0,s.O)(p)&&(0,s.O)(m)&&p!==m&&1!==(null==n?void 0:n.stops.length)){const e=this.prepareFlowColorSlider();return n.stops.forEach(((e,l)=>{this.currentStopValues[l]=e.value})),(e||this.flowColorSlider)&&this.flowColorSlider.min!==this.flowColorSlider.max?(0,r.h)("div",{class:"slider-box"},(0,r.h)("calcite-label",null,i.panels.flow.dataRange),(0,r.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),(0,r.h)("div",null,"\xa0"),this.renderResetButton()),(0,r.h)("div",{ref:e=>{e&&this.afterFlowColorSliderCreate(e)}})):this.flowColorSlider&&this.flowColorSlider.min===this.flowColorSlider.max?null:this.renderFlowColorSliderLoading()}this.flowColorSlider&&(this.flowColorSlider.destroy(),this.flowColorSlider=void 0)}renderFlowColorSliderLoading(){const{strings:e}=s.s;return(0,r.h)("div",{class:"slider-box"},(0,r.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=s.s;return(0,r.h)("arcgis-smart-mapping-action",{text:e.panels.flow.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderResetButton(){const{strings:e}=s.s;return(0,r.h)("arcgis-smart-mapping-action",{text:e.panels.flow.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareFlowColorSlider(){var e,l,o,r;const{layer:i,modules:a}=s.s,n=i,h=(0,s.a9)(),u=(0,s.d)(h,"color"),{sourceJSON:d}=n,{minValues:c,maxValues:p}=d,m=(0,s.J)(h,"color"),f=null!==(e=null==m?void 0:m.minSliderValue)&&void 0!==e?e:null==c?void 0:c[0],S=null!==(l=null==m?void 0:m.maxSliderValue)&&void 0!==l?l:null==p?void 0:p[0],g=m?(0,s.aI)(m.theme,u.stops):void 0;if(!this.flowColorSlider||!u&&this.flowColorSlider.stops){null===(o=this.flowColorSlider)||void 0===o||o.destroy();let e={min:f,max:S};e=Object.assign(Object.assign({},e),g),e.stops=u.stops,e.precision=(0,t.g)(u.stops),e.labelFormatFunction=l=>l.toFixed(e.precision),this.flowColorSlider=new a.ColorSlider(e),this.flowColorSlider.min===this.flowColorSlider.max&&this.flowColorSlider.set(e),this.createFlowColorSliderChangeEvents()}else{if("dragging"===(null===(r=this.flowColorSlider.slider)||void 0===r?void 0:r.state))return!0;let e={min:f,max:S};e=Object.assign(Object.assign({},e),g),e.stops=u.stops,e.precision=(0,t.g)(u.stops),this.flowColorSlider.set(e)}return(0,s.O)(this.flowColorSlider)}handleInvertSlider(){const e=(0,s.a9)(),l=(0,s.d)(e,"color");let o=l.stops.map((e=>e.color));o=o.reverse(),l.stops.forEach(((e,l)=>{e.color=o[l]})),(0,s.a8)(),(0,r.f)(this.hostElement),this.arcgisSmartMappingFlowColorSliderChange.emit()}handleResetSlider(){const e=(0,s.a9)();(0,i.r)((0,a.c)({includeColorVariable:!0}),this.flowItemNode).then((l=>{const o=(0,s.d)(e,"color"),i=(0,s.J)(e,"color"),t=(0,s.d)(l.renderer,"color"),a=(0,s.J)(l.renderer,"color");i.minSliderValue=a.minSliderValue,i.maxSliderValue=a.maxSliderValue,o.stops.forEach(((e,l)=>e.value=t.stops[l].value)),(0,s.a8)(),(0,r.f)(this.hostElement)}),(e=>this.arcgisSmartMappingFlowColorSliderError.emit(e)))}afterFlowColorSliderCreate(e){if(this.flowColorSlider.container)e.append(this.flowColorSlider.container);else{const l=document.createElement("div");e.append(l),this.flowColorSlider.container=l}}createFlowColorSliderChangeEvents(){this.flowColorSlider&&(this.flowColorSlider.on("min-change",(e=>{e.value>this.currentStopValues[0]?(this.flowColorSlider.stops.forEach(((e,l)=>{e.value=this.currentStopValues[l]})),this.handleMinMaxChange(this.currentStopValues[0],this.flowColorSlider.max)):this.handleMinMaxChange(e.value,this.flowColorSlider.max)})),this.flowColorSlider.on("max-change",(e=>{e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.flowColorSlider.stops.forEach(((e,l)=>{e.value=this.currentStopValues[l]})),this.handleMinMaxChange(this.flowColorSlider.min,this.currentStopValues[this.currentStopValues.length-1])):this.handleMinMaxChange(this.flowColorSlider.min,e.value)})),this.flowColorSlider.on("thumb-change",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("thumb-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("segment-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))))}handleMinMaxChange(e,l){const o=(0,s.a9)(),i=(0,s.J)(o,"color")||{};i.minSliderValue=e,i.maxSliderValue=l,o.authoringInfo.classificationMethod="manual",(0,s.a8)(),(0,r.f)(this.hostElement),this.arcgisSmartMappingFlowColorSliderChange.emit()}updateRendererStops(e){const l=(0,s.a9)(),o=(0,s.d)(l,"color");o.stops=e,o.stops.forEach(((e,l)=>{this.currentStopValues[l]=e.value})),(0,s.a8)(),this.arcgisSmartMappingFlowColorSliderChange.emit()}get hostElement(){return(0,r.d)(this)}};n.style=".slider-box{height:275px}.slider-box .esri-color-slider{min-width:200px}.slider-box .esri-color-slider .esri-slider .esri-slider__content{height:130px}.slider-box .esri-color-slider .esri-slider .esri-slider__label,.slider-box .esri-color-slider .esri-slider .esri-slider__min,.slider-box .esri-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.slider-box .esri-color-slider .esri-slider .esri-slider__label:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__min:hover,.slider-box .esri-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-box-buttons-front{display:flex}"},95875:(e,l,o)=>{let r,s;function i(e){e.loading=!1}function t(e,l){return function(e){e.loading=!0,s=!1,r&&clearTimeout(r),r=setTimeout((()=>{i(e),s=!0}),6e4)}(l),e.then((e=>(i(l),s?Promise.reject(new Error("timeout")):Promise.resolve(e)))).catch((e=>(i(l),Promise.reject(e))))}o.d(l,{r:()=>t})},13521:(e,l,o)=>{o.d(l,{a:()=>a,b:()=>t,g:()=>d,u:()=>i});var r=o(1991),s=o(82646);o(70506);function i(e){const{modules:l}=s.s,o=(0,s.b)(),i=l.esriLang.clone(o.classBreakInfos);o.classBreakInfos=[],i.forEach(((l,t)=>{l=function(e,l,o,i){if((0,r.i)(l))if(0===l);else if(l<1){const r=Math.round(1/l);e.minValue="first"===i?Math.floor(e.minValue/l)/r:Math.round(e.minValue/l)/r,e.maxValue="last"===i?Math.ceil(e.maxValue/l)/r:Math.round(e.maxValue/l)/r,e.label=`${o>0?"> ":""}${e.minValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})} - ${e.maxValue.toLocaleString(s.s.fullLocale,{maximumSignificantDigits:15})}`}else e.minValue="first"===i?Math.floor(e.minValue/l)*l:Math.round(e.minValue/l)*l,e.maxValue="last"===i?Math.ceil(e.maxValue/l)*l:Math.round(e.maxValue/l)*l,e.label=(o>0?"> ":"")+e.minValue.toLocaleString()+" - "+e.maxValue.toLocaleString();return e}(l,e,t,0===t?"first":t===i.length-1?"last":void 0),o.addClassBreakInfo({minValue:l.minValue,maxValue:l.maxValue,symbol:l.symbol,label:l.label})}))}function t(e){const l=(0,s.b)().classBreakInfos;let o=e,r=1/0;l.forEach((e=>{o||(o=Math.max(n(e.minValue),n(e.maxValue))),r=Math.min(r,e.maxValue-e.minValue)}));const i=[];return r>1e7?(i.push(1e7),i.push(1e6),i.push(1e5),i.push(1e4),i.push(1e3),i.push(100),i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01)):r>1e6?(i.push(1e6),i.push(1e5),i.push(1e4),i.push(1e3),i.push(100),i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01)):r>1e5?(i.push(1e5),i.push(1e4),i.push(1e3),i.push(100),i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01)):r>1e4?(i.push(1e4),i.push(1e3),i.push(100),i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01)):r>1e3?(i.push(1e3),i.push(100),i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01),o>3&&i.push(.001)):r>100?(i.push(100),i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01),o>3&&i.push(.001),o>4&&i.push(1e-4),o>5&&i.push(1e-5)):r>10?(i.push(10),o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01),o>3&&i.push(.001),o>4&&i.push(1e-4),o>5&&i.push(1e-5),o>6&&i.push(1e-6)):r>1?(o>0&&i.push(1),o>1&&i.push(.1),o>2&&i.push(.01),o>3&&i.push(.001),o>4&&i.push(1e-4),o>5&&i.push(1e-5),o>6&&i.push(1e-6)):r>.1?(o>1&&i.push(.1),o>2&&i.push(.01),o>3&&i.push(.001),o>4&&i.push(1e-4),o>5&&i.push(1e-5),o>6&&i.push(1e-6)):r>.01?(o>2&&i.push(.01),o>3&&i.push(.001),o>4&&i.push(1e-4),o>5&&i.push(1e-5),o>6&&i.push(1e-6)):r>.001?(o>3&&i.push(.001),o>4&&i.push(1e-4),o>5&&i.push(1e-5),o>6&&i.push(1e-6),o>7&&i.push(1e-7)):r>1e-4?(o>4&&i.push(1e-4),o>5&&i.push(1e-5),o>6&&i.push(1e-6),o>7&&i.push(1e-7),o>8&&i.push(1e-8)):r>1e-5&&(o>5&&i.push(1e-5),o>6&&i.push(1e-6),o>7&&i.push(1e-7),o>8&&i.push(1e-8),o>9&&i.push(1e-9)),i}function a(){const e=(0,s.b)();let l=1e10;return e.classBreakInfos.forEach((e=>{l=Math.min(l,h(e.minValue)),l=Math.min(l,h(e.maxValue))})),l}function n(e){let l=1;for(;Math.round(e*l)/l!==e;)l*=10;return Math.log(l)/Math.LN10}function h(e){let l=1e-8;for(;u(Math.round(e/l)*l)===e;)l*=10;return l/10}function u(e){return parseFloat(e.toPrecision(12))}function d(e){var l,o,s,i,t,a,h,d;let c=0;e.forEach((e=>{(0,r.i)(e.value)?c=Math.max(n(u(e.value)),c):((0,r.i)(e.minValue)&&(c=Math.max(n(u(e.minValue)),c)),(0,r.i)(e.maxValue)&&(c=Math.max(n(u(e.maxValue)),c)),(0,r.i)(e.min)&&(c=Math.max(n(u(e.min)),c)),(0,r.i)(e.max)&&(c=Math.max(n(u(e.max)),c)))})),c=Math.min(c,3);const p=e[0],m=e[e.length-1],f=Math.min(null!==(o=null!==(l=p.minValue)&&void 0!==l?l:p.min)&&void 0!==o?o:p.value,null!==(i=null!==(s=m.minValue)&&void 0!==s?s:m.min)&&void 0!==i?i:m.value),S=Math.max(null!==(a=null!==(t=p.maxValue)&&void 0!==t?t:p.max)&&void 0!==a?a:p.value,null!==(d=null!==(h=m.maxValue)&&void 0!==h?h:m.max)&&void 0!==d?d:m.value)-f;return S/e.length<2e-7?c=8:S/e.length<2e-6?c=7:S/e.length<2e-5?c=6:S/e.length<2e-4?c=5:S/e.length<.002?c=4:S/e.length<.02?c=3:S/e.length<.2?c=Math.max(c,2):S/e.length<2&&(c=Math.max(c,1)),Math.round(c)}},22601:(e,l,o)=>{o.d(l,{a:()=>i,c:()=>s,f:()=>t});o(77040),o(70506);var r=o(82646);function s(e){const{layer:l,mapView:o,modules:s}=r.s,i=l;return e=e||{},s.RasterFlowCreator.createRenderer({layer:i,view:o,theme:e.flowTheme||"flow-line",includeColorVariable:e.includeColorVariable,legendOptions:e.legendOptions,flowRepresentation:e.flowRepresentation,flowScheme:e.flowScheme||t()}).then((l=>(l.layerEffect&&-1===l.layerEffect.indexOf("drop-shadow")&&(i.effect=l.layerEffect),l.renderer.color=l.renderer.color&&(e.color||l.renderer.color),Promise.resolve(l))),(e=>Promise.reject(e)))}function i(e){var l;const{layer:o,mapView:s,modules:i}=r.s,a=o;e=e||{};const n=(0,r.a9)(),h=(0,r.d)(n,"color"),u=n.authoringInfo,d=e.flowTheme||(null==u?void 0:u.flowTheme)||"flow-line";return i.RasterFlowCreator.createRenderer({layer:a,view:s,theme:d,includeColorVariable:null!==(l=e.includeColorVariable)&&void 0!==l?l:!!h,legendOptions:e.legendOptions||(null==h?void 0:h.legendOptions),flowRepresentation:e.flowRepresentation||n.flowRepresentation,flowScheme:e.flowScheme}).then((l=>{const o=(0,r.J)(n,"color"),s=(0,r.J)(l.renderer,"color");(null==o?void 0:o.minSliderValue)&&(null==o?void 0:o.maxSliderValue)&&s&&(s.minSliderValue=o.minSliderValue,s.maxSliderValue=o.maxSliderValue);const a=(0,r.d)((0,r.a9)(),"color"),h=(0,r.d)(l.renderer,"color");a&&h&&a.stops.forEach(((e,l)=>{h.stops[l].value=e.value})),l.renderer.color=l.renderer.color&&(e.color||n.color||l.renderer.color);return(e.flowScheme||t())&&a&&h&&a.stops.forEach(((e,l)=>{h.stops[l].color=new i.esriColor(e.color.toJSON())})),d===u.flowTheme&&(l.renderer.flowSpeed=n.flowSpeed,l.renderer.density=n.density,l.renderer.trailLength=n.trailLength,l.renderer.trailWidth=n.trailWidth,l.renderer.trailCap=n.trailCap),Promise.resolve(l)}),(e=>Promise.reject(e)))}function t(){const{mapView:e,modules:l}=r.s,o=(0,r.a9)(),s=(0,r.d)(o,"color");if(!s)return null;const i=s.stops.map((e=>e.color)),t=l.flowSchemes.getSchemes({basemap:e.map.basemap||"topo"}),a=[t.primaryScheme].concat(t.secondarySchemes),n=[];return a.forEach((e=>{let l=i.some(((l,o)=>!(0,r.aa)(e.colors[o],l)));l?(e.colors=e.colors.reverse(),l=i.some(((l,o)=>!(0,r.aa)(e.colors[o],l))),l||n.push(e)):n.push(e)})),n.length?n[0]:null}}}]);