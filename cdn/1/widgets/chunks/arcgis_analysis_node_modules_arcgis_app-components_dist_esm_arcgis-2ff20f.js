/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f"],{37430:(e,i,t)=>{t.d(i,{c:()=>o,g:()=>p,h:()=>c});var n=t(71700),a=t(76173),l=t(28944),s=t(86537),r=t(99907),d=function(e,i){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]])}return t};function o(e,i){var t;const n=(null==e?void 0:e.type)||null,a=(null==i?void 0:i.type)||null;return a&&(a===n||(null===(t={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeBigInteger"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[n])||void 0===t?void 0:t.includes(a)))}function p(e){var i;const{timezone:t,analyzeResults:r,type:o,fieldMappings:p,dataLayer:c,id:u,uidPair:y,addAppendSelectOption:g,sourceDataLayer:m}=e;let h,f;const{publishParameters:T}=r,b=d(r,["publishParameters"]),v="upsert"===g||"update"===g,F=function(e){const i=e.filter((e=>e.source!==a.N)),t=i.map((({source:e,name:i})=>({source:e,name:i})));return t}(p),w=function(e){const i=e.map((e=>e.name));return i}(F),I={dateFieldsTimeReference:{timeZone:t||"UTC",respectsDaylightSaving:!0}},O={sourceTableName:c.name,fieldMappings:(null==F?void 0:F.length)?JSON.stringify(F):null,upsert:v,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:v&&"esriFieldTypeGlobalID"===(null==y?void 0:y.type),updateGeometry:!v||"attributeAndGeometry"===n.a.addAppendSelectUpdateTypeOption,appendFields:w.length?JSON.stringify(w):null,appendItemId:u,appendUploadFormat:s.a[n.a.type].appendUploadFormat,rollbackOnFailure:!0};"Table"===m.type&&(T.locationType="none");const k=d(T,["layers"]);if("CSV"===o)T.layerInfo.dateFieldsTimeReference=I.dateFieldsTimeReference,f=Object.assign(Object.assign(Object.assign({},I),T),b);else if("Microsoft Excel"===o){const e=function(e,i){const t=Object.assign({},e);t.locationType=(null==i?void 0:i.locationType)||e.locationType,"address"===t.locationType?(t.addressFields=i.addressFields,t.sourceCountry=i.sourceCountry):"coordinates"===t.locationType&&(t.coordinateFieldType=i.coordinateFieldType,"LatitudeAndLongitude"===t.coordinateFieldType?(t.latitudeFieldName=i.latitudeFieldName,t.longitudeFieldName=i.longitudeFieldName):t.coordinateFieldName=i.coordinateFieldName);return t}((0,l.a)({},!0),k);e.dateFieldsTimeReference=I.dateFieldsTimeReference,k.name=c.name,f=Object.assign(Object.assign(Object.assign(Object.assign({},I),{layers:[e]}),k),b)}else f=Object.assign(Object.assign(Object.assign({},I),T),b);return h=Object.assign(Object.assign({},O),{appendSourceInfo:JSON.stringify(f)}),"add"===g?h.upsertMatchingField=m.objectIdField||(null===(i=m.uniqueField)||void 0===i?void 0:i.name):v&&(null==y?void 0:y.isUniqueIndex)&&(h.upsertMatchingField=null==y?void 0:y.name),h}function c(e,i){const t=i.appendErrorMessages;let n=r.u.i18n.error,a=t.appendError;switch(e.code){case"invalidUniqueIdentifier":n=t.invalidUniqueIdentifier.title,a=t.invalidUniqueIdentifier.description;break;case"cannotAddNullData":n=t.cannotAddNullData.title,a=t.cannotAddNullData.description;break;case"exceededMaxFieldLength":n=t.exceededMaxFieldLength.title,a=t.exceededMaxFieldLength.description;break;case"invalidFieldType":n=t.invalidFieldType.title,a=t.invalidFieldType.description}return{title:n,description:a}}},51566:(e,i,t)=>{t.d(i,{a:()=>s});var n=t(46581),a=t(37430),l=t(39274);async function s(e){var i;const t=(0,a.g)(e),s=`${null===(i=e.existingItem)||void 0===i?void 0:i.url}/${e.sourceDataLayer.id}/append`;try{const i=await(0,n.r)(s,t,{},"post"),{status:a,recordCount:r}=await(0,l.g)(e.id,{},null==i?void 0:i.statusUrl);return{result:{status:a,recordCount:r}}}catch(e){let i="unhandledError";const t={error:e}.error.description.toLowerCase();switch(!0){case t.includes("the create unique index statement terminated because a duplicate key was found for the object name"):i="invalidUniqueIdentifier";break;case t.includes("does not allow nulls"):i="cannotAddNullData";break;case t.includes("the value violates the maxlength limit of this column"):i="exceededMaxFieldLength";break;case t.includes("input string was not in a correct format"):i="invalidFieldType"}return console.error(e),{error:{code:i,message:JSON.stringify(e)}}}}},45831:(e,i,t)=>{t.r(i),t.d(i,{arcgis_new_item_pages_append_select_update:()=>c});var n=t(7263),a=t(51566),l=t(5992),s=t(50852),r=t(71700),d=t(99907),o=t(63262),p=t(37430);t(46581),t(31670),t(11935),t(28926),t(70506),t(99004),t(94788),t(65215),t(39274),t(51325),t(49712),t(90079),t(57399),t(66488),t(67575),t(15437),t(73596),t(86537),t(91253),t(7652),t(43780),t(59673),t(59296),t(2174),t(24125),t(11163),t(28944),t(71695),t(76173);const c=class{constructor(e){(0,n.r)(this,e),this.workflowComplete=(0,n.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,n.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,n.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,n.c)(this,"newItemPrevPage",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===d.u.workflow?"attribute":"uploaded",this.i18n=d.u.i18n.appendSelectUpdateType,"append"===d.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,o.v)({dataLayer:r.a.dataLayer,type:r.a.type,sourceDataLayer:r.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),d.u.nextText="updateAppend"}async handleNext(){const e=this.selected;if("update"===d.u.workflow){r.a.addUpdateItemPropertiesOption=e;const i="uploaded"===e;r.a.keepDescription=i,this.handleUpdate()}else r.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=d.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:i,keepDescription:t,existingItem:n,fileName:a}=r.a,s=await(0,l.b)(n,n.itemOwner.userContentUrl,{file:e,overwrite:i,keepDescription:t,fileName:a});s.success?this.workflowComplete.emit({success:s.success}):(this.loading=!1,this.error={title:d.u.i18n.error,description:d.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e,i;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=d.u.i18n.append.appendLoadingMessages.appendCloseNotice;const t=await(0,a.a)({sourceDataLayer:r.a.sourceDataLayer,existingItem:r.a.existingItem,timezone:r.a.timezone,analyzeResults:r.a.analyzeResults,type:r.a.type,fieldMappings:r.a.fieldMappings,dataLayer:r.a.dataLayer,id:r.a.id,uidPair:r.a.uidPair,addAppendSelectOption:r.a.addAppendSelectOption});if("completed"!==(null===(e=null==t?void 0:t.result)||void 0===e?void 0:e.status.toLowerCase()))this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,p.h)(null!==(i=null==t?void 0:t.error)&&void 0!==i?i:{code:"unhandledError"},{appendErrorMessages:d.u.i18n.append.appendErrorMessages});else{await(0,s.d)(r.a.id,{permanentDelete:!0});const e=Object.assign({appendType:r.a.addAppendSelectOption},t);this.workflowComplete.emit(e)}}render(){const{i18n:e,appendOptions:i,updateOptions:t,noticeMessage:a,error:l}=this;let s=i,r=e.header,o="appendOptions";return"update"===d.u.workflow&&(s=t,r=e.itemPropertiesHeader,o="updateOptions"),(0,n.h)(n.H,{key:"d999808a88f48de6a847d4a3e2b61b0705e832bc",class:{"overflow-hidden":this.loading}},(0,n.h)("arcgis-new-item-description",{key:"f8fb926f5c6246f9f808c01d1c0b74ecc97e55af",header:r}),(0,n.h)("calcite-tile-select-group",{key:"80971708645026fed2c312f724e5e716c01c7689",layout:"vertical",class:"tile-select"},Object.keys(s).map((i=>{const{icon:t}=s[i];return(0,n.h)("calcite-tile-select",{key:i,checked:this.selected===i,heading:e[o][i].title,description:e[o][i].description,icon:t,name:"feature-layer-create-mode","input-enabled":!0,width:"full",type:"radio",value:i,disabled:"attributeAndGeometry"===i&&this.cannotUpdateGeometry,onCalciteTileSelectChange:e=>{this.selected=e.target.value}})}))),"append"===d.u.workflow&&this.cannotUpdateGeometry&&(0,n.h)("calcite-notice",{key:"126fcf7432afb7265206578a36c1feae7a3f239e",class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,n.h)("div",{key:"675464501e8b338f413b2121cbdbf5204d05039b",slot:"title"},e[a.title]),(0,n.h)("div",{key:"d3f03d68d949da1bcf35f3f5b9905bbef54045ef",slot:"message"},e[a.description])),(0,n.h)("arcgis-new-item-loader",{key:"c2f802cb0e7ec220041376153a93fe00f12605cf",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,n.h)("arcgis-new-item-alert",{key:"08fc905ff81f07314aa296cb01776a3df401fe21",heading:null==l?void 0:l.title,description:null==l?void 0:l.description,link:{href:null==l?void 0:l.link,title:null==l?void 0:l.linkText},active:!!l,onAlertDismiss:()=>this.error=null}))}get el(){return(0,n.d)(this)}};c.style=".tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}"},63262:(e,i,t)=>{function n(e){var i,t;const{dataLayer:n,type:a,sourceDataLayer:l}=e,s=null!==(i=null==n?void 0:n.geometryType)&&void 0!==i?i:null===(t=null==n?void 0:n.layerInfo)||void 0===t?void 0:t.geometryType;if("Microsoft Excel"===a||"CSV"===a){if(("address"===n.locationType&&n.addressFields||"coordinates"===n.locationType)&&"esriGeometryPoint"===(null==l?void 0:l.geometryType))return null;if(!s||"none"===n.locationType||"Table"===(null==l?void 0:l.type))return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==l?void 0:l.geometryType)!==s)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else if((null==l?void 0:l.geometryType)!==(null==n?void 0:n.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}function a(e,i,t){return"Microsoft Excel"===t||"CSV"===t?"Table"===(null==i?void 0:i.type)||("esriGeometryPoint"===(null==i?void 0:i.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==i?void 0:i.geometryType)&&(!!e.addressFields||"none"!==e.locationType)):"Table"===(null==i?void 0:i.type)||(null==e?void 0:e.geometryType)===(null==i?void 0:i.geometryType)}t.d(i,{c:()=>a,v:()=>n})}}]);