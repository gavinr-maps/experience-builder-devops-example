/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c84748.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c84748"],{99004:(e,t,r)=>{r.d(t,{c:()=>o,g:()=>n});var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},84411:(e,t,r)=>{r.r(t),r.d(t,{arcgis_member_browser_filter_categories:()=>d});var o=r(7263),n=r(43780),i=r(12926),a=r(29259),s=r(32023),c=r(31670),l=r(69773),u=r(59296);r(46581),r(28926),r(70506),r(99004),r(94788),r(65215),r(59673),r(22783),r(78613),r(93816),r(11935),r(2174);const d=class{constructor(e){(0,o.r)(this,e),this.arcgisMemberBrowserFilter=(0,o.c)(this,"arcgisMemberBrowserFilter",7),this.arcgisMemberBrowserCategorySchemaUpdate=(0,o.c)(this,"arcgisMemberBrowserCategorySchemaUpdate",7),this.arcgisMemberBrowserCategoryEditSuccess=(0,o.c)(this,"arcgisMemberBrowserCategoryEditSuccess",7),this.setSchema=e=>{this.schema=e,this.arcgisMemberBrowserCategorySchemaUpdate.emit(e)},this.checkSchemaFilterStillValid=(e,t,r)=>e.some((e=>{var o;const n=(0,a.b)(r,e,!1);return n===t||!!(null===(o=e.categories)||void 0===o?void 0:o.length)&&this.checkSchemaFilterStillValid(e.categories,t,n)})),this.category=void 0,this.expanded=void 0,this.loading=void 0,this.schema=[],this.categoriesCount={}}async componentWillLoad(){this.store=(0,s.g)(this.el),this.i18n=this.store.state.i18n.filterCategories,(null===c.c||void 0===c.c?void 0:c.c.portal)?await this.fetchMemberCategories(c.c.portal):(0,c.o)("portal",(e=>{this.fetchMemberCategories(e)})),(0,l.a)("categories",this.store,(()=>this.category=null))}async componentDidLoad(){this.category&&this.emitFilterEvent()}async fetchMemberCategories(e,t=!1){var r,o;const a=await(0,i.g)(e);this.categoriesCount=a;const s=await(0,n.c)(e,null===c.c||void 0===c.c?void 0:c.c.user,t),l=null===(o=null===(r=null==s?void 0:s.memberCategorySchema)||void 0===r?void 0:r[0])||void 0===o?void 0:o.categories;this.setSchema(l),this.loading=!1}emitFilterEvent(){const{category:e,i18n:t}=this,r="null"===e?"null":e?[e]:"",o=t.label.replace("${name}","null"===e?t.noCategoriesAssigned:null==e?void 0:e.replace(`${a.U}/`,""));this.arcgisMemberBrowserFilter.emit({id:"categories",param:"categories",value:r,label:o})}renderNestedCategories(e,t){return e.map((e=>{var r;const n=t?`${t}/${e.title}`:`${a.U}/${e.title}`,i=!!(null===(r=e.categories)||void 0===r?void 0:r.length);return(0,o.h)("calcite-tree-item",{"data-value":n,"data-children":i,selected:this.category===n,key:`${n}--${i}`},(0,o.h)("a",null,e.displayName||e.title,this.categoriesCount[n.toLowerCase()]?` (${this.categoriesCount[n.toLowerCase()]})`:""),i&&(0,o.h)("calcite-tree",{slot:"children",selectionMode:"children"},this.renderNestedCategories(e.categories,n)))}))}render(){const{loading:e,schema:t,i18n:r}=this,n=(null==t?void 0:t.length)>0;return this.store.state.groupId&&!this.store.state.myOrgView||e||(0,u.a)(c.c.user)||this.store.state.includeExternalUsers?null:(0,o.h)(o.F,null,(0,o.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.category,filterID:"categories",onArcgisBrowserFilterRemove:()=>{this.category=null}},n?(0,o.h)("calcite-tree",{selectionMode:"children",onCalciteTreeSelect:e=>{var t,r;const o=e.target,n=null===(r=null===(t=null==o?void 0:o.selectedItems)||void 0===t?void 0:t[0])||void 0===r?void 0:r.dataset,i=(null==n?void 0:n.value)||"";this.category===i?this.category=null:this.category=i,this.emitFilterEvent()}},(0,o.h)("calcite-tree-item",{"data-value":"null",selected:"null"===this.category},(0,o.h)("a",null,r.noCategoriesAssigned,this.categoriesCount.null?` (${this.categoriesCount.null})`:"")),this.renderNestedCategories(t)):(0,o.h)("div",null,(0,o.h)("p",{class:"no-category-title"},r.noCategoriesTitle),(0,o.h)("p",{class:"no-category-description"},r.noCategories))))}get el(){return(0,o.d)(this)}};d.style=".no-category-title{margin-bottom:0.25rem;margin-top:1rem;font-size:1rem}.no-category-description{overflow-wrap:break-word}.no-category-description:not(:last-child){margin-bottom:1rem;margin-top:0px}.add-category-button{max-width:100%;overflow-wrap:break-word}"},29259:(e,t,r)=>{r.d(t,{U:()=>o,a:()=>a,b:()=>n,g:()=>i});const o="/Categories",n=(e,t,r=!0)=>{const o=null!=e?e:"";return`${o}${o.endsWith("/")?"":"/"}${r?t.title.toLocaleLowerCase():t.title}`};function i(e){var t;let r=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.title;return r&&"/"!==r.charAt(0)&&(r=`/${r}`),r||o}const a=(e,t)=>`${e.replace(/\/([^\/]+)$/,`/${t}`)}`},43780:(e,t,r)=>{r.d(t,{a:()=>h,b:()=>d,c:()=>g,d:()=>v,f:()=>u,g:()=>l,u:()=>m});var o=r(46581),n=r(29259),i=r(31670),a=r(59673),s=r(59296),c=r(94788);const l=async({portal:e,user:t,group:r,useCache:o=!1})=>{var n;try{const i=await(r?d(r.id,e,o):u(e,t,o));return{result:null!==(n=null==i?void 0:i.categorySchema)&&void 0!==n?n:null}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}};async function u(e,t,r=!0){if(null!=e||(e=i.c.portal),null!=t||(t=i.c.user),!(null==e?void 0:e.id)||t&&(0,s.a)(t))return null;const n=()=>(0,o.r)(`${(0,c.g)(e)}portals/${e.id}/categorySchema`);return r?(0,o.f)(n,"categorySchema",e.id):n()}async function d(e,t,r=!0){if(null!=t||(t=null===i.c||void 0===i.c?void 0:i.c.portal),!e||!t)return null;const n=()=>(0,o.r)(`${(0,a.a)(t,{id:e})}categorySchema`);return r?(0,o.f)(n,"categorySchema",e):n()}async function g(e,t,r=!0){if(null!=e||(e=i.c.portal),null!=t||(t=i.c.user),!(null==e?void 0:e.id)||t&&(0,s.a)(t))return null;const n=()=>(0,o.r)(`${(0,c.g)(e)}portals/${e.id}/memberCategorySchema`);return r?(0,o.f)(n,"memberCategorySchema",e.id):n()}async function h(e,t,r=!0){const n=()=>async function(e,t){var r;const n=(0,c.g)(e),i=(0,c.d)(e),s=await(0,o.r)(`${n}portals/self?culture=${i}`),l=await(0,o.r)(`${n}community/groups?q=${s.contentCategorySetsGroupQuery}`),u=null===(r=null==l?void 0:l.results)||void 0===r?void 0:r[0],d=(await(0,o.r)((0,a.g)(e,u),{q:`typekeywords: ${t}`})).results[0];return(0,o.r)(`${n}content/items/${d.id}/data`)}(e,t);return r?(0,o.f)(n,"categorySchema",t):n()}async function m({categories:e,itemIds:t,portal:r}){try{const n=`${(0,c.g)(r)}/content/updateItems`,i=JSON.stringify(t.map((t=>({[t]:{categories:Array.isArray(e)?e:e[t]}}))));return{result:await(0,o.r)(n,{items:i},{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}}const v=async({path:e,portal:t,group:r,updateInfo:o})=>{try{const i=(await p({category:e,portal:t,group:r,num:1})).total;if(0===i)return console.warn(`No items found with category ${e} when updating schema`),{};const a=100,s=Math.ceil(i/a),c=[];for(let i=0;i<s;i++)c.push(p({category:e,portal:t,group:r,start:i*a,num:a}).then((({results:t})=>{const r={};return t.forEach((t=>{const i="change-title"===o.type?t.categories.map((t=>{const r=(0,n.a)(e,o.newTitle);return t===e?r:t.replace(`${e}/`,`${r}/`)})):t.categories.filter((t=>!t.startsWith(e)));r[t.id]=i})),r})));const l=await Promise.all(c);return await Promise.all(l.map((e=>m({categories:e,itemIds:Object.keys(e),portal:t})))),{}}catch(t){return console.error(`Error ${o.type} items schema from path ${e}:`,t),{error:{code:"unhandledError"}}}},p=({category:e,num:t=100,start:r=0,portal:n,group:i})=>{const s={start:r,num:t,categories:JSON.stringify([e])},l=i?(0,a.g)(n,i):`${(0,c.g)(n)}search`;return(0,o.r)(l,Object.assign(Object.assign({},s),{q:i?void 0:`orgid: ${n.id}`}))}},70506:(e,t,r)=>{r.d(t,{e:()=>i});var o,n=r(99004),i={exports:{}};o=i.exports,n.c,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},r="4.24",o="next";function n(e){if(e.toLowerCase()===o)return o;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function i(e){return void 0===e&&(e=r),"https://js.arcgis.com/".concat(e,"/")}function a(e){void 0===e&&(e=r);var t=i(e),a=n(e);if(a!==o&&3===a.major){var s=a.minor<=10?"js/":"";return"".concat(t).concat(s,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function s(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function c(e,t){if(t){var r=document.querySelector(t);r.parentNode.insertBefore(e,r)}else document.head.appendChild(e)}function l(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function u(e){return!e||n(e)?a(e):e}function d(e,t){var r=u(e),o=l(r);return o||c(o=s(r),t),o}var g={};function h(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function m(e,t,r){var o;r&&(o=v(e,r));var n=function(){t(e),e.removeEventListener("load",n,!1),o&&e.removeEventListener("error",o,!1)};e.addEventListener("load",n,!1)}function v(e,t){var r=function(o){t(o.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",r,!1)};return e.addEventListener("error",r,!1),r}function p(e){void 0===e&&(e={}),g=e}function f(){return document.querySelector("script[data-esri-loader]")}function y(){var e=window.require;return e&&e.on}function w(e){void 0===e&&(e={});var r={};[g,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}));var o=r.version,n=r.url||i(o);return new t.Promise((function(e,t){var i=f();if(i){var a=i.getAttribute("src");a!==n?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(a,")."))):y()?e(i):m(i,e,t)}else if(y())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=r.css;s&&d(!0===s?o:s,r.insertCssBefore),m(i=h(n),(function(){i.setAttribute("data-esri-loader","loaded"),e(i)}),t),document.body.appendChild(i)}}))}function b(e){return new t.Promise((function(t,r){var o=window.require.on("error",r);window.require(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];o.remove(),t(e)}))}))}function C(e,t){if(void 0===t&&(t={}),y())return b(e);var r=f(),o=r&&r.getAttribute("src");return!t.url&&o&&(t.url=o),w(t).then((function(){return b(e)}))}e.utils=t,e.loadModules=C,e.getScript=f,e.isLoaded=y,e.loadScript=w,e.setDefaultOptions=p,e.loadCss=d,Object.defineProperty(e,"__esModule",{value:!0})}(o)},59673:(e,t,r)=>{r.d(t,{a:()=>n,g:()=>i});var o=r(94788);const n=(e,t)=>(0,o.a)(`${(0,o.g)(e)}community/groups/${t.id}`),i=(e,t)=>`${((e,t)=>(0,o.a)(`${(0,o.g)(e)}content/groups/${t.id}`))(e,t)}search`},28926:(e,t,r)=>{r.d(t,{l:()=>n});var o=r(70506);const n=async(e,t)=>(await o.e.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))},69773:(e,t,r)=>{r.d(t,{a:()=>i,b:()=>s,g:()=>l,i:()=>n,o:()=>a});var o=r(78613);const n=e=>"item-browser"===e.state.type,i=(e,t,r)=>{t.onChange("filters",(t=>{t[e]&&t[e].value||r()}))},a=(e,t)=>{e.onChange("preview",(e=>{t()}))},s=(e,t)=>{e.onChange("groupId",(e=>{t()}))},c=new Map;function l(e,t){const r=c.get(e);if(r)return r;const n=(0,o.c)(e,t);return n?(c.set(e,n.store),n.store):null}},32023:(e,t,r)=>{r.d(t,{g:()=>i,o:()=>a});var o=r(11935),n=r(69773);function i(e){return(0,n.g)(e,"arcgis-member-browser")}(0,o.c)({type:"member-browser",includeExternalUsers:!1});const a=(e,t)=>{e.onChange("sort",(e=>{t(e)}))}}}]);