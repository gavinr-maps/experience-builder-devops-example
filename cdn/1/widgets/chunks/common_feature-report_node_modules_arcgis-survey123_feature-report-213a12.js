"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_common_feature-report_node_modules_arcgis-survey123_feature-report-213a12"],{28593:(e,t,r)=>{r.d(t,{A:()=>l,N:()=>h,U:()=>y,a:()=>d,b:()=>T,c:()=>f,d:()=>g,e:()=>a,g:()=>O,r:()=>m});var s=r(12542);function n(e){return Object.keys(e).some((t=>{let r=e[t];if(!r)return!1;r&&r.toParam&&(r=r.toParam());switch(r.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}}))}function o(e){const t={};return Object.keys(e).forEach((r=>{var s,n;let o=e[r];if(o&&o.toParam&&(o=o.toParam()),!o&&0!==o&&"boolean"!=typeof o&&"string"!=typeof o)return;let i;switch(o.constructor.name){case"Array":const e=null===(n=null===(s=o[0])||void 0===s?void 0:s.constructor)||void 0===n?void 0:n.name;i="Array"===e?o:"Object"===e?JSON.stringify(o):o.join(",");break;case"Object":i=JSON.stringify(o);break;case"Date":i=o.valueOf();break;case"Function":i=null;break;case"Boolean":i=o+"";break;default:i=o}(i||0===i||"string"==typeof i||Array.isArray(i))&&(t[r]=i)})),t}function i(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map((t=>i(e,t))).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function a(e){const t=o(e);return Object.keys(t).map((e=>i(e,t[e]))).join("&")}var c={FormData:globalThis.FormData,File:globalThis.File,Blob:globalThis.Blob};class l extends Error{constructor(e,t,r,s,n){super(e);const o=new.target.prototype;Object.setPrototypeOf(this,o),e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=r,this.url=s,this.options=n}}var u=function(){return Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.request})};const h="@esri/arcgis-rest-js";class d extends l{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",r,s,n){super(e,t,r,s,n),this.name="ArcGISAuthError",this.message="AUTHENTICATION_ERROR_CODE"===t?e:`${t}: ${e}`;const o=new.target.prototype;Object.setPrototypeOf(this,o)}retry(e,t=1){let r=0;const s=(n,o)=>{r+=1,e(this.url,this.options).then((e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return p(this.url,t)})).then((e=>{n(e)})).catch((e=>{"ArcGISAuthError"===e.name&&r<t?s(n,o):e.name===this.name&&e.message===this.message&&r>=t?o(this):o(e)}))};return new Promise(((e,t)=>{s(e,t)}))}}function p(e,t){const r=globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}},s=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},r),t),{params:Object.assign(Object.assign({},r.params),t.params),headers:Object.assign(Object.assign({},r.headers),t.headers)}),{httpMethod:i,rawResponse:p}=s,m=Object.assign({f:"json"},s.params);let f=null;const g={method:i,signal:s.signal,credentials:s.credentials||"same-origin"};let O;if(s.headers&&s.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(g.credentials="include"),"string"==typeof s.authentication){const e=s.authentication;O={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)},s.authentication.startsWith("AAPK")||s.suppressWarnings||globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING||(b="Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information.",console&&console.warn&&console.warn.apply(console,[b]),globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=!0)}else O=s.authentication;var b;const T=e;return(O?O.getToken(e).catch((t=>(t.url=e,t.options=s,f=t,Promise.resolve("")))):Promise.resolve("")).then((t=>{t.length&&(m.token=t),O&&O.getDomainCredentials&&(g.credentials=O.getDomainCredentials(e));const r={};if("GET"===g.method){m.token&&s.hideToken&&"undefined"==typeof window&&(r["X-Esri-Authorization"]=`Bearer ${m.token}`,delete m.token);const n=""===a(m)?e:e+"?"+a(m);s.maxUrlLength&&n.length>s.maxUrlLength||m.token&&s.hideToken?(g.method="POST",t.length&&s.hideToken&&(m.token=t,delete r["X-Esri-Authorization"])):e=n}const i=new RegExp("/items/.+/updateResources").test(e);return"POST"===g.method&&(g.body=function(e,t){const r=n(e)||t,s=o(e);if(r){const e=new c.FormData;return Object.keys(s).forEach((t=>{if("undefined"!=typeof Blob&&s[t]instanceof Blob){const r=s.fileName||s[t].name||t;e.append(t,s[t],r)}else e.append(t,s[t])})),e}return a(e)}(m,i)),g.headers=Object.assign(Object.assign({},r),s.headers),("undefined"==typeof window||window&&void 0===window.document)&&!g.headers.referer&&(g.headers.referer=h),n(m)||i||(g.headers["Content-Type"]="application/x-www-form-urlencoded"),globalThis.fetch?globalThis.fetch(e,g):u().then((({fetch:t})=>t(e,g)))})).then((t=>{if(!t.ok)return t.json().then((r=>{const{status:n,statusText:o}=t,{message:i,details:a}=r.error,c=`${i}. ${a?a.join(" "):""}`.trim();throw new l(c,`HTTP ${n} ${o}`,r,e,s)})).catch((r=>{if("ArcGISRequestError"===r.name)throw r;const{status:n,statusText:o}=t;throw new l(o,`HTTP ${n}`,t,e,s)}));if(p)return t;switch(m.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}})).then((t=>{if("json"!==m.f&&"geojson"!==m.f||p)return t;{const r=function(e,t,r,s,n){if(e.code>=400){const{message:r,code:n}=e;throw new l(r,n,e,t,s)}if(e.error){const{message:r,code:o,messageCode:i}=e.error,a=i||o||"UNKNOWN_ERROR_CODE";if(498===o||499===o)throw n||new d(r,a,e,t,s);throw new l(r,a,e,t,s)}if("failed"===e.status||"failure"===e.status){let r,n="UNKNOWN_ERROR_CODE";try{r=JSON.parse(e.statusMessage).message,n=JSON.parse(e.statusMessage).code}catch(t){r=e.statusMessage||e.message}throw new l(r,n,e,t,s)}return e}(t,T,0,s,f);if(f){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];s.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+864e5)},f=null}return r}}))}function m(e,t={params:{f:"json"}}){return p(e,t).catch((e=>e instanceof d&&t.authentication&&"string"!=typeof t.authentication&&t.authentication.canRefresh&&t.authentication.refreshCredentials?e.retry((()=>t.authentication.refreshCredentials()),1):Promise.reject(e)))}function f(e){return"string"!=typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}function g(e={}){return e.portal?f(e.portal):e.authentication&&"string"!=typeof e.authentication?e.authentication.portal:"https://www.arcgis.com/sharing/rest"}function O(e,t){return m(b(e,t),Object.assign({httpMethod:"GET"},t))}const b=(e,t)=>`${"string"==typeof t?t:g(t)}/content/items/${e}`;function T(e){const t=`${b(e.id,e)}/relatedItems`,r=Object.assign({httpMethod:"GET",params:{direction:e.direction}},e);return"string"==typeof e.relationshipType?r.params.relationshipType=e.relationshipType:r.params.relationshipTypes=e.relationshipType,delete r.direction,delete r.relationshipType,m(t,r)}class y{constructor(){this.isPortal=!1,this.svgCache={}}static getService(){return this.service||(this.service=new y),this.service}getPortalInfo(){return this.portalInfo&&this.portalInfo.user?Promise.resolve(this.portalInfo):function(e,t){const r=e||"self";return m(`${g(t)}/portals/${r}`,Object.assign({httpMethod:"GET"},t))}(null,this.getBaseRequestOptions()).then((e=>{if(e.error)throw new Error(JSON.stringify(e));return this.portalInfo=e,this.isPortal=e.isPortal,e}))}getUser(){var e;return(null===(e=this.portalInfo)||void 0===e?void 0:e.user)||{}}setDir(){document.getElementsByTagName("html")[0].dir=-1!==["ar","he"].indexOf(s.P.locale)?"rtl":"ltr"}getSurveyItemInfo(e){return O(e,this.getBaseRequestOptions()).then((e=>e))}getBaseRequestOptions(){return{authentication:s.P.token,portal:`${s.P.portalUrl}/sharing/rest`}}supportFeatureReport(){return!this.isPortal||this.isPortal&&this.compareVersion(this.portalInfo.currentVersion,this.getRestApiVersion("10.5.0"))>=0}formatFieldVal(e,t){var r,s;if(!t)return t;const n=e.type,o=null===(r=e.domain)||void 0===r?void 0:r.codedValues;return"esriFieldTypeDate"===n?t=this.formatDateTime(t):o?t=(null===(s=o.find((e=>e.code===t)))||void 0===s?void 0:s.name)||t:this.isNumberField(e)&&(t=this.formatNumber(t)),t}isNumberField(e){if(!e)return!1;const t=e.type;return"esriFieldTypeSingle,esriFieldTypeDouble,esriFieldTypeInteger,esriFieldTypeSmallInteger".split(",").includes(t)}formatNumber(e){return new Intl.NumberFormat(s.P.locale||"default").format(e)}formatDateTime(e,t){t=t||"date",e instanceof Date||(e=new Date(e));return e?new Intl.DateTimeFormat(s.P.locale||"default",{date:{year:"numeric",month:"numeric",day:"numeric"},time:{hour:"numeric",minute:"numeric",second:"numeric"},datetime:{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}}[t]).format(e):""}getPercentage(e,t,r){let n=0;if(!(e&&e.jobStatusInfo||t))return"";const o=t||Number(e.jobStatusInfo.progress+""||"0");let i=1;if(100===Math.round(100*o)&&1!==o){const e=(o+"").substr(3);let t=e.split("").findIndex((e=>parseInt(e,10)<9));-1===t&&(t=e.split("").length-1),i=t+1}return n=Math.round(o*Math.pow(10,i+2))/Math.pow(10,i),r?n:new Intl.NumberFormat(s.P.locale,{style:"percent"}).format(n/100)}getFileSize(e){let t=0,r="KB";return e&&e>1048576?(t=Number((e/1048576).toFixed(1)),r="MB"):(t=Number((e/1024).toFixed(1)),r="KB"),t+r}extractPlaceholders(e){const t=(e=e||"").match(/\$[^{$]*?{[^}]*?.*?}/g),r=[];return t&&t.forEach((e=>{-1===r.indexOf(e)&&r.push(e)})),r}parseMarkdown(e){const t=(e+"").split("`");let r="";return t.forEach(((e,t)=>{r+=t%2==0?e:"<i>"+e+"</i>"})),r}isUserCanPrintFeatureReport(){const e=this.getUser().privileges||[],t=["premium:user:featurereport"];return e.filter((e=>t.indexOf(e)>-1)).length===t.length}setSvgCache(e,t){e&&t&&(this.svgCache[e]=t)}getSvgCache(e){return e?this.svgCache?this.svgCache[e]:null:this.svgCache}compareVersion(e,t){if(t=""+t,!(e=""+e)||!t)throw new Error("version is not existed");let r,s;const n=/(\.0+)+$/,o=e.replace(n,"").split("."),i=t.replace(n,"").split("."),a=Math.min(o.length,i.length);for(r=0;r<a;r++)if(s=parseInt(o[r],10)-parseInt(i[r],10),s)return s;return o.length-i.length}getRestApiVersion(e){return e?"10.9.1"===e?"9.2":"10.9.0"===e?"8.4":"10.8.1"===e?"8.2":"10.8.0"===e?"7.3":"10.7.2"===e?"7.2":"10.7.1"===e||"10.7.0"===e?"7.1":"10.6.1"===e?"6.1":"10.6.0"===e?"5.3":"10.5.2"===e?"5.2":"10.5.1"===e?"5.1":"10.5.0"===e?"4.4":"10.4.0"===e?"3.10":"":""}}}}]);