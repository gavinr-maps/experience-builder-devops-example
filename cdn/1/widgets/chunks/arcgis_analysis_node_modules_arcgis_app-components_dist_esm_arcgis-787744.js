/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-787744.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-787744"],{73086:(e,t,i)=>{i.r(t),i.d(t,{arcgis_image_collection_explorer:()=>h});var a=i(7263),s=i(62159),n=i(58233),r=i(28926),o=i(11246),l=i(55343),m=i(81457);i(78613),i(70506),i(99004);const d=e=>`ImageCollectionExplorerSessionStorage_${e}`,c=(e,t)=>{const i=(0,m.a)(d(e),!0),a=Object.assign(Object.assign({},i),{selectedImageItems:t});(0,m.b)(d(e),a,!0)},h=class{constructor(e){(0,a.r)(this,e),this.arcgisImageItemExplorerDismissedChange=(0,a.c)(this,"arcgisImageItemExplorerDismissedChange",7),this.handleCloseClick=()=>{var e;e=this.layer.id,(0,m.c)(d(e)),this.isShowingFiltersPopover=!1,this.arcgisImageItemExplorerDismissedChange.emit()},this.handleImageItemInitialQuery=()=>{var e;const{view:t,layer:i}=this,a=(0,l.g)(t);this.currentFilterDetail=this.currentFilterDetail||{selectedAOI:this.selectedAOI,queryField:null,queryValues:null,isIncludeOverviews:!1,displayExtent:a};const{selectedAOI:s,queryField:n,queryValues:r,isIncludeOverviews:o}=this.currentFilterDetail;this.selectedAOI=s||this.selectedAOI;const m=(0,l.b)(i,n,r,o,a,null===(e=this.layerInitialMosaicRule)||void 0===e?void 0:e.lockRasterIds);this.totalImageItemCount=-1,this.imageItemFeatures=[],this.resetPaginationStartIndex(),this.queryImageCollectionItemsAndCount(m)},this.handleImageItemFilterQuery=async e=>{var t;const{selectedAOI:i,queryField:a,queryValues:s,isIncludeOverviews:n,displayExtent:r}=e,{layer:o}=this;this.selectedAOI=i,this.activeQueryField=a;const m=(0,l.b)(o,a,s,n,r,null===(t=this.layerInitialMosaicRule)||void 0===t?void 0:t.lockRasterIds);this.totalImageItemCount=-1,this.resetPaginationStartIndex(),this.imageItemFeatures=[],this.queryImageCollectionItemsAndCount(m)},this.queryImageCollectionItemsAndCount=async e=>{var t,i,a,s,n,r;const{selectedAOI:o,layer:m,view:d,imageItemSortField:c,imageItemSortOrder:h,fetchAbortController:g}=this;let I;this.hasQueryImageItemError=!1,this.isQueryingImageItems=!0,g&&g.abort();try{if(this.fetchAbortController=new AbortController,o===l.A.Visible?(e.orderByFields=[`${c.name} ${h}`],I=await(0,l.a)(m,d,e),this.totalImageItemCount=null!==(i=null===(t=null==I?void 0:I.features)||void 0===t?void 0:t.length)&&void 0!==i?i:0):(this.totalImageItemCount<0&&(this.totalImageItemCount=await(0,l.c)(m,e,null===(a=this.fetchAbortController)||void 0===a?void 0:a.signal)),this.totalImageItemCount>0&&(e.orderByFields=[`${c.name} ${h}`],e.num=Math.min(5*this.imageItemCountPerPage,(null===(s=this.layer.sourceJSON)||void 0===s?void 0:s.maxRecordCount)||this.imageItemCountPerPage),I=await(0,l.d)(m,e,null===(n=this.fetchAbortController)||void 0===n?void 0:n.signal))),this.isQueryingImageItems=!1,!(null===(r=null==I?void 0:I.features)||void 0===r?void 0:r.length))return this.imageItemFeatures=[],void(this.inspectImageItemFeature=null);const g=e.start||0;for(let e=0;e<I.features.length;e++)this.imageItemFeatures[g+e]=I.features[e]}catch(e){const t=(0,l.o)(e);if(this.isQueryingImageItems=t,t)return;this.hasQueryImageItemError=!0,this.imageItemFeatures.some((e=>!!e))?this.imageItemListCurPageStartIndex=this.imageItemListPrevPageStartIndex:(this.totalImageItemCount=-1,this.imageItemFeatures=[])}},this.handleSelectNewImageItemToInspect=e=>{const t=this.getNewImageItemFeatureToInspect(e);this.inspectImageItemFeature=t,this.refreshImageItemInfo(t)},this.getNewImageItemFeatureToInspect=e=>{const{activeImageItemListNavTab:t,inspectImageItemFeature:i,imageItemFeatures:a,layer:s,selectedImageItemFeatures:n}=this,r=t===l.I.All?a:n,o=r.findIndex((e=>e.attributes[s.objectIdField]===i.attributes[s.objectIdField]));return r[("previous"===e?o-1+r.length:o+1)%r.length]},this.refreshImageItemInfo=async e=>{const{layer:t}=this,i=await t.getCatalogItemRasterInfo(e.attributes[t.objectIdField]);this.imageItemInfo=i},this.handleDisplayedFieldsInImageItemCardChange=e=>{const{imageItemCardDisplayedFields:t,layer:i,activeQueryField:a}=this;let s=[...t];const n=t.findIndex((t=>t.name===e.name));if(n>=0){const e=t.splice(n,1);s=[...e,...t]}n<0&&s.length<4&&(s=[e,...t]);(0,l.e)(i,a).forEach((e=>{s.findIndex((t=>t.name===e.name))<0&&s.length<4&&s.push(e)})),this.imageItemCardDisplayedFields=s},this.handleOpenImageItemFiltersPopover=()=>{const{isShowingFiltersPopover:e}=this;this.isShowingFiltersPopover=!e},this.handleOpenImageItemListSettingsPopover=()=>{const{isShowingListSettingsPopover:e}=this;this.isShowingFiltersPopover=!1,this.isShowingListSettingsPopover=!e},this.handleOpenImageItemSortPopover=()=>{const{isShowingSortPopover:e}=this;this.isShowingFiltersPopover=!1,this.isShowingSortPopover=!e},this.highlightImageItem=async e=>{const{view:t,layer:i}=this;this.removeImageItemHighlight();const a=await t.whenLayerView(i);this.highlightImageItemHandler=a.highlight(e)},this.removeImageItemHighlight=()=>{var e;null===(e=this.highlightImageItemHandler)||void 0===e||e.remove()},this.clearAllImageItemSelections=()=>{this.selectedImageItemFeatures=[]},this.zoomToSelectedImageItems=e=>{const{view:t}=this;t.goTo(e)},this.openImageItemInspectPopover=e=>{const{layer:t,inspectImageItemFeature:i}=this;this.isShowingFiltersPopover=!1,this.removeImageItemHighlight();const a=e.attributes[t.objectIdField];this.isShowingImageItemInspectPopover=(null==i?void 0:i.attributes[t.objectIdField])!==a||!this.isShowingImageItemInspectPopover,this.inspectImageItemFeature=e,this.refreshImageItemInfo(e)},this.handleAddSelectedImageItemsAsNewLayer=e=>{const{layer:t,view:i,activeQueryField:a,modules:s}=this,{ImageryLayer:n,MosaicRule:r}=s,o=this.getObjectIdsFromImageItemFeatures(e),m=`${t.objectIdField} in (${o.map((e=>`${e}`)).join(",")})`,d=(0,l.f)(t,a,e),c=new n({url:t.url,title:d,renderer:t.renderer,definitionExpression:m,useViewTime:!1}),h=new r({method:"lock-raster",lockRasterIds:o});c.mosaicRule=h,i.map.add(c)},this.handleImageItemListNavTabChange=e=>{this.activeImageItemListNavTab=e,this.resetPaginationStartIndex(),this.isShowingImageItemInspectPopover&&(this.isShowingImageItemInspectPopover=!1)},this.handleZoomToLayer=()=>{const{view:e,layer:t}=this;t.fullExtent&&e.goTo(t.fullExtent)},this.handleImageItemListPageChange=e=>{var t;if(this.activeImageItemListNavTab===l.I.All){const i=(0,l.p)(e,this.imageItemCountPerPage,this.totalImageItemCount);if(!this.imageItemFeatures[i-1]){const{queryField:i,queryValues:a,isIncludeOverviews:s,displayExtent:n}=this.currentFilterDetail||{},{layer:r}=this,o=(0,l.b)(r,i,a,s,n,null===(t=this.layerInitialMosaicRule)||void 0===t?void 0:t.lockRasterIds);o.start=e-1,this.queryImageCollectionItemsAndCount(o)}}},this.loadSavedUIOptionsFromSessionStorage=async e=>{if(!e)return;const{Field:t,Graphic:i}=this.modules,a=(e=>{const t=(0,m.a)(d(e),!0);return null==t?void 0:t.sortingOption})(e);a&&(this.imageItemSortOrder=a.sortOrder,this.imageItemSortField=t.fromJSON(a.sortField));const s=(e=>{const t=(0,m.a)(d(e),!0);return null==t?void 0:t.listSettingsOption})(e);s&&(this.imageItemCardDisplayedFields=s.selectedFields,this.isShowingThumbnails=s.isShowingThumbnails);const n=(e=>{const t=(0,m.a)(d(e),!0);return null==t?void 0:t.filterOptions})(e);n&&(this.currentFilterDetail=Object.assign(Object.assign({},n),{queryField:t.fromJSON(n.queryField)}),this.isFilterApplied=!0,this.activeQueryField=t.fromJSON(n.queryField));const r=(e=>{const t=(0,m.a)(d(e),!0);return null==t?void 0:t.selectedImageItems})(e);if(r){const e=r.map((e=>i.fromJSON(e)));this.selectedImageItemFeatures=e}},this.jsapiUrl=void 0,this.portal=void 0,this.layer=void 0,this.view=void 0,this.activeQueryField=void 0,this.selectedAOI=l.A.DisplayExtent,this.activeImageItemListNavTab=l.I.All,this.totalImageItemCount=-1,this.imageItemFeatures=[],this.selectedImageItemFeatures=[],this.imageItemInfo=void 0,this.inspectImageItemFeature=void 0,this.imageItemCardDisplayedFields=[],this.isShowingImageItemInspectPopover=!1,this.isShowingListSettingsPopover=!1,this.isShowingFiltersPopover=!1,this.isShowingSortPopover=!1,this.isShowingThumbnails=!1,this.isQueryingImageItems=!1,this.imageItemSortOrder=l.S.Asc,this.imageItemSortField=void 0,this.imageItemListCurPageStartIndex=1,this.imageItemListPrevPageStartIndex=1,this.isFilterApplied=!1,this.currentFilterDetail=void 0,this.hasQueryImageItemError=!1,this.hasExceedMaxMosaicImageCountError=!1}handleImageItemFiltersPopoverClosed(){this.isShowingFiltersPopover=!1}handleImageItemListSettingsPopoverClosed(){this.isShowingListSettingsPopover=!1}handleImageItemSortPopoverClosed(){this.isShowingSortPopover=!1}handleImageItemsSortChangeSaved(e){var t;const{sortField:i,sortOrder:a}=e.detail;this.imageItemSortOrder=a,this.imageItemSortField=i;const{currentFilterDetail:s,layer:n,selectedImageItemFeatures:r,modules:o}=this,{queryField:h,queryValues:g,isIncludeOverviews:I,displayExtent:u}=s||{},{Extent:p}=o,v="extent"===(null==u?void 0:u.type)?u:p.fromJSON(u),y=(0,l.b)(n,h,g,I,v,null===(t=this.layerInitialMosaicRule)||void 0===t?void 0:t.lockRasterIds);this.resetPaginationStartIndex(),this.imageItemFeatures=[],this.queryImageCollectionItemsAndCount(y),(null==r?void 0:r.length)>0&&this.sortSelectedImageItems(r),((e,t)=>{const i=(0,m.a)(d(e),!0),a=Object.assign(Object.assign({},i),{sortingOption:t});(0,m.b)(d(e),a,!0)})(n.id,e.detail),c(n.id,this.selectedImageItemFeatures)}handleImageItemListSettingsSaved(e){const{selectedFields:t,isShowingThumbnails:i}=e.detail;this.isShowingThumbnails=i,this.imageItemCardDisplayedFields=t.length>0?t:[this.activeQueryField],((e,t)=>{const i=(0,m.a)(d(e),!0),a=Object.assign(Object.assign({},i),{listSettingsOption:t});(0,m.b)(d(e),a,!0)})(this.layer.id,{isShowingThumbnails:i,selectedFields:this.imageItemCardDisplayedFields})}handleImageItemInspectPopoverClosed(){this.isShowingImageItemInspectPopover=!1}handleImageItemToInspectChanged(e){const t=e.detail;this.handleSelectNewImageItemToInspect(t)}handleZoomToInspectingImageItem(){const{inspectImageItemFeature:e,view:t}=this;t.goTo(e)}handleAddInspectingImageItemToLayer(){const{inspectImageItemFeature:e}=this;this.handleAddSelectedImageItemsAsNewLayer([e])}handleImageItemFilterApply(e){this.isFilterApplied=!0;const t=e.detail;this.currentFilterDetail=t,this.handleImageItemFilterQuery(t),((e,t)=>{const i=(0,m.a)(d(e),!0),a=Object.assign(Object.assign({},i),{filterOptions:t});(0,m.b)(d(e),a,!0)})(this.layer.id,t)}handleSelectedImageItemsChange(e){var t;if(0===e.length&&((0,l.r)(this.layer,this.layerInitialMosaicRule),this.activeImageItemListNavTab===l.I.Select&&this.handleImageItemListNavTabChange(l.I.All)),e.length>0&&(this.hasExceedMaxMosaicImageCountError=e.length>=(null===(t=this.layer.sourceJSON)||void 0===t?void 0:t.maxMosaicImageCount),!this.hasExceedMaxMosaicImageCountError)){const t=this.getObjectIdsFromImageItemFeatures(e);(0,l.l)(this.layer,t)}c(this.layer.id,this.selectedImageItemFeatures)}handleQueryFieldChanged(){this.handleDisplayedFieldsInImageItemCardChange(this.activeQueryField)}async setFocus(){var e;null===(e=this.refCloseButtonNode)||void 0===e||e.setFocus()}async componentWillLoad(){[this.strings,this.locale]=await(0,s.g)(this.hostElement);const[e,t,i,a,n,m,d,c]=await(0,r.l)(["esri/layers/support/CodedValueDomain","esri/geometry/Extent","esri/layers/support/Field","esri/Graphic","esri/identity/IdentityManager","esri/layers/ImageryLayer","esri/layers/support/MosaicRule","esri/core/reactiveUtils"]);this.modules={IdentityManager:n,ImageryLayer:m,MosaicRule:d,CodedValueDomain:e,Extent:t,Field:i,Graphic:a},this.loadSavedUIOptionsFromSessionStorage(this.layer.id),this.currentMapExtent=this.view.extent;const{fields:h,sourceJSON:g,mosaicRule:I}=this.layer||{},u=(0,l.h)(h),p=(0,l.i)(u);this.activeQueryField=this.activeQueryField||p,this.imageItemSortField=this.imageItemSortField||p,this.layerInitialMosaicRule=null==I?void 0:I.clone(),this.imageItemCountPerPage=Math.min(60,(null==g?void 0:g.maxRecordCount)||60),this.handleImageItemInitialQuery(),this.watchExtentChangeHandler=c.watch((()=>[this.view.stationary,this.view.extent]),(([e])=>{var t;e&&(null===(t=this.fetchAbortController)||void 0===t||t.abort(),(0,o.d)((()=>{if(this.isFilterApplied&&this.currentFilterDetail&&!(0,l.q)(this.currentMapExtent,this.view)){const e=(0,l.g)(this.view);this.currentFilterDetail.displayExtent=e,this.handleImageItemFilterQuery(this.currentFilterDetail)}else this.handleImageItemInitialQuery()}),300)())}))}disconnectedCallback(){var e;(0,l.r)(this.layer,this.layerInitialMosaicRule),this.removeImageItemHighlight(),null===(e=this.watchExtentChangeHandler)||void 0===e||e.remove()}render(){const{jsapiUrl:e,strings:t,imageItemInfo:i,inspectImageItemFeature:s,imageItemCardDisplayedFields:r,isShowingThumbnails:o,imageItemSortField:m,imageItemSortOrder:d,isShowingImageItemInspectPopover:c,isShowingListSettingsPopover:h,isShowingSortPopover:g,isShowingFiltersPopover:I,hasQueryImageItemError:u,hasExceedMaxMosaicImageCountError:p,layer:v,view:y}=this,S="rtl"===(0,n.g)(this.hostElement),f=!(null==v?void 0:v.loaded);return(0,a.h)(a.H,{key:"a2c1e87407a3be04bf66a3173b919bd755594466",class:"calcite-match-height"},(0,a.h)("calcite-panel",{key:"bf6b037ab95a65da5cb7426d850fff9fa6a4ee05",loading:f,heading:t.imageCollectionExplorer,class:{panel:!0,[n.C.rtl]:S}},this.renderPanelCloseButton(),this.renderActionBar(),this.renderImageItemList()),(0,a.h)("arcgis-image-item-filters-popover",{key:"ffa23bac3763b9b2d202a75f0903fad95d0793f5",layer:v,view:y,referenceElement:this.filterActionElement,open:I,currentFilterDetail:this.currentFilterDetail}),(0,a.h)("arcgis-image-item-list-settings-popover",{key:"fbbc21672adbe050f3895341bf610d9aef33f54b",referenceElement:this.listSettingsActionElement,fields:(0,l.h)(v.fields),preselectedFields:r,isShowingThumbnails:o,open:h}),(0,a.h)("arcgis-image-item-sort-popover",{key:"f3b0a52f29b93de46c144f8b56ad6a0b1158ad06",open:g,referenceElement:this.sortActionElement,fields:v.fields,preselectedSortField:m,preselectedSortOrder:d}),(0,a.h)("arcgis-image-item-inspect-popover",{key:"ae814d4783b853c5492e12e2d6548d4900123bd2",jsapiUrl:e,layer:v,view:y,referenceElement:this.hostElement,isShowing:c,imageItemInfo:i,imageItemFeatureGraphic:s,popoverHeight:this.hostElement.clientHeight}),u&&this.renderAlert("",t.filterFailedErrorMessage,l.j.Danger),p&&this.renderAlert("",t.exceedMaxMosaicImageCountErrorMessage,l.j.Warning))}renderPanelCloseButton(){const{strings:e}=this;return(0,a.h)("calcite-action",{text:e.close,icon:"x",slot:"header-actions-end",onClick:this.handleCloseClick,ref:e=>this.refCloseButtonNode=e})}renderActionBar(){const{strings:e,imageItemSortOrder:t,imageItemSortField:i,isShowingFiltersPopover:s,isShowingListSettingsPopover:n,isShowingSortPopover:r}=this,o=t===l.S.Asc;return(0,a.h)("calcite-action-bar",{slot:"action-bar",expanded:!0,"expand-disabled":!0,layout:"horizontal",scale:"l"},(0,a.h)("calcite-action",{icon:"sliders",text:"",title:e.filters,textEnabled:!1,active:s,ref:e=>this.filterActionElement=e,onClick:this.handleOpenImageItemFiltersPopover}),(0,a.h)("calcite-action",{icon:"list",text:"",title:e.listSettings,textEnabled:!1,active:n,onClick:this.handleOpenImageItemListSettingsPopover,ref:e=>this.listSettingsActionElement=e}),(0,a.h)("div",{class:"sort-image-item-action-wrapper"},(0,a.h)("calcite-action",{icon:o?"sort-ascending":"sort-descending",textEnabled:!0,text:`${e.sortBy} ${null==i?void 0:i.name}`,title:o?e.sortImageItemAscendingOrder:e.sortImageItemDescendingOrder,active:r,onClick:this.handleOpenImageItemSortPopover,ref:e=>this.sortActionElement=e})))}renderImageItemListTabs(){const{strings:e,activeImageItemListNavTab:t,selectedImageItemFeatures:i}=this,s=i.length>0;return(0,a.h)("calcite-tabs",{layout:"center"},(0,a.h)("calcite-tab-nav",{slot:"title-group"},(0,a.h)("calcite-tab-title",{selected:t===l.I.All,onClick:()=>this.handleImageItemListNavTabChange(l.I.All)},e.all),(0,a.h)("calcite-tab-title",{selected:t===l.I.Select,disabled:!s,onClick:()=>this.handleImageItemListNavTabChange(l.I.Select)},e.selected)))}renderImageItemList(){const{strings:e,isQueryingImageItems:t,totalImageItemCount:i,selectedImageItemFeatures:s,imageItemFeatures:n,activeImageItemListNavTab:r}=this;if(t)return(0,a.h)("calcite-loader",{label:e.loading,scale:"m"});const o=r===l.I.All?i>0&&(null==n?void 0:n.length)>0:(null==s?void 0:s.length)>0;return(0,a.h)("div",{class:"image-item-list-container"},this.renderImageItemListTabs(),(null==s?void 0:s.length)>0&&this.renderImageItemListSelectionButtonGroup(),!o&&this.renderNoImageItemFetchedCoachMessage(),o&&this.renderImageItemListPaginationInfo(),o&&this.renderImageItemCardList(),o&&this.renderImageItemListPagination())}renderSelectedImageItemCount(){const{strings:e,selectedImageItemFeatures:t}=this,i=t.length,s=e.selectedImageItemCountInfo.replace("${selectedCount}",i.toString());return i>0&&(0,a.h)("calcite-chip",{value:s,kind:"brand",closable:!0,onCalciteChipClose:()=>this.clearAllImageItemSelections()},s)}renderImageItemListSelectionButtonGroup(){const{strings:e,selectedImageItemFeatures:t}=this;return(0,a.h)("div",{class:"image-item-list-selection-button-wrapper"},this.renderSelectedImageItemCount(),(0,a.h)("div",{style:{display:"flex"}},(0,a.h)("calcite-button",{label:e.addToMap,appearance:"transparent","icon-start":"add-layer",kind:"neutral",scale:"s",title:e.addToMap,onClick:()=>this.handleAddSelectedImageItemsAsNewLayer(t)}),(0,a.h)("calcite-button",{label:e.zoomToSelection,appearance:"transparent","icon-start":"zoom-to-object",kind:"neutral",scale:"s",title:e.zoomToSelection,onClick:()=>this.zoomToSelectedImageItems(t)})))}renderImageItemListPaginationInfo(){const{strings:e,activeImageItemListNavTab:t,totalImageItemCount:i,imageItemListCurPageStartIndex:s,selectedImageItemFeatures:n}=this,r=t===l.I.All?i:n.length,o=(0,l.p)(s,this.imageItemCountPerPage,r),m=e.imageItemPaginationAndTotalCountInfo.replace("${totalCount}",r.toString()).replace("${start}",s.toString()).replace("${end}",o.toString());return(0,a.h)("div",{class:"list-pagination-info-wrapper"},m)}renderImageItemCardList(){const{strings:e,activeImageItemListNavTab:t,imageItemFeatures:i,selectedImageItemFeatures:s,layer:n,isShowingThumbnails:r,imageItemListCurPageStartIndex:o,inspectImageItemFeature:m,isShowingImageItemInspectPopover:d}=this,c=t===l.I.All?i:s,h=(0,l.p)(o,this.imageItemCountPerPage,c.length),g=null==c?void 0:c.slice(o-1,h).map((i=>{if(!i)return;const o=i.attributes[n.objectIdField],c=t===l.I.Select||this.getObjectIdsFromImageItemFeatures(s).includes(o),h=d&&(null==m?void 0:m.attributes[n.objectIdField])===o;return(0,a.h)("li",{onMouseOver:()=>this.highlightImageItem(i),onMouseOut:this.removeImageItemHighlight},(0,a.h)("calcite-card",null,(0,a.h)("div",{class:"image-item-info-container"},r?this.renderPreviewThumbnail(o):null,(0,a.h)("div",{class:"image-item-info-text-section"},(0,a.h)("div",null,i.attributes.Name||i.attributes.name),this.renderFeatureAttributesInImageItemCard(i))),(0,a.h)("div",{slot:"footer-start",style:{"flex-wrap":"wrap"}},(0,a.h)("calcite-button",{kind:"neutral","icon-start":"information",appearance:h?"solid":"transparent",title:e.viewImageDetails,onClick:()=>this.openImageItemInspectPopover(i)}),(0,a.h)("calcite-button",{kind:"neutral","icon-start":"zoom-to-object",appearance:"transparent",title:e.zoomToImage,onClick:()=>this.zoomToSelectedImageItems([i])}),(0,a.h)("calcite-button",{kind:"neutral","icon-start":"add-layer",appearance:"transparent",title:e.addImageToMap,onClick:()=>this.handleAddSelectedImageItemsAsNewLayer([i])})),(0,a.h)("div",{slot:"footer-end"},(0,a.h)("calcite-button",{appearance:c?"solid":"outline",kind:"neutral",iconEnd:c?"x":"",onClick:()=>{const e=c?s.filter((e=>(null==e?void 0:e.attributes[n.objectIdField])!==o)):[...s,i];this.sortSelectedImageItems(e)}},c?e.selected:e.select))))}));return(0,a.h)("ul",{class:"image-item-card-list"},g)}renderPreviewThumbnail(e){const{layer:t,modules:i}=this,{IdentityManager:s}=i,n=s.findCredential(t.url),{token:r}=n||{},o=`${t.url}/${e}/thumbnail${r?`?token=${r}`:""}`;return(0,a.h)("img",{src:o})}renderFeatureAttributesInImageItemCard(e){const{imageItemCardDisplayedFields:t,modules:i}=this,{CodedValueDomain:s}=i,n=t.map((t=>{let i=e.attributes[t.name];if("date"===t.type)i=(0,l.k)(i);else if((0,l.m)(t)){const e=t.domain;i="function"==typeof e.getName?e.getName(i):s.fromJSON(t.domain).getName(i)}return(0,a.h)("li",null,`${t.name} : ${i}`)}));return(0,a.h)("ul",{class:"image-item-card-displayed-field-list"},n)}renderImageItemListPagination(){const{strings:e,activeImageItemListNavTab:t,totalImageItemCount:i,imageItemListCurPageStartIndex:s,selectedImageItemFeatures:n}=this,r=t===l.I.All?i:n.length;return(0,a.h)("div",{class:"pagination-wrapper"},(0,a.h)("calcite-pagination",{onCalcitePaginationChange:e=>{const t=e.target;this.imageItemListPrevPageStartIndex=this.imageItemListCurPageStartIndex,this.imageItemListCurPageStartIndex=t.startItem,this.handleImageItemListPageChange(this.imageItemListCurPageStartIndex)},startItem:s,totalItems:r,pageSize:this.imageItemCountPerPage,messageOverrides:{next:e.next,previous:e.previous},class:{hide:!r||r<this.imageItemCountPerPage}}))}renderNoImageItemFetchedCoachMessage(){const{strings:e,isFilterApplied:t}=this;return(0,a.h)("div",{class:"no-image-item-coach-wrapper"},(0,a.h)("calcite-icon",{scale:"l",icon:"overview"}),t?e.updateFilterOrZoomToBrowseImages:e.zoomToBrowseImages,t?(0,a.h)("calcite-button",{kind:"neutral",appearance:"outline",onClick:()=>{this.isShowingFiltersPopover=!0}},e.updateFilters):(0,a.h)("calcite-button",{kind:"neutral",appearance:"outline",onClick:this.handleZoomToLayer},e.zoomToImages))}renderAlert(e,t,i){return(0,a.h)("calcite-alert",{kind:i,label:t,open:!0,icon:"exclamation-mark-circle"},(0,a.h)("div",{slot:"title"},e),(0,a.h)("div",{slot:"message"},t))}resetPaginationStartIndex(){this.imageItemListCurPageStartIndex=1,this.imageItemListPrevPageStartIndex=1}getObjectIdsFromImageItemFeatures(e){const{layer:t}=this;return Array.isArray(e)?e.filter((e=>!!e)).map((e=>e.attributes[t.objectIdField])):[]}sortSelectedImageItems(e){const{imageItemSortField:t,imageItemSortOrder:i}=this,a=e.sort(((e,a)=>{const s=e.attributes[t.name],n=a.attributes[t.name];return i===l.S.Asc?(0,l.n)(s,n,this.locale):(0,l.n)(n,s,this.locale)}));this.selectedImageItemFeatures=a}get hostElement(){return(0,a.d)(this)}static get watchers(){return{selectedImageItemFeatures:["handleSelectedImageItemsChange"],activeQueryField:["handleQueryFieldChanged"]}}};h.style=":host{display:flex;flex-direction:column;flex:1 1 auto;overflow:hidden}.image-item-list-container{display:flex;flex-direction:column;flex:1 1 auto;padding:5px 5px 0}.image-item-card-list{width:100%;padding:0;margin:0;overflow-y:auto;list-style:none}.image-item-list-selection-button-wrapper{display:flex;align-items:center;justify-content:space-between;padding:0.5rem}.image-item-info-container{display:flex;align-items:center;flex-wrap:wrap;gap:10px}.image-item-info-container>img{max-width:50%}.image-item-info-text-section{flex:1;word-break:break-word}.image-item-info-text-section>div{margin-bottom:10px;font-size:var(--calcite-font-size--1);font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-text-1)}.list-pagination-info-wrapper{padding-inline-start:0.5rem}.image-item-inspect-button-group{text-align:start}.image-item-card-displayed-field-list{list-style-type:none;padding:0;margin:0;word-break:break-word}.sort-image-item-action-wrapper{border-inline-start:1px solid var(--calcite-color-foreground-3);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.pagination-wrapper{display:flex;justify-content:center;padding:0.5rem 0}.pagination-wrapper .hide{display:none}.no-image-item-coach-wrapper{display:flex;height:100%;flex-direction:column;align-items:center;justify-content:center;text-align:center;gap:1rem}"},81457:(e,t,i)=>{i.d(t,{a:()=>d,b:()=>m,c:()=>c,d:()=>n,e:()=>s,g:()=>o,r:()=>l,s:()=>r});var a=i(11246);function s(e,t,i,a){!function(e,t,i){i=i||{};let a=null==i?void 0:i.expires;if("number"==typeof a){const e=new Date,t=24*a*60*60*1e3;e.setTime(Date.now()+t),a=i.expires=e}"string"!=typeof a&&(null==a?void 0:a.toUTCString)&&(i.expires=a.toUTCString());let s,n=`${e}=${encodeURIComponent(t)}`;for(s in i){n+=`; ${s}`;const e=i[s];!0!==e&&(n+=`=${e}`)}document.cookie=n}(e,a?JSON.stringify(t):t,i)}function n(e,t){const i=function(e){const t=document.cookie,i=new RegExp(`(?:^|; )${(0,a.e)(e)}=([^;]*)`),s=t.match(i);return s?decodeURIComponent(s[1]):void 0}(e);return i&&t?JSON.parse(i):i}function r(e,t,i){window.localStorage.setItem(e,i?JSON.stringify(t):t)}function o(e,t){const i=window.localStorage.getItem(e);return i&&t?JSON.parse(i):i}function l(e){window.localStorage.removeItem(e)}function m(e,t,i){window.sessionStorage.setItem(e,i?JSON.stringify(t):t)}function d(e,t){const i=window.sessionStorage.getItem(e);return i&&t?JSON.parse(i):i}function c(e){window.sessionStorage.removeItem(e)}}}]);