/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-aa2602.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-aa2602"],{42579:(e,t,i)=>{i.r(t),i.d(t,{arcgis_aggregation:()=>x,arcgis_aggregation_binning:()=>P,arcgis_aggregation_clustering:()=>T,arcgis_aggregation_field:()=>A,arcgis_aggregation_fields:()=>N,arcgis_aggregation_info_popover:()=>I,arcgis_aggregation_symbol_styler_popover:()=>L,arcgis_aggregation_tile:()=>R});var s=i(7263),a=i(58233),n=i(62159),o=i(28926),l=i(1991),r=i(77040),c=i(11246),d=i(28939);i(78613),i(70506),i(99004);var g;function h(e,t,i){if(t&&(null==e?void 0:e.tagName)===t.toUpperCase()||i&&(null==e?void 0:e.classList.contains(i)))return e;{let s=null==e?void 0:e.parentElement;for(;s;){if(t&&s.tagName===t.toUpperCase()||i&&s.classList.contains(i))return s;if("BODY"===s.tagName)break;s=s.parentElement}}}function p(e,t){switch(e){case"sum":return t.fields.sum;case"avg":return t.fields.mean;case"min":return t.fields.min;case"max":return t.fields.max;case"stddev":return t.fields.stdDev;case"mode":return t.fields.mode;case"var":return t.fields.var;case"count":return t.fields.count;default:return""}}function u(e){const t=e.featureReduction;if(t)return"binning"===t.type?"binning":"cluster"===t.type?function(e){var t,i;const s=e.featureReduction;return s.renderer&&"pie-chart"===s.renderer.type&&!(null===(i=null===(t=null==s?void 0:s.renderer)||void 0===t?void 0:t.authoringInfo)||void 0===i?void 0:i.isAutoGenerated)}(e)?"pie-chart":"cluster":void 0}function m(e){const{SimpleLineSymbol:t,SimpleMarkerSymbol:i,Color:s}=e;return new i({style:"circle",size:6.75,outline:new t({style:"solid",color:new s([92,92,92,64]),width:1}),color:new s([227,139,79,255])})}function f(e,t){return"picture-marker"===e.type||"cim"===e.type&&!function(e,t){const{cimSymbolUtils:i}=t;return!!i.getCIMSymbolColor(e)}(e,t)}function b(e,t){var i,s;const{cimSymbolUtils:a,Color:n}=t;return"cim"===(null==e?void 0:e.type)?n.fromJSON(null===(i=a.getCIMSymbolColor(e))||void 0===i?void 0:i.toJSON()):"simple-marker"===(null==e?void 0:e.type)&&["x","cross"].indexOf(null==e?void 0:e.style)>-1?null===(s=null==e?void 0:e.outline)||void 0===s?void 0:s.color:null==e?void 0:e.color}function y(e,t){const{cimSymbolUtils:i}=t;return"cim"===e.type?i.getCIMSymbolSize(e):e.size?e.size:e.width}function v(e,t){return t&&e.fields.find((e=>e.name===t))}function F(e,t,i){var s;return!!(null===(s=e.featureReduction.fields)||void 0===s?void 0:s.find((e=>e.onStatisticField===t&&e.statisticType===i)))}function C(e,t,i,s){var a;const n=t.substring(0,t.lastIndexOf(`_${i}`));return!!(null===(a=e.featureReduction.fields)||void 0===a?void 0:a.find((e=>e.name.substring(0,e.name.lastIndexOf(`_${s}`))===n&&e.statisticType===s)))}function S(e){return["string","date","timestamp-offset"].includes(e.type)?["mode"]:["sum","avg","min","max","mode"]}function w(e,t,i){const{FieldInfo:s}=i,a=t.featureReduction,{popupTemplate:n}=a;n.fieldInfos=n.fieldInfos||[];n.fieldInfos.find((t=>t.fieldName===e.name))||n.fieldInfos.push(new s({fieldName:e.name,label:e.alias,isEditable:!1,visible:!0,format:E(e,t)}))}function k(e,t){return e.featureReduction.popupTemplate.fieldInfos.find((e=>e.fieldName===t))}function E(e,t){const i=e.onStatisticField,s=e.onStatisticExpression,a="sum"===e.statisticType,n="count"===e.statisticType,o=v(t,i),l=n||s&&a||o&&["small-integer","big-integer","integer","long","number"].indexOf(o.type)>-1;return o&&["single","double"].indexOf(o.type)>-1?{digitSeparator:!0,places:1}:l?{digitSeparator:!0}:void 0}!function(e){e.CLUSTERING="clustering",e.CHART_CLUSTERING="chartClustering",e.BINNING="binning"}(g||(g={}));const x=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationStyleClick=(0,s.c)(this,"arcgisAggregationStyleClick",7),this.arcgisAggregationClose=(0,s.c)(this,"arcgisAggregationClose",7),this.arcgisAggregationChanged=(0,s.c)(this,"arcgisAggregationChanged",7),this.arcgisAggregationError=(0,s.c)(this,"arcgisAggregationError",7),this.tileNodes=[],this.lastFeatureReduction=[],this.view=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.hideLayerTitle=!1,this.options=void 0}async setFocus(){var e;null===(e=this.flowItemNode)||void 0===e||e.setFocus()}async componentWillLoad(){const[e,t]=await(0,n.g)(this.hostElement);this.strings=e,this.locale=t;const[i,s,a,l,r,c,d,g,h,p]=await(0,o.l)(["esri/smartMapping/popup/clusters","esri/support/popupUtils","esri/smartMapping/heuristics/binLevel","esri/smartMapping/labels/clusters","esri/smartMapping/labels/bins","esri/layers/support/AggregateField","esri/popup/FieldInfo","esri/smartMapping/renderers/pieChart","esri/smartMapping/renderers/color","esri/renderers/SimpleRenderer"]);this.modules={popupClusters:i,popupUtils:s,binLevel:a,clusterLabelCreator:l,binLabelCreator:r,AggregateField:c,FieldInfo:d,pieChartCreator:g,colorCreator:h,SimpleRenderer:p};const{view:u,layer:m}=this;this.props={view:u,layer:m},this.initializeFieldInfos()}componentDidLoad(){var e;const{props:t,modules:i}=this,{layer:s}=t,{AggregateField:a}=i,n=s.featureReduction;if(n&&!(null===(e=n.fields)||void 0===e?void 0:e.length)){const e=new a({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0});s.featureReduction.fields=[e]}requestAnimationFrame((()=>this.flowItemNode.setFocus()))}render(){const{layer:e,options:t}=this;return(0,s.h)(s.H,{key:"5d35585c01577e95c015e98f1b17e54fb45adcbd",class:"calcite-match-height"},(0,s.h)("calcite-flow",{key:"1743ff2b2e538213c08c166420f1b4e55b188ad9",class:"flow",dir:(0,a.g)(this.hostElement),ref:e=>this.flowNode=e},e.featureEffect?this.renderMsg():this.renderContent(),(t===g.CLUSTERING||t===g.CHART_CLUSTERING)&&this.renderClusteringOptions(),t===g.BINNING&&this.renderBinningOptions()))}renderContent(){var e,t,i;const{props:n,hideLayerTitle:o,config:l,flowItemNode:r,tileNodes:c,strings:d}=this,{layer:h}=n,p=h.featureReduction,m="rtl"===(0,a.g)(this.hostElement),f={flowItemNode:r,strings:d,config:l},{renderer:b}=h,y="unique-value"===b.type,v=y&&!!b.field2,F="heatmap"===b.type,C="pie-chart"===b.type,S=!!b.valueExpression,w="class-breaks"===b.type&&"class-breaks-color"===(null===(e=b.authoringInfo)||void 0===e?void 0:e.type),k=y?null===(t=b.uniqueValueInfos)||void 0===t?void 0:t.length:w?null===(i=b.classBreakInfos)||void 0===i?void 0:i.length:0,E=!F&&!C&&!v,x=(y||w)&&k<=10&&!v&&!S,P=u(h);return(0,s.h)("calcite-flow-item",{heading:d.aggregation,description:o?void 0:h.title,class:{panel:!0,[a.C.rtl]:m},closable:!0,onCalciteFlowItemClose:()=>{this.arcgisAggregationClose.emit()},ref:e=>{this.flowItemNode=e}},(0,s.h)("div",{class:"toggle"},(0,s.h)("calcite-label",{layout:"inline-space-between"},d.enableAggregation,(0,s.h)("calcite-switch",{scale:"s",checked:!!p,label:d.enableAggregation,onCalciteSwitchChange:e=>this.handleToggleClustering(e),ref:e=>this.switchNode=e}))),(0,s.h)("div",null,E&&(0,s.h)("arcgis-aggregation-tile",{props:Object.assign({title:d.clustering,imagePath:(0,s.a)("./assets/arcgis-aggregation-thumbnails/clustering.jpg"),moreInfo:d.info.clustering,helpId:"120003927"},f),selected:"cluster"===P,ref:e=>c.cluster=e,onArcgisAggregationTileSelect:async()=>{await this.enableAggregation("cluster"),(0,s.f)(this.hostElement)},onArcgisAggregationTileOptions:()=>{this.options=g.CLUSTERING,(0,s.f)(this.hostElement)}}),x&&(0,s.h)("arcgis-aggregation-tile",{props:Object.assign({title:d.chartClustering,imagePath:(0,s.a)("./assets/arcgis-aggregation-thumbnails/chartClustering.jpg"),moreInfo:d.info.chartClustering,helpId:"120003927"},f),selected:"pie-chart"===P,ref:e=>c["pie-chart"]=e,onArcgisAggregationTileSelect:async()=>{await this.enableAggregation("pie-chart"),(0,s.f)(this.hostElement)},onArcgisAggregationTileOptions:()=>{this.options=g.CHART_CLUSTERING,(0,s.f)(this.hostElement)}}),(0,s.h)("arcgis-aggregation-tile",{props:Object.assign({title:d.binning,imagePath:(0,s.a)("./assets/arcgis-aggregation-thumbnails/binning.jpg"),moreInfo:d.info.binning,helpId:"120003926"},f),selected:"binning"===P,ref:e=>c.binning=e,onArcgisAggregationTileSelect:async()=>{await this.enableAggregation("binning"),(0,s.f)(this.hostElement)},onArcgisAggregationTileOptions:()=>{this.options=g.BINNING,(0,s.f)(this.hostElement)}})))}renderMsg(){const{layer:e,hideLayerTitle:t,strings:i}=this,n="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("calcite-flow-item",{heading:i.aggregation,description:t?void 0:e.title,class:{panel:!0,[a.C.rtl]:n},closable:!0,onCalciteFlowItemClose:()=>{this.arcgisAggregationClose.emit()},ref:e=>{this.flowItemNode=e}},(0,s.h)("calcite-tip",{"non-dismissible":!0},i.cluster.leNotSupportedMessage))}renderClusteringOptions(){const{props:e,hideLayerTitle:t,portal:i,config:a,flowNode:n,strings:o,locale:l}=this,{layer:r,view:c}=e;return(0,s.h)("arcgis-aggregation-clustering",{view:c,layer:r,portal:i,config:a,flowNode:n,hideLayerTitle:t,strings:o,currentLanguage:l,onArcgisAggregationClusteringChange:()=>this.arcgisAggregationChanged.emit(),onArcgisAggregationClusteringDismissedChange:()=>{},onCalcitePanelBackClick:()=>{this.options=void 0}})}renderBinningOptions(){const{props:e,hideLayerTitle:t,portal:i,config:a,flowNode:n,strings:o,locale:l}=this,{layer:r,view:c}=e;return(0,s.h)("arcgis-aggregation-binning",{view:c,layer:r,portal:i,config:a,flowNode:n,hideLayerTitle:t,strings:o,currentLanguage:l,onArcgisAggregationBinningChange:()=>this.arcgisAggregationChanged.emit(),onArcgisAggregationBinningDismissedChange:()=>{},onCalcitePanelBackClick:()=>{this.options=void 0}})}async handleToggleClustering(e){e.currentTarget.checked?await this.enableAggregation("default"):this.disableAggregation(),(0,s.f)(this.hostElement)}async enableAggregation(e){const{props:t,flowItemNode:i}=this,{layer:a}=t,{renderer:n}=a,o="unique-value"===n.type&&!!n.field2,l="heatmap"===n.type,r="pie-chart"===n.type;if("default"===e&&this.lastFeatureReductionType&&this.lastFeatureReduction[this.lastFeatureReductionType])a.featureReduction=this.lastFeatureReduction[this.lastFeatureReductionType],a.featureReduction=a.featureReduction.clone(),this.arcgisAggregationChanged.emit();else{"default"===e&&(e=l||r||o?"binning":"cluster");const t=u(a);if(t&&("binning"===a.featureReduction.type&&(a.featureReduction.labelsVisible=!1),this.lastFeatureReduction[t]=a.featureReduction),this.lastFeatureReduction[e])a.featureReduction=this.lastFeatureReduction[e],a.featureReduction=a.featureReduction.clone(),this.arcgisAggregationChanged.emit();else try{i.loading=!0,"binning"===e?await this.createBinning():await this.createCluster(e),i.loading=!1,a.featureReduction=a.featureReduction.clone(),this.arcgisAggregationChanged.emit()}catch(e){i.loading=!1,this.arcgisAggregationError.emit({message:"Aggregation style could not be changed.",type:"warning"}),(0,s.f)(this.hostElement)}}}async createCluster(e){var t,i;const{props:s,switchNode:a,tileNodes:n,modules:o}=this,{layer:l,view:r}=s,{popupClusters:c,clusterLabelCreator:d,pieChartCreator:g}=o,h=l.featureReduction;try{const s="cluster"===e&&await d.getLabelSchemes({layer:l,renderer:l.renderer,view:r});let a;l.featureReduction={type:"cluster",clusterMinSize:(null===(t=null==s?void 0:s.primaryScheme)||void 0===t?void 0:t.clusterMinSize)||9,clusterMaxSize:37.5,clusterRadius:37.5,labelsVisible:"cluster"===e,labelingInfo:null===(i=null==s?void 0:s.primaryScheme)||void 0===i?void 0:i.labelingInfo},"pie-chart"===e&&(a=await g.createRendererForClustering({layer:l}),l.featureReduction.renderer=a.renderer,l.featureReduction.fields=l.featureReduction.fields.concat(a.fields));const n=await c.getTemplates({renderer:l.renderer,layer:l});if("cluster"===e){const e=n.primaryTemplate.value;l.featureReduction.popupTemplate=e}else{const e=n.secondaryTemplates[0].value;l.featureReduction.popupTemplate=e,a.fields.forEach((e=>w(e,l,o)))}return Promise.resolve()}catch(e){return l.featureReduction=h,l.featureReduction?n[u(l)].setFocus():a.setFocus(),Promise.reject()}}async createBinning(){var e,t;const{props:i,switchNode:s,tileNodes:a,modules:n}=this,{layer:o,view:l}=i,{popupUtils:r,binLevel:c,binLabelCreator:d,AggregateField:g,colorCreator:h}=n,p=o.featureReduction;try{const i=c,s=await i({view:l});if(o.featureReduction={type:"binning",fixedBinLevel:s||1},!(null===(e=o.featureReduction.fields)||void 0===e?void 0:e.length)){const e=new g({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0});o.featureReduction.fields=[e]}const a=await h.createContinuousRenderer({layer:o,view:l,field:"aggregateCount",outlineOptimizationEnabled:!0,sizeOptimizationEnabled:!0,defaultSymbolEnabled:!1,forBinning:!0});o.featureReduction.renderer=a.renderer;const n=await d.getLabelSchemes({layer:o});o.featureReduction.labelingInfo=null===(t=null==n?void 0:n.primaryScheme)||void 0===t?void 0:t.labelingInfo,o.featureReduction.labelsVisible=!1;const p=o.featureReduction.fields.map((e=>e.onStatisticField)),u=r.createPopupTemplateForFeatureReduction({featureReduction:o.featureReduction,fields:o.fields.filter((e=>p.indexOf(e.name)>-1))});return o.featureReduction.popupTemplate=u,Promise.resolve()}catch(e){return o.featureReduction=p,o.featureReduction?a[u(o)].setFocus():s.setFocus(),Promise.reject()}}disableAggregation(){const{props:e}=this,{layer:t}=e,i=u(t);"binning"===i&&(t.featureReduction.labelsVisible=!1),this.lastFeatureReduction[i]=t.featureReduction,this.lastFeatureReductionType=i,t.featureReduction=null,this.arcgisAggregationChanged.emit()}initializeFieldInfos(){const{layer:e,modules:t}=this,i=e.featureReduction;(null==i?void 0:i.popupTemplate)&&!i.popupTemplate.fieldInfos&&i.fields.forEach((i=>w(i,e,t)))}static get assetsDirs(){return["assets"]}get hostElement(){return(0,s.d)(this)}};x.style=":host{height:100%}.flow{height:100%}.panel{height:100%}.toggle{background-color:white;padding:15px 10px 5px 10px}";const P=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationBinningChange=(0,s.c)(this,"arcgisAggregationBinningChange",7),this.arcgisAggregationBinningDismissedChange=(0,s.c)(this,"arcgisAggregationBinningDismissedChange",7),this.arcgisAggregationBinningStyleBtnBackClick=(0,s.c)(this,"arcgisAggregationBinningStyleBtnBackClick",7),this.arcgisAggregationBinningStyleBtnClick=(0,s.c)(this,"arcgisAggregationBinningStyleBtnClick",7),this.calcitePanelBackClick=(0,s.c)(this,"calcitePanelBackClick",7),this.internalChange=(0,s.c)(this,"internalChange",7),this.closeLabelPopovers=(0,s.c)(this,"closeLabelPopovers",7),this.closePopupPopovers=(0,s.c)(this,"closePopupPopovers",7),this.closeAttributePopovers=(0,s.c)(this,"closeAttributePopovers",7),this.disableSizeSlider=!1,this.onBinSizeChange=(0,c.d)((async e=>{const{layer:t,view:i,modules:s}=this,{colorCreator:a,AggregateField:n}=s;t.featureReduction.fixedBinLevel=e;let o=t.featureReduction.fields.find((e=>"count"===e.statisticType));o||(o=new n({name:"aggregateCount",onStatisticField:void 0,alias:"aggregateCount",statisticType:"count",visible:!0}),t.featureReduction.fields.push(o));const l=await a.createContinuousRenderer({layer:t,view:i,field:o.name,outlineOptimizationEnabled:!0,sizeOptimizationEnabled:!0,defaultSymbolEnabled:!1,forBinning:!0});t.featureReduction.renderer=l.renderer,this.internalChange.emit()}),300),this.view=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.flowNode=void 0,this.strings=void 0,this.currentLanguage=void 0,this.hideLayerTitle=!1}internalChangeHandler(){const{layer:e}=this,t=e.featureReduction;e.featureReduction=t.clone(),this.arcgisAggregationBinningChange.emit()}async done(){this.closePopovers()}async setFocus(){this.flowItemNode.setFocus()}async componentWillLoad(){this.layerGeometryType=await(0,l.j)(this.layer);const[e,t,i]=await(0,o.l)(["esri/layers/support/AggregateField","esri/smartMapping/renderers/color","esri/core/reactiveUtils"]);this.modules={AggregateField:e,colorCreator:t,reactiveUtils:i}}async componentDidLoad(){requestAnimationFrame((()=>this.flowItemNode.setFocus()));const{modules:e,view:t,layer:i}=this,s=t;e.reactiveUtils.watch((()=>{var e;return[null===(e=i.featureReduction)||void 0===e?void 0:e.maxScale,s.scale]}),(()=>{const e=i.featureReduction;e&&(s.scale<=e.maxScale&&!this.styleDivNode.classList.contains("btn-disabled")?(this.styleDivNode.classList.add("btn-disabled"),this.styleBtnNode.disabled=!0):s.scale>e.maxScale&&this.styleDivNode.classList.contains("btn-disabled")&&(this.styleDivNode.classList.remove("btn-disabled"),this.styleBtnNode.disabled=!1))}))}componentDidUpdate(){}disconnectedCallback(){var e;this.closePopovers(),this.binSizeTooltipNode&&(null===(e=this.binSizeTooltipNode.parentElement)||void 0===e||e.removeChild(this.binSizeTooltipNode),this.binSizeTooltipNode=null)}render(){const{layer:e,strings:t,hideLayerTitle:i}=this;return(0,s.h)(s.H,{key:"e7d261bb8044dd5cc101f45796f3a7d5947506b5",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"123f693394cf386ae126a03495f95b4d479109e4",heading:t.binning,description:i?void 0:e.title,onCalciteFlowItemBack:()=>{this.calcitePanelBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderBinSize(),this.renderScaleThresholdSlider(),this.renderFieldsBtn(),this.renderLabelBtn(),this.renderPopupBtn(),this.renderStyleBtn()))}renderBinSize(){var e;const{layer:t,strings:i}=this,n="rtl"===(0,a.g)(this.hostElement),o=t.featureReduction;return(0,s.h)("div",{class:"slider-title-wrapper"},(0,s.h)("calcite-label",{class:"slider-heading",layout:"inline"},i.bin.binSizeTitle,(0,s.h)("calcite-button",{"icon-start":"information",scale:"s",appearance:"transparent",kind:"neutral",onClick:e=>{e.stopPropagation(),this.toggleBinSizeTooltip()},ref:e=>this.binSizeInfoButtonNode=e})),(0,s.h)("div",{class:"slider-div"},(0,s.h)("label",{class:"slider-label"},n?i.bin.large:i.bin.small),(0,s.h)("calcite-slider",{class:"slider-slider",min:1,max:9,value:10-(null!==(e=o.fixedBinLevel)&&void 0!==e?e:3),step:1,minLabel:i.bin.binSizeTitle,onCalciteSliderInput:e=>{const t=e.target;this.onBinSizeChange(10-t.value)}}),(0,s.h)("label",{class:"slider-label"},n?i.bin.small:i.bin.large)))}renderScaleThresholdSlider(){const{layer:e,view:t,portal:i,config:a,strings:n}=this;return(0,s.h)("arcgis-aggregation-scale-threshold-slider",{type:"binning",view:t,portal:i,config:a,layer:e,strings:n})}renderFieldsBtn(){const{strings:e}=this,t="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("div",{class:"btn-section"},(0,s.h)("button",{class:"btn",onClick:e=>this.addFieldsPanel(e),ref:e=>this.fieldsButtonNode=e},(0,s.h)("span",{class:"btn-text"},e.bin.editAttributes),(0,s.h)("span",{class:"btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderLabelBtn(){const{strings:e}=this,t="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("div",{class:"btn-section"},(0,s.h)("button",{class:"btn",onClick:e=>this.addLabelPanel(e),ref:e=>this.labelsButtonNode=e},(0,s.h)("span",{class:"btn-text"},e.bin.editLabel),(0,s.h)("span",{class:"btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderPopupBtn(){const{strings:e}=this,t="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("div",{class:"btn-section"},(0,s.h)("button",{class:"btn",onClick:e=>this.addPopupPanel(e),ref:e=>this.popupButtonNode=e},(0,s.h)("span",{class:"btn-text"},e.bin.editPopups),(0,s.h)("span",{class:"btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderStyleBtn(){const{layer:e,view:t,strings:i}=this,n="rtl"===(0,a.g)(this.hostElement),o=t,l=e.featureReduction,r=o.scale<=l.maxScale;return(0,s.h)("div",{class:"btn-section "+(r?"btn-disabled":""),ref:e=>this.styleDivNode=e},(0,s.h)("button",{class:"btn",disabled:r,onClick:e=>this.addStylePanel(e),ref:e=>this.styleBtnNode=e},(0,s.h)("span",{class:"btn-text"},i.bin.editStyle),(0,s.h)("span",{class:"btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:n?"chevron-left":"chevron-right"}))))}closePopovers(){this.closeAttributePopovers.emit(),this.closeLabelPopovers.emit(),this.closePopupPopovers.emit()}toggleBinSizeTooltip(){var e;const{strings:t}=this;if(this.binSizeTooltipNode)null===(e=this.binSizeTooltipNode.parentElement)||void 0===e||e.removeChild(this.binSizeTooltipNode),this.binSizeTooltipNode=null;else{const e=this.binSizeTooltipNode=document.createElement("calcite-tooltip");e.referenceElement=this.binSizeInfoButtonNode,e.open=!0,e.innerHTML=t.bin.binSizeWarning,document.body.append(e)}}addFieldsPanel(e){e.stopPropagation(),this.closePopovers();const{layer:t,view:i,currentLanguage:a,strings:n,flowNode:o,hideLayerTitle:l}=this,r=document.createElement("arcgis-aggregation-fields");r.lang=a,r.layer=t,r.mapView=i,r.strings=n,r.currentLanguage=a,r.hideLayerTitle=l,r.flowNode=o,r.addEventListener("arcgisAggregationFieldsChange",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),r.addEventListener("arcgisAggregationFieldsBackClick",(()=>{o.removeChild(r),setTimeout((()=>this.fieldsButtonNode.focus()),300)})),o.appendChild(r)}addLabelPanel(e){const{layer:t,view:i,portal:a,config:n,currentLanguage:o,strings:l,flowNode:c,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=l.bin.labelBinFeaturesHeading,g.description=d?void 0:t.title;const h=document.createElement("calcite-fab");h.icon="plus",h.slot="fab",h.scale="s",h.appearance="outline-fill",h.kind="neutral",h.label=l.bin.labelFab,h.text=l.bin.labelFab,h.textEnabled=!0,g.appendChild(h);const p=document.createElement("arcgis-label");p.lang=o,p.layer=t,p.mapView=i,p.portal=a,p.config=n,p.layerDisplayType=r.l.cluster,p.calciteFlowProps={calciteFlowItem:g,calciteFab:h},p.addEventListener("labelUpdated",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),g.appendChild(p),g.addEventListener("calciteFlowItemBack",(()=>setTimeout((()=>this.labelsButtonNode.focus()),300))),c.appendChild(g),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}addPopupPanel(e){const{layer:t,view:i,portal:a,config:n,currentLanguage:o,strings:l,flowNode:c,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=l.bin.binPopupsHeading,g.description=d?void 0:t.title;const h=document.createElement("calcite-fab");h.icon="plus",h.slot="fab",h.scale="s",h.appearance="outline-fill",h.kind="neutral",h.label=l.bin.popupFab,h.text=l.bin.popupFab,h.textEnabled=!0,g.appendChild(h);const p=document.createElement("arcgis-popup");p.lang=o,p.layer=t,p.mapView=i,p.portal=a,p.config=n,p.layerDisplayType=r.l.cluster,p.calciteFlowProps={flow:c,calciteFab:h,calciteFlowItem:g},p.addEventListener("popupUpdated",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),g.appendChild(p),g.addEventListener("calciteFlowItemBack",(()=>setTimeout((()=>this.popupButtonNode.focus()),300))),c.appendChild(g),g.setFocus(),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}addStylePanel(e){const{layer:t,view:i,portal:s,config:a,flowNode:n}=this;e.stopPropagation(),this.closePopovers();const o=document.createElement("arcgis-smart-mapping");o.portal=s,o.layer=t,o.mapView=i,o.config=a,o.hideLayerTitle=!0,o.useFeatureReduction=!0,o.addEventListener("arcgisSmartMappingClose",(({detail:e})=>{var t;null===(t=o.parentElement)||void 0===t||t.removeChild(o),this.arcgisAggregationBinningStyleBtnBackClick.emit(e),setTimeout((()=>this.styleBtnNode.focus()),300)})),o.addEventListener("arcgisSmartMappingBeforeBack",(({detail:e})=>this.arcgisAggregationBinningStyleBtnBackClick.emit(e))),n.appendChild(o),o.setFocus(),setTimeout((()=>requestAnimationFrame((()=>o.setFocus()))),200),this.arcgisAggregationBinningStyleBtnClick.emit()}get hostElement(){return(0,s.d)(this)}};P.style=".block-section.sc-arcgis-aggregation-binning{padding:0 10px}.block-content.sc-arcgis-aggregation-binning{padding-top:10px}.slider-title-wrapper.sc-arcgis-aggregation-binning{background-color:var(--arcgis-app-background);border-bottom:1px solid var(--arcgis-app-border);padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing)}.slider-div.sc-arcgis-aggregation-binning{display:flex;align-items:center;justify-content:space-between;flex-flow:row wrap}.slider-heading.sc-arcgis-aggregation-binning{display:inline-block;padding:var(--arcgis-app-cap-spacing-half) 0;font-size:var(--arcgis-app-font-size-0)}.slider-label.sc-arcgis-aggregation-binning{display:inline-block;padding:var(--arcgis-app-cap-spacing-eighth) 0;font-size:var(--arcgis-app-font-size--1);order:2}.slider-slider.sc-arcgis-aggregation-binning{display:inline-block;width:100%;order:1}.btn-section.sc-arcgis-aggregation-binning{background-color:var(--arcgis-app-background)}.btn.sc-arcgis-aggregation-binning{background:var(--arcgis-app-background-clear);border:none;border-bottom:solid 1px var(--arcgis-app-border);color:var(--arcgis-app-font-color);display:flex;align-items:center;justify-content:space-between;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing);cursor:pointer;width:100%}.btn.sc-arcgis-aggregation-binning:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.btn-disabled.sc-arcgis-aggregation-binning{opacity:var(--calcite-opacity-disabled)}.btn.sc-arcgis-aggregation-binning:focus{outline:none;border:2px solid var(--calcite-color-brand)}.btn-text.sc-arcgis-aggregation-binning{font-family:var(--arcgis-app-font-family);font-size:var(--arcgis-app-font-size-0)}.style-button-div.sc-arcgis-aggregation-binning{background-color:white;padding:10px}";const T=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationClusteringChange=(0,s.c)(this,"arcgisAggregationClusteringChange",7),this.arcgisAggregationClusteringDismissedChange=(0,s.c)(this,"arcgisAggregationClusteringDismissedChange",7),this.calcitePanelBackClick=(0,s.c)(this,"calcitePanelBackClick",7),this.internalChange=(0,s.c)(this,"internalChange",7),this.closeLabelPopovers=(0,s.c)(this,"closeLabelPopovers",7),this.closePopupPopovers=(0,s.c)(this,"closePopupPopovers",7),this.closeAttributePopovers=(0,s.c)(this,"closeAttributePopovers",7),this.disableSizeSlider=!1,this.view=void 0,this.layer=void 0,this.portal=void 0,this.config=void 0,this.flowNode=void 0,this.strings=void 0,this.currentLanguage=void 0,this.hideLayerTitle=!1,this.symbolSelected=!1}internalChangeHandler(){const{layer:e}=this,t=e.featureReduction;e.featureReduction=t.clone(),this.arcgisAggregationClusteringChange.emit()}async done(){this.closePopovers()}async setFocus(){this.flowItemNode.setFocus()}async componentWillLoad(){this.layerGeometryType=await(0,l.j)(this.layer);const[e,t,i,s,a,n]=await(0,o.l)(["esri/smartMapping/popup/support/utils","esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/Color","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"]);this.modules={symbolUtils:t,cimSymbolUtils:i,Color:s,SimpleMarkerSymbol:a,SimpleLineSymbol:n};const r=e.getPrimaryVisualVariables(this.layer.renderer);this.disableSizeSlider=r.some((e=>"size"===(null==e?void 0:e.type)))}async componentDidLoad(){var e,t;requestAnimationFrame((()=>this.flowItemNode.setFocus()));const{layer:i}=this;if("pie-chart"===(null===(e=i.featureReduction.renderer)||void 0===e?void 0:e.type)){const[e]=await(0,o.l)(["esri/smartMapping/renderers/pieChart"]),s=await e.createRendererForClustering({layer:i});this.autoGeneratedPieChartClusterFields=null===(t=s.fields)||void 0===t?void 0:t.map((e=>e.name))}}componentDidUpdate(){}disconnectedCallback(){this.closePopovers()}render(){const{layer:e,strings:t,hideLayerTitle:i}=this,a=function(e){var t,i;const s=e.featureReduction;return!(null==s?void 0:s.renderer)||(null===(i=null===(t=null==s?void 0:s.renderer)||void 0===t?void 0:t.authoringInfo)||void 0===i?void 0:i.isAutoGenerated)}(e),n=u(e);return(0,s.h)(s.H,{key:"c0b5bd517b273d1c357b427a395776f9e9dda8de",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"41c0229fd33893860ddd0d63739bafde568ef887",heading:t.clustering,description:i?void 0:e.title,onCalciteFlowItemBack:()=>{this.calcitePanelBackClick.emit()},ref:e=>this.flowItemNode=e},a&&this.renderSymbol(),"pie-chart"===n&&this.renderShape(),this.renderClusterRadius(),this.renderClusterSize(),this.renderScaleThresholdSlider(),this.renderFieldsBtn(),this.renderLabelBtn(),this.renderPopupBtn()))}renderSymbol(){const{layer:e,strings:t}=this,i=!!e.featureReduction.symbol;return(0,s.h)("calcite-block-section",{text:t.cluster.overrideSymbol,open:i,"toggle-display":"switch",class:"block-section",onCalciteBlockSectionToggle:e=>{this.handleToggleSymbol(e)}},this.renderSymbolContent())}renderSymbolContent(){const{layer:e,symbolSelected:t,strings:i}=this;if(e.featureReduction.symbol)return(0,s.h)("div",{class:"block-content"},(0,s.h)("calcite-label",null,i.symbolStyle,(0,s.h)("div",{class:"symbol-button "+(t?"selected":""),tabindex:"0",role:"button","aria-label":i.symbolStyle,onClick:e=>this.openSymbolStylerPopover(e)},(0,s.h)("div",{class:"symbol",ref:e=>this.createSymbolPreview(e)}),(0,s.h)("calcite-icon",{scale:"s",icon:"pencil",class:"symbol-icon"}))))}renderShape(){var e;const{layer:t,strings:i}=this,n="rtl"===(0,a.g)(this.hostElement),o=t.featureReduction;return(0,s.h)("div",{class:"slider-title-wrapper"}," ",(0,s.h)("calcite-label",null,i.cluster.shape,(0,s.h)("div",{class:"slider-div"},(0,s.h)("label",{class:"slider-label"},n?i.cluster.donut:i.cluster.pie),(0,s.h)("calcite-slider",{class:"slider-slider",min:0,max:Math.max(.9,o.renderer.holePercentage),value:null!==(e=o.renderer.holePercentage)&&void 0!==e?e:0,step:.1,minLabel:i.cluster.shape,onCalciteSliderInput:e=>{const i=t.featureReduction,s=e.target;i.renderer.holePercentage=s.value,this.internalChange.emit()}}),(0,s.h)("label",{class:"slider-label"},n?i.cluster.pie:i.cluster.donut))))}renderClusterRadius(){var e;const{layer:t,strings:i}=this,n="rtl"===(0,a.g)(this.hostElement),o=t.featureReduction;return(0,s.h)("div",{class:"slider-title-wrapper"},(0,s.h)("label",{class:"slider-heading"},i.cluster.radiusTitle),(0,s.h)("div",{class:"slider-div"},(0,s.h)("label",{class:"slider-label"},n?i.cluster.high:i.cluster.low),(0,s.h)("calcite-slider",{class:"slider-slider",min:9,max:90,value:null!==(e=o.clusterRadius)&&void 0!==e?e:37.5,step:1,minLabel:i.cluster.radiusTitle,onCalciteSliderInput:e=>{const i=t.featureReduction,s=e.target;i.clusterRadius=s.value,this.internalChange.emit()}}),(0,s.h)("label",{class:"slider-label"},n?i.cluster.low:i.cluster.high)))}renderClusterSize(){var e,t;const{layer:i,strings:n,disableSizeSlider:o}=this,l="rtl"===(0,a.g)(this.hostElement),r=i.featureReduction;return(0,s.h)("div",{class:"slider-title-wrapper"},(0,s.h)("label",{class:"slider-heading"},n.cluster.sizeTitle),(0,s.h)("div",{class:"slider-div"},(0,s.h)("label",{class:"slider-label"},l?n.cluster.max:n.cluster.min),(0,s.h)("calcite-slider",{class:"slider-slider",min:9,max:90,minValue:null!==(e=r.clusterMinSize)&&void 0!==e?e:9,maxValue:null!==(t=r.clusterMaxSize)&&void 0!==t?t:90,step:1,disabled:o,minLabel:`${n.cluster.min} ${n.cluster.sizeTitle}`,maxLabel:`${n.cluster.max} ${n.cluster.sizeTitle}`,onCalciteSliderInput:e=>{const t=i.featureReduction,s=e.target;t.clusterMinSize=s.minValue,t.clusterMaxSize=s.maxValue,this.internalChange.emit()}}),(0,s.h)("label",{class:"slider-label"},l?n.cluster.min:n.cluster.max)))}renderScaleThresholdSlider(){const{layer:e,view:t,portal:i,config:a,strings:n}=this;return(0,s.h)("arcgis-aggregation-scale-threshold-slider",{type:u(e),view:t,portal:i,config:a,layer:e,strings:n})}renderFieldsBtn(){const{strings:e}=this,t="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("div",{class:"cluster-btn-section"},(0,s.h)("button",{class:"cluster-btn",onClick:e=>this.addFieldsPanel(e),ref:e=>this.fieldsButtonNode=e},(0,s.h)("span",{class:"cluster-btn-text"},e.cluster.editClusterAttributes),(0,s.h)("span",{class:"cluster-btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderLabelBtn(){const{strings:e}=this,t="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("div",{class:"cluster-btn-section"},(0,s.h)("button",{class:"cluster-btn",onClick:e=>this.addLabelPanel(e),ref:e=>this.labelsButtonNode=e},(0,s.h)("span",{class:"cluster-btn-text"},e.cluster.editClusterLabel),(0,s.h)("span",{class:"cluster-btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}renderPopupBtn(){const{strings:e}=this,t="rtl"===(0,a.g)(this.hostElement);return(0,s.h)("div",{class:"cluster-btn-section"},(0,s.h)("button",{class:"cluster-btn",onClick:e=>this.addPopupPanel(e),ref:e=>this.popupButtonNode=e},(0,s.h)("span",{class:"cluster-btn-text"},e.cluster.editClusterPopups),(0,s.h)("span",{class:"cluster-btn-icon"},(0,s.h)("calcite-icon",{scale:"s",icon:t?"chevron-left":"chevron-right"}))))}closePopovers(){var e,t;this.closeAttributePopovers.emit(),this.closeLabelPopovers.emit(),this.closePopupPopovers.emit(),null===(t=null===(e=this.stylerPopoverNode)||void 0===e?void 0:e.parentElement)||void 0===t||t.removeChild(this.stylerPopoverNode),this.stylerPopoverNode=null}handleToggleSymbol(e){const{layer:t,modules:i}=this,a=t.featureReduction;e.currentTarget.open?this.lastSymbol?(a.symbol=this.lastSymbol,this.lastSymbol=void 0):a.symbol=m(i):(this.lastSymbol=a.symbol,a.symbol=void 0),this.internalChange.emit(),(0,s.f)(this.hostElement)}createSymbolPreview(e){const{layer:t,modules:i}=this,{symbolUtils:s}=i,a=t.featureReduction;if(!a.symbol)return;const n=a.symbol,o="cim"===n.type?20:14;s.renderPreviewHTML(n,{size:o,symbolConfig:void 0}).then((t=>{e.childNodes.forEach((t=>e.removeChild(t))),e.appendChild(t)}))}async openSymbolStylerPopover(e){const{layer:t,portal:i,strings:a}=this,n=h(e.target,null,"symbol-button");this.stylerPopoverNode?(this.symbolSelected=!1,this.closePopovers(),this.stylerPopoverNode=null):(this.closePopovers(),this.symbolSelected=!0,this.stylerPopoverNode=document.createElement("arcgis-aggregation-symbol-styler-popover"),this.stylerPopoverNode.props={layer:t,portal:i,strings:a},this.stylerPopoverNode.referenceElement=this.flowItemNode,this.stylerPopoverNode.addEventListener("arcgisAggregationSymbolStylerPopoverClose",(()=>{this.closePopovers(),this.symbolSelected=!1,setTimeout((()=>n.focus()),300)})),this.stylerPopoverNode.addEventListener("arcgisAggregationSymbolStylerChange",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),document.body.appendChild(this.stylerPopoverNode),this.stylerPopoverNode.setOpen(!0))}addFieldsPanel(e){e.stopPropagation(),this.closePopovers();const{layer:t,view:i,currentLanguage:a,strings:n,flowNode:o,hideLayerTitle:l,autoGeneratedPieChartClusterFields:r}=this,c=document.createElement("arcgis-aggregation-fields");c.lang=a,c.layer=t,c.mapView=i,c.strings=n,c.currentLanguage=a,c.hideLayerTitle=l,c.flowNode=o,c.autoGeneratedPieChartClusterFields=r,c.addEventListener("arcgisAggregationFieldsChange",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),c.addEventListener("arcgisAggregationFieldsBackClick",(()=>{o.removeChild(c),setTimeout((()=>this.fieldsButtonNode.focus()),300)})),o.appendChild(c)}addLabelPanel(e){const{layer:t,view:i,portal:a,config:n,currentLanguage:o,strings:l,flowNode:c,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=l.cluster.labelClusterFeaturesHeading,g.description=d?void 0:t.title;const h=document.createElement("calcite-fab");h.icon="plus",h.slot="fab",h.scale="s",h.appearance="outline-fill",h.kind="neutral",h.label=l.cluster.labelFab,h.text=l.cluster.labelFab,h.textEnabled=!0,g.appendChild(h);const p=document.createElement("arcgis-label");p.lang=o,p.layer=t,p.mapView=i,p.portal=a,p.config=n,p.layerDisplayType=r.l.cluster,p.calciteFlowProps={calciteFlowItem:g,calciteFab:h},p.addEventListener("labelUpdated",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),g.appendChild(p),g.addEventListener("calciteFlowItemBack",(()=>setTimeout((()=>this.labelsButtonNode.focus()),300))),c.appendChild(g),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}addPopupPanel(e){const{layer:t,view:i,portal:a,config:n,currentLanguage:o,strings:l,flowNode:c,hideLayerTitle:d}=this;e.stopPropagation(),this.closePopovers();const g=document.createElement("calcite-flow-item");g.heading=l.cluster.clusterPopupsHeading,g.description=d?void 0:t.title;const h=document.createElement("calcite-fab");h.icon="plus",h.slot="fab",h.scale="s",h.appearance="outline-fill",h.kind="neutral",h.label=l.cluster.popupFab,h.text=l.cluster.popupFab,h.textEnabled=!0,g.appendChild(h);const p=document.createElement("arcgis-popup");p.lang=o,p.layer=t,p.mapView=i,p.portal=a,p.config=n,p.layerDisplayType=r.l.cluster,p.calciteFlowProps={flow:c,calciteFab:h,calciteFlowItem:g},p.addEventListener("popupUpdated",(()=>{this.internalChange.emit(),(0,s.f)(this.hostElement)})),g.appendChild(p),g.addEventListener("calciteFlowItemBack",(()=>setTimeout((()=>this.popupButtonNode.focus()),300))),c.appendChild(g),setTimeout((()=>requestAnimationFrame((()=>g.setFocus()))),200)}get hostElement(){return(0,s.d)(this)}};T.style=".block-section.sc-arcgis-aggregation-clustering{padding:0 10px}.block-content.sc-arcgis-aggregation-clustering{padding-top:10px}.symbol-button.sc-arcgis-aggregation-clustering{border:solid 1px var(--arcgis-app-border);display:flex;justify-content:space-between}.symbol-button.selected.sc-arcgis-aggregation-clustering{border-color:var(--calcite-color-brand);border-width:1px}.symbol-button.sc-arcgis-aggregation-clustering:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.symbol-button.sc-arcgis-aggregation-clustering:focus{border-color:var(--calcite-color-brand);border-width:2px}.symbol.sc-arcgis-aggregation-clustering{padding:5px}.symbol-icon.sc-arcgis-aggregation-clustering{padding:6px}.slider-title-wrapper.sc-arcgis-aggregation-clustering{background-color:var(--arcgis-app-background);border-bottom:1px solid var(--arcgis-app-border);padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing)}.slider-div.sc-arcgis-aggregation-clustering{display:flex;align-items:center;justify-content:space-between;flex-flow:row wrap}.slider-heading.sc-arcgis-aggregation-clustering{display:inline-block;padding:var(--arcgis-app-cap-spacing-half) 0;font-size:var(--arcgis-app-font-size-0)}.slider-label.sc-arcgis-aggregation-clustering{display:inline-block;padding:var(--arcgis-app-cap-spacing-eighth) 0;font-size:var(--arcgis-app-font-size--1);order:2}.slider-slider.sc-arcgis-aggregation-clustering{display:inline-block;width:100%;order:1}.cluster-btn-section.sc-arcgis-aggregation-clustering{background-color:var(--arcgis-app-background)}.cluster-btn.sc-arcgis-aggregation-clustering{background:var(--arcgis-app-background-clear);border:none;border-bottom:solid 1px var(--arcgis-app-border);color:var(--arcgis-app-font-color);display:flex;align-items:center;justify-content:space-between;padding:var(--arcgis-app-cap-spacing) var(--arcgis-app-side-spacing);cursor:pointer;width:100%}.cluster-btn.sc-arcgis-aggregation-clustering:hover{background-color:var(--arcgis-app-background-hover);border-color:var(--arcgis-app-border-hover)}.cluster-btn.sc-arcgis-aggregation-clustering:focus{outline:none;border:2px solid var(--calcite-color-brand)}.cluster-btn-text.sc-arcgis-aggregation-clustering{font-family:var(--arcgis-app-font-family);font-size:var(--arcgis-app-font-size-0)}";const A=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationFieldChange=(0,s.c)(this,"arcgisAggregationFieldChange",7),this.arcgisAggregationFieldDelete=(0,s.c)(this,"arcgisAggregationFieldDelete",7),this.displayDate=new Date("December 31, 1969 18:00:00"),this.arcadeExpMap=new Map,this.disconnected=!1,this.onFieldSelect=()=>{const{layer:e,mapView:t,aggregateField:i,fieldPickListSortBy:s,strings:a}=this,n=h(this.hostElement,"calcite-flow-item"),o=n.getBoundingClientRect().width||215;this.arcgisFieldPickList=document.createElement("arcgis-field-pick-list"),this.arcgisFieldPickList.popoverProps={placement:"auto",offsetDistance:-1*(o+10),offsetSkidding:0,pointerDisabled:!0,popoverWidth:o+30,refElement:n},this.arcgisFieldPickList.fields=this.createPickListFields(),this.arcgisFieldPickList.layer=e,this.arcgisFieldPickList.mapView=t,this.arcgisFieldPickList.showFieldInfo=!0,this.arcgisFieldPickList.showFieldName=!1,this.arcgisFieldPickList.selectedFields=[i.onStatisticField],this.arcgisFieldPickList.sortBy=s,this.arcgisFieldPickList.addEventListener("arcgisFieldPickListDismissed",(t=>{var i,s;t.stopPropagation();const o=null===(s=null===(i=t.detail)||void 0===i?void 0:i.selectedFields)||void 0===s?void 0:s[0];if(n.disabled=!1,this.arcgisFieldPickList&&(document.body.removeChild(this.arcgisFieldPickList),this.arcgisFieldPickList=null,setTimeout((()=>{this.fieldNode.setFocus()}),1)),o){const{aggregateField:t}=this,i=v(e,o),s=S(i);let n=0,l=F(e,i.name,s[n]);for(;n<s.length&&l;)n++,s[n]===t.statisticType&&n++,n<s.length&&(l=F(e,i.name,s[n]));if(l)return;const r=t.name,c=s[n];t.name=`${i.name}_${c}`,t.onStatisticField=i.name,t.onStatisticExpression=null,t.alias=`${i.alias||i.name} ${p(c,a).toLowerCase()}`,t.statisticType=c,this.replacePopupField(r),this.currentFieldInfo=this.getCurrentFieldInfo(),this.arcgisAggregationFieldChange.emit()}})),this.arcgisFieldPickList.addEventListener("arcgisFieldPickListSortByChange",(e=>this.fieldPickListSortBy=e.detail)),document.body.appendChild(this.arcgisFieldPickList),n.disabled=!0},this.mapView=void 0,this.layer=void 0,this.aggregateField=void 0,this.open=!1,this.strings=void 0,this.currentLanguage=void 0,this.isAutoGeneratedPieChartClusterField=!1}async done(){this.closePopovers()}async setFocus(){this.panelNode.setFocus()}async componentWillLoad(){const[e,t,i,s]=await(0,o.l)(["esri/popup/FieldInfo","esri/popup/support/FieldInfoFormat","esri/intl","esri/layers/support/fieldUtils"]);this.modules={FieldInfo:e,FieldInfoFormat:t,intl:i,fieldUtils:s};const{layer:a,aggregateField:n,modules:r}=this;k(a,n.name)||w(n,a,r),this.arcadeExpMap=(0,l.f)(this.layer.featureReduction.popupTemplate),this.currentFieldInfo=this.getCurrentFieldInfo(),this.rendererFields=await s.getRendererFields(a.featureReduction.renderer)}componentDidLoad(){var e;this.flowItemNode=h(this.hostElement,"calcite-flow-item");const{currentFieldInfo:t}=this;d.a.get(null===(e=t.format)||void 0===e?void 0:e.dateFormat)&&this.setupDateTimeDisplay()}disconnectedCallback(){this.disconnected=!0,clearTimeout(this.fieldAliasHandle),this.closePopovers()}render(){const{layer:e,aggregateField:t,open:i}=this,n=(0,a.g)(this.hostElement),o=k(e,t.name),l=(t.isAutoGenerated?o.label:t.alias)||t.name;return(0,s.h)(s.H,{key:"bbf0094adb4beb143ca6394c80bbc4a496ef44ef",dir:n},(0,s.h)("calcite-block",{key:"97ee706779ee4f34f76c71f0e046858131e62cf5",heading:l,open:i,collapsible:!0,ref:e=>this.blockNode=e,onCalciteBlockOpen:e=>{const t=e.target;this.open=t.open},onCalciteBlockClose:e=>{const t=e.target;this.open=t.open}},this.renderDropdown(),this.renderFieldSelection(),this.renderFieldTypeOptions(),this.renderTypeSelection(),this.renderResultFieldName(),this.renderFieldAlias(),this.renderFormatting()))}renderDropdown(){var e;const{layer:t,aggregateField:i,strings:n,isAutoGeneratedPieChartClusterField:o}=this,l=null!==(e=v(t,i.onStatisticField))&&void 0!==e?e:i.onStatisticExpression;if(i.isAutoGenerated||o||!l)return null;const r=(0,a.g)(this.hostElement);return(0,s.h)("div",{slot:"control"},(0,s.h)("calcite-dropdown",{dir:r,placement:"bottom-end",scale:"s",overlayPositioning:"fixed"},(0,s.h)("calcite-action",{id:"dropdown-action-element",ref:e=>this.dropdownActionNode=e,slot:"trigger",scale:"m",text:n.delete},(0,s.h)("calcite-icon",{scale:"s",icon:"ellipsis"})),(0,s.h)("calcite-dropdown-group",null,(0,s.h)("calcite-dropdown-item",{onClick:e=>{e.stopPropagation(),this.removeField()},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||this.removeField()}},n.delete))),(0,s.h)("calcite-tooltip",{overlayPositioning:"fixed",referenceElement:"dropdown-action-element",placement:"leading-start"},n.fields.moreOptions))}renderFieldSelection(){var e;const{aggregateField:t,strings:i,isAutoGeneratedPieChartClusterField:a}=this;return t.isAutoGenerated||a||!t.onStatisticField&&!t.onStatisticExpression?null:(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,i.fields.field),(0,s.h)("div",{class:"field-selection"},(0,s.h)("calcite-button",{class:"non-simple-field-button",appearance:"outline-fill",kind:"neutral",width:"full",scale:"m",alignment:"icon-end-space-between",iconEnd:"chevron-down",disabled:t.isAutoGenerated,onClick:()=>this.onFieldSelect(),ref:e=>this.fieldNode=e},t.onStatisticField||(null===(e=t.onStatisticExpression)||void 0===e?void 0:e.title)),(0,s.h)("div",null,"\xa0"),(0,s.h)("calcite-button",{id:"aggregation-attribute-switch",appearance:"outline-fill",kind:"neutral",iconStart:"code",label:i.fields.expression,onClick:()=>this.openArcadeEditor(),ref:e=>{e&&(this.arcadeButtonNode=e)}}),(0,s.h)("calcite-tooltip",{referenceElement:"aggregation-attribute-switch"},i.fields.addExpression)))}renderFieldTypeOptions(){const{aggregateField:e,strings:t,layer:i,rendererFields:a}=this;if(!e.onStatisticExpression)return null;const n=e.onStatisticExpression.returnType,o=a.includes(e.name);return(0,s.h)("div",{class:"section"},(0,s.h)("calcite-label",null,t.fields.fieldType),(0,s.h)("calcite-segmented-control",{disabled:o,scale:"s",width:"full",onCalciteSegmentedControlChange:a=>{const n=a.target.value,o="number"===n?t.fields.sum:t.fields.mode,l=e.name,r=`${e.onStatisticExpression.title}_${o.toLocaleLowerCase()}`;if(i.featureReduction.fields.find((e=>e.name===r))&&l!==r){const t=i.featureReduction.fields.map((e=>e.name));let s=1;for(;t.includes(`${e.onStatisticExpression.title}_${s}_${o.toLocaleLowerCase()}`);)s++;e.onStatisticExpression.title=`${e.onStatisticExpression.title}_${s}`}e.name=`${e.onStatisticExpression.title}_${o.toLocaleLowerCase()}`,e.alias=e.onStatisticExpression.title,e.onStatisticField=null,e.statisticType="number"===n?"sum":"mode",e.onStatisticExpression.returnType=n,this.replacePopupField(l),this.currentFieldInfo=this.getCurrentFieldInfo(),this.arcgisAggregationFieldChange.emit(),(0,s.f)(this.hostElement)}},(0,s.h)("calcite-segmented-control-item",{value:"number",checked:"number"===n},t.fields.number),(0,s.h)("calcite-segmented-control-item",{value:"string",checked:"string"===n},t.fields.string)))}renderTypeSelection(){const{layer:e,aggregateField:t,strings:i,isAutoGeneratedPieChartClusterField:a}=this,n=t.onStatisticField?v(e,t.onStatisticField):t.onStatisticExpression,o=t.onStatisticExpression?"string"===t.onStatisticExpression.returnType:"string"===(null==n?void 0:n.type),l=t.onStatisticExpression?["date","timestamp-offset"].includes(t.onStatisticExpression.returnType):["date","timestamp-offset"].includes(null==n?void 0:n.type);return(0,s.h)("div",{class:"section"},(0,s.h)("calcite-label",null,i.fields.statsType),(0,s.h)("calcite-select",{width:"full",scale:"m",label:i.fields.statsType,disabled:t.isAutoGenerated||a||!n,onCalciteSelectChange:e=>{const s=(null==e?void 0:e.target).selectedOption.value,a=t.name;t.name=t.onStatisticExpression?`${t.onStatisticExpression.title}_${s}`:`${n.name}_${s}`,t.onStatisticField&&(t.onStatisticField=n.name),t.alias=t.onStatisticExpression?t.onStatisticExpression.title:`${n.alias||n.name} ${p(s,i).toLowerCase()}`,t.statisticType=s,this.replacePopupField(a),this.arcgisAggregationFieldChange.emit()}},!o&&!l&&this.renderTypeOption("sum"),!o&&!l&&this.renderTypeOption("avg"),!o&&!l&&this.renderTypeOption("min"),!o&&!l&&this.renderTypeOption("max"),this.renderTypeOption("mode"),"count"===t.statisticType&&this.renderTypeOption("count")))}renderTypeOption(e){const{layer:t,aggregateField:i,strings:a}=this;return(0,s.h)("calcite-option",{value:e,label:p(e,a),disabled:i.statisticType!==e&&(i.onStatisticField&&F(t,i.onStatisticField,e)||i.onStatisticExpression&&C(t,i.name,i.statisticType,e)),selected:i.statisticType===e})}renderResultFieldName(){const{aggregateField:e,strings:t}=this;return(0,s.h)("div",{class:"section"},(0,s.h)("calcite-label",null,t.fields.resultFieldName),(0,s.h)("calcite-input",{type:"text",disabled:!0,value:e.name,scale:"m",label:t.fields.resultFieldName}))}renderFieldAlias(){const{layer:e,aggregateField:t,strings:i}=this,a=k(e,t.name),n=(t.isAutoGenerated?a.label:t.alias)||t.name;return(0,s.h)("div",{class:"section"},(0,s.h)("calcite-label",null,i.fields.fieldAlias),(0,s.h)("calcite-input",{type:"text",value:n,scale:"m",label:i.fields.fieldAlias,onCalciteInputInput:s=>{if(this.disconnected)return;clearTimeout(this.fieldAliasHandle);const a=s.target;let n=a.value;this.blockNode.heading=n,n?this.updateAlias(n):this.fieldAliasHandle=setTimeout((()=>{const s=k(e,t.name);if(!(t.isAutoGenerated?s.label:t.alias)){const s=v(e,t.onStatisticField);n=`${s.alias||s.name} ${p(t.statisticType,i).toLocaleLowerCase()}`,this.blockNode.heading=n,a.value=n}this.updateAlias(n)}),3e3)}}))}renderFormatting(){const{layer:e,aggregateField:t,modules:i,strings:a}=this,{FieldInfoFormat:n}=i,o=e.featureReduction.popupTemplate,l=v(e,t.onStatisticField);if(t.onStatisticExpression||!l&&"count"!==t.statisticType||"string"===(null==l?void 0:l.type))return null;let r=o.fieldInfos.find((e=>e.fieldName===t.name));r.format=r.format||new n({dijitSeparator:!0,places:0});const c=["date","timestamp-offset"].includes(null==l?void 0:l.type),g=!l||["integer","small-integer","big-integer"].indexOf(l.type)>-1,h=d.a.has(r.format.dateFormat)?d.a.get(r.format.dateFormat):d.a.get("short-date-short-time");return(0,s.h)("div",{class:"format"},(0,s.h)("calcite-label",{scale:"l"},a.fields.formatting),!g&&!c&&this.renderSignificantDigits(r.format),!c&&this.renderThousandSeparator(r.format),c&&this.renderDateFormat(h.dateFormat),c&&this.renderShowTime(h.timeFormat),c&&this.renderTimeFormat(h.timeFormat))}renderSignificantDigits(e){const{strings:t}=this;return(0,s.h)("section",null,(0,s.h)("calcite-label",null,t.fields.significantDigits,(0,s.h)("calcite-select",{label:t.fields.significantDigits,onCalciteSelectChange:t=>{const i=t.target;e.places=Number(i.selectedOption.value)||0,this.arcgisAggregationFieldChange.emit()}},(0,s.h)("calcite-option",{value:"0",selected:0===e.places},t.fields.decimalPlaces0),(0,s.h)("calcite-option",{value:"1",selected:1===e.places},t.fields.decimalPlaces1),[2,3,4,5,6,7,8].map((i=>(0,s.h)("calcite-option",{value:i.toString(),selected:e.places===i},t.fields.decimalPlacesN.replace("${num}",`${i}`)))))))}renderThousandSeparator(e){const{strings:t}=this;return(0,s.h)("section",null,(0,s.h)("calcite-label",{layout:"inline-space-between"},t.fields.show1000Separator,(0,s.h)("calcite-switch",{scale:"s",checked:e.digitSeparator,onCalciteSwitchChange:t=>{const i=null==t?void 0:t.target;e.digitSeparator=i.checked,this.arcgisAggregationFieldChange.emit()}})))}renderDateFormat(e){const{strings:t,modules:i,displayDate:a}=this;return(0,s.h)("calcite-label",null,t.fields.dateFormat,(0,s.h)("calcite-select",{ref:e=>this.dateFormatSelectNode=e,label:t.fields.dateFormat,onCalciteSelectChange:()=>this.changeDateFormat()},d.d.map((t=>(0,s.h)("calcite-option",{value:t,selected:e===t},i.intl.formatDate(a,i.intl.convertDateFormatToIntlOptions(t)))))))}renderShowTime(e){const{strings:t}=this;return(0,s.h)("div",{class:"single-line-label-switch-section",ref:e=>this.showTimeNode=e},(0,s.h)("calcite-label",{class:"single-line-label-switch-label"},t.fields.showTime),(0,s.h)("calcite-switch",{scale:"s",class:"single-line-label-switch-switch",ref:e=>this.showTimeSwitchNode=e,checked:(i=e,null!=i),onCalciteSwitchChange:()=>this.changeDateFormat()}));var i}renderTimeFormat(e){const{strings:t}=this;return(0,s.h)("calcite-label",{ref:e=>this.timeFormatNode=e},t.fields.timeFormat,(0,s.h)("calcite-select",{label:t.fields.timeFormat,ref:e=>this.timeFormatSelectNode=e,onCalciteSelectChange:()=>this.changeDateFormat()},d.t.map((t=>(0,s.h)("calcite-option",{value:t,selected:e===t},this.getTimeFormatString(t))))))}closePopovers(){this.arcgisFieldPickList&&(document.body.removeChild(this.arcgisFieldPickList),this.arcgisFieldPickList=null)}removeField(){var e;const{layer:t,aggregateField:i}=this,s=t.featureReduction,a=s.popupTemplate;let n=a.fieldInfos.findIndex((e=>e.fieldName===i.name));n>=0&&a.fieldInfos.splice(n,1),n=s.fields.findIndex((e=>e.name===i.name)),s.fields.splice(n,1),null===(e=a.content)||void 0===e||e.forEach(((e,t)=>{var s;"fields"===e.type&&e.fieldInfos&&(a.content[t].fieldInfos=null===(s=a.content[t].fieldInfos)||void 0===s?void 0:s.filter((e=>e.fieldName!==i.name)))})),this.arcgisAggregationFieldDelete.emit()}createPickListFields(){const{layer:e,aggregateField:t}=this,{fields:i}=e;return i.filter((e=>["small-integer","big-integer","integer","single","double","long","number","string","date","timestamp-offset"].indexOf(e.type)>-1)).filter((i=>t.onStatisticField===i.name||!function(e,t){return!S(v(e,t)).find((i=>!F(e,t,i)))}(e,i.name))).map((e=>({name:e.name,alias:e.alias,type:e.type})))}replacePopupField(e){var t;const{layer:i,aggregateField:s,modules:a}=this,{FieldInfo:n}=a,o=i.featureReduction,{popupTemplate:l}=o;l.fieldInfos=l.fieldInfos||[];const r=l.fieldInfos.findIndex((t=>t.fieldName===e)),c=s.onStatisticField?v(i,s.onStatisticField):s.onStatisticExpression;l.fieldInfos.splice(r,1,new n({fieldName:s.name,label:s.alias,isEditable:!1,visible:!0,format:s.onStatisticExpression?"number"===s.onStatisticExpression.returnType?{digitSeparator:!0}:void 0:"string"===c.type?void 0:["date","timestamp-offset"].includes(c.type)?{dateFormat:"short-date-short-time"}:["small-integer","big-integer","integer","long","number"].indexOf(c.type)>-1?{digitSeparator:!0}:{digitSeparator:!0,places:1}})),null===(t=l.content)||void 0===t||t.forEach(((t,i)=>{var s;"fields"===t.type&&t.fieldInfos&&(l.content[i].fieldInfos=null===(s=l.content[i].fieldInfos)||void 0===s?void 0:s.filter((t=>t.fieldName!==e)))}))}updateAlias(e){const{layer:t,aggregateField:i}=this,s=k(t,i.name);i.isAutoGenerated?s.label=e:i.alias=e,this.updatePopupAlias(),this.arcgisAggregationFieldChange.emit()}updatePopupAlias(){const{layer:e,aggregateField:t}=this,i=e.featureReduction,s=k(e,t.name),a=t.isAutoGenerated?s.label:t.alias;t.isAutoGenerated||(s.label=a),Array.isArray(i.popupTemplate.content)&&i.popupTemplate.content.length&&i.popupTemplate.content.forEach((e=>{if("fields"===e.type&&e.fieldInfos){const i=e.fieldInfos.find((e=>e.fieldName===t.name));i&&(i.label=a)}}))}async openArcadeEditor(){var e,t,i;const{strings:s}=this;if(!this.arcadeEditor){h(this.hostElement,"calcite-flow-item").disabled=!0,this.arcadeEditor=document.createElement("arcgis-modal-arcade"),this.arcadeEditor.arcadeScript=(null===(e=this.aggregateField.onStatisticExpression)||void 0===e?void 0:e.expression)||"",this.arcadeEditor.arcadeProfile=this.getArcadeProfile(),this.arcadeEditor.testData=await this.getArcadeTestData(),this.arcadeEditor.addExistingExpressions=!0,this.arcadeEditor.layer=this.layer,this.arcadeEditor.arcadeTitle=(null===(t=this.aggregateField.onStatisticExpression)||void 0===t?void 0:t.title)||s.fields.newExpression,this.arcadeEditor.arcadeTitleEditable=!0,this.arcadeEditor.returnPredictOutputType=!0,this.arcadeEditor.arcadeTitleEditingEnabled=!(null===(i=this.aggregateField.onStatisticExpression)||void 0===i?void 0:i.title),document.body.appendChild(this.arcadeEditor),this.arcadeEditor.addEventListener("arcgisModalArcadeClose",(e=>this.arcadeSetup(e.detail)))}}getArcadeProfile(){const{layer:e}=this;return{id:"labeling",definitions:{$feature:e}}}async getArcadeTestData(){const{layer:e,mapView:t}=this;try{return{profileVariableInstances:{$feature:(await(0,l.n)(e,t)).features[0]},spatialReference:this.mapView.spatialReference,timeZone:this.mapView.timeZone}}catch(e){console.log(e)}}arcadeSetup(e){var t,i;if(!e||"date"===e.predictOutputType)return void this.handleArcadeModalClose();const{layer:a,aggregateField:n,strings:o}=this;if(null==e?void 0:e.script){const l="number"===e.predictOutputType?o.fields.sum:o.fields.mode,r=n.name,c=`${e.title}_${l.toLocaleLowerCase()}`;if(a.featureReduction.fields.find((e=>e.name===c))&&r!==c){const t=a.featureReduction.fields.map((e=>e.name));let i=1;for(;t.includes(`${e.title}_${i}_${l.toLocaleLowerCase()}`);)i++;e.title=`${e.title}_${i}`}n.name=`${e.title}_${l.toLocaleLowerCase()}`,n.alias=e.title,n.onStatisticField=null,n.statisticType="number"===e.predictOutputType?"sum":"mode",n.onStatisticExpression?(n.onStatisticExpression.expression=e.script,n.onStatisticExpression.title=e.title,n.onStatisticExpression.returnType=null!==(t=e.predictOutputType)&&void 0!==t?t:"number"):n.onStatisticExpression={expression:e.script,title:e.title,returnType:null!==(i=e.predictOutputType)&&void 0!==i?i:"number"},this.replacePopupField(r),this.currentFieldInfo=this.getCurrentFieldInfo(),this.arcgisAggregationFieldChange.emit(),(0,s.f)(this.hostElement)}this.handleArcadeModalClose()}handleArcadeModalClose(){const{flowItemNode:e}=this;e.disabled=!1,document.body.removeChild(this.arcadeEditor),this.arcadeEditor=null,this.arcadeButtonNode.setFocus()}setupDateTimeDisplay(){const{currentFieldInfo:e}=this,t=d.a.get(e.format.dateFormat);t&&(""===t.timeFormat?(this.showTimeNode.style.display="flex",this.showTimeSwitchNode.checked=!1,this.timeFormatNode.style.display="none"):null===t.timeFormat?(this.showTimeNode.style.display="none",this.showTimeSwitchNode.checked=!1,this.timeFormatNode.style.display="none"):(this.showTimeNode.style.display="flex",this.showTimeSwitchNode.checked=!0,this.timeFormatNode.style.display="block"))}getTimeFormatString(e){const{strings:t}=this;return e===d.t[0]?t.fields.shortTime:e===d.t[1]?t.fields.longTime:e===d.t[2]?t.fields.shortTime24:e===d.t[3]?t.fields.longTime24:t.fields.shortTime24}changeDateFormat(){const{currentFieldInfo:e}=this,t=this.dateFormatSelectNode.selectedOption.value,i=this.timeFormatSelectNode.selectedOption.value,s=d.a.get(t);""===s.timeFormat?e.format.dateFormat=this.showTimeSwitchNode.checked?`${t}-${i}`:`${t}`:null===s.timeFormat&&(e.format.dateFormat=`${t}`),this.saveFieldInfo(),this.setupDateTimeDisplay()}saveFieldInfo(){var e;const{layer:t,aggregateField:i,currentFieldInfo:s,arcadeExpMap:a}=this,n=null===(e=t.featureReduction)||void 0===e?void 0:e.popupTemplate;if(this.arcadeExpMap.has(s.fieldName)&&(null==n?void 0:n.expressionInfos)&&n.expressionInfos.find(((e,t)=>{if(`${r.f.expression}${e.name}`===s.fieldName)return n.expressionInfos[t]=a.get(s.fieldName).clone()})),null==n?void 0:n.fieldInfos){const e=n.fieldInfos.findIndex((e=>e.fieldName===this.aggregateField.name));n.fieldInfos[e]=s.clone()}Array.isArray(null==n?void 0:n.content)&&n.content.forEach((e=>{"fields"===e.type&&e.fieldInfos&&e.fieldInfos.forEach(((t,a)=>{if(t.fieldName===i.name){const t=s.clone();t.visible=!0,e.fieldInfos[a]=t}}))})),this.arcgisAggregationFieldChange.emit()}getCurrentFieldInfo(){var e;const{layer:t,aggregateField:i}=this;return null===(e=t.featureReduction.popupTemplate.fieldInfos)||void 0===e?void 0:e.find((e=>e.fieldName===i.name))}get hostElement(){return(0,s.d)(this)}};A.style=".section.sc-arcgis-aggregation-field{padding-top:15px}.format.sc-arcgis-aggregation-field{padding-top:20px}.field-selection.sc-arcgis-aggregation-field{display:flex;width:100%;justify-content:space-between;align-items:stretch;min-width:0}.non-simple-field-button.sc-arcgis-aggregation-field{width:calc(100% - 32px)}.single-line-label-switch-section.sc-arcgis-aggregation-field{display:flex;margin:0;padding:var(--arcgis-app-cap-spacing-half) 0}.single-line-label-switch-label.sc-arcgis-aggregation-field{display:flex;flex-flow:column nowrap;flex:1 0 0%;overflow:hidden}.single-line-label-switch-switch.sc-arcgis-aggregation-field{flex:0 0 0%;justify-self:flex-end;margin:0}.single-line-label-switch-switch.sc-arcgis-aggregation-field input.sc-arcgis-aggregation-field{display:none}";const N=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationFieldsChange=(0,s.c)(this,"arcgisAggregationFieldsChange",7),this.arcgisAggregationFieldsClose=(0,s.c)(this,"arcgisAggregationFieldsClose",7),this.arcgisAggregationFieldsBackClick=(0,s.c)(this,"arcgisAggregationFieldsBackClick",7),this.allFieldsAdded=!1,this.mapView=void 0,this.layer=void 0,this.flowNode=void 0,this.strings=void 0,this.currentLanguage=void 0,this.hideLayerTitle=!1,this.autoGeneratedPieChartClusterFields=void 0}async done(){this.closePopovers()}async setFocus(){this.flowItemNode.setFocus()}async componentWillLoad(){const[e,t]=await(0,o.l)(["esri/layers/support/AggregateField","esri/popup/FieldInfo"]);this.modules={AggregateField:e,FieldInfo:t}}componentDidLoad(){requestAnimationFrame((()=>this.flowItemNode.setFocus()))}disconnectedCallback(){this.closePopovers()}render(){const{layer:e,strings:t,hideLayerTitle:i}=this,a=e.featureReduction.fields;return h(this.hostElement,"calcite-flow").customItemSelectors="arcgis-aggregation-fields",(0,s.h)(s.H,{key:"d47456d2e586cae26739de5fef8220b27dc9b354",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"1b1aa6a2b68d287be41a6f979ae10958b5f80a09",heading:"binning"===e.featureReduction.type?t.bin.binAttributesHeading:t.cluster.clusterAttributesHeading,description:i?void 0:e.title,onCalciteFlowItemBack:()=>{this.arcgisAggregationFieldsBackClick.emit(),this.closePopovers()},ref:e=>this.flowItemNode=e},this.renderTip(a),(0,s.h)("div",{key:"2dae6f86149d8c7355f035b17d209e476643eef1",class:"fields"},null==a?void 0:a.map(((e,t)=>this.renderStatsField(e,t)))),this.renderAddField()))}renderTip(e){const{strings:t}=this;return(null==e?void 0:e.length)?null:(0,s.h)("calcite-tip",{heading:t.fields.msgTitle,closeDisabled:!0},t.fields.msg)}renderStatsField(e,t){const{layer:i,mapView:a,selectedFieldName:n,modules:o,strings:l,autoGeneratedPieChartClusterFields:r}=this;w(e,i,o);const c=null==r?void 0:r.includes(e.name);return(0,s.h)("arcgis-aggregation-field",{layer:i,mapView:a,strings:l,aggregateField:e,isAutoGeneratedPieChartClusterField:c,open:n===e.name,onArcgisAggregationFieldChange:()=>{this.selectedFieldName=e.name,i.featureReduction.fields[t]=e,this.arcgisAggregationFieldsChange.emit(),(0,s.f)(this.hostElement)},onArcgisAggregationFieldDelete:()=>{this.selectedFieldName=void 0,this.arcgisAggregationFieldsChange.emit(),(0,s.f)(this.hostElement),setTimeout((()=>this.fabNode.setFocus()),300)}})}renderAddField(){const{allFieldsAdded:e,strings:t}=this;return e?null:(0,s.h)("calcite-fab",{slot:"fab",appearance:"outline-fill",kind:"neutral",scale:"s",icon:"plus",textEnabled:!0,text:t.fields.addField,onClick:()=>this.addStatsField(),ref:e=>this.fabNode=e})}closePopovers(){this.attributeFormatter&&(document.body.removeChild(this.attributeFormatter),this.attributeFormatter=null)}addStatsField(){const{layer:e,strings:t,modules:i}=this,{AggregateField:a}=i,n=function(e){return e.fields.filter((e=>["small-integer","big-integer","integer","single","double","long","number","string"].indexOf(e.type)>-1))}(e);let o=0,l=S(n[o]),r=0,c=F(e,n[o].name,l[r]);for(;o<n.length&&c;){for(;r<l.length&&c;)r++,r<l.length&&(c=F(e,n[o].name,l[r]));c&&(o++,o<n.length&&(l=S(n[o]),r=0,c=F(e,n[o].name,l[r])))}if(c)this.allFieldsAdded=!0;else{const s=n[o],c=l[r],d=new a({name:`${s.name}_${c}`,onStatisticField:s.name,alias:`${s.alias||s.name} ${p(c,t).toLocaleLowerCase()}`,statisticType:c,visible:!0}),g=e.featureReduction;g.fields=g.fields||[],g.fields.push(d),w(d,e,i),this.selectedFieldName=d.name}(0,s.f)(this.hostElement)}get hostElement(){return(0,s.d)(this)}};N.style=".fields.sc-arcgis-aggregation-fields{background-color:white}.field-icon.sc-arcgis-aggregation-fields{padding:0 var(--arcgis-app-cap-spacing);display:flex;align-items:center}";const I=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationInfoPopoverClose=(0,s.c)(this,"arcgisAggregationInfoPopoverClose",7),this.arcgisAggregationInfoPopoverDisconnected=(0,s.c)(this,"arcgisAggregationInfoPopoverDisconnected",7),this.documentTabHandler=void 0,this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.onOpen=()=>{setTimeout((()=>requestAnimationFrame((()=>{var e;return null===(e=this.panelNode)||void 0===e?void 0:e.setFocus()}))),1)},this.props=void 0,this.referenceElement=void 0,this.open=!1}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async setFocus(){var e;null===(e=this.panelNode)||void 0===e||e.setFocus()}disconnectedCallback(){this.arcgisAggregationInfoPopoverDisconnected.emit()}render(){const{props:e,referenceElement:t}=this,{config:i,title:a,moreInfo:n,helpId:o,strings:l}=e,{helpBase:r,helpMap:c}=i,d=l.tile.info.title.replace("${title}",a);return(0,s.h)(s.H,{key:"7ad16bce9ce5951be00e1306aec99774d1e3087e",class:"js-app-flyout arcgis-aggregation-popover"},(0,s.h)("calcite-popover",{key:"ec79857a16d9d0ab2c5da479526f7adeac43c387",open:!0,placement:"auto",offsetSkidding:5,label:"",referenceElement:t,class:"info-popover",onCalcitePopoverOpen:this.onOpen,ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{key:"5f3b6891ba5c3687bb36607c9c619fc786b45a51",heading:d,closable:!0,ref:e=>this.panelNode=e,onCalcitePanelClose:()=>{this.arcgisAggregationInfoPopoverClose.emit(),setTimeout((()=>t.parentElement.focus()),300)}},(0,s.h)("div",{key:"a73b7e35eac938e0a863063e8c6e0b1fa691f19a",class:"info"},(0,s.h)("div",{key:"29493f8be56f6b4c7e53b0233cf89b1dc60fcbe8"},n),o&&c?(0,s.h)("div",{class:"info-help"},(0,s.h)("calcite-button",{appearance:"solid",label:l.tile.info.learnMore,class:"info-help-button",slot:"footer",onClick:()=>{window.open(`${r}${c[o]}`,"_blank")}},l.tile.info.learnMore)):null))))}get hostElement(){return(0,s.d)(this)}};I.style=".info{padding:10px;background-color:white}.info-popover{max-width:320px}.info-help{padding-top:10px;justify-content:flex-end;display:flex}.info-help-button{display:flex;flex-flow:row-reverse}";const L=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationSymbolStylerChange=(0,s.c)(this,"arcgisAggregationSymbolStylerChange",7),this.arcgisAggregationSymbolStylerPopoverClose=(0,s.c)(this,"arcgisAggregationSymbolStylerPopoverClose",7),this.arcgisAggregationSymbolStylerPopoverDisconnected=(0,s.c)(this,"arcgisAggregationSymbolStylerPopoverDisconnected",7),this.documentTabHandler=void 0,this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.props=void 0,this.referenceElement=void 0}async reposition(){var e;null===(e=this.popoverNode)||void 0===e||e.reposition()}async setFocus(){var e;null===(e=this.closeActionNode)||void 0===e||e.setFocus()}async setOpen(e){this.popoverNode&&(this.popoverNode.open=e,e&&setTimeout((()=>this.closeActionNode.setFocus()),100))}async componentWillLoad(){const[e,t,i,s,a]=await(0,o.l)(["esri/symbols/support/symbolUtils","esri/symbols/support/cimSymbolUtils","esri/Color","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"]);this.modules={symbolUtils:e,cimSymbolUtils:t,Color:i,SimpleMarkerSymbol:s,SimpleLineSymbol:a}}disconnectedCallback(){this.arcgisAggregationSymbolStylerPopoverDisconnected.emit()}render(){const{props:e,referenceElement:t}=this,{strings:i}=e;return(0,s.h)(s.H,{key:"4514bbee847faa636a19945bbcb0eb6172bd46ca",class:"js-app-flyout arcgis-aggregation-popover"},(0,s.h)("calcite-popover",{key:"c76f4ac4aa8a4a61b4c81f6dabc8abe0df15d0d3",placement:"leading-start",offsetDistance:0,offsetSkidding:45,pointerDisabled:!0,label:i.symbolStyle,referenceElement:t,triggerDisabled:!0,class:"popover",open:!1,ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{key:"c05e492e592f004853a82b50bd5f90b9b2c7ff8d",heading:i.symbolStyle,closable:!1},(0,s.h)("div",{key:"4d66d651481d6d19839e3b8673eba7f62b41ba1d",slot:"header-content"},i.symbolStyle),(0,s.h)("calcite-action",{key:"50a0357d8e63de55dc8647ab76a9f61660c2d9e9",slot:"header-actions-end",scale:"s",icon:"x",text:"",onClick:()=>this.arcgisAggregationSymbolStylerPopoverClose.emit(),ref:e=>this.closeActionNode=e}),(0,s.h)("div",{key:"9eb9496e4bc113ee250bab14f9a96ee19da8a2a0",class:"symbol-styler-div",ref:e=>this.buildSymbolStyler(e)}))))}async buildSymbolStyler(e){const{props:t,modules:i}=this,{layer:s,portal:n}=t,{Color:o}=i;let l=s.featureReduction.symbol;["simple-fill","simple-marker","simple-line","picture-marker","cim"].indexOf(l.type)>-1||(l=m(i));const r="picture-marker"!==l.type&&!!l.color,c=function(e){var t;return"picture-marker"!==e.type&&"cim"!==e.type&&!!(null===(t=e.outline)||void 0===t?void 0:t.color)}(l),d="cim"===l.type&&"CIMPointSymbol"===l.data.symbol.type,g="rtl"===(0,a.g)(this.hostElement);let h;if("simple-marker"===l.type){const e=l;h=e.outline?{color:e.outline.color?e.outline.color:new o([0,0,0,.5]),size:e.outline.width}:{color:new o([0,0,0,.5]),size:1}}else h="cim"===l.type?void 0:{color:new o([255,255,255,.5]),size:1};const p=document.createElement("arcgis-symbol-styler");p.popoverProps={placement:"bottom-end",offsetDistance:10,offsetSkidding:g?3:-3,pointerDisabled:"true",popoverWidth:315,refElement:this.closeActionNode};const u=p.edit(l.clone(),{portal:n,symbolFilter:void 0,sections:{marker:d||["simple-marker","picture-marker"].indexOf(l.type)>-1?{open:!0,symbolsOpen:!0,sizeOpen:!0,parts:{size:!1},markerType:"all"}:void 0,fill:{type:"color",optional:!0,open:!0,suggestedColorsOpen:!0,transparencyOpen:f(l,i)},stroke:{type:"color",optional:!0,extraParts:{style:-1===["simple-marker","picture-marker","cim"].indexOf(l.type),width:!0}}},fill:{color:b(l,i)||(v=new o("#ff8200"),F=.85,v.a=F,v)},marker:{size:y(l,i)},stroke:h,fillEnabled:r,strokeEnabled:c});var v,F;p.addEventListener("arcgisSymbolStylerEdit",(e=>this.onChangeSymbol(e))),e.appendChild(p),await u}onChangeSymbol({detail:{symbol:e}}){const{props:t}=this,{layer:i}=t;i.featureReduction.symbol=e,this.arcgisAggregationSymbolStylerChange.emit()}get hostElement(){return(0,s.d)(this)}};L.style=".popover{z-index:100}.symbol-styler-div{width:328px;height:100%;overflow-y:auto;overflow-x:hidden}arcgis-symbol-styler{max-height:calc(90vh - 100px);}";const R=class{constructor(e){(0,s.r)(this,e),this.arcgisAggregationTileSelect=(0,s.c)(this,"arcgisAggregationTileSelect",7),this.arcgisAggregationTileOptions=(0,s.c)(this,"arcgisAggregationTileOptions",7),this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.keyupEventHandler=e=>{const{selected:t}=this;" "!==e.key&&"Enter"!==e.key||(e.stopPropagation(),this.removeInfoPopover(),t?this.arcgisAggregationTileOptions.emit():this.arcgisAggregationTileSelect.emit(),e.preventDefault())},this.keydownEventHandler=e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())},this.clickEventHandler=e=>{var t;const{selected:i}=this;"CALCITE-CHECKBOX"!==(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.nodeName)&&(e.stopPropagation(),this.removeInfoPopover(),i?this.arcgisAggregationTileOptions.emit():this.arcgisAggregationTileSelect.emit(),e.preventDefault())},this.checkboxChangeHandler=e=>{const{selected:t}=this;e.preventDefault();const i=e.target;i.checked?(this.removeInfoPopover(),t?this.arcgisAggregationTileOptions.emit():this.arcgisAggregationTileSelect.emit()):i.checked=!0},this.props=void 0,this.selected=void 0}async setFocus(){var e;null===(e=this.tileNode)||void 0===e||e.focus()}disconnectedCallback(){this.removeInfoPopover()}render(){const{props:e,selected:t}=this,{title:i,imagePath:n,strings:o}=e,l={tile:!0,"tile-selected":t},r={"tile-image":!0,"tile-image-selected":t},c={"tile-check":!0,rtl:"rtl"===(0,a.g)(this.hostElement)};return(0,s.h)(s.H,{key:"a82ea78390388f390aa9c865f205d87f0147ad29"},(0,s.h)("div",{key:"a11d9c8ca21c3c337a07c9a84ee2c3b6164adc39",class:l,role:"button",tabindex:"0","aria-label":`${i} ${o.tile.options}`,"aria-selected":t,ref:e=>{this.tileNode=e,this.addTileListeners(e)}},(0,s.h)("div",{key:"1099e71d25f16655d0b208369ef6f01774169ca2",class:r,style:{backgroundImage:`url(${n})`},"aria-hidden":"true"}),(0,s.h)("div",{key:"1ef84dbbbc29071219f43cb66782b4ff1361353a",class:c,"aria-label":"","aria-hidden":"true"},(0,s.h)("calcite-checkbox",{key:"156880abfe10a520cdf17429c717584bb7eccd98",name:"style-tile-check-name",checked:t,tabindex:"-1",ref:e=>this.addCheckboxListener(e)})),this.renderTileLink()))}renderTileLink(){const{props:e,selected:t}=this,{strings:i}=e,n={"style-link-text":!0,rtl:"rtl"===(0,a.g)(this.hostElement)};return(0,s.h)("div",{class:"style-link","aria-label":e.title},(0,s.h)("div",{class:"style-link-title"},(0,s.h)("div",{class:n,"aria-hidden":"true"},e.title),(0,s.h)("calcite-action",{class:"style-link-info",scale:"s",icon:"information",compact:!0,onClick:e=>this.handleInfoClick(e),text:i.tile.moreInfo,ref:e=>{this.infoIconNode=e,e.addEventListener("keyup",(e=>{e.stopPropagation(),(" "===e.key||!this.infoPopoverNode&&"Enter"===e.key)&&this.handleInfoClick(e)})),e.addEventListener("keydown",(e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())}))}})),t&&this.renderStyleOptions())}renderStyleOptions(){const{props:e}=this,{strings:t}=e;return(0,s.h)("calcite-button",{appearance:"outline-fill",width:"full",scale:"s",label:t.tile.options},t.tile.options)}handleInfoClick(e){e.stopPropagation();const{props:t}=this,{config:i,title:s,moreInfo:a,helpId:n,flowItemNode:o,strings:l}=t;this.removeInfoPopover(),this.infoPopoverNode=document.createElement("arcgis-aggregation-info-popover"),this.infoPopoverNode.props={title:s,moreInfo:a,helpId:n,config:i,flowItemNode:o,strings:l},this.infoPopoverNode.referenceElement=this.infoIconNode,this.infoPopoverNode.addEventListener("arcgisAggregationInfoPopoverClose",(e=>{e.stopPropagation(),this.removeInfoPopover(),setTimeout((()=>this.infoIconNode.setFocus()),200)})),this.infoPopoverNode.addEventListener("arcgisAggregationInfoPopoverDisconnected",(e=>{e.stopPropagation(),this.removeInfoPopover()})),document.body.appendChild(this.infoPopoverNode),setTimeout((()=>this.infoPopoverNode.setFocus()),100),setTimeout((()=>{this.documentClickHandler=e=>{this.isInsideInfoPopoverNode(e.target)||(this.removeInfoPopover(),setTimeout((()=>this.infoIconNode.setFocus()),200))},document.addEventListener("click",this.documentClickHandler),this.panelScrollHandler=()=>{this.removeInfoPopover()},null==o||o.addEventListener("calciteFlowItemScroll",this.panelScrollHandler)}),100)}removeInfoPopover(){const{props:e}=this,{flowItemNode:t}=e;document.body.querySelectorAll(".arcgis-aggregation-popover").forEach((e=>document.body.removeChild(e))),this.infoPopoverNode=null,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0),this.panelScrollHandler&&(null==t||t.removeEventListener("calciteFlowItemScroll",this.panelScrollHandler),this.panelScrollHandler=void 0)}isInsideInfoPopoverNode(e){if("ARCGIS-AGGREGATION-INFO-POPOVER"===(null==e?void 0:e.tagName))return!0;{let t=null==e?void 0:e.parentElement;for(;t;){if("ARCGIS-AGGREGATION-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}addTileListeners(e){e.addEventListener("keyup",this.keyupEventHandler),e.addEventListener("keydown",this.keydownEventHandler),e.addEventListener("click",this.clickEventHandler)}addCheckboxListener(e){e.addEventListener("calciteCheckboxChange",this.checkboxChangeHandler)}get hostElement(){return(0,s.d)(this)}};R.style=".tile{background-color:white;position:relative;margin:6px;cursor:pointer;box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 1px #e0e0e0;transition:box-shadow 125ms ease-in-out}.tile:hover{z-index:5;box-shadow:0 1px 0 2px rgba(0, 0, 0, 0.05), 0 0 0 1px #e0e0e0}.tile:focus{outline:2px solid var(--calcite-color-brand)}.tile-selected{box-shadow:0 1px 10px 2px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--calcite-color-brand)}.tile-selected:hover{z-index:5;box-shadow:0 1px 0 2px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--calcite-color-brand)}.tile-check{position:absolute;top:10px;right:10px}.tile-check.rtl{right:auto;left:10px;overflow-x:hidden}.style-link{padding:9px 9px}.style-link-icon{margin-top:-1px}.style-link-text{margin-right:10px}.style-link-text.rtl{margin-right:0;margin-left:10px}.style-link-title{display:flex;font-weight:bold;padding-bottom:5px}.style-link-options{color:#0079c1;display:flex;flex-direction:row nowrap}.style-link-options svg{fill:#0079c1}.tile-image{height:100px;width:100%;background-size:cover;display:flex;align-items:center;justify-content:center}.tile-image-selected{height:68px;background-size:auto 100px}.style-sub-text{font-size:80%;padding:0 0 6px 0}.style-link-info{height:18px}"},28939:(e,t,i)=>{i.d(t,{a:()=>n,d:()=>s,t:()=>a});const s=["short-date","long-month-day-year","day-short-month-year","long-date","long-month-year","short-month-year","year"],a=["short-time","long-time","short-time-24","long-time-24"],n=new Map;n.set("short-date",{dateFormat:s[0],timeFormat:""}),n.set("short-date-short-time",{dateFormat:s[0],timeFormat:a[0]}),n.set("short-date-long-time",{dateFormat:s[0],timeFormat:a[1]}),n.set("short-date-short-time-24",{dateFormat:s[0],timeFormat:a[2]}),n.set("short-date-long-time-24",{dateFormat:s[0],timeFormat:a[3]}),n.set("long-month-day-year",{dateFormat:s[1],timeFormat:""}),n.set("long-month-day-year-short-time",{dateFormat:s[1],timeFormat:a[0]}),n.set("long-month-day-year-long-time",{dateFormat:s[1],timeFormat:a[1]}),n.set("long-month-day-year-short-time-24",{dateFormat:s[1],timeFormat:a[2]}),n.set("long-month-day-year-long-time-24",{dateFormat:s[1],timeFormat:a[3]}),n.set("day-short-month-year",{dateFormat:s[2],timeFormat:""}),n.set("day-short-month-year-short-time",{dateFormat:s[2],timeFormat:a[0]}),n.set("day-short-month-year-long-time",{dateFormat:s[2],timeFormat:a[1]}),n.set("day-short-month-year-short-time-24",{dateFormat:s[2],timeFormat:a[2]}),n.set("day-short-month-year-long-time-24",{dateFormat:s[2],timeFormat:a[3]}),n.set("long-date",{dateFormat:s[3],timeFormat:""}),n.set("long-date-short-time",{dateFormat:s[3],timeFormat:a[0]}),n.set("long-date-long-time",{dateFormat:s[3],timeFormat:a[1]}),n.set("long-date-short-time-24",{dateFormat:s[3],timeFormat:a[2]}),n.set("long-date-long-time-24",{dateFormat:s[3],timeFormat:a[3]}),n.set("long-month-year",{dateFormat:s[4],timeFormat:null}),n.set("short-month-year",{dateFormat:s[5],timeFormat:null}),n.set("year",{dateFormat:s[6],timeFormat:null}),n.set("default",{dateFormat:s[0],timeFormat:a[2]})},11246:(e,t,i)=>{i.d(t,{a:()=>c,b:()=>h,c:()=>a,d:()=>s,e:()=>n,f:()=>d,g:()=>p,i:()=>o,m:()=>l,t:()=>r,u:()=>g});const s=(e,t)=>{let i,s="idle";const a=(...a)=>new Promise((n=>{switch(s){case"flushed":s="idle",i?(clearTimeout(i),n(e(...a))):n(null);break;case"invoked":clearTimeout(i),s="idle",n(e(...a));break;case"cancelled":clearTimeout(i),s="idle",n(null);break;default:i&&clearTimeout(i),s="pending",i=setTimeout((()=>(s="idle",n(e(...a)))),t)}}));return a.flush=function(...e){return s="flushed",a(...e)},a.invoke=function(...e){return s="invoked",a(...e)},a.cancel=function(...e){return s="cancelled",a(...e)},a.getStatus=function(){return s},a},a=(e,t)=>{let i;return(...s)=>new Promise((a=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,a(e(...s))}),t))}))};function n(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(e){return null!=e}async function l(e,t){return await Promise.all([e,r(t)]),e}function r(e){return new Promise((t=>setTimeout(t,e)))}const c=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:s}=t(e);return[i,s]}))),d=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function g(e,t){const i=[],s={};return e.forEach((e=>{const a=t(e);null==s[a]&&(s[a]=e,i.push(e))})),i}function h(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let s=typeof e;return s in t?!t[s].hasOwnProperty(e)&&(t[s][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const p=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,s)=>e.slice(t*s,t+t*s)))}}]);