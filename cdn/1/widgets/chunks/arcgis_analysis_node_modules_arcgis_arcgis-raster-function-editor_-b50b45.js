"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-b50b45"],{60567:(e,t,a)=>{a.d(t,{N:()=>o,R:()=>i});const i={CORE:"CORE",STANDARD:"STANDARD"},o={INTEGER:"integer",FLOAT:"float"}},81790:(e,t,a)=>{a.d(t,{R:()=>i});const i={header:"header",content:"content"}},17242:(e,t,a)=>{a.d(t,{E:()=>i});const i={newTemplate:"new-template",openTemplate:"open-template",addFunction:"add-function",addConstant:"add-constant",addRaster:"add-raster",deleteSelected:"delete-selected"}},2229:(e,t,a)=>{a.r(t),a.d(t,{rfx_editor_app:()=>L});var i=a(17002),o=a(33752),s=a(17242),n=a(1409),r=a(27793),l=a(14385),d=a(15517),c=(a(23795),a(17902),a(56451),a(68852),a(62559)),h=a(59799),m=(a(588),a(71802),a(44345),a(38146)),p=a(98379),u=a(16925),v=a(86889),f=a(75311),C=a(60567),g=a(81790);function y(e,t){return(0,l.o)(t)?e:{...e,thumbnailEx:t.thumbnail,name:t.name,description:t.description,functionType:t.functionType,definition:t.definitionQuery,properties:t.properties}}function x(e){if((0,l.o)(e))return void console.warn("RFT Handler get RFT Blob: No model provided.");let t=JSON.stringify(e,null,2);t=t.replaceAll(/\??token=[^&"]+?\"/g,'"');return new Blob([t],{type:"text/json"})}const S="host",E="content",w="overlay-element",T="overlay-panel",b="list-wrapper",R="arcgis--rtl",F="action-bar",L=class{constructor(e){(0,i.r)(this,e),this.analysisRFTLaunch=(0,i.c)(this,"analysisRFTLaunch",7),this.analysisTemplateSaved=(0,i.c)(this,"analysisTemplateSaved",7),this.analysisTemplateNameChanged=(0,i.c)(this,"analysisTemplateNameChanged",7),this.analysisRFTEditorClose=(0,i.c)(this,"analysisRFTEditorClose",7),this.analysisRFTFailedToLoad=(0,i.c)(this,"analysisRFTFailedToLoad",7),this.analysisRFTLoaded=(0,i.c)(this,"analysisRFTLoaded",7),this.rfxCoreServices={diagramZoomInCommand:void 0,diagramZoomOutCommand:void 0,diagramAutoLayoutCommand:void 0,diagramStretchCommand:void 0,diagramPanCommand:void 0,diagramSelectCommand:void 0,addRFxFunctionCommand:void 0,addRasterNodeCommand:void 0,addScalarNodeCommand:void 0,addRFTPortalItemCommand:void 0,getModelCommand:void 0,refreshDiagramViewCommand:void 0,deleteSelectedItemsCommand:void 0,getModelDisplayDataCommand:void 0},this.headerElement=null,this.overlayElementsConfig={leftToolBar:{slot:"left",visible:!0,builder:()=>(({handleDiagramZoomIn:e,handleDiagramZoomOut:t,handleDiagramAutoLayout:a,handleDiagramStretch:o,handleDiagramSelect:s,handleDiagramPan:n,handleDiagramDeleteSelected:r,slot:l})=>(0,i.h)("div",{slot:l},(0,i.h)("rfx-diagram-interaction-toolbar",{handleDiagramZoomIn:e,handleDiagramZoomOut:t,handleDiagramAutoLayout:a,handleDiagramStretch:o,handleDiagramSelect:s,handleDiagramPan:n,handleDiagramDeleteSelected:r})))({handleDiagramZoomIn:this.handleDiagramZoomIn,handleDiagramZoomOut:this.handleDiagramZoomOut,handleDiagramAutoLayout:this.handleDiagramAutoLayout,handleDiagramStretch:this.handleDiagramStretch,handleDiagramSelect:this.handleDiagramSelect,handleDiagramPan:this.handleDiagramPan,handleDiagramDeleteSelected:this.handleDiagramDeleteSelected,slot:"left"}),type:"static"},rightToolBar:{slot:"right",visible:!0,builder:()=>(({handleRFTLaunch:e,handleRFTSave:t,handleRFTSaveAs:a,handleOpenTemplateEditor:o,handleRFTShare:s,slot:n})=>(0,i.h)("div",{slot:n},(0,i.h)("rfx-rft-interaction-toolbar",{handleRFTLaunch:e,handleRFTSave:t,handleRFTSaveAs:a,handleOpenTemplateEditor:o,handleRFTShare:s})))({handleRFTLaunch:this.handleRFTLaunch,handleRFTSave:this.handleRFTSave,handleRFTSaveAs:this.handleRFTSaveAs,handleOpenTemplateEditor:this.handleOpenTemplateEditor,handleRFTShare:this.handleRFTShare,slot:"right"}),type:"static"},rfxListView:{slot:"left",visible:!1,builder:({addRasterFunctionTitle:e})=>(({slot:e,handleTriggerSelectFunction:t,handlePanelClose:a,heading:o})=>(0,i.h)("div",{slot:e,class:b},(0,i.h)("rfx-panel",{heading:o,closable:!0,showFooter:!1,closed:!1,class:{[w]:!0,[T]:!0},onCalcitePanelClose:a},(0,i.h)("rfx-list-view",{mode:C.R.CORE,onTriggerSelectFunction:t}))))({slot:"left",heading:e,handleTriggerSelectFunction:this.handleRFxListViewTriggerSelectFunction,handlePanelClose:this.handleRFxListViewPanelClose}),type:"static"}},this.showUnsavedChangesDialog=()=>void 0!==this.closeWithoutSavingModalElement?Promise.resolve(!1):new Promise((e=>{const t=document.createElement("rfx-close-without-saving-modal");t.rftTitle=v.s.rftProperties?.name||this.strings.newTemplate,t.handleCancel=()=>{t.remove(),this.closeWithoutSavingModalElement=void 0,e(!1)},t.handleDontSave=()=>{t.remove(),this.closeWithoutSavingModalElement=void 0,this.clearState(),e(!0)},t.handleSave=async()=>{t.remove(),this.closeWithoutSavingModalElement=void 0,e(await this.handleRFTSaveAs())},this.closeWithoutSavingModalElement=t,document.body.appendChild(t)})),this.showCloseWithoutSavingModal=(e,t)=>{const a=document.createElement("rfx-close-without-saving-modal");a.rftTitle=v.s.rftProperties?.name||this.strings.newTemplate,a.handleCancel=()=>{a.remove(),this.closeWithoutSavingModalElement=void 0},a.handleDontSave=e??this.handleDontSaveClick,a.handleSave=t??this.handleRFTSaveOnClose,this.closeWithoutSavingModalElement=a,document.body.appendChild(a)},this.handleRFTSaveOnClose=()=>{this.handleRFTSaveAs(),this.closeWithoutSavingModalElement.remove(),this.closeWithoutSavingModalElement=void 0},this.initializeRFxEditorCore=e=>{const t=e;var a;this.rfxEditorCoreElement=e,this.rfxCoreServices.diagramZoomInCommand=(a=t,{execute:async()=>{await a.zoomIn()}}),this.rfxCoreServices.diagramZoomOutCommand=(e=>({execute:async()=>{await e.zoomOut()}}))(t),this.rfxCoreServices.diagramAutoLayoutCommand=(e=>({execute:async()=>{await e.autoLayout()}}))(t),this.rfxCoreServices.diagramStretchCommand=(e=>({execute:async()=>{await e.stretch()}}))(t),this.rfxCoreServices.diagramPanCommand=(e=>({execute:async()=>{await e.pan()}}))(t),this.rfxCoreServices.diagramSelectCommand=(e=>({execute:async()=>{await e.select()}}))(t),this.rfxCoreServices.addRFxFunctionCommand=(e=>({execute:async t=>{await e.addRFxFunction(t)}}))(t),this.rfxCoreServices.addRasterNodeCommand=(e=>({execute:async t=>{const{value:a}=t||{};await e.addRasterNode({value:a})}}))(t),this.rfxCoreServices.addScalarNodeCommand=(e=>({execute:async t=>{const{value:a}=t||{};await e.addScalarNode({value:a})}}))(t),this.rfxCoreServices.addRFTPortalItemCommand=(e=>({execute:async t=>await e.addRFTPortalItem(t)}))(t),this.rfxCoreServices.getModelCommand=(e=>({execute:async()=>await e.getModel()}))(t),this.rfxCoreServices.refreshDiagramViewCommand=(e=>({execute:async()=>{await e.refreshDiagramView()}}))(t),this.rfxCoreServices.deleteSelectedItemsCommand=(e=>({execute:async()=>{await e.deleteSelected()}}))(t),this.rfxCoreServices.getModelDisplayDataCommand=(e=>({execute:async()=>{const{displayData:t}=await e.getModelDisplayData()||{};return t}}))(t)},this.handleNewTemplateClick=()=>{if(!0===v.s.hasUnsavedChanges){const e=()=>{this.closeWithoutSavingModalElement?.remove(),this.closeWithoutSavingModalElement=void 0,this.clearState()};this.showCloseWithoutSavingModal(e)}else this.clearState()},this.handleOpenTemplateClick=()=>{const{portal:e}=this;this.itemBrowserElement=(0,p.b)({modalStrings:{header:this.strings.browseRFT},portal:e,user:e.user,filter:'(type: "Raster function template")',onClose:this.closeItemBrowser,onSelection:this.handleItemBrowserSelection}),document.body.appendChild(this.itemBrowserElement)},this.handleItemBrowserSelection=async e=>{if(null!==e.detail){const t=e.detail.id;await this.loadRFT(t)}},this.loadRFT=async e=>{try{const t=await this.rfxCoreServices.addRFTPortalItemCommand.execute(e);null==v.s.rftJSON&&!1===v.s.hasUnsavedChanges?(v.s.rftJSON=t.toJSON(),v.s.rftProperties=function(e){if((0,l.o)(e))return;const{name:t,description:a,thumbnailEx:i,functionType:o,definition:s,properties:n}=e;return{name:t,description:a,thumbnail:i,functionType:o,definitionQuery:s,properties:n}}(v.s.rftJSON),v.s.portalItem=new o.default({id:e}),this.analysisTemplateNameChanged.emit(v.s.rftProperties.name)):v.s.hasUnsavedChanges=!0,this.analysisRFTLoaded.emit()}catch(t){console.error("Unable to display selected Raster function template."),this.analysisRFTFailedToLoad.emit(e)}},this.createRfxDetailsEditor=({detailsEditorRfxTemplate:e,detailsEditorRfxSchema:t,detailsEditorRfxNode:a})=>{const i=(0,n.C)(e,this.translatedRFTNamesMap,!0)??e?.name,o=document.createElement("div");o.setAttribute("style","display: flex; width: 28rem; justify-content: space-between;"),o.slot="header",this.headerElement=o;const s=document.createElement("span");s.setAttribute("style","display: flex; align-items: center;"),s.innerHTML=i;const r=document.createElement("calcite-action");r.label="",r.text="",r.icon="information",r.onclick=this.handleRFxDetailsEditorHeadingHelpClick(e,i),o.appendChild(s),o.appendChild(r);const l=(({rfxTemplate:e,mapLayers:t,portal:a,schema:i,title:o,handlePanelClose:s,handlePanelOk:n,handlePanelCancel:r,createLayerBrowse:l,headerElementComponent:d,mapView:c})=>{const h=document.createElement("rfx-details-editor");h.rfxTemplate=e,h.schema=i,h.mapLayers=t,h.portal=a,h.mapView=c,h.addEventListener("rfxDetailsEditorBrowseLayerClick",l);const m=(0,p.a)("rfx-modal","",{open:!0});m.setAttribute("style","--calcite-modal-height: 32rem"),m.addEventListener("rfxModalClose",(()=>{s()})),m.addEventListener("rfxModalPrimaryClick",(async()=>{const e=await h.okClicked();n({rfxTemplate:e})})),m.addEventListener("rfxModalSecondaryClick",(()=>{r()})),m.appendChild(d);const u=document.createElement("div");return u.slot=g.R.content,u.appendChild(h),m.appendChild(u),m})({rfxTemplate:e,schema:t,title:i,mapLayers:this.mapLayers,portal:this.portal,mapView:this.mapView,createLayerBrowse:this.createLayerBrowse,handlePanelClose:()=>{l.remove()},handlePanelOk:e=>{const{rfxTemplate:t}=e;a?.read(t),l.remove()},handlePanelCancel:()=>{l.remove()},headerElementComponent:o});document.body.appendChild(l)},this.createLayerBrowse=e=>{const t=e.detail;let a=(0,p.b)({modalStrings:{header:this.strings.selectLayer},portal:this.portal,user:this.portal.user,filter:t.filter||'(type: "Image Service")',selectionMode:"single-sublayer",hideFilters:!1,onClose:()=>{a.remove(),a=void 0},onSelection:e=>{this.updateLayerValue(t.isFeatureSelectElement,t.referenceElement,e)}});document.body.appendChild(a)},this.updateLayerValue=(e,t,a)=>{if(null!==a.detail&&void 0!==a.detail){const e=a.detail;t.updateBrowsedLayer(e)}},this.handleAddFunctionClick=()=>{this.visibilityReducer({key:"rfxListView",visible:!0})},this.handleAddConstantClick=e=>{const{value:t}=e||{};this.rfxCoreServices.addScalarNodeCommand.execute({value:t}),v.s.hasUnsavedChanges=!0},this.handleAddRasterClick=e=>{const{value:t}=e||{};this.rfxCoreServices.addRasterNodeCommand.execute({value:t}),v.s.hasUnsavedChanges=!0},this.handleDontSaveClick=()=>{this.handleCloseClick(),this.closeWithoutSavingModalElement?.remove(),this.closeWithoutSavingModalElement=void 0},this.handleRunClick=()=>{},this.handleSaveClick=()=>{},this.handleCloseClick=()=>{this.clearState(),this.analysisRFTEditorClose.emit()},this.clearState=()=>{v.s.hasUnsavedChanges=!1,v.s.rftJSON=void 0,v.s.rftProperties=void 0,v.s.portalItem=void 0,this.rfxEditorCoreElement.clearAll(),this.analysisTemplateNameChanged.emit()},this.handleDiagramZoomIn=()=>{this.rfxCoreServices.diagramZoomInCommand.execute()},this.handleDiagramZoomOut=()=>{this.rfxCoreServices.diagramZoomOutCommand.execute()},this.handleDiagramAutoLayout=()=>{this.rfxCoreServices.diagramAutoLayoutCommand.execute()},this.handleDiagramStretch=()=>{this.rfxCoreServices.diagramStretchCommand.execute()},this.handleDiagramPan=()=>{this.rfxCoreServices.diagramPanCommand.execute()},this.handleDiagramDeleteSelected=()=>{this.rfxCoreServices.deleteSelectedItemsCommand.execute()},this.handleRFTLaunch=async()=>{try{let e=await this.rfxCoreServices.getModelCommand.execute();e=(0,l.o)(v.s.rftProperties)?{...e,name:this.strings.defaultTemplateName,description:""}:y(e,v.s.rftProperties),void 0!==v.s.portalItem&&(e.sourceItemId=v.s.portalItem.id);const t=()=>{this.closeWithoutSavingModalElement?.remove(),this.closeWithoutSavingModalElement=void 0,this.analysisRFTLaunch.emit(e)},a=()=>{this.handleRFTSaveOnClose()};void 0!==e&&(!0===v.s.hasUnsavedChanges?(this.showCloseWithoutSavingModal(t,a),v.s.rftJSON=e):this.analysisRFTLaunch.emit(e))}catch{this.showErrorModal()}},this.handleDiagramSelect=()=>{this.rfxCoreServices.diagramSelectCommand.execute()},this.handleRFTSave=async()=>{try{let e=await this.rfxCoreServices.getModelCommand.execute();e=y(e,v.s.rftProperties),v.s.rftJSON=e;const t=x(e),a=v.s.portalItem?.toJSON(),i=await(0,p.u)(v.s.portalItem,{itemProperties:{...a,title:v.s.rftProperties.name,snippet:v.s.rftProperties.description,thumbnail:v.s.rftProperties.thumbnail},itemData:t});i.success&&(v.s.portalItem=i.item,v.s.hasUnsavedChanges=!1,document.body.appendChild((0,p.d)({modalStrings:{content:this.strings.saveSuccess.replace("${template}",i.item.title)}})),this.analysisTemplateSaved.emit(i.item))}catch{this.showErrorModal()}},this.showErrorModal=()=>{const e=(0,p.e)({modalStrings:{header:this.strings.templateInvalidModalTitle,content:this.strings.templateInvalidModalMsg,cancel:this.strings.cancel}});!1===document.body.contains(e)&&(document.body.appendChild(e),e.open=!0)},this.closeSaveModal=()=>{void 0!==this.saveModalElement&&(this.saveModalElement.removeEventListener("cancelClick",this.closeSaveModal),this.saveModalElement.remove(),this.saveModalElement=void 0)},this.saveAsItem=async e=>{const t=e.detail.itemProperties;v.s.rftProperties={...v.s.rftProperties,name:t.title,description:t.snippet};const a=y(v.s.rftJSON,v.s.rftProperties);v.s.rftJSON=a;const i=x(a);t.fileType="json";const o=await(0,p.c)({itemProperties:{...t,thumbnail:v.s.rftProperties.thumbnail},itemData:i},this.portal);o.success&&(v.s.portalItem=o.item,v.s.hasUnsavedChanges=!1,document.body.appendChild((0,p.d)({modalStrings:{content:this.strings.saveSuccess.replace("${template}",o.item.title)}})),this.analysisTemplateSaved.emit(o.item)),this.closeSaveModal()},this.closeItemBrowser=()=>{void 0!==this.itemBrowserElement&&(this.itemBrowserElement.removeEventListener("rfxItemBrowserClose",this.closeItemBrowser),this.itemBrowserElement.remove(),this.itemBrowserElement=void 0)},this.handleRFTSaveAs=async()=>new Promise((async e=>{const{portal:t,closeSaveModal:a,saveAsItem:i}=this;this.saveModalElement?.remove();try{const o=await this.rfxEditorCoreElement.getModel();v.s.rftJSON=o,void 0!==o&&(this.saveModalElement=(0,p.f)({portal:t,portalItem:v.s.portalItem,itemProps:void 0!==v.s.rftProperties?{title:v.s.rftProperties.name,snippet:v.s.rftProperties.description}:void 0,onCancel:()=>{a(),e(!1)},onSave:t=>{i(t),e(!0)}}),document.body.appendChild(this.saveModalElement))}catch{this.showErrorModal(),e(!1)}})),this.handleRFxTemplateEditorPanelClose=()=>{void 0!==this.templateEditorElement&&(this.templateEditorElement.remove(),this.templateEditorElement=void 0)},this.handleRFxTemplateEditorPanelSave=e=>{v.s.rftProperties=e,v.s.hasUnsavedChanges=!0,this.templateEditorElement?.remove()},this.handleOpenTemplateEditor=()=>{this.templateEditorElement=(0,p.g)({templateProperties:v.s.rftProperties,modalStrings:{header:this.strings.templatePropertiesTitle},onCancel:this.handleRFxTemplateEditorPanelClose,onSave:this.handleRFxTemplateEditorPanelSave}),document.body.appendChild(this.templateEditorElement)},this.handleRFTShare=()=>{const{portal:e}=this;this.shareModalElement?.remove(),this.shareModalElement=(0,p.h)({portal:e,portalItem:v.s.portalItem}),this.shareModalElement.addEventListener("rfxShareSuccessful",(()=>{this.shareModalElement?.remove(),this.shareModalElement=void 0,document.body.appendChild((0,p.d)({modalStrings:{content:this.strings.shareSuccess.replace("${template}",v.s.portalItem.title)}}))})),document.body.appendChild(this.shareModalElement)},this.handleRFxListViewTriggerSelectFunction=async e=>{e.stopPropagation();const{detail:t}=e,a=await(0,n.b)(t);this.rfxCoreServices.addRFxFunctionCommand.execute(a),v.s.hasUnsavedChanges=!0},this.handleRFxListViewPanelClose=e=>{e.stopPropagation(),this.visibilityReducer({key:"rfxListView",visible:!1})},this.createRasterNodeEditor=(e,t)=>{const a=(0,p.i)({heading:this.strings.browseLayerDialogTitle,inputLayers:(0,d.t)(this.mapLayers).imageryLayers,layerValue:t,handlePanelOk:t=>{e.value=t.rasterValue,a?.remove()},handlePanelClose:()=>{a?.remove()},createLayerBrowse:this.createLayerBrowse});document.body.appendChild(a)},this.handlePopoverClose=()=>{(0,u.r)(this.toolHelpPopover)},this.handleRFxDetailsEditorHeadingHelpClick=(e,t)=>async()=>{const a=(0,n.e)(e),{helpTemplate:i,learnMoreUrl:o}=await(0,r.b)({rfxName:a,rfxTemplate:e,portal:this.portal});this.toolHelpPopover=(0,u.s)(this.toolHelpPopover,{helpSrcdoc:i,helpId:"toolDescription",heading:t,referenceElement:this.headerElement,learnMoreUrl:o,offsetDistance:25,offsetSkidding:0}),this.toolHelpPopover.addEventListener("rfxHelpPopoverClose",this.handlePopoverClose)},this.showRfxList=!1,this.mapView=void 0,this.mapLayers=void 0,this.portal=void 0,this.rftItemId=void 0,this.renderFlag=!1}handleActionBarClick(e){switch(e.detail.actionId){case s.E.newTemplate:this.handleNewTemplateClick();break;case s.E.openTemplate:this.handleOpenTemplateClick();break;case s.E.addFunction:this.handleAddFunctionClick();break;case s.E.addConstant:this.handleAddConstantClick();break;case s.E.addRaster:this.handleAddRasterClick()}}async onPanelClose(){return new Promise((async e=>{!0===v.s.hasUnsavedChanges?e(await this.showUnsavedChangesDialog()):(this.handleCloseClick(),e(!0))}))}async getModelJSON(){const e=await this.rfxCoreServices.getModelDisplayDataCommand.execute(),t=this.rfxEditorCoreElement.getBoundingClientRect(),a=t.left,i=t.top;return e.map((e=>({...e,x:a+e.x,y:i+e.y})))}async componentWillLoad(){({strings:this.strings,dir:this.direction,locale:this.locale}=await(0,c.b)(this.hostElement,(0,i.g)("."))),this.translatedRFTNamesMap=await async function(){const e=new Map,{rfxFunctions:t}=await(0,n.a)();for(const a of t)(0,l.o)(a)||("CellStatisticsFunction"===a.name&&e.set("LocalFunction__40",a.title),e.set(a.name,a.title));return e}()}componentDidLoad(){void 0!==this.rftItemId&&setTimeout((async()=>{await this.loadRFT(this.rftItemId)}),1)}disconnectedCallback(){(0,u.r)(this.toolHelpPopover)}visibilityReducer({key:e,visible:t}){const a=this.overlayElementsConfig[e];if(a.visible!==t){if(!0===t){const e=Object.values(this.overlayElementsConfig).filter((e=>e.slot===a.slot));e.length>=2&&e.slice(1).forEach((e=>{e.visible=!1}))}a.visible=t,this.scheduleRenderer()}}scheduleRenderer(){this.renderFlag=!this.renderFlag}renderOverlayElements(){const e={addRasterFunctionTitle:this.strings.addRasterFunctionTitle,templatePropertiesTitle:this.strings.templatePropertiesTitle,browseLayerDialogTitle:this.strings.browseLayerDialogTitle},t=this.overlayElementsConfig;return Object.keys(t).map((a=>{const i=t[a];if(!i.visible)return[];const o=i?.builder?.(e);return o}))}_renderEditorCoreUI(){return(0,i.h)("rfx-editor-core",{ref:this.initializeRFxEditorCore,onRfxCoreNodeEditProperties:e=>{e.stopPropagation();const{detail:t}=e;switch(this.handlePopoverClose(),t.dataType){case h.d.raster:this.createRasterNodeEditor(t.node,t.json);break;case h.d.rfxtemplate:if(void 0===t.schema||(0,f.i)({category:t.schema?.category}))return;this.createRfxDetailsEditor({detailsEditorRfxTemplate:t.json,detailsEditorRfxSchema:t.schema,detailsEditorRfxNode:t.node})}},onRfxCoreNodeDuplicate:async e=>{e.stopPropagation();const{detail:t}=e;switch(t.dataType){case h.d.raster:this.handleAddRasterClick({value:t.value});break;case h.d.scalar:this.handleAddConstantClick({value:t.value.value});break;case h.d.rfxtemplate:const e=(0,n.e)(t.json),a=await(0,n.b)(e);this.rfxCoreServices.addRFxFunctionCommand.execute(a)}},onRfxCoreDeprecatedFunctionFound:e=>{e.stopPropagation();const t=this.portal?.sourceJSON?.helpBase||n.F.learnMoreDocBaseURL,a=n.F.learnMoreDocDeprecatedHelpID,i=(0,c.f)(a,t,this.locale),{detail:o}=e,s=`${this.strings.deprecatedFunctions}${o}`;document.body.appendChild((0,p.j)({modalStrings:{content:(0,m.f)(this.strings.deprecatedFunctionAlertContent,{docLink:i}),header:this.strings.deprecatedFunctionAlertHeader,functionNames:s}}))}},this.renderOverlayElements())}render(){return(0,i.h)(i.H,{key:"eabc3e970000e3001765e53dfafc37da544e1d2b",class:S},(0,i.h)("div",{key:"731d0289d6965ebf7973b5b6138310becd5a2088",class:{[E]:!0,[R]:"rtl"===this.direction}},(0,i.h)("slot",{key:"0a5d25928efd8cc424988555b700e0e21486adbc",name:F}),(0,i.h)("calcite-panel",{key:"fc1f4ae2f6272b46eff2d27ec174340e917bf816",heading:""},this._renderEditorCoreUI())))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,i.a)(this)}};L.style=":root{--calcite-color-brand:#007ac2;--calcite-color-brand-hover:#00619b;--calcite-color-brand-press:#004874;--calcite-color-status-info:#00619b;--calcite-color-status-success:#35ac46;--calcite-color-status-warning:#edd317;--calcite-color-status-danger:#d83020;--calcite-color-status-danger-hover:#a82b1e;--calcite-color-status-danger-press:#7c1d13;--calcite-color-background:#f8f8f8;--calcite-color-foreground-1:#ffffff;--calcite-color-foreground-2:#f3f3f3;--calcite-color-foreground-3:#eaeaea;--calcite-color-text-1:#151515;--calcite-color-text-2:#4a4a4a;--calcite-color-text-3:#6a6a6a;--calcite-color-text-inverse:#ffffff;--calcite-color-text-link:#00619b;--calcite-color-border-1:#cacaca;--calcite-color-border-2:#d4d4d4;--calcite-color-border-3:#dfdfdf;--calcite-color-border-input:#949494;--rfx-quarter-spacing:0.25rem;--rfx-half-spacing:0.5rem;--rfx-three-quarter-spacing:0.75rem;--rfx-full-spacing:1rem;--rfx-component-default-width:100%;--rfx-ui-border-input:var(--calcite-color-border-2);--rfx-popover-content-min-height:30vh;--rfx-popover-content-max-height:60vh;--rfx-popover-content-height:45vh;--rfx-widget-content-height:30vh;--rfx-modal-width-small:32rem}.host{height:100%;width:100%}.content{height:100%;display:flex;overflow:hidden}.action-bar{height:100%;border-width:0 1px 0 0;border-style:solid;border-color:var(--calcite-color-border-2)}.menu-actions{display:inline-flex;justify-self:stretch}.header-actions{height:100%}.tooltip{white-space:nowrap}.arcgis--rtl .action-bar{border-width:0 0 0 1px}.editor-container{position:relative;}.overlay-element{z-index:3;box-shadow:0 0 5px rgba(0, 0, 0, 0.2);border-radius:0.25rem}.overlay-panel{max-height:90%;max-width:22rem;width:22rem}.list-wrapper{display:flex;height:100%}";a(5294),a(63716),a(55448),a(2924),a(11840),a(52373),a(440),a(66744),a(15195),a(19562)},98379:(e,t,a)=>{a.d(t,{I:()=>l,a:()=>x,b:()=>g,c:()=>m,d:()=>w,e:()=>E,f:()=>f,g:()=>y,h:()=>C,i:()=>b,j:()=>T,k:()=>u,l:()=>p,m:()=>v,u:()=>h});var i=a(33752),o=a(38146),s=a(14385),n=a(19562);const r={JSON:"json",XML:"xml"},l={RASTER_FUNCTION_TEMPLATE:"Raster function template"};function d(e){const t=new FormData,{itemProperties:a,itemData:i}=e,{title:o,description:n,tags:d,type:c,snippet:h,properties:m,categories:p}=a,u=a.fileType||r.JSON;if(t.append("title",o),(0,s.o)(i)){let e="";c===l.RASTER_FUNCTION_TEMPLATE&&(e="rft");const a=`${o}.${void 0!==e?e+".":""}${u}`;t.append("file",i,a),t.append("name",a)}return t.append("type",c),void 0!==n&&t.append("description",n),void 0!==h&&t.append("snippet",h),void 0!==d&&t.append("tags",d.join(",")),void 0!==m&&t.append("properties",JSON.stringify(m)),void 0!==p&&t.append("categories",p.join(",")),t.append("f","json"),t}async function c(e,t,a){const{thumbnail:o,shareOptions:n}=a,r={success:!0,errors:[]};if(e.data){const a=e.data.id,l=new i.default({id:a,portal:t});return r.item=l,l.load().then((()=>(void 0!==o&&l.updateThumbnail({thumbnail:o}),(0,s.o)(n),Promise.resolve(r))))}}function h(e,t){((0,s.o)(t)||(0,s.o)(e))&&Promise.reject(new Error("Item data or item not present"));const a=e.portal,i=`${a.user.userContentUrl}/items/${e.id}/update`;return(0,o.r)(`${i}`,{body:d(t)}).then((e=>c(e,a,t.itemProperties)),(e=>({success:!1,errors:[e]})))}function m(e,t){((0,s.o)(e)||(0,s.o)(t))&&Promise.reject(new Error("Item data or portal not present"));const{itemProperties:a}=e,i=t.user;if((0,s.o)(i))return;const{ownerFolder:n}=a,r=void 0!==n&&n.id!==n.title?n.id:void 0,l=(0,s.o)(r)?`${i.userContentUrl}/addItem`:`${i.userContentUrl}/${r}/addItem`;return(0,o.r)(l,{body:d(e)}).then((e=>c(e,t,a)),(e=>({success:!1,errors:[e]})))}const p=({label:e,open:t})=>{const a=document.createElement("rfx-section");return a.label=e,a.open=t,a},u=({content:e,unsupportedWarningComponent:t,title:a,isFunctionChain:i})=>{const o=document.createElement("calcite-block");return o.open=!0,!0===i&&(o.heading=a,o.collapsible=!0,o.headingLevel=3),(0,s.o)(t)||o.appendChild(t),o.appendChild(e),o},v=({label:e,hideHelp:t=!1,onHelpActionClick:a})=>{const i=document.createElement("rfx-label");return i.label=e,i.hideHelp=t,i.addEventListener("rfxLabelHelpActionClick",a),i},f=({portal:e,portalItem:t,itemProps:a,onCancel:i,onSave:o})=>{const s=document.createElement("rfx-save-modal");return s.portal=e,s.portalItem=t,s.itemProps=a,s.addEventListener("cancelClick",i),s.addEventListener("saveClick",o),s},C=({portal:e,portalItem:t})=>{const a=document.createElement("rfx-share-modal");return a.portal=e,a.portalItem=t,a},g=({modalStrings:{header:e},portal:t,user:a,filter:i,hideFilters:o,selectionMode:s,onClose:n,onSelection:r})=>{const l=document.createElement("rfx-item-browser");return l.portal=t,l.user=a,l.header=e,l.filter=i,l.hideFilters=o,l.selectionMode=s??"single",l.addEventListener("rfxItemBrowserClose",n),l.addEventListener("rfxItemBrowserSelection",r),l},y=({templateProperties:e,modalStrings:{header:t},onCancel:a,onSave:i})=>{const o=document.createElement("rfx-modal"),s=document.createElement("div");s.innerHTML=t,s.slot="header",o.appendChild(s);const n=document.createElement("rfx-template-editor");n.value=e;const r=document.createElement("div");return r.slot="content",r.style.height="50vh",r.appendChild(n),o.appendChild(r),o.addEventListener("rfxModalSecondaryClick",a),o.addEventListener("rfxModalPrimaryClick",(()=>{i(n.value)})),o.addEventListener("rfxModalClose",a),o},x=(e,t,a)=>{const i=document.createElement(e);var o,s;return o=i,s=a,Object.keys(s).forEach((e=>{o.setAttribute(e,s[e])})),i.innerHTML=t,i},S={modal:{kind:"warning"},header:{slot:"header",style:"\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n    "},headerIcon:{icon:"exclamation-mark-triangle-f",style:"\n      margin: 0 1rem;\n      --calcite-ui-icon-color: var(--calcite-color-status-warning);\n    "},content:{slot:"content"}},E=({modalStrings:{header:e,content:t}})=>{const a=x("rfx-modal","",S.modal);a.showPrimaryButton=!1;const i=x("div","",S.header),o=x("div",e,{}),s=x("calcite-icon","",S.headerIcon);i.appendChild(s),i.appendChild(o);const n=x("div","",S.content);return n.appendChild(x("p",t,{})),a.appendChild(i),a.appendChild(n),a.addEventListener("rfxModalSecondaryClick",(()=>{a.remove(),a.open=!1})),a.addEventListener("rfxModalClose",(()=>{a.remove(),a.open=!1})),a},w=({modalStrings:{content:e}})=>{const t=x("calcite-alert",e,{kind:"success",scale:n.C.l,open:!0,label:"save success"});t.autoClose=!0;const a=x("div",e,{slot:"message"});return t.appendChild(a),t},T=({modalStrings:{content:e,header:t,functionNames:a}})=>{const i=x("calcite-alert",e,{kind:"warning",scale:n.C.m,open:!0,label:"deprecate function"});i.autoClose=!0;const o=x("div",t,{slot:"title"}),s=x("div",e,{slot:"message"}),r=x("p",a,{});return s.appendChild(r),i.appendChild(s),i.appendChild(o),i},b=({heading:e,handlePanelClose:t,handlePanelOk:a,inputLayers:i,layerValue:o,createLayerBrowse:s})=>{let n;const r=x("rfx-modal","",{open:!0});r.addEventListener("rfxModalClose",t),r.addEventListener("rfxModalPrimaryClick",(async()=>{const e=await(n?.getRasterValue());a({rasterValue:e})})),r.addEventListener("rfxModalSecondaryClick",t);const l=x("div",e,{slot:"header"}),d=x("div","",{slot:"content"});return r.appendChild(l),n=document.createElement("rfx-select-layer-panel"),n.value=o?.value,n.inputLayers=i,r.addEventListener("rfxlayerSelectBrowseLayerClick",s),d.appendChild(n),r.appendChild(d),r}}}]);