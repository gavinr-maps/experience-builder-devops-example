System.register(["jimu-core","jimu-arcgis"],(function(t,e){var o={},a={};return{setters:[function(t){o.AbstractDataAction=t.AbstractDataAction,o.MutableStoreManager=t.MutableStoreManager,o.getAppStore=t.getAppStore,o.i18n=t.i18n,o.utils=t.utils},function(t){a.MapViewManager=t.MapViewManager,a.SHOW_ON_MAP_DATA_ID_PREFIX=t.SHOW_ON_MAP_DATA_ID_PREFIX,a.ShowOnMapDataType=t.ShowOnMapDataType,a.featureUtils=t.featureUtils,a.zoomToUtils=t.zoomToUtils}],execute:function(){t((()=>{"use strict";var t={26826:t=>{t.exports=a},48891:t=>{t.exports=o}},e={};function i(o){var a=e[o];if(void 0!==a)return a.exports;var n=e[o]={exports:{}};return t[o](n,n.exports,i),n.exports}i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{i.r(n),i.d(n,{default:()=>a});var t=i(48891),e=i(26826);var o=function(t,e,o,a){return new(o||(o=Promise))((function(i,n){function r(t){try{u(a.next(t))}catch(t){n(t)}}function s(t){try{u(a.throw(t))}catch(t){n(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,s)}u((a=a.apply(t,e||[])).next())}))};class a extends t.AbstractDataAction{constructor(){super(...arguments),this._viewManager=e.MapViewManager.getInstance()}isSupported(t){return o(this,void 0,void 0,(function*(){const{records:e}=t;return e.length>0&&e.some((t=>{var e;return null===(e=t.feature)||void 0===e?void 0:e.geometry}))}))}onExecute(a,i){var n,r,s,u;return o(this,void 0,void 0,(function*(){const o=this._getActiveViewId(this.widgetId,(0,t.getAppStore)().getState().jimuMapViewsInfo),l=(null===(n=t.MutableStoreManager.getInstance().getStateValue([this.widgetId]))||void 0===n?void 0:n.showOnMapDatas)||{},d=t.i18n.getIntl(),c=(null==i?void 0:i.dataName)||d.formatMessage({id:"showOnMapData",defaultMessage:"Show on map data"});l[`${e.SHOW_ON_MAP_DATA_ID_PREFIX}dataAction_${t.utils.getUUID()}`]={mapWidgetId:this.widgetId,jimuMapViewId:o,dataSet:a,type:e.ShowOnMapDataType.DataAction,symbolOption:(null===(r=null==i?void 0:i.actionConfig)||void 0===r?void 0:r.isUseCustomSymbol)?i.actionConfig.symbolOption:!1===(null===(s=null==i?void 0:i.actionConfig)||void 0===s?void 0:s.isUseCustomSymbol)?null:void 0,title:c},t.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"showOnMapDatas",l);const p=this._viewManager.getJimuMapViewById(o),g=yield e.featureUtils.convertDataRecordSetToFeatureSet(a);return p&&(null===(u=null==g?void 0:g.features)||void 0===u?void 0:u.length)>0&&e.zoomToUtils.zoomTo(null==p?void 0:p.view,g.features,null),yield Promise.resolve(!0)}))}_getActiveViewId(t,e){let o=Object.keys(e||{}).find((o=>e[o].mapWidgetId===t&&e[o].isActive));return o||(o=Object.keys(e||{}).find((o=>e[o].mapWidgetId===t))),o}}})(),n})())}}}));