System.register(["jimu-core/emotion","jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-ui/advanced/data-source-selector","jimu-theme","jimu-ui/advanced/sql-expression-builder","jimu-ui/advanced/builder-components"],function(e,t){var a={},s={},o={},i={},n={},r={},c={},l={};return{setters:[function(e){a.jsx=e.jsx,a.jsxs=e.jsxs},function(e){s.AllDataSourceTypes=e.AllDataSourceTypes,s.DataSourceComponent=e.DataSourceComponent,s.DataSourceManager=e.DataSourceManager,s.DataSourceTypes=e.DataSourceTypes,s.Immutable=e.Immutable,s.MessageActionConnectionType=e.MessageActionConnectionType,s.MessageCarryData=e.MessageCarryData,s.React=e.React,s.SqlExpressionMode=e.SqlExpressionMode,s.classNames=e.classNames,s.css=e.css,s.dataSourceUtils=e.dataSourceUtils,s.getAppStore=e.getAppStore,s.polished=e.polished},function(e){o.Button=e.Button,o.Collapse=e.Collapse,o.Icon=e.Icon,o.Label=e.Label,o.Radio=e.Radio,o.Switch=e.Switch,o.Tooltip=e.Tooltip},function(e){i.SettingRow=e.SettingRow,i.SettingSection=e.SettingSection},function(e){n.DataSourceSelector=e.DataSourceSelector,n.FieldSelector=e.FieldSelector},function(e){r.withTheme=e.withTheme},function(e){c.SqlExpressionBuilderPopup=e.SqlExpressionBuilderPopup},function(e){l.ChooseConnectionType=e.ChooseConnectionType}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=r},13089:e=>{"use strict";e.exports=n},14321:e=>{"use strict";e.exports=o},45508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},67386:e=>{"use strict";e.exports=a},71442:e=>{"use strict";e.exports=c},74587:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 40"><path fill="#A8A8A8" fill-rule="evenodd" d="M6 30v10H0v-1h5v-9zM3.162 18.582a.5.5 0 0 1 0 .71l-1.416 1.421a2.497 2.497 0 0 0-.003 3.545c.983.983 2.56.98 3.544-.003l1.42-1.42a.504.504 0 0 1 .712.713L6 24.968a3.5 3.5 0 0 1-4.967 0 3.5 3.5 0 0 1 0-4.967l1.416-1.422a.504.504 0 0 1 .713.003m4.967-.71a.5.5 0 0 1 0 .71L4.58 22.129a.504.504 0 0 1-.713-.712l3.548-3.548a.504.504 0 0 1 .713.003m2.838-2.838a3.5 3.5 0 0 1 0 4.967l-1.42 1.419a.504.504 0 0 1-.713-.712l1.423-1.417a2.5 2.5 0 0 0 0-3.547 2.5 2.5 0 0 0-3.547 0l-1.42 1.419a.504.504 0 0 1-.713-.712l1.42-1.42a3.506 3.506 0 0 1 4.97.003M6 0v10H5V1H0V0z"></path></svg>'},79244:e=>{"use strict";e.exports=s},79298:e=>{"use strict";e.exports=i},86739:e=>{"use strict";e.exports=l}},t={};function u(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,u),o.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var a in t)u.o(t,a)&&!u.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var d={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(d),u.d(d,{default:()=>V});var e=u(67386),t=u(79244),a=u(14321),s=u(79298),o=u(13089),i=u(1888),n=u(71442);const r="Trigger data",c="Connection mode",l="Customize",p="In this mode, the selected data will be filtered if the data from the source widgets is in the Map widget. The trigger and action data are from the same layer and will be automatically bound.",g="Action data",S="Conditions",h="Trigger / action connection",m="Select a trigger field",D="Select an action field",f="More conditions",y="Please set your expression first.",I="Auto bound.",v="Automatic";function x(e,a){var s,o;const i=C(),n=null===(s=null==i?void 0:i.widgets)||void 0===s?void 0:s[e],r=null===(o=null==n?void 0:n.manifest)||void 0===o?void 0:o.publishMessages;let c=t.MessageCarryData.UseDataSource;return null==r||r.forEach(e=>{const t=e;(null==t?void 0:t.messageCarryData)&&(null==t?void 0:t.messageType)===a&&(c=null==t?void 0:t.messageCarryData)}),c}function b(e,a,s,o){var i,n;let r=null;const c=w(e,s);if(!(c&&c.length>0))return null;let l=!1;if(a){const e=null===(n=null===(i=t.DataSourceManager.getInstance().getDataSource(a.dataSourceId))||void 0===i?void 0:i.getDataSourceJson())||void 0===n?void 0:n.isOutputFromWidget;l=c.some(t=>!!t&&(L(t.dataSourceId)?t.dataSourceId===a.rootDataSourceId:e||o?a.mainDataSourceId===t.mainDataSourceId:a.dataSourceId===t.dataSourceId))}if(l)r=a;else if(r=null,c&&1===c.length){const e=c[0];e&&e.dataSourceId&&!L(e.dataSourceId)&&(r=(0,t.Immutable)({dataSourceId:e.dataSourceId,mainDataSourceId:e.mainDataSourceId,dataViewId:e.dataViewId,rootDataSourceId:e.rootDataSourceId}))}return r}function A(e,a,s){var o;const i=C(),n=null===(o=null==i?void 0:i.widgets)||void 0===o?void 0:o[e],r=j(e,a);return{isReadOnly:U(n,a,r),useDataSources:s&&s.dataSourceId?(0,t.Immutable)([s]):(0,t.Immutable)([]),fromRootDsIds:r,fromDsIds:r&&r.length>0?void 0:T(e,a)}}function w(e,a){var s;const o=x(e,a),i=C(),n=null===(s=null==i?void 0:i.widgets)||void 0===s?void 0:s[e],r=(null==n?void 0:n.useDataSources)||(0,t.Immutable)([]),c=function(e){var a;const s=null!==(a=null==e?void 0:e.map(e=>({dataSourceId:e,mainDataSourceId:e,rootDataSourceId:null})))&&void 0!==a?a:[];return(0,t.Immutable)(s)}(null==n?void 0:n.outputDataSources)||(0,t.Immutable)([]),l=function(e){const a=[],s=M(e),o=null==s?void 0:s.useMapWidgetIds,i={};(null==o?void 0:o.length)>0&&o.forEach(e=>{if(e){const t=M(e),s=null==t?void 0:t.useDataSources;s&&s.forEach(e=>{var t;const s=null===(t=null==e?void 0:e.asMutable)||void 0===t?void 0:t.call(e,{deep:!0});s&&s.dataSourceId&&!i[s.dataSourceId]&&(i[s.dataSourceId]=!0,a.push(s))})}});return(0,t.Immutable)(a)}(e),u=c,d=(null==n?void 0:n.useDataSources)?r:l,p=(0,t.Immutable)(d.asMutable({deep:!0}).concat(u.asMutable({deep:!0})));switch(o){case t.MessageCarryData.OutputDataSource:return u;case t.MessageCarryData.UseDataSource:return d;case t.MessageCarryData.BothDataSource:return p}}function M(e){var t;if(!e)return null;const a=C();return null===(t=null==a?void 0:a.widgets)||void 0===t?void 0:t[e]}function U(e,a,s){const o=x(null==e?void 0:e.id,a),i=(null==e?void 0:e.outputDataSources)||[],n=(null==e?void 0:e.useDataSources)||[];if(s)return!1;switch(o){case t.MessageCarryData.OutputDataSource:return 1===(null==i?void 0:i.length);case t.MessageCarryData.UseDataSource:return 1===(null==n?void 0:n.length);case t.MessageCarryData.BothDataSource:return 1===i.length+n.length}}function C(){var e,a,s;return window.jimuConfig.isBuilder?null===(a=null===(e=(0,t.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===a?void 0:a.appConfig:null===(s=(0,t.getAppStore)().getState())||void 0===s?void 0:s.appConfig}function j(e,a){let s=[];const o=w(e,a);return o&&o.forEach(e=>{const t=null==e?void 0:e.dataSourceId;t&&L(t)&&s.push(t)}),s=Array.from(new Set(s)),s.length>0?(0,t.Immutable)(s):void 0}function T(e,a){const s=w(e,a),o=[];return s&&s.forEach(e=>{const t=null==e?void 0:e.mainDataSourceId;t&&!L(t)&&o.push(t)}),(0,t.Immutable)(o)}function L(e){const a=C();if(e&&a.dataSources){const s=a.dataSources[e];if(s&&(s.type===t.DataSourceTypes.WebMap||s.type===t.DataSourceTypes.WebScene))return!0}return!1}var R=u(86739),O=u(45508),E=u.n(O),q=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(a[s[o]]=e[s[o]])}return a};const N=a=>{const s=window.SVG,{className:o}=a,i=q(a,["className"]),n=(0,t.classNames)("jimu-icon jimu-icon-component",o);return s?(0,e.jsx)(s,Object.assign({className:n,src:E()},i)):(0,e.jsx)("svg",Object.assign({className:n},i))},F=(0,t.Immutable)([t.AllDataSourceTypes.FeatureLayer,t.AllDataSourceTypes.SceneLayer,t.AllDataSourceTypes.BuildingComponentSubLayer,t.AllDataSourceTypes.ImageryLayer,t.AllDataSourceTypes.OrientedImageryLayer,t.AllDataSourceTypes.SubtypeGroupLayer,t.AllDataSourceTypes.SubtypeSublayer]);class B extends t.React.PureComponent{constructor(e){super(e),this.modalStyle={position:"absolute",top:"0",bottom:"0",width:"259px",height:"auto",borderRight:"",borderBottom:"",paddingBottom:"1px"},this.initOutputDataSources=e=>{var a;const s=null!==(a=null==e?void 0:e.map(e=>({dataSourceId:e,mainDataSourceId:e,rootDataSourceId:null})))&&void 0!==a?a:[];return(0,t.Immutable)(s)},this.onAllDataRadioChecked=()=>{const e=this.props.config.set("useAnyTriggerData",!0);this.updateMessageActionConfigAndUseDataSources(e)},this.onCustomizeDataRadioChecked=()=>{const e=this.props.config.set("useAnyTriggerData",!1);this.updateMessageActionConfigAndUseDataSources(e)},this.handleTriggerLayerChange=e=>{e&&e.length>0?this.handleTriggerLayerSelected(e[0]):this.handleRemoveLayerForTriggerLayer()},this.handleActionLayerChange=e=>{e&&e.length>0?this.handleActionLayerSelected(e[0]):this.handleRemoveLayerForActionLayer()},this.handleTriggerLayerSelected=e=>{const t=this.props.config.set("messageUseDataSource",e);this.updateMessageActionConfigAndUseDataSources(t)},this.handleActionLayerSelected=e=>{const t=this.props.config.set("actionUseDataSource",e).set("sqlExprObj",null);this.updateMessageActionConfigAndUseDataSources(t)},this.handleRemoveLayerForTriggerLayer=()=>{const e=this.props.config.set("messageUseDataSource",null).set("connectionType",null);this.updateMessageActionConfigAndUseDataSources(e)},this.handleRemoveLayerForActionLayer=()=>{const e=this.props.config.set("actionUseDataSource",null).set("sqlExprObj",null).set("connectionType",null);this.updateMessageActionConfigAndUseDataSources(e)},this.showSqlExprPopup=()=>{this.setState({isSqlExprShow:!0})},this.toggleSqlExprPopup=()=>{this.setState({isSqlExprShow:!this.state.isSqlExprShow})},this.onSqlExprBuilderChange=e=>{const t=this.props.config.set("sqlExprObj",e);this.updateMessageActionConfigAndUseDataSources(t)},this.onMessageFieldSelected=(e,t)=>{const a=this.props.config.set("messageUseDataSource",{dataSourceId:this.props.config.messageUseDataSource.dataSourceId,mainDataSourceId:this.props.config.messageUseDataSource.mainDataSourceId,dataViewId:this.props.config.messageUseDataSource.dataViewId,rootDataSourceId:this.props.config.messageUseDataSource.rootDataSourceId,fields:e.map(e=>e.jimuName)});this.updateMessageActionConfigAndUseDataSources(a)},this.onActionFieldSelected=(e,t)=>{const a=this.props.config.set("actionUseDataSource",{dataSourceId:this.props.config.actionUseDataSource.dataSourceId,mainDataSourceId:this.props.config.actionUseDataSource.mainDataSourceId,dataViewId:this.props.config.actionUseDataSource.dataViewId,rootDataSourceId:this.props.config.actionUseDataSource.rootDataSourceId,fields:e.map(e=>e.jimuName)});this.updateMessageActionConfigAndUseDataSources(a)},this.switchEnabledDataRelationShip=e=>{const t=this.props.config.set("enabledDataRelationShip",e);this.updateMessageActionConfigAndUseDataSources(t)},this.checkTriggerLayerIsSameToActionLayer=()=>!(!this.props.config.messageUseDataSource||!this.props.config.actionUseDataSource)&&(this.props.config.messageUseDataSource.mainDataSourceId===this.props.config.actionUseDataSource.mainDataSourceId&&this.props.config.messageUseDataSource.rootDataSourceId===this.props.config.actionUseDataSource.rootDataSourceId),this.onUseLayersRelationship=()=>{const e=this.props.config.setIn(["messageUseDataSource","fields"],[]).setIn(["actionUseDataSource","fields"],[]).set("connectionType",t.MessageActionConnectionType.UseLayersRelationship);this.updateMessageActionConfigAndUseDataSources(e)},this.onSetCustomFields=()=>{const e=this.props.config.setIn(["messageUseDataSource","fields"],[]).setIn(["actionUseDataSource","fields"],[]).set("connectionType",t.MessageActionConnectionType.SetCustomFields);this.updateMessageActionConfigAndUseDataSources(e)},this.modalStyle.borderRight="1px solid black",this.modalStyle.borderBottom="1px solid black",this.state={isShowLayerList:!1,currentLayerType:null,isSqlExprShow:!1}}componentDidMount(){const e=function(e){const a=e.messageWidgetId,s=C();let o=null,i=null;if(e.config.messageUseDataSource){const t=!0;o=b(e.messageWidgetId,e.config.messageUseDataSource,e.messageType,t)}else{const s=w(a,e.messageType);if(s&&1===s.length){const e=s[0];e&&(o=L(e.dataSourceId)?null:(0,t.Immutable)({dataSourceId:e.dataSourceId,mainDataSourceId:e.mainDataSourceId,dataViewId:e.dataViewId,rootDataSourceId:e.rootDataSourceId}))}}const n=e.widgetId,r=s.widgets[n];if(e.config.actionUseDataSource){const t=!1;i=b(e.widgetId,e.config.actionUseDataSource,e.messageType,t)}else if(r&&r.useDataSources&&1===r.useDataSources.length){const e=r.useDataSources[0];e&&(i=L(e.dataSourceId)?null:(0,t.Immutable)({dataSourceId:e.dataSourceId,mainDataSourceId:e.mainDataSourceId,dataViewId:e.dataViewId,rootDataSourceId:e.rootDataSourceId}))}const c=e.config.actionUseDataSource&&e.config.actionUseDataSource.dataSourceId;return(i&&i.dataSourceId)!==c?{messageUseDataSource:o,actionUseDataSource:i,sqlExprObj:null}:{messageUseDataSource:o,actionUseDataSource:i,sqlExprObj:e.config.sqlExprObj}}(this.props),a=this.props.config.set("messageUseDataSource",e.messageUseDataSource).set("actionUseDataSource",e.actionUseDataSource).set("sqlExprObj",e.sqlExprObj);this.updateMessageActionConfigAndUseDataSources(a)}getStyle(e){return t.css`
      .jimu-widget-setting--section {
        border-bottom: none;
      }

      .label-line-height {
        line-height: 20px;
      }

      .jimu-collapse {
        margin-top: 12px;
        margin-bottom: 12px;
      }

      .setting-header {
        padding: ${t.polished.rem(10)} ${t.polished.rem(16)} ${t.polished.rem(0)} ${t.polished.rem(16)}
      }

      .deleteIcon {
        cursor: pointer;
        opacity: .8;
      }

      .deleteIcon:hover {
        opacity: 1;
      }

      .sql-expr-display {
        width: 100%;
        height: auto;
        min-height: 60px;
        line-height: 25px;
        padding: 3px 5px;
        color: ${e.ref.palette.neutral[900]};
        border: 1px solid ${e.ref.palette.neutral[500]};
      }

      .relate-panel-left {
        flex: auto;
        .action-select-chooser {
          margin-top: ${t.polished.rem(12)};
        }
      }
    `}updateMessageActionConfigAndUseDataSources(e){const a=function(e){const a=[];if(e){if(e.messageUseDataSource){const s=(0,t.Immutable)(e.messageUseDataSource).asMutable({deep:!0});a.push(s)}if(e.actionUseDataSource&&(0===a.length||a.length>0&&e.actionUseDataSource.dataSourceId!==a[0].dataSourceId)){const s=(0,t.Immutable)(e.actionUseDataSource).asMutable({deep:!0});a.push(s)}}return a}(e);this.props.onSettingChange({actionId:this.props.actionId,config:e,useDataSources:a})}render(){var i,d,x,b,w;const{config:M}=this.props,U=t.DataSourceManager.getInstance(),C=M.messageUseDataSource&&U.getDataSource(M.messageUseDataSource.dataSourceId),j=M.actionUseDataSource&&U.getDataSource(M.actionUseDataSource.dataSourceId),T=!M.connectionType||M.connectionType===t.MessageActionConnectionType.SetCustomFields,{theme:L}=this.props,O=A(this.props.messageWidgetId,this.props.messageType,this.props.config.messageUseDataSource),E=A(this.props.widgetId,this.props.messageType,this.props.config.actionUseDataSource),q=null===(x=null===(d=null===(i=null==L?void 0:L.ref)||void 0===i?void 0:i.palette)||void 0===d?void 0:d.neutral)||void 0===x?void 0:x[900],B=this.props.config.useAnyTriggerData,V=this.props.intl.formatMessage({id:"mapAction_TriggerActionConnectionMode",defaultMessage:c}),P=this.props.intl.formatMessage({id:"mapZoomToAction_Automatic",defaultMessage:v}),_=this.props.intl.formatMessage({id:"mapFilterAction_AutomaticTriggerDataTip",defaultMessage:p}),k=this.props.intl.formatMessage({id:"mapAction_Customize",defaultMessage:l}),W=this.props.intl.formatMessage({id:"mapAction_TriggerLayer",defaultMessage:r}),$=this.props.intl.formatMessage({id:"mapAction_ActionLayer",defaultMessage:g});return(0,e.jsxs)("div",{css:this.getStyle(this.props.theme),children:[(0,e.jsxs)(s.SettingSection,{title:V,className:"pb-0",children:[(0,e.jsxs)(s.SettingRow,{children:[(0,e.jsxs)(a.Label,{className:"d-flex align-items-center label-line-height",children:[(0,e.jsx)(a.Radio,{className:"mr-2",checked:B,onChange:()=>{this.onAllDataRadioChecked()}}),P]}),(0,e.jsx)(a.Tooltip,{title:_,showArrow:!0,placement:"left",children:(0,e.jsx)("span",{className:"ml-2",children:(0,e.jsx)(N,{})})})]}),(0,e.jsx)(s.SettingRow,{children:(0,e.jsxs)(a.Label,{className:"d-flex align-items-center label-line-height",children:[(0,e.jsx)(a.Radio,{className:"mr-2",checked:!B,onChange:()=>{this.onCustomizeDataRadioChecked()}}),k]})})]}),!B&&(0,e.jsx)(s.SettingSection,{title:W,className:"pt-5 pb-0",children:(0,e.jsx)(o.DataSourceSelector,{className:"mt-2",types:F,useDataSources:O.useDataSources,fromRootDsIds:O.fromRootDsIds,fromDsIds:O.fromDsIds,closeDataSourceListOnChange:!0,disableRemove:()=>O.isReadOnly,disableDataSourceList:O.isReadOnly,hideAddDataButton:!0,hideTypeDropdown:!0,mustUseDataSource:!0,onChange:this.handleTriggerLayerChange,widgetId:this.props.messageWidgetId,isMultiple:!1,hideDataView:!0,isMultipleDataView:!1,disableDataView:!0,enableToSelectOutputDsFromSelf:!0})}),!B&&(0,e.jsx)(s.SettingSection,{title:$,className:"pt-5 pb-0",children:(0,e.jsx)(o.DataSourceSelector,{className:"mt-2",types:F,useDataSources:E.useDataSources,fromRootDsIds:E.fromRootDsIds,fromDsIds:E.fromDsIds,closeDataSourceListOnChange:!0,disableRemove:()=>E.isReadOnly,disableDataSourceList:E.isReadOnly,hideAddDataButton:!0,hideTypeDropdown:!0,mustUseDataSource:!0,onChange:this.handleActionLayerChange,widgetId:this.props.widgetId,isMultiple:!1,hideDataView:!0,isMultipleDataView:!1,disableDataView:!0,enableToSelectOutputDsFromSelf:!0})}),!B&&this.props.config&&this.props.config.messageUseDataSource&&this.props.config.actionUseDataSource&&(0,e.jsxs)(s.SettingSection,{title:this.props.intl.formatMessage({id:"mapAction_Conditions",defaultMessage:S}),className:"pt-5",children:[(0,e.jsx)(s.SettingRow,{tag:"label",label:this.props.intl.formatMessage({id:"mapAction_RelateMessage",defaultMessage:h}),className:"mt-2",children:(0,e.jsx)(a.Switch,{checked:this.props.config.enabledDataRelationShip,onChange:e=>{this.switchEnabledDataRelationShip(e.target.checked)}})}),(0,e.jsxs)(a.Collapse,{isOpen:this.props.config.enabledDataRelationShip,className:"w-100",children:[(0,e.jsx)(R.ChooseConnectionType,{messageDataSource:C,actionDataSource:j,connectionType:M.connectionType,onUseLayersRelationship:this.onUseLayersRelationship,onSetCustomFields:this.onSetCustomFields}),this.checkTriggerLayerIsSameToActionLayer()&&(0,e.jsx)("div",{className:"w-100 border p-1 mr-2",children:this.props.intl.formatMessage({id:"mapAction_AutoBind",defaultMessage:I})}),!this.checkTriggerLayerIsSameToActionLayer()&&T&&(0,e.jsxs)("div",{className:"w-100 d-flex align-items-center",children:[(0,e.jsxs)("div",{className:"d-flex flex-column relate-panel-left mt-3",children:[(0,e.jsx)(o.FieldSelector,{className:"w-100",useDataSources:(0,t.Immutable)([null===(b=this.props.config.messageUseDataSource)||void 0===b?void 0:b.asMutable({deep:!0})]),isDataSourceDropDownHidden:!0,placeholder:this.props.intl.formatMessage({id:"mapAction_TriggerLayerField",defaultMessage:m}),onChange:this.onMessageFieldSelected,useDropdown:!0,selectedFields:this.props.config.messageUseDataSource&&this.props.config.messageUseDataSource.fields?this.props.config.messageUseDataSource.fields:(0,t.Immutable)([])}),(0,e.jsx)(o.FieldSelector,{className:"w-100 action-select-chooser",placeholder:this.props.intl.formatMessage({id:"mapAction_ActionLayerField",defaultMessage:D}),useDataSources:(0,t.Immutable)([null===(w=this.props.config.actionUseDataSource)||void 0===w?void 0:w.asMutable({deep:!0})]),isDataSourceDropDownHidden:!0,onChange:this.onActionFieldSelected,useDropdown:!0,selectedFields:this.props.config.actionUseDataSource&&this.props.config.actionUseDataSource.fields?this.props.config.actionUseDataSource.fields:(0,t.Immutable)([])})]}),(0,e.jsx)(a.Icon,{className:"flex-none",width:12,height:40,color:q,icon:u(74587)})]})]}),(0,e.jsxs)(s.SettingRow,{children:[(0,e.jsx)(a.Button,{type:"link",disabled:!this.props.config.actionUseDataSource,className:"w-100 d-flex justify-content-start",onClick:this.showSqlExprPopup,children:(0,e.jsx)("div",{className:"w-100 text-truncate",style:{textAlign:"start"},children:this.props.intl.formatMessage({id:"mapAction_MoreConditions",defaultMessage:f})})}),this.props.config.actionUseDataSource&&(0,e.jsx)(t.DataSourceComponent,{useDataSource:this.props.config.actionUseDataSource,children:a=>(0,e.jsx)(n.SqlExpressionBuilderPopup,{dataSource:a,mode:t.SqlExpressionMode.Simple,isOpen:this.state.isSqlExprShow,toggle:this.toggleSqlExprPopup,expression:this.props.config.sqlExprObj,onChange:e=>{this.onSqlExprBuilderChange(e)}})})]}),(0,e.jsx)(s.SettingRow,{children:(0,e.jsx)("div",{className:"sql-expr-display",children:this.props.config.sqlExprObj&&j?t.dataSourceUtils.getArcGISSQL(this.props.config.sqlExprObj,j).displaySQL:this.props.intl.formatMessage({id:"mapAction_SetExpression",defaultMessage:y})})})]})]})}}B.defaultProps={config:(0,t.Immutable)({useAnyTriggerData:!0,messageUseDataSource:null,actionUseDataSource:null,sqlExprObj:null,enabledDataRelationShip:!0,connectionType:t.MessageActionConnectionType.SetCustomFields})};const V=(0,i.withTheme)(B)})(),d})())}}});