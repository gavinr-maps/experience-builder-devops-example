System.register(["jimu-core","jimu-theme","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/setting-components","jimu-ui"],(function(e,t){var a={},o={},s={},u={},n={};return{setters:[function(e){a.DataSourceManager=e.DataSourceManager,a.Immutable=e.Immutable,a.MessageType=e.MessageType,a.React=e.React,a.ReactRedux=e.ReactRedux,a.jsx=e.jsx},function(e){o.withTheme=e.withTheme},function(e){s.AllDataSourceTypes=e.AllDataSourceTypes,s.DataSourceSelector=e.DataSourceSelector},function(e){u.SettingRow=e.SettingRow,u.SettingSection=e.SettingSection},function(e){n.Label=e.Label,n.Radio=e.Radio}],execute:function(){e((()=>{"use strict";var e={79244:e=>{e.exports=a},1888:e=>{e.exports=o},14321:e=>{e.exports=n},13089:e=>{e.exports=s},79298:e=>{e.exports=u}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,r),s.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};r.r(i),r.d(i,{default:()=>h});var l=r(79244),c=r(1888),d=r(13089);const p=(0,l.Immutable)([d.AllDataSourceTypes.FeatureLayer,d.AllDataSourceTypes.SceneLayer,d.AllDataSourceTypes.BuildingComponentSubLayer,d.AllDataSourceTypes.ImageryLayer,d.AllDataSourceTypes.OrientedImageryLayer,d.AllDataSourceTypes.SubtypeGroupLayer,d.AllDataSourceTypes.SubtypeSublayer]);function S(e){const{widgetId:t,useDataSources:a=(0,l.Immutable)([]),onChange:o}=e,s=l.ReactRedux.useSelector((e=>{var a,o,s,u,n,r;const i=null===(a=e.appStateInBuilder)||void 0===a?void 0:a.appConfig,l=null===(o=null==i?void 0:i.widgets)||void 0===o?void 0:o[t];if((null===(s=null==l?void 0:l.useDataSources)||void 0===s?void 0:s.length)>0)return l.useDataSources;if((null===(u=null==l?void 0:l.useMapWidgetIds)||void 0===u?void 0:u.length)>0){const e=l.useMapWidgetIds[0],t=null===(n=null==i?void 0:i.widgets)||void 0===n?void 0:n[e];if((null===(r=null==t?void 0:t.useDataSources)||void 0===r?void 0:r.length)>0)return t.useDataSources}return null}));let u=(0,l.Immutable)([]),n=(0,l.Immutable)([]);const r=l.DataSourceManager.getInstance();return null==s||s.forEach((e=>{const t=r.getDataSource(e.dataSourceId);t&&(t.type===d.AllDataSourceTypes.WebMap||t.type===d.AllDataSourceTypes.WebScene?u=u.concat([e.dataSourceId]):n=n.concat([t.isDataView?t.getMainDataSource().id:t.id]))})),0===u.length?u=void 0:n=void 0,l.React.useEffect((()=>{const e=(null==s?void 0:s.length)>0?s.map((e=>e.mainDataSourceId)):[],t=a.filter((t=>e.includes(t.dataSourceId)||e.includes(t.mainDataSourceId)||e.includes(t.rootDataSourceId)));t.length<a.length&&o(t.asMutable({deep:!0}))}),[s,o,a]),l.React.createElement(d.DataSourceSelector,{types:p,useDataSources:a,fromRootDsIds:u,fromDsIds:n,mustUseDataSource:!0,isMultiple:!0,isMultipleDataView:!0,hideAddDataButton:!0,hideDataView:!0,hideTypeDropdown:!0,enableToSelectOutputDsFromSelf:!0,onChange:o})}var m=r(79298),g=r(14321);class D extends l.React.PureComponent{constructor(){super(...arguments),this.state={useCustomData:!1},this.handleDataChange=e=>{this.props.onSettingChange({actionId:this.props.actionId,config:{useDataSources:(null==e?void 0:e.length)>0?e:[]}})}}componentDidMount(){var e,t,a;(null===(e=this.props.config)||void 0===e?void 0:e.useDataSources)||this.handleDataChange([]),this.setState({useCustomData:(null===(a=null===(t=this.props.config)||void 0===t?void 0:t.useDataSources)||void 0===a?void 0:a.length)>0})}render(){var e;if(this.props.messageType!==l.MessageType.DataRecordsSelectionChange)return null;const{messageWidgetId:t,config:a}=this.props;return(0,l.jsx)(m.SettingSection,{className:"border-0",title:this.props.intl.formatMessage({id:"messageAction_TriggerData"})},(0,l.jsx)(m.SettingRow,null,(0,l.jsx)("div",null,(0,l.jsx)("div",null,(0,l.jsx)(g.Label,{check:!0,centric:!0},(0,l.jsx)(g.Radio,{name:"useAllData",style:{cursor:"pointer"},value:"all",className:"mr-2",checked:!this.state.useCustomData,onClick:()=>{this.setState({useCustomData:!1})}}),this.props.intl.formatMessage({id:"allDataWithoutCount"}))),(0,l.jsx)("div",{className:"mt-2"},(0,l.jsx)(g.Label,{check:!0,centric:!0},(0,l.jsx)(g.Radio,{name:"useCustomData",style:{cursor:"pointer"},value:"custom",className:"mr-2",checked:this.state.useCustomData,onClick:()=>{this.setState({useCustomData:!0})}}),this.props.intl.formatMessage({id:"custom"}))))),this.state.useCustomData&&(0,l.jsx)(m.SettingRow,{flow:"wrap"},(0,l.jsx)(S,{widgetId:t,useDataSources:(0,l.Immutable)(null!==(e=null==a?void 0:a.useDataSources)&&void 0!==e?e:[]),onChange:this.handleDataChange})))}}const h=(0,c.withTheme)(D);return i})())}}}));