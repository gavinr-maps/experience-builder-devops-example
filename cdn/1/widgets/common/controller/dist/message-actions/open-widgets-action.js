System.register(["jimu-core","jimu-layouts/layout-runtime"],function(e,t){var s={},o={};return{setters:[function(e){s.AbstractMessageAction=e.AbstractMessageAction,s.AppMode=e.AppMode,s.FixedPosition=e.FixedPosition,s.MessageType=e.MessageType,s.WidgetState=e.WidgetState,s.appActions=e.appActions,s.getAppStore=e.getAppStore},function(){}],execute:function(){e((()=>{var e={41496:e=>{"use strict";e.exports=o},79244:e=>{"use strict";e.exports=s}},t={};function i(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var r={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(r),i.d(r,{default:()=>t});var e=i(79244);i(41496);e.FixedPosition.TopRight,document.body;class t extends e.AbstractMessageAction{constructor(){super(...arguments),this.supportedMessageTypes=[e.MessageType.ButtonClick,e.MessageType.DataRecordsSelectionChange],this.supportedMessageTypesInExpressMode=[e.MessageType.ButtonClick],this.getDefaultMessageActionConfig=e=>({widgetIds:[],useDataSources:[]})}filterMessageDescription(t){return(0,e.getAppStore)().getState().appRuntimeInfo.appMode===e.AppMode.Express?this.supportedMessageTypesInExpressMode.includes(t.messageType):this.supportedMessageTypes.includes(t.messageType)}filterMessage(e){return!0}onExecute(t,s){var o,i,r,n,a,d,p,u;let l=null===(i=null===(o=null==s?void 0:s.widgetIds)||void 0===o?void 0:o.asMutable)||void 0===i?void 0:i.call(o);if(!l||0===l.length)return Promise.resolve(!0);let c=!1,g=!1;if(t.type===e.MessageType.DataRecordsSelectionChange){const e=t;if(0===(e.records||[]).length)c=!0;else{const t=e.records[0].dataSource,o=t.id,i=null===(r=t.getMainDataSource())||void 0===r?void 0:r.id,p=null===(n=t.getRootDataSource())||void 0===n?void 0:n.id,u=null===(d=null===(a=null==t?void 0:t.getAssociatedDataSource)||void 0===a?void 0:a.call(t))||void 0===d?void 0:d.id;if(s.useDataSources&&s.useDataSources.length>0){s.useDataSources.some(e=>[o,i,p,u].includes(e.mainDataSourceId))||(g=!0)}}}if(!s||c||g)return Promise.resolve(!0);const v=this.widgetId,f=(0,e.getAppStore)().getState(),S=f.appConfig.widgets[v].config;if(null===(p=null==S?void 0:S.behavior)||void 0===p?void 0:p.onlyOpenOne){const t=null!==(u=f.widgetsRuntimeInfo)&&void 0!==u?u:{},s=Object.keys(t).filter(s=>{const o=t[s];return o.controllerWidgetId===v&&(t=>[e.WidgetState.Opened,e.WidgetState.Active].includes(t.state))(o)});s.length>0&&(0,e.getAppStore)().dispatch(e.appActions.closeWidgets(s)),l.length>1&&(l=l.slice(0,1))}return(0,e.getAppStore)().dispatch(e.appActions.openWidgets(l)),Promise.resolve(!0)}}})(),r})())}}});