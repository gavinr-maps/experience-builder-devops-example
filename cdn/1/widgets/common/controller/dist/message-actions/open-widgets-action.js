System.register(["jimu-core","jimu-layouts/layout-runtime"],(function(e,t){var o={},s={};return{setters:[function(e){o.AbstractMessageAction=e.AbstractMessageAction,o.AppMode=e.AppMode,o.FixedPosition=e.FixedPosition,o.MessageType=e.MessageType,o.WidgetState=e.WidgetState,o.appActions=e.appActions,o.getAppStore=e.getAppStore},function(){}],execute:function(){e((()=>{var e={79244:e=>{"use strict";e.exports=o},41496:e=>{"use strict";e.exports=s}},t={};function i(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var r={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(r),i.d(r,{default:()=>t});var e=i(79244);i(41496);e.FixedPosition.TopRight,document.body;class t extends e.AbstractMessageAction{constructor(){super(...arguments),this.supportedMessageTypes=[e.MessageType.ButtonClick,e.MessageType.DataRecordsSelectionChange],this.supportedMessageTypesInExpressMode=[e.MessageType.ButtonClick]}filterMessageDescription(t){return(0,e.getAppStore)().getState().appRuntimeInfo.appMode===e.AppMode.Express?this.supportedMessageTypesInExpressMode.includes(t.messageType):this.supportedMessageTypes.includes(t.messageType)}filterMessage(e){return!0}onExecute(t,o){var s,i,r,n,a,p;let d=!1,u=!1;if(t.type===e.MessageType.DataRecordsSelectionChange){const e=t;if(0===(e.records||[]).length)d=!0;else{const t=e.records[0].dataSource,a=t.id,p=null===(s=t.getMainDataSource())||void 0===s?void 0:s.id,d=null===(i=t.getRootDataSource())||void 0===i?void 0:i.id,c=null===(n=null===(r=null==t?void 0:t.getAssociatedDataSource)||void 0===r?void 0:r.call(t))||void 0===n?void 0:n.id;if(o.useDataSources&&o.useDataSources.length>0){o.useDataSources.some((e=>[a,p,d,c].includes(e.mainDataSourceId)))||(u=!0)}}}if(!o||d||u)return Promise.resolve(!0);let c=null==o?void 0:o.widgetIds.asMutable();const l=null==o?void 0:o.controllerId,g=(0,e.getAppStore)().getState(),v=g.appConfig.widgets[l].config;if(null===(a=null==v?void 0:v.behavior)||void 0===a?void 0:a.onlyOpenOne){const t=null!==(p=g.widgetsRuntimeInfo)&&void 0!==p?p:{},o=Object.keys(t).filter((o=>{const s=t[o];return s.controllerWidgetId===l&&(t=>[e.WidgetState.Opened,e.WidgetState.Active].includes(t.state))(s)}));o.length>0&&(0,e.getAppStore)().dispatch(e.appActions.closeWidgets(o)),c.length>1&&(c=c.slice(0,1))}return(0,e.getAppStore)().dispatch(e.appActions.openWidgets(c)),Promise.resolve(!0)}}})(),r})())}}}));