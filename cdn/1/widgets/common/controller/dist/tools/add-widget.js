System.register(["jimu-core","jimu-ui","jimu-core/emotion","jimu-ui/advanced/setting-components","jimu-layouts/layout-runtime","jimu-for-builder"],function(e,t){var i={},o={},n={},r={},s={},d={};return{setters:[function(e){i.AppMode=e.AppMode,i.BrowserSizeMode=e.BrowserSizeMode,i.FixedPosition=e.FixedPosition,i.LayoutItemType=e.LayoutItemType,i.React=e.React,i.WidgetType=e.WidgetType,i.appActions=e.appActions,i.css=e.css,i.getAppStore=e.getAppStore,i.i18n=e.i18n},function(e){o.defaultMessages=e.defaultMessages},function(e){n.jsx=e.jsx},function(e){r.WidgetList=e.WidgetList},function(e){s.searchUtils=e.searchUtils,s.utils=e.utils},function(e){d.appBuilderSync=e.appBuilderSync,d.builderAppSync=e.builderAppSync}],execute:function(){e((()=>{var e={4108:e=>{"use strict";e.exports=d},14321:e=>{"use strict";e.exports=o},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},39492:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 0a1.6 1.6 0 0 0-1.6 1.6v4.8H1.6a1.6 1.6 0 1 0 0 3.2h4.8v4.8a1.6 1.6 0 1 0 3.2 0V9.6h4.8a1.6 1.6 0 1 0 0-3.2H9.6V1.6A1.6 1.6 0 0 0 8 0" clip-rule="evenodd"></path></svg>'},41496:e=>{"use strict";e.exports=s},67386:e=>{"use strict";e.exports=n},79244:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=r}},t={};function p(i){var o=t[i];if(void 0!==o)return o.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,p),n.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var i in t)p.o(t,i)&&!p.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.p="";var a={};return p.p=window.jimuConfig.baseUrl,(()=>{"use strict";p.r(a),p.d(a,{default:()=>f});var e=p(79244),t=p(14321),i=p(23662),o=p.n(i),n=p(39492),r=p.n(n),s=p(67386),d=p(79298),l=p(41496),u=p(4108);e.FixedPosition.TopRight,document.body;const c=t=>(t=>{var i,o;const{appConfig:n,browserSizeMode:r}=(0,e.getAppStore)().getState().appStateInBuilder||(0,e.getAppStore)().getState(),s=l.searchUtils.getParentWidgetIdOfContent(n,t,e.LayoutItemType.Widget,r);return"controller"===(null===(o=null===(i=n.widgets[s])||void 0===i?void 0:i.manifest)||void 0===o?void 0:o.name)})(t)?e=>{var t;return"controller"!==(null===(t=null==e?void 0:e.manifest)||void 0===t?void 0:t.name)&&g(e)}:g,g=t=>{var i,o;const n=null==t?void 0:t.itemType,r=null===(i=null==t?void 0:t.manifest)||void 0===i?void 0:i.name;if(n===e.LayoutItemType.Section||["navigator","divider","menu"].includes(r))return!1;const s=(0,e.getAppStore)().getState(),d=(s.appStateInBuilder?s.appStateInBuilder:s).appRuntimeInfo.appMode===e.AppMode.Express,p=null===(o=null==t?void 0:t.manifest)||void 0===o?void 0:o.widgetType;return(!d||!["arcgis-map","controller"].includes(r)&&p!==e.WidgetType.Layout)&&!l.utils.isWidgetPlaceholder(l.utils.getAppConfig(),t)},S=(t,i,o)=>{window.jimuConfig.isBuilder?u.builderAppSync.publishChangeWidgetStatePropToApp({widgetId:t,propKey:i,value:o}):(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(t,i,o))};const v=e.css`
  height: 600px;
  width: 405px;
  >.content {
    height: 100%;
    margin-top: 0 !important;
    padding-top: var(--sys-spacing-4);
    .list-container {
      height: calc(100% - 100px);
    }
  }
`,m=t=>{const i=t.widgetId,o=e.React.useCallback(e=>{S(i,"itemToAdd",e)},[i]),n=c(i);return(0,s.jsx)("div",{css:v,children:(0,s.jsx)(d.WidgetList,{isAccepted:n,onSelect:o})})};class f{constructor(){this.index=4,this.id="conttroller-add-widget1",this.name="conttroller-add-widget2"}getAppState(){const t=(0,e.getAppStore)().getState();return t.appStateInBuilder?t.appStateInBuilder:t}getGroupId(){return"controller-tools"}getTitle(){const i=e.i18n.getIntl("_jimu");return i?i.formatMessage({id:"addWidget",defaultMessage:t.defaultMessages.addWidget}):"Add widget"}getIcon(){return window.jimuConfig.isBuilder?r():o()}visible(){return!0}checked(){if(this.getAppState().browserSizeMode===e.BrowserSizeMode.Small)return this.isOpenInSidePanel}onClick(t){const i=t.layoutItem.widgetId;if(this.getAppState().browserSizeMode===e.BrowserSizeMode.Small){this.isOpenInSidePanel=!this.isOpenInSidePanel;const t=()=>{this.isOpenInSidePanel=!1,((t,i)=>{window.jimuConfig.isBuilder?u.builderAppSync.publishWidgetToolbarStateChangeToApp(t,i):(0,e.getAppStore)().dispatch(e.appActions.widgetToolbarStateChange(t,i))})(i,["controller-add-widget"])};u.appBuilderSync.publishSidePanelToApp({type:"widget",widgetId:i,keepPanel:!0,active:this.isOpenInSidePanel,isItemAccepted:c(i),onSelect:e=>{S(i,"itemToAdd",e)},onClose:t})}}getSettingPanel(t){return this.getAppState().browserSizeMode===e.BrowserSizeMode.Small?null:m}}})(),a})())}}});