/*! For license information please see builder-support.js.LICENSE.txt */
System.register(["jimu-core/emotion","jimu-core","jimu-for-builder","jimu-layouts/layout-runtime","jimu-ui","jimu-theme","jimu-layouts/layout-builder","jimu-core/react","jimu-ui/advanced/setting-components"],function(e,t){var o={},i={},n={},a={},r={},l={},s={},d={},c={};return Object.defineProperty(d,"__esModule",{value:!0}),{setters:[function(e){o.jsx=e.jsx,o.jsxs=e.jsxs},function(e){i.AppMode=e.AppMode,i.BaseVersionManager=e.BaseVersionManager,i.ErrorBoundary=e.ErrorBoundary,i.ExtensionManager=e.ExtensionManager,i.FixedPosition=e.FixedPosition,i.Immutable=e.Immutable,i.LayoutItemType=e.LayoutItemType,i.LayoutType=e.LayoutType,i.React=e.React,i.ReactRedux=e.ReactRedux,i.WidgetManager=e.WidgetManager,i.WidgetState=e.WidgetState,i.WidgetType=e.WidgetType,i.appActions=e.appActions,i.classNames=e.classNames,i.css=e.css,i.focusElementInKeyboardMode=e.focusElementInKeyboardMode,i.getAppStore=e.getAppStore,i.hooks=e.hooks,i.i18n=e.i18n,i.lodash=e.lodash,i.polished=e.polished},function(e){n.appConfigUtils=e.appConfigUtils,n.getAppConfigAction=e.getAppConfigAction},function(e){a.LayoutContext=e.LayoutContext,a.LayoutItemSizeModes=e.LayoutItemSizeModes,a.PageContext=e.PageContext,a.searchUtils=e.searchUtils,a.utils=e.utils},function(e){r.Button=e.Button,r.FloatingPanel=e.FloatingPanel,r.Icon=e.Icon,r.Loading=e.Loading,r.MobilePanel=e.MobilePanel,r.Modal=e.Modal,r.ModalBody=e.ModalBody,r.NavButtonGroup=e.NavButtonGroup,r.Pagination=e.Pagination,r.Popper=e.Popper,r.Tooltip=e.Tooltip,r.defaultMessages=e.defaultMessages,r.hooks=e.hooks,r.styleUtils=e.styleUtils},function(e){l.getBuilderThemeVariables=e.getBuilderThemeVariables,l.getTheme2=e.getTheme2,l.styled=e.styled},function(e){s.CanvasPane=e.CanvasPane,s.DropArea=e.DropArea,s.LayoutItemToolbar=e.LayoutItemToolbar,s.withRnd=e.withRnd},function(e){Object.keys(e).forEach(function(t){d[t]=e[t]})},function(e){c.SortTree=e.SortTree}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=l},4108:e=>{"use strict";e.exports=n},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},4843:(e,t,o)=>{"use strict";o.d(t,{z:()=>m});var i=o(67386),n=o(79244),a=o(19640),r=o(70687),l=o(14321),s=o(17087);const d=(e,t,o)=>n.css`
    position: ${e===t?"relative":"absolute"};
    left: ${(e-t)*(6*o+40)}px;
    transition: all ease 0.3s;
  `,c=e=>{const{lists:t=[],createItem:o,itemLength:a,isOpen:r,reference:c,advancedStyle:u,onClose:p,onMouseDown:v}=e,g=n.hooks.useCheckSmallBrowserSizeMode(),h=3*(g?4:5),[m,f]=n.React.useState(1),y=Math.ceil(t.length/h),w=new Array(y).fill(1).map((e,t)=>t+1),b=e=>{f(e)},x=n.hooks.useLatest(m);n.React.useEffect(()=>{x.current>y&&0!==y&&f(y)},[x,y]);const S=((e,t,o)=>{const i=o?4:5,a=o?n.css`top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important;`:"";return n.css`
    ${a}
    &.modal-dialog {
      width: fit-content;
      margin: 0;
      .modal-content {
        .modal-body {
          padding: 0;
        }
      }
    }
    .popup-more {
      padding: var(--sys-spacing-3);
      display: flex;
      position: relative;
      overflow: hidden;
      .popup-page {
        display: grid;
        max-width: ${e*i}px;
        grid-template-columns: repeat(${t>1||o?i:"auto-fit"}, ${e}px);
        grid-template-rows: repeat(${t>1||o?3:"auto-fit"}, 1fr);
        gap: var(--sys-spacing-2) 0;
        justify-content: center;
      }
    }
    .popup-pagination {
      padding: 0 var(--sys-spacing-3) var(--sys-spacing-2) var(--sys-spacing-3);
      text-align: center;
      .jimu-pagination {
        justify-content: center;
        .jimu-page-number {
          display: none;
        }
      }
      .page-indicator {
        width: 6px;
        height: 6px;
        padding: 0;
        border-radius: 3px;
        border: none;
        background-color: var(--sys-color-action-disabled);
        transition: width ease 0.3s;
        &+.page-indicator {
          margin-left: 8px;
        }
        &.page-current {
          background-color: var(--sys-color-action-selected);
        }
      }
    }
  `})(a,w.length,g),I=n.React.useRef(0),R=n.React.useRef(0),C=(0,i.jsxs)(n.React.Fragment,{children:[(0,i.jsx)("div",{className:"popup-more",css:u,onTouchStart:e=>{1===e.touches.length&&(I.current=e.touches[0].clientX)},onTouchMove:e=>{1===e.touches.length&&(R.current=e.touches[0].clientX)},onTouchEnd:e=>{const t=R.current-I.current;t<-100&&f(e=>e<y?e+1:e),t>100&&f(e=>e>1?e-1:e),I.current=0,R.current=0},onMouseDown:v,children:w.map(e=>{const n=t.slice(h*(e-1),h*e);return(0,i.jsx)("div",{className:"popup-page",css:d(e,m,a),onFocus:()=>{f(e)},children:n.map(e=>o(e,"popup-list-item",p))},e)})}),w.length>1&&(0,i.jsxs)("div",{className:"popup-pagination",children:[g&&w.map(e=>(0,i.jsx)(l.Button,{tabIndex:-1,"aria-hidden":!0,className:(0,n.classNames)("page-indicator",{"page-current":m===e}),onClick:()=>{b(e)}},e)),!g&&(0,i.jsx)(l.Pagination,{variant:"text",current:m,simple:!0,size:"sm",totalPage:w.length,onChangePage:b})]})]});return g?(0,i.jsx)(l.Modal,{className:"popup-more-modal",css:S,isOpen:r,toggle:p,children:(0,i.jsx)(l.ModalBody,{children:C})}):(0,i.jsx)(l.Popper,{className:"popup-more-popper",overflowHidden:!0,css:S,open:r,reference:c,autoFocus:!0,trapFocus:!0,flipOptions:s.yH,shiftOptions:s.ZT,offsetOptions:s.XJ,toggle:p,children:C})};var u=o(50572),p=o(13166),v=o(4651),g=o.n(v),h=o(54657);const m=n.React.forwardRef((e,t)=>{const{vertical:o,alignment:l,space:s,itemStyle:d,lists:v=[],createItem:m,itemLength:f,autoSize:y,advanced:w,className:b,onMouseDown:x}=e,S=((e,t,o,i=r.aL.Center)=>n.css`
    &.root {
      flex-direction: ${e?"column":"row"};
      width: 100%;
      height: 100%;
      ${e?`min-height: ${o}px;`:`min-width: ${o}px;`}
      max-height: 100%;
      max-width: 100%;
      display: flex;
      justify-content: ${"center"===i?"center":"flex-"+i};
      flex-wrap: nowrap;
      align-items: center;
      .popup-list-item {
        &:not(:first-of-type) {
          margin-top: ${e?t+"px":"unset"};
          margin-left: ${e?"unset":t+"px"};
        }
      }
    }
  `)(o,s,f,l),[I,R]=n.hooks.useForwardRef(t),C=(0,a.s)({rootRef:I,lists:v,itemLength:f,autoSize:y,vertical:o,space:s});let j=v,M=[],z=!1;C<v.length&&(j=v.slice(0,C-1),M=v.slice(C-1),z=!0);const[k,A]=n.React.useState(!1),L=n.React.useRef(null),O=n.React.useCallback(e=>{A(t=>{const o="boolean"==typeof e?e:!t;return o||(0,n.focusElementInKeyboardMode)(L.current),o})},[]);n.React.useEffect(()=>{0===M.length&&A(!1)},[M.length]);const T=n.hooks.useTranslation(p.A),$=(0,h.useAdvancedStyle)(d.variant,w);return(0,i.jsxs)("div",{className:(0,n.classNames)("root popup-list-root",b),css:S,ref:R,onMouseDown:x,children:[j.map(e=>m(e,(0,n.classNames)("popup-list-item"))),z&&(0,i.jsx)(u.I,{ref:L,className:"popup-more-card popup-list-item",label:T("moreWidgets"),icon:g(),showLabel:d.showLabel,showIndicator:d.showIndicator,showTooltip:d.showTooltip,labelGrowth:d.labelGrowth,avatar:d.avatar,active:k,onClick:()=>{O()}}),(0,i.jsx)(c,{lists:M,createItem:m,isOpen:k,itemLength:f,reference:L.current,advancedStyle:$,onClose:()=>{O(!1)},onMouseDown:x})]})})},6055:e=>{"use strict";e.exports=s},9567:(e,t,o)=>{"use strict";o.d(t,{FZ:()=>u,GF:()=>r,Jt:()=>l,Q$:()=>d,YC:()=>a,_C:()=>c,jN:()=>s});var i=o(79244),n=o(17087);const a=(e,t)=>"custom"!==e?e||"default":t<=n.ln.sm?"sm":t>n.ln.sm&&t<=n.ln.default?"default":t>n.ln.default?"lg":void 0,r=(e,t)=>"custom"===e?null!=t?t:n.ln.default:n.ln[e],l=(e,t)=>"custom"===e&&null!=t?t:n.UI,s=(e,t)=>{const o="circle"===t;return"sm"===e?o?3:5:"default"===e?o?2:6:"lg"===e?o?4:10:void 0},d=(e,t,o,i)=>{let a=t;o&&(a+=n.nx);return a+=2*s(e,i),a},c=(e,t)=>{var o,i,n,l,s;const c=null==e?void 0:e.showLabel,u=null==e?void 0:e.labelGrowth,p=a(null===(o=null==e?void 0:e.avatar)||void 0===o?void 0:o.size,null===(i=null==e?void 0:e.avatar)||void 0===i?void 0:i.buttonSize),v=r(null===(n=null==e?void 0:e.avatar)||void 0===n?void 0:n.size,null===(l=null==e?void 0:e.avatar)||void 0===l?void 0:l.buttonSize),g=null===(s=null==e?void 0:e.avatar)||void 0===s?void 0:s.shape;return d(p,v,c,g)+t+u},u=e=>{var t,o;if(!e)return;return(null===(o=null===(t=(0,i.getAppStore)().getState().widgetsRuntimeInfo)||void 0===t?void 0:t[e])||void 0===o?void 0:o.isClassLoaded)?Promise.resolve(i.WidgetManager.getInstance().getWidgetClass(e)):i.WidgetManager.getInstance().loadWidgetClass(e)}},12279:(e,t,o)=>{"use strict";o.d(t,{i7:()=>y,GD:()=>d,FZ:()=>c.FZ});var i=o(67386),n=o(79244),a=o(50572),r=o(14321),l=o(62838),s=o.n(l);const d=e=>{var t,o;const{markerEnabled:l,onMarkerClick:d,widgetid:c,showLabel:u,showIndicator:p,showTooltip:v,labelGrowth:g,avatar:h,onClick:m,active:f,editDraggable:y,className:w}=e,b=n.ReactRedux.useSelector(e=>{var t;return null===(t=e.appConfig.widgets)||void 0===t?void 0:t[c]}),x="string"==typeof b.icon?b.icon:b.icon.asMutable({deep:!0});return b?(0,i.jsx)(a.I,{widgetid:c,className:`widget-avatar-card ${w}`,showLabel:u,showIndicator:p,showTooltip:v,labelGrowth:g,avatar:h,label:b.label,icon:x,autoFlip:null===(o=null===(t=null==b?void 0:b.manifest)||void 0===t?void 0:t.properties)||void 0===o?void 0:o.flipIcon,marker:l?s():"",active:f,editDraggable:y,onMarkerClick:d,onClick:m}):(0,i.jsx)(r.Loading,{})};o(42667);var c=o(9567),u=o(49859),p=o.n(u),v=o(1888),g=o(70687);const h=(0,v.styled)("div",{shouldForwardProp:e=>!["vertical","space","alignment"].includes(e)})(e=>`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: ${e.alignment===g.aL.Start?"flex-start":e.alignment===g.aL.End?"flex-end":"center"};\n  flex-direction: ${e.vertical?"column":"row"};\n  .avatar-placeholder {\n    &:not(:first-of-type) {\n      margin-top: ${e.vertical?`${e.space}px`:"unset"};\n      margin-left: ${e.vertical?"unset":`${e.space}px`};\n    }\n  }\n`),m=(e=>{const t=[];for(;e>0;)t.push(e),e--;return t})(3),f=(0,n.Immutable)({type:"secondary",size:"lg",shape:"circle"}),y=e=>{const{vertical:t,space:o,size:r="lg",alignment:l=g.aL.Center,shape:s="circle",buttonSize:d}=e,c=n.React.useMemo(()=>f.set("size",r).set("shape",s).set("buttonSize",d),[r,s,d]);return(0,i.jsx)(h,{className:"list-placeholder",vertical:t,space:o,alignment:l,children:m.map((e,t)=>(0,i.jsx)(a.I,{disabled:!0,className:"avatar-placeholder",icon:p(),label:"",showTooltip:!1,avatar:c},t))})}},13166:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});const i={_widgetLabel:"Widget Controller",_action_openWidget_label:"Open widget",_action_toggleWidget_label:"Toggle widget",resizerTooltip:"Customize the window size by dragging and dropping.",moreWidgets:"More widgets"}},14321:e=>{"use strict";e.exports=r},17087:(e,t,o)=>{"use strict";o.d(t,{D7:()=>u,Gt:()=>n,UI:()=>r,XJ:()=>m,ZT:()=>h,aP:()=>v,bC:()=>a,iI:()=>s,kg:()=>c,ln:()=>d,nx:()=>l,up:()=>p,yH:()=>g});var i=o(79244);const n=5,a="controller",r=16,l=21,s={sm:24,default:32,lg:48},d={sm:26,default:32,lg:40},c={width:150,height:120},u={width:360,height:360},p={x:70,y:70},v={x:30,y:30},g=(i.FixedPosition.TopRight,{flipAlignment:!1}),h={boundary:document.body,rootBoundary:"document"},m=16},19640:(e,t,o)=>{"use strict";o.d(t,{k:()=>r,s:()=>l});var i=o(79244);const n=(e,t=!1,o=0,n=o,a)=>{var r,l;const s=t?"clientHeight":"clientWidth",[d,c]=i.React.useState(null!==(l=null===(r=e.current)||void 0===r?void 0:r[s])&&void 0!==l?l:0),u=a,p=i.hooks.useLatest(()=>{const t=e.current[s]||0;c(t)}),v=i.React.useMemo(()=>i.lodash.debounce(()=>{p.current()},500,{leading:!0}),[p]);return i.React.useEffect(()=>{if(u)return;const t=e.current;t&&v();const o=new ResizeObserver(v);return o.observe(t),()=>{o.disconnect(),v.cancel()}},[e,v,u]),Math.max(d+o,n)},a=(e,t,o)=>{let i=e,n=t;return n-i>o?n=e+o:n-i<o&&(i=0,n=i+o),[i,n]},r=e=>{var t;const{rootRef:o,lists:r,itemLength:l,autoSize:s,vertical:d,space:c,autoScrollEnd:u}=e,p=null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0;let v,g=n(o,d,c,l,s);s?(v=p,g=l*v):v=Math.floor(g/l)>p?p:Math.floor(g/l);const h=g-l*v,[m,f]=i.React.useState(a(0,0,v)[0]),[y,w]=i.React.useState(a(0,0,v)[1]),b=i.hooks.useLatest(m),x=i.hooks.useLatest(y),[S,I]=i.React.useState(y-m>=p),R=0===m,C=y===p;i.React.useEffect(()=>{if(0===g)return;const[e,t]=a(x.current,b.current,v);f(e),w(t),I(t-e>=p)},[v,g,x,b,p]);const j=i.hooks.useEventCallback((e,t=!0)=>{const o=t?1:v;let i=0,n=0;e?(i=m-o,i<0?(i=0,n=i+v):n=y-o):(n=y+o,n>p?(n=p,i=n-v):i=m+o),f(i),w(n)}),M=i.hooks.usePrevious(p);return i.React.useEffect(()=>{if(u&&(p>0&&M>0)&&M<p){let e=0,t=0;t=p,e=t-v,e=Math.max(0,e),f(e),w(t)}},[u,p,v,M]),{start:m,end:y,disablePrevious:R,disableNext:C,hideArrow:S,scroll:j,remainLength:h}},l=e=>{var t;const{rootRef:o,lists:i,itemLength:a,autoSize:r,vertical:l,space:s}=e,d=null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0,c=n(o,l,s,a,r);let u;return u=r||Math.floor(c/a)>d?d:Math.floor(c/a),u}},20863:(e,t,o)=>{"use strict";o.d(t,{A:()=>j});var i=o(67386),n=o(79244),a=o(17087),r=o(28482),l=o(14321),s=o(12279),d=o(41496),c=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};function u(e){const{widgetId:t,canCrossLayoutBoundary:o,className:a,layoutId:u,layoutItemId:p,offPanel:v}=e,g=c(e,["widgetId","canCrossLayoutBoundary","className","layoutId","layoutItemId","offPanel"]),h=n.hooks.useCancelablePromiseMaker(),[m,f]=n.React.useState(null),[y,w]=n.React.useState(""),[b,x]=n.React.useState("");n.React.useEffect(()=>{f(null),w("");h((0,s.FZ)(t)).then(e=>{f(e),w(t)},e=>{var t;x(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)})},[h,t]);const S=n.React.useCallback(()=>{var e,o;if(b)return;if(window.jimuConfig.isBuilder)return;(null===(o=null===(e=(0,n.getAppStore)().getState().widgetsRuntimeInfo)||void 0===e?void 0:e[t])||void 0===o?void 0:o.state)===n.WidgetState.Active||(0,n.getAppStore)().dispatch(n.appActions.activateWidget(t))},[b,t]),I=n.ReactRedux.useSelector(e=>e.appRuntimeInfo.appMode===n.AppMode.Design),R=n.ReactRedux.useSelector(e=>{var o,i,n;const a=e.appConfig.widgets[t];return null!==(n=null===(i=null===(o=null==a?void 0:a.manifest)||void 0===o?void 0:o.properties)||void 0===i?void 0:i.supportInlineEditing)&&void 0!==n&&n}),C=n.ReactRedux.useSelector(e=>{const o=e.widgetsRuntimeInfo[t];return R&&(null==o?void 0:o.isInlineEditing)}),j=n.ReactRedux.useSelector(e=>{var o;const i=e.appConfig.widgets[t];return(null===(o=null==i?void 0:i.manifest)||void 0===o?void 0:o.widgetType)!==n.WidgetType.Layout}),M=n.ReactRedux.useSelector(e=>{var o,i,n;const a=e.appConfig.widgets[t];return(null===(i=null===(o=null==a?void 0:a.manifest)||void 0===o?void 0:o.properties)||void 0===i?void 0:i.hasEmbeddedLayout)&&Object.keys(null!==(n=a.layouts)&&void 0!==n?n:{}).length>0}),z=I&&!C&&j&&!M,{viewOnly:k,builderTheme:A}=n.React.useContext(d.PageContext),L=(0,r.eU)(),O=n.ReactRedux.useSelector(e=>e.appRuntimeInfo.appMode),T=L===t&&!k&&O!==n.AppMode.Run,$=L!==t&&!k&&O===n.AppMode.Design,P=n.React.useCallback(e=>{const{browserSizeMode:o,appConfig:{mainSizeMode:i}}=(0,n.getAppStore)().getState();!R||k||window.parent.isExpressBuilder&&o!==i||(e.stopPropagation(),(0,n.getAppStore)().dispatch(n.appActions.setWidgetIsInlineEditingState(t,!0)))},[R,k,t]),E=(0,n.classNames)("widget-renderer w-100 h-100",a),N=((e,t,o)=>n.React.useMemo(()=>{const i=t?`\n    .widget-tip {\n      display: block;\n      padding: inherit;\n      position: absolute;\n      left: 0;\n      bottom: 0;\n      top: 0;\n      right: 0;\n      pointer-events: none;\n    }\n    .widget-tip.selected {\n      border: 1px solid ${t.sys.color.primary.main};\n    }\n    &:hover > .widget-tip.highlight {\n      border: 2px solid ${t.sys.color.primary.main};\n    }\n    `:"",a=e?"visible":"hidden";return n.css`
      overflow: ${a};
      position: relative;
      .widget-content {
        position: relative;
        height: 100%;
        width: 100%;
        z-index: 0;
        ${o?`border-radius: var(--sys-shape-2); overflow: ${a};`:""}
      }
      .widget-mask {
        position: absolute;
        background: transparent;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        z-index: 1;
      }
      ${i}
    `},[t,e,o]))(o,A,v);return(0,i.jsxs)("div",Object.assign({css:N,className:E,onMouseDownCapture:S,onDoubleClickCapture:P,"data-widgetid":y},g,{children:[(0,i.jsxs)("div",{className:"widget-content p-1",children:[b,!b&&m&&(0,i.jsx)(n.ErrorBoundary,{children:(0,i.jsx)(m,{widgetId:y,layoutId:u,layoutItemId:p})}),!b&&!m&&(0,i.jsx)(l.Loading,{})]}),z&&(0,i.jsx)("div",{className:"widget-mask"}),(T||$)&&(0,i.jsx)("div",{className:(0,n.classNames)("widget-tip",{selected:T,highlight:$})})]}))}const p=(0,n.Immutable)({}),v=e=>{var t,o,a;const{rootVisible:s,containerMapId:d,onClose:c,widgets:v=p,layout:g,onClick:h}=e,m=null!==(t=Object.keys(v).find(e=>(0,r.V5)(v[e])))&&void 0!==t?t:"",f=null===(a=null===(o=(0,n.getAppStore)().getState().appConfig.widgets)||void 0===o?void 0:o[m])||void 0===a?void 0:a.label;return(0,i.jsx)(l.MobilePanel,{className:(0,n.classNames)("mobile-widget-launcher",{"d-none":!m}),mapWidgetId:d,title:f,open:!!m&&s,keepMount:!0,onClick:e=>{h(e,m)},onClose:e=>{c(e,m)},children:Object.entries(v).map(([e,t])=>{if(!(void 0!==t.state))return null;const o=(0,r.V5)(t),a=null==g?void 0:g.id,l=(0,r.pp)(g,e);return(0,i.jsx)(u,{widgetId:e,layoutId:a,layoutItemId:l,onClick:t=>{h(t,e)},className:(0,n.classNames)({"d-none":!o})},e)})})};var g=o(70687),h=o(53716);const m=()=>document.body.getBoundingClientRect(),f=(e,t,o,i,a)=>{const[r,l]=n.React.useState(()=>m()),[s,d]=n.React.useState([o]),c=n.React.useRef(0);n.React.useEffect(()=>{const e=()=>{const e=m();l(e)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);const u=(e,t)=>e.right>=t.right||e.left<=t.left,p=(e,t)=>e.bottom>=t.bottom||e.top<=t.top,v=n.hooks.useEventCallback(t=>{if(c.current++,c.current>7)return console.warn(`Number of cycles: ${c.current}.You may have opened too many panels, and now there is not enough space for them to be placed without overstepping and blocking`),t;const i=((e,t)=>!(!e||!t)&&(u(e,t)||p(e,t)))(t,r);if(!i)return t;const{width:n,height:l}=t;let{left:s,top:d,right:h,bottom:m}=t;if(i){const t=u({left:s,top:d,right:h,bottom:m,width:n,height:l},r),i=p({left:s,top:d,right:h,bottom:m,width:n,height:l},r);t&&(s=e===g.t2.SideBySide?o.x:r.right-n),i||e!==g.t2.SideBySide||(d+=a),h=s+n,m=d+l}return v({left:s,top:d,right:h,bottom:m,width:n,height:l})});return n.React.useEffect(()=>{const n=[];let r={width:0,height:0};Object.keys(t).forEach((l,s)=>{const d=t[l],u=0!==s?n[s-1]:o;let{x:p,y:h}=u;if(e===g.t2.SideBySide){const{width:e}=r;p+=i>0?e:-e,p+=0!==s?i:0}else e===g.t2.Stack&&(p+=0!==s?i:0,h+=0!==s?a:0);const m={left:p,top:h,right:p+d.width,bottom:h+d.height,width:d.width,height:d.height},{left:f,top:y}=v(m);c.current>7?(p=u.x,h=u.y):(p=f,h=y),c.current=0,n.push({x:p,y:h}),r=d}),d(n)},[e,o,i,a,r.width,r.height,v,t]),s},y=(0,n.Immutable)({}),w=e=>{const{rootVisible:t,mode:o,start:s,spaceX:d,spaceY:c,sizes:p,widgets:v=y,layout:g,autoFocus:m,onResizeStop:w,onClick:b,onClose:x}=e,S=n.ReactRedux.useSelector(e=>e.appConfig.widgets),[I,R]=n.React.useState(p),C=n.React.useMemo(()=>((e,t)=>{let o=(0,n.Immutable)({});return Object.keys(e).forEach(e=>{o=o.set(e,t[e]||a.D7)}),o})(v,I),[I,v]),[j,M]=n.React.useState(!1),z=f(o,C,s,d,c),k=n.ReactRedux.useSelector(e=>e.appRuntimeInfo.appMode===n.AppMode.Run),A=(0,i.jsx)(h.Ku,{isRuntime:k,isResizing:j});return(0,i.jsx)(n.React.Fragment,{children:Object.entries(v).map(([e,o],n)=>{var s;if(!(void 0!==o.state))return null;const d=(0,r.V5)(o),c=z[n];if(!c)return null;const p=C[e],v=null===(s=null==S?void 0:S[e])||void 0===s?void 0:s.label,h=null==g?void 0:g.id,f=(0,r.pp)(g,e);return(0,i.jsx)(l.FloatingPanel,{style:{maxWidth:"100vw",position:"fixed",backgroundColor:"var(--sys-color-surface-paper)"},headerTitle:v,defaultPosition:c,defaultSize:p,open:d&&t,keepMount:!0,className:"multiple-widget-launcher",showHeaderClose:!0,showHeaderCollapse:!0,activateOnlyForHeader:!0,autoFocus:d&&m,minSize:a.kg,dragBounds:"body",resizeHandle:A,onClick:t=>{b(t,e)},onResize:t=>{((e,t)=>{R(I.set(e,t)),M(!0)})(e,t)},onResizeStop:t=>{((e,t)=>{null==w||w(e,t),M(!1)})(e,t)},onHeaderClose:t=>{x(t,e)},children:(0,i.jsx)(u,{widgetId:e,layoutId:h,layoutItemId:f})},e)})})},b=(0,n.Immutable)({}),x=e=>{const{widgets:t=b,root:o,placement:s,sizes:d,layout:c,autoFocus:p,onResizeStop:v,onClick:g,onClose:m}=e,f=n.ReactRedux.useSelector(e=>e.appConfig.widgets),[y,w]=n.React.useState(d),[x,S]=n.React.useState(!1),I=n.ReactRedux.useSelector(e=>e.appRuntimeInfo.appMode===n.AppMode.Run),R=(0,i.jsx)(h.Ku,{isRuntime:I,isResizing:x});return(0,i.jsx)(n.React.Fragment,{children:Object.entries(t).map(([e,t])=>{var d,b;if(!(void 0!==t.state))return null;const x=t.state!==n.WidgetState.Closed,I=null!==(d=y[e])&&void 0!==d?d:a.D7,C=null===(b=null==f?void 0:f[e])||void 0===b?void 0:b.label;let j=(0,h.Ht)(e);j&&j.offsetParent||(j=(null==o?void 0:o.querySelector(".popup-more-card"))||(null==o?void 0:o.querySelector(".avatar-card")));const M=null==c?void 0:c.id,z=(0,r.pp)(c,e);return(0,i.jsx)(l.FloatingPanel,{style:{maxWidth:"100vw",backgroundColor:"var(--sys-color-surface-paper)"},flipOptions:a.yH,shiftOptions:a.ZT,offsetOptions:a.XJ,className:"single-widget-launcher",headerTitle:C,activateOnlyForHeader:!0,minSize:a.kg,dragBounds:"body",defaultSize:I,resizeHandle:R,onResize:t=>{var o,i;o=e,i=t,w(e=>e.set(o,i)),S(!0)},onResizeStop:t=>{var o,i;o=e,i=t,null==v||v(o,i),S(!1)},onHeaderClose:t=>{m(t,e)},showHeaderCollapse:!0,open:x,keepMount:!0,autoFocus:x&&p,reference:j,onClick:t=>{g(t,e)},placement:s,children:(0,i.jsx)(u,{widgetId:e,layoutId:M,layoutItemId:z})},e)})})},S=(0,n.Immutable)({}),I=e=>{const{widgets:t=S,root:o,placement:s,layout:d,onClick:c,onClose:p}=e;return(0,i.jsx)(n.React.Fragment,{children:Object.entries(t).map(([e,t])=>{if(!(void 0!==t.state))return null;const v=t.state!==n.WidgetState.Closed;let g=(0,h.Ht)(e);g&&g.offsetParent||(g=(null==o?void 0:o.querySelector(".popup-more-card"))||(null==o?void 0:o.querySelector(".avatar-card")));const m=null==d?void 0:d.id,f=(0,r.pp)(d,e);return(0,i.jsx)(l.Popper,{autoUpdate:!0,css:n.css`
    border-radius: 0;
    max-width: 100vw;
    background: transparent !important;
    box-shadow: none !important;
    border: none !important;
    filter: drop-shadow(0 0 6px rgba(0, 0, 0, .15));
    .widget-content {
      padding: 0 !important;
    }
  `,flipOptions:a.yH,shiftOptions:a.ZT,offsetOptions:a.XJ,className:"off-panel-widget-launcher",open:v,keepMount:!0,autoFocus:v,reference:g,toggle:(t,o)=>{"escape"===o&&p(t,e)},onClick:t=>{c(t,e)},placement:s,children:(0,i.jsx)(u,{widgetId:e,layoutId:m,layoutItemId:f,offPanel:!0})},e)})})};var R=o(54657);const C=e=>n.ReactRedux.useSelector(t=>{var o,i,n,a;const r=t.appConfig,l=t.browserSizeMode,s=r.widgets[e].parent;let c=null!==(o=s[l])&&void 0!==o?o:[];if(0===c.length){c=null!==(i=s[r.mainSizeMode])&&void 0!==i?i:[]}const u=null===(n=c[0])||void 0===n?void 0:n.layoutId,p=d.searchUtils.getWidgetIdThatUseTheLayoutId(r,u),v=r.widgets[p];return"arcgis-map"===(null===(a=null==v?void 0:v.manifest)||void 0===a?void 0:a.name)?v.id:""});function j(e){var t,o,l,s,c,u,p,g,m,f;const{id:y,config:b,version:S,rootRef:j,autoFocus:M=!0,onResizeStop:z}=e,{viewOnly:k}=n.React.useContext(d.PageContext),A=n.hooks.useCheckSmallBrowserSizeMode(),L=null===(t=b.behavior)||void 0===t?void 0:t.onlyOpenOne,O=null!==(l=null===(o=null==b?void 0:b.behavior)||void 0===o?void 0:o.arrangement)&&void 0!==l?l:"floating",T=L&&"floating"===O,$=!L&&"floating"===O,P=(0,r.af)(y,a.bC),E=n.React.useCallback((e,t)=>{var o;e.stopPropagation();const i=new CustomEvent("click");i.composedPath=()=>e.nativeEvent.composedPath(),window.dispatchEvent(i);const a=(0,n.getAppStore)().getState(),l=a.appRuntimeInfo.appMode===n.AppMode.Express,s=a.browserSizeMode!==a.appConfig.mainSizeMode;if(k||l&&s)return;const d=null==P?void 0:P.id,c=(0,r.pp)(P,t),u=null===(o=(0,n.getAppStore)().getState().appRuntimeInfo)||void 0===o?void 0:o.selection;u&&u.layoutId===d&&u.layoutItemId===c||(0,n.getAppStore)().dispatch(n.appActions.selectionChanged({layoutId:d,layoutItemId:c}))},[P,k]),N=n.React.useCallback((e,t)=>{if(!t)return;null==e||e.stopPropagation(),null==e||e.preventDefault(),(0,n.getAppStore)().dispatch(n.appActions.closeWidget(t));const o=(0,h.z_)(t)||(0,h.Sr)(y);(0,n.focusElementInKeyboardMode)(o),(0,n.getAppStore)().dispatch(n.appActions.selectionChanged(null))},[y]),B=C(y),W=(null===(s=b.behavior)||void 0===s?void 0:s.vertical)?"right-start":"bottom-start",D=null===(c=b.behavior)||void 0===c?void 0:c.displayType,F=null===(g=null===(p=null===(u=(0,n.getAppStore)())||void 0===u?void 0:u.getState())||void 0===p?void 0:p.appContext)||void 0===g?void 0:g.isRTL,H=n.React.useMemo(()=>F?Object.assign(Object.assign({},a.up),{x:document.body.clientWidth-a.D7.width-a.up.x}):a.up,[F]),G=n.React.useMemo(()=>F?Object.assign(Object.assign({},a.aP),{x:-a.aP.x}):a.aP,[F]),U=null===(m=b.behavior)||void 0===m?void 0:m.size,V=(0,r.PG)(y,a.bC),_=n.hooks.useLatest(V),K=Object.keys(V),X=(0,r.eU)();n.hooks.useUpdateEffect(()=>{const e=Object.keys(_.current),t=e.filter(e=>(0,r.V5)(_.current[e]));e.includes(X)&&!t.includes(X)&&(0,h.xu)(y,X,t,b.behavior.onlyOpenOne)},[b.behavior.onlyOpenOne,y,X,_]);const Y=n.React.useCallback(()=>{const e=_.current,t=Object.keys(e).filter(t=>(0,r.V5)(e[t]));(0,n.getAppStore)().dispatch(n.appActions.closeWidgets(t))},[_]);n.hooks.useUpdateEffect(()=>{(0,n.getAppStore)().dispatch(n.appActions.resetWidgetsState(K))},[S]);const q=n.ReactRedux.useSelector(e=>e.appRuntimeInfo.currentPageId);n.hooks.useUpdateEffect(()=>{Y()},[q]);const J=n.React.useContext(R.VisibleContext),Z=n.ReactRedux.useSelector(e=>e.appContext.isInBuilder),Q=null===(f=b.behavior)||void 0===f?void 0:f.openStarts;n.React.useEffect(()=>{J?!Z&&(null==Q?void 0:Q.length)>0&&(0,n.getAppStore)().dispatch(n.appActions.openWidgets(Q)):Y()},[Y,Z,Q,J]);const ee=n.ReactRedux.useSelector(e=>{const t=e.appConfig.widgets;return K.filter(e=>A?"controller"===t[e].manifest.name:t[e].offPanel).join(",")},n.ReactRedux.shallowEqual),te=K.filter(e=>!ee.split(",").includes(e)).join(","),oe=n.React.useMemo(()=>V.without.apply(V,te.split(",")),[te,V]),ie=n.React.useMemo(()=>V.without.apply(V,ee.split(",")),[ee,V]);return(0,i.jsxs)(n.React.Fragment,{children:[A&&(0,i.jsx)(v,{containerMapId:B,layout:P,widgets:ie,rootVisible:J,onClick:E,onClose:N}),!A&&T&&(0,i.jsx)(x,{sizes:U,root:j.current,placement:W,widgets:ie,layout:P,autoFocus:M,onResizeStop:z,onClick:E,onClose:N}),!A&&$&&(0,i.jsx)(w,{sizes:U,rootVisible:J,mode:D,start:H,spaceX:G.x,spaceY:G.y,widgets:ie,layout:P,autoFocus:M,onResizeStop:z,onClick:E,onClose:N}),(0,i.jsx)(I,{root:j.current,placement:W,widgets:oe,layout:P,onClick:E,onClose:N})]})}},26189:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 10"><path fill="#B6B6B6" d="M10 2.778V0L0 10h2.778zM10 5.607 5.607 10H10z"></path></svg>'},28482:(e,t,o)=>{"use strict";o.d(t,{H9:()=>g,PG:()=>r,V5:()=>p,af:()=>l,eU:()=>v,lL:()=>s,ne:()=>d,pp:()=>u});var i=o(79244),n=o(41496),a=o(17087);const r=(e,t)=>{const o=i.ReactRedux.useSelector(e=>e.widgetsRuntimeInfo),n=l(e,t),a=c(n);return i.React.useMemo(()=>{const e={};return a.forEach(t=>{var n;const a=null!==(n=null==o?void 0:o[t])&&void 0!==n?n:{isClassLoaded:!1};e[t]=(0,i.Immutable)(a)}),(0,i.Immutable)(e)},[a,o])},l=(e,t)=>i.ReactRedux.useSelector(o=>{var i,a,r,l;const s=null===(r=null===(a=null===(i=o.appConfig.widgets)||void 0===i?void 0:i[e])||void 0===a?void 0:a.layouts)||void 0===r?void 0:r[t],d=o.browserSizeMode,c=o.appConfig.mainSizeMode,u=n.searchUtils.findLayoutId(s,d,c);return null===(l=o.appConfig.layouts)||void 0===l?void 0:l[u]}),s=(e,t)=>{var o,a,r,l;const s=(0,i.getAppStore)().getState(),d=s.appStateInBuilder||s;if(!d)return;const c=d.appConfig,u=d.browserSizeMode,p=null===(r=null===(a=null===(o=c.widgets)||void 0===o?void 0:o[e])||void 0===a?void 0:a.layouts)||void 0===r?void 0:r[t],v=n.searchUtils.findLayoutId(p,u,c.mainSizeMode);return null===(l=c.layouts)||void 0===l?void 0:l[v]},d=e=>{var t,o,i;let n=(null!==(i=null===(o=null===(t=null==e?void 0:e.order)||void 0===t?void 0:t.asMutable)||void 0===o?void 0:o.call(t))&&void 0!==i?i:[]).map(t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]});return n=n.filter(e=>e&&e.id&&e.widgetId&&!e.isPending),n.map(e=>e.id)},c=e=>d(e).map(t=>{var o,i;return null===(i=null===(o=e.content)||void 0===o?void 0:o[t])||void 0===i?void 0:i.widgetId}),u=(e,t)=>{if(null!=(null==e?void 0:e.content)&&t)return Object.keys(e.content).find(o=>e.content[o].widgetId===t)},p=e=>[i.WidgetState.Opened,i.WidgetState.Active].includes(e.state),v=()=>i.ReactRedux.useSelector(e=>{var t,o;const i=e.appRuntimeInfo.selection;return null===(o=null===(t=e.appConfig.layouts[null==i?void 0:i.layoutId])||void 0===t?void 0:t.content)||void 0===o?void 0:o[null==i?void 0:i.layoutItemId].widgetId}),g=e=>{const t=r(e,a.bC),o=Object.keys(t),i=v();return e===i||o.includes(i)}},41496:e=>{"use strict";e.exports=a},42667:(e,t,o)=>{"use strict";o.d(t,{Q:()=>c});var i=o(67386),n=o(79244),a=o(14321),r=o(19640),l=o(70687),s=o(28482);const d=[],c=n.React.forwardRef((e,t)=>{const{controllerId:o,className:c,lists:u=d,createItem:p,vertical:v,itemLength:g,space:h,alignment:m=l.aL.Center,autoScrollEnd:f,autoSize:y,onMouseDown:w}=e,b=n.hooks.useTranslation(a.defaultMessages),[x,S]=n.hooks.useForwardRef(t),{start:I,end:R,disablePrevious:C,disableNext:j,hideArrow:M,scroll:z,remainLength:k}=(0,r.k)({rootRef:x,lists:u,itemLength:g,autoSize:y,vertical:v,space:h,autoScrollEnd:f}),A=u.slice(I,R),L=(({vertical:e,space:t,itemLength:o,autoSize:i,hideArrow:a,alignment:r,remainLength:s})=>n.css`
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    button.previous, button.next {
      flex-shrink: 0;
      display: ${a?"none":"block"};
      &:hover {
        color: var(--sys-color-primary-light);
      }
    }
    ${r!==l.aL.Start||i||e?"":`button.next { transform: translateX(${-s}px); }`}
    ${r===l.aL.Start&&!i&&e?`button.next { transform: translateY(${-s}px); }`:""}
    ${r!==l.aL.End||i||e?"":`button.previous { transform: translateX(${s}px); }`}
    ${r===l.aL.End&&!i&&e?`button.previous { transform: translateY(${s}px); }`:""}
    .root {
      flex-direction: ${e?"column":"row"};
      width: 100%;
      height: 100%;
      ${e?`min-height: ${o}px;`:`min-width: ${o}px;`}
      max-height: ${i?"100%":"calc(100% - 20px)"};
      max-width: ${i?"100%":"calc(100% - 20px)"};
      display: flex;
      justify-content: ${r===l.aL.Start?"flex-start":r===l.aL.End?"flex-end":"center"};
      flex-wrap: nowrap;
      align-items: center;
      .scroll-list-item {
        &:not(:first-of-type) {
          margin-top: ${e?t+"px":"unset"};
          margin-left: ${e?"unset":t+"px"};
        }
      }
    }
`)({vertical:v,space:h,itemLength:g,autoSize:y,hideArrow:M,alignment:m,remainLength:k}),O=(0,s.H9)(o);n.React.useEffect(()=>{O&&((0,n.getAppStore)().dispatch(n.appActions.widgetStatePropChange(o,"hideArrow",M)),(0,n.getAppStore)().dispatch(n.appActions.widgetStatePropChange(o,"disablePrevious",C)),(0,n.getAppStore)().dispatch(n.appActions.widgetStatePropChange(o,"disableNext",j)),(0,n.getAppStore)().dispatch(n.appActions.widgetToolbarStateChange(o,["controller-previous","controller-next"])))},[o,j,C,M,O]),n.React.useEffect(()=>{if(O){const e=n.ExtensionManager.getInstance(),t=e.getExtensionById(`${o}-previous`),i=e.getExtensionById(`${o}-next`);t&&(t.scroll=z),i&&(i.scroll=z)}},[o,O,z]);return(0,i.jsx)(a.NavButtonGroup,{css:L,variant:"text",tag:"div",vertical:v,onChange:e=>{z(e,!0)},disablePrevious:C,disableNext:j,previousAriaLabel:b("previous"),nextAriaLabel:b("next"),className:(0,n.classNames)("scroll-list",c),children:(0,i.jsx)("div",{className:"root scroll-list-root",ref:S,onMouseDown:w,children:u.map(e=>{const t=!A.includes(e);return p(e,(0,n.classNames)("scroll-list-item",{"d-none":t}))})})})})},49859:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M4 4h2v1H4zM8 4h2v1H8zM14 4h-2v1h2zM15 4h1v2h-1zM16 8h-1v2h1zM4 14h1v2H4zM5 6H4v2h1zM4 10h1v2H4zM16 12h-1v2h1zM16 15v1h-2v-1zM12 15h-2v1h2zM6 15h2v1H6z"></path><path fill="#000" fill-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1" clip-rule="evenodd"></path></svg>'},50572:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i=o(67386),n=o(79244),a=o(14321),r=o(9567);const l={none:"0",sm:"0",default:"var(--sys-shape-1)",lg:"var(--sys-shape-2)"},s=n.React.forwardRef((e,t)=>{var o;const{label:s,className:d,showLabel:c,showIndicator:u=!0,showTooltip:p=!0,labelGrowth:v=0,icon:g,marker:h,onClick:m,onMarkerClick:f,avatar:y,autoFlip:w,active:b,editDraggable:x,disabled:S,widgetid:I}=e,R=y.type||"primary",C=(0,r.YC)(y.size,y.buttonSize),j=(0,r.GF)(y.size,y.buttonSize),M=(0,r.Jt)(y.size,y.iconSize),z=y.shape||"circle",k=(e=>{const{size:t,buttonSize:o,showLabel:i,showIndicator:s,shape:d,labelGrowth:c}=e,u=a.hooks.useClassicTheme();return n.React.useMemo(()=>{const e=(0,r.Q$)(t,o,i,d),a=e+c,p=(0,r.jN)(t,d),v="circle"===d?"50%":l[t],g="circle"===d?{sm:-1,default:0,lg:4}[t]:p-6;return n.css`
      display: flex;
      align-items:center;
      flex-direction: column;
      justify-content: ${i?"space-around":"center"};
      width: ${u?n.polished.rem(a):a+"px"} !important;
      height: ${u?n.polished.rem(e):e+"px"};
      .tool-drag-handler {
        cursor: auto;
      }
      .avatar {
        padding: ${p}px;
        position: relative;
        text-align: center;
        &:hover .marker {
          visibility: visible;
        }
        .avatar-button {
          width: ${o}px;
          height: ${o}px;
          border-radius: ${v};
        }
        .avatar-button.disabled {
          color: var(--sys-color-action-disabled-text);
          background-color: var(--sys-color-action-disabled);
          border: 1px solid var(--sys-color-divider-secondary);
        }
        .marker {
          position: absolute;
          right: ${g}px;
          top: ${g}px;
          padding: 0;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          .icon-btn-sizer {
            min-width: .625rem;
            min-height: .625rem;
          }
          visibility: hidden;
        }
      }
      ${s?".avatar.active {\n        .avatar-button, .marker {\n          transform: translateY(-7px);\n        }\n        ::after {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          left: 50%;\n          transform: translateX(-50%);\n          border: 1px solid var(--ref-palette-white);\n          border-radius: 3px;\n          width: 6px;\n          height: 3px;\n          background-color: var(--sys-color-primary-main);\n          box-sizing: content-box;\n        }\n      }":""}
      .avatar-label {
        text-align: center;
        width: 100%;
        min-height: ${u?n.polished.rem(21):"21px"};
        cursor: default;
      }
    `},[t,o,i,d,c,u,s])})({size:C,buttonSize:j,showLabel:c,showIndicator:u,shape:z,labelGrowth:v}),A=l[C],L=(0,i.jsx)(a.Button,{"data-widgetid":I,"aria-label":s,"aria-expanded":b,"aria-haspopup":"dialog",icon:!0,active:b,className:(0,n.classNames)("avatar-button",{disabled:S}),type:R,size:C,style:{borderRadius:"circle"===z?"50%":A},onClick:m,children:(0,i.jsx)(a.Icon,{color:"string"!=typeof g&&(null===(o=g.properties)||void 0===o?void 0:o.color),icon:"string"!=typeof g?g.svg:g,size:M,autoFlip:w})});return(0,i.jsxs)("div",{ref:t,"data-widgetid":I,className:(0,n.classNames)("avatar-card",{active:b},d),css:k,children:[(0,i.jsxs)("div",{className:(0,n.classNames)({"no-drag-action":!x,active:b},"avatar tool-drag-handler"),children:[p?(0,i.jsx)(a.Tooltip,{title:s,style:{pointerEvents:"none"},children:L}):L,h&&(0,i.jsx)(a.Button,{className:"marker",size:"sm",icon:!0,onClick:f,children:(0,i.jsx)(a.Icon,{size:8,icon:h})})]}),c&&(0,i.jsx)("div",{className:(0,n.classNames)("avatar-label text-truncate",{active:b}),children:s})]})})},53716:(e,t,o)=>{"use strict";o.d(t,{Ht:()=>d,Ku:()=>p,Sr:()=>u,xu:()=>g,z_:()=>c});var i=o(67386),n=o(79244),a=o(14321),r=o(28482),l=o(17087),s=o(13166);const d=e=>document.querySelector(`.widget-controller .avatar-card[data-widgetid='${e}']`),c=e=>document.querySelector(`.widget-controller .avatar-card[data-widgetid='${e}'] button`),u=e=>document.querySelector(`[data-widgetid='${e}'] .popup-more-card button`),p=e=>{const{isRuntime:t,isResizing:r}=e,l=n.hooks.useTranslation(s.A),d=o(t?26189:54044);return n.React.useMemo(()=>{const e=(0,i.jsx)("div",{className:"resize-handle d-flex p-1",children:(0,i.jsx)(a.Icon,{icon:d,size:t?10:16,currentColor:!1})});return r||t?e:(0,i.jsx)(a.Tooltip,{title:l("resizerTooltip"),children:e})},[r,t,d,l])},v=(e,t)=>{const o=(0,r.lL)(t,l.bC),i=Object.keys(o.content).find(t=>o.content[t].widgetId===e);(0,n.getAppStore)().dispatch(n.appActions.selectionChanged({layoutId:o.id,layoutItemId:i}))},g=(e,t,o,i,a=!1)=>{i?((0,n.getAppStore)().dispatch(n.appActions.closeWidgets(o)),o.includes(t)||((0,n.getAppStore)().dispatch(n.appActions.openWidget(t)),a&&v(t,e))):o.includes(t)?(0,n.getAppStore)().dispatch(n.appActions.closeWidget(t)):((0,n.getAppStore)().dispatch(n.appActions.openWidget(t)),a&&v(t,e))}},54044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M12 0h4v16H0v-4h12z"></path><path fill="#FFF" d="M13 1h2v14H1v-2h12z"></path></svg>'},54657:(e,t,o)=>{"use strict";o.d(t,{VisibleContext:()=>w,useAdvancedStyle:()=>x});var i=o(67386),n=o(79244),a=o(9567),r=o(70687),l=o(42667),s=o(12279),d=o(17087),c=o(28482),u=o(20863),p=o(53716),v=o(4843);const g=e=>{var t,o,g,h,m,f,y,w;const{id:b,config:x,version:S,autoSize:I}=e,R=null===(t=x.behavior)||void 0===t?void 0:t.onlyOpenOne,C=null===(o=x.behavior)||void 0===o?void 0:o.vertical,j=x.behavior.overflownStyle||r.AH.Arrows,M=null===(g=null==x?void 0:x.appearance)||void 0===g?void 0:g.card,z=(0,a._C)(M,null===(h=null==x?void 0:x.appearance)||void 0===h?void 0:h.space),k=n.hooks.useCheckSmallBrowserSizeMode(),A=n.React.useRef(null),L=(0,c.PG)(b,d.bC),O=Object.keys(L),T=O.filter(e=>(0,c.V5)(L[e])),$=n.React.useCallback(e=>{var t;const o=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid;if(!o)return;const i=!!k||R;T.includes(o)||e.stopPropagation(),(0,p.xu)(b,o,T,i,!0)},[k,R,T,b]),[P,E]=n.React.useState(!1),N=n.React.useCallback((e,t,o)=>{const a=T.includes(e);return(0,i.jsx)(s.GD,{className:`${t} layout-item`,widgetid:e,markerEnabled:!1,active:a,showLabel:M.showLabel,showIndicator:M.showIndicator,showTooltip:M.showTooltip,labelGrowth:M.labelGrowth,avatar:M.avatar,variant:M.variant,onClick:t=>{E(!0),(0,n.getAppStore)().dispatch(n.appActions.widgetStatePropChange(e,"autoFocus",!0)),null==o||o(t),$(t)}},e)},[M,$,T]);return(0,i.jsxs)("div",{className:"controller-runtime w-100 h-100",children:[(0,i.jsx)(u.A,{id:b,config:x,version:S,rootRef:A,autoFocus:P}),j===r.AH.PopupWindow&&(0,i.jsx)(v.z,{ref:A,className:"runtime--popup-list",vertical:C,itemLength:z,space:null===(m=x.appearance)||void 0===m?void 0:m.space,alignment:null===(f=x.behavior)||void 0===f?void 0:f.alignment,autoSize:I,lists:O,createItem:N,itemStyle:M,advanced:x.appearance.advanced}),j===r.AH.Arrows&&(0,i.jsx)(l.Q,{ref:A,controllerId:b,className:"runtime--scroll-list",vertical:C,itemLength:z,space:null===(y=x.appearance)||void 0===y?void 0:y.space,alignment:null===(w=x.behavior)||void 0===w?void 0:w.alignment,autoSize:I,lists:O,createItem:N})]})};var h=o(14321);const m={behavior:{onlyOpenOne:!0,openStarts:[],displayType:"STACK",vertical:!1,size:{}},appearance:{space:0,advanced:!1,card:{showLabel:!1,labelGrowth:10,showTooltip:!0,showIndicator:!1,avatar:{type:"primary",size:"default",shape:"circle"}}}};class f extends n.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"Version manager for release 1.0.0",upgrader:e=>{if(!e)return m;if(e.behavior&&e.appearance)return e;{let o=e;return e.behavior||(o=o.setIn(["behavior","openStarts"],[]),o=o.setIn(["behavior","onlyOpenOne"],e.onlyOpenOne),o=o.setIn(["behavior","displayType"],e.displayType),o=o.setIn(["behavior","vertical"],e.vertical),o=o.setIn(["behavior","size"],e.size),o=o.without(["onlyOpenOne","displayType","size"])),e.appearance||(o=o.setIn(["appearance","advanced"],!1),e.vertical?o=o.setIn(["appearance","space"],e.space):(o=o.setIn(["appearance","space"],0),o=o.setIn(["appearance","card","labelGrowth"],e.space)),o=o.setIn(["appearance","card","showLabel"],e.showLabel),o=o.setIn(["appearance","card","avatar","size"],"SMALL"===(t=e.iconSize)?"sm":"MEDIUM"===t?"default":"LARGE"===t?"lg":t),o=o.setIn(["appearance","card","avatar","shape"],e.iconStyle),o=o.setIn(["appearance","card","avatar","type"],"primary"),o=o.without(["space","showLabel","iconSize","iconStyle","vertical"])),o}var t}},{version:"1.1.0",description:"Version manager for release 1.1.0",upgrader:e=>{var t,o;if(!e)return m;let i=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card;const n=null==i?void 0:i.variants,a=null===(o=null==i?void 0:i.avatar)||void 0===o?void 0:o.type;let r=e;if(n){const e=((e,t="primary")=>null==e?void 0:e[t])(n,a);i=null==i?void 0:i.set("variant",e).without("variants"),r=r.setIn(["appearance","card"],i)}return r}},{version:"1.6.0",description:"Version manager for release 1.6.0",upgrader:e=>{var t;if(!e)return m;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,i=e;return o&&(o=o.set("showTooltip",!0),i=i.setIn(["appearance","card"],o)),i}},{version:"1.14.0",description:"Version manager for release 1.14.0",upgrader:e=>{var t;if(!e)return m;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,i=e;return o&&(o=o.set("showIndicator",!1),i=i.setIn(["appearance","card"],o)),i}},{version:"1.19.0",description:"Version manager for release 1.19.0",upgrader:e=>{if(!e)return m;let t=e;return["default","hover","active"].forEach(e=>{var o,i,n,a;const r=null===(a=null===(n=null===(i=null===(o=null==t?void 0:t.appearance)||void 0===o?void 0:o.card)||void 0===i?void 0:i.variant)||void 0===n?void 0:n[e])||void 0===a?void 0:a.boxShadow;if((e=>{const{color:t,offsetX:o,offsetY:i,blur:n,spread:a}=e||{};return t&&(!o||!i||!n)&&(i||n||a)})(r)){const o=(e=>{const{color:t,offsetX:o,offsetY:i,blur:n,spread:a}=e||{},r=[o,i,n,a].filter(e=>!!e);return{color:t,offsetX:r[0],offsetY:r[1],blur:r[2],spread:r[3]}})(r);t=t.setIn(["appearance","card","variant",e,"boxShadow"],o)}}),t}}]}}const y=new f,w=n.React.createContext(!0),b=(e,t)=>{const{bg:o,iconColor:i,boxShadow:a,color:r,italic:l,bold:s,underline:d,strike:c}=e||{},u=h.styleUtils.toCSSTextUnderLine({underline:d,strike:c});let p;if(a&&(null==a?void 0:a.color)){const{offsetX:e="0",offsetY:t="0",blur:o="0",spread:i="0"}=a;p={offsetX:e,offsetY:t,blur:o,spread:i,color:null==a?void 0:a.color}}let v=n.css``;return"active"===t&&(v=n.css`::after {
      background-color: ${o};
    }`),n.css`
    >.avatar {
      >.avatar-button {
        ${o?n.css`background-color: ${o}; border-color: ${o};`:""}
        ${i?n.css`color: ${i};`:""}
        ${(null==p?void 0:p.color)?n.css`box-shadow: ${h.styleUtils.toCSSBoxshadow(p)};`:""}
      }
      ${v}
    }
    >.avatar-label {
      ${r?n.css`color: ${r};`:""}
      ${l?n.css`font-style: italic;`:""}
      ${s?n.css`font-weight: bold;`:""}
      ${d||c?n.css`text-decoration: ${u};`:""}
    }
  `},x=(e,t)=>{const o=null==e?void 0:e.default,i=null==e?void 0:e.active,a=o&&i?o.merge(i):i,r=null==e?void 0:e.hover,l=o&&r?o.merge(r):r;return n.React.useMemo(()=>{const e=t&&o?b(o,"regular"):"",i=b({bg:"var(--sys-color-primary-dark)"},"active"),r=t&&a?b(a,"active"):"",s=t&&l?b(l,"hover"):"";return n.css`
      .avatar-card {
        ${e}
        ${n.css`&.active:not(.disabled) { ${i} }`}
        ${r?n.css`&.active:not(.disabled) { ${r} }`:""}
        ${s?n.css`&:hover { ${s} }`:""}
      }
    `},[t,o,a,l])},S=e=>{var t,o,a,r;const{builderSupportModules:l,id:s,config:c,onInitResizeHandler:u,onInitDragHandler:p,autoWidth:v,autoHeight:h,controllerWidgetId:m,state:f}=e,y=null===(t=c.behavior)||void 0===t?void 0:t.onlyOpenOne,b=null===(o=c.behavior)||void 0===o?void 0:o.displayType,S=null===(a=null==c?void 0:c.behavior)||void 0===a?void 0:a.vertical,I=null==c?void 0:c.appearance.advanced,R=null===(r=null==c?void 0:c.appearance)||void 0===r?void 0:r.card.variant,C=!!m||v,j=!!m||h,M=S?j:C,z=m?f===n.WidgetState.Opened:f!==n.WidgetState.Hidden,k=n.ReactRedux.useSelector(e=>e.appContext.isInBuilder),A=n.ReactRedux.useSelector(e=>e.appRuntimeInfo.appMode);n.React.useEffect(()=>{null==u||u(null,null,()=>{$(e=>e+1)})},[u]),n.React.useEffect(()=>{null==p||p(null,null,()=>{$(e=>e+1)})},[p]);const L=k&&A!==n.AppMode.Run,O=L&&l.widgetModules.Builder,[T,$]=n.React.useState(0);n.hooks.useUpdateEffect(()=>{$(e=>e+1)},[y,b,A]);const P=((e,t,o)=>{const i=e?0:d.iI.sm,a=e?0:d.iI.sm,r=t?"5px":0,l=o?"5px":0;return n.React.useMemo(()=>n.css`
      overflow: visible;
      white-space: nowrap;
      .controller-container {
        width: 100%;
        height: 100%;
        padding: ${l} ${r};
        min-width:  ${i}px;
        min-height: ${a}px;
      }
    `,[r,l,i,a])})(M,C,j),E=x(R,I);return(0,i.jsx)("div",{className:"widget-controller jimu-widget rw-controller",css:[P,E],children:(0,i.jsx)("div",{className:"controller-container",children:(0,i.jsxs)(w.Provider,{value:z,children:[!L&&(0,i.jsx)(g,{id:s,version:T,config:c,autoSize:M}),L&&O&&(0,i.jsx)(O,{id:s,version:T,config:c,autoSize:M})]})})})};S.versionManager=y},56037:(e,t,o)=>{"use strict";o(85160)},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},67386:e=>{"use strict";e.exports=o},68972:e=>{"use strict";e.exports=d},70687:(e,t,o)=>{"use strict";var i,n,a;o.d(t,{AH:()=>a,aL:()=>n,t2:()=>i}),function(e){e.Stack="STACK",e.SideBySide="SIDEBYSIDE"}(i||(i={})),function(e){e.Center="center",e.Start="start",e.End="end"}(n||(n={})),function(e){e.Arrows="ARROWS",e.PopupWindow="POPUP_WINDOW"}(a||(a={}))},79244:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=c},85160:(e,t,o)=>{"use strict";var i=o(68972);var n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=i.useSyncExternalStore,r=i.useRef,l=i.useEffect,s=i.useMemo,d=i.useDebugValue}},t={};function u(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,u),n.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var o in t)u.o(t,o)&&!u.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var p={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(p),u.d(p,{default:()=>U});var e=u(67386),t=u(79244),o=u(17087),i=u(4108),n=u(28482),a=u(12279),r=u(42667),l=u(9567),s=u(41496),d=u(6055);const c={gap:10,padding:{number:[0],unit:"px"},header:{borderTop:{type:"solid",color:"var(--sys-color-primary-main)",width:"2px"},expandIcon:{svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>',properties:{filename:"expand.svg",size:16,color:"var(--sys-color-surface-overlay-text)",inlineSvg:!0}},collapseIcon:{svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .54.54 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.54.54 0 0 1 0 .738" clip-rule="evenodd"></path></svg>',properties:{filename:"collapse.svg",size:16,color:"var(--sys-color-surface-overlay-text)",inlineSvg:!0}},showWidgetIcon:!1,widgetIconSize:16,widgetIconColor:"var(--sys-color-surface-overlay-text)",textStyle:{bold:!0,color:"var(--sys-color-surface-overlay-text)",size:"14px"},padding:{number:[0],unit:"px"},borderRadius:{number:[0],unit:"px"},collapsedColor:"rgba(0,0,0,0)",expandedColor:"rgba(0,0,0,0)"},panel:{backgroundColor:"rgba(0,0,0,0)",borderRadius:{number:[0],unit:"px"},padding:{number:[0],unit:"px"},border:{color:"var(--sys-color-primary-main)",type:"solid",width:"0px"}},singleMode:!1,showToggleAll:!1,useQuickStyle:3};var v=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function r(e){try{s(i.next(e))}catch(e){a(e)}}function l(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,l)}s((i=i.apply(e,t||[])).next())})};const g=e=>(e=>{var o,i;const{appConfig:n,browserSizeMode:a}=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState(),r=s.searchUtils.getParentWidgetIdOfContent(n,e,t.LayoutItemType.Widget,a);return"controller"===(null===(i=null===(o=n.widgets[r])||void 0===o?void 0:o.manifest)||void 0===i?void 0:i.name)})(e)?e=>{var t;return"controller"!==(null===(t=null==e?void 0:e.manifest)||void 0===t?void 0:t.name)&&h(e)}:h,h=e=>{var o,i;const n=null==e?void 0:e.itemType,a=null===(o=null==e?void 0:e.manifest)||void 0===o?void 0:o.name;if(n===t.LayoutItemType.Section||["navigator","divider","menu"].includes(a))return!1;const r=(0,t.getAppStore)().getState(),l=(r.appStateInBuilder?r.appStateInBuilder:r).appRuntimeInfo.appMode===t.AppMode.Express,d=null===(i=null==e?void 0:e.manifest)||void 0===i?void 0:i.widgetType;return(!l||!["arcgis-map","controller"].includes(a)&&d!==t.WidgetType.Layout)&&!s.utils.isWidgetPlaceholder(s.utils.getAppConfig(),e)},m=(e,o,n)=>v(void 0,void 0,void 0,function*(){const a=(0,i.getAppConfigAction)(),r=yield f(a,e,o,n);if(e.type===t.LayoutType.AccordionLayout){x(a,e.parent.id,[r])}return a.exec(),r}),f=(e,o,n,a)=>v(void 0,void 0,void 0,function*(){const r=n.layoutInfo;let l;if(r&&r.layoutId&&r.layoutItemId){const a=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!a)return;const r=a.browserSizeMode;let s;s=n.isFromCurrentSizeMode?r:i.appConfigUtils.getSizeModeOfALayout(e.appConfig,n.layoutInfo.layoutId),l=e.moveLayoutItem(n.layoutInfo,o.id,s,r)}else if(n.uri){const t=yield e.addNewWidgetToLayout(o.id,{uri:n.uri,itemId:n.itemId},!0);l={layoutId:o.id,layoutItemId:t}}return e.adjustOrderOfItem(l,a||0,!0),e.editLayoutItemProperty(l,"bbox",{},!0),e.editLayoutItemProperty(l,"setting",{},!0),l}),y=(e,o)=>{var n,a,r,l,s,d,c,u;const p=(0,i.getAppConfigAction)();p.removeLayoutItem(e,!0,!0);const{layoutId:v,layoutItemId:g}=e;if(o){const e=null===(n=p.appConfig.widgets[o])||void 0===n?void 0:n.config,t=null===(l=null===(r=null===(a=p.appConfig.layouts[v])||void 0===a?void 0:a.content)||void 0===r?void 0:r[g])||void 0===l?void 0:l.widgetId;if(Array.isArray(null===(s=null==e?void 0:e.behavior)||void 0===s?void 0:s.openStarts)&&e.behavior.openStarts.includes(t)){const i=e.setIn(["behavior","openStarts"],e.behavior.openStarts.filter(e=>e!==t));p.editWidgetConfig(o,i)}}p.exec();const h=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!h)return;const m=h.appRuntimeInfo.selection;if(!m||(null==m?void 0:m.layoutId)===e.layoutId&&(null==m?void 0:m.layoutItemId)===e.layoutItemId){const e=null===(u=null===(c=null===(d=h.appConfig.widgets[o])||void 0===d?void 0:d.parent)||void 0===c?void 0:c[h.browserSizeMode])||void 0===u?void 0:u[0];(0,t.getAppStore)().dispatch(t.appActions.selectionChanged(e))}},w=(e,o)=>{var i,n;if(!e||!o)return null;return{id:e.id,layoutInfo:o,itemType:t.LayoutItemType.Widget,manifest:null===(i=e.manifest)||void 0===i?void 0:i.asMutable({deep:!0}),icon:"string"==typeof e.icon?e.icon:null===(n=e.icon)||void 0===n?void 0:n.asMutable({deep:!0}),label:e.label}},b=(e,o,i,n,a)=>v(void 0,void 0,void 0,function*(){var r,l,s,d,c,u,p;const v={name:"accordion",label:"Group",uri:"widgets/layout/accordion/",icon:null,itemType:t.LayoutItemType.Widget,manifest:{widgetType:t.WidgetType.Layout,properties:{}}},g=yield f(e,o,v,a),h=null===(s=null===(l=null===(r=e.appConfig.layouts[o.id])||void 0===r?void 0:r.content)||void 0===l?void 0:l[g.layoutItemId])||void 0===s?void 0:s.widgetId,m=function(e,t){const o=Object.values((null==t?void 0:t.content)||{}).map(e=>e.widgetId),i=null==e?void 0:e.widgets,n=Object.values(i||{}).filter(e=>o.includes(e.id)&&"widgets/layout/accordion/"===e.uri).map(e=>e.label);return n}(e.appConfig,o),y=t.i18n.getIntl(),w=y?y.formatMessage({id:"groupLabel",defaultMessage:"Group"}):"Group";e.editWidgetProperty(h,"label",function(e,t="Group"){const o=new RegExp(`${t} [0-9]+`),i=e.filter(e=>o.test(e)),n=/\d+/,a=i.map(e=>{var t;return parseInt(null===(t=n.exec(e))||void 0===t?void 0:t[0])}),r=a.sort((e,t)=>t-e)[0]||0;return`${t} ${r+1}`}(m,w)),e.adjustOrderOfItem(g,a,!0);const b=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!b)return;const S=b.browserSizeMode,I=null===(p=null===(u=null===(c=null===(d=e.appConfig.widgets)||void 0===d?void 0:d[h])||void 0===c?void 0:c.layouts)||void 0===u?void 0:u.DEFAULT)||void 0===p?void 0:p[S],R=e.appConfig.layouts[I],C=yield f(e,R,n,0),j=yield f(e,R,i,1);x(e,h,[C,j])});function x(e,t,o){var i,n,a,r,l,d,u;const p=e.appConfig,v=(null===(n=null===(i=p.widgets[t].config)||void 0===i?void 0:i.asMutable)||void 0===n?void 0:n.call(i,{deep:!0}))||{};let g=v;3!==v.useQuickStyle&&(g=c);const h=v.expandedItems||[],m=[];for(const t of o){const{layoutId:o,layoutItemId:i}=t,n=null===(l=null===(r=null===(a=p.layouts[o])||void 0===a?void 0:a.content)||void 0===r?void 0:r[i])||void 0===l?void 0:l.widgetId,c=p.widgets[n];n&&m.push(n),(null===(d=c.manifest.properties)||void 0===d?void 0:d.supportAutoSize)?e.editLayoutItemProperty(t,"setting.autoProps.height",s.LayoutItemSizeModes.Auto,!0):(null===(u=c.manifest.defaultSize)||void 0===u?void 0:u.height)?e.editLayoutItemProperty(t,"bbox",{height:c.manifest.defaultSize.height+"px"},!0):e.editLayoutItemProperty(t,"bbox",{height:"300px"},!0)}g.expandedItems=h.concat(m),e.editWidgetConfig(t,g)}const S=t.React.forwardRef((o,i)=>{const{layout:n,layouts:a,vertical:r,childClass:l,placeholder:c,className:u}=o,{color:p,size:[v,g]}=c,h=t.React.useRef(null),f=t.React.useRef(null),y=t.React.useRef(null),w=t.React.useRef(null),b=t.React.useRef(null),[x,S]=t.React.useState(!1),I=t.hooks.useForkRef(h,i),R=t.css`
    width: 100%;
    height: 100%;
    position: absolute;
    left: 0;
    bottom: 0;
    top: 0;
    right: 0;
    background: transparent;
    z-index: ${x?1:0};
    > .drop-area {
      width: 100%;
      height: 100%;
    }
    > .overlay {
      position: absolute;
      left: 0;
      bottom: 0;
      top: 0;
      right: 0;
      background: transparent;
      z-index: -1;
      &.hide {
        display: none;
      }
    }
  `;t.React.useEffect(()=>{f.current=new d.CanvasPane(b.current)},[]);return(0,e.jsxs)("div",{className:(0,t.classNames)("drop-zone",u),ref:I,css:R,children:[(0,e.jsx)(d.DropArea,{style:R,className:"drop-area",layouts:a,highlightDragover:!0,onDragOver:(e,t,o,i,n,a)=>{let l=i;const s=w.current,d=h.current.offsetHeight,c=h.current.offsetWidth;if(s&&s.length)if(r){const{insertY:e,refId:t}=((e,t,o)=>{let i,n,a=!1;if(t.some((e,r)=>{if(e.top+e.height/2>o){if(0===r)i=e.top;else{const o=t[r-1];i=(e.top+o.top+o.height)/2}a=!0,n=e.id}return a}),!a){const e=t[t.length-1];i=e.top+e.height}return{insertY:i,refId:n}})(0,s,a);y.current=t,l={top:e-g/2+h.current.scrollTop,width:v,left:(c-v)/2+h.current.scrollLeft,height:g}}else{const{insertX:e,refId:t}=((e,t,o)=>{let i,n,a=!1;if(t.some((e,r)=>{if(e.left+e.width/2>o){if(0===r)i=e.left;else{const o=t[r-1];i=(e.left+o.left+o.width)/2}a=!0,n=e.id}return a}),!a){const e=t[t.length-1];i=e.left+e.width}return{insertX:i,refId:n}})(0,s,n);y.current=t,l={left:e-g/2+h.current.scrollLeft,width:g,top:(d-v)/2+h.current.scrollTop,height:v}}else l=r?{top:o.height/2-g/2,width:v,left:(c-v)/2+h.current.scrollLeft,height:g}:{left:o.width/2-g/2,width:g,top:(d-v)/2+h.current.scrollTop,height:v};f.current.clear(),f.current.setColor(p),f.current.drawRect(l)},onDrop:(e,t,o)=>{f.current.clear();let i=0;y.current?i=n.order&&n.order.indexOf(y.current)||0:n.order&&(i=n.order.length),m(n,e,i),y.current=null,w.current=[]},onToggleDragoverEffect:e=>{e&&(y.current=null,(()=>{w.current=[];const e=h.current.getBoundingClientRect(),t=h.current.parentNode.querySelectorAll(`.${l}`);t&&t.length&&t.forEach(t=>{const o=t.getAttribute("data-layoutitemid");if(n.order&&n.order.includes(o)){const i=s.utils.relativeClientRect(t.getBoundingClientRect(),e);i.id=o,w.current.push(i)}}),r?w.current.sort((e,t)=>e.top-t.top):w.current.sort((e,t)=>e.left-t.left)})(),f.current.setSize(h.current.clientWidth,h.current.clientHeight)),S(e)}}),(0,e.jsx)("canvas",{className:(0,t.classNames)("overlay",{hide:!x}),ref:b})]})}),I=(0,d.withRnd)(!1)(a.GD),R=o=>{const{className:i,draggable:n,layoutId:a,layoutItem:r,onClick:l,showLabel:s,showIndicator:d,showTooltip:c,labelGrowth:u,markerEnabled:p,avatar:v,active:g,removeWidget:h}=o;return(0,e.jsx)(I,{className:(0,t.classNames)(i,"layout-item","align-items-center"),layoutId:a,layoutItem:r,widgetid:r.widgetId,layoutItemId:r.id,markerEnabled:p,showLabel:s,showIndicator:d,showTooltip:c,labelGrowth:u,avatar:v,active:g,editDraggable:n,useDragHandler:!0,onClick:l,onMarkerClick:()=>{h(r.widgetId)}})};var C=u(1888),j=u(70687),M=u(4843);const z=t.React.forwardRef((i,a)=>{const{controllerId:d,draggable:c,itemStyle:u,vertical:p,className:v,space:h,alignment:m,overflownStyle:f=j.AH.Arrows,onItemClick:w,markerEnabled:b=!0,autoSize:x,advanced:I,placeholder:z,onMouseDown:k}=i,A=t.ReactRedux.useSelector(e=>{var t,i,n;return null===(n=null===(i=null===(t=e.appConfig.widgets)||void 0===t?void 0:t[d])||void 0===i?void 0:i.layouts)||void 0===n?void 0:n[o.bC]}),L=(0,n.af)(d,o.bC),O=(0,n.ne)(L),T=(0,C.getBuilderThemeVariables)(),$=(0,n.PG)(d,o.bC),P=Object.keys($).filter(e=>(0,n.V5)($[e])),E=(0,l._C)(u,h),N={color:t.polished.rgba(null==T?void 0:T.sys.color.primary.light,.5),size:[E,o.Gt]},B=(o,i,n,a)=>{const r=L.content[o],l=r&&r.widgetId||"",s=P.includes(l);return(0,e.jsx)(R,{className:(0,t.classNames)(`layout-${null==L?void 0:L.id}-item layout-item`,i),layoutId:L.id,layoutItemId:o,draggable:c&&!a,markerEnabled:b,layoutItem:r,active:s,showLabel:u.showLabel,showIndicator:u.showIndicator,showTooltip:u.showTooltip,labelGrowth:u.labelGrowth,avatar:u.avatar,removeWidget:()=>{y({layoutId:L.id,layoutItemId:o},d)},onClick:e=>{null==n||n(e),null==w||w(e)}},o)},W=g(d);return L&&(0,e.jsx)(s.LayoutContext.Provider,{value:{isItemAccepted:W},children:(0,e.jsxs)("div",{ref:a,className:(0,t.classNames)(v,"layout controller-layout w-100 h-100 d-flex align-items-center justify-content-center"),"data-layoutid":L.id,children:[(0,e.jsx)(S,{vertical:p,layout:L,childClass:`layout-${L.id}-item`,placeholder:N,layouts:A}),!z&&f===j.AH.PopupWindow&&(0,e.jsx)(M.z,{className:"popup-list",vertical:p,space:h,itemStyle:u,alignment:m,lists:O,createItem:B,itemLength:E,autoSize:x,advanced:I,onMouseDown:k}),!z&&f===j.AH.Arrows&&(0,e.jsx)(r.Q,{controllerId:d,autoSize:x,className:"layout-item-list",vertical:p,itemLength:E,space:h,alignment:m,lists:O,autoScrollEnd:!0,createItem:B,onMouseDown:k}),z]})})});var k=u(20863);u(68972),u(56037);function A(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function L(e,t){if(A(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(let i=0;i<o.length;i++)if(!Object.prototype.hasOwnProperty.call(t,o[i])||!A(e[o[i]],t[o[i]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;"undefined"!=typeof globalThis&&globalThis;const O={rootBoundary:"viewport",crossAxis:!0},T={boundary:document.body,fallbackPlacements:["top-start","bottom-start"]};function $(i){const{id:a}=i,{layoutId:r,layoutItem:l}=t.ReactRedux.useSelector(e=>{var t;const i=null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.selection,r=(0,n.lL)(a,o.bC);let l,s;return i&&i.layoutId===r.id&&r.content[i.layoutItemId]&&(l=i.layoutId,s=r.content[i.layoutItemId]),{layoutId:l,layoutItem:s}},L),[s,c]=t.React.useState(null);t.React.useEffect(()=>{if(r&&l){let e=0;const t=setInterval(()=>{e++;const o=document.querySelector(`.single-widget-launcher:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`)||document.querySelector(`.multiple-widget-launcher:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`)||document.querySelector(`.mobile-panel-popper:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`)||document.querySelector(`.off-panel-widget-launcher:has(.widget-renderer[data-widgetid=${null==l?void 0:l.widgetId}])`);c(o),(e>=20||o)&&clearInterval(t)},100)}else c(null)},[r,l]);const u=t.hooks.useTranslation();return r&&l&&s&&(0,e.jsx)("div",{onClick:e=>{e.stopPropagation()},children:(0,e.jsx)(d.LayoutItemToolbar,{layoutId:r,layoutItem:l,refElement:s,shiftOptions:O,flipOptions:T,builderTheme:(0,C.getTheme2)(),formatMessage:u,showDefaultTools:!1},r+l.id)})}var P=u(53716),E=function(e,t,o,i){return new(o||(o=Promise))(function(n,a){function r(e){try{s(i.next(e))}catch(e){a(e)}}function l(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,l)}s((i=i.apply(e,t||[])).next())})};const N=(e,i)=>{const a=t.React.useCallback(t=>E(void 0,void 0,void 0,function*(){var a,r;const l=(0,n.lL)(e,o.bC),s=null!==(r=null===(a=l.order)||void 0===a?void 0:a.length)&&void 0!==r?r:0;try{const e=yield m(l,t,s);i(e)}catch(e){console.error("Failed to add widget")}}),[e,i]),r=t.ReactRedux.useSelector(t=>{var o;return null===(o=t.widgetsState[e])||void 0===o?void 0:o.itemToAdd});t.React.useEffect(()=>{r&&(a(r),(0,t.getAppStore)().dispatch(t.appActions.widgetStatePropChange(e,"itemToAdd",null)))},[e,r,a])};var B=u(79298);const W=(e,t,o)=>{var i;return null===(i=e[o.widgetId])||void 0===i?void 0:i.label},D=(e,t)=>`${t.widgetId||""},${e},${t.id}`,F=e=>{var o,i,n,a,r,l,s;const{draggingItemJsons:d,targetItemJsons:c,dropType:u}=e,p=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!p)return!1;const v=p.appConfig.widgets,[g]=d[0].itemKey.split(","),h=v[g],[m]=null===(n=null===(i=null===(o=null==c?void 0:c[1])||void 0===o?void 0:o.itemKey)||void 0===i?void 0:i.split)||void 0===n?void 0:n.call(i,","),f=v[m];return("to-inside"!==u||"accordion"!==(null===(a=null==h?void 0:h.manifest)||void 0===a?void 0:a.name)&&"accordion"!==(null===(r=null==f?void 0:f.manifest)||void 0===r?void 0:r.name))&&(!["to-top","to-bottom"].includes(u)||"accordion"!==(null===(l=null==h?void 0:h.manifest)||void 0===l?void 0:l.name)||"accordion"!==(null===(s=null==f?void 0:f.manifest)||void 0===s?void 0:s.name))},H=(e,a)=>{var r,l,s,d,c,u,p,g,h;const{dragItemJsons:f,dragItemIndex:y,itemJsons:x,dropType:S,targetDropItemIndex:I}=a,R=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!R)return;const C=R.appConfig.widgets,j=(0,n.lL)(e,o.bC),[M,z,k]=f[0].itemKey.split(","),A={layoutId:z,layoutItemId:k},L=C[M],[O,T,$]=x[0].itemKey.split(","),P={layoutId:T,layoutItemId:$},E=C[O],N=w(L,A),B=w(E,P),[W]=null===(s=null===(l=null===(r=null==f?void 0:f[1])||void 0===r?void 0:r.itemKey)||void 0===l?void 0:l.split)||void 0===s?void 0:s.call(l,","),[D]=null===(u=null===(c=null===(d=null==x?void 0:x[1])||void 0===d?void 0:d.itemKey)||void 0===c?void 0:c.split)||void 0===u?void 0:u.call(c,","),F=C[D];if("to-inside"===S&&N&&B){const e=null!==(g=null===(p=null==x?void 0:x[1])||void 0===p?void 0:p.itemChildren.map(e=>e.itemKey).indexOf(null==x?void 0:x[0].itemKey))&&void 0!==g?g:0;if("accordion"===B.manifest.name){const t=(0,n.lL)(O,"DEFAULT");m(t,N,e)}else if("accordion"!==B.manifest.name){((e,o,n,a,r,...l)=>{v(void 0,[e,o,n,a,r,...l],void 0,function*(e,o,n,a,r,l=!0){var s,d,c,u,p,v;const g=(0,i.getAppConfigAction)(),h=l&&n<r?r-1:r;yield b(g,e,o,a,h),g.exec();const m=o.id?[o.id,a.id]:[a.id];(0,t.getAppStore)().dispatch(t.appActions.closeWidgets(m));const f=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!f)return;const y=f.appRuntimeInfo.selection;if(!y||(null==y?void 0:y.layoutId)===e.id&&[null===(s=o.layoutInfo)||void 0===s?void 0:s.layoutItemId,null===(d=a.layoutInfo)||void 0===d?void 0:d.layoutItemId].includes(null==y?void 0:y.layoutItemId)){const o=null===(c=e.parent)||void 0===c?void 0:c.id,i=null===(v=null===(p=null===(u=f.appConfig.widgets[o])||void 0===u?void 0:u.parent)||void 0===p?void 0:p[f.browserSizeMode])||void 0===v?void 0:v[0];(0,t.getAppStore)().dispatch(t.appActions.selectionChanged(i))}})})(j,N,y,B,e,W===D)}}else if(["to-top","to-bottom"].includes(S)&&N){let e=j;"accordion"===(null===(h=null==F?void 0:F.manifest)||void 0===h?void 0:h.name)&&(e=(0,n.lL)(D,"DEFAULT")),m(e,N,I)}},G=t.css`
width: 300px;
height: 400px;
overflow-y: auto;
padding: var(--sys-spacing-4);
.jimu-tree-item__main-line {
  height: 32px;
  background-color: var(--ref-palette-neutral-500);
  &:hover {
    background-color: var(--ref-palette-neutral-600);
  }
  color: var(--ref-palette-neutral-1100);
}
.jimu-tree-item__body {
  border: none !important;
}
`,U={Builder:r=>{var l,d,c,u;const{id:p,config:v,version:g,autoSize:h}=r,m=t.hooks.useCheckSmallBrowserSizeMode(),{viewOnly:f}=t.React.useContext(s.PageContext),y=t.ReactRedux.useSelector(e=>e.appRuntimeInfo.appMode===t.AppMode.Express),w=t.React.useRef(null),b=(0,n.PG)(p,o.bC),x=!Object.keys(null!=b?b:{}).length;t.hooks.useUpdateEffect(()=>{(0,t.getAppStore)().dispatch(t.appActions.widgetToolbarStateChange(p,["controller-manage-widgets"]))},[p,x]);const S=t.React.useRef([0,0]),I=Object.keys(b).filter(e=>(0,n.V5)(b[e])),R=null===(l=v.behavior)||void 0===l?void 0:l.onlyOpenOne,C=!!m||R,j=t.ReactRedux.useSelector(e=>e.browserSizeMode!==e.appConfig.mainSizeMode),M=v.behavior.vertical,A=v.appearance.card,L=v.appearance.space,O=v.behavior.alignment,T=v.behavior.overflownStyle,E=t.React.useMemo(()=>{var t,o,i;return(0,e.jsx)(a.i7,{size:null===(t=A.avatar)||void 0===t?void 0:t.size,buttonSize:null===(o=A.avatar)||void 0===o?void 0:o.buttonSize,space:M?L:A.labelGrowth,shape:null===(i=A.avatar)||void 0===i?void 0:i.shape,vertical:M,alignment:O})},[O,null===(d=A.avatar)||void 0===d?void 0:d.buttonSize,null===(c=A.avatar)||void 0===c?void 0:c.shape,null===(u=A.avatar)||void 0===u?void 0:u.size,A.labelGrowth,L,M]),B=t.hooks.useLatest(I),W=t.React.useCallback(e=>{e&&y&&setTimeout(()=>{var o,i,n;const a=null===(n=null===(i=null===(o=(0,t.getAppStore)().getState().appConfig.layouts[e.layoutId])||void 0===o?void 0:o.content)||void 0===i?void 0:i[e.layoutItemId])||void 0===n?void 0:n.widgetId;(0,P.xu)(p,a,B.current,C,!0)},50)},[p,y,C,B]);return N(p,W),(0,e.jsxs)("div",{className:"controller-builder w-100 h-100",ref:w,children:[(0,e.jsx)(k.A,{id:p,config:v,version:g,rootRef:w,onResizeStop:(e,o)=>{if(!e)return;let n=(null==v?void 0:v.behavior.size)||(0,t.Immutable)({});n=n.set(e,o);const a=v.setIn(["behavior","size"],n);(0,i.getAppConfigAction)().editWidgetConfig(p,a).exec()}}),!y&&(0,e.jsx)($,{id:p}),(0,e.jsx)(z,{autoSize:h,vertical:M,controllerId:p,onItemClick:e=>{var t;const o=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid,i=S.current[0]!==e.clientX||S.current[1]!==e.clientY;o&&!i&&(I.includes(o)||e.stopPropagation(),(0,P.xu)(p,o,I,C,!(f||y&&j)))},onMouseDown:e=>{S.current=[e.clientX,e.clientY]},itemStyle:A,draggable:!0,markerEnabled:!f&&!y,space:L,alignment:O,overflownStyle:T,placeholder:x?E:null,advanced:v.appearance.advanced})]})},ManageWidgetsComponent:i=>{const{widgetId:a}=i,r=t.ReactRedux.useSelector(e=>{const t=e.appStateInBuilder||e;if(!t)return;return t.appConfig.layouts}),l=t.React.useMemo(()=>{const e=(0,n.lL)(a,o.bC);return((e,o)=>{const i=(0,t.getAppStore)().getState().appStateInBuilder||(0,t.getAppStore)().getState();if(!o||!i)return;const a=i.appConfig.widgets,r=null==o?void 0:o.content;return{itemKey:e,itemChildren:(0,n.ne)(o).map(e=>r[e]).map(e=>{var t;const i=e.widgetId,r=a[i];let l;if("accordion"===(null===(t=null==r?void 0:r.manifest)||void 0===t?void 0:t.name)){const e=(0,n.lL)(i,"DEFAULT"),t=(0,n.ne)(e).map(t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]});l=t.map(t=>({itemKey:D(e.id,t),itemStateTitle:W(a,e.id,t)})).filter(e=>!!e.itemStateTitle)}return{itemKey:D(o.id,e),itemStateTitle:W(a,o.id,e),itemChildren:l,itemStateExpanded:!!l}}).filter(e=>!!e.itemStateTitle)}})(a,e)},[a,r]),s=t.React.useCallback(e=>{H(a,e)},[a]),d=t.React.useCallback(e=>{((e,t)=>{const[,o,i]=t.itemKey.split(",");y({layoutId:o,layoutItemId:i},e)})(a,e)},[a]);return(0,e.jsx)("div",{css:G,children:(0,e.jsx)(B.SortTree,{rootItemJson:l,isItemDroppable:F,onSort:s,onRemove:d})})}}})(),p})())}}});