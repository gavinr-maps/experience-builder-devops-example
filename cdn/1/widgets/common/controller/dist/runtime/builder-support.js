/*! For license information please see builder-support.js.LICENSE.txt */
System.register(["jimu-core","jimu-for-builder","jimu-layouts/layout-runtime","jimu-ui","jimu-theme","jimu-layouts/layout-builder","jimu-core/react","jimu-ui/advanced/setting-components"],(function(e,t){var o={},a={},n={},i={},r={},l={},s={},d={};return Object.defineProperty(s,"__esModule",{value:!0}),{setters:[function(e){o.AppMode=e.AppMode,o.BaseVersionManager=e.BaseVersionManager,o.ErrorBoundary=e.ErrorBoundary,o.FixedPosition=e.FixedPosition,o.Immutable=e.Immutable,o.LayoutItemType=e.LayoutItemType,o.LayoutType=e.LayoutType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.WidgetManager=e.WidgetManager,o.WidgetState=e.WidgetState,o.WidgetType=e.WidgetType,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.focusElementInKeyboardMode=e.focusElementInKeyboardMode,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.i18n=e.i18n,o.jsx=e.jsx,o.lodash=e.lodash,o.polished=e.polished},function(e){a.appConfigUtils=e.appConfigUtils,a.getAppConfigAction=e.getAppConfigAction},function(e){n.LayoutContext=e.LayoutContext,n.LayoutItemSizeModes=e.LayoutItemSizeModes,n.PageContext=e.PageContext,n.searchUtils=e.searchUtils,n.utils=e.utils},function(e){i.Button=e.Button,i.FloatingPanel=e.FloatingPanel,i.Icon=e.Icon,i.Loading=e.Loading,i.MobilePanel=e.MobilePanel,i.Modal=e.Modal,i.ModalBody=e.ModalBody,i.NavButtonGroup=e.NavButtonGroup,i.Pagination=e.Pagination,i.Popper=e.Popper,i.Tooltip=e.Tooltip,i.defaultMessages=e.defaultMessages,i.styleUtils=e.styleUtils},function(e){r.getBuilderThemeVariables=e.getBuilderThemeVariables,r.getTheme2=e.getTheme2,r.styled=e.styled,r.useTheme=e.useTheme},function(e){l.CanvasPane=e.CanvasPane,l.DropArea=e.DropArea,l.LayoutItemToolbar=e.LayoutItemToolbar,l.withRnd=e.withRnd},function(e){Object.keys(e).forEach((function(t){s[t]=e[t]}))},function(e){d.SortTree=e.SortTree}],execute:function(){e((()=>{var e={54044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M12 0h4v16H0v-4h12z"></path><path fill="#FFF" d="M13 1h2v14H1v-2h12z"></path></svg>'},26189:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 10"><path fill="#B6B6B6" d="M10 2.778V0L0 10h2.778zM10 5.607 5.607 10H10z"></path></svg>'},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},49859:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M4 4h2v1H4zM8 4h2v1H8zM14 4h-2v1h2zM15 4h1v2h-1zM16 8h-1v2h1zM4 14h1v2H4zM5 6H4v2h1zM4 10h1v2H4zM16 12h-1v2h1zM16 15v1h-2v-1zM12 15h-2v1h2zM6 15h2v1H6z"></path><path fill="#000" fill-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1" clip-rule="evenodd"></path></svg>'},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},17087:(e,t,o)=>{"use strict";o.d(t,{D7:()=>s,Gt:()=>n,XJ:()=>v,ZT:()=>p,aP:()=>c,bC:()=>i,iI:()=>r,kg:()=>l,up:()=>d,yH:()=>u});var a=o(79244);const n=5,i="controller",r={sm:24,default:32,lg:48},l={width:150,height:120},s={width:360,height:360},d={x:70,y:70},c={x:30,y:30},u=(a.FixedPosition.TopRight,{flipAlignment:!1}),p={boundary:document.body,rootBoundary:"document"},v=16},70687:(e,t,o)=>{"use strict";var a,n,i;o.d(t,{AH:()=>i,aL:()=>n,t2:()=>a}),function(e){e.Stack="STACK",e.SideBySide="SIDEBYSIDE"}(a||(a={})),function(e){e.Center="center",e.Start="start",e.End="end"}(n||(n={})),function(e){e.Arrows="ARROWS",e.PopupWindow="POPUP_WINDOW"}(i||(i={}))},50572:(e,t,o)=>{"use strict";o.d(t,{I6:()=>d,Q$:()=>r});var a=o(79244),n=o(14321),i=o(17087);const r=(e,t,o)=>{let a=i.iI[e];t&&(a+=21);return a+=2*l(e,o),a},l=(e,t)=>"circle"===t?"sm"===e?4:"default"===e?2:"lg"===e?0:void 0:6,s={none:"0",sm:"0",default:"var(--sys-shape-1)",lg:"var(--sys-shape-2)"},d=a.React.forwardRef(((e,t)=>{var o;const{label:i,className:d,showLabel:c,showIndicator:u=!0,showTooltip:p=!0,labelGrowth:v=0,icon:g,marker:m,onClick:f,onMarkerClick:h,avatar:y,autoFlip:w,active:b,editDraggable:S,disabled:x,widgetid:I}=e,R=y.type||"primary",C=y.size||"default",k=y.shape||"circle",A=((e,t,o,n,i)=>a.React.useMemo((()=>{const s=r(e,t,n),d=s+i,c=l(e,n);return a.css`
      display: flex;
      align-items:center;
      flex-direction: column;
      justify-content: ${t?"space-around":"center"};
      width: ${a.polished.rem(d)} !important;
      height: ${a.polished.rem(s)};
      .tool-drag-handler {
        cursor: auto;
      }
      .avatar {
        padding: ${c}px;
        position: relative;
        text-align: center;
        &:hover .marker {
          visibility: visible;
        }
        .avatar-button.disabled {
          color: var(--sys-color-action-disabled-text);
          background-color: var(--sys-color-action-disabled);
          border: 1px solid var(--sys-color-divider-secondary);
        }
        .marker {
          position: absolute;
          right: 0;
          top: 0;
          padding: 0;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          .icon-btn-sizer {
            min-width: .625rem;
            min-height: .625rem;
          }
          visibility: hidden;
        }
      }
      ${o?".avatar.active {\n        .avatar-button, .marker {\n          transform: translateY(-7px);\n        }\n        ::after {\n          content: '';\n          position: absolute;\n          bottom: 0;\n          left: 50%;\n          transform: translateX(-50%);\n          border: 1px solid var(--ref-palette-white);\n          border-radius: 3px;\n          width: 6px;\n          height: 3px;\n          background-color: var(--sys-color-primary-main);\n          box-sizing: content-box;\n        }\n      }":""}
      .avatar-label {
        text-align: center;
        width: 100%;
        min-height: ${a.polished.rem(21)};
        cursor: default;
      }
    `}),[e,t,n,i,o]))(C,c,u,k,v),M=s[C],j=(0,a.jsx)(n.Button,{"data-widgetid":I,"aria-label":i,"aria-expanded":b,"aria-haspopup":"dialog",icon:!0,active:b,className:(0,a.classNames)("avatar-button",{disabled:x}),type:R,size:C,style:{borderRadius:"circle"===k?"50%":M},onClick:f},(0,a.jsx)(n.Icon,{color:"string"!=typeof g&&(null===(o=g.properties)||void 0===o?void 0:o.color),icon:"string"!=typeof g?g.svg:g,autoFlip:w}));return(0,a.jsx)("div",{ref:t,"data-widgetid":I,className:(0,a.classNames)("avatar-card",{active:b},d),css:A},(0,a.jsx)("div",{className:(0,a.classNames)({"no-drag-action":!S,active:b},"avatar tool-drag-handler")},p?(0,a.jsx)(n.Tooltip,{title:i,style:{pointerEvents:"none"}},j):j,m&&(0,a.jsx)(n.Button,{className:"marker",size:"sm",icon:!0,onClick:h},(0,a.jsx)(n.Icon,{size:8,icon:m}))),c&&(0,a.jsx)("div",{className:(0,a.classNames)("avatar-label text-truncate",{active:b})},i))}))},12279:(e,t,o)=>{"use strict";o.d(t,{i7:()=>h,GD:()=>s,FZ:()=>d.F});var a=o(79244),n=o(50572),i=o(14321),r=o(62838),l=o.n(r);const s=e=>{var t,o;const{markerEnabled:r,onMarkerClick:s,widgetid:d,showLabel:c,showIndicator:u,showTooltip:p,labelGrowth:v,avatar:g,onClick:m,active:f,editDraggable:h,className:y}=e,w=a.ReactRedux.useSelector((e=>{var t;return null===(t=e.appConfig.widgets)||void 0===t?void 0:t[d]})),b="string"==typeof w.icon?w.icon:w.icon.asMutable({deep:!0});return w?a.React.createElement(n.I6,{widgetid:d,className:`widget-avatar-card ${y}`,showLabel:c,showIndicator:u,showTooltip:p,labelGrowth:v,avatar:g,label:w.label,icon:b,autoFlip:null===(o=null===(t=null==w?void 0:w.manifest)||void 0===t?void 0:t.properties)||void 0===o?void 0:o.flipIcon,marker:r?l():"",active:f,editDraggable:h,onMarkerClick:s,onClick:m}):a.React.createElement(i.Loading,null)};o(42667);var d=o(9567),c=o(49859),u=o.n(c),p=o(1888),v=o(70687);const g=(0,p.styled)("div",{shouldForwardProp:e=>!["vertical","space","alignment"].includes(e)})((e=>`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: ${e.alignment===v.aL.Start?"flex-start":e.alignment===v.aL.End?"flex-end":"center"};\n  flex-direction: ${e.vertical?"column":"row"};\n  .avatar-placeholder {\n    &:not(:first-of-type) {\n      margin-top: ${e.vertical?a.polished.rem(e.space):"unset"};\n      margin-left: ${e.vertical?"unset":a.polished.rem(e.space)};\n    }\n  }\n`)),m=(e=>{const t=[];for(;e>0;)t.push(e),e--;return t})(3),f=(0,a.Immutable)({type:"secondary",size:"lg",shape:"circle"}),h=e=>{const{vertical:t,space:o,size:i="lg",alignment:r=v.aL.Center}=e,l=a.React.useMemo((()=>f.set("size",i)),[i]);return a.React.createElement(g,{className:"list-placeholder",vertical:t,space:o,alignment:r},m.map(((e,t)=>a.React.createElement(n.I6,{key:t,disabled:!0,className:"avatar-placeholder",icon:u(),label:"",showTooltip:!1,avatar:l}))))}},28482:(e,t,o)=>{"use strict";o.d(t,{H9:()=>v,PG:()=>r,V5:()=>p,af:()=>l,lL:()=>s,ne:()=>d,pp:()=>u});var a=o(79244),n=o(41496),i=o(17087);const r=(e,t)=>{const o=a.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo)),n=l(e,t),i=c(n);return a.React.useMemo((()=>{const e={};return i.forEach((t=>{var n;const i=null!==(n=null==o?void 0:o[t])&&void 0!==n?n:{isClassLoaded:!1};e[t]=(0,a.Immutable)(i)})),(0,a.Immutable)(e)}),[i,o])},l=(e,t)=>a.ReactRedux.useSelector((o=>{var a,i,r,l;const s=null===(r=null===(i=null===(a=o.appConfig.widgets)||void 0===a?void 0:a[e])||void 0===i?void 0:i.layouts)||void 0===r?void 0:r[t],d=o.browserSizeMode,c=o.appConfig.mainSizeMode,u=n.searchUtils.findLayoutId(s,d,c);return null===(l=o.appConfig.layouts)||void 0===l?void 0:l[u]})),s=(e,t)=>{var o,i,r,l;const s=(0,a.getAppStore)().getState().appConfig,d=(0,a.getAppStore)().getState().browserSizeMode,c=null===(r=null===(i=null===(o=s.widgets)||void 0===o?void 0:o[e])||void 0===i?void 0:i.layouts)||void 0===r?void 0:r[t],u=n.searchUtils.findLayoutId(c,d,s.mainSizeMode);return null===(l=s.layouts)||void 0===l?void 0:l[u]},d=e=>{var t,o,a;let n=(null!==(a=null===(o=null===(t=null==e?void 0:e.order)||void 0===t?void 0:t.asMutable)||void 0===o?void 0:o.call(t))&&void 0!==a?a:[]).map((t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]}));return n=n.filter((e=>e&&e.id&&e.widgetId&&!e.isPending)),n.map((e=>e.id))},c=e=>d(e).map((t=>{var o,a;return null===(a=null===(o=e.content)||void 0===o?void 0:o[t])||void 0===a?void 0:a.widgetId})),u=(e,t)=>{if(null!=(null==e?void 0:e.content)&&t)return Object.keys(e.content).find((o=>e.content[o].widgetId===t))},p=e=>[a.WidgetState.Opened,a.WidgetState.Active].includes(e.state),v=e=>{const t=r(e,i.bC),o=Object.keys(t);return a.ReactRedux.useSelector((t=>{var a,n,i;const r=t.appRuntimeInfo.selection,l=null===(i=null===(n=null===(a=t.appConfig.layouts[null==r?void 0:r.layoutId])||void 0===a?void 0:a.content)||void 0===n?void 0:n[null==r?void 0:r.layoutItemId])||void 0===i?void 0:i.widgetId;return e===l||o.includes(l)}))}},42667:(e,t,o)=>{"use strict";o.d(t,{Q:()=>d});var a=o(79244),n=o(14321),i=o(19640),r=o(70687),l=o(28482);const s=[],d=a.React.forwardRef(((e,t)=>{const{controllerId:o,className:d,lists:c=s,createItem:u,vertical:p,itemLength:v,space:g,alignment:m=r.aL.Center,autoScrollEnd:f,autoSize:h,onMouseDown:y}=e,w=a.hooks.useTranslation(n.defaultMessages),[b,S]=a.hooks.useForwardRef(t),{start:x,end:I,disablePrevious:R,disableNext:C,hideArrow:k,scroll:A,remainLength:M}=(0,i.k)({rootRef:b,lists:c,itemLength:v,autoSize:h,vertical:p,space:g,autoScrollEnd:f}),j=c.slice(x,I),z=(({vertical:e,space:t,itemLength:o,autoSize:n,hideArrow:i,alignment:l,remainLength:s})=>a.css`
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    button.previous, button.next {
      flex-shrink: 0;
      display: ${i?"none":"block"};
    }
    ${l!==r.aL.Start||n||e?"":`button.next { transform: translateX(${-s}px); }`}
    ${l===r.aL.Start&&!n&&e?`button.next { transform: translateY(${-s}px); }`:""}
    ${l!==r.aL.End||n||e?"":`button.previous { transform: translateX(${s}px); }`}
    ${l===r.aL.End&&!n&&e?`button.previous { transform: translateY(${s}px); }`:""}
    .root {
      flex-direction: ${e?"column":"row"};
      width: 100%;
      height: 100%;
      ${e?`min-height: ${o}px;`:`min-width: ${o}px;`} 
      max-height: ${n?"100%":"calc(100% - 20px)"};
      max-width: ${n?"100%":"calc(100% - 20px)"};
      display: flex;
      justify-content: ${l===r.aL.Start?"flex-start":l===r.aL.End?"flex-end":"center"};
      flex-wrap: nowrap;
      align-items: center;
      .scroll-list-item {
        &:not(:first-of-type) {
          margin-top: ${e?t+"px":"unset"};
          margin-left: ${e?"unset":t+"px"};
        }
      }
    }
`)({vertical:p,space:g,itemLength:v,autoSize:h,hideArrow:k,alignment:m,remainLength:M}),L=(0,l.H9)(o);a.React.useEffect((()=>{L&&((0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"hideArrow",k)),(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"disablePrevious",R)),(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"disableNext",C)),(0,a.getAppStore)().dispatch(a.appActions.widgetToolbarStateChange(o,["controller-previous","controller-next"])))}),[o,C,R,k,L]),a.React.useEffect((()=>{L&&(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(o,"onArrowClick",A))}),[o,L,A]);return(0,a.jsx)(n.NavButtonGroup,{css:z,type:"tertiary",vertical:p,onChange:e=>{A(e,!0)},disablePrevious:R,disableNext:C,previousAriaLabel:w("previous"),nextAriaLabel:w("next"),className:(0,a.classNames)("scroll-list",d)},(0,a.jsx)("div",{className:"root scroll-list-root",ref:S,onMouseDown:y},c.map((e=>{const t=!j.includes(e);return u(e,(0,a.classNames)("scroll-list-item",{"d-none":t}))}))))}))},4843:(e,t,o)=>{"use strict";o.d(t,{z:()=>m});var a=o(79244),n=o(19640),i=o(70687),r=o(14321),l=o(17087);const s=(e,t,o)=>a.css`
    position: ${e===t?"relative":"absolute"};
    left: ${(e-t)*(6*o+40)}px;
    transition: all ease 0.3s;
  `,d=e=>{const{lists:t=[],createItem:o,itemLength:n,isOpen:i,reference:d,advancedStyle:c,onClose:u,onMouseDown:p}=e,v=a.hooks.useCheckSmallBrowserSizeMode(),g=3*(v?4:5),[m,f]=a.React.useState(1),h=Math.ceil(t.length/g),y=new Array(h).fill(1).map(((e,t)=>t+1)),w=e=>{f(e)},b=a.hooks.useLatest(m);a.React.useEffect((()=>{b.current>h&&0!==h&&f(h)}),[b,h]);const S=((e,t,o)=>{const n=o?4:5,i=o?a.css`top: 50% !important; left: 50% !important; transform: translate(-50%, -50%) !important;`:"";return a.css`
    ${i}
    &.modal-dialog {
      width: fit-content;
      margin: 0;
      .modal-content {
        border-radius: 8px;
        .modal-body {
          padding: 0;
        }
      }
    }
    &.popper {
      border-radius: 4px;
    }
    .popup-more {
      padding: var(--sys-spacing-3);
      display: flex;
      position: relative;
      overflow: hidden;
      .popup-page {
        display: grid;
        max-width: ${e*n}px;
        grid-template-columns: repeat(${t>1||o?n:"auto-fit"}, ${e}px);
        grid-template-rows: repeat(${t>1||o?3:"auto-fit"}, 1fr);
        gap: var(--sys-spacing-2) 0;
        justify-content: center;
      }
    }
    .popup-pagination {
      padding: 0 var(--sys-spacing-3) var(--sys-spacing-2) var(--sys-spacing-3);
      text-align: center;
      .jimu-pagination {
        justify-content: center;
        .jimu-page-number {
          display: none;
        }
      }
      .page-indicator {
        width: 6px;
        height: 6px;
        padding: 0;
        border-radius: 3px;
        border: none;
        background-color: var(--sys-color-action-disabled);
        transition: width ease 0.3s;
        &+.page-indicator {
          margin-left: 8px;
        }
        &.page-current {
          background-color: var(--sys-color-action-selected);
        }
      }
    }
  `})(n,y.length,v),x=a.React.useRef(0),I=a.React.useRef(0),R=(0,a.jsx)(a.React.Fragment,null,(0,a.jsx)("div",{className:"popup-more",css:c,onTouchStart:e=>{1===e.touches.length&&(x.current=e.touches[0].clientX)},onTouchMove:e=>{1===e.touches.length&&(I.current=e.touches[0].clientX)},onTouchEnd:e=>{const t=I.current-x.current;t<-100&&f((e=>e<h?e+1:e)),t>100&&f((e=>e>1?e-1:e)),x.current=0,I.current=0},onMouseDown:p},y.map((e=>{const i=t.slice(g*(e-1),g*e);return(0,a.jsx)("div",{key:e,className:"popup-page",css:s(e,m,n),onFocus:()=>{f(e)}},i.map((e=>o(e,"popup-list-item",u))))}))),y.length>1&&(0,a.jsx)("div",{className:"popup-pagination"},v&&y.map((e=>(0,a.jsx)(r.Button,{key:e,tabIndex:-1,"aria-hidden":!0,className:(0,a.classNames)("page-indicator",{"page-current":m===e}),onClick:()=>{w(e)}}))),!v&&(0,a.jsx)(r.Pagination,{variant:"text",current:m,simple:!0,size:"sm",totalPage:y.length,onChangePage:w})));return v?(0,a.jsx)(r.Modal,{className:"popup-more-modal",css:S,isOpen:i,toggle:u},(0,a.jsx)(r.ModalBody,null,R)):(0,a.jsx)(r.Popper,{className:"popup-more-popper",css:S,open:i,reference:d,autoFocus:!0,trapFocus:!0,flipOptions:l.yH,shiftOptions:l.ZT,offsetOptions:l.XJ,toggle:u},R)};var c=o(50572),u=o(13166),p=o(4651),v=o.n(p),g=o(54657);const m=a.React.forwardRef(((e,t)=>{const{vertical:o,alignment:r,space:l,itemStyle:s,lists:p=[],createItem:m,itemLength:f,autoSize:h,advanced:y,className:w,onMouseDown:b}=e,S=((e,t,o,n=i.aL.Center)=>a.css`
    &.root {
      flex-direction: ${e?"column":"row"};
      width: 100%;
      height: 100%;
      ${e?`min-height: ${o}px;`:`min-width: ${o}px;`}
      max-height: 100%;
      max-width: 100%;
      display: flex;
      justify-content: ${"center"===n?"center":"flex-"+n};
      flex-wrap: nowrap;
      align-items: center;
      .popup-list-item {
        &:not(:first-of-type) {
          margin-top: ${e?t+"px":"unset"};
          margin-left: ${e?"unset":t+"px"};
        }
      }
    }
  `)(o,l,f,r),[x,I]=a.hooks.useForwardRef(t),R=(0,n.s)({rootRef:x,lists:p,itemLength:f,autoSize:h,vertical:o,space:l});let C=p,k=[],A=!1;R<p.length&&(C=p.slice(0,R-1),k=p.slice(R-1),A=!0);const[M,j]=a.React.useState(!1),z=a.React.useRef(null),L=a.React.useCallback((e=>{j((t=>{const o="boolean"==typeof e?e:!t;return o||(0,a.focusElementInKeyboardMode)(z.current),o}))}),[]);a.React.useEffect((()=>{0===k.length&&j(!1)}),[k.length]);const T=a.hooks.useTranslation(u.A),O=(0,g.useAdvancedStyle)(s.variant,y);return(0,a.jsx)("div",{className:(0,a.classNames)("root popup-list-root",w),css:S,ref:I,onMouseDown:b},C.map((e=>m(e,(0,a.classNames)("popup-list-item")))),A&&(0,a.jsx)(c.I6,{ref:z,className:"popup-more-card popup-list-item",label:T("moreWidgets"),icon:v(),showLabel:s.showLabel,showIndicator:s.showIndicator,showTooltip:s.showTooltip,labelGrowth:s.labelGrowth,avatar:s.avatar,active:M,onClick:()=>{L()}}),(0,a.jsx)(d,{lists:k,createItem:m,isOpen:M,itemLength:f,reference:z.current,advancedStyle:O,onClose:()=>{L(!1)},onMouseDown:b}))}))},19640:(e,t,o)=>{"use strict";o.d(t,{k:()=>r,s:()=>l});var a=o(79244);const n=(e,t=!1,o=0,n=o,i)=>{var r,l;const s=t?"clientHeight":"clientWidth",[d,c]=a.React.useState(null!==(l=null===(r=e.current)||void 0===r?void 0:r[s])&&void 0!==l?l:0),u=i,p=a.hooks.useLatest((()=>{const t=e.current[s]||0;c(t)})),v=a.React.useMemo((()=>a.lodash.debounce((()=>{p.current()}),500,{leading:!0})),[p]);return a.React.useEffect((()=>{if(u)return;const t=e.current;t&&v();const o=new ResizeObserver(v);return o.observe(t),()=>{o.disconnect(),v.cancel()}}),[e,v,u]),Math.max(d+o,n)},i=(e,t,o)=>{let a=e,n=t;return n-a>o?n=e+o:n-a<o&&(a=0,n=a+o),[a,n]},r=e=>{var t;const{rootRef:o,lists:r,itemLength:l,autoSize:s,vertical:d,space:c,autoScrollEnd:u}=e,p=null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0;let v,g=n(o,d,c,l,s);s?(v=p,g=l*v):v=Math.floor(g/l)>p?p:Math.floor(g/l);const m=g-l*v,[f,h]=a.React.useState(i(0,0,v)[0]),[y,w]=a.React.useState(i(0,0,v)[1]),b=a.hooks.useLatest(f),S=a.hooks.useLatest(y),[x,I]=a.React.useState(y-f>=p),R=0===f,C=y===p;a.React.useEffect((()=>{if(0===g)return;const[e,t]=i(S.current,b.current,v);h(e),w(t),I(t-e>=p)}),[v,g,S,b,p]);const k=a.hooks.useEventCallback(((e,t=!0)=>{const o=t?1:v;let a=0,n=0;e?(a=f-o,a<0?(a=0,n=a+v):n=y-o):(n=y+o,n>p?(n=p,a=n-v):a=f+o),h(a),w(n)})),A=a.hooks.usePrevious(p);return a.React.useEffect((()=>{if(u&&(p>0&&A>0)&&A<p){let e=0,t=0;t=p,e=t-v,e=Math.max(0,e),h(e),w(t)}}),[u,p,v,A]),{start:f,end:y,disablePrevious:R,disableNext:C,hideArrow:x,scroll:k,remainLength:m}},l=e=>{var t;const{rootRef:o,lists:a,itemLength:i,autoSize:r,vertical:l,space:s}=e,d=null!==(t=null==a?void 0:a.length)&&void 0!==t?t:0,c=n(o,l,s,i,r);let u;return u=r||Math.floor(c/i)>d?d:Math.floor(c/i),u}},9567:(e,t,o)=>{"use strict";o.d(t,{F:()=>r,_:()=>i});var a=o(79244),n=o(50572);const i=(e,t)=>{const o=null==e?void 0:e.showLabel,a=null==e?void 0:e.labelGrowth,i=null==e?void 0:e.avatar.size,r=null==e?void 0:e.avatar.shape;return(0,n.Q$)(i,o,r)+t+a},r=e=>{var t,o;if(!e)return;return(null===(o=null===(t=(0,a.getAppStore)().getState().widgetsRuntimeInfo)||void 0===t?void 0:t[e])||void 0===o?void 0:o.isClassLoaded)?Promise.resolve(a.WidgetManager.getInstance().getWidgetClass(e)):a.WidgetManager.getInstance().loadWidgetClass(e)}},53716:(e,t,o)=>{"use strict";o.d(t,{Ht:()=>s,Ku:()=>c,Sr:()=>d,cq:()=>v,xu:()=>p});var a=o(79244),n=o(14321),i=o(28482),r=o(17087),l=o(13166);const s=e=>document.querySelector(`.widget-controller .avatar-card[data-widgetid='${e}']`),d=e=>document.querySelector(`[data-widgetid='${e}'] .popup-more-card`),c=e=>{const{isRuntime:t,isResizing:i}=e,r=a.hooks.useTranslation(l.A),s=o(t?26189:54044);return a.React.useMemo((()=>{const e=(0,a.jsx)("div",{className:"resize-handle d-flex p-1"},(0,a.jsx)(n.Icon,{icon:s,size:t?10:16,currentColor:!1}));return i||t?e:(0,a.jsx)(n.Tooltip,{title:r("resizerTooltip")},e)}),[i,t,s,r])},u=(e,t)=>{const o=(0,i.lL)(t,r.bC),n=Object.keys(o.content).find((t=>o.content[t].widgetId===e));(0,a.getAppStore)().dispatch(a.appActions.selectionChanged({layoutId:o.id,layoutItemId:n}))},p=(e,t,o,n,i=!1)=>{n?((0,a.getAppStore)().dispatch(a.appActions.closeWidgets(o)),o.includes(t)||((0,a.getAppStore)().dispatch(a.appActions.openWidget(t)),i&&u(t,e))):o.includes(t)?(0,a.getAppStore)().dispatch(a.appActions.closeWidget(t)):((0,a.getAppStore)().dispatch(a.appActions.openWidget(t)),i&&u(t,e))},v=e=>{const[t,o]=a.React.useState(!0);return a.React.useEffect((()=>{let t;return e?(t=new IntersectionObserver((e=>{const t=e[0];if(!t)return;const a=t.target.checkVisibility();o(a)})),t.observe(e)):o(!1),()=>{t&&t.disconnect()}}),[e]),t}},20863:(e,t,o)=>{"use strict";o.d(t,{A:()=>R});var a=o(79244),n=o(17087),i=o(28482),r=o(14321),l=o(12279),s=o(41496),d=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o};function c(e){const{widgetId:t,canCrossLayoutBoundary:o,className:n,layoutId:i,layoutItemId:c}=e,u=d(e,["widgetId","canCrossLayoutBoundary","className","layoutId","layoutItemId"]),p=a.hooks.useCancelablePromiseMaker(),[v,g]=a.React.useState(null),[m,f]=a.React.useState(""),[h,y]=a.React.useState("");a.React.useEffect((()=>{g(null),f("");p((0,l.FZ)(t)).then((e=>{g(e),f(t)}),(e=>{var t;y(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)}))}),[p,t]);const w=a.React.useCallback((()=>{var e,o;if(h)return;if(window.jimuConfig.isBuilder)return;(null===(o=null===(e=(0,a.getAppStore)().getState().widgetsRuntimeInfo)||void 0===e?void 0:e[t])||void 0===o?void 0:o.state)===a.WidgetState.Active||(0,a.getAppStore)().dispatch(a.appActions.activateWidget(t))}),[h,t]),b=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===a.AppMode.Design)),S=a.ReactRedux.useSelector((e=>{var o,a,n;const i=e.appConfig.widgets[t];return null!==(n=null===(a=null===(o=null==i?void 0:i.manifest)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.supportInlineEditing)&&void 0!==n&&n})),x=a.ReactRedux.useSelector((e=>{const o=e.widgetsRuntimeInfo[t];return S&&(null==o?void 0:o.isInlineEditing)})),I=a.ReactRedux.useSelector((e=>{var o;const n=e.appConfig.widgets[t];return(null===(o=null==n?void 0:n.manifest)||void 0===o?void 0:o.widgetType)!==a.WidgetType.Layout})),R=a.ReactRedux.useSelector((e=>{var o,a,n;const i=e.appConfig.widgets[t];return(null===(a=null===(o=null==i?void 0:i.manifest)||void 0===o?void 0:o.properties)||void 0===a?void 0:a.hasEmbeddedLayout)&&Object.keys(null!==(n=i.layouts)&&void 0!==n?n:{}).length>0})),C=b&&!x&&I&&!R,{viewOnly:k}=a.React.useContext(s.PageContext),A=a.React.useCallback((e=>{const{browserSizeMode:o,appConfig:{mainSizeMode:n}}=(0,a.getAppStore)().getState();!S||k||window.parent.isExpressBuilder&&o!==n||(e.stopPropagation(),(0,a.getAppStore)().dispatch(a.appActions.setWidgetIsInlineEditingState(t,!0)))}),[S,k,t]),M=(0,a.classNames)("widget-renderer w-100 h-100",n),j=(e=>a.React.useMemo((()=>a.css`
      overflow: ${e?"visible":"hidden"};
      position: relative;
      .widget-content {
        position: relative;
        height: 100%;
        width: 100%;
        z-index: 0;
      }
      .widget-mask {
        position: absolute;
        background: transparent;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        z-index: 1;
      }
  `),[e]))(o);return(0,a.jsx)("div",Object.assign({css:j,className:M,onMouseDownCapture:w,onDoubleClickCapture:A,"data-widgetid":m},u),(0,a.jsx)("div",{className:"widget-content p-1"},h,!h&&v&&(0,a.jsx)(a.ErrorBoundary,null,(0,a.jsx)(v,{widgetId:m,layoutId:i,layoutItemId:c})),!h&&!v&&(0,a.jsx)(r.Loading,null)),C&&(0,a.jsx)("div",{className:"widget-mask"}))}const u=(0,a.Immutable)({}),p=e=>{var t,o,n;const{rootVisible:l,containerMapId:s,onClose:d,widgets:p=u,layout:v,onClick:g}=e,m=null!==(t=Object.keys(p).find((e=>(0,i.V5)(p[e]))))&&void 0!==t?t:"",f=null===(n=null===(o=(0,a.getAppStore)().getState().appConfig.widgets)||void 0===o?void 0:o[m])||void 0===n?void 0:n.label;return a.React.createElement(r.MobilePanel,{className:(0,a.classNames)("mobile-widget-launcher",{"d-none":!m}),mapWidgetId:s,title:f,open:!!m&&l,keepMount:!0,onClick:e=>{g(e,m)},onClose:e=>{d(e,m)}},Object.entries(p).map((([e,t])=>{if(!(void 0!==t.state))return null;const o=(0,i.V5)(t),n=null==v?void 0:v.id,r=(0,i.pp)(v,e);return a.React.createElement(c,{key:e,widgetId:e,layoutId:n,layoutItemId:r,onClick:t=>{g(t,e)},className:(0,a.classNames)({"d-none":!o})})})))};var v=o(70687),g=o(53716);const m=()=>document.body.getBoundingClientRect(),f=(e,t,o,n,i)=>{const[r,l]=a.React.useState((()=>m())),[s,d]=a.React.useState([o]),c=a.React.useRef(0);a.React.useEffect((()=>{const e=()=>{const e=m();l(e)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const u=(e,t)=>e.right>=t.right||e.left<=t.left,p=(e,t)=>e.bottom>=t.bottom||e.top<=t.top,g=a.hooks.useEventCallback((t=>{if(c.current++,c.current>7)return console.warn(`Number of cycles: ${c.current}.You may have opened too many panels, and now there is not enough space for them to be placed without overstepping and blocking`),t;const a=((e,t)=>!(!e||!t)&&(u(e,t)||p(e,t)))(t,r);if(!a)return t;const{width:n,height:l}=t;let{left:s,top:d,right:m,bottom:f}=t;if(a){const t=u({left:s,top:d,right:m,bottom:f,width:n,height:l},r),a=p({left:s,top:d,right:m,bottom:f,width:n,height:l},r);t&&(s=e===v.t2.SideBySide?o.x:r.right-n),a||e!==v.t2.SideBySide||(d+=i),m=s+n,f=d+l}return g({left:s,top:d,right:m,bottom:f,width:n,height:l})}));return a.React.useEffect((()=>{const a=[];let r={width:0,height:0};Object.keys(t).forEach(((l,s)=>{const d=t[l],u=0!==s?a[s-1]:o;let{x:p,y:m}=u;if(e===v.t2.SideBySide){const{width:e}=r;p+=n>0?e:-e,p+=0!==s?n:0}else e===v.t2.Stack&&(p+=0!==s?n:0,m+=0!==s?i:0);const f={left:p,top:m,right:p+d.width,bottom:m+d.height,width:d.width,height:d.height},{left:h,top:y}=g(f);c.current>7?(p=u.x,m=u.y):(p=h,m=y),c.current=0,a.push({x:p,y:m}),r=d})),d(a)}),[e,o,n,i,r.width,r.height,g,t]),s},h=(0,a.Immutable)({}),y=e=>{const{rootVisible:t,mode:o,start:l,spaceX:s,spaceY:d,sizes:u,widgets:p=h,layout:v,autoFocus:m,onResizeStop:y,onClick:w,onClose:b}=e,S=a.ReactRedux.useSelector((e=>e.appConfig.widgets)),[x,I]=a.React.useState(u),R=a.React.useMemo((()=>((e,t)=>{let o=(0,a.Immutable)({});return Object.keys(e).forEach((e=>{o=o.set(e,t[e]||n.D7)})),o})(p,x)),[x,p]),[C,k]=a.React.useState(!1),A=f(o,R,l,s,d),M=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===a.AppMode.Run)),j=(0,a.jsx)(g.Ku,{isRuntime:M,isResizing:C});return(0,a.jsx)(a.React.Fragment,null,Object.entries(p).map((([e,o],n)=>{var l;if(!(void 0!==o.state))return null;const s=(0,i.V5)(o),d=A[n];if(!d)return null;const u=R[e],p=null===(l=null==S?void 0:S[e])||void 0===l?void 0:l.label,g=null==v?void 0:v.id,f=(0,i.pp)(v,e);return(0,a.jsx)(r.FloatingPanel,{key:e,style:{maxWidth:"100vw",position:"fixed"},headerTitle:p,defaultPosition:d,defaultSize:u,className:(0,a.classNames)({"d-none":!s||!t},"multiple-widget-launcher"),showHeaderClose:!0,showHeaderCollapse:!0,activateOnlyForHeader:!0,autoFocus:s&&m,dragBounds:"body",resizeHandle:j,onClick:t=>{w(t,e)},onResize:t=>{((e,t)=>{I(x.set(e,t)),k(!0)})(e,t)},onResizeStop:t=>{((e,t)=>{null==y||y(e,t),k(!1)})(e,t)},onHeaderClose:t=>{b(t,e)}},(0,a.jsx)(c,{widgetId:e,layoutId:g,layoutItemId:f}))})))},w=(0,a.Immutable)({}),b=e=>{const{widgets:t=w,root:o,placement:l,sizes:s,layout:d,autoFocus:u,onResizeStop:p,onClick:v,onClose:m}=e,f=a.ReactRedux.useSelector((e=>e.appConfig.widgets)),[h,y]=a.React.useState(s),[b,S]=a.React.useState(!1),x=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===a.AppMode.Run)),I=(0,a.jsx)(g.Ku,{isRuntime:x,isResizing:b});return(0,a.jsx)(a.React.Fragment,null,Object.entries(t).map((([e,t])=>{var s,w;if(!(void 0!==t.state))return null;const b=t.state!==a.WidgetState.Closed,x=null!==(s=h[e])&&void 0!==s?s:n.D7,R=null===(w=null==f?void 0:f[e])||void 0===w?void 0:w.label;let C=(0,g.Ht)(e);C&&C.offsetParent||(C=(null==o?void 0:o.querySelector(".popup-more-card"))||(null==o?void 0:o.querySelector(".avatar-card")));const k=null==d?void 0:d.id,A=(0,i.pp)(d,e);return(0,a.jsx)(r.FloatingPanel,{key:e,style:{maxWidth:"100vw"},flipOptions:n.yH,shiftOptions:n.ZT,offsetOptions:n.XJ,className:(0,a.classNames)({"d-none":!b},"single-widget-launcher"),headerTitle:R,activateOnlyForHeader:!0,minSize:n.kg,dragBounds:"body",defaultSize:x,resizeHandle:I,onResize:t=>{var o,a;o=e,a=t,y((e=>e.set(o,a))),S(!0)},onResizeStop:t=>{var o,a;o=e,a=t,null==p||p(o,a),S(!1)},onHeaderClose:t=>{m(t,e)},showHeaderCollapse:!0,open:!0,autoFocus:b&&u,reference:C,onClick:t=>{v(t,e)},placement:l},(0,a.jsx)(c,{widgetId:e,layoutId:k,layoutItemId:A}))})))},S=(0,a.Immutable)({}),x=e=>{const{widgets:t=S,root:o,placement:l,layout:s,onClick:d,onClose:u}=e;return(0,a.jsx)(a.React.Fragment,null,Object.entries(t).map((([e,t])=>{if(!(void 0!==t.state))return null;const p=t.state!==a.WidgetState.Closed;let v=(0,g.Ht)(e);v&&v.offsetParent||(v=(null==o?void 0:o.querySelector(".popup-more-card"))||(null==o?void 0:o.querySelector(".avatar-card")));const m=null==s?void 0:s.id,f=(0,i.pp)(s,e);return(0,a.jsx)(r.Popper,{key:e,autoUpdate:!0,css:a.css`
    border-radius: 0;
    max-width: 100vw;
    .widget-content {
      padding: 0 !important;
    }
  `,flipOptions:n.yH,shiftOptions:n.ZT,offsetOptions:n.XJ,className:(0,a.classNames)({"d-none":!p},"off-panel-widget-launcher"),open:!0,autoFocus:p,reference:v,toggle:(t,o)=>{"escape"===o&&u(t,e)},onClick:t=>{d(t,e)},placement:l},(0,a.jsx)(c,{widgetId:e,layoutId:m,layoutItemId:f}))})))},I=e=>a.ReactRedux.useSelector((t=>{var o,a,n,i;const r=t.appConfig,l=t.browserSizeMode,d=r.widgets[e].parent;let c=null!==(o=d[l])&&void 0!==o?o:[];if(0===c.length){c=null!==(a=d[r.mainSizeMode])&&void 0!==a?a:[]}const u=null===(n=c[0])||void 0===n?void 0:n.layoutId,p=s.searchUtils.getWidgetIdThatUseTheLayoutId(r,u),v=r.widgets[p];return"arcgis-map"===(null===(i=null==v?void 0:v.manifest)||void 0===i?void 0:i.name)?v.id:""}));function R(e){var t,o,r,l,d,c,u,v,m,f;const{id:h,config:w,version:S,rootRef:R,autoFocus:C=!0,onResizeStop:k}=e,{viewOnly:A}=a.React.useContext(s.PageContext),M=a.hooks.useCheckSmallBrowserSizeMode(),j=null===(t=w.behavior)||void 0===t?void 0:t.onlyOpenOne,z=null!==(r=null===(o=null==w?void 0:w.behavior)||void 0===o?void 0:o.arrangement)&&void 0!==r?r:"floating",L=j&&"floating"===z,T=!j&&"floating"===z,O=(0,i.af)(h,n.bC),E=a.React.useCallback(((e,t)=>{var o;e.stopPropagation();const n=new CustomEvent("click");n.composedPath=()=>e.nativeEvent.composedPath(),window.dispatchEvent(n);const r=(0,a.getAppStore)().getState(),l=r.appRuntimeInfo.appMode===a.AppMode.Express,s=r.browserSizeMode!==r.appConfig.mainSizeMode;if(A||l&&s)return;const d=null==O?void 0:O.id,c=(0,i.pp)(O,t),u=null===(o=(0,a.getAppStore)().getState().appRuntimeInfo)||void 0===o?void 0:o.selection;u&&u.layoutId===d&&u.layoutItemId===c||(0,a.getAppStore)().dispatch(a.appActions.selectionChanged({layoutId:d,layoutItemId:c}))}),[O,A]),P=a.React.useCallback(((e,t)=>{if(!t)return;null==e||e.stopPropagation(),null==e||e.preventDefault(),(0,a.getAppStore)().dispatch(a.appActions.closeWidget(t));const o=(0,g.Ht)(t)||(0,g.Sr)(h);(0,a.focusElementInKeyboardMode)(o),(0,a.getAppStore)().dispatch(a.appActions.selectionChanged(null))}),[h]),$=I(h),N=(null===(l=w.behavior)||void 0===l?void 0:l.vertical)?"right-start":"bottom-start",B=null===(d=w.behavior)||void 0===d?void 0:d.displayType,W=null===(v=null===(u=null===(c=(0,a.getAppStore)())||void 0===c?void 0:c.getState())||void 0===u?void 0:u.appContext)||void 0===v?void 0:v.isRTL,D=a.React.useMemo((()=>W?Object.assign(Object.assign({},n.up),{x:document.body.clientWidth-n.D7.width-n.up.x}):n.up),[W]),F=a.React.useMemo((()=>W?Object.assign(Object.assign({},n.aP),{x:-n.aP.x}):n.aP),[W]),H=null===(m=w.behavior)||void 0===m?void 0:m.size,G=(0,i.PG)(h,n.bC),V=a.hooks.useLatest(G),U=Object.keys(G),_=a.ReactRedux.useSelector((e=>{var t,o;const a=e.appRuntimeInfo.selection;return null===(o=null===(t=e.appConfig.layouts[null==a?void 0:a.layoutId])||void 0===t?void 0:t.content)||void 0===o?void 0:o[null==a?void 0:a.layoutItemId].widgetId}));a.hooks.useUpdateEffect((()=>{const e=Object.keys(V.current),t=e.filter((e=>(0,i.V5)(V.current[e])));e.includes(_)&&!t.includes(_)&&(0,g.xu)(h,_,t,w.behavior.onlyOpenOne)}),[w.behavior.onlyOpenOne,h,_,V]);const K=a.React.useCallback((()=>{const e=V.current,t=Object.keys(e).filter((t=>(0,i.V5)(e[t])));(0,a.getAppStore)().dispatch(a.appActions.closeWidgets(t))}),[V]);a.hooks.useUpdateEffect((()=>{(0,a.getAppStore)().dispatch(a.appActions.resetWidgetsState(U))}),[S]);const X=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.currentPageId));a.hooks.useUpdateEffect((()=>{K()}),[X]);const q=(0,g.cq)(R.current),J=a.ReactRedux.useSelector((e=>e.appContext.isInBuilder)),Y=null===(f=w.behavior)||void 0===f?void 0:f.openStarts;a.React.useEffect((()=>{q?!J&&(null==Y?void 0:Y.length)>0&&(0,a.getAppStore)().dispatch(a.appActions.openWidgets(Y)):K()}),[K,J,Y,q]);const Q=a.ReactRedux.useSelector((e=>{const t=e.appConfig.widgets;return U.filter((e=>t[e].offPanel)).join(",")}),a.ReactRedux.shallowEqual),Z=U.filter((e=>!Q.split(",").includes(e))).join(","),ee=a.React.useMemo((()=>G.without.apply(G,Z.split(","))),[Z,G]),te=a.React.useMemo((()=>G.without.apply(G,Q.split(","))),[Q,G]);return(0,a.jsx)(a.React.Fragment,null,M&&(0,a.jsx)(p,{containerMapId:$,layout:O,widgets:G,rootVisible:q,onClick:E,onClose:P}),!M&&L&&(0,a.jsx)(b,{sizes:H,root:R.current,placement:N,widgets:te,layout:O,autoFocus:C,onResizeStop:k,onClick:E,onClose:P}),!M&&T&&(0,a.jsx)(y,{sizes:H,rootVisible:q,mode:B,start:D,spaceX:F.x,spaceY:F.y,widgets:te,layout:O,autoFocus:C,onResizeStop:k,onClick:E,onClose:P}),!M&&(0,a.jsx)(x,{root:R.current,placement:N,widgets:ee,layout:O,onClick:E,onClose:P}))}},13166:(e,t,o)=>{"use strict";o.d(t,{A:()=>a});const a={_widgetLabel:"Widget Controller",_action_openWidget_label:"Open widget",resizerTooltip:"Customize the window size by dragging and dropping.",moreWidgets:"More widgets"}},54657:(e,t,o)=>{"use strict";o.d(t,{useAdvancedStyle:()=>w});var a=o(79244),n=o(9567),i=o(70687),r=o(42667),l=o(12279),s=o(17087),d=o(28482),c=o(20863),u=o(53716),p=o(4843);const v=e=>{var t,o,v,g,m,f,h,y;const{id:w,config:b,version:S,autoSize:x}=e,I=null===(t=b.behavior)||void 0===t?void 0:t.onlyOpenOne,R=null===(o=b.behavior)||void 0===o?void 0:o.vertical,C=b.behavior.overflownStyle||i.AH.Arrows,k=null===(v=null==b?void 0:b.appearance)||void 0===v?void 0:v.card,A=(0,n._)(k,null===(g=null==b?void 0:b.appearance)||void 0===g?void 0:g.space),M=a.hooks.useCheckSmallBrowserSizeMode(),j=a.React.useRef(null),z=(0,d.PG)(w,s.bC),L=Object.keys(z),T=L.filter((e=>(0,d.V5)(z[e]))),O=a.React.useCallback((e=>{var t;const o=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid;if(!o)return;const a=!!M||I;T.includes(o)||e.stopPropagation(),(0,u.xu)(w,o,T,a,!0)}),[M,I,T,w]),[E,P]=a.React.useState(!1),$=a.React.useCallback(((e,t,o)=>{const n=T.includes(e);return a.React.createElement(l.GD,{key:e,className:`${t} layout-item`,widgetid:e,markerEnabled:!1,active:n,showLabel:k.showLabel,showIndicator:k.showIndicator,showTooltip:k.showTooltip,labelGrowth:k.labelGrowth,avatar:k.avatar,variant:k.variant,onClick:t=>{P(!0),(0,a.getAppStore)().dispatch(a.appActions.widgetStatePropChange(e,"autoFocus",!0)),null==o||o(t),O(t)}})}),[k,O,T]);return a.React.createElement("div",{className:"controller-runtime w-100 h-100"},a.React.createElement(c.A,{id:w,config:b,version:S,rootRef:j,autoFocus:E}),C===i.AH.PopupWindow&&a.React.createElement(p.z,{ref:j,className:"runtime--popup-list",vertical:R,itemLength:A,space:null===(m=b.appearance)||void 0===m?void 0:m.space,alignment:null===(f=b.behavior)||void 0===f?void 0:f.alignment,autoSize:x,lists:L,createItem:$,itemStyle:k,advanced:b.appearance.advanced}),C===i.AH.Arrows&&a.React.createElement(r.Q,{ref:j,controllerId:w,className:"runtime--scroll-list",vertical:R,itemLength:A,space:null===(h=b.appearance)||void 0===h?void 0:h.space,alignment:null===(y=b.behavior)||void 0===y?void 0:y.alignment,autoSize:x,lists:L,createItem:$}))};var g=o(14321);const m={behavior:{onlyOpenOne:!0,openStarts:[],displayType:"STACK",vertical:!1,size:{}},appearance:{space:0,advanced:!1,card:{showLabel:!1,labelGrowth:10,showTooltip:!0,showIndicator:!1,avatar:{type:"primary",size:"default",shape:"circle"}}}};class f extends a.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"Version manager for release 1.0.0",upgrader:e=>{if(!e)return m;if(e.behavior&&e.appearance)return e;{let o=e;return e.behavior||(o=o.setIn(["behavior","openStarts"],[]),o=o.setIn(["behavior","onlyOpenOne"],e.onlyOpenOne),o=o.setIn(["behavior","displayType"],e.displayType),o=o.setIn(["behavior","vertical"],e.vertical),o=o.setIn(["behavior","size"],e.size),o=o.without(["onlyOpenOne","displayType","size"])),e.appearance||(o=o.setIn(["appearance","advanced"],!1),e.vertical?o=o.setIn(["appearance","space"],e.space):(o=o.setIn(["appearance","space"],0),o=o.setIn(["appearance","card","labelGrowth"],e.space)),o=o.setIn(["appearance","card","showLabel"],e.showLabel),o=o.setIn(["appearance","card","avatar","size"],"SMALL"===(t=e.iconSize)?"sm":"MEDIUM"===t?"default":"LARGE"===t?"lg":t),o=o.setIn(["appearance","card","avatar","shape"],e.iconStyle),o=o.setIn(["appearance","card","avatar","type"],"primary"),o=o.without(["space","showLabel","iconSize","iconStyle","vertical"])),o}var t}},{version:"1.1.0",description:"Version manager for release 1.1.0",upgrader:e=>{var t,o;if(!e)return m;let a=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card;const n=null==a?void 0:a.variants,i=null===(o=null==a?void 0:a.avatar)||void 0===o?void 0:o.type;let r=e;if(n){const e=((e,t="primary")=>null==e?void 0:e[t])(n,i);a=null==a?void 0:a.set("variant",e).without("variants"),r=r.setIn(["appearance","card"],a)}return r}},{version:"1.6.0",description:"Version manager for release 1.6.0",upgrader:e=>{var t;if(!e)return m;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,a=e;return o&&(o=o.set("showTooltip",!0),a=a.setIn(["appearance","card"],o)),a}},{version:"1.14.0",description:"Version manager for release 1.14.0",upgrader:e=>{var t;if(!e)return m;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,a=e;return o&&(o=o.set("showIndicator",!1),a=a.setIn(["appearance","card"],o)),a}}]}}const h=new f,y=(e,t)=>{const{bg:o,iconColor:n,boxShadow:i,color:r,italic:l,bold:s,underline:d,strike:c}=e||{},u=g.styleUtils.toCSSTextUnderLine({underline:d,strike:c});let p=a.css``;return"active"===t&&(p=a.css`::after {
      background-color: ${o};
    }`),a.css`
    >.avatar {
      >.avatar-button {
        ${o?a.css`background-color: ${o}; border-color: ${o};`:""}
        ${n?a.css`color: ${n};`:""}
        ${(null==i?void 0:i.color)?a.css`box-shadow: ${g.styleUtils.toCSSBoxshadow(i)};`:""}
      }
      ${p}
    }
    >.avatar-label {
      ${r?a.css`color: ${r};`:""}
      ${l?a.css`font-style: italic;`:""}
      ${s?a.css`font-weight: bold;`:""}
      ${d||c?a.css`text-decoration: ${u};`:""}
    }
  `},w=(e,t)=>{const o=null==e?void 0:e.default,n=null==e?void 0:e.active,i=o&&n?o.merge(n):n,r=null==e?void 0:e.hover,l=o&&r?o.merge(r):r;return a.React.useMemo((()=>{const e=t&&o?y(o,"regular"):"",n=y({bg:"var(--sys-color-primary-dark)"},"active"),r=t&&i?y(i,"active"):"",s=t&&l?y(l,"hover"):"";return a.css`
      .avatar-card {
        ${e}
        ${a.css`&.active:not(.disabled) { ${n} }`}
        ${r?a.css`&.active:not(.disabled) { ${r} }`:""}
        ${s?a.css`&:hover { ${s} }`:""}
      }
    `}),[t,o,i,l])},b=e=>{var t,o,n,i;const{builderSupportModules:r,id:l,config:d,onInitResizeHandler:c,onInitDragHandler:u,autoWidth:p,autoHeight:g}=e,m=null===(t=d.behavior)||void 0===t?void 0:t.onlyOpenOne,f=null===(o=d.behavior)||void 0===o?void 0:o.displayType,h=null===(n=null==d?void 0:d.behavior)||void 0===n?void 0:n.vertical,y=null==d?void 0:d.appearance.advanced,b=null===(i=null==d?void 0:d.appearance)||void 0===i?void 0:i.card.variant,S=h?g:p,x=a.ReactRedux.useSelector((e=>e.appContext.isInBuilder)),I=a.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode));a.React.useEffect((()=>{null==c||c(null,null,(()=>{A((e=>e+1))}))}),[c]),a.React.useEffect((()=>{null==u||u(null,null,(()=>{A((e=>e+1))}))}),[u]);const R=x&&I!==a.AppMode.Run,C=R&&r.widgetModules.Builder,[k,A]=a.React.useState(0);a.hooks.useUpdateEffect((()=>{A((e=>e+1))}),[m,f,I]);const M=((e,t,o)=>{const n=e?0:s.iI.sm,i=e?0:s.iI.sm,r=t?"5px":0,l=o?"5px":0;return a.React.useMemo((()=>a.css`
      overflow: visible;
      white-space: nowrap;
      .controller-container {
        width: 100%;
        height: 100%;
        padding: ${l} ${r};
        min-width:  ${n}px;
        min-height: ${i}px;
      }
    `),[r,l,n,i])})(S,p,g),j=w(b,y);return(0,a.jsx)("div",{className:"widget-controller jimu-widget rw-controller",css:[M,j]},(0,a.jsx)("div",{className:"controller-container"},!R&&(0,a.jsx)(v,{id:l,version:k,config:d,autoSize:S}),R&&C&&(0,a.jsx)(C,{id:l,version:k,config:d,autoSize:S})))};b.versionManager=h},77154:(e,t,o)=>{"use strict";var a=o(68972);var n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=a.useSyncExternalStore,r=a.useRef,l=a.useEffect,s=a.useMemo,d=a.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,o,a,c){var u=r(null);if(null===u.current){var p={hasValue:!1,value:null};u.current=p}else p=u.current;u=s((function(){function e(e){if(!l){if(l=!0,i=e,e=a(e),void 0!==c&&p.hasValue){var t=p.value;if(c(t,e))return r=t}return r=e}if(t=r,n(i,e))return t;var o=a(e);return void 0!==c&&c(t,o)?t:(i=e,r=o)}var i,r,l=!1,s=void 0===o?null:o;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]}),[t,o,a,c]);var v=i(e,u[0],u[1]);return l((function(){p.hasValue=!0,p.value=v}),[v]),d(v),v}},56037:(e,t,o)=>{"use strict";e.exports=o(77154)},79244:e=>{"use strict";e.exports=o},68972:e=>{"use strict";e.exports=s},4108:e=>{"use strict";e.exports=a},6055:e=>{"use strict";e.exports=l},41496:e=>{"use strict";e.exports=n},1888:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=i},79298:e=>{"use strict";e.exports=d}},t={};function c(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,c),n.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var o in t)c.o(t,o)&&!c.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="";var u={};return c.p=window.jimuConfig.baseUrl,(()=>{"use strict";c.r(u),c.d(u,{default:()=>K});var e=c(79244),t=c(17087),o=c(4108),a=c(28482),n=c(12279),i=c(42667),r=c(9567),l=c(41496),s=c(6055);const d={gap:0,padding:{number:[0],unit:"px"},header:{borderTop:{type:"solid",color:"var(--sys-color-primary-main)",width:"2px"},expandIcon:{svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>',properties:{filename:"expand.svg",size:16,color:"var(--ref-palette-neutral-1200)",inlineSvg:!0}},collapseIcon:{svg:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .54.54 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.54.54 0 0 1 0 .738" clip-rule="evenodd"></path></svg>',properties:{filename:"collapse.svg",size:16,color:"var(--ref-palette-neutral-1200)",inlineSvg:!0}},showWidgetIcon:!1,widgetIconSize:16,widgetIconColor:"var(--ref-palette-white)",textStyle:{bold:!0,color:"var(--ref-palette-neutral-1200)",size:"14px"},padding:{number:[0],unit:"px"},borderRadius:{number:[0],unit:"px"},collapsedColor:"rgba(0,0,0,0)",expandedColor:"rgba(0,0,0,0)"},panel:{backgroundColor:"rgba(0,0,0,0)",borderRadius:{number:[0],unit:"px"},padding:{number:[0],unit:"px"},border:{color:"var(--sys-color-primary-main)",type:"solid",width:"0px"}},singleMode:!1,showToggleAll:!1,useQuickStyle:3};var p=function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function l(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}s((a=a.apply(e,t||[])).next())}))};const v=t=>{var o,a;let n=!0;const i=null==t?void 0:t.itemType,r=null===(o=null==t?void 0:t.manifest)||void 0===o?void 0:o.name;(i===e.LayoutItemType.Section||["controller","navigator","divider","menu"].includes(r))&&(n=!1);const s=(0,e.getAppStore)().getState(),d=(s.appStateInBuilder?s.appStateInBuilder:s).appRuntimeInfo.appMode===e.AppMode.Express,c=null===(a=null==t?void 0:t.manifest)||void 0===a?void 0:a.widgetType;return d&&(["arcgis-map"].includes(r)||c===e.WidgetType.Layout)&&(n=!1),l.utils.isWidgetPlaceholder(l.utils.getAppConfig(),t)&&(n=!1),n},g=(t,a,n)=>p(void 0,void 0,void 0,(function*(){const i=(0,o.getAppConfigAction)(),r=yield m(i,t,a,n);if(t.type===e.LayoutType.AccordionLayout){w(i,t.parent.id,[r])}return i.exec(),r})),m=(t,a,n,i)=>p(void 0,void 0,void 0,(function*(){const r=n.layoutInfo;let l;if(r&&r.layoutId&&r.layoutItemId){const i=(0,e.getAppStore)().getState().browserSizeMode;let r;r=n.isFromCurrentSizeMode?i:o.appConfigUtils.getSizeModeOfALayout(t.appConfig,n.layoutInfo.layoutId),l=t.moveLayoutItem(n.layoutInfo,a.id,r,i)}else if(n.uri){const e=yield t.addNewWidgetToLayout(a.id,{uri:n.uri},!0);l={layoutId:a.id,layoutItemId:e}}return t.adjustOrderOfItem(l,i||0,!0),t.editLayoutItemProperty(l,"bbox",{},!0),t.editLayoutItemProperty(l,"setting",{},!0),l})),f=(t,a)=>{var n,i,r,l,s,d,c,u;const p=(0,o.getAppConfigAction)();p.removeLayoutItem(t,!0,!0);const{layoutId:v,layoutItemId:g}=t;if(a){const e=null===(n=p.appConfig.widgets[a])||void 0===n?void 0:n.config,t=null===(l=null===(r=null===(i=p.appConfig.layouts[v])||void 0===i?void 0:i.content)||void 0===r?void 0:r[g])||void 0===l?void 0:l.widgetId;if(Array.isArray(null===(s=null==e?void 0:e.behavior)||void 0===s?void 0:s.openStarts)&&e.behavior.openStarts.includes(t)){const o=e.setIn(["behavior","openStarts"],e.behavior.openStarts.filter((e=>e!==t)));p.editWidgetConfig(a,o)}}p.exec();const m=(0,e.getAppStore)().getState(),f=m.appRuntimeInfo.selection;if(!f||(null==f?void 0:f.layoutId)===t.layoutId&&(null==f?void 0:f.layoutItemId)===t.layoutItemId){const t=null===(u=null===(c=null===(d=m.appConfig.widgets[a])||void 0===d?void 0:d.parent)||void 0===c?void 0:c[m.browserSizeMode])||void 0===u?void 0:u[0];(0,e.getAppStore)().dispatch(e.appActions.selectionChanged(t))}},h=(t,o)=>{var a,n;if(!t||!o)return null;return{id:t.id,layoutInfo:o,itemType:e.LayoutItemType.Widget,manifest:null===(a=t.manifest)||void 0===a?void 0:a.asMutable({deep:!0}),icon:"string"==typeof t.icon?t.icon:null===(n=t.icon)||void 0===n?void 0:n.asMutable({deep:!0}),label:t.label}},y=(t,o,a,n,i)=>p(void 0,void 0,void 0,(function*(){var r,l,s,d,c,u,p;const v={name:"accordion",label:"Group",uri:"widgets/layout/accordion/",icon:null,itemType:e.LayoutItemType.Widget,manifest:{widgetType:e.WidgetType.Layout,properties:{}}},g=yield m(t,o,v,i),f=null===(s=null===(l=null===(r=t.appConfig.layouts[o.id])||void 0===r?void 0:r.content)||void 0===l?void 0:l[g.layoutItemId])||void 0===s?void 0:s.widgetId,h=function(e,t){const o=Object.values((null==t?void 0:t.content)||{}).map((e=>e.widgetId)),a=null==e?void 0:e.widgets,n=Object.values(a||{}).filter((e=>o.includes(e.id)&&"widgets/layout/accordion/"===e.uri)).map((e=>e.label));return n}(t.appConfig,o),y=e.i18n.getIntl(),b=y?y.formatMessage({id:"groupLabel",defaultMessage:"Group"}):"Group";t.editWidgetProperty(f,"label",function(e,t="Group"){const o=new RegExp(`${t} [0-9]+`),a=e.filter((e=>o.test(e))),n=/\d+/,i=a.map((e=>{var t;return parseInt(null===(t=n.exec(e))||void 0===t?void 0:t[0])})),r=i.sort(((e,t)=>t-e))[0]||0;return`${t} ${r+1}`}(h,b)),t.adjustOrderOfItem(g,i,!0);const S=(0,e.getAppStore)().getState().browserSizeMode,x=null===(p=null===(u=null===(c=null===(d=t.appConfig.widgets)||void 0===d?void 0:d[f])||void 0===c?void 0:c.layouts)||void 0===u?void 0:u.DEFAULT)||void 0===p?void 0:p[S],I=t.appConfig.layouts[x],R=yield m(t,I,n,0),C=yield m(t,I,a,1);w(t,f,[R,C])}));function w(e,t,o){var a,n,i,r,s,c,u;const p=e.appConfig,v=(null===(n=null===(a=p.widgets[t].config)||void 0===a?void 0:a.asMutable)||void 0===n?void 0:n.call(a,{deep:!0}))||{};let g=v;3!==v.useQuickStyle&&(g=d);const m=v.expandedItems||[],f=[];for(const t of o){const{layoutId:o,layoutItemId:a}=t,n=null===(s=null===(r=null===(i=p.layouts[o])||void 0===i?void 0:i.content)||void 0===r?void 0:r[a])||void 0===s?void 0:s.widgetId,d=p.widgets[n];n&&f.push(n),(null===(c=d.manifest.properties)||void 0===c?void 0:c.supportAutoSize)?e.editLayoutItemProperty(t,"setting.autoProps.height",l.LayoutItemSizeModes.Auto,!0):(null===(u=d.manifest.defaultSize)||void 0===u?void 0:u.height)?e.editLayoutItemProperty(t,"bbox",{height:d.manifest.defaultSize.height+"px"},!0):e.editLayoutItemProperty(t,"bbox",{height:"300px"},!0)}g.expandedItems=m.concat(f),e.editWidgetConfig(t,g)}const b=e.React.forwardRef(((t,o)=>{const{layout:a,layouts:n,vertical:i,childClass:r,placeholder:d,className:c}=t,{color:u,size:[p,v]}=d,m=e.React.useRef(null),f=e.React.useRef(null),h=e.React.useRef(null),y=e.React.useRef(null),w=e.React.useRef(null),[b,S]=e.React.useState(!1),x=e.hooks.useForkRef(m,o),I=e.css`
    width: 100%;
    height: 100%;
    position: absolute;
    left: 0;
    bottom: 0;
    top: 0;
    right: 0;
    background: transparent;
    z-index: ${b?1:0};
    > .drop-area {
      width: 100%;
      height: 100%;
    }
    > .overlay {
      position: absolute;
      left: 0;
      bottom: 0;
      top: 0;
      right: 0;
      background: transparent;
      z-index: -1;
      &.hide {
        display: none;
      }
    }
  `;e.React.useEffect((()=>{f.current=new s.CanvasPane(w.current)}),[]);return(0,e.jsx)("div",{className:(0,e.classNames)("drop-zone",c),ref:x,css:I},(0,e.jsx)(s.DropArea,{style:I,className:"drop-area",layouts:n,highlightDragover:!0,onDragOver:(e,t,o,a,n,r)=>{let l=a;const s=y.current,d=m.current.offsetHeight,c=m.current.offsetWidth;if(s&&s.length)if(i){const{insertY:e,refId:t}=((e,t,o)=>{let a,n,i=!1;if(t.some(((e,r)=>{if(e.top+e.height/2>o){if(0===r)a=e.top;else{const o=t[r-1];a=(e.top+o.top+o.height)/2}i=!0,n=e.id}return i})),!i){const e=t[t.length-1];a=e.top+e.height}return{insertY:a,refId:n}})(0,s,r);h.current=t,l={top:e-v/2+m.current.scrollTop,width:p,left:(c-p)/2+m.current.scrollLeft,height:v}}else{const{insertX:e,refId:t}=((e,t,o)=>{let a,n,i=!1;if(t.some(((e,r)=>{if(e.left+e.width/2>o){if(0===r)a=e.left;else{const o=t[r-1];a=(e.left+o.left+o.width)/2}i=!0,n=e.id}return i})),!i){const e=t[t.length-1];a=e.left+e.width}return{insertX:a,refId:n}})(0,s,n);h.current=t,l={left:e-v/2+m.current.scrollLeft,width:v,top:(d-p)/2+m.current.scrollTop,height:p}}else l=i?{top:o.height/2-v/2,width:p,left:(c-p)/2+m.current.scrollLeft,height:v}:{left:o.width/2-v/2,width:v,top:(d-p)/2+m.current.scrollTop,height:p};f.current.clear(),f.current.setColor(u),f.current.drawRect(l)},onDrop:(e,t,o)=>{f.current.clear();let n=0;h.current?n=a.order&&a.order.indexOf(h.current)||0:a.order&&(n=a.order.length),g(a,e,n),h.current=null,y.current=[]},onToggleDragoverEffect:e=>{e&&(h.current=null,(()=>{y.current=[];const e=m.current.getBoundingClientRect(),t=m.current.parentNode.querySelectorAll(`.${r}`);t&&t.length&&t.forEach((t=>{const o=t.getAttribute("data-layoutitemid");if(a.order&&a.order.includes(o)){const a=l.utils.relativeClientRect(t.getBoundingClientRect(),e);a.id=o,y.current.push(a)}})),i?y.current.sort(((e,t)=>e.top-t.top)):y.current.sort(((e,t)=>e.left-t.left))})(),f.current.setSize(m.current.clientWidth,m.current.clientHeight)),S(e)}}),(0,e.jsx)("canvas",{className:(0,e.classNames)("overlay",{hide:!b}),ref:w}))})),S=(0,s.withRnd)(!1)(n.GD),x=t=>{const{className:o,draggable:a,layoutId:n,layoutItem:i,onClick:r,showLabel:l,showIndicator:s,showTooltip:d,labelGrowth:c,markerEnabled:u,avatar:p,active:v,removeWidget:g}=t;return e.React.createElement(S,{className:(0,e.classNames)(o,"layout-item","align-items-center"),layoutId:n,layoutItem:i,widgetid:i.widgetId,layoutItemId:i.id,markerEnabled:u,showLabel:l,showIndicator:s,showTooltip:d,labelGrowth:c,avatar:p,active:v,editDraggable:a,useDragHandler:!0,onClick:r,onMarkerClick:()=>{g(i.widgetId)}})};var I=c(1888),R=c(70687),C=c(4843);const k=e.React.forwardRef(((o,n)=>{const{controllerId:s,draggable:d,itemStyle:c,vertical:u,className:p,space:g,alignment:m,overflownStyle:h=R.AH.Arrows,onItemClick:y,markerEnabled:w=!0,autoSize:S,advanced:k,placeholder:A,onMouseDown:M}=o,j=e.ReactRedux.useSelector((e=>{var o,a,n;return null===(n=null===(a=null===(o=e.appConfig.widgets)||void 0===o?void 0:o[s])||void 0===a?void 0:a.layouts)||void 0===n?void 0:n[t.bC]})),z=(0,a.af)(s,t.bC),L=(0,a.ne)(z),T=(0,I.getBuilderThemeVariables)(),O=(0,a.PG)(s,t.bC),E=Object.keys(O).filter((e=>(0,a.V5)(O[e]))),P=(0,r._)(c,g),$={color:e.polished.rgba(null==T?void 0:T.sys.color.primary.light,.5),size:[P,t.Gt]},N=(t,o,a,n)=>{const i=z.content[t],r=i&&i.widgetId||"",l=E.includes(r);return e.React.createElement(x,{key:t,className:(0,e.classNames)(`layout-${null==z?void 0:z.id}-item layout-item`,o),layoutId:z.id,layoutItemId:t,draggable:d&&!n,markerEnabled:w,layoutItem:i,active:l,showLabel:c.showLabel,showIndicator:c.showIndicator,showTooltip:c.showTooltip,labelGrowth:c.labelGrowth,avatar:c.avatar,removeWidget:()=>{f({layoutId:z.id,layoutItemId:t},s)},onClick:e=>{null==a||a(e),null==y||y(e)}})};return z&&e.React.createElement(l.LayoutContext.Provider,{value:{isItemAccepted:v}},e.React.createElement("div",{ref:n,className:(0,e.classNames)(p,"layout controller-layout w-100 h-100 d-flex align-items-center justify-content-center"),"data-layoutid":z.id},e.React.createElement(b,{vertical:u,layout:z,childClass:`layout-${z.id}-item`,placeholder:$,layouts:j}),!A&&h===R.AH.PopupWindow&&e.React.createElement(C.z,{className:"popup-list",vertical:u,space:g,itemStyle:c,alignment:m,lists:L,createItem:N,itemLength:P,autoSize:S,advanced:k,onMouseDown:M}),!A&&h===R.AH.Arrows&&e.React.createElement(i.Q,{controllerId:s,autoSize:S,className:"layout-item-list",vertical:u,itemLength:P,space:g,alignment:m,lists:L,autoScrollEnd:!0,createItem:N,onMouseDown:M}),A))}));var A=c(20863),M=c(68972),j=c(56037),z="default"in M?M.default:M;Symbol.for("react-redux-context"),"undefined"!=typeof globalThis&&globalThis;Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen"),Symbol.for("react.client.reference");var L=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),T="undefined"!=typeof navigator&&"ReactNative"===navigator.product;L||T?z.useLayoutEffect:z.useEffect;function O(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function E(e,t){if(O(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(let a=0;a<o.length;a++)if(!Object.prototype.hasOwnProperty.call(t,o[a])||!O(e[o[a]],t[o[a]]))return!1;return!0}Object.defineProperty,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.prototype;var P;P=j.useSyncExternalStoreWithSelector,(e=>{0})(M.useSyncExternalStore);const $={rootBoundary:"viewport",crossAxis:!0},N={boundary:document.body,fallbackPlacements:["top-start","bottom-start"]};function B(o){const{id:n}=o,{layoutId:i,layoutItem:r}=e.ReactRedux.useSelector((e=>{var o;const i=null===(o=e.appRuntimeInfo)||void 0===o?void 0:o.selection,r=(0,a.lL)(n,t.bC);let l,s;return i&&i.layoutId===r.id&&r.content[i.layoutItemId]&&(l=i.layoutId,s=r.content[i.layoutItemId]),{layoutId:l,layoutItem:s}}),E),[l,d]=e.React.useState(null);e.React.useEffect((()=>{if(i&&r){let e=0;const t=setInterval((()=>{e++;const o=document.querySelector(`.single-widget-launcher:has(.widget-renderer[data-widgetid=${null==r?void 0:r.widgetId}])`)||document.querySelector(`.multiple-widget-launcher:has(.widget-renderer[data-widgetid=${null==r?void 0:r.widgetId}])`)||document.querySelector(`.mobile-panel-popper:has(.widget-renderer[data-widgetid=${null==r?void 0:r.widgetId}])`);d(o),(e>=20||o)&&clearInterval(t)}),100)}else d(null)}),[i,r]);const c=e.hooks.useTranslation();return i&&r&&l&&(0,e.jsx)(e.React.Fragment,null,(0,e.jsx)(s.LayoutItemToolbar,{key:i+r.id,layoutId:i,layoutItem:r,refElement:l,shiftOptions:$,flipOptions:N,builderTheme:(0,I.getTheme2)(),formatMessage:c,showDefaultTools:!1}))}var W=c(53716);const D=(e,t,o)=>{var a;return null===(a=e[o.widgetId])||void 0===a?void 0:a.label},F=(e,t)=>`${t.widgetId||""},${e},${t.id}`,H=n=>{const i=(0,a.af)(n,t.bC),r=e.ReactRedux.useSelector((e=>{if(!i)return;const t=e.appConfig.widgets,o=null==i?void 0:i.content,r=(0,a.ne)(i).map((e=>o[e])).map((e=>{var o;const n=e.widgetId,r=t[n];let l;if("accordion"===(null===(o=null==r?void 0:r.manifest)||void 0===o?void 0:o.name)){const e=(0,a.lL)(n,"DEFAULT"),o=(0,a.ne)(e).map((t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]}));l=o.map((o=>({itemKey:F(e.id,o),itemStateTitle:D(t,e.id,o)}))).filter((e=>!!e.itemStateTitle))}return{itemKey:F(i.id,e),itemStateTitle:D(t,i.id,e),itemChildren:l,itemStateExpanded:!!l}})).filter((e=>!!e.itemStateTitle));return{itemKey:n,itemChildren:r}}),e.lodash.isDeepEqual),l=M.default.useCallback((t=>{var o,a,n,i,r,l,s;const{draggingItemJsons:d,targetItemJsons:c,dropType:u}=t,p=(0,e.getAppStore)().getState().appConfig.widgets,[v]=d[0].itemKey.split(","),g=p[v],[m]=null===(n=null===(a=null===(o=null==c?void 0:c[1])||void 0===o?void 0:o.itemKey)||void 0===a?void 0:a.split)||void 0===n?void 0:n.call(a,","),f=p[m];return("to-inside"!==u||"accordion"!==(null===(i=null==g?void 0:g.manifest)||void 0===i?void 0:i.name)&&"accordion"!==(null===(r=null==f?void 0:f.manifest)||void 0===r?void 0:r.name))&&(!["to-top","to-bottom"].includes(u)||"accordion"!==(null===(l=null==g?void 0:g.manifest)||void 0===l?void 0:l.name)||"accordion"!==(null===(s=null==f?void 0:f.manifest)||void 0===s?void 0:s.name))}),[]),s=M.default.useCallback((t=>{var n,r,l,s,d,c,u,v;const{dragItemJsons:m,dragItemIndex:f,itemJsons:w,targetDropItemIndex:b}=t,S=(0,e.getAppStore)().getState().appConfig.widgets,[x,I,R]=m[0].itemKey.split(","),C={layoutId:I,layoutItemId:R},k=S[x],[A,M,j]=w[0].itemKey.split(","),z={layoutId:M,layoutItemId:j},L=S[A],T=h(k,C),O=h(L,z),[E]=null===(l=null===(r=null===(n=null==m?void 0:m[1])||void 0===n?void 0:n.itemKey)||void 0===r?void 0:r.split)||void 0===l?void 0:l.call(r,","),[P]=null===(c=null===(d=null===(s=null==w?void 0:w[1])||void 0===s?void 0:s.itemKey)||void 0===d?void 0:d.split)||void 0===c?void 0:c.call(d,","),$=S[P];if("to-inside"===t.dropType&&T&&O){const t=null===(u=null==w?void 0:w[1])||void 0===u?void 0:u.itemChildren.indexOf(null==w?void 0:w[0]);if("accordion"===O.manifest.name){const e=(0,a.lL)(A,"DEFAULT");g(e,T,t)}else if("accordion"!==O.manifest.name){((t,a,n,i,r,...l)=>{p(void 0,[t,a,n,i,r,...l],void 0,(function*(t,a,n,i,r,l=!0){var s,d,c,u,p,v;const g=(0,o.getAppConfigAction)(),m=l&&n<r?r-1:r;yield y(g,t,a,i,m),g.exec();const f=a.id?[a.id,i.id]:[i.id];(0,e.getAppStore)().dispatch(e.appActions.closeWidgets(f));const h=(0,e.getAppStore)().getState(),w=h.appRuntimeInfo.selection;if(!w||(null==w?void 0:w.layoutId)===t.id&&[null===(s=a.layoutInfo)||void 0===s?void 0:s.layoutItemId,null===(d=i.layoutInfo)||void 0===d?void 0:d.layoutItemId].includes(null==w?void 0:w.layoutItemId)){const o=null===(c=t.parent)||void 0===c?void 0:c.id,a=null===(v=null===(p=null===(u=h.appConfig.widgets[o])||void 0===u?void 0:u.parent)||void 0===p?void 0:p[h.browserSizeMode])||void 0===v?void 0:v[0];(0,e.getAppStore)().dispatch(e.appActions.selectionChanged(a))}}))})(i,T,f,O,t,E===P)}}else if(["to-top","to-bottom"].includes(t.dropType)&&T){let e=i;"accordion"===(null===(v=null==$?void 0:$.manifest)||void 0===v?void 0:v.name)&&(e=(0,a.lL)(P,"DEFAULT")),g(e,T,b)}}),[i]),d=M.default.useCallback((e=>{const[,t,o]=e.itemKey.split(",");f({layoutId:t,layoutItemId:o},n)}),[n]),c=(0,a.H9)(n);M.default.useEffect((()=>{c&&((0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(n,"widgetTreeJson",r)),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(n,"isItemDroppable",l)),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(n,"onTreeSort",s)),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(n,"onTreeRemove",d)))}),[n,l,c,d,s,r])};var G=function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function l(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}s((a=a.apply(e,t||[])).next())}))};const V=(o,n)=>{const i=e.React.useCallback((e=>G(void 0,void 0,void 0,(function*(){var i,r;const l=(0,a.lL)(o,t.bC),s=null!==(r=null===(i=l.order)||void 0===i?void 0:i.length)&&void 0!==r?r:0;try{const t=yield g(l,e,s);n(t)}catch(e){console.error("Failed to add widget")}}))),[o,n]),r=e.ReactRedux.useSelector((e=>{var t;return null===(t=e.widgetsState[o])||void 0===t?void 0:t.itemToAdd}));e.React.useEffect((()=>{r&&(i(r),(0,e.getAppStore)().dispatch(e.appActions.widgetStatePropChange(o,"itemToAdd",null)))}),[o,r,i])};var U=c(79298);const _=t=>e.css`
width: 300px;
height: 400px;
overflow-y: auto;
padding: ${t.sys.spacing[4]};
.jimu-tree-item__main-line {
  height: 32px;
  background-color: ${t.ref.palette.neutral[500]};
  &:hover {
    background-color: ${t.ref.palette.neutral[600]};
  }
  color: ${t.ref.palette.neutral[1100]};
}
.jimu-tree-item__body {
  border: none !important;
}
`,K={Builder:i=>{var r,s;const{id:d,config:c,version:u,autoSize:p}=i,v=e.hooks.useCheckSmallBrowserSizeMode(),{viewOnly:g}=e.React.useContext(l.PageContext),m=e.ReactRedux.useSelector((t=>t.appRuntimeInfo.appMode===e.AppMode.Express)),f=e.React.useRef(null),h=(0,a.PG)(d,t.bC),y=!Object.keys(null!=h?h:{}).length;e.hooks.useUpdateEffect((()=>{(0,e.getAppStore)().dispatch(e.appActions.widgetToolbarStateChange(d,["controller-manage-widgets"]))}),[d,y]);const w=e.React.useRef([0,0]),b=Object.keys(h).filter((e=>(0,a.V5)(h[e]))),S=null===(r=c.behavior)||void 0===r?void 0:r.onlyOpenOne,x=!!v||S,I=e.ReactRedux.useSelector((e=>e.browserSizeMode!==e.appConfig.mainSizeMode)),R=c.behavior.vertical,C=c.appearance.card,M=c.appearance.space,j=c.behavior.alignment,z=c.behavior.overflownStyle,L=e.React.useMemo((()=>{var t;return(0,e.jsx)(n.i7,{size:null===(t=C.avatar)||void 0===t?void 0:t.size,space:R?M:C.labelGrowth,vertical:R,alignment:j})}),[j,null===(s=C.avatar)||void 0===s?void 0:s.size,C.labelGrowth,M,R]),T=e.hooks.useLatest(b),O=e.React.useCallback((t=>{t&&m&&setTimeout((()=>{var o,a,n;const i=null===(n=null===(a=null===(o=(0,e.getAppStore)().getState().appConfig.layouts[t.layoutId])||void 0===o?void 0:o.content)||void 0===a?void 0:a[t.layoutItemId])||void 0===n?void 0:n.widgetId;(0,W.xu)(d,i,T.current,x,!0)}),50)}),[d,m,x,T]);return V(d,O),H(d),(0,e.jsx)("div",{className:"controller-builder w-100 h-100",ref:f},(0,e.jsx)(A.A,{id:d,config:c,version:u,rootRef:f,onResizeStop:(t,a)=>{if(!t)return;let n=(null==c?void 0:c.behavior.size)||(0,e.Immutable)({});n=n.set(t,a);const i=c.setIn(["behavior","size"],n);(0,o.getAppConfigAction)().editWidgetConfig(d,i).exec()}}),!m&&(0,e.jsx)(B,{id:d}),(0,e.jsx)(k,{autoSize:p,vertical:R,controllerId:d,onItemClick:e=>{var t;const o=null===(t=e.currentTarget.dataset)||void 0===t?void 0:t.widgetid,a=w.current[0]!==e.clientX||w.current[1]!==e.clientY;o&&!a&&(b.includes(o)||e.stopPropagation(),(0,W.xu)(d,o,b,x,!(g||m&&I)))},onMouseDown:e=>{w.current=[e.clientX,e.clientY]},itemStyle:C,draggable:!0,markerEnabled:!g&&!m,space:M,alignment:j,overflownStyle:z,placeholder:y?L:null,advanced:c.appearance.advanced}))},ManageWidgetsComponent:t=>{var o,a;const n=t.widgetId,i=null===(a=null===(o=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[n].widgetTreeJson)))||void 0===o?void 0:o.asMutable)||void 0===a?void 0:a.call(o,{deep:!0}),r=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[n].isItemDroppable)),l=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[n].onTreeSort)),s=e.ReactRedux.useSelector((e=>(e.appStateInBuilder?e.appStateInBuilder:e).widgetsState[n].onTreeRemove)),d=(0,I.useTheme)();return(0,e.jsx)("div",{css:_(d)},(0,e.jsx)(U.SortTree,{rootItemJson:i,isItemDroppable:r,onSort:l,onRemove:s}))}}})(),u})())}}}));