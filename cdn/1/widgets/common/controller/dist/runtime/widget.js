System.register(["jimu-core","jimu-ui","jimu-layouts/layout-runtime","jimu-theme"],(function(e,t){var o={},a={},n={},i={};return{setters:[function(e){o.AppMode=e.AppMode,o.BaseVersionManager=e.BaseVersionManager,o.ContainerType=e.ContainerType,o.ControllerPosition=e.ControllerPosition,o.ErrorBoundary=e.ErrorBoundary,o.Immutable=e.Immutable,o.LayoutItemType=e.LayoutItemType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.WidgetManager=e.WidgetManager,o.WidgetState=e.WidgetState,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.jsx=e.jsx,o.lodash=e.lodash,o.polished=e.polished},function(e){a.Button=e.Button,a.FloatingPanel=e.FloatingPanel,a.Icon=e.Icon,a.Loading=e.Loading,a.MobilePanel=e.MobilePanel,a.NavButtonGroup=e.NavButtonGroup,a.Popper=e.Popper,a.Tooltip=e.Tooltip,a.defaultMessages=e.defaultMessages,a.styleUtils=e.styleUtils,a.utils=e.utils},function(e){n.searchUtils=e.searchUtils},function(e){i.styled=e.styled}],execute:function(){e((()=>{var e={25164:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M4 4h2v1H4V4ZM8 4h2v1H8V4ZM14 4h-2v1h2V4ZM15 4h1v2h-1V4ZM16 8h-1v2h1V8ZM4 14h1v2H4v-2ZM5 6H4v2h1V6ZM4 10h1v2H4v-2ZM16 12h-1v2h1v-2ZM16 15v1h-2v-1h2ZM12 15h-2v1h2v-1ZM6 15h2v1H6v-1Z"></path><path fill="#000" fill-rule="evenodd" d="M18 0a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h16Zm0 1H2a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1Z" clip-rule="evenodd"></path></svg>'},55339:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746L8.746 8Z"></path></svg>'},48891:e=>{"use strict";e.exports=o},74758:e=>{"use strict";e.exports=n},34796:e=>{"use strict";e.exports=i},30726:e=>{"use strict";e.exports=a}},t={};function l(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,l),n.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var r={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(r),l.d(r,{__set_webpack_public_path__:()=>U,default:()=>H});var e=l(48891),t=l(30726);const o="controller",a={sm:24,default:32,lg:48},n={width:150,height:120},i={width:300,height:300},s={x:70,y:70},c={x:30,y:30};e.ControllerPosition.TopRight;var d=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o};const u=(e,t,o)=>{let n=a[e];return t&&(n+=21),n+=2*p(e,o),n},p=(e,t)=>"circle"===t?"sm"===e?4:"default"===e?2:"lg"===e?0:void 0:6,v=e.React.forwardRef(((o,a)=>{var n;const{label:i,className:l,title:r,showLabel:s,showTooltip:c=!0,labelGrowth:v=0,icon:g,marker:h,onMarkerClick:m,avatar:f,autoFlip:b,active:y,editDraggable:w,disabled:S}=o,R=d(o,["label","className","title","showLabel","showTooltip","labelGrowth","icon","marker","onMarkerClick","avatar","autoFlip","active","editDraggable","disabled"]),x=f||{},{shape:I,style:C}=x,O=d(x,["shape","style"]),k=null==O?void 0:O.size,[j,M]=e.React.useState(null),E=((t,o,a,n)=>e.React.useMemo((()=>{const i=u(t,o,a),l=i+n,r=p(t,a);return e.css`
      display: flex;
      align-items:center;
      flex-direction: column;
      justify-content: ${o?"space-around":"center"};
      width: ${e.polished.rem(l)} !important;
      height: ${e.polished.rem(i)};
      .tool-drag-handler {
        cursor: auto;
      }
      .avatar {
        padding: ${r}px;
        position: relative;
        text-align: center;
        .marker {
          position: absolute;
          right: 0;
          top: 0;
          padding: 0;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          .icon-btn-sizer {
            min-width: .625rem;
            min-height: .625rem;
          }
        }
      }
      .avatar-label {
        text-align: center;
        width: 100%;
        min-height: ${e.polished.rem(21)};
        cursor: default;
      }
    `}),[t,o,a,n]))(k,s,I,v),A=(0,e.jsx)(t.Button,Object.assign({icon:!0,active:y,disabled:S,className:"avatar-button",ref:a},O,{style:Object.assign({borderRadius:"circle"===I?"50%":void 0},C)}),(0,e.jsx)(t.Icon,{color:"string"!=typeof g&&(null===(n=g.properties)||void 0===n?void 0:n.color),icon:"string"!=typeof g?g.svg:g,autoFlip:b}));return(0,e.jsx)("div",Object.assign({},R,{className:(0,e.classNames)("avatar-card",`${l} avatar-card`),css:E}),(0,e.jsx)("div",{className:(0,e.classNames)({"no-drag-action":!w},"avatar tool-drag-handler"),onMouseEnter:()=>{M(!0)},onMouseLeave:()=>{M(!1)}},h&&j&&(0,e.jsx)(t.Button,{className:"marker",size:"sm",icon:!0,onClick:m},(0,e.jsx)(t.Icon,{size:8,icon:h})),c?(0,e.jsx)(t.Tooltip,{title:r||i,style:{pointerEvents:"none"}},A):A),s&&(0,e.jsx)("div",{className:(0,e.classNames)("avatar-label text-truncate",{active:y})},i))}));var g=l(74758),h=l(55339),m=l.n(h);const f=o=>{var a,n;const{markerEnabled:i,onMarkerClick:l,widgetid:r,showLabel:s,showTooltip:c,labelGrowth:d,avatar:u,onClick:p,active:g,editDraggable:h,className:f}=o,b=e.ReactRedux.useSelector((e=>{var t;return null===(t=e.appConfig.widgets)||void 0===t?void 0:t[r]}));return b?e.React.createElement(v,{"data-widgetid":r,className:`widget-avatar-card ${f}`,showLabel:s,showTooltip:c,labelGrowth:d,avatar:u,label:b.label,icon:b.icon,autoFlip:null===(n=null===(a=null==b?void 0:b.manifest)||void 0===a?void 0:a.properties)||void 0===n?void 0:n.flipIcon,marker:i?m():"",active:g,editDraggable:h,onMarkerClick:l,onClick:p}):e.React.createElement(t.Loading,null)},b=(e,t,o)=>{let a=e,n=t;return n-a>o?n=e+o:n-a<o&&(a=0,n=a+o),[a,n]};const y=[],w=e.React.forwardRef(((o,a)=>{const{scrollRef:n,className:i,lists:l=y,createItem:r,vertical:s,itemLength:c,space:d,onChange:u,autoHideArrow:p,minLength:v=c,autoScrollEnd:g,autoSize:h,onScrollStatusChange:m}=o,f=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o}(o,["scrollRef","className","lists","createItem","vertical","itemLength","space","onChange","autoHideArrow","minLength","autoScrollEnd","autoSize","onScrollStatusChange"]),w=e.hooks.useTranslation(t.defaultMessages),[S,R]=e.hooks.useForwardRef(a),{start:x,end:I,disablePrevious:C,disableNext:O,hideArrow:k,scroll:j}=(t=>{var o;const{rootRef:a,lists:n,itemLength:i,autoSize:l,vertical:r,space:s,minLength:c,autoScrollEnd:d}=t,u=null!==(o=null==n?void 0:n.length)&&void 0!==o?o:0,p=e.hooks.useLatest(l),v=((t,o,a=0,n=a,i)=>{let l=((t,o=500,a=!1,n)=>{var i,l;const r=a?"clientHeight":"clientWidth",[s,c]=e.React.useState(null!==(l=null===(i=t.current)||void 0===i?void 0:i[r])&&void 0!==l?l:0),d=!n&&!window.jimuConfig.isInBuilder,u=e.hooks.useLatest((()=>{const e=t.current[r]||0;c(e)})),p=e.React.useMemo((()=>e.lodash.debounce((()=>{u.current()}),o)),[]);return e.React.useEffect((()=>{if(d)return;const e=t.current;e&&p();const o=new ResizeObserver(p);return o.observe(e),()=>{o.disconnect(),p.cancel()}}),[t,p,d]),s})(t,500,o,i);return l+=a,l=Math.max(l,n),l})(a,r,s,c,!l),g=e.React.useMemo((()=>p.current?u:Math.floor(v/i)),[p,u,i,v]),[h,m]=e.React.useState(b(0,0,g)[0]),[f,y]=e.React.useState(b(0,0,g)[1]),w=e.hooks.useLatest(h),S=e.hooks.useLatest(f),R=f-h>=u,x=0===h,I=f===u;e.React.useEffect((()=>{if(0===v)return;const[e,t]=b(S.current,w.current,g);m(e),y(t)}),[g,v,S,w]);const C=e.hooks.useEventCallback(((e,t=!0)=>{const o=t?1:g;let a=0,n=0;e?(a=h-o,a<0?(a=0,n=a+g):n=f-o):(n=f+o,n>u?(n=u,a=n-g):a=h+o),m(a),y(n)})),O=e.React.useRef([]),k=e.hooks.useEventCallback((()=>{const e=u>0&&O.current.length>0&&n[n.length-1]!==O.current[O.current.length-1];if(d&&e&&O.current.length>u){let e=0,t=0;t=u,e=t-g,e=Math.max(0,e),m(e),y(t)}}));return e.React.useEffect((()=>{k(),O.current=n}),[n,k]),{start:h,end:f,disablePrevious:x,disableNext:I,hideArrow:R,scroll:C}})({rootRef:S,lists:l,itemLength:c,autoSize:h,vertical:s,space:d,minLength:v,autoScrollEnd:g}),M=h?l:l.slice(x,I),E=!!h||k,A=((t,o,a,n,i)=>e.css`
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    button.previous, button.next {
      flex-shrink: 0;
      display: ${i?"none":"block"};
    }
    .root {
      flex-direction: ${t?"column":"row"};
      width: 100%;
      height: 100%;
      min-width: ${e.polished.rem(a)};
      max-height: ${n?"100%":"calc(100% - 20px)"};
      max-width: ${n?"100%":"calc(100% - 20px)"};
      display: flex;
      justify-content: center;
      flex-wrap: nowrap;
      align-items: center;
      .scroll-list-item {
        &:not(:first-of-type) {
          margin-top: ${t?e.polished.rem(o):"unset"};
          margin-left: ${t?"unset":e.polished.rem(o)};
        }
      }
    }
`)(s,d,v,h,E);return e.React.useEffect((()=>{null==m||m(E,C,O)}),[O,C,E,m]),e.React.useEffect((()=>{t.utils.setRef(n,j)}),[j,n]),(0,e.jsx)(t.NavButtonGroup,Object.assign({},f,{css:A,type:"tertiary",vertical:s,onChange:e=>{null==u||u(e),j(e,!0)},disablePrevious:C,disableNext:O,previousAriaLabel:w("previous"),nextAriaLabel:w("next"),className:(0,e.classNames)("scroll-list",i)}),(0,e.jsx)("div",{className:"root scroll-list-root",ref:R},M.map((e=>r(e,"scroll-list-item")))))}));l(25164),(0,l(34796).styled)("div")`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: ${e=>e.vertical?"column":"row"};
  .avatar-placeholder {
    &:not(:first-of-type) {
      margin-top: ${t=>t.vertical?e.polished.rem(t.space):"unset"};
      margin-left: ${t=>t.vertical?"unset":e.polished.rem(t.space)};
    }
  }
`,(e=>{const t=[];for(;e>0;)t.push(e),e--})(3);function S(o){const{widgetId:a,canCrossLayoutBoundary:n,className:i}=o,l=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]])}return o}(o,["widgetId","canCrossLayoutBoundary","className"]),r=e.hooks.useCancelablePromiseMaker(),[s,c]=e.React.useState(null),[d,u]=e.React.useState("");e.React.useEffect((()=>{const t=r((t=>{var o,a;if(t)return(null===(a=null===(o=(0,e.getAppStore)().getState().widgetsRuntimeInfo)||void 0===o?void 0:o[t])||void 0===a?void 0:a.isClassLoaded)?Promise.resolve(e.WidgetManager.getInstance().getWidgetClass(t)):e.WidgetManager.getInstance().loadWidgetClass(t)})(a));t.then((e=>{c(e)}),(e=>{var t;u(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e)}))}),[r,a]);const p=e.React.useCallback((()=>{var t,o;d||window.jimuConfig.isBuilder||(null===(o=null===(t=(0,e.getAppStore)().getState().widgetsRuntimeInfo)||void 0===t?void 0:t[a])||void 0===o?void 0:o.state)===e.WidgetState.Active||(0,e.getAppStore)().dispatch(e.appActions.activateWidget(a))}),[d,a]),v=(0,e.classNames)("widget-renderer w-100 h-100",i),g=(t=>e.React.useMemo((()=>e.css`
      overflow: ${t?"visible":"hidden"};
      position: relative;
      .widget-content {
        position: relative;
        height: 100%;
        width: 100%;
        z-index: 0;
      }
  `),[t]))(n);return(0,e.jsx)("div",Object.assign({css:g,className:v,onMouseDownCapture:p,"data-widgetid":a},l),(0,e.jsx)("div",{className:"widget-content p-1"},d,!d&&s&&(0,e.jsx)(e.ErrorBoundary,null,(0,e.jsx)(s,{widgetId:a})),!d&&!s&&(0,e.jsx)(t.Loading,null)))}const R=(t,o)=>e.ReactRedux.useSelector((e=>{var a,n,i,l;const r=null===(i=null===(n=null===(a=e.appConfig.widgets)||void 0===a?void 0:a[t])||void 0===n?void 0:n.layouts)||void 0===i?void 0:i[o],s=e.browserSizeMode,c=e.appConfig.mainSizeMode,d=g.searchUtils.findLayoutId(r,s,c);return null===(l=e.appConfig.layouts)||void 0===l?void 0:l[d]})),x=(e,t)=>{if(null!=(null==e?void 0:e.content)&&t)return Object.keys(e.content).find((o=>e.content[o].widgetId===t))},I=(0,e.Immutable)({}),C=a=>{var n,i,l;const{controllerId:r,containerMapId:s,onClose:c,widgets:d=I}=a,u=null!==(n=Object.keys(d).find((t=>d[t].state===e.WidgetState.Opened)))&&void 0!==n?n:"",p=null===(l=null===(i=(0,e.getAppStore)().getState().appConfig.widgets)||void 0===i?void 0:i[u])||void 0===l?void 0:l.label,v=R(r,o),g=e.React.useCallback(((t,o)=>{var a;t.stopPropagation();const n=null==v?void 0:v.id,i=x(v,o),l=null===(a=(0,e.getAppStore)().getState().appRuntimeInfo)||void 0===a?void 0:a.selection;l&&l.layoutId===n&&l.layoutItemId===i||(0,e.getAppStore)().dispatch(e.appActions.selectionChanged({layoutId:n,layoutItemId:i}))}),[v]);return e.React.createElement(t.MobilePanel,{className:(0,e.classNames)({"d-none":!u}),mapWidgetId:s,title:p,open:!!u,keepMount:!0,onClose:e=>{null==e||e.stopPropagation(),null==e||e.nativeEvent.stopImmediatePropagation(),null==c||c(u)}},Object.entries(d).map((([t,o])=>{if(void 0===o.state)return null;const a=o.state===e.WidgetState.Opened;return e.React.createElement(S,{key:t,widgetId:t,onClick:e=>{g(e,t)},className:(0,e.classNames)({"d-none":!a})})})))},O=e=>document.querySelector(`.widget-controller .avatar-card[data-widgetid='${e}']`),k=[{name:"preventOverflow",options:{boundary:document.body,rootBoundary:document}}],j=(0,e.Immutable)({}),M=a=>{var l;const{controllerId:r,widgets:s=j,root:c,placement:d,sizes:u,onClose:p}=a,v=e.ReactRedux.useSelector((e=>e.appConfig.widgets)),g=null!==(l=Object.keys(s).find((t=>s[t].state===e.WidgetState.Opened)))&&void 0!==l?l:"",[h,m]=e.React.useState((()=>{var e;return null!==(e=O(g))&&void 0!==e?e:c})),f=R(r,o),b=e.React.useCallback(((t,o)=>{var a;t.stopPropagation();const n=null==f?void 0:f.id,i=x(f,o),l=null===(a=(0,e.getAppStore)().getState().appRuntimeInfo)||void 0===a?void 0:a.selection;l&&l.layoutId===n&&l.layoutItemId===i||(0,e.getAppStore)().dispatch(e.appActions.selectionChanged({layoutId:n,layoutItemId:i}))}),[f]);e.React.useEffect((()=>{var e;m(null!==(e=O(g))&&void 0!==e?e:c)}),[g]);const[y,w]=e.React.useState(u),I=(e,t)=>{t.stopPropagation(),null==p||p(e);const o=null==h?void 0:h.querySelector("button");null==o||o.focus()};return e.React.createElement(e.React.Fragment,null,Object.entries(s).map((([o,a])=>{var l,r;if(void 0===a.state)return null;const s=a.state===e.WidgetState.Opened,c=null!==(l=y[o])&&void 0!==l?l:i,u=null===(r=null==v?void 0:v[o])||void 0===r?void 0:r.label;return e.React.createElement(t.Popper,{key:o,style:{maxWidth:"100vw"},modifiers:k,className:(0,e.classNames)({"d-none":!s},"single-widget-launcher"),headerTitle:u,activateOnlyForHeader:!0,minSize:n,dragBounds:"body",defaultSize:c,onResize:e=>{var t,a;t=o,a=e,w((e=>e.set(t,a)))},onHeaderClose:e=>{I(o,e)},floating:!0,open:!0,autoFocus:s,reference:h,toggle:e=>{((e,t)=>{"Escape"===(null==t?void 0:t.key)&&I(e,t)})(o,e)},onClick:e=>{b(e,o)},placement:d},e.React.createElement(S,{widgetId:o}))})))};var E;!function(e){e.Stack="STACK",e.SideBySide="SIDEBYSIDE"}(E||(E={}));const A=()=>document.body.getBoundingClientRect(),L=(0,e.Immutable)({}),$=a=>{const{mode:n,start:l,spaceX:r,spaceY:s,sizes:c,controllerId:d,widgets:u=L,onClose:p}=a,v=e.ReactRedux.useSelector((e=>e.appConfig.widgets)),[g,h]=e.React.useState(c),m=e.React.useMemo((()=>((t,o)=>{let a=(0,e.Immutable)({});return Object.keys(t).forEach((e=>{a=a.set(e,o[e]||i)})),a})(u,g)),[g,u]),f=R(d,o),b=e.React.useCallback(((t,o)=>{var a;t.stopPropagation();const n=null==f?void 0:f.id,i=x(f,o),l=null===(a=(0,e.getAppStore)().getState().appRuntimeInfo)||void 0===a?void 0:a.selection;l&&l.layoutId===n&&l.layoutItemId===i||(0,e.getAppStore)().dispatch(e.appActions.selectionChanged({layoutId:n,layoutItemId:i}))}),[f]),y=e=>{const t=O(e),o=null==t?void 0:t.querySelector("button");null==o||o.focus()},w=((t,o,a,n,i)=>{const[l,r]=e.React.useState((()=>A())),[s,c]=e.React.useState([a]),d=e.React.useRef(0);e.React.useEffect((()=>{const e=()=>{const e=A();r(e)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const u=(e,t)=>e.right>=t.right||e.left<=t.left,p=(e,t)=>e.bottom>=t.bottom||e.top<=t.top,v=e.hooks.useEventCallback((e=>{if(d.current++,d.current>7)return console.warn(`Number of cycles: ${d.current}.You may have opened too many panels, and now there is not enough space for them to be placed without overstepping and blocking`),e;const o=((e,t)=>!(!e||!t)&&(u(e,t)||p(e,t)))(e,l);if(!o)return e;const{width:n,height:r}=e;let{left:s,top:c,right:g,bottom:h}=e;if(o){const e=u({left:s,top:c,right:g,bottom:h,width:n,height:r},l),o=p({left:s,top:c,right:g,bottom:h,width:n,height:r},l);e&&(s=t===E.SideBySide?a.x:l.right-n),o||t!==E.SideBySide||(c+=i),g=s+n,h=c+r}return v({left:s,top:c,right:g,bottom:h,width:n,height:r})}));return e.React.useEffect((()=>{const e=[];let l={width:0,height:0};Object.keys(o).forEach(((r,s)=>{const c=o[r],u=0!==s?e[s-1]:a;let{x:p,y:g}=u;if(t===E.SideBySide){const{width:e}=l;p+=e,p+=0!==s?n:0}else t===E.Stack&&(p+=0!==s?n:0,g+=0!==s?i:0);const h={left:p,top:g,right:p+c.width,bottom:g+c.height,width:c.width,height:c.height},{left:m,top:f}=v(h);d.current>7?(p=u.x,g=u.y):(p=m,g=f),d.current=0,e.push({x:p,y:g}),l=c})),c(e)}),[t,a,n,i,l.width,l.height,v,o]),s})(n,m,l,r,s);return e.React.createElement(e.React.Fragment,null,Object.entries(u).map((([o,a],n)=>{var i;if(void 0===a.state)return null;const l=a.state===e.WidgetState.Opened,r=w[n];if(!r)return null;const s=m[o],c=null===(i=null==v?void 0:v[o])||void 0===i?void 0:i.label;return e.React.createElement(t.FloatingPanel,{key:o,style:{maxWidth:"100vw"},headerTitle:c,defaultPosition:r,defaultSize:s,className:(0,e.classNames)({"d-none":!l},"multiple-widget-launcher"),showHeaderClose:!0,activateOnlyForHeader:!0,autoFocus:l,dragBounds:"body",onClick:e=>{b(e,o)},onResize:e=>{var t,a;t=o,a=e,h(g.set(t,a))},onLeave:()=>{y(o)},onHeaderClose:e=>{((e,t)=>{null==t||t.stopPropagation(),null==p||p(e),y(e)})(o,e)}},e.React.createElement(S,{widgetId:o}))})))},N=t=>{const o=(0,e.getAppStore)().getState().appConfig.sections,a=Object.values(null!=o?o:{}).find((e=>{var o;return null===(o=e.views)||void 0===o?void 0:o.includes(t)}));return null==a?void 0:a.id},z=t=>{var a,n,l,r,d,p,v,h,m,b,y,S,x,I,k,j,E;const{id:A,config:L,version:z,autoSize:P}=t,T=null!==(n=null===(a=null==L?void 0:L.behavior)||void 0===a?void 0:a.arrangement)&&void 0!==n?n:"floating",W=null===(l=L.behavior)||void 0===l?void 0:l.onlyOpenOne,B=null===(r=L.behavior)||void 0===r?void 0:r.openStarts,H=null===(d=L.behavior)||void 0===d?void 0:d.size,U=null===(p=L.behavior)||void 0===p?void 0:p.vertical,V=null===(v=L.behavior)||void 0===v?void 0:v.displayType,F=null===(h=null==L?void 0:L.appearance)||void 0===h?void 0:h.card,Z=((e,t)=>{const o=null==e?void 0:e.showLabel,a=null==e?void 0:e.labelGrowth,n=null==e?void 0:e.avatar.size,i=null==e?void 0:e.avatar.shape;return u(n,o,i)+t+a})(null===(m=null==L?void 0:L.appearance)||void 0===m?void 0:m.card,null===(b=null==L?void 0:L.appearance)||void 0===b?void 0:b.space),G=null===(x=null===(S=null===(y=(0,e.getAppStore)())||void 0===y?void 0:y.getState())||void 0===S?void 0:S.appContext)||void 0===x?void 0:x.isRTL,_=null===(j=null===(k=null===(I=(0,e.getAppStore)())||void 0===I?void 0:I.getState())||void 0===k?void 0:k.appContext)||void 0===j?void 0:j.isInBuilder,D=e.React.useMemo((()=>G?Object.assign(Object.assign({},s),{x:document.body.clientWidth-i.width-s.x}):s),[G]),Y=e.React.useMemo((()=>G?Object.assign(Object.assign({},c),{x:-c.x}):c),[G]),q=U?"right-start":"bottom",K=(t=>{const o=e.ReactRedux.useSelector((e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.sectionNavInfos}));return((t,o)=>{const a=(t=>{const o=(0,e.getAppStore)().getState().appConfig.sections,a=t?Object.values(t).map((e=>e.currentViewId)):[],n=a.map(N),i=Object.values(null!=o?o:{}).map((e=>{var t;if(!n.includes(e.id))return null===(t=e.views)||void 0===t?void 0:t[0]})).filter((e=>!!e)),l=a;return i.forEach((e=>{a.includes(e)||l.push(e)})),l})(t),n=(0,e.getAppStore)().getState().browserSizeMode,i=(0,e.getAppStore)().getState().appConfig,l=g.searchUtils.getContentContainerInfo(i,o,e.LayoutItemType.Widget,n);let r=!0;if(!l)return r;if(l.type===e.ContainerType.View)if(a.includes(l.id)){const t=l.id,o=N(t),s=g.searchUtils.getContentContainerInfo(i,o,e.LayoutItemType.Section,n);s&&s.type===e.ContainerType.View&&(a.includes(s.id)||(r=!1))}else r=!1;return r})(o,t)})(A),X=(t=>e.ReactRedux.useSelector((o=>{var a;const n=o.appConfig,i=o.browserSizeMode,l=g.searchUtils.getParentWidgetIdOfContent(n,t,e.LayoutItemType.Widget,i),r=n.widgets[l];return"arcgis-map"===(null===(a=null==r?void 0:r.manifest)||void 0===a?void 0:a.name)?r.id:""})))(A),J=e.hooks.useCheckSmallBrowserSizeMode(),Q=e.ReactRedux.useSelector((e=>e.appRuntimeInfo.currentPageId)),ee=W&&"floating"===T,te=!W&&"floating"===T,oe=e.React.useRef(null),ae=((t,o)=>{const a=e.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo)),n=(e=>{const t=(e=>{var t,o,a;let n=(null!==(a=null===(o=null===(t=null==e?void 0:e.order)||void 0===t?void 0:t.asMutable)||void 0===o?void 0:o.call(t))&&void 0!==a?a:[]).map((t=>{var o;return null===(o=e.content)||void 0===o?void 0:o[t]}));return n=n.filter((e=>e&&e.id&&e.widgetId&&!e.isPending)),n.map((e=>e.id))})(e);return t.map((t=>{var o,a;return null===(a=null===(o=e.content)||void 0===o?void 0:o[t])||void 0===a?void 0:a.widgetId}))})(R(t,o));return e.React.useMemo((()=>{const t={};return n.forEach((o=>{var n;const i=null!==(n=null==a?void 0:a[o])&&void 0!==n?n:{isClassLoaded:!1};t[o]=(0,e.Immutable)(i)})),(0,e.Immutable)(t)}),[n,a])})(A,o),ne=Object.keys(ae),ie=ne.filter((t=>ae[t].state===e.WidgetState.Opened)),le=e.React.useCallback((t=>{var o;const a=null===(o=t.currentTarget.dataset)||void 0===o?void 0:o.widgetid;a&&(J||W?((0,e.getAppStore)().dispatch(e.appActions.closeWidgets(ie)),ie.includes(a)||(0,e.getAppStore)().dispatch(e.appActions.openWidget(a,A))):ie.includes(a)?(0,e.getAppStore)().dispatch(e.appActions.closeWidget(a)):(0,e.getAppStore)().dispatch(e.appActions.openWidget(a,A)))}),[J,W,ie,A]),re=t=>{if(!t)return;(0,e.getAppStore)().dispatch(e.appActions.closeWidget(t));const o=O(t);null==o||o.focus()};e.hooks.useUpdateEffect((()=>{(0,e.getAppStore)().dispatch(e.appActions.closeWidgets(ie))}),[z,Q]),e.hooks.useUpdateEffect((()=>{K||(0,e.getAppStore)().dispatch(e.appActions.closeWidgets(ie))}),[K]),e.React.useEffect((()=>{!_&&(null==B?void 0:B.length)&&K&&setTimeout((()=>{(0,e.getAppStore)().dispatch(e.appActions.openWidgets(B,A))}),1e3)}),[]);const se=e.React.useCallback(((t,o)=>{const a=ie.includes(t);return e.React.createElement(f,Object.assign({},F,{key:t,className:`${o} layout-item`,widgetid:t,markerEnabled:!1,active:a,onClick:le}))}),[F,le,ie]);return e.React.createElement("div",{className:"controller-runtime w-100 h-100"},J&&e.React.createElement(C,{containerMapId:X,controllerId:A,widgets:ae,onClose:re}),!J&&e.React.createElement(e.React.Fragment,null,ee&&e.React.createElement(M,{sizes:H,root:oe.current,placement:q,controllerId:A,widgets:ae,onClose:re}),te&&e.React.createElement($,{sizes:H,mode:V,start:D,spaceX:Y.x,spaceY:Y.y,controllerId:A,widgets:ae,onClose:re})),e.React.createElement(w,{ref:oe,className:"runtime--scroll-list",vertical:U,itemLength:Z,space:null===(E=L.appearance)||void 0===E?void 0:E.space,autoHideArrow:!0,autoSize:P,lists:ne,createItem:se}))},P={behavior:{onlyOpenOne:!0,openStarts:[],displayType:"STACK",vertical:!1,size:{}},appearance:{space:0,advanced:!1,card:{showLabel:!1,labelGrowth:10,avatar:{type:"primary",size:"default",shape:"circle"}}}};class T extends e.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"Version manager for release 1.0.0",upgrader:e=>{if(!e)return P;if(e.behavior&&e.appearance)return e;{let o=e;return e.behavior||(o=o.setIn(["behavior","openStarts"],[]),o=o.setIn(["behavior","onlyOpenOne"],e.onlyOpenOne),o=o.setIn(["behavior","displayType"],e.displayType),o=o.setIn(["behavior","vertical"],e.vertical),o=o.setIn(["behavior","size"],e.size),o=o.without(["onlyOpenOne","displayType","size"])),e.appearance||(o=o.setIn(["appearance","advanced"],!1),e.vertical?o=o.setIn(["appearance","space"],e.space):(o=o.setIn(["appearance","space"],0),o=o.setIn(["appearance","card","labelGrowth"],e.space)),o=o.setIn(["appearance","card","showLabel"],e.showLabel),o=o.setIn(["appearance","card","avatar","size"],"SMALL"===(t=e.iconSize)?"sm":"MEDIUM"===t?"default":"LARGE"===t?"lg":t),o=o.setIn(["appearance","card","avatar","shape"],e.iconStyle),o=o.setIn(["appearance","card","avatar","type"],"primary"),o=o.without(["space","showLabel","iconSize","iconStyle","vertical"])),o}var t}},{version:"1.1.0",description:"Version manager for release 1.1.0",upgrader:e=>{var t,o;if(!e)return P;let a=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card;const n=null==a?void 0:a.variants,i=null===(o=null==a?void 0:a.avatar)||void 0===o?void 0:o.type;let l=e;if(n){const e=((e,t="primary")=>null==e?void 0:e[t])(n,i);a=null==a?void 0:a.set("variant",e).without("variants"),l=l.setIn(["appearance","card"],a)}return l}},{version:"1.6.0",description:"Version manager for release 1.6.0",upgrader:e=>{var t;if(!e)return P;let o=null===(t=null==e?void 0:e.appearance)||void 0===t?void 0:t.card,a=e;return o&&(o=o.set("showTooltip",!0),a=a.setIn(["appearance","card"],o)),a}}]}}const W=new T,B=o=>{var n,i,l,r;const{builderSupportModules:s,id:c,config:d,onInitResizeHandler:u,autoWidth:p,autoHeight:v}=o,g=null===(n=d.behavior)||void 0===n?void 0:n.onlyOpenOne,h=null===(i=d.behavior)||void 0===i?void 0:i.displayType,m=null===(l=null==d?void 0:d.behavior)||void 0===l?void 0:l.vertical,f=null==d?void 0:d.appearance.advanced,b=null===(r=null==d?void 0:d.appearance)||void 0===r?void 0:r.card.variant,y=m?v:p,w=e.ReactRedux.useSelector((e=>e.appContext.isInBuilder)),S=e.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode)),R=e.ReactRedux.useSelector((e=>e.browserSizeMode));e.React.useEffect((()=>{null==u||u(null,null,(()=>{O((e=>e+1))}))}),[u]);const x=w&&S!==e.AppMode.Run,I=x&&s.widgetModules.Builder,[C,O]=e.React.useState(0);e.hooks.useUpdateEffect((()=>{O((e=>e+1))}),[g,h,S,R]);const k=((t,o,n)=>{const i=t?0:a.sm,l=t?0:a.sm,r=o?"5px":0,s=n?"5px":0;return e.React.useMemo((()=>e.css`
      overflow: hidden;
      white-space: nowrap;
      .controller-container {
        width: 100%;
        height: 100%;
        padding: ${s} ${r};
        min-width:  ${i}px;
        min-height: ${l}px;
      }
    `),[r,s,i,l])})(y,p,v),j=((o,a)=>{const n=null==o?void 0:o.default,i=null==o?void 0:o.active,l=null==o?void 0:o.hover;return e.React.useMemo((()=>a?e.css`
      .avatar-card:not(.add-widget-btn) {
        ${n&&e.css`
          > .avatar {
            > .avatar-button {
              background-color: ${n.bg};
              border-color: ${n.bg};
            }
          }
          > .avatar-label {
            color: ${n.color};
            font-style: ${(null==n?void 0:n.italic)?"italic":"normal"};
            font-weight: ${(null==n?void 0:n.bold)?"bold":"normal"};
            text-decoration: ${t.styleUtils.toCSSTextUnderLine({underline:n.underline,strike:n.strike})};
          }
        `}
        ${l&&e.css`
          &:hover {
            > .avatar {
              > .avatar-button {
                background-color: ${l.bg};
                border-color: ${l.bg};
              }
            }
            > .avatar-label {
              color: ${l.color};
              font-style: ${(null==l?void 0:l.italic)?"italic":"normal"};
              font-weight: ${(null==l?void 0:l.bold)?"bold":"normal"};
              text-decoration: ${t.styleUtils.toCSSTextUnderLine({underline:l.underline,strike:l.strike})};
            }
          }
        `}
        ${i&&e.css`
          > .avatar {
            > .avatar-button {
              &:not(:disabled):not(.disabled):active,
              &:not(:disabled):not(.disabled).active,
              &[aria-expanded='true'] {
                background-color: ${i.bg};
                border-color: ${i.bg};
              }
            }
          }
          > .avatar-label {
            &:not(:disabled):not(.disabled):active,
            &:not(:disabled):not(.disabled).active {
              color: ${i.color};
              font-style: ${(null==i?void 0:i.italic)?"italic":"normal"};
              font-weight: ${(null==i?void 0:i.bold)?"bold":"normal"};
              text-decoration: ${t.styleUtils.toCSSTextUnderLine({underline:i.underline,strike:i.strike})};
            }
          }
        `}
      }
    `:e.css``),[a,n,i,l])})(b,f);return(0,e.jsx)("div",{className:"widget-controller jimu-widget shadow rw-controller",css:[k,j]},(0,e.jsx)("div",{className:"controller-container"},!x&&(0,e.jsx)(z,{id:c,version:C,config:d,autoSize:y}),x&&I&&(0,e.jsx)(I,{id:c,version:C,config:d,autoSize:y})))};B.versionManager=W;const H=B;function U(e){l.p=e}})(),r})())}}}));