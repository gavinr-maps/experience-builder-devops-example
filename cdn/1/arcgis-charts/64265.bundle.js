"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([[64265],{20776:(e,t,n)=>{n.d(t,{Z:()=>p});var i=n(66341),r=n(70375),a=n(69079),o=n(78668),s=n(53729),l=n(20182),c=n(12928);const u=[137,80,78,71,13,10,26,10];function h(e){const t=new Uint8Array(e);return!u.some(((e,n)=>e!==t[n]))}function d(e){if(!h(e))return!1;const t=new DataView(e),n=new Uint8Array(e);let i,r=8;do{const e=t.getUint32(r);if(i=String.fromCharCode.apply(String,Array.prototype.slice.call(n.subarray(r+4,r+8))),"acTL"===i)return!0;r+=12+e}while("IEND"!==i&&r<n.length);return!1}var f=n(29573),g=n(60211);const m=[71,73,70];class p{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const n=this._resourceMap.get(e);if(n)return{width:n.width,height:n.height};let a=this._inFlightResourceMap.get(e);return a?a.then((e=>({width:e.width,height:e.height}))):(a=async function(e,t){const{arrayBuffer:n,mediaType:a}=await async function(e,t){let n;const a=";base64,";if(e.includes(a)){const t=e.indexOf(a),i=e.indexOf(a)+a.length,r=e.substring(i);n={arrayBuffer:(0,s.R)(r),mediaType:e.substring(0,t).replace("data:","")}}else try{const r=await(0,i.default)(e,{responseType:"array-buffer",...t});n={arrayBuffer:r.data,mediaType:r.getHeader("Content-Type")}}catch(t){if(!(0,o.D_)(t))throw new r.Z("mapview-invalid-resource",`Could not fetch requested resource at ${e}`)}return n}(e,t),u="image/png"===a;return"image/gif"===a&&function(e){if(!function(e){const t=new Uint8Array(e);return!m.some(((e,n)=>e!==t[n]))}(e))return!1;const t=new DataView(e),n=t.getUint8(10);let i=13+(128&n?3*2**(1+(7&n)):0),r=0,a=!1;for(;!a;){switch(t.getUint8(i++)){case 33:if(!o())return!1;break;case 44:s();break;case 59:a=!0;break;default:return!1}if(r>1)return!0}function o(){switch(t.getUint8(i++)){case 249:i++,i+=4,l();break;case 1:r++,i++,i+=12,l();break;case 254:l();break;case 255:i++,i+=8,i+=3,l();break;default:return!1}return!0}function s(){r++,i+=8;const e=t.getUint8(i++);i+=128&e?3*2**(1+(7&e)):0,i++,l()}function l(){let e;for(;e=t.getUint8(i++);)i+=e}return!1}(n)?async function(e,t){const n=(0,g.p)(e),i=(0,g.d)(n,!0),{width:r,height:a}=n.lsd,o=document.createElement("canvas");o.width=r,o.height=a;const s=o.getContext("2d",{willReadFrequently:!0}),l=[],u=[];for(const e of i){u.push((0,c.HA)(e.delay||100));const t=new ImageData(e.patch,e.dims.width,e.dims.height),n=(0,f.E0)(t),i=3===e.disposalType?s.getImageData(e.dims.left,e.dims.top,e.dims.width,e.dims.height):void 0;s.drawImage(n,e.dims.left,e.dims.top);const o=s.getImageData(0,0,r,a);l.push(o),1===e.disposalType||(2===e.disposalType?s.clearRect(e.dims.left,e.dims.top,e.dims.width,e.dims.height):3===e.disposalType&&s.putImageData(i,e.dims.left,e.dims.top))}return{frameDurations:u,getFrame:e=>l[e],width:r,height:a}}(n):u&&d(n)?async function(e,t){const n=(0,l.p)(e);if(n instanceof Error)throw n;await n.createImages(),(0,o.k_)(t);const{frames:i,width:r,height:a}=n,s=document.createElement("canvas");s.width=r,s.height=a;const u=s.getContext("2d",{willReadFrequently:!0}),h=[],d=[];for(const e of i){d.push((0,c.HA)(e.delay||100));const t=e.imageElement;0===e.blendOp?u.globalCompositeOperation="copy":u.globalCompositeOperation="source-over";const n=2===e.disposeOp?u.getImageData(e.left,e.top,e.width,e.height):void 0;u.drawImage(t,e.left,e.top);const i=u.getImageData(0,0,r,a);h.push(i),0===e.disposeOp||(1===e.disposeOp?u.clearRect(e.left,e.top,e.width,e.height):2===e.disposeOp&&u.putImageData(n,e.left,e.top))}return{frameDurations:d,getFrame:e=>h[e],width:r,height:a}}(n,t):async function(e,t){const n=window.URL.createObjectURL(e);try{const{data:e}=await(0,i.default)(n,{...t,responseType:"image"});return e}catch(e){if(!(0,o.D_)(e))throw new r.Z("mapview-invalid-resource",`Could not fetch requested resource at ${n}`);throw e}finally{window.URL.revokeObjectURL(n)}}(new Blob([n],{type:a}),t)}(e,t),this._inFlightResourceMap.set(e,a),a.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,a.mx)(e)}}},25609:(e,t,n)=>{var i,r,a,o,s,l,c,u,h,d,f,g,m,p,y,C,w,R,b,v,P,S,M,T,L,F,B,D,A,x,I,O,_,k,N,E,z,U,W,H,X,G,Y,J,Z,q,$,Q,V,j,K,ee,te,ne,ie,re,ae,oe,se,le,ce;n.d(t,{$y:()=>S,AH:()=>r,CS:()=>$,DD:()=>u,Dd:()=>A,Em:()=>P,JS:()=>Z,Ky:()=>h,Lh:()=>Q,Qb:()=>ae,RL:()=>i,RS:()=>se,TF:()=>v,Tx:()=>s,UR:()=>w,UX:()=>re,bj:()=>q,eZ:()=>c,id:()=>L,kP:()=>E,of:()=>f,r4:()=>H,sj:()=>z,v2:()=>a,zQ:()=>D,zV:()=>C}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(i||(i={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(r||(r={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(a||(a={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(o||(o={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(s||(s={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(c||(c={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(u||(u={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(h||(h={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(d||(d={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(f||(f={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(g||(g={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(m||(m={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(p||(p={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(y||(y={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(C||(C={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(w||(w={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(R||(R={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(b||(b={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(v||(v={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(P||(P={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(S||(S={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(M||(M={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(T||(T={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(L||(L={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(F||(F={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(B||(B={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(D||(D={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(A||(A={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(x||(x={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(I||(I={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(O||(O={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(_||(_={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(k||(k={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(N||(N={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(E||(E={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(z||(z={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(U||(U={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(W||(W={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(H||(H={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(X||(X={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(G||(G={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(Y||(Y={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(J||(J={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(Z||(Z={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(q||(q={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}($||($={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(Q||(Q={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(V||(V={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(j||(j={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(K||(K={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(ee||(ee={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(te||(te={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(ne||(ne={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(ie||(ie={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(re||(re={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(ae||(ae={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(oe||(oe={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(se||(se={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(le||(le={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(ce||(ce={}))},48024:(e,t,n)=>{n.r(t),n.d(t,{previewCIMSymbol:()=>L});var i,r,a=n(95550),o=n(95215),s=n(30936),l=n(66341),c=n(61681),u=n(78668),h=n(24361),d=n(20776),f=n(34245),g=n(556),m=n(89417),p=n(60789),y=n(97500),C=n(37939);(r=i||(i={})).Legend="legend",r.Preview="preview";const w=e=>e&&e.scaleFactor?e.scaleFactor:1;var R=n(83773),b=n(5840);const v=new class{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._imageDataCanvas=null,this._pictureMarkerCache=new Map,this._textRasterizer=new m.Z,this._cimResourceManager=new d.Z,this._rasterizer=new g.Z(this._cimResourceManager)}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,n,i,r,a,s,l){if(!e)return null;const{data:c}=e;if(!c||"CIMSymbolReference"!==c.type||!c.symbol)return null;const{symbol:u}=c;a||(a=(0,p.JW)(u));const h=await o.E0.resolveSymbolOverrides(c,t,this._spatialReference,r,a,s,l);this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const d=this._imageDataCanvas,g=this._cimResourceManager,m=[];o.B$.fetchResources(h,g,m),o.B$.fetchFonts(h,g,m),m.length>0&&await Promise.all(m);const{width:y,height:C}=n,w=function(e,t,n,i){const r=-t/2+1,a=t/2-1,o=n/2-1,s=-n/2+1;switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[r,0],[0,0],[a,0]]]};default:return"legend"===i?{rings:[[[r,o],[a,0],[a,s],[r,s],[r,o]]]}:{rings:[[[r,o],[a,o],[a,s],[r,s],[r,o]]]}}}(a,y,C,i),R=o.B$.getEnvelope(h,w,g);if(!R)return null;const b=1.3333333333333333*(window.devicePixelRatio||1);let v=1,P=0,S=0;switch(u.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;R.width>y&&(e=y/R.width);let t=1;R.height>C&&(t=C/R.height),"preview"===i&&(R.width<y&&(e=y/R.width),R.height<C&&(t=C/R.height)),v=Math.min(e,t),P=R.x+R.width/2,S=R.y+R.height/2}break;case"CIMLineSymbol":{let e=1;R.height>C&&(e=C/R.height),v=e,S=R.y+R.height/2;const t=R.x*v+y/2,n=(R.x+R.width)*v+y/2;if(t<0){const{paths:e}=w;e[0][0][0]-=t}if(n>y){const{paths:e}=w;e[0][2][0]-=n-y}}break;case"CIMPolygonSymbol":{P=R.x+R.width/2,S=R.y+R.height/2;const e=R.x*v+y/2,t=(R.x+R.width)*v+y/2,n=R.y*v+C/2,i=(R.y+R.height)*v+C/2,{rings:r}=w;e<0&&(r[0][0][0]-=e,r[0][3][0]-=e,r[0][4][0]-=e),n<0&&(r[0][0][1]+=n,r[0][1][1]+=n,r[0][4][1]+=n),t>y&&(r[0][1][0]-=t-y,r[0][2][0]-=t-y),i>C&&(r[0][2][1]+=i-C,r[0][3][1]+=i-C)}}d.width=y*b,d.height=C*b,d.width+=2,d.height+=2;const M=d.getContext("2d"),T=f.zA.createIdentity();return T.translate(-P,-S),T.scale(v*b,-v*b),T.translate(y*b/2+1,C*b/2+1),M.clearRect(0,0,d.width,d.height),new f.cD(M,g,T,!0).drawSymbol(h,w),M.getImageData(0,0,d.width,d.height)}async analyzeCIMSymbol3D(e,t,n,i,r){const a=[],s=t?{geometryType:i,spatialReference:this._spatialReference,fields:t}:null,l=[];o.B$.fetchFonts(e.data.symbol,this._cimResourceManager,l),await Promise.all(l);const c=new h._(this._cimResourceManager,s);let d;await c.analyzeSymbolReference(e.data,this._avoidSDF,a),(0,u.k_)(r);for(const e of a)"CIMPictureMarker"!==e.cim.type&&"CIMPictureFill"!==e.cim.type&&"CIMPictureStroke"!==e.cim.type||(d||(d=[]),d.push(this._fetchPictureMarkerResource(e,r))),n&&"text"===e.type&&"string"==typeof e.text&&e.text.includes("[")&&(e.text=(0,p.Qs)(n,e.text,e.cim.textCase));return d&&await Promise.all(d),a}rasterizeCIMSymbol3D(e,t,n,i,r,a){const o=[];for(const s of e){i&&"function"==typeof i.scaleFactor&&(i.scaleFactor=i.scaleFactor(t,r,a));const e=this._getRasterizedResource(s,t,n,i,r,a);if(!e)continue;let l=0,c=e.anchorX||0,u=e.anchorY||0,h=!1,d=0,f=0;if("esriGeometryPoint"===n){const e=w(i);if(d=(0,p.hf)(s.offsetX,t,r,a)*e||0,f=(0,p.hf)(s.offsetY,t,r,a)*e||0,"marker"===s.type)l=(0,p.hf)(s.rotation,t,r,a)||0,h=s.rotateClockwise??!1;else if("text"===s.type){if(l=(0,p.hf)(s.angle,t,r,a)||0,void 0!==s.horizontalAlignment)switch(s.horizontalAlignment){case"left":c=-.5;break;case"right":c=.5;break;default:c=0}if(void 0!==s.verticalAlignment)switch(s.verticalAlignment){case"top":u=.5;break;case"bottom":u=-.5;break;case"baseline":u=-.25;break;default:u=0}}}null!=e&&o.push({angle:l,rotateClockWise:h,anchorX:c,anchorY:u,offsetX:d,offsetY:f,rasterizedResource:e})}return this.getSymbolImage(o)}getSymbolImage(e){const t=document.createElement("canvas"),n=(0,c.s3)(t.getContext("2d"));let i=0,r=0,o=0,s=0;const l=[];for(let t=0;t<e.length;t++){const c=e[t],u=c.rasterizedResource;if(!u)continue;const h=u.size,d=c.offsetX,f=c.offsetY,g=c.anchorX,m=c.anchorY,p=c.rotateClockWise||!1;let y=c.angle,C=(0,a.F2)(d)-h[0]*(.5+g),w=(0,a.F2)(f)-h[1]*(.5+m),R=C+h[0],b=w+h[1];if(y){p&&(y=-y);const e=Math.sin(y*Math.PI/180),t=Math.cos(y*Math.PI/180),n=C*t-w*e,i=C*e+w*t,r=C*t-b*e,a=C*e+b*t,o=R*t-b*e,s=R*e+b*t,l=R*t-w*e,c=R*e+w*t;C=Math.min(n,r,o,l),w=Math.min(i,a,s,c),R=Math.max(n,r,o,l),b=Math.max(i,a,s,c)}i=C<i?C:i,r=w<r?w:r,o=R>o?R:o,s=b>s?b:s;const v=n.createImageData(u.size[0],u.size[1]);v.data.set(new Uint8ClampedArray(u.image.buffer));const P={offsetX:d,offsetY:f,rotateClockwise:p,angle:y,rasterizedImage:v,anchorX:g,anchorY:m};l.push(P)}t.width=o-i,t.height=s-r;const u=-i,h=s;for(let e=0;e<l.length;e++){const t=l[e],i=this._imageDataToCanvas(t.rasterizedImage),r=t.rasterizedImage.width,o=t.rasterizedImage.height,s=u-r*(.5+t.anchorX),c=h-o*(.5-t.anchorY);if(t.angle){const e=(360-t.angle)*Math.PI/180;n.save(),n.translate((0,a.F2)(t.offsetX),-(0,a.F2)(t.offsetY)),n.translate(u,h),n.rotate(e),n.translate(-u,-h),n.drawImage(i,s,c),n.restore()}else n.drawImage(i,s+(0,a.F2)(t.offsetX),c-(0,a.F2)(t.offsetY))}const d=new C.e({x:u/t.width-.5,y:h/t.height-.5});return{imageData:0!==t.width&&0!==t.height?n.getImageData(0,0,t.width,t.height):n.createImageData(1,1),anchorPosition:d}}async _fetchPictureMarkerResource(e,t){const n=e.materialHash;if(!this._pictureMarkerCache.get(n)){const i=(await(0,l.default)(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(n,i)}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,n=(0,c.s3)(t.getContext("2d"));return t.width=e.width,t.height=e.height,n.putImageData(e,0,0),t}_imageTo32Array(e,t,n,i){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const r=this._imageDataCanvas,a=(0,c.s3)(r.getContext("2d"));if(r.width=t,r.height=n,a.drawImage(e,0,0,t,n),i){a.save();const r=new s.Z(i);a.fillStyle=r.toHex(),a.globalCompositeOperation="multiply",a.fillRect(0,0,t,n),a.globalCompositeOperation="destination-atop",a.drawImage(e,0,0,t,n),a.restore()}return new Uint32Array(a.getImageData(0,0,t,n).data.buffer)}_getRasterizedResource(e,t,n,i,r,a){let o,s,l;if("text"===e.type)return this._rasterizeTextResource(e,t,i,r,a);({analyzedCIM:o,hash:s}=function(e,t,n,i){let r,a;return"function"==typeof e.materialHash?(r=(0,e.materialHash)(t,n,i),a=(0,h.S)(e.cim,e.materialOverrides)):(r=e.materialHash,a=e.cim),{analyzedCIM:a,hash:r}}(e,t,r,a));const u=w(i);if("CIMPictureMarker"===e.cim.type){const n=(0,p.hf)(e.size,t,r,a)*u,{image:i,width:o,height:s}=(0,c.s3)(this._getPictureResource(e,n,(0,p.hf)(e.color,t,r,a)));return l={image:i,size:[o,s],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},l}(0,y.FW)(o,u,{preserveOutlineWidth:!1});const d=o;s+=n,i&&(s+=JSON.stringify(i));const f=this._resourceCache;return f.has(s)?f.get(s):(l=this._rasterizer.rasterizeJSONResource({cim:d,type:e.type,url:e.url,mosaicHash:s,size:null,path:null},window.devicePixelRatio||1,this._avoidSDF),f.set(s,l),l)}_rasterizeTextResource(e,t,n,i,r){const a=w(n),o=(0,p.hf)(e.text,t,i,r);if(!o||0===o.length)return null;const s=e.cim,l=(0,p.hf)(s?.fontFamilyName||e.fontName,t,i,r),c=(0,p.hf)(s?.font?.style||e.style,t,i,r),u=(0,p.hf)(s?.font?.weight||e.weight,t,i,r),h=(0,p.hf)(s?.font?.decoration||e.decoration,t,i,r),d=(0,p.hf)(e.size,t,i,r)*a,f=(0,p.hf)(e.horizontalAlignment,t,i,r),g=(0,p.hf)(e.verticalAlignment,t,i,r),m=(0,p.nn)((0,p.hf)(e.color,t,i,r)),y=(0,p.nn)((0,p.hf)(e.outlineColor,t,i,r)),C=(0,p.hf)(e.outlineSize,t,i,r),R=null!=e.backgroundColor?(0,p.nn)(e.backgroundColor):null,b=null!=e.borderLineColor?(0,p.nn)(e.borderLineColor):null,v=null!=e.borderLineWidth?e.borderLineWidth:null,P={color:m,size:d,horizontalAlignment:f,verticalAlignment:g,font:{family:l,style:c,weight:u,decoration:h},halo:{size:C||0,color:y,style:c},backgroundColor:R,borderLine:null!=b&&null!=v?{color:b,size:v}:null,pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(o,P)}_getPictureResource(e,t,n){const i=this._pictureMarkerCache.get(e.materialHash);if(!i)return null;const r=i.height/i.width,o=t?r>1?(0,a.F2)(t):(0,a.F2)(t)/r:i.width,s=t?r>1?(0,a.F2)(t)*r:(0,a.F2)(t):i.height;return{image:this._imageTo32Array(i,o,s,n),width:o,height:s}}}(null,!0),P=(0,a.Wz)(R.b_.size),S=(0,a.Wz)(R.b_.maxSize),M=(0,a.Wz)(R.b_.lineWidth),T=1;async function L(e,t={}){const{node:n,opacity:r,symbolConfig:s}=t,l=null!=s&&"object"==typeof s&&"isSquareFill"in s&&s.isSquareFill,c=t.cimOptions||t,u=c.geometryType||(0,p.JW)(e?.data?.symbol),h=function(e){const t=e?.size;return"number"==typeof t?{width:t,height:t}:{width:null!=t&&"object"==typeof t&&"width"in t?t.width:null,height:null!=t&&"object"==typeof t&&"height"in t?t.height:null}}(t),{feature:d,fieldMap:f}=c;if(null==h.width||null==h.height){const t=await o.E0.resolveSymbolOverrides(e.data,d,null,f,u);if(!t)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:t},e.data.primitiveOverrides=void 0;const n=[];o.B$.fetchResources(t,v.resourceManager,n),o.B$.fetchFonts(t,v.resourceManager,n),n.length>0&&await Promise.all(n);const i=o.B$.getEnvelope(t,null,v.resourceManager),r=i?.width,a=i?.height;h.width="esriGeometryPolygon"===u?P:"esriGeometryPolyline"===u?M:null!=r&&isFinite(r)?Math.min(r,S):P,h.height="esriGeometryPolygon"===u?P:null!=a&&isFinite(a)?Math.max(Math.min(a,S),T):P}const g=await v.rasterizeCIMSymbolAsync(e,d,h,l||"esriGeometryPolygon"!==u?i.Preview:i.Legend,f,u);if(!g)return null;const{width:m,height:y}=g,C=document.createElement("canvas");C.width=m,C.height=y,C.getContext("2d").putImageData(g,0,0);const w=(0,a.F2)(h.width),R=(0,a.F2)(h.height),L=new Image(w,R);L.src=C.toDataURL(),L.ariaLabel=t.ariaLabel??null,L.alt=t.ariaLabel??"",null!=r&&(L.style.opacity=`${r}`);let F=L;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:w,height:R,src:L.src},fill:null,stroke:null,offset:[0,0]};F=(0,b.wh)([[e]],[w,R],{effectView:t.effectView,ariaLabel:t.ariaLabel})}return n&&F&&n.appendChild(F),F}},31090:(e,t,n)=>{var i,r;function a(e){switch(e){case"left":return i.Left;case"right":return i.Right;case"center":return i.Center}}function o(e){switch(e){case"top":return r.Top;case"middle":return r.Center;case"baseline":return r.Baseline;case"bottom":return r.Bottom}}function s(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[i.Right,r.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[i.Center,r.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[i.Left,r.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[i.Right,r.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[i.Center,r.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[i.Left,r.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[i.Right,r.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[i.Center,r.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[i.Left,r.Top];default:return console.debug(`Found invalid placement type ${e}`),[i.Center,r.Center]}}function l(e){switch(e){case i.Right:return-1;case i.Center:return 0;case i.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function c(e){switch(e){case r.Top:return 1;case r.Center:return 0;case r.Bottom:case r.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function u(e){switch(e){case"left":return i.Left;case"right":return i.Right;case"center":return i.Center}}function h(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}n.d(t,{Hd:()=>u,M7:()=>i,NS:()=>h,TR:()=>r,b7:()=>o,g:()=>l,kH:()=>a,qv:()=>s,tf:()=>c}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(i||(i={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(r||(r={}))},14266:(e,t,n)=>{n.d(t,{$0:()=>u,AI:()=>r,Al:()=>y,By:()=>P,C1:()=>$,CQ:()=>V,CU:()=>H,D3:()=>p,Ex:()=>f,I_:()=>o,Ic:()=>C,Ij:()=>b,Ip:()=>Z,Iv:()=>te,Iw:()=>g,Jw:()=>L,Ls:()=>s,MI:()=>q,QU:()=>T,SD:()=>ie,Tz:()=>j,U:()=>oe,Uh:()=>Q,V4:()=>W,X0:()=>Y,XD:()=>ue,XJ:()=>J,Xj:()=>M,Zd:()=>N,_5:()=>D,_6:()=>ne,a:()=>X,aK:()=>I,dn:()=>U,e0:()=>ee,eF:()=>m,eV:()=>h,f2:()=>v,fL:()=>G,iJ:()=>w,iV:()=>E,jk:()=>re,kF:()=>F,lK:()=>O,m4:()=>_,mx:()=>S,nM:()=>R,nb:()=>ce,oK:()=>K,pU:()=>x,qf:()=>c,ru:()=>a,tQ:()=>z,tz:()=>se,u4:()=>le,uG:()=>k,uQ:()=>l,vw:()=>ae,xl:()=>A,xm:()=>d,yP:()=>B});var i=n(39994);const r=1e-30,a=4294967295,o=512,s=128,l=511,c=16777216,u=8,h=10,d=29,f=24,g=8,m={metrics:{width:15,height:17,left:0,top:-7,advance:14}},p=0,y=0,C=0,w=1,R=2,b=3,v=4,P=5,S=6,M=12,T=5,L=6,F=5,B=6,D=0,A=1,x=2,I=3,O=4,_=2,k=1,N=2,E=4,z=1.05,U=(0,i.Z)("featurelayer-force-marker-text-draw-order")?.5:3,W=5,H=6,X=1.15,G=2,Y=128-2*G,J=8,Z=500,q=10,$=1024,Q=2,V=0,j=1,K=4,ee=8,te=16,ne=4,ie=1,re=4,ae=8,oe=32,se=64,le=128,ce=4,ue=2},8530:(e,t,n)=>{n.d(t,{Au:()=>r,Jz:()=>o,UJ:()=>a});const i=new Float32Array(1);function r(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function a(e,t){return 65535&e|t<<16}function o(e,t,n,i){return 255&e|(255&t)<<8|(255&n)<<16|i<<24}new Uint32Array(i.buffer)}}]);