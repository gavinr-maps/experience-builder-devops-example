define(["require","exports","esri/rest/support/JobInfo","esri/rest/geoprocessor","esri/request","esri/core/urlUtils","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/Polygon","esri/identity/IdentityManager","esri/core/reactiveUtils","esri/rest/support/Query","esri/core/promiseUtils","esri/portal/PortalItemResource","esri/layers/FeatureLayer","esri/geometry/support/jsonUtils","esri/layers/Layer","esri/portal/PortalItem","esri/layers/support/Field","esri/renderers/Renderer","esri/rest/support/FeatureSet","esri/config","esri/smartMapping/statistics/uniqueValues","esri/core/sql"],(function(e,t,r,n,o,i,a,s,c,u,l,f,d,p,y,v,b,h,g,m,j,_,w,O){"use strict";function S(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var P=S(r),E=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}(n),A=S(o),k=S(u),T=S(y),$=S(h),I=S(g),C=S(m),x=S(j),z=S(_);function N(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function U(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())}))}var L="object"==typeof global&&global&&global.Object===Object&&global,F="object"==typeof self&&self&&self.Object===Object&&self,R=L||F||Function("return this")(),D=R.Symbol,M=Object.prototype,J=M.hasOwnProperty,B=M.toString,V=D?D.toStringTag:void 0,G=Object.prototype.toString,H=D?D.toStringTag:void 0;function q(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":H&&H in Object(e)?function(e){var t=J.call(e,V),r=e[V];try{e[V]=void 0;var n=!0}catch(e){}var o=B.call(e);return n&&(t?e[V]=r:delete e[V]),o}(e):function(e){return G.call(e)}(e)}function W(e){return null!=e&&"object"==typeof e}function K(e){return"symbol"==typeof e||W(e)&&"[object Symbol]"==q(e)}function Y(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var Z=Array.isArray,Q=D?D.prototype:void 0,X=Q?Q.toString:void 0;function ee(e){if("string"==typeof e)return e;if(Z(e))return Y(e,ee)+"";if(K(e))return X?X.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function te(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function re(e){return e}function ne(e){if(!te(e))return!1;var t=q(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var oe,ie=R["__core-js_shared__"],ae=(oe=/[^.]+$/.exec(ie&&ie.keys&&ie.keys.IE_PROTO||""))?"Symbol(src)_1."+oe:"",se=Function.prototype.toString;function ce(e){if(null!=e){try{return se.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ue=/^\[object .+?Constructor\]$/,le=Function.prototype,fe=Object.prototype,de=le.toString,pe=fe.hasOwnProperty,ye=RegExp("^"+de.call(pe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!te(e)||(t=e,ae&&ae in t))&&(ne(e)?ye:ue).test(ce(e));var t}(r)?r:void 0}var be=ve(R,"WeakMap"),he=Object.create,ge=function(){function e(){}return function(t){if(!te(t))return{};if(he)return he(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),me=ge;function je(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _e=Date.now;function we(e){return function(){return e}}var Oe,Se,Pe,Ee=function(){try{var e=ve(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ae=Ee,ke=Ae?function(e,t){return Ae(e,"toString",{configurable:!0,enumerable:!1,value:we(t),writable:!0})}:re,Te=(Oe=ke,Se=0,Pe=0,function(){var e=_e(),t=16-(e-Pe);if(Pe=e,t>0){if(++Se>=800)return arguments[0]}else Se=0;return Oe.apply(void 0,arguments)}),$e=Te;function Ie(e){return e!=e}function Ce(e,t){return!(null==e||!e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}(e,t):function(e,t,r,n){for(var o=e.length,i=-1;++i<o;)if(t(e[i],i,e))return i;return-1}(e,Ie)}(e,t)>-1}var xe=/^(?:0|[1-9]\d*)$/;function ze(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&xe.test(e))&&e>-1&&e%1==0&&e<t}function Ne(e,t,r){"__proto__"==t&&Ae?Ae(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function Ue(e,t){return e===t||e!=e&&t!=t}var Le=Object.prototype.hasOwnProperty;function Fe(e,t,r){var n=e[t];Le.call(e,t)&&Ue(n,r)&&(void 0!==r||t in e)||Ne(e,t,r)}function Re(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=n?n(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),o?Ne(r,s,c):Fe(r,s,c)}return r}var De=Math.max;function Me(e,t,r){return t=De(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=De(n.length-t,0),a=Array(i);++o<i;)a[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(a),je(e,this,s)}}function Je(e,t){return $e(Me(e,t,re),e+"")}function Be(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ve(e){return null!=e&&Be(e.length)&&!ne(e)}function Ge(e,t,r){if(!te(r))return!1;var n=typeof t;return!!("number"==n?Ve(r)&&ze(t,r.length):"string"==n&&t in r)&&Ue(r[t],e)}function He(e){return Je((function(t,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&Ge(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++n<o;){var s=r[n];s&&e(t,s,n,i)}return t}))}var qe=Object.prototype;function We(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||qe)}function Ke(e){return W(e)&&"[object Arguments]"==q(e)}var Ye=Object.prototype,Ze=Ye.hasOwnProperty,Qe=Ye.propertyIsEnumerable,Xe=Ke(function(){return arguments}())?Ke:function(e){return W(e)&&Ze.call(e,"callee")&&!Qe.call(e,"callee")},et=Xe,tt="object"==typeof t&&t&&!t.nodeType&&t,rt=tt&&"object"==typeof module&&module&&!module.nodeType&&module,nt=rt&&rt.exports===tt?R.Buffer:void 0,ot=(nt?nt.isBuffer:void 0)||function(){return!1},it={};function at(e){return function(t){return e(t)}}it["[object Float32Array]"]=it["[object Float64Array]"]=it["[object Int8Array]"]=it["[object Int16Array]"]=it["[object Int32Array]"]=it["[object Uint8Array]"]=it["[object Uint8ClampedArray]"]=it["[object Uint16Array]"]=it["[object Uint32Array]"]=!0,it["[object Arguments]"]=it["[object Array]"]=it["[object ArrayBuffer]"]=it["[object Boolean]"]=it["[object DataView]"]=it["[object Date]"]=it["[object Error]"]=it["[object Function]"]=it["[object Map]"]=it["[object Number]"]=it["[object Object]"]=it["[object RegExp]"]=it["[object Set]"]=it["[object String]"]=it["[object WeakMap]"]=!1;var st="object"==typeof t&&t&&!t.nodeType&&t,ct=st&&"object"==typeof module&&module&&!module.nodeType&&module,ut=ct&&ct.exports===st&&L.process,lt=function(){try{return ct&&ct.require&&ct.require("util").types||ut&&ut.binding&&ut.binding("util")}catch(e){}}(),ft=lt&&lt.isTypedArray,dt=ft?at(ft):function(e){return W(e)&&Be(e.length)&&!!it[q(e)]},pt=dt,yt=Object.prototype.hasOwnProperty;function vt(e,t){var r=Z(e),n=!r&&et(e),o=!r&&!n&&ot(e),i=!r&&!n&&!o&&pt(e),a=r||n||o||i,s=a?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],c=s.length;for(var u in e)!t&&!yt.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ze(u,c))||s.push(u);return s}function bt(e,t){return function(r){return e(t(r))}}var ht=bt(Object.keys,Object),gt=Object.prototype.hasOwnProperty;function mt(e){if(!We(e))return ht(e);var t=[];for(var r in Object(e))gt.call(e,r)&&"constructor"!=r&&t.push(r);return t}function jt(e){return Ve(e)?vt(e):mt(e)}var _t=Object.prototype.hasOwnProperty;He((function(e,t){if(We(t)||Ve(t))Re(t,jt(t),e);else for(var r in t)_t.call(t,r)&&Fe(e,r,t[r])}));var wt=Object.prototype.hasOwnProperty;function Ot(e){return Ve(e)?vt(e,!0):function(e){if(!te(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=We(e),r=[];for(var n in e)("constructor"!=n||!t&&wt.call(e,n))&&r.push(n);return r}(e)}var St=He((function(e,t,r,n){Re(t,Ot(t),e,n)})),Pt=St,Et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/;function kt(e,t){if(Z(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!K(e))||At.test(e)||!Et.test(e)||null!=t&&e in Object(t)}var Tt=ve(Object,"create"),$t=Object.prototype.hasOwnProperty,It=Object.prototype.hasOwnProperty;function Ct(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function xt(e,t){for(var r=e.length;r--;)if(Ue(e[r][0],t))return r;return-1}Ct.prototype.clear=function(){this.__data__=Tt?Tt(null):{},this.size=0},Ct.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ct.prototype.get=function(e){var t=this.__data__;if(Tt){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return $t.call(t,e)?t[e]:void 0},Ct.prototype.has=function(e){var t=this.__data__;return Tt?void 0!==t[e]:It.call(t,e)},Ct.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Tt&&void 0===t?"__lodash_hash_undefined__":t,this};var zt=Array.prototype.splice;function Nt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Nt.prototype.clear=function(){this.__data__=[],this.size=0},Nt.prototype.delete=function(e){var t=this.__data__,r=xt(t,e);return!(r<0||(r==t.length-1?t.pop():zt.call(t,r,1),--this.size,0))},Nt.prototype.get=function(e){var t=this.__data__,r=xt(t,e);return r<0?void 0:t[r][1]},Nt.prototype.has=function(e){return xt(this.__data__,e)>-1},Nt.prototype.set=function(e,t){var r=this.__data__,n=xt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Ut=ve(R,"Map");function Lt(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Ft(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Rt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Rt.Cache||Ft),r}Ft.prototype.clear=function(){this.size=0,this.__data__={hash:new Ct,map:new(Ut||Nt),string:new Ct}},Ft.prototype.delete=function(e){var t=Lt(this,e).delete(e);return this.size-=t?1:0,t},Ft.prototype.get=function(e){return Lt(this,e).get(e)},Ft.prototype.has=function(e){return Lt(this,e).has(e)},Ft.prototype.set=function(e,t){var r=Lt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Rt.Cache=Ft;var Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mt=/\\(\\)?/g,Jt=function(e){var t=Rt((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Dt,(function(e,r,n,o){t.push(n?o.replace(Mt,"$1"):r||e)})),t}),(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}(),Bt=Jt;function Vt(e){return null==e?"":ee(e)}function Gt(e,t){return Z(e)?e:kt(e,t)?[e]:Bt(Vt(e))}function Ht(e){if("string"==typeof e||K(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function qt(e,t){for(var r=0,n=(t=Gt(t,e)).length;null!=e&&r<n;)e=e[Ht(t[r++])];return r&&r==n?e:void 0}function Wt(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var Kt=D?D.isConcatSpreadable:void 0;function Yt(e){return Z(e)||et(e)||!!(Kt&&e&&e[Kt])}function Zt(e,t,r,n,o){var i=-1,a=e.length;for(r||(r=Yt),o||(o=[]);++i<a;){var s=e[i];t>0&&r(s)?t>1?Zt(s,t-1,r,n,o):Wt(o,s):n||(o[o.length]=s)}return o}function Qt(e){return null!=e&&e.length?Zt(e,1):[]}function Xt(e){return $e(Me(e,void 0,Qt),e+"")}var er=bt(Object.getPrototypeOf,Object),tr=Function.prototype,rr=Object.prototype,nr=tr.toString,or=rr.hasOwnProperty,ir=nr.call(Object);function ar(e){if(!W(e)||"[object Object]"!=q(e))return!1;var t=er(e);if(null===t)return!0;var r=or.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&nr.call(r)==ir}function sr(e){if(!W(e))return!1;var t=q(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ar(e)}var cr=Je((function(e,t){try{return je(e,void 0,t)}catch(e){return sr(e)?e:new Error(e)}})),ur=cr;function lr(e){var t=this.__data__=new Nt(e);this.size=t.size}lr.prototype.clear=function(){this.__data__=new Nt,this.size=0},lr.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},lr.prototype.get=function(e){return this.__data__.get(e)},lr.prototype.has=function(e){return this.__data__.has(e)},lr.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Nt){var n=r.__data__;if(!Ut||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ft(n)}return r.set(e,t),this.size=r.size,this};var fr="object"==typeof t&&t&&!t.nodeType&&t,dr=fr&&"object"==typeof module&&module&&!module.nodeType&&module,pr=dr&&dr.exports===fr?R.Buffer:void 0,yr=pr?pr.allocUnsafe:void 0;function vr(){return[]}var br=Object.prototype.propertyIsEnumerable,hr=Object.getOwnPropertySymbols,gr=hr?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a)&&(i[o++]=a)}return i}(hr(e),(function(t){return br.call(e,t)})))}:vr,mr=gr,jr=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Wt(t,mr(e)),e=er(e);return t}:vr,_r=jr;function wr(e,t,r){var n=t(e);return Z(e)?n:Wt(n,r(e))}function Or(e){return wr(e,jt,mr)}function Sr(e){return wr(e,Ot,_r)}var Pr=ve(R,"DataView"),Er=ve(R,"Promise"),Ar=ve(R,"Set"),kr="[object Map]",Tr="[object Promise]",$r="[object Set]",Ir="[object WeakMap]",Cr="[object DataView]",xr=ce(Pr),zr=ce(Ut),Nr=ce(Er),Ur=ce(Ar),Lr=ce(be),Fr=q;(Pr&&Fr(new Pr(new ArrayBuffer(1)))!=Cr||Ut&&Fr(new Ut)!=kr||Er&&Fr(Er.resolve())!=Tr||Ar&&Fr(new Ar)!=$r||be&&Fr(new be)!=Ir)&&(Fr=function(e){var t=q(e),r="[object Object]"==t?e.constructor:void 0,n=r?ce(r):"";if(n)switch(n){case xr:return Cr;case zr:return kr;case Nr:return Tr;case Ur:return $r;case Lr:return Ir}return t});var Rr=Fr,Dr=Object.prototype.hasOwnProperty,Mr=R.Uint8Array;function Jr(e){var t=new e.constructor(e.byteLength);return new Mr(t).set(new Mr(e)),t}var Br=/\w*$/,Vr=D?D.prototype:void 0,Gr=Vr?Vr.valueOf:void 0,Hr=lt&&lt.isMap,qr=Hr?at(Hr):function(e){return W(e)&&"[object Map]"==Rr(e)},Wr=qr,Kr=lt&&lt.isSet,Yr=Kr?at(Kr):function(e){return W(e)&&"[object Set]"==Rr(e)},Zr=Yr,Qr="[object Arguments]",Xr="[object Function]",en="[object Object]",tn={};function rn(e,t,r,n,o,i){var a,s=1&t,c=2&t,u=4&t;if(r&&(a=o?r(e,n,o,i):r(e)),void 0!==a)return a;if(!te(e))return e;var l=Z(e);if(l){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Dr.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!s)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e,a)}else{var f=Rr(e),d=f==Xr||"[object GeneratorFunction]"==f;if(ot(e))return function(e,t){if(t)return e.slice();var r=e.length,n=yr?yr(r):new e.constructor(r);return e.copy(n),n}(e,s);if(f==en||f==Qr||d&&!o){if(a=c||d?{}:function(e){return"function"!=typeof e.constructor||We(e)?{}:me(er(e))}(e),!s)return c?function(e,t){return Re(e,_r(e),t)}(e,function(e,t){return e&&Re(t,Ot(t),e)}(a,e)):function(e,t){return Re(e,mr(e),t)}(e,function(e,t){return e&&Re(t,jt(t),e)}(a,e))}else{if(!tn[f])return o?e:{};a=function(e,t,r){var n,o,i,a=e.constructor;switch(t){case"[object ArrayBuffer]":return Jr(e);case"[object Boolean]":case"[object Date]":return new a(+e);case"[object DataView]":return function(e,t){var r=t?Jr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var r=t?Jr(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,r);case"[object Map]":case"[object Set]":return new a;case"[object Number]":case"[object String]":return new a(e);case"[object RegExp]":return(i=new(o=e).constructor(o.source,Br.exec(o))).lastIndex=o.lastIndex,i;case"[object Symbol]":return n=e,Gr?Object(Gr.call(n)):{}}}(e,f,s)}}i||(i=new lr);var p=i.get(e);if(p)return p;i.set(e,a),Zr(e)?e.forEach((function(n){a.add(rn(n,t,r,n,e,i))})):Wr(e)&&e.forEach((function(n,o){a.set(o,rn(n,t,r,o,e,i))}));var y=l?void 0:(u?c?Sr:Or:c?Ot:jt)(e);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r););}(y||e,(function(n,o){y&&(n=e[o=n]),Fe(a,o,rn(n,t,r,o,e,i))})),a}function nn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Ft;++t<r;)this.add(e[t])}function on(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function an(e,t){return e.has(t)}function sn(e,t,r,n,o,i){var a=1&r,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=i.get(e),l=i.get(t);if(u&&l)return u==t&&l==e;var f=-1,d=!0,p=2&r?new nn:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var y=e[f],v=t[f];if(n)var b=a?n(v,y,f,t,e,i):n(y,v,f,e,t,i);if(void 0!==b){if(b)continue;d=!1;break}if(p){if(!on(t,(function(e,t){if(!an(p,t)&&(y===e||o(y,e,r,n,i)))return p.push(t)}))){d=!1;break}}else if(y!==v&&!o(y,v,r,n,i)){d=!1;break}}return i.delete(e),i.delete(t),d}function cn(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function un(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}tn[Qr]=tn["[object Array]"]=tn["[object ArrayBuffer]"]=tn["[object DataView]"]=tn["[object Boolean]"]=tn["[object Date]"]=tn["[object Float32Array]"]=tn["[object Float64Array]"]=tn["[object Int8Array]"]=tn["[object Int16Array]"]=tn["[object Int32Array]"]=tn["[object Map]"]=tn["[object Number]"]=tn[en]=tn["[object RegExp]"]=tn["[object Set]"]=tn["[object String]"]=tn["[object Symbol]"]=tn["[object Uint8Array]"]=tn["[object Uint8ClampedArray]"]=tn["[object Uint16Array]"]=tn["[object Uint32Array]"]=!0,tn["[object Error]"]=tn[Xr]=tn["[object WeakMap]"]=!1,nn.prototype.add=nn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},nn.prototype.has=function(e){return this.__data__.has(e)};var ln=D?D.prototype:void 0,fn=ln?ln.valueOf:void 0,dn=Object.prototype.hasOwnProperty,pn="[object Arguments]",yn="[object Array]",vn="[object Object]",bn=Object.prototype.hasOwnProperty;function hn(e,t,r,n,o){return e===t||(null==e||null==t||!W(e)&&!W(t)?e!=e&&t!=t:function(e,t,r,n,o,i){var a=Z(e),s=Z(t),c=a?yn:Rr(e),u=s?yn:Rr(t),l=(c=c==pn?vn:c)==vn,f=(u=u==pn?vn:u)==vn,d=c==u;if(d&&ot(e)){if(!ot(t))return!1;a=!0,l=!1}if(d&&!l)return i||(i=new lr),a||pt(e)?sn(e,t,r,n,o,i):function(e,t,r,n,o,i,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new Mr(e),new Mr(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ue(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=cn;case"[object Set]":var c=1&n;if(s||(s=un),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;n|=2,a.set(e,t);var l=sn(s(e),s(t),n,o,i,a);return a.delete(e),l;case"[object Symbol]":if(fn)return fn.call(e)==fn.call(t)}return!1}(e,t,c,r,n,o,i);if(!(1&r)){var p=l&&bn.call(e,"__wrapped__"),y=f&&bn.call(t,"__wrapped__");if(p||y){var v=p?e.value():e,b=y?t.value():t;return i||(i=new lr),o(v,b,r,n,i)}}return!!d&&(i||(i=new lr),function(e,t,r,n,o,i){var a=1&r,s=Or(e),c=s.length;if(c!=Or(t).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:dn.call(t,l)))return!1}var f=i.get(e),d=i.get(t);if(f&&d)return f==t&&d==e;var p=!0;i.set(e,t),i.set(t,e);for(var y=a;++u<c;){var v=e[l=s[u]],b=t[l];if(n)var h=a?n(b,v,l,t,e,i):n(v,b,l,e,t,i);if(!(void 0===h?v===b||o(v,b,r,n,i):h)){p=!1;break}y||(y="constructor"==l)}if(p&&!y){var g=e.constructor,m=t.constructor;g==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(p=!1)}return i.delete(e),i.delete(t),p}(e,t,r,n,o,i))}(e,t,r,n,hn,o))}function gn(e){return e==e&&!te(e)}function mn(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}function jn(e,t){return null!=e&&t in Object(e)}function _n(e,t){return null!=e&&function(e,t,r){for(var n=-1,o=(t=Gt(t,e)).length,i=!1;++n<o;){var a=Ht(t[n]);if(!(i=null!=e&&r(e,a)))break;e=e[a]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&Be(o)&&ze(a,o)&&(Z(e)||et(e))}(e,t,jn)}function wn(e){return"function"==typeof e?e:null==e?re:"object"==typeof e?Z(e)?function(e,t){return kt(e)&&gn(t)?mn(Ht(e),t):function(r){var n=function(e,t,r){var n=null==e?void 0:qt(e,t);return void 0===n?void 0:n}(r,e);return void 0===n&&n===t?_n(r,e):hn(t,n,3)}}(e[0],e[1]):function(e){var t=function(e){for(var t=jt(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,gn(o)]}return t}(e);return 1==t.length&&t[0][2]?mn(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,n){var o=r.length,i=o;if(null==e)return!i;for(e=Object(e);o--;){var a=r[o];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var s=(a=r[o])[0],c=e[s],u=a[1];if(a[2]){if(void 0===c&&!(s in e))return!1}else if(!hn(u,c,3,undefined,new lr))return!1}return!0}(r,0,t)}}(e):function(e){return kt(e)?(t=Ht(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return qt(t,e)}}(e);var t}(e)}function On(e){return W(e)&&Ve(e)}function Sn(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Pn,En=(Pn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},function(e){return null==Pn?void 0:Pn[e]}),An=/[&<>"']/g,kn=RegExp(An.source),Tn=Math.min;function $n(e){return On(e)?e:[]}Je((function(e){var t=Sn(e),r=Y(e,$n);return t===Sn(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?function(e,t,r){for(var n=Ce,o=e[0].length,i=e.length,a=i,s=Array(i),c=1/0,u=[];a--;){var l=e[a];a&&t&&(l=Y(l,at(t))),c=Tn(l.length,c),s[a]=t||o>=120&&l.length>=120?new nn(a&&l):void 0}l=e[0];var f=-1,d=s[0];e:for(;++f<o&&u.length<c;){var p=l[f],y=t?t(p):p;if(p=0!==p?p:0,!(d?an(d,y):n(u,y,r))){for(a=i;--a;){var v=s[a];if(!(v?an(v,y):n(e[a],y,r)))continue e}d&&d.push(y),u.push(p)}}return u}(r,wn(t)):[]}));var In=Object.prototype.hasOwnProperty;function Cn(e,t){return null==(e=function(e,t){return t.length<2?e:qt(e,function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}(t,0,-1))}(e,t=Gt(t,e)))||delete e[Ht(Sn(t))]}function xn(e){return ar(e)?void 0:e}var zn=Xt((function(e,t){var r={};if(null==e)return r;var n=!1;t=Y(t,(function(t){return t=Gt(t,e),n||(n=t.length>1),t})),Re(e,Sr(e),r),n&&(r=rn(r,7,xn));for(var o=t.length;o--;)Cn(r,t[o]);return r})),Nn=zn;function Un(e,t,r,n){if(!te(e))return e;for(var o=-1,i=(t=Gt(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c=Ht(t[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var l=s[c];void 0===(u=n?n(l,c,s):void 0)&&(u=te(l)?l:ze(t[o+1])?[]:{})}Fe(s,c,u),s=s[c]}return e}Xt((function(e,t){return null==e?{}:function(e,t){return function(e,t,r){for(var n=-1,o=t.length,i={};++n<o;){var a=t[n],s=qt(e,a);r(0,a)&&Un(i,Gt(a,e),s)}return i}(e,t,(function(t,r){return _n(e,r)}))}(e,t)}));var Ln=Object.prototype,Fn=Ln.hasOwnProperty;function Rn(e,t,r,n){return void 0===e||Ue(e,Ln[r])&&!Fn.call(n,r)?t:e}var Dn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Mn(e){return"\\"+Dn[e]}var Jn=/<%=([\s\S]+?)%>/g,Bn={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Jn,variable:"",imports:{_:{escape:function(e){return(e=Vt(e))&&kn.test(e)?e.replace(An,En):e}}}},Vn=/\b__p \+= '';/g,Gn=/\b(__p \+=) '' \+/g,Hn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,qn=/[()=,{}\[\]\/\s]/,Wn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Kn=/($^)/,Yn=/['\n\r\u2028\u2029\\]/g,Zn=Object.prototype.hasOwnProperty,Qn=Ar&&1/un(new Ar([,-0]))[1]==1/0?function(e){return new Ar(e)}:function(){};function Xn(e){return null==e||"string"==typeof e&&""===e||ar(e)&&function(e){if(null==e)return!0;if(Ve(e)&&(Z(e)||"string"==typeof e||"function"==typeof e.splice||ot(e)||pt(e)||et(e)))return!e.length;var t=Rr(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(We(e))return!mt(e).length;for(var r in e)if(In.call(e,r))return!1;return!0}(e)||Array.isArray(e)&&e.length<1||"object"==typeof e&&!1===Z(e)&&function(e){let t=!0;if("object"==typeof e&&!1===Z(e))for(const r in e){const n=null==e?void 0:e[r];if(!0===e.hasOwnProperty(r)&&null!=n&&""!==n){t=!1;break}}return t}(e)}function eo(e,t){return U(this,void 0,void 0,(function*(){return A.default(e,t)}))}Je((function(e){var t=Sn(e);return On(t)&&(t=void 0),function(e,t,r){var n=-1,o=Ce,i=e.length,a=!0,s=[],c=s;if(i>=200){var u=t?null:Qn(e);if(u)return un(u);a=!1,o=an,c=new nn}else c=t?[]:s;e:for(;++n<i;){var l=e[n],f=t?t(l):l;if(l=0!==l?l:0,a&&f==f){for(var d=c.length;d--;)if(c[d]===f)continue e;t&&c.push(f),s.push(l)}else o(c,f,undefined)||(c!==s&&c.push(f),s.push(l))}return s}(Zt(e,1,On,!0),wn(t))}));const to={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",NorwegianBokml:"nb",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"},ro=[...Object.values(to),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"],no=[to.Arabic,to.Hebrew];function oo(e,t){return function(e,t,r){var n=Bn.imports._.templateSettings||Bn;e=Vt(e),t=Pt({},t,n,Rn);var o,i,a=Pt({},t.imports,n.imports,Rn),s=jt(a),c=function(e,t){return Y(t,(function(t){return e[t]}))}(a,s),u=0,l=t.interpolate||Kn,f="__p += '",d=RegExp((t.escape||Kn).source+"|"+l.source+"|"+(l===Jn?Wn:Kn).source+"|"+(t.evaluate||Kn).source+"|$","g"),p=Zn.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(d,(function(t,r,n,a,s,c){return n||(n=a),f+=e.slice(u,c).replace(Yn,Mn),r&&(o=!0,f+="' +\n__e("+r+") +\n'"),s&&(i=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=c+t.length,t})),f+="';\n";var y=Zn.call(t,"variable")&&t.variable;if(y){if(qn.test(y))throw new Error("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(i?f.replace(Vn,""):f).replace(Gn,"$1").replace(Hn,"$1;"),f="function("+(y||"obj")+") {\n"+(y?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=ur((function(){return Function(s,p+"return "+f).apply(void 0,c)}));if(v.source=f,sr(v))throw v;return v}(e)(t)}class io extends Error{constructor(e,t,r,n){super(t),this.name=e,this.details=r,this.cause=n}}const ao="networkError";var so=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")},co=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return so()}try{return __global__||so()}finally{delete Object.prototype.__global__}}(),uo="object"==typeof globalThis&&globalThis&&globalThis.Array===Array?globalThis:co,lo=uo,fo={object:!0,symbol:!0},po={exports:{}},yo=function(e){return null!=e},vo=yo,bo={object:!0,function:!0,undefined:!0},ho=/^\s*class[\s{/}]/,go=Function.prototype.toString,mo=function(e){return null!=e},jo=mo,_o=Object.keys,wo=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}()?Object.keys:function(e){return _o(jo(e)?Object(e):e)},Oo=mo,So=wo,Po=Math.max,Eo=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}()?Object.assign:function(e,t){var r,n,o,i=Po(arguments.length,2);for(e=Object(function(e){if(!Oo(e))throw new TypeError("Cannot use null or undefined");return e}(e)),o=function(n){try{e[n]=t[n]}catch(e){r||(r=e)}},n=1;n<i;++n)So(t=arguments[n]).forEach(o);if(void 0!==r)throw r;return e},Ao=mo,ko=Array.prototype.forEach,To=Object.create,$o="razdwatrzy",Io=String.prototype.indexOf,Co="function"==typeof $o.contains&&!0===$o.contains("dwa")&&!1===$o.contains("foo")?String.prototype.contains:function(e){return Io.call(this,e,arguments[1])>-1},xo=yo,zo=function(e){return!!function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!function(e){if(!function(e){return!!vo(e)&&hasOwnProperty.call(bo,typeof e)}(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}}(e)}(e)&&!ho.test(go.call(e))},No=Eo,Uo=function(e){var t=To(null);return ko.call(arguments,(function(e){Ao(e)&&function(e,t){var r;for(r in e)t[r]=e[r]}(Object(e),t)})),t},Lo=Co,Fo=po.exports=function(e,t){var r,n,o,i,a;return arguments.length<2||"string"!=typeof e?(i=t,t=e,e=null):i=arguments[2],xo(e)?(r=Lo.call(e,"c"),n=Lo.call(e,"e"),o=Lo.call(e,"w")):(r=o=!0,n=!1),a={value:t,configurable:r,enumerable:n,writable:o},i?No(Uo(i),a):a};Fo.gs=function(e,t,r){var n,o,i,a;return"string"!=typeof e?(i=r,r=t,t=e,e=null):i=arguments[3],xo(t)?zo(t)?xo(r)?zo(r)||(i=r,r=void 0):r=void 0:(i=t,t=r=void 0):t=void 0,xo(e)?(n=Lo.call(e,"c"),o=Lo.call(e,"e")):(n=!0,o=!1),a={get:t,set:r,configurable:n,enumerable:o},i?No(Uo(i),a):a};var Ro,Do,Mo,Jo=function(e){if(!function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}(e))throw new TypeError(e+" is not a symbol");return e},Bo=po.exports,Vo=Object.create,Go=Object.defineProperty,Ho=Object.prototype,qo=Vo(null),Wo=po.exports,Ko=uo.Symbol,Yo=po.exports,Zo=Jo,Qo=Object.create(null),Xo=po.exports,ei=Jo,ti=uo.Symbol,ri=function(e){for(var t,r,n=0;qo[e+(n||"")];)++n;return qo[e+=n||""]=!0,Go(Ho,t="@@"+e,Bo.gs(null,(function(e){r||(r=!0,Go(this,t,Bo(e)),r=!1)}))),t},ni=Object.create,oi=Object.defineProperties,ii=Object.defineProperty;if("function"==typeof ti)try{String(ti()),Mo=!0}catch(e){}else ti=null;Do=function(e){if(this instanceof Do)throw new TypeError("Symbol is not a constructor");return Ro(e)};var ai=Ro=function e(t){var r;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return Mo?ti(t):(r=ni(Do.prototype),t=void 0===t?"":String(t),oi(r,{__description__:Xo("",t),__name__:Xo("",ri(t))}))};(function(e){Object.defineProperties(e,{hasInstance:Wo("",Ko&&Ko.hasInstance||e("hasInstance")),isConcatSpreadable:Wo("",Ko&&Ko.isConcatSpreadable||e("isConcatSpreadable")),iterator:Wo("",Ko&&Ko.iterator||e("iterator")),match:Wo("",Ko&&Ko.match||e("match")),replace:Wo("",Ko&&Ko.replace||e("replace")),search:Wo("",Ko&&Ko.search||e("search")),species:Wo("",Ko&&Ko.species||e("species")),split:Wo("",Ko&&Ko.split||e("split")),toPrimitive:Wo("",Ko&&Ko.toPrimitive||e("toPrimitive")),toStringTag:Wo("",Ko&&Ko.toStringTag||e("toStringTag")),unscopables:Wo("",Ko&&Ko.unscopables||e("unscopables"))})})(Ro),function(e){Object.defineProperties(e,{for:Yo((function(t){return Qo[t]?Qo[t]:Qo[t]=e(String(t))})),keyFor:Yo((function(e){var t;for(t in Zo(e),Qo)if(Qo[t]===e)return t}))})}(Ro),oi(Do.prototype,{constructor:Xo(Ro),toString:Xo("",(function(){return this.__name__}))}),oi(Ro.prototype,{toString:Xo((function(){return"Symbol ("+ei(this).__description__+")"})),valueOf:Xo((function(){return ei(this)}))}),ii(Ro.prototype,Ro.toPrimitive,Xo("",(function(){var e=ei(this);return"symbol"==typeof e?e:e.toString()}))),ii(Ro.prototype,Ro.toStringTag,Xo("c","Symbol")),ii(Do.prototype,Ro.toStringTag,Xo("c",Ro.prototype[Ro.toStringTag])),ii(Do.prototype,Ro.toPrimitive,Xo("c",Ro.prototype[Ro.toPrimitive]));var si=function(){var e,t=lo.Symbol;if("function"!=typeof t)return!1;e=t("test symbol");try{String(e)}catch(e){return!1}return!!fo[typeof t.iterator]&&!!fo[typeof t.toPrimitive]&&!!fo[typeof t.toStringTag]}()?uo.Symbol:ai;si("-");const ci=["job-cancelled","job-deleted","job-succeeded","job-timed-out","job-failed"];var ui={exports:{}};function li(e,t,r,n){var o=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(n)?n:r(n),i=t.get(o);return void 0===i&&(i=e.call(this,n),t.set(o,i)),i}function fi(e,t,r){var n=Array.prototype.slice.call(arguments,3),o=r(n),i=t.get(o);return void 0===i&&(i=e.apply(this,n),t.set(o,i)),i}function di(e,t,r,n,o){return r.bind(t,e,n,o)}function pi(e,t){return di(e,this,1===e.length?li:fi,t.cache.create(),t.serializer)}function yi(){return JSON.stringify(arguments)}function vi(){this.cache=Object.create(null)}vi.prototype.has=function(e){return e in this.cache},vi.prototype.get=function(e){return this.cache[e]},vi.prototype.set=function(e,t){this.cache[e]=t};var bi={create:function(){return new vi}};ui.exports=function(e,t){var r=t&&t.cache?t.cache:bi,n=t&&t.serializer?t.serializer:yi;return(t&&t.strategy?t.strategy:pi)(e,{cache:r,serializer:n})},ui.exports.strategies={variadic:function(e,t){return di(e,this,fi,t.cache.create(),t.serializer)},monadic:function(e,t){return di(e,this,li,t.cache.create(),t.serializer)}};var hi=ui.exports;const gi=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];function mi(t,r){return U(this,void 0,void 0,(function*(){const n=yield function(t=function(e=document.documentElement){var t;const r=function e(t){let r;return r=void 0===t||t===document||t===window?null:t.closest("[lang]")||e(t.getRootNode().host),r}(e),n=null!==(t=null==r?void 0:r.lang)&&void 0!==t?t:window.navigator.language,o=function(e){let t=to.English;if(void 0!==e){const r=Object.values(to),n=r.filter((e=>-1!==e.indexOf("-")));if(-1!==e.indexOf("-")){const[t,r]=e.split("-");e=`${t}-${r.toUpperCase()}`}if(!0===n.includes(e))t=e;else{const n=function(e){const t=null==e?void 0:e.match(/^([a-z]{2})-([A-Z]{1,2})$/);let r=to.English;return null!=t&&(null==t?void 0:t.length)>1?r=t[1]:2===(null==e?void 0:e.length)&&e.toLowerCase()===e&&(r=e),r}(e);!0===r.includes(n)&&(t=n)}}return t}(n),i=function(e){let t=ro.find((t=>t===e));if(void 0===t&&(t=e),void 0!==t&&-1!==t.indexOf("-")){const[e,r]=t.split("-");t=`${e}-${r.toUpperCase()}`}return"ar"===t&&(t="ar-u-nu-latn"),t}(n);return{locale:o,rtl:no.includes(o),formatLocale:i}}().locale){return U(this,void 0,void 0,(function*(){let r=yield new Promise((function(t,r){e(["./errors.t9n.en-6cb15d51-af422bd0"],t,r)}));switch(t){case to.Arabic:r=yield new Promise((function(t,r){e(["./errors.t9n.ar-1b9d7225-e5ab3e60"],t,r)}));break;case to.Bosnian:r=yield new Promise((function(t,r){e(["./errors.t9n.bs-377a5410-21724478"],t,r)}));break;case to.Bulgarian:r=yield new Promise((function(t,r){e(["./errors.t9n.bg-89d094b5-313f0e15"],t,r)}));break;case to.Catalan:r=yield new Promise((function(t,r){e(["./errors.t9n.ca-b4c83c33-10aafcba"],t,r)}));break;case to.Czech:r=yield new Promise((function(t,r){e(["./errors.t9n.cs-96fcf27d-1c5dabcf"],t,r)}));break;case to.Danish:r=yield new Promise((function(t,r){e(["./errors.t9n.da-cefe0c47-f5ec85f4"],t,r)}));break;case to.German:r=yield new Promise((function(t,r){e(["./errors.t9n.de-a1b0ae17-8f46b75b"],t,r)}));break;case to.Greek:r=yield new Promise((function(t,r){e(["./errors.t9n.el-0a20e1cc-26072a22"],t,r)}));break;case to.EnglishUSA:r=yield new Promise((function(t,r){e(["./errors.t9n.en-US-c9f50f19-892f088a"],t,r)}));break;case to.Spanish:r=yield new Promise((function(t,r){e(["./errors.t9n.es-0dd138a7-c2f1f217"],t,r)}));break;case to.Estonian:r=yield new Promise((function(t,r){e(["./errors.t9n.et-57cc3980-ce933e20"],t,r)}));break;case to.Finnish:r=yield new Promise((function(t,r){e(["./errors.t9n.fi-7d2525cb-cb5130a0"],t,r)}));break;case to.French:r=yield new Promise((function(t,r){e(["./errors.t9n.fr-b2186e48-9ee1405e"],t,r)}));break;case to.Hebrew:r=yield new Promise((function(t,r){e(["./errors.t9n.he-f487411b-b0b9c841"],t,r)}));break;case to.Croatian:r=yield new Promise((function(t,r){e(["./errors.t9n.hr-61ca76d9-41fe3101"],t,r)}));break;case to.Hungarian:r=yield new Promise((function(t,r){e(["./errors.t9n.hu-7fa01d3c-19cdc1ae"],t,r)}));break;case to.Indonesian:r=yield new Promise((function(t,r){e(["./errors.t9n.id-6801fef5-0a3210cc"],t,r)}));break;case to.Italian:r=yield new Promise((function(t,r){e(["./errors.t9n.it-568c2b04-b6bdfead"],t,r)}));break;case to.Japanese:r=yield new Promise((function(t,r){e(["./errors.t9n.ja-6042d3af-348db024"],t,r)}));break;case to.Korean:r=yield new Promise((function(t,r){e(["./errors.t9n.ko-4d01f228-c47fac88"],t,r)}));break;case to.Lithuanian:r=yield new Promise((function(t,r){e(["./errors.t9n.lt-7f94cd9d-124e3795"],t,r)}));break;case to.Latvian:r=yield new Promise((function(t,r){e(["./errors.t9n.lv-0223c6ae-a0cedc5c"],t,r)}));break;case to.NorwegianBokml:r=yield new Promise((function(t,r){e(["./errors.t9n.nb-1f800b8b-435a46f2"],t,r)}));break;case to.Dutch:r=yield new Promise((function(t,r){e(["./errors.t9n.nl-dd20c6e1-26d44f0d"],t,r)}));break;case to.Polish:r=yield new Promise((function(t,r){e(["./errors.t9n.pl-e71d8c8e-f97b1fd7"],t,r)}));break;case to.PortugueseBrazil:r=yield new Promise((function(t,r){e(["./errors.t9n.pt-BR-6cdb50a3-6a968f4f"],t,r)}));break;case to.PortuguesePortugal:r=yield new Promise((function(t,r){e(["./errors.t9n.pt-PT-6b3866f5-9782cc9c"],t,r)}));break;case to.Romanian:r=yield new Promise((function(t,r){e(["./errors.t9n.ro-86e7cba9-3424d72d"],t,r)}));break;case to.Russian:r=yield new Promise((function(t,r){e(["./errors.t9n.ru-23cdd703-a95e7cee"],t,r)}));break;case to.Serbian:r=yield new Promise((function(t,r){e(["./errors.t9n.sr-fad84a78-fe5653d9"],t,r)}));break;case to.Slovak:r=yield new Promise((function(t,r){e(["./errors.t9n.sk-3b14f765-fb44e224"],t,r)}));break;case to.Slovenian:r=yield new Promise((function(t,r){e(["./errors.t9n.sl-e900baaf-1ec50095"],t,r)}));break;case to.Swedish:r=yield new Promise((function(t,r){e(["./errors.t9n.sv-4613eae2-09baa094"],t,r)}));break;case to.Thai:r=yield new Promise((function(t,r){e(["./errors.t9n.th-5732c8a4-b7bc1056"],t,r)}));break;case to.Turkish:r=yield new Promise((function(t,r){e(["./errors.t9n.tr-ccd64dcc-19fe7d0d"],t,r)}));break;case to.Ukrainian:r=yield new Promise((function(t,r){e(["./errors.t9n.uk-e6c5f2f4-4ae5232d"],t,r)}));break;case to.Vietnamese:r=yield new Promise((function(t,r){e(["./errors.t9n.vi-3f1e30b4-589e264b"],t,r)}));break;case to.ChineseChina:r=yield new Promise((function(t,r){e(["./errors.t9n.zh-CN-8e563d8f-64030da5"],t,r)}));break;case to.ChineseHongKong:r=yield new Promise((function(t,r){e(["./errors.t9n.zh-HK-23eb2505-89e86991"],t,r)}));break;case to.ChineseTaiwan:r=yield new Promise((function(t,r){e(["./errors.t9n.zh-TW-4017c011-d4027d56"],t,r)}))}return r}))}(),o=n[t];throw new io(t,null!=o?o:n.defaultError,{type:"analysis_ui"},r)}))}function ji(e){null!=e||(e="standard");let t="";return t="raster"===e?"_ra":"",t}function _i(e){return{"&":"&amp;","<":"&lt;",">":"&gt;"}[e]||e}hi((e=>U(void 0,void 0,void 0,(function*(){const{geocodeServiceURL:t,locale:r}=e;let n;if(Xn(t))n={ruleType:"expression",expression:"$[Data].geocodeServiceURL = NULL",destination:"sourceCountry",effectParams:{visible:!1}};else{let e,o;try{({data:{countries:e,detailedCountries:o}}=yield eo(`${t}?f=json`,{responseType:"json"}))}catch(e){throw console.error("Failed to get Locator info"),e}const i={};o.forEach((e=>{var t;const n=e.localizedNames,o=r.length>2&&r;let a;if("boolean"!=typeof o&&(a=n[o]),void 0===a){const e=2===r.length?r.slice(0,2):r;if(a=n[e],void 0===a){const t=Object.keys(n).find((t=>t.startsWith(e)));void 0!==t&&(a=n[t])}}null!=a&&""!==a||(a=null!==(t=n[to.English])&&void 0!==t?t:n[to.EnglishUSA]),i[e.name]=a})),n={ruleType:"expression",expression:"$[Data].geocodeServiceURL NOT null",destination:"sourceCountry",effectParams:{visible:!0,choiceList:e,choiceListLabels:i}}}return n}))),{serializer:e=>{const{geocodeServiceURL:t}=e;return null!=t?t:"EMPTY_KEY"}}),hi((e=>U(void 0,void 0,void 0,(function*(){const{geocodeServiceURL:t,inputFileItem:r,inputTable:n}=e;let o,i;if(!(Xn(t)||Xn(r)&&Xn(n))){let t,r;i=yield wi(e);try{t=JSON.parse(i.field_info),r=JSON.parse(i.field_mapping)}catch(e){throw console.error("Failed to parse result of AnalyzeGeocodeInput"),e}const n=t.map((e=>e[0])),a=n.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:t})),{});o={ruleType:"expression",expression:"($[Data].geocodeServiceURL NOT null) AND (($[Data].inputTable NOT null) OR ($[Data].inputFileItem NOT null))",destination:"geocodeUIParameters",effectParams:gi.reduce(((e,t,o)=>{var i;const s=null===(i=r.find((e=>e[1]===t)))||void 0===i?void 0:i[0];return Object.assign(Object.assign({},e),{[`UIparameterInfos[${o}].choiceList`]:n,[`UIparameterInfos[${o}].choiceListLabels`]:a,[`UIparameterInfos[${o}].defaultValue`]:s})}),{})}}return{addressFieldsRule:o,geocodeParameters:i}}))),{serializer:e=>{const{geocodeServiceURL:t,inputFileItem:r,inputTable:n}=e,o=null==r?void 0:r.itemid,i=null==n?void 0:n.url;return Xn(t)||Xn(o)&&Xn(i)?"EMPTY_KEY":`${t}${o}${i}`}}),Rt((e=>{var t;const r={};let n;if(void 0!==e.featureSet){if(r.source=x.default.fromJSON(e.featureSet).features,n=e.layerDefinition,void 0!==n.fields&&(r.fields=n.fields.map((e=>I.default.fromJSON(e)))),void 0!==n.objectIdField&&(r.objectIdField=n.objectIdField),void 0!==n.geometryType){let e="point";switch(n.geometryType){case"esriGeometryMultipoint":e="multipoint";break;case"esriGeometryPoint":e="point";break;case"esriGeometryPolygon":e="polygon";break;case"esriGeometryPolyline":e="polyline"}r.geometryType=e}void 0!==n.spatialReference&&(r.spatialReference=n.spatialReference),void 0!==(null===(t=n.drawingInfo)||void 0===t?void 0:t.renderer)&&(r.renderer=C.default.fromJSON(n.drawingInfo.renderer))}return new T.default(r)})),Rt(((e,t)=>U(void 0,void 0,void 0,(function*(){let r=!1;if(!0===window.location.href.includes("://localhost:")||void 0===t)r=!0;else{const n=`${e}${e.indexOf("?")>-1?"&":"?"}f=json`;z.default.request.proxyUrl=`${t}/sharing/proxy`;try{r=!1===Xn((yield eo(n,{useProxy:!0})).data)}catch(e){r=!1}}return!0===r?e:void 0})))),Rt((e=>U(void 0,void 0,void 0,(function*(){const{locale:t,name:r,assetPrefix:n,analysisEngine:o,memoizedHelper:i}=e,a=`${r.toLowerCase()}${ji(o)}`;let s,c,u,l;const f=`${n}/tool-ui-json/${a}.tool.ui.json`,d=`${n}/tool-json/${a}.tool.json`,p=`${n}/t9n/${a}/${a}.t9n.${t}.json`,y=`${n}/t9n/common.t9n.${t}.json`;let v=t;t===to.English||t===to.EnglishUSA?v="":v===to.NorwegianBokml&&(v="no");const b=`${n}/help/${""!==v?v+"/":""}${r}${ji(o)}.html`;try{l=yield i(d),s=yield i(f),c=yield i(p),u=yield i(y),c=Object.assign(Object.assign({},u),c)}catch(e){s=void 0}return{toolJson:l,toolUIJson:s,toolT9n:c,toolHelpFilePath:b}})))),hi((e=>U(void 0,void 0,void 0,(function*(){const{url:t}=e,r=`${t}/sharing/rest/community/self`,n=k.default.findCredential(r);let o;void 0!==n&&(o=n.token);const i={query:{returnUserLicensedItems:!0,token:o,f:"json"}};try{const{data:{userLicensedItems:e}}=yield eo(r,i);return[...e.map((({entitlements:e})=>e))].flat()}catch(e){yield mi(ao)}return[]}))),{serializer:e=>`${e.user.username}`}),hi((e=>U(void 0,void 0,void 0,(function*(){let t={isMultidimensional:!1};const r="imagery-tile"===e.type?e.rasterInfo.multidimensionalInfo:e.multidimensionalInfo,n=e.multidimensionalSubset;if(null!=r){const o=null!=n?e.getMultidimensionalSubsetVariables():r.variables;if(void 0!==o&&o.length>0){const e=[],r=[],n={},i={},a={},s={},c={},u={},l={};o.forEach(((t,o)=>{let a="";const f=t.name;t.dimensions.forEach(((t,r)=>{var d,p;const y=t.name;-1===e.indexOf(y)&&e.push(y);const v=r>0?`,${y}=${null===(d=t.values)||void 0===d?void 0:d.length}`:`${y}=${null===(p=t.values)||void 0===p?void 0:p.length}`;if(a=a.concat(v),0===r&&(i[f]={}),void 0===n[y]&&(n[y]=[]),i[f][y]=t.values,0===o){const e=t.values;if(void 0!==e)if("StdTime"!==y||void 0!==t.unit&&"ISO8601"!==t.unit)Array.isArray(e)&&"number"==typeof e[0]?s[y]=c[y]=e.map(String):Array.isArray(e[0])&&Array.isArray(e[1])&&(s[y]=e[0].map(String),c[y]=e[1].map(String));else{const t=[],r=[],n={},o={};e.forEach((e=>{if("number"==typeof e){const i=new Date(e),a=i.toLocaleString(),s=i.toISOString();t.push(s),r.push(s),n[s]=a,o[s]=a}else if(Array.isArray(e)){const i=new Date(e[0]),a=new Date(e[1]),s=i.toISOString(),c=a.toISOString();t.push(s),r.push(c),n[s]=i.toLocaleString(),o[c]=a.toLocaleString()}})),s[y]=t,c[y]=r,u[y]=n,l[y]=o}}n[y].push(f)})),r.push({name:f,alias:`${f}[${a}](${t.description})`,type:"string"})}));for(const e in n){const t=r.filter((t=>n[e].indexOf(t.name)>-1));a[e]={id:"1",name:e,description:"DimensionVariables",getFields:()=>Promise.resolve(t)}}t={isMultidimensional:!0,dimensions:e,dimensionVariableDatasets:a,dimensionValues:i,variablesDataset:{id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(r)},dimensionMinValues:s,dimensionMaxValues:c,dimensionMinValuesWithLabels:u,dimensionMaxValuesWithLabels:l}}}const o="imagery"===e.type?yield e.generateRasterInfo(e.renderingRule):e.rasterInfo;return t.rasterInfo=o,t}))));const wi=e=>U(void 0,void 0,void 0,(function*(){const{asyncGeocodeUrl:t}=e,r=yield E.submitJob(`${t}/AnalyzeGeocodeInput`,Object.assign(Object.assign({},Nn(e,"asyncGeocodeUrl")),{f:"json"}));try{return yield r.waitForJobCompletion(),(yield r.fetchResultData("geocodeParameters")).value}catch(e){throw console.error("AnalyzeGeocodeInput failed"),e}}));hi(((e,t)=>new $.default({id:e,portal:t})),{serializer:e=>{var t;return`${e[0]}-${null===(t=e[1])||void 0===t?void 0:t.url}`}}),hi((e=>U(void 0,void 0,void 0,(function*(){var t,r;const{restUrl:n}=e,o=`${n}/portals/helpmap`;let i;try{const e=yield A.default(o,{query:{f:"json"},responseType:"json",method:"auto"});i=null!==(r=yield null===(t=e.data)||void 0===t?void 0:t.helpMap)&&void 0!==r?r:void 0}catch(e){i=void 0}return i}))),{serializer:e=>{var t;return`${e[0]}-${null===(t=e[1])||void 0===t?void 0:t.url}`}});const Oi="esriExecutionTypeSynchronous",Si="standard",Pi="geoanalytics",Ei="raster";var Ai={exports:{}};function ki(e,t,r,n){var o=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(n)?n:r(n),i=t.get(o);return void 0===i&&(i=e.call(this,n),t.set(o,i)),i}function Ti(e,t,r){var n=Array.prototype.slice.call(arguments,3),o=r(n),i=t.get(o);return void 0===i&&(i=e.apply(this,n),t.set(o,i)),i}function $i(e,t,r,n,o){return r.bind(t,e,n,o)}function Ii(e,t){return $i(e,this,1===e.length?ki:Ti,t.cache.create(),t.serializer)}function Ci(){return JSON.stringify(arguments)}function xi(){this.cache=Object.create(null)}xi.prototype.has=function(e){return e in this.cache},xi.prototype.get=function(e){return this.cache[e]},xi.prototype.set=function(e,t){this.cache[e]=t};var zi={create:function(){return new xi}};Ai.exports=function(e,t){var r=t&&t.cache?t.cache:zi,n=t&&t.serializer?t.serializer:Ci;return(t&&t.strategy?t.strategy:Ii)(e,{cache:r,serializer:n})},Ai.exports.strategies={variadic:function(e,t){return $i(e,this,Ti,t.cache.create(),t.serializer)},monadic:function(e,t){return $i(e,this,ki,t.cache.create(),t.serializer)}};var Ni=Ai.exports;function Ui(e,t,r=!1){let n=t.helperServices.analysis.url;switch(e){case Pi:n=t.helperServices.geoanalytics.url;break;case Ei:n=t.helperServices.rasterAnalytics.url;break;case Si:n=r?t.helperServices.asyncGeocode.url:t.helperServices.analysis.url}return n}const Li=e=>{const t=Array.from(e).map((e=>{let t;return t="object"==typeof e&&void 0!==e.id?e.id:e,t}));return JSON.stringify(t)},Fi=Ni(((e,t,r)=>N(void 0,void 0,void 0,(function*(){var n;const o=`${Ui(t,r,"BatchGeocode"===e)}/${e}?f=json`,i=yield A.default(o,{responseType:"json",authMode:"no-prompt"}),a=yield i.data;return null===(n=a.parameters)||void 0===n||n.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),a}))),{serializer:Li}),Ri=Ni(((e,t)=>N(void 0,void 0,void 0,(function*(){const r=Ui(e,t),n=yield A.default(`${r}?f=json`,{responseType:"json"}),{data:{tasks:o}}=n,i=o.map((r=>Fi(r,e,t)));return yield Promise.all(i)}))),{serializer:Li}),Di=Ni(((e,t)=>N(void 0,void 0,void 0,(function*(){let r=[];return r=void 0!==t?yield Ri(t,e):[...yield Ri(Si,e),...yield Ri(Ei,e),...yield Ri(Pi,e)],new Map(r.map((e=>[e.name.toLowerCase(),e])))}))),{serializer:Li}),Mi=Ni((e=>N(void 0,void 0,void 0,(function*(){const{helperServices:t}=e;let r;if(void 0!==t.routingUtilities){const e=yield E.execute(`${t.routingUtilities.url}/GetTravelModes?f=json`),{results:[{value:{features:n}},{value:o}]}=e;r={travelModes:n.map((e=>JSON.parse(e.attributes.TravelMode))),defaultTravelModeId:o}}return r}))),{serializer:Li}),Ji=Ni(((e,t)=>N(void 0,void 0,void 0,(function*(){var r;const n=`${e}/${t}?f=json`,o=yield A.default(n,{responseType:"json",authMode:"no-prompt"}),i=yield o.data;return null===(r=i.parameters)||void 0===r||r.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),i})))),Bi=Ni((e=>N(void 0,void 0,void 0,(function*(){const t=yield A.default(`${e}?f=json`,{responseType:"json"}),{data:{tasks:r}}=t,n=r.map((t=>Ji(e,t)));return yield Promise.all(n)})))),Vi="analysisCoreJobStatus";function Gi(e){return{detail:e,composed:!0,cancelable:!0,bubbles:!0}}function Hi(e,t){e.dispatchEvent(new window.CustomEvent("analysisCoreResultDataComplete",Gi(t)))}function qi(e,t){e.dispatchEvent(new window.CustomEvent(Vi,Gi(t)))}const Wi=[{toolName:"CreateViewshed",analysisEngine:Si},{toolName:"CreateWatersheds",analysisEngine:Si},{toolName:"TraceDownstream",analysisEngine:Si}],Ki=[{toolName:"SummarizeNearby",analysisEngine:Si},{toolName:"CreateViewshed",analysisEngine:Si},{toolName:"CreateWatersheds",analysisEngine:Si},{toolName:"TraceDownstream",analysisEngine:Si},{toolName:"EnrichLayer",analysisEngine:Si},{toolName:"CreateDriveTimeAreas",analysisEngine:Si},{toolName:"PlanRoutes",analysisEngine:Si},{toolName:"FindNearest",analysisEngine:Si},{toolName:"ConnectOriginsToDestinations",analysisEngine:Si},{toolName:"ChooseBestFacilities",analysisEngine:Si}];function Yi(e){var t;return N(this,void 0,void 0,(function*(){const{portal:r,jobParams:o,analysisEngine:i,toolName:a,toolElement:s}=e,c=Ui(null!=i?i:Si,r,"BatchGeocode"===a);let u=[];if(void 0!==Wi.find((e=>e.toolName===a&&e.analysisEngine===i)))u=[{dateType:"string",value:{cost:0,totalRecords:0}}];else{let e="";switch(i){case Ei:e=c+"/EstimateRasterAnalysisCost";break;case Si:e=c.replace("tasks/GPServer","Estimate/GPServer/EstimateCredits")}const r={};for(const e in o)"object"==typeof o[e]&&void 0!==o[e]?r[e]=JSON.stringify(o[e]):r[e]=o[e];const l=i===Ei?{inputAnalysisTask:{name:a,parameters:r}}:{taskName:a,taskParameters:r},f=(yield A.default(`${e}?f=json`,{responseType:"json"})).data,d=null===(t=null==f?void 0:f.parameters)||void 0===t?void 0:t.filter((e=>"esriGPParameterDirectionOutput"===e.direction));let p;switch(f.executionType){case Oi:p=yield n.execute(e,l),u=p.results;break;case"esriExecutionTypeAsynchronous":{const t=yield E.submitJob(e,l),r={interval:1500,statusCallback:e=>{qi(s,{jobInfo:e})}};yield t.waitForJobCompletion(r);const n=null==d?void 0:d.map((e=>t.fetchResultData(e.name)));u=yield Promise.all(n);break}}}var l;return void 0!==s&&(l=u,s.dispatchEvent(new window.CustomEvent("creditEstimateComplete",Gi(l)))),u}))}function Zi(e){var t,r,n;const o=function(e){const t="object"==typeof e&&null!==e,r=t&&"totalRecords"in e&&("maximumCost"in e||"cost"in e),n=t&&"credits"in e&&"functions"in e&&Array.isArray(e.functions)&&e.functions.every((e=>"object"==typeof e&&null!==e&&"name"in e&&"costFactor"in e&&"gigaPixels"in e));return t&&(r||n)}(null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.value)?e[0].value:void 0,i=null!==(n=null!==(r=null==o?void 0:o.maximumCost)&&void 0!==r?r:null==o?void 0:o.cost)&&void 0!==n?n:null==o?void 0:o.credits;return Number.isNaN(i)?void 0:i}function Qi(e,t){return void 0===t||void 0===e||e<=t}function Xi(e,t){let r=!0;return void 0!==t.sourceJSON.availableCredits&&void 0!==e&&(r=t.sourceJSON.availableCredits>e),r}const ea=/^[\p{L}\p{N}_][\p{L}\p{N}_\s]*[\p{L}\p{N}_]$/u;function ta(e,t){const r=[];return e.forEach((e=>{var n,o,i,a;if(e in t){const s=JSON.parse(t[e]),c=null!==(a=null!==(o=null===(n=null==s?void 0:s.serviceProperties)||void 0===n?void 0:n.name)&&void 0!==o?o:null===(i=null==s?void 0:s.itemProperties)||void 0===i?void 0:i.title)&&void 0!==a?a:void 0;void 0!==c&&r.push(c)}})),r}function ra(e){return N(this,void 0,void 0,(function*(){const{portal:{url:t,id:r},itemType:n}=e,{serviceName:o}=e,i=`${t}/sharing/rest/portals/${r}/isServiceNameAvailable?f=json`,a={query:{f:"json",name:o,type:n}};let s=!0;try{s=(yield A.default(i,a)).data.available}catch(e){yield mi(ao)}return s}))}function na(e){return e.every((e=>ea.test(e)))}t.UnancelableTools=Ki,t.ZeroCreditTools=Wi,t.cancelJob=function(e,t){return N(this,void 0,void 0,(function*(){let r=e.jobStatus,n=e.messages;const o=e.jobId;try{if(!0===function(e){return"job-executing"===e||"job-submitted"===e||"job-new"===e||"job-waiting"===e}((e=yield e.cancelJob(o)).jobStatus)||"job-cancelling"===e.jobStatus)for(;!1===ci.includes(e.jobStatus);)yield new Promise((e=>setTimeout(e,500))),e=yield e.checkJobStatus(),qi(t,{jobInfo:e});r=e.jobStatus,n=e.messages,qi(t,{jobInfo:e})}catch(e){void 0!==e.jobStatus&&void 0!==e.jobId&&void 0!==e.messages&&e.jobId===o&&(r=e.jobStatus,n=e.messages)}return{jobStatus:r,messages:n}}))},t.checkServiceName=ra,t.creditThresholdCheck=Qi,t.execute=function(e){return N(this,void 0,void 0,(function*(){const{portal:t}=e,{jobParamsPayload:r,jobParams:n,toolUiParameters:o,toolName:i,analysisEngine:a,analysisType:s,resultParams:c,containerElement:u,gpMessages:l,webToolServerUrl:f,executionType:d,creditCheckOptions:p}=e;let y=function(e){let t=!0;return t=!0!==Xn(null==e?void 0:e.orgId)&&(function(e){var t,r;return null!==(r=null===(t=e.role)||void 0===t?void 0:t.includes("admin"))&&void 0!==r&&r}(e)||function(e){var t,r;return null!==(r=null===(t=e.role)||void 0===t?void 0:t.includes("publisher"))&&void 0!==r&&r}(e)),t}(t.user);const v=Object.keys(r).some((e=>{const t=r[e];return"string"==typeof t&&t.includes("serviceProperties")})),b=ta(Object.keys(r).filter((e=>{const t=r[e];return"string"==typeof t&&(t.includes("serviceProperties")||t.includes("itemProperties"))})),r);if(!1===na(b)&&(yield mi("specialCharactersInServiceNameError")),v){const e=b.map((e=>{const r=t.isPortal?function(e){return e.replace(/\s/g,"_")}(e):e;return ra({portal:t,serviceName:r,itemType:a!==Ei||void 0!==o.resultType&&"FEATURE_LAYER"===o.resultType?"Feature Service":"Image Service"})}));y=!(yield Promise.all(e)).some((e=>!1===e)),!1===y&&(yield mi("serviceNameExistsError"))}const{skipCreditChecks:h=!1,creditThreshold:g}=null!=p?p:{};if(!1===h&&void 0===f&&(e.analysisEngine===Si||e.analysisEngine===Ei)){const r=Zi(yield Yi({toolName:e.toolName,portal:t,jobParams:e.jobParamsPayload,analysisEngine:e.analysisEngine,toolElement:e.containerElement}));y=Xi(r,t.user),!1===y&&(yield mi("InsufficientCreditsError")),y=Qi(r,g),!1===y&&(yield mi("creditThresholdExceededError",{estimatedCredits:r,creditThreshold:g}))}if(!0===y){const e=`${void 0===f?Ui(a,t,"BatchGeocode"===i):f}/${i}?f=json`;if(d===Oi){const t=yield E.execute(e,n),r=t.results,c=P.default.fromJSON({messages:t.messages});qi(u,{jobInfo:c,submissionData:{toolName:i,analysisEngine:a,analysisType:s,jobParams:n,toolUiParameters:o}}),Hi(u,{results:r,jobInfo:c})}else{const t=yield E.submitJob(e,r);qi(u,{jobInfo:t,submissionData:{toolName:i,analysisEngine:a,analysisType:s,jobParams:n,toolUiParameters:o}});const f={interval:1500,statusCallback:e=>{qi(u,{jobInfo:e})}};try{let e;if(yield t.waitForJobCompletion(f),!0===c.includes("processInfo"))try{e=function(e,t={}){let r="";return e.forEach((e=>{const n=JSON.parse(e),{message:o,messageCode:i,params:a,style:s}=n;if(Array.isArray(o)){const e={};let n=s;o.forEach(((r,o)=>{const s=`${i}_${o}`;n=n.replace("></",">${"+s+"}</");let c=void 0!==t[s]?t[s]:r;c=oo(c,a),c=function(e){return e.replace(/[<>]/g,_i)}(c),e[s]=`${c}`})),r+=oo(n,e)}else{let e=void 0!==t[i]?t[i]:o;e=oo(e,a);const n=s.indexOf("</");r+=`${s.substring(0,n)}${e}${s.substring(n)}`}})),r}((yield t.fetchResultData("processInfo")).value,l);const r=c.indexOf("processInfo");c.splice(r,1)}catch(e){}const r=c.map((e=>t.fetchResultData(e))),n=(yield Promise.allSettled(r)).filter((e=>"fulfilled"===e.status)).map((e=>e.value));(function(e,t){N(this,void 0,void 0,(function*(){const r=[];e.forEach((e=>{if("object"==typeof e.value&&"itemId"in e.value&&!Xn(e.value.itemId)&&void 0!==t){const n=e.value.itemId;r.push(function(e,t){return U(this,void 0,void 0,(function*(){const r=new $.default({id:e}),n=yield r.load();let o=Object.assign(n,t);return o=yield o.update(),o}))}(n,{description:t}))}})),yield Promise.all(r)}))})(n,e),Hi(u,{results:n,jobInfo:t})}catch(e){qi(u,{jobInfo:t})}}}}))},t.getAllToolInfoJsons=Di,t.getAnalysisServer=Ui,t.getCreditsEstimate=Yi,t.getOutputServiceNames=ta,t.getToolInfoJson=Fi,t.getToolInfoJsonByUrl=Ji,t.getToolInfoJsonsByEngine=Ri,t.getToolInfoJsonsByUrl=Bi,t.getTravelModes=Mi,t.hasEnoughCredits=Xi,t.outputNameValidation=na,t.parseCreditEstimate=Zi,Object.defineProperty(t,"__esModule",{value:!0})}));