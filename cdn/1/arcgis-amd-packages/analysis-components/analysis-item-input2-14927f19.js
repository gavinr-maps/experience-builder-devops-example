define(["exports","./index-86304dcd","./index2-600fb1b2","./utils-2b3d82c1","./analysis-item-browser2-db031f89","./analysis-label2-b880686f"],(function(e,t,i,s,l,n){"use strict";const a="analysis-item-input",o={label:`${a}__label`,buttonContainer:`${a}__buttons-container`,border:`${a}__border`,loaderContainer:`${a}__loader-container`,loader:`${a}__loader`},r=t.proxyCustomElement(class extends t.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.analysisItemInputChange=t.createEvent(this,"analysisItemInputChange",7),this.analysisHelpClick=t.createEvent(this,"analysisHelpClick",7),this.renderInitialMode=()=>{var e;let i;if(void 0!==this.newItemMode){const e=this.getNewItemButtonProps(this.newItemMode);i=t.h("calcite-button",{width:"full",appearance:"outline",scale:s.UIDefaults.Scale,kind:"neutral","icon-start":e.icon,onClick:this.openAddItem},e.label)}return t.h("div",{class:o.buttonContainer},i,t.h("calcite-button",{width:"full",appearance:"outline",kind:"neutral",scale:s.UIDefaults.Scale,"icon-start":"select",onClick:this.openItemBrowser},null!==(e=this.selectButtonLabel)&&void 0!==e?e:this.strings.selectItem))},this.clearselectedItem=()=>{this.selectedItem=void 0,this.value=void 0,this.analysisItemInputChange.emit()},this.openItemBrowser=()=>{this.itemBrowserElement=document.createElement("analysis-item-browser"),this.itemBrowserElement.header=this.strings.selectItem,this.itemBrowserElement.filter=this.filterExpression,this.itemBrowserElement.portal=this.portal,this.itemBrowserElement.user=this.user,this.itemBrowserElement.bucketOptions=this.bucketOptions,this.itemBrowserElement.hidePreview=this.hidePreview,this.itemBrowserElement.hideFilters=!0,this.itemBrowserElement.hideAddToMap=!0,this.itemBrowserElement.selectionMode="single",this.itemBrowserElement.addEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.addEventListener("analysisItemBrowserSelection",this.onSelectedBrowserItem),document.body.appendChild(this.itemBrowserElement)},this.onSelectedBrowserItem=e=>{null!==e.detail&&(this.value={itemId:e.detail.id},this.analysisItemInputChange.emit())},this.openAddItem=()=>{void 0!==this.newItemMode&&void 0!==this.newItemConfig&&(this.newItemElement=document.createElement("arcgis-new-item"),this.newItemElement.allowPublish=!1,this.newItemElement.allowedItemTypes=this.itemTypes,this.newItemElement.allowedModes=[this.newItemMode],this.newItemElement.api=4,this.newItemElement.config=this.newItemConfig,this.newItemElement.portal=this.portal,this.newItemElement.user=this.user,this.newItemElement.addEventListener("workflowCancel",this.closeModals),this.newItemElement.addEventListener("workflowComplete",this.onAddItemComplete),document.body.appendChild(this.newItemElement))},this.onAddItemComplete=e=>{void 0!==e.detail.id?this.value={itemId:e.detail.id}:(this.value=void 0,this.selectedItem=void 0),this.analysisItemInputChange.emit(),void 0!==this.newItemElement&&(this.newItemElement.isActive=!1)},this.closeModals=()=>{void 0!==this.itemBrowserElement&&(this.itemBrowserElement.removeEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.removeEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.remove(),this.itemBrowserElement=void 0),void 0!==this.newItemElement&&(this.newItemElement.removeEventListener("workflowCancel",this.closeModals),this.newItemElement.removeEventListener("workflowComplete",this.onAddItemComplete),this.newItemElement.remove(),this.newItemElement=void 0)},this.getNewItemButtonProps=e=>{if("file"===e)return{icon:"upload-to",label:this.strings.addFile};throw new Error("Unsupported new item mode.")},this.validate=()=>{let e;return this.required&&i.isEmptyDataItem(this.value)?(e=!1,this.errorMessage=this.strings.requiredInputMessage):(e=!0,this.errorMessage=void 0),e},this.renderLoader=()=>{var e;const i=!0===this.isProcessingItem;return t.h("div",{class:o.loaderContainer},t.h("calcite-loader",{class:o.loader,style:{display:!1===i?"none":void 0},inline:!0,label:"loader",scale:s.UIDefaults.Scale,type:"indeterminate"}),i?null!==(e=this.processingItemMessage)&&void 0!==e?e:this.strings.queryModelArgsMsg:null)},this.onValueListItemMouseOver=e=>{var t;const i=e.target;"calcite-value-list-item"===(null==i?void 0:i.localName)&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=null!==(t=this.replaceTooltipText)&&void 0!==t?t:this.strings.replaceItem),this.replaceTooltip.referenceElement=i,s.addOpenableDomElement(document,this.replaceTooltip))},this.onValueListItemMouseOut=()=>{s.removeOpenableDomElement(this.replaceTooltip)},this.onValueListItemClick=e=>{const t=e.target;"calcite-value-list-item"===(null==t?void 0:t.localName)&&this.openItemBrowser()},this.isProcessingItem=!1,this.errorMessage=void 0,this.selectedItem=void 0,this.deepLearningParameters={},this.value=void 0,this.required=!1,this.label=void 0,this.itemTypes=[],this.itemFilter=void 0,this.sharingLevels=void 0,this.hidePreview=!1,this.newItemMode=void 0,this.selectButtonLabel=void 0,this.processingItemMessage=void 0,this.replaceTooltipText=void 0,this.newItemConfig=void 0,this.user=void 0,this.portal=void 0}async loadItemProperties(){var e;if(void 0!==this.abortController&&this.abortController.abort(),this.deepLearningParameters=void 0,"Deep Learning Package"===(null===(e=this.selectedItem)||void 0===e?void 0:e.type))try{this.abortController=new AbortController,this.isProcessingItem=!0,this.deepLearningParameters=await i.processDeepLearningModelItem(this.selectedItem,this.portal,{signal:this.abortController.signal}),this.isProcessingItem=!1,this.analysisItemInputChange.emit()}catch(e){!1===i.wasAborted(e)&&(this.isProcessingItem=!1,this.errorMessage=this.strings.queryModelArgsErrMsg)}}async hydrateSelectedItem(e){var t;const s=null==e?void 0:e.itemId;if(s!==(null===(t=this.selectedItem)||void 0===t?void 0:t.id)){if(void 0===s)this.selectedItem=void 0;else{const e=i.getPortalItemMemo(s,this.portal);try{await e.load(),this.selectedItem=e}catch(e){this.value=void 0,"object"==typeof e&&null!==e&&("identity-manager:not-authorized"===e.name?this.errorMessage=this.strings.itemPermissionDenied:"request:server"===e.name&&"object"==typeof e.details&&null!==e.details&&"CONT_0001"===e.details.messageCode&&(this.errorMessage=this.strings.itemNotFound))}}this.analysisItemInputChange.emit()}}validateOnValueChange(){this.validate()}get hasError(){return void 0!==this.errorMessage}get filterExpression(){return s.makePortalSearchFilter(this.itemTypes,this.itemFilter)}get bucketOptions(){let e;if(void 0!==this.sharingLevels){e=[...this.sharingLevels];const t=e.indexOf("org-admin");t>=0&&(e.splice(t,1),"org_admin"!==this.user.role||e.includes("org")||e.push("org"))}return e}async componentWillLoad(){({strings:this.strings}=await i.fetchComponentLocaleStrings(this.hostElement,t.getAssetPath("."))),this.hydrateSelectedItem(this.value)}disconnectedCallback(){this.closeModals(),s.removeOpenableDomElement(this.replaceTooltip)}async checkValidity(){const e=this.validate();return Promise.resolve(e)}render(){const e=i.isEmptyDataItem(this.value)?this.renderInitialMode():this.renderSelection();return t.h(t.Host,null,void 0!==this.label&&""!==this.label?t.h("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,e,t.h("calcite-input-message",{status:"invalid",scale:s.UIDefaults.Scale,hidden:!this.hasError,icon:"exclamationMarkTriangle"},this.errorMessage))}renderSelection(){var e,i,s,l;return t.h("div",null,t.h("calcite-value-list-item",{key:null===(e=this.selectedItem)||void 0===e?void 0:e.id,value:null===(i=this.selectedItem)||void 0===i?void 0:i.id,label:null!==(l=null===(s=this.selectedItem)||void 0===s?void 0:s.title)&&void 0!==l?l:"",class:o.border,onMouseOver:this.onValueListItemMouseOver,onMouseOut:this.onValueListItemMouseOut,onClick:this.onValueListItemClick},t.h("calcite-action",{text:this.strings.removeItem,slot:"actions-end",label:this.strings.removeItem,appearance:"transparent",icon:"x",onClick:this.clearselectedItem})),this.renderLoader())}static get assetsDirs(){return["t9n"]}get hostElement(){return this}static get watchers(){return{selectedItem:["loadItemProperties"],value:["hydrateSelectedItem","validateOnValueChange"]}}static get style(){return":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-ui-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height:30vh;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh}.analysis-item-input__border{border:1px solid var(--analysis-ui-border-input);box-shadow:none}.analysis-item-input__buttons-container{display:flex;flex-direction:row;gap:var(--analysis-half-spacing);margin-bottom:var(--analysis-half-spacing)}.analysis-item-input__label{cursor:pointer;padding-bottom:var(--analysis-half-spacing);margin-block-start:0;margin-block-end:0}.analysis-item-input__loader-container{font-size:var(--calcite-font-size--2)}.analysis-item-input__loader{margin-top:0.5rem}"}},[1,"analysis-item-input",{selectedItem:[1040],deepLearningParameters:[1040],value:[1040],required:[516],label:[513],itemTypes:[16],itemFilter:[1,"item-filter"],sharingLevels:[16],hidePreview:[4,"hide-preview"],newItemMode:[513,"new-item-mode"],selectButtonLabel:[513,"select-button-label"],processingItemMessage:[513,"processing-item-message"],replaceTooltipText:[513,"replace-tooltip-text"],newItemConfig:[16],user:[16],portal:[16],isProcessingItem:[32],errorMessage:[32],checkValidity:[64]}]);function m(){"undefined"!=typeof customElements&&["analysis-item-input","analysis-item-browser","analysis-label"].forEach((e=>{switch(e){case"analysis-item-input":customElements.get(e)||customElements.define(e,r);break;case"analysis-item-browser":customElements.get(e)||l.defineCustomElement();break;case"analysis-label":customElements.get(e)||n.defineCustomElement()}}))}m(),e.AnalysisItemInput=r,e.defineCustomElement=m}));