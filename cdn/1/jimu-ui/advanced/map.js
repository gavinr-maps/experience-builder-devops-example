System.register(["jimu-arcgis","jimu-core","jimu-core/emotion","jimu-theme","jimu-ui","jimu-ui/basic/color-picker"],function(e,t){var i={},o={},s={},a={},n={},l={};return{setters:[function(e){i.JimuMapViewComponent=e.JimuMapViewComponent,i.MapViewManager=e.MapViewManager,i.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,i.portalUtils=e.portalUtils},function(e){o.APP_FRAME_NAME_IN_BUILDER=e.APP_FRAME_NAME_IN_BUILDER,o.AppMode=e.AppMode,o.DataSourceComponent=e.DataSourceComponent,o.DataSourceTypes=e.DataSourceTypes,o.ErrorBoundary=e.ErrorBoundary,o.ExtentChangeMessage=e.ExtentChangeMessage,o.Immutable=e.Immutable,o.MessageManager=e.MessageManager,o.React=e.React,o.ReactDOM=e.ReactDOM,o.ReactRedux=e.ReactRedux,o.ReactResizeDetector=e.ReactResizeDetector,o.SessionManager=e.SessionManager,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.esri=e.esri,o.focusElementInKeyboardMode=e.focusElementInKeyboardMode,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.injectIntl=e.injectIntl,o.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,o.loadArcGISMapComponents=e.loadArcGISMapComponents,o.lodash=e.lodash,o.polished=e.polished,o.portalUrlUtils=e.portalUrlUtils,o.useIntl=e.useIntl,o.utils=e.utils},function(e){s.Fragment=e.Fragment,s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){a.Global=e.Global,a.registerStyles=e.registerStyles,a.useTheme=e.useTheme,a.withStyles=e.withStyles,a.withTheme=e.withTheme},function(e){n.AlertPopup=e.AlertPopup,n.Button=e.Button,n.FOCUSABLE_CONTAINER_CLASS=e.FOCUSABLE_CONTAINER_CLASS,n.Icon=e.Icon,n.Label=e.Label,n.MobilePanelManager=e.MobilePanelManager,n.Nav=e.Nav,n.NavItem=e.NavItem,n.NavLink=e.NavLink,n.NumericInput=e.NumericInput,n.Option=e.Option,n.Popper=e.Popper,n.SVG=e.SVG,n.Select=e.Select,n.Slider=e.Slider,n.Switch=e.Switch,n.TextArea=e.TextArea,n.defaultMessages=e.defaultMessages,n.getButtonIconSizeNumber=e.getButtonIconSizeNumber,n.getFocusableElements=e.getFocusableElements,n.hooks=e.hooks},function(e){l.ColorPicker=e.ColorPicker}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=a},3077:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="M7 1a6 6 0 1 0 0 12A6 6 0 0 0 7 1m0 13a7 7 0 1 1 5.621-2.828l-.222.284 3.405 3.404a.668.668 0 0 1-.944.944L11.456 12.4A6.97 6.97 0 0 1 7 14"></path></svg>'},8634:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 39 32"><path d="M38.784 9.778v2.962H3.236V9.778h.074L13.086.002l2.111 2.111-7.702 7.665zM3.236 21.628h31.327l-7.702 7.702 2.111 2.111 9.776-9.813h.037v-2.962H3.237v2.962z"></path></svg>'},14321:e=>{"use strict";e.exports=n},24769:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><g fill="none" fill-rule="nonzero"><path fill="#000" d="m7.745 7 4.1 4.1a.527.527 0 0 1-.745.746L7 7.746l-4.1 4.1a.527.527 0 0 1-.746-.746l4.1-4.1-4.1-4.1a.527.527 0 0 1 .746-.746l4.1 4.1 4.1-4.1a.527.527 0 0 1 .746.746z"></path><path d="M1 1h12v12H1z"></path></g></svg>'},48013:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0"></path></svg>'},53089:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#050505" d="m12.687 9.074.073-.133a.15.15 0 0 0 .017-.078l-.012-.142c-.002-.033-.042-.051-.068-.028l-.205.175a.1.1 0 0 1-.019.01l-.092.017a.04.04 0 0 0-.033.051l.019.077a.14.14 0 0 0 .093.097l.07.02a.134.134 0 0 0 .157-.066M13.8 9.389a.13.13 0 0 0 .058-.014l.141-.069q.002 0 .003.002l.104.13q.008.01.023.01h.069a.028.028 0 0 0 .023-.046l-.108-.141-.047-.04-.382-.191-.092.036h-.07v-.001l-.026-.084a.027.027 0 0 0-.025-.019h-.093a.027.027 0 0 0-.027.028v.082h.06v.024c0 .03.023.055.052.06l.136.016h.001l.074.093c.023.028.019.097-.006.125v.001h.131zM13.878 6.775l-.048.043a.3.3 0 0 0-.094.187.3.3 0 0 1-.082.178.5.5 0 0 1-.246.136l-.018.004-.076.062s-.022.11 0 .135c.009.012.049.01.061 0 .016-.012.017-.08.017-.08l.242-.087s.06.08.09.083c.012.002.042-.013.05-.025.032-.045.068-.208.068-.208a.6.6 0 0 0 .024-.113l.013-.143.108-.007.043-.087-.112-.011zM9.427 10.12a.141.141 0 0 0 .245 0v-.334a.122.122 0 0 0-.187-.105.13.13 0 0 0-.058.105zM6.698 4.315l.144-.084.002-.006a.065.065 0 0 0-.026-.085.1.1 0 0 0-.031-.008h-.328l-.035-.038a.22.22 0 0 0-.157-.074L5.778 4l-.048.009-.048.009-.289.122a.2.2 0 0 1-.076.018l-.464.023a.2.2 0 0 0-.099.028l-.26.148a.03.03 0 0 0-.015.024.03.03 0 0 0 .012.026c.02.015.014.047-.01.053l-.203.051a.03.03 0 0 0-.019.044l.068.112a.03.03 0 0 0 .02.014l.364.063c.056.01.106.04.14.086l.251.333.074.102a.094.094 0 0 1-.007.118l-.056.06a.09.09 0 0 0-.015.105l.183.37a.13.13 0 0 0 .081.068.223.223 0 0 0 .274-.142l.048-.137a.1.1 0 0 1 .04-.05l.204-.175a.24.24 0 0 1 .085-.046l.32-.088a.22.22 0 0 0 .148-.133l.151-.378a.23.23 0 0 0-.001-.172l-.03-.07a.23.23 0 0 1 .097-.28M4.03 4.643l.061-.11a.2.2 0 0 1 .088-.087l.504-.282-.057-.066-.572-.035a.2.2 0 0 0-.05.003l-.557.09a.232.232 0 0 0-.137.377l.125.148c.043.051.107.08.172.08h.224a.23.23 0 0 0 .199-.118M4.666 5.672l.052-.061c.013-.016.01-.04-.007-.051l-.162-.116-.569-.425a.14.14 0 0 0-.081-.027h-.224a.13.13 0 0 0-.095.04l-.118.115a.034.034 0 0 0-.003.047l.067.085q.01.015.03.014l.064-.006a.035.035 0 0 1 .038.033l.002.038q0 .007-.002.016l-.03.073a.04.04 0 0 0 .006.036l.07.084a.03.03 0 0 0 .028.012l.068-.003a.035.035 0 0 0 .034-.035v-.147c0-.019.014-.034.032-.035l.094-.007q.014 0 .024.007l.174.133c.013.011.017.029.01.044l-.057.116a.03.03 0 0 1-.03.018l-.054.004a.04.04 0 0 0-.032.027.036.036 0 0 0 .032.044l.117.009q.037.002.069.024l.206.146q.022.014.043-.003l.065-.055a.03.03 0 0 0 .011-.018l.021-.083a.04.04 0 0 0-.004-.029l-.07-.11.022-.004a.04.04 0 0 1 .024.004l.091.054a.035.035 0 0 0 .044-.008M2.08 5.137h.07l.104.146q.02.027.05.044l.136.068q.028.015.061.015h.422V5.27l-.156-.056-.18-.097A.14.14 0 0 1 2.52 5.1l-.288-.166a.13.13 0 0 0-.067-.018h-.173a.14.14 0 0 0-.13.095l-.014.047a.14.14 0 0 0 .033.14l.061.062h.138zM2.679 5.022l.11-.058a.14.14 0 0 1 .063-.015h.06c.052 0 .1.03.123.078l.044.092v.094h-.2v-.12l-.084-.043-.1.003zM3.061 4.95l.1.164.08.047h.115l.116-.124-.088-.116-.225.028zM2.414 4.698l.158.057a.1.1 0 0 1 .03.015l.109.073q.027.019.06.021l.2.02-.024-.124-.238-.132a.14.14 0 0 0-.065-.017h-.122zM7.46 5.712l.058.092a.03.03 0 0 1-.001.028l-.044.06q-.007.013-.004.022l.017.061a.02.02 0 0 0 .008.012l.092.072c.063.048.07.141.017.2l-.001.002a.14.14 0 0 1-.101.046h-.11a.025.025 0 0 1-.024-.031l.028-.11a.02.02 0 0 1 .014-.017l.049-.024q.015-.008.013-.026l-.002-.03a.03.03 0 0 0-.02-.021l-.071-.015a.024.024 0 0 0-.027.014l-.016.035v.002l-.001.002-.035.118q-.006.017-.024.018l-.11-.003a.02.02 0 0 1-.018-.007.02.02 0 0 1-.007-.017v-.127c0-.013.011-.024.024-.024l.058-.002q.012 0 .02-.01l.053-.079A.03.03 0 0 0 7.3 5.94V5.82q0-.012.01-.019l.115-.094a.024.024 0 0 1 .037.005"></path><path fill="#050505" fill-rule="evenodd" d="M15.073 5.1H14.7a.04.04 0 0 1-.04-.03l-.358-.069a.16.16 0 0 1-.088-.027l-.081-.055a.16.16 0 0 0-.088-.027s-.832-.43-1.922-.388c-.41.016-.77.222-.77.222a.03.03 0 0 0-.02.026l-.004.034a.033.033 0 0 1-.033.028l-.164-.004a.033.033 0 0 0-.034.032l-.459.016c-.04 0-.077.02-.1.053l-.041.06c-.03.045-.441.06-.441.06a.06.06 0 0 1-.036-.055v-.049q0-.026.02-.044l.218-.2a.16.16 0 0 1 .087-.04l.136-.018a.06.06 0 0 0 .04-.024l.016-.024a.06.06 0 0 0-.028-.09l-.01-.005a.06.06 0 0 0-.047.004l-.104.061a.1.1 0 0 1-.03.008h-.101a.16.16 0 0 0-.114.049l-.244.252a.17.17 0 0 0-.042.08l-.023.11.016.047-.096.135-.087.087h-.081v-.087H9.45l-.028.11a.16.16 0 0 1-.098.11l-.081.032a.16.16 0 0 1-.156-.026l-.106-.086.284.015.032-.062S9 5.18 8.828 5.084c-.14-.08-.324-.013-.388.016a.2.2 0 0 0-.042.027l-.62.565a.16.16 0 0 0-.006.231l.058.061.083-.069a.06.06 0 0 1 .076.003l.155.146h.04l.146-.176a.06.06 0 0 0 .002-.072l-.019-.026a.06.06 0 0 1-.004-.066l.204-.334a.04.04 0 0 1 .052-.017l.036.018c.022.01.03.035.019.057l-.14.268a.13.13 0 0 0-.01.104l.023.071a.18.18 0 0 1-.03.146l-.087.12a.16.16 0 0 1-.134.064l-.254-.01a.05.05 0 0 1-.031-.013.05.05 0 0 1-.013-.032v-.042a.045.045 0 0 0-.046-.046.046.046 0 0 0-.045.042l-.007.074a.046.046 0 0 1-.045.042h-.024a.04.04 0 0 0-.03.012l-.414.386.06.088v.093a.057.057 0 0 1-.056.056h-.132c-.071 0-.127.06-.123.132l.001.018a.124.124 0 0 0 .119.116l.141.004a.16.16 0 0 0 .135-.068l.101-.144a.16.16 0 0 1 .13-.067h.097q.05 0 .09.028l.157.11c.03.022.033.068.004.092l-.088.077a.16.16 0 0 1-.104.04h-.55a.16.16 0 0 0-.126.064l-.425.573a.17.17 0 0 0-.032.096v.38q0 .054.032.097l.148.198q.018.025.027.055c.01.033.036.08.1.08h.686s.172.005.172.12q0 .061-.003.116a.16.16 0 0 0 .083.148c.048.028.099.077.099.155v.21a.2.2 0 0 1-.007.049.8.8 0 0 1-.079.178c-.036.054.015.135.052.182a.17.17 0 0 1 .035.102v.21s.016.076.088.109a.6.6 0 0 1 .097.05v.084c0 .09.071.16.16.16h.207s.094.008.155-.087l.28-.437s.04-.043 0-.12c-.04-.076-.021-.145-.021-.145l.19-.11s.09-.016.09-.141v-.136a.1.1 0 0 0-.018-.062l-.033-.057a.16.16 0 0 1 .021-.191l.395-.424s.104-.156.104-.235H9.49a.16.16 0 0 1-.136-.077l-.346-.576a.087.087 0 0 1 .033-.121.084.084 0 0 1 .112.03l.335.552-.001.05c0 .016.012.028.028.028.083 0 .327-.01.463-.13a.6.6 0 0 0 .143-.181.16.16 0 0 0-.038-.19l-.085-.076-.11.025-.197-.199a.063.063 0 0 1 .016-.1.06.06 0 0 1 .065.007l.307.238s.063.056.127.056h.18c.056 0 .108.03.136.078l.402.683s.06.056.094.054c.035-.003.082-.15.082-.15 0-.136.065-.266.176-.344l.138-.098a.16.16 0 0 1 .202.015l.085.083v.09c0 .014.012.027.028.027h.038l.036-.036h.042v.359c0 .04.015.08.043.109l.267.288v-.103a.16.16 0 0 0-.035-.1l-.125-.158a.16.16 0 0 1-.035-.1v-.109c0-.017.021-.026.033-.013l.162.167.004.105c.001.02.025.03.038.015l.229-.25s.066-.083 0-.152a5 5 0 0 0-.158-.154.05.05 0 0 1-.016-.039.05.05 0 0 1 .019-.038l.044-.037.11.002s-.023.052-.058.112c0 0 .017.096.123-.083.008-.007.036-.003.067.002.04.006.084.014.1-.002.06-.064.309-.407.309-.407s.032-.126-.043-.192c-.076-.066-.043-.147-.043-.147l.094-.082v-.058h-.244s.02-.13.194-.139l.031-.001q.016 0 .03-.002a.13.13 0 0 1 .127.083q.01.024.01.052v.243l.036.004s.068.007.093-.084c0 0 .046-.013.046-.068v-.066l-.066-.08.107-.138a.12.12 0 0 1 .075-.045l.054-.011a.13.13 0 0 0 .08-.053l.247-.373a.17.17 0 0 0 .027-.09v-.102a.05.05 0 0 0-.05-.05h-.144s-.06-.07.022-.12c.057-.035.169-.128.232-.18a.16.16 0 0 1 .101-.038h.29a.16.16 0 0 0 .093-.03l.19-.137a.04.04 0 0 1 .025-.008c.082 0 .125.1.07.162l-.198.214a.16.16 0 0 0-.043.106l-.003.173c0 .032.026.06.059.06h.048l.259-.268a.13.13 0 0 0 .033-.066l.01-.056a.16.16 0 0 1 .155-.134h.114a.15.15 0 0 0 .104-.039l.159-.14a.04.04 0 0 1 .028-.01h.082a.042.042 0 0 0 .043-.044v-.08q0-.02.013-.032l.062-.058a.16.16 0 0 1 .181-.024l.104.055a.06.06 0 0 0 .076-.016l.051-.065a.06.06 0 0 0 .012-.052.06.06 0 0 0-.033-.042l-.503-.25a5 5 0 0 0-.39-.014M8.141 7.024l.09-.078zl-.133-.163a.1.1 0 0 1-.01-.019.1.1 0 0 0 .01.018zm.755.493h-.081a.1.1 0 0 1-.032-.004 9 9 0 0 1-.61-.186.06.06 0 0 1-.035-.045.06.06 0 0 1 .015-.055l.11-.117a.094.094 0 0 1 .13.005l.1.107.087-.016-.024-.064s-.01-.03-.021-.056.048-.061.048-.061.06-.006.06.088c0 .093.097.163.097.163h.332c.021 0 .035.023.024.04l-.059.113a.16.16 0 0 1-.141.088m.417-.503H9.2l-.083-.065a.06.06 0 0 0-.032-.01h-.108a.07.07 0 0 0-.044.017l-.078.07-.078.012a.05.05 0 0 1-.056-.026.1.1 0 0 1-.006-.02l-.011-.087a.1.1 0 0 1 .021-.069l.128-.145.058-.005-.003.026a.05.05 0 0 0 .05.058h.029a.07.07 0 0 0 .064-.042l.026-.058.12.02.01.087a.08.08 0 0 0 .026.048l.133.112v.025c0 .03-.023.052-.053.052m.574.093v.099h-.205l-.018-.099a.05.05 0 0 1 .008-.039l.011-.015a.05.05 0 0 0-.008-.069l-.096-.089v-.163l.14-.06h.072c.028 0 .052.019.06.046l.001.004q.008.031-.013.056a.1.1 0 0 0-.015.031l-.013.085.113.105-.08.054z" clip-rule="evenodd"></path><path fill="#050505" d="M12.945 7.8q-.008-.022-.017-.021t-.036.025a.11.11 0 0 0-.039.08q0 .03.012.062c.007.018.02.032.028.032.025 0 .066-.14.052-.178M12.894 8.108l.024.005.014.004q.026.008.033.015.006.007.013.03l.004.014c.008.027.002.053-.018.07-.046.037-.038.057.03.072.047.01.061.024.061.062 0 .046-.003.046-.055.019-.03-.016-.06-.023-.065-.016q-.009.012.014.021c.055.02.086.071.074.12-.014.057.014.066.059.02.048-.049.089.023.078.136-.004.038-.038.055-.09.043a.1.1 0 0 1-.022-.012.04.04 0 0 1-.013-.027c0-.024-.013-.029-.051-.02s-.05.006-.05-.018a.05.05 0 0 1 .03-.044q.02-.006.02-.017 0-.01-.02-.038a.2.2 0 0 1-.03-.08c0-.02-.008-.037-.019-.037-.027 0-.088-.193-.063-.201q.007-.004.012-.016a.2.2 0 0 0 .009-.053c0-.04.003-.054.021-.052M12.8 8.567c.047-.044.072-.116.04-.116-.014 0-.082.079-.11.129-.03.052.009.045.07-.013M12.912 8.698a.02.02 0 0 1 .021.02q0 .018-.008.02s-.005 0-.007-.003a.1.1 0 0 1-.015-.017q-.01-.018.01-.02M13.254 8.913q-.021-.045-.044-.043t-.03.05a.1.1 0 0 1-.01.026c.013.052.052.06.064.063h.004l.025-.029.014-.015zM13.082 8.894c.026-.004.035.015.011.043l-.008.015-.057.01-.036.005c-.038.006-.077.011-.1.037q0 .006.01.009t.032-.001l.006-.003.005-.003.02-.002.064.008-.004.006h-.002l-.005.004-.013.008c-.03.026-.044.054-.034.067.008.012.015.04.015.062-.002.053-.066.067-.079.017q-.009-.035-.012.021c-.001.044-.011.057-.038.051-.02-.004-.035-.025-.035-.047a.14.14 0 0 0-.016-.065c-.008-.013-.006-.048.006-.078.007-.019.009-.028.01-.036l.002-.006.012-.032.018-.05-.003.001c.028-.026.056-.032.1-.022l.032.004a.15.15 0 0 0 .068-.012q.015-.009.031-.011M13.36 9.136c0-.027-.034-.042-.092-.042a1 1 0 0 0-.064.006c-.08.012-.103.027-.08.051.02.02.236.007.236-.015M5.866 9.362l-.35-.185a.2.2 0 0 0-.102-.026h-.101a.04.04 0 0 1-.037-.033.22.22 0 0 0-.218-.201h-.032a.22.22 0 0 1-.173-.088l-.048-.065a.22.22 0 0 0-.155-.086l-.262-.023a.03.03 0 0 1-.017-.007l-.043-.03q-.019-.012-.038 0l-.187.106a.2.2 0 0 1-.108.028h-.192a.04.04 0 0 1-.017-.004.15.15 0 0 1-.071-.133v-.112a.04.04 0 0 0-.023-.035l-.014-.003h-.122a.04.04 0 0 1-.032-.019.04.04 0 0 1 0-.038l.057-.1a.04.04 0 0 0 .006-.02V8.2q0-.016-.011-.027a.04.04 0 0 0-.027-.011h-.066a.04.04 0 0 0-.03.017l-.038.06a.22.22 0 0 1-.184.1h-.054s-.086-.015-.086-.108v-.339a.1.1 0 0 1 .045-.067c.032-.02.107-.061.144-.081a.04.04 0 0 1 .043.005l.07.066q.01.01.024.01h.015c.022 0 .051 0 .057-.003q.005-.003.003-.014c0-.017 0-.046.045-.06.066-.019.109.04.109.04l.165.199a.04.04 0 0 0 .05.006l.023-.016a.04.04 0 0 0 .012-.05l-.002-.005a.22.22 0 0 1 .048-.28l.137-.118s.016-.01.024-.071c.005-.037.015-.09.021-.128l.021-.036.02-.036.297-.252a.036.036 0 0 1 .055.008c.014.022.038.046.069.045a.8.8 0 0 0 .208-.093.04.04 0 0 0 .019-.033v-.047l-.143.03a.04.04 0 0 1-.044-.031l-.016-.095a.04.04 0 0 0-.036-.03l-.143.015.018-.043a.04.04 0 0 1 .034-.027l.352-.037.056-.023.056-.023.071-.056a.04.04 0 0 0 .004-.055l-.396-.41a.04.04 0 0 0-.043-.008l-.118.057a.04.04 0 0 1-.038-.003L4.1 5.91a.036.036 0 0 0-.05.008l-.051.07a.03.03 0 0 0-.007.02l-.01.174q0 .016.011.029l.048.05a.04.04 0 0 1-.005.056l-.07.051a.04.04 0 0 1-.034.006l-.16.027a.22.22 0 0 0-.133-.13l-.08-.028a.222.222 0 0 1-.098-.35l.156-.19a.04.04 0 0 0 .007-.038l-.044-.115-.008-.012-.176-.19a.122.122 0 0 0-.21.065l-.001.01a.12.12 0 0 1-.12.104H2.54l-.05-.01-.04-.009-.358-.162-.075-.018-.33-.022-.092.015-.148.058a.2.2 0 0 1-.124.01L.591 5.23a.2.2 0 0 0-.132.013l-.346.15a.038.038 0 0 0-.009.063l.09.077c.026.021.011.065-.022.066l-.136.003c-.02 0-.036.017-.036.037v.02c0 .02.016.036.036.037l.117.001c.04.002.051.056.015.072l-.101.046a.04.04 0 0 0-.022.037l.01.103a.22.22 0 0 0 .184.198l.072.012c.034.006.042.051.013.069l-.023.013c-.024.015-.024.05 0 .064l.012.006a.04.04 0 0 0 .035.003l.618-.282a.22.22 0 0 1 .237.04l.588.543a.22.22 0 0 1 .071.152l.02.415a.22.22 0 0 0 .048.128l.579.728c.01.014.03.018.045.01a.04.04 0 0 0 .014-.055s.365.383.4.399l.296.148a.2.2 0 0 0 .097.023h.147q.024 0 .033.021l.05.108V8.7l.001.001.002.003c.015.025.088.143.165.148.087.005.243 0 .243 0s.056-.001.056.06v.095a.04.04 0 0 1-.019.032c-.048.027-.172.107-.172.197v.212q0 .014.008.024c.016.019.05.06.08.084.027.022.072.073.098.103l.013.014a.04.04 0 0 1 .008.024v.122l.001.006.001.007c.007.016.024.057.055.072.019.009.065.047.108.085a.22.22 0 0 1 .076.186l-.027.345-.003.02-.003.02-.119.45-.007.08.012.185a.2.2 0 0 1-.01.095l-.044.126a.24.24 0 0 0-.007.125l.056.233a.12.12 0 0 0 .044.07l.057.045c.022.018.054.042.076.026.077-.054.12-.218.155-.353.015-.06.03-.115.044-.15.01-.023.067-.105.134-.202.11-.156.245-.35.244-.389l-.003-.09c0-.022.016-.038.037-.038h.114q.016 0 .026-.012l.266-.294a.04.04 0 0 0 .01-.026v-.12c0-.021.017-.037.038-.037.045.002.12.002.145-.02.027-.021.097-.103.138-.15l.021-.024a.04.04 0 0 0 .01-.025v-.19c0-.055.02-.108.057-.15l.133-.148a.137.137 0 0 0-.043-.215M14.916 10.7l-.008.001c-.006.005.005.036.024.067.031.051.033.062.016.086-.017.025-.016.03.004.044q.054.035-.022.03c-.038-.004-.049.002-.07.039a.3.3 0 0 1-.078.074c-.071.044-.108.109-.06.109q.02.001.012.026c-.01.032-.006.032.065-.002.041-.02.06-.038.066-.065a.07.07 0 0 1 .041-.048c.018-.006.032-.015.03-.019-.007-.018.033-.082.048-.077.02.006.08-.06.07-.076q-.006-.01.012-.011c.022 0 .043-.048.03-.067-.004-.006-.023-.007-.043-.003q-.035.008-.035-.01c0-.02-.075-.089-.102-.097M12.885 9.274l-.486-.057a.1.1 0 0 1-.035-.01l-.118-.048a.14.14 0 0 1-.048-.032l-.39-.414a.05.05 0 0 0-.042-.015.047.047 0 0 0-.028.078l.41.466a.15.15 0 0 0 .063.04l.232.07a.1.1 0 0 0 .04.005h.397zM13.85 9.535l-.02.057a.255.255 0 0 1-.27.17.05.05 0 0 1-.038-.027.05.05 0 0 1 .001-.047l.1-.186-.26.01a.3.3 0 0 0-.1.023l-.098.046a.3.3 0 0 0-.07.049l-.18.178a.2.2 0 0 1-.075.051l-.123.055a.26.26 0 0 0-.152.236v.02q0 .052.02.1l.096.228q.004.008.005.015a.11.11 0 0 0 .143.077l.245-.088a.25.25 0 0 1 .108-.013l.294.027c.08.006.15.05.193.12l.02.03a.25.25 0 0 0 .218.122h.118a.26.26 0 0 0 .182-.076l.13-.132a.26.26 0 0 0 .075-.183v-.173a.26.26 0 0 0-.082-.19l-.268-.248a.24.24 0 0 1-.06-.082l-.08-.175c-.017-.027-.06-.026-.071.006M13.322 9.25c.017.001.029.014.028.037 0 .015-.029.043-.064.063a.3.3 0 0 1-.068.032c-.016.004-.019-.005-.019-.027 0-.017.006-.031.014-.031.007 0 .03-.02.051-.043q.031-.033.058-.03M13.079 9.272c.16 0 .149.04-.013.048-.095.004-.12 0-.115-.021.005-.018.045-.027.128-.027M6.117 5.52h.09l.067.046.182-.047.033.081v.115l-.175.021a.13.13 0 0 1-.1-.028l-.153-.121zM8.12 4.551h-.23l-.056.04.197.25h.09l.082-.152.202.103.032-.048-.24-.169a.13.13 0 0 0-.076-.024M8.611 4.372h-.298l-.028.046.086.064a.13.13 0 0 0 .08.027h.16l.076-.08zM3.042 4.379l-.197.074-.19.048.273.13.216-.07.072-.013-.057-.109zM3.415 4.78h-.086v.043l.046.017.01.044.071.01.048.055.424-.014.024-.05-.037-.056h-.456zM3.03 4.884l-.033-.096.033-.018.127.01.03.029-.07.082zM3.216 4.725l.016-.054.035-.024.034.013.058.025v.024h-.03l-.046.038z"></path><path fill="#050505" d="m3.844 8.095-.083.037c-.01.005-.01.021 0 .024l.088.037.103-.017.167.115h.119s.081-.01.081-.032-.081-.033-.081-.033l-.172-.13zM4.4 8.272s-.074.045-.065.066c.016.038.16 0 .16 0s.052-.048.043-.066c-.018-.031-.138 0-.138 0M14.162 10.93h-.28l.074.164h.066z"></path></svg>'},54337:e=>{"use strict";e.exports=l},62686:e=>{"use strict";e.exports=i},67386:e=>{"use strict";e.exports=s},74305:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><g id="Application/text-outline"><path id="Vector (Stroke)" fill="#000" fill-rule="evenodd" d="M15 1v4h-3.09v-.974A.16.16 0 0 0 11.817 4H9.545v8h1.948v3H4.506v-3h1.949V4H4.182a.16.16 0 0 0-.091.026V5H1V1zM8.545 3h3.273c.29 0 .567.105.772.293a.96.96 0 0 1 .32.707H14V2H2v2h1.09a.96.96 0 0 1 .32-.707c.205-.188.482-.293.772-.293h3.273v9.5a.48.48 0 0 1-.16.354.57.57 0 0 1-.386.146H5.506v1h4.987v-1H9.092a.57.57 0 0 1-.386-.146.48.48 0 0 1-.16-.354z" clip-rule="evenodd"></path></g></svg>'},79244:e=>{"use strict";e.exports=o},87616:e=>{e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjEzMiIgdmlld0JveD0iMCAwIDE4MCAxMzIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTUwLjM4OTUgMTMuMjU1NkM1Mi45NDU0IDEzLjI1NTYgNTUuMDE3MyAxMS4xODM2IDU1LjAxNzMgOC42Mjc3OEM1NS4wMTczIDYuMDcxOTMgNTIuOTQ1NCA0IDUwLjM4OTUgNEM0Ny44MzM3IDQgNDUuNzYxNyA2LjA3MTkzIDQ1Ljc2MTcgOC42Mjc3OEM0NS43NjE3IDExLjE4MzYgNDcuODMzNyAxMy4yNTU2IDUwLjM4OTUgMTMuMjU1NlpNNTAuMzg5NSAxMS45MzMzQzUyLjIxNTEgMTEuOTMzMyA1My42OTUxIDEwLjQ1MzQgNTMuNjk1MSA4LjYyNzc4QzUzLjY5NTEgNi44MDIxNyA1Mi4yMTUxIDUuMzIyMjIgNTAuMzg5NSA1LjMyMjIyQzQ4LjU2MzkgNS4zMjIyMiA0Ny4wODQgNi44MDIxNyA0Ny4wODQgOC42Mjc3OEM0Ny4wODQgMTAuNDUzNCA0OC41NjM5IDExLjkzMzMgNTAuMzg5NSAxMS45MzMzWiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNTQuNzY3IDEwMy43OTlDMTU0Ljc2NyAxMDYuMzU1IDE1Mi42OTYgMTA4LjQyNyAxNTAuMTQgMTA4LjQyN0MxNDcuNTg0IDEwOC40MjcgMTQ1LjUxMiAxMDYuMzU1IDE0NS41MTIgMTAzLjc5OUMxNDUuNTEyIDEwMS4yNDMgMTQ3LjU4NCA5OS4xNzEyIDE1MC4xNCA5OS4xNzEyQzE1Mi42OTYgOTkuMTcxMiAxNTQuNzY3IDEwMS4yNDMgMTU0Ljc2NyAxMDMuNzk5Wk0xNTMuNDQ1IDEwMy43OTlDMTUzLjQ0NSAxMDUuNjI1IDE1MS45NjUgMTA3LjEwNSAxNTAuMTQgMTA3LjEwNUMxNDguMzE0IDEwNy4xMDUgMTQ2LjgzNCAxMDUuNjI1IDE0Ni44MzQgMTAzLjc5OUMxNDYuODM0IDEwMS45NzMgMTQ4LjMxNCAxMDAuNDkzIDE1MC4xNCAxMDAuNDkzQzE1MS45NjUgMTAwLjQ5MyAxNTMuNDQ1IDEwMS45NzMgMTUzLjQ0NSAxMDMuNzk5WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTE4LjM3ODggMTguNTc4QzE2Ljc3IDE4LjE1MDQgMTUuMTg0NiAxNy43NzM0IDEzLjYzNTIgMTcuNDQzTDEzLjkxMSAxNi4xNDk4QzE1LjQ4MSAxNi40ODQ3IDE3LjA4NzggMTYuODY2NyAxOC43MTg0IDE3LjMwMDJMMTguMzc4OCAxOC41NzhaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNMjMuMDYwMiAxOS45NTE2QzI0LjU4ODIgMjAuNDQzNSAyNi4xMjUyIDIwLjk4MjYgMjcuNjYxIDIxLjU3MkwyOC4xMzQ3IDIwLjMzNzZDMjYuNTc1MyAxOS43MzkgMjUuMDE1MyAxOS4xOTIgMjMuNDY1NCAxOC42OTNMMjMuMDYwMiAxOS45NTE2WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTguODMyMTUgMTYuNTQyMkM3LjE0NzQ2IDE2LjI2OTQgNS41MzAwNiAxNi4wNTMyIDQgMTUuODg3M0w0LjE0MjU5IDE0LjU3MjhDNS42OTU1OCAxNC43NDEyIDcuMzM1ODkgMTQuOTYwNSA5LjA0MzQ1IDE1LjIzNjlMOC44MzIxNSAxNi41NDIyWiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTMyLjE1ODcgMjMuNDUxM0MzMy42Mjg5IDI0LjExODQgMzUuMDg4MiAyNC44MzUzIDM2LjUyNzIgMjUuNjA0OEwzNy4xNTA3IDI0LjQzODhDMzUuNjg1IDIzLjY1NTEgMzQuMiAyMi45MjU2IDMyLjcwNTEgMjIuMjQ3M0wzMi4xNTg3IDIzLjQ1MTNaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNNDQuNzQxNiAzMC43OTk0QzQzLjQ0MDQgMjkuODI3MiA0Mi4xMDE4IDI4LjkxMTIgNDAuNzM0NCAyOC4wNDg4TDQxLjQzOTggMjYuOTMwNUM0Mi44MzUgMjcuODEwNSA0NC4yMDI1IDI4Ljc0NjEgNDUuNTMzMSAyOS43NDAyTDQ0Ljc0MTYgMzAuNzk5NFoiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGQ9Ik00OC41MDMgMzMuODY4OUM0OS43MDU1IDM0Ljk0MTkgNTAuODYzIDM2LjA3MjMgNTEuOTY3IDM3LjI2MjhMNTIuOTM2NSAzNi4zNjM4QzUxLjgwMjkgMzUuMTQxNCA1MC42MTU2IDMzLjk4MTkgNDkuMzgzMyAzMi44ODI0TDQ4LjUwMyAzMy44Njg5WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTU2LjQ4NzEgNDIuOTQ2N0M1Ni4wMzMyIDQyLjI3NDUgNTUuNTYzNiA0MS42MTc3IDU1LjA3OTIgNDAuOTc1OEw1Ni4xMzQ2IDQwLjE3OTRDNTYuNjMyNyA0MC44Mzk0IDU3LjExNTggNDEuNTE1MSA1Ny41ODI5IDQyLjIwNjhDNTguMDk5MSA0Mi45NzEzIDU4LjU5MDQgNDMuNzM3NSA1OS4wNTg0IDQ0LjUwNDlMNTcuOTI5NSA0NS4xOTMzQzU3LjQ3MjEgNDQuNDQzMiA1Ni45OTE4IDQzLjY5NDIgNTYuNDg3MSA0Mi45NDY3WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTYwLjQ5MjQgNDkuODY4NUM2MS4yOTA3IDUxLjQ5NzUgNjEuOTk2NCA1My4xMjc5IDYyLjYyNDQgNTQuNzU1MUw2My44NTc5IDU0LjI3OUM2My4yMTY5IDUyLjYxODEgNjIuNDk1OSA1MC45NTIzIDYxLjY3OTcgNDkuMjg2N0w2MC40OTI0IDQ5Ljg2ODVaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNMTUxLjYxMyA4Mi45NzYyQzE1MC43ODggODIuNzU1MiAxNDkuOTY1IDgyLjYxMTggMTQ5LjE0MyA4Mi41MzkyTDE0OS4yNTkgODEuMjIyMUMxNTAuMTU3IDgxLjMwMTQgMTUxLjA1NSA4MS40NTggMTUxLjk1NSA4MS42OTkxQzE1Mi44MzcgODEuOTM1NCAxNTMuNjczIDgyLjIwMjIgMTU0LjQ2NSA4Mi40OTc5TDE1NC4wMDMgODMuNzM2N0MxNTMuMjUyIDgzLjQ1NjQgMTUyLjQ1NiA4My4yMDIyIDE1MS42MTMgODIuOTc2MloiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGQ9Ik02NC4zNDU0IDU5LjgwNzVDNjQuODYzNSA2MS41NDIzIDY1LjMwOTYgNjMuMjY4MiA2NS43MDIyIDY0Ljk3OTZMNjYuOTkxIDY0LjY4NEM2Ni41OTI5IDYyLjk0ODYgNjYuMTM5NiA2MS4xOTQ5IDY1LjYxMjMgNTkuNDI5Mkw2NC4zNDU0IDU5LjgwNzVaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNMTYyLjA2OSA4OS4yOTQyQzE2MS4wNDIgODguMDY2NCAxNTkuODQgODYuOTU1NSAxNTguNDE0IDg1Ljk4NkwxNTkuMTU3IDg0Ljg5MjZDMTYwLjY4OCA4NS45MzMzIDE2MS45ODEgODcuMTI3NiAxNjMuMDg0IDg4LjQ0NTdMMTYyLjA2OSA4OS4yOTQyWiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTEzOS4zNCA4NC42MDIzQzE0MC45NTMgODMuODUzMiAxNDIuNTUyIDgzLjI3NjUgMTQ0LjE0MiA4Mi45MTUxTDE0My44NDggODEuNjI1OEMxNDIuMTUgODIuMDExOSAxNDAuNDYyIDgyLjYyMzMgMTM4Ljc4MyA4My40MDMxTDEzOS4zNCA4NC42MDIzWiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTE2Ni41ODkgOTguMTMyNkMxNjYuMDc0IDk2LjQ5MjIgMTY1LjQ3NiA5NC45MjcgMTY0Ljc1IDkzLjQ2MDJMMTY1LjkzNSA5Mi44NzM3QzE2Ni42OTkgOTQuNDE2MyAxNjcuMzIgOTYuMDQ4IDE2Ny44NSA5Ny43MzY0TDE2Ni41ODkgOTguMTMyNloiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGQ9Ik0xMzAuNTMxIDkwLjAyNDRDMTMxLjk3IDg4Ljk3MzQgMTMzLjM5NyA4Ny45ODY2IDEzNC44MTggODcuMDk0N0wxMzQuMTE0IDg1Ljk3NUMxMzIuNjYxIDg2Ljg4NzcgMTMxLjIwNyA4Ny44OTMxIDEyOS43NTEgODguOTU2N0wxMzAuNTMxIDkwLjAyNDRaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNNjcuNjM3OSA3NS41MzE5QzY3LjM3MjQgNzMuNzkyOSA2Ny4wODk5IDcyLjAyNDIgNjYuNzY3NCA3MC4yMzEzTDY4LjA2ODggNjkuOTk3M0M2OC4zOTQxIDcxLjgwNjMgNjguNjc4NiA3My41ODc3IDY4Ljk0NSA3NS4zMzIzTDY3LjYzNzkgNzUuNTMxOVoiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGQ9Ik0xNjcuODg1IDEwMy4wMzRDMTY4LjIzMSAxMDQuNTU1IDE2OC41NDggMTA2LjEwNyAxNjguODY5IDEwNy42NzdMMTY4Ljk0MiAxMDguMDM1TDE3MC4yMzggMTA3Ljc3TDE3MC4xNjMgMTA3LjQwNUwxNzAuMTYzIDEwNy40MDRMMTcwLjE2MiAxMDcuNDAzTDE3MC4xNjIgMTA3LjQwMUwxNzAuMTYyIDEwNy4zOTlDMTY5Ljg0MiAxMDUuODM1IDE2OS41MjMgMTA0LjI3MyAxNjkuMTc0IDEwMi43NEwxNjcuODg1IDEwMy4wMzRaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNMTIyLjI2NCA5Ni40MzgxTDEyMS40NDMgOTUuNDAxOEwxMjIuNTc2IDk0LjUwMzFDMTIzLjU3MyA5My43MTEgMTI0LjU2OSA5Mi45MjA1IDEyNS41NiA5Mi4xNDQ4TDEyNi4zNzUgOTMuMTg1N0MxMjUuMzkxIDkzLjk1NjMgMTI0LjQwNCA5NC43Mzk5IDEyMy40MSA5NS41Mjg3TDEyMy40MDUgOTUuNTMzMkwxMjIuMjY0IDk2LjQzODFaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNNjguNDM4MiA4MC44NjQzQzY4LjcxNzEgODIuNjkzIDY5LjAwNDMgODQuNDc4NSA2OS4zMjk2IDg2LjIwNzZMNzAuNjI5IDg1Ljk2MzFDNzAuMzA3OSA4NC4yNTYyIDcwLjAyMzQgODIuNDg4MSA2OS43NDUzIDgwLjY2NUw2OC40MzgyIDgwLjg2NDNaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNMTcxLjM3MyAxMTguMDYzQzE3MC44NTIgMTE2LjQxOCAxNzAuNDE1IDExNC43NDQgMTcwLjAyMyAxMTMuMDY2TDE3MS4zMSAxMTIuNzY1QzE3MS42OTcgMTE0LjQyMiAxNzIuMTI2IDExNi4wNjEgMTcyLjYzNCAxMTcuNjY0TDE3MS4zNzMgMTE4LjA2M1oiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGQ9Ik0xMTMuODYgMTAyLjc4NEMxMTUuMjk0IDEwMS43OSAxMTYuNzE0IDEwMC43NDQgMTE4LjExOSA5OS42NzI5TDExNy4zMTggOTguNjIxMkMxMTUuOTIzIDk5LjY4NCAxMTQuNTIgMTAwLjcxOCAxMTMuMTA3IDEwMS42OTdMMTEzLjg2IDEwMi43ODRaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNNzIuMzQ4NyA5Ni42OTA1QzcxLjYyMDYgOTUuMDU2NCA3MS4wMjk3IDkzLjMyNDcgNzAuNTMwNyA5MS41MTMyTDcxLjgwNTQgOTEuMTYyQzcyLjI5MTEgOTIuOTI1IDcyLjg2MTEgOTQuNTkxOCA3My41NTY1IDk2LjE1MjNMNzIuMzQ4NyA5Ni42OTA1WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTEwNC42OCAxMDguMDc1QzEwNi4yNzggMTA3LjM3NSAxMDcuODUzIDEwNi41NTQgMTA5LjQwNyAxMDUuNjQ0TDEwOC43MzggMTA0LjUwM0MxMDcuMjIxIDEwNS4zOTIgMTA1LjY5MiAxMDYuMTg5IDEwNC4xNSAxMDYuODY0TDEwNC42OCAxMDguMDc1WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTE3NS44NTUgMTI3LjQ2M0MxNzQuODMyIDEyNi4wMTYgMTczLjk3NSAxMjQuNDk1IDE3My4yNDIgMTIyLjkyNEwxNzQuNDQgMTIyLjM2NUMxNzUuMTQ0IDEyMy44NzQgMTc1Ljk2MyAxMjUuMzI2IDE3Ni45MzQgMTI2LjY5OUwxNzUuODU1IDEyNy40NjNaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNNzUuMTI4MiAxMDEuNDY3Qzc2LjIxODcgMTAyLjkxNCA3Ny41MDA3IDEwNC4yMzUgNzkuMDIwMyAxMDUuNDE1TDc5LjgzMTEgMTA0LjM3Qzc4LjQwNjcgMTAzLjI2NSA3Ny4yMDY0IDEwMi4wMjcgNzYuMTg0IDEwMC42NzFMNzUuMTI4MiAxMDEuNDY3WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTk5LjYyMjcgMTA5LjgyNEM5Ny44NzcxIDExMC4yNTkgOTYuMTAyNiAxMTAuNTE4IDk0LjI5OCAxMTAuNTYxTDk0LjI2NjYgMTA5LjIzOUM5NS45NjQ2IDEwOS4xOTkgOTcuNjQyMiAxMDguOTU1IDk5LjMwMzEgMTA4LjU0MUw5OS42MjI3IDEwOS44MjRaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNODMuNzY5MiAxMDguMjU4Qzg0LjU3ODIgMTA4LjYyOCA4NS40MzI0IDEwOC45NzEgODYuMzM0NyAxMDkuMjg3Qzg3LjIwNTUgMTA5LjU5MiA4OC4wNzEgMTA5LjgzOSA4OC45MzEyIDExMC4wMzFMODkuMjIwMyAxMDguNzQxQzg4LjQxMDggMTA4LjU2IDg3LjU5NDYgMTA4LjMyNyA4Ni43NzE1IDEwOC4wMzlDODUuOTA1NCAxMDcuNzM2IDg1LjA4OSAxMDcuNDA4IDg0LjMxODcgMTA3LjA1Nkw4My43NjkyIDEwOC4yNThaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNMTE3LjgwNSAxMjAuNjU5TDExNC4zNzYgMTI0LjA4OEwxMTcuNjQ5IDEyNy4zNkwxMTYuNzE0IDEyOC4yOTVMMTEzLjQ0MSAxMjUuMDIzTDExMC4xNjkgMTI4LjI5NUwxMDkuMjM0IDEyNy4zNkwxMTIuNTA3IDEyNC4wODhMMTA5LjA3OCAxMjAuNjU5TDExMC4wMTMgMTE5LjcyNEwxMTMuNDQxIDEyMy4xNTNMMTE2Ljg3IDExOS43MjRMMTE3LjgwNSAxMjAuNjU5WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZD0iTTEzNy45NDYgNjQuNDY0TDE0MC43NTEgNjcuMjY4OUwxMzcuOTQ2IDcwLjA3MzdMMTM4Ljg4MSA3MS4wMDg3TDE0MS42ODYgNjguMjAzOEwxNDQuNDkxIDcxLjAwODdMMTQ1LjQyNiA3MC4wNzM3TDE0Mi42MjEgNjcuMjY4OUwxNDUuNDI2IDY0LjQ2NEwxNDQuNDkxIDYzLjUyOTFMMTQxLjY4NiA2Ni4zMzM5TDEzOC44ODEgNjMuNTI5MUwxMzcuOTQ2IDY0LjQ2NFoiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGQ9Ik0xMi4wNzggNzMuNjU5MkwxNS41NzcyIDc3LjE1ODRMMTIuMDc4IDgwLjY1NzZMMTMuMDEyOSA4MS41OTI1TDE2LjUxMjEgNzguMDkzM0wyMC4wMTEzIDgxLjU5MjVMMjAuOTQ2MyA4MC42NTc2TDE3LjQ0NzEgNzcuMTU4NEwyMC45NDYzIDczLjY1OTJMMjAuMDExMyA3Mi43MjQzTDE2LjUxMjEgNzYuMjIzNEwxMy4wMTI5IDcyLjcyNDNMMTIuMDc4IDczLjY1OTJaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBkPSJNNzcuMjM4MyAzMi44MTk1TDczLjA3OCAyOC42NTkyTDc0LjAxMjkgMjcuNzI0M0w3OC4xNzMyIDMxLjg4NDZMODIuMzMzNSAyNy43MjQzTDgzLjI2ODUgMjguNjU5Mkw3OS4xMDgyIDMyLjgxOTVMODMuMjY4NSAzNi45Nzk4TDgyLjMzMzUgMzcuOTE0OEw3OC4xNzMyIDMzLjc1NDVMNzQuMDEyOSAzNy45MTQ4TDczLjA3OCAzNi45Nzk4TDc3LjIzODMgMzIuODE5NVoiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNODUuMDc4MSA3OS43MjQzVjkxLjYyNDNMOTYuOTc4MSA5MS42MjQzVjc5LjcyNDNIODUuMDc4MVpNOTUuNjU1OCA4MS4wNDY1SDg2LjQwMDNWOTAuMzAySDk1LjY1NThWODEuMDQ2NVoiIGZpbGw9IiNDNUM1QzUiLz4NCjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTguMDc4MSAzOC43MjQzVjQ3Ljk3OThIMjcuMzMzNlYzOC43MjQzTDE4LjA3ODEgMzguNzI0M1pNMjYuMDExNCA0MC4wNDY1SDE5LjQwMDNWNDYuNjU3NkgyNi4wMTE0VjQwLjA0NjVaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQ1LjUzMzEgNzUuNTg5NUM0OC4wODg5IDc1LjU4OTUgNTAuMTYwOCA3My41MTc2IDUwLjE2MDggNzAuOTYxN0M1MC4xNjA4IDY4LjQwNTkgNDguMDg4OSA2Ni4zMzM5IDQ1LjUzMzEgNjYuMzMzOUM0Mi45NzcyIDY2LjMzMzkgNDAuOTA1MyA2OC40MDU5IDQwLjkwNTMgNzAuOTYxN0M0MC45MDUzIDczLjUxNzYgNDIuOTc3MiA3NS41ODk1IDQ1LjUzMzEgNzUuNTg5NVpNNDUuNTMzMSA3NC4yNjczQzQ3LjM1ODcgNzQuMjY3MyA0OC44Mzg2IDcyLjc4NzMgNDguODM4NiA3MC45NjE3QzQ4LjgzODYgNjkuMTM2MSA0Ny4zNTg3IDY3LjY1NjEgNDUuNTMzMSA2Ny42NTYyQzQzLjcwNzUgNjcuNjU2MSA0Mi4yMjc1IDY5LjEzNjEgNDIuMjI3NSA3MC45NjE3QzQyLjIyNzUgNzIuNzg3MyA0My43MDc0IDc0LjI2NzMgNDUuNTMzMSA3NC4yNjczWiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00Mi43MTE0IDk4LjE1NDdWMTA3LjQxSDUxLjk2N1Y5OC4xNTQ3SDQyLjcxMTRaTTUwLjY0NDggOTkuNDc2OUg0NC4wMzM3VjEwNi4wODhINTAuNjQ0OFY5OS40NzY5WiIgZmlsbD0iI0M1QzVDNSIvPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMjQuOTQ2IDU0LjUyOTFDMTI0Ljk0NiA2NC40NzAyIDExNi44ODggNzIuNTI5MSAxMDYuOTQ2IDcyLjUyOTFDOTcuMDA1MyA3Mi41MjkxIDg4Ljk0NjQgNjQuNDcwMiA4OC45NDY0IDU0LjUyOTFDODguOTQ2NCA0NC41ODc5IDk3LjAwNTMgMzYuNTI5MSAxMDYuOTQ2IDM2LjUyOTFDMTE2Ljg4OCAzNi41MjkxIDEyNC45NDYgNDQuNTg3OSAxMjQuOTQ2IDU0LjUyOTFaTTEyMy43NDYgNTQuNTI5MUMxMjMuNzQ2IDYzLjgwNzQgMTE2LjIyNSA3MS4zMjkxIDEwNi45NDYgNzEuMzI5MUM5Ny42NjggNzEuMzI5MSA5MC4xNDY0IDYzLjgwNzQgOTAuMTQ2NCA1NC41MjkxQzkwLjE0NjQgNDUuMjUwNyA5Ny42NjggMzcuNzI5MSAxMDYuOTQ2IDM3LjcyOTFDMTE2LjIyNSAzNy43MjkxIDEyMy43NDYgNDUuMjUwNyAxMjMuNzQ2IDU0LjUyOTFaIiBmaWxsPSIjQzVDNUM1Ii8+DQo8L3N2Zz4NCg=="},91340:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M20.889 1.333h6.222a3.556 3.556 0 0 1 3.556 3.556v6.222a3.556 3.556 0 0 1-3.556 3.556h-6.222a3.556 3.556 0 0 1-3.556-3.556V4.889a3.556 3.556 0 0 1 3.556-3.556M20 4v8h8V4zM4.889 17.333h6.222a3.556 3.556 0 0 1 3.556 3.556v6.222a3.556 3.556 0 0 1-3.556 3.556H4.889a3.556 3.556 0 0 1-3.556-3.556v-6.222a3.556 3.556 0 0 1 3.556-3.556M4 20v8h8v-8zm20 8a4 4 0 1 0 0-8 4 4 0 0 0 0 8m0 2.667a6.667 6.667 0 1 1 0-13.334 6.667 6.667 0 0 1 0 13.334M4.981 12h6.037L7.999 5.963zm4.212-9.615 5.176 10.352a1.334 1.334 0 0 1-1.192 1.93H2.825a1.333 1.333 0 0 1-1.192-1.929L6.809 2.386a1.332 1.332 0 0 1 2.385 0z"></path></svg>'},97984:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#000" fill-rule="nonzero" d="m14.376 10.573 1.647.927-8 4.5-8-4.5 1.648-.927 1.02.574-.628.353 5.96 3.353 5.96-3.353-.627-.353zm-.999-2.414.606.341-5.96 3.353L2.063 8.5l.607-.341-1.02-.574L.023 8.5l8 4.5 8-4.5-1.626-.915zM8.023 1.023l-8 4.5 8 4.5 8-4.5zm-5.96 4.5 5.96-3.352 5.96 3.352-5.96 3.353z"></path></svg>'}},t={};function r(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{"use strict";r.r(c),r.d(c,{DrawingElevationMode3D:()=>st,JimuDraw:()=>Ji,JimuDrawCreationMode:()=>at,JimuMap:()=>K,JimuSymbolType:()=>Ae,MapStatesEditor:()=>X,MapThumb:()=>m,SnappingMode:()=>nt,SymbolList:()=>Ee,SymbolSelector:()=>Be,useMeasurementsUnitsInfos:()=>pt});var e={};r.r(e),r.d(e,{Draw:()=>s,JimuMap:()=>o,SymbolSelector:()=>a});var t=r(1888),i=r(79244);const o=e=>i.css`

    position: relative;

    .map-is-live-mode {
      .is-widget {
        pointer-events: auto !important;
      }
    }

    .widget-map-usemask {
      pointer-events: auto !important;
    }

    .map-is-design-mode {
      .exbmap-ui,
      .exbmap-ui-tool {
        pointer-events: none !important;
      }

      .is-widget {
        pointer-events: auto !important;
      }
    }

    .widget-map{
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
      z-index: -1;
      .overview-container{
        position: absolute;
        top: 12px;
        right: 12px;
        width: 300px;
        height: 200px;
        border: 1px solid black;
        z-index: 1;
      }

      .extent-container{
        background-color: rgba(0, 0, 0, 0.5);
        position: absolute;
        z-index: 2;
      }

      .extent-btn-container{
        button{
          outline: none;
        }
        .previous-extent-btn{
          color: #111;
        }
        .next-extent-btn{
          color: #222;
        }
      }
    }

    .exbmap-ui-layout{
      z-index: 0;
    }

    .mapswitch-container {
      position: absolute;
      z-index: 7;
      width: 32px;
      height: 32px;
      bottom: 10px;
      left: 10px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3)
    }

    .mapswitch-icon {
      fill: black;
      left: 8px;
      top: 8px;
      position: absolute;
      display: block;
    }

    .widget-map-background {
      background-color: white;
      position: absolute;
      z-index: 1;
    }

    @keyframes appear {
      0%{opacity:0}
      25%{opacity:.25}
      50%{opacity:.5;}
      75%{opacity:.75}
      100%{opacity:1;}
    }

    @keyframes disappear {
      0%{opacity:1}
      25%{opacity:.75}
      50%{opacity:.5;}
      75%{opacity:.25}
      100%{opacity:0;}
    }

    .multisourcemap-item-appear {
      animation: appear 300ms;
      -webkit-animation: appear 300ms;
      -moz-animation: appear 300ms;
      animation-fill-mode: forwards;
      -webkit-animation-fill-mode: forwards;
      -moz-animation-fill-mode: forwards;
      animation-timing-function: ease-in;
      -webkit-animation-timing-function: ease-in;
      -moz-animation-timing-function: ease-in;
    }

    .multisourcemap-item-disappear {
      animation: disappear 300ms;
      -webkit-animation: disappear 300ms;
      -moz-animation: disappear 300ms;
      animation-fill-mode: forwards;
      -webkit-animation-fill-mode: forwards;
      -moz-animation-fill-mode: forwards;
      animation-timing-function: ease-in;
      -webkit-animation-timing-function: ease-in;
      -moz-animation-timing-function: ease-in;
    }

    .multisourcemap-item-appear-noanimate {
      opacity: 1;
    }

    .multisourcemap-item-disappear-noanimate {
      opacity: 0;
    }

    .exbmap-ui-tool-shell {
      pointer-events: auto;
    }
  `,s=e=>{const t=e.theme;return i.css`
    .jimu-draw-loader {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      width: 100%;
      animation: esri-fade-in 500ms ease-in-out;
    }

    .jimu-draw-loader:before {
      background-color: rgba(110,110,110,0.3);
      width: 100%;
      z-index: 0;
      content: "";
      opacity: 1;
      position: absolute;
      height: 2px;
      top: 0;
      transition: opacity 500ms ease-in-out;
    }

    .jimu-draw-loader:after {
      background-color: ${t.sys.color.primary.main};
      width: 20%;
      z-index: 0;
      animation: looping-progresss-bar-ani 1500ms linear infinite;
      content: "";
      opacity: 1;
      position: absolute;
      height: 2px;
      top: 0;
      transition: opacity 500ms ease-in-out;
    }
  `},a=e=>i.css`
    &.jimu-symbol-selector {
      .symbol-selector-preview-btn {
        min-width: 16px;
        min-height: 16px;
      }
    }
  `;var n=r(67386),l=r(53089),d=r.n(l),p=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i};const u=e=>{const t=window.SVG,{className:o}=e,s=p(e,["className"]),a=(0,i.classNames)("jimu-icon jimu-icon-component",o);return t?(0,n.jsx)(t,Object.assign({className:a,src:d()},s)):(0,n.jsx)("svg",Object.assign({className:a},s))};class h extends i.React.PureComponent{constructor(e){super(e),this.unmount=!1,this.state={mapThumbCache:{}}}componentDidMount(){this.unmount=!1,this.requestThumbUrlByProps()}componentDidUpdate(e,t){e.mapItemId!==this.props.mapItemId&&this.requestThumbUrlByProps()}getMapThumbKey(e,t){return`${e||"empty"}-${t||"empty"}`}addMapThumbUrlToCache(e,t,i){if(this.unmount)return;if(!i&&this.state.mapThumbCache[e])return;const o=Object.assign(Object.assign({},this.state.mapThumbCache),{[e]:t});this.setState({mapThumbCache:o})}requestThumbUrlByProps(){const e=this.props.portUrl,t=this.props.mapItemId,o=this.getMapThumbKey(e,t);if(!(o in this.state.mapThumbCache))if(t||this.addMapThumbUrlToCache(o,null),e&&e!==(0,i.getAppStore)().getState().portalUrl)i.esri.restPortal.searchItems({q:`id:${t}`,portal:e+"/sharing/rest"}).then(e=>{if(!this.unmount)if(e.results[0]){const t=`${this.props.portUrl}/sharing/rest/content/items/${e.results[0].id}/info/${e.results[0].thumbnail}`;this.addMapThumbUrlToCache(o,t);const i=document.createElement("img");i.onerror=()=>{this.addMapThumbUrlToCache(o,null,!0)},i.src=t}else this.addMapThumbUrlToCache(o,null)});else{const e=(0,i.getAppStore)().getState().portalUrl;i.esri.restPortal.searchItems({q:`id:${t}`,authentication:i.SessionManager.getInstance().getMainSession(),portal:e+"/sharing/rest"}).then(t=>{var s;if(!this.unmount)if(null===(s=t.results[0])||void 0===s?void 0:s.thumbnail){const s=i.SessionManager.getInstance().getSessionByUrl(e);let a=null;a=s&&(null==s?void 0:s.token)?`${e}/sharing/rest/content/items/${t.results[0].id}/info/${t.results[0].thumbnail}?token=${null==s?void 0:s.token}`:`${e}/sharing/rest/content/items/${t.results[0].id}/info/${t.results[0].thumbnail}`;const n=document.createElement("img");n.onerror=()=>{this.addMapThumbUrlToCache(o,null,!0)},n.src=a,this.addMapThumbUrlToCache(o,a)}else this.addMapThumbUrlToCache(o,null)})}}componentWillUnmount(){this.unmount=!0}render(){var e,t,i,o,s,a,l,r,c,d,p,h,m,g;const y=this.getMapThumbKey(this.props.portUrl,this.props.mapItemId),S=this.state.mapThumbCache[y];if(S)return(0,n.jsx)("img",{className:"w-100 h-100",src:S,style:{display:"block",objectFit:"cover",objectPosition:"50% 50%"}});{const y=null===(e=this.props)||void 0===e?void 0:e.theme;let S=null===(o=null===(i=null===(t=null==y?void 0:y.sys)||void 0===t?void 0:t.color)||void 0===i?void 0:i.surface)||void 0===o?void 0:o.overlay,M=null===(l=null===(a=null===(s=null==y?void 0:y.sys)||void 0===s?void 0:s.color)||void 0===a?void 0:a.surface)||void 0===l?void 0:l.overlayHint;return(null===(r=this.props)||void 0===r?void 0:r.usedInSetting)&&(S=null===(p=null===(d=null===(c=null==y?void 0:y.ref)||void 0===c?void 0:c.palette)||void 0===d?void 0:d.neutral)||void 0===p?void 0:p[300],M=null===(g=null===(m=null===(h=null==y?void 0:y.ref)||void 0===h?void 0:h.palette)||void 0===m?void 0:m.neutral)||void 0===g?void 0:g[600]),(0,n.jsx)("div",{style:{backgroundColor:S,height:"100%"},children:(0,n.jsx)(u,{color:M,size:"100%"})})}}}const m=(0,t.withTheme)((0,i.injectIntl)(h));var g=r(14321),y=r(62686);class S extends i.React.PureComponent{}class M extends i.React.PureComponent{constructor(){super(...arguments),this.moveY=0,this.startY=0,this.isRegisted=!1,this.registerTouchEvent=e=>{e&&!this.isRegisted&&(e.addEventListener("touchstart",e=>{this.moveY=0;const t=e.touches[0];this.startY=t.clientY},{passive:!1}),e.addEventListener("touchmove",t=>{const i=t.touches[0];this.moveY=-1*(i.clientY-this.startY),this.startY=i.clientY,e.scrollTop=e.scrollTop+this.moveY},{passive:!1}),e.addEventListener("touchend",e=>{this.moveY=0,this.startY=0},{passive:!1}),this.isRegisted=!0)}}getStyle(){return i.css`
      overflow: auto;
      pointer-events: auto;
      `}render(){return(0,n.jsx)("div",{css:this.getStyle(),className:this.props.className,style:this.props.style,ref:e=>{this.registerTouchEvent(e)},children:this.props.children})}}class f extends i.React.PureComponent{componentWillUnmount(){this.props.onDestroyed&&this.props.onDestroyed()}render(){return(0,n.jsx)(n.Fragment,{children:this.props.children})}}const b=r(91340),w=r(24769);class v extends S{constructor(e){super(e),this.toolName=null,this.isContainedToMobilePanel=!1,this.generation=0,this.exbMapUiRef=i.React.createRef(),this._getContent=()=>this.props.toolJson.isOnlyExpanded?(0,n.jsx)("div",{className:"exbmap-ui exbmap-ui-tool-panel",children:(0,n.jsx)(i.ErrorBoundary,{children:this.getExpandPanel()})}):this.props.isMobile?this._renderMobileTool():this._renderPCTool(),this.onResize=({width:e,height:t})=>{e&&t&&(this.generation=t,this.forceUpdate())};const t=this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.container;g.MobilePanelManager.getInstance().checkDomIsContained(t)&&(this.isContainedToMobilePanel=!0),this.shiftOptions={padding:15,boundary:t},this.flipOptions={padding:0},this._onKeyDown=this._onKeyDown.bind(this),this.onPopperToggle=this.onPopperToggle.bind(this)}focusDefaultElement(){}onShowPanel(){}onClosePanel(){}destroy(){}static getIsNeedSetting(){return!0}static isAvailable(e){return!0}onPopperToggle(e){e&&"keydown"===e.type&&"Escape"===e.key&&(this._onIconClick(),(0,i.focusElementInKeyboardMode)(this.iconContainer))}_onKeyDown(e){"Enter"!==e.key&&" "!==e.key||(this.props.activeToolName!==this.toolName?this._onIconClick():this.focusDefaultElement())}_onIconClick(e){const t=this.getIcon()&&this.getIcon().onIconClick;t&&t(e),this.getExpandPanel()&&(this.isContainedToMobilePanel,this.props.activeToolName&&this.props.activeToolName===this.toolName?this.props.onActiveToolNameChange(null):(this.props.onActiveToolNameChange(this.toolName),this.onShowPanel()))}_initIconContainer(e){e&&!this.iconContainer&&(this.iconContainer=e,this.forceUpdate())}_renderPCTool(){let e=this.getIcon();e||(e={icon:b,onIconClick:()=>null});const t=this.getExpandPanel();return(0,n.jsxs)("div",{className:"exbmap-ui exbmap-ui-tool",children:[(0,n.jsx)("div",{style:{},ref:e=>{this._initIconContainer(e)},className:(0,i.classNames)("exbmap-ui-tool esri-widget--button-like",{selected:this.toolName===this.props.activeToolName&&t}),title:this.props.toolJson.isShowIconTitle?this.getTitle():"",onClick:e=>{this._onIconClick(e)},"aria-expanded":this.props.activeToolName===this.toolName,role:"button",tabIndex:0,onKeyDown:this._onKeyDown,children:(0,n.jsx)(g.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:e.icon})}),this.iconContainer&&this.toolName===this.props.activeToolName&&t&&(0,n.jsx)(f,{onDestroyed:()=>{this.onClosePanel()},children:(0,n.jsx)(g.Popper,{className:"exbmap-ui-popper",reference:this.iconContainer,open:!(this.toolName!==this.props.activeToolName||!t),placement:this.props.toolJson.panelPlacement,shiftOptions:this.shiftOptions,flipOptions:this.flipOptions,version:this.generation,toggle:this.onPopperToggle,disablePortal:!0,forceLatestFocusElements:!0,children:(0,n.jsx)("div",{className:this.getExpandPanelPlacementClassName(),children:(0,n.jsxs)("div",{className:"exbmap-ui-expand-content",ref:this.exbMapUiRef,children:[(0,n.jsxs)("div",{className:"w-100 justify-content-between d-flex exbmap-ui-expand-content-header",children:[(0,n.jsx)("div",{className:"panel-title text-truncate",style:{maxWidth:"210px"},title:this.getTitle(),children:this.getTitle()}),(0,n.jsx)("div",{onClick:()=>{this.props.onActiveToolNameChange(null)},role:"button",tabIndex:0,"aria-label":this.props.intl.formatMessage({id:"close",defaultMessage:"close"}),children:(0,n.jsx)(g.Icon,{className:"panel-icon",width:20,height:20,icon:w})})]}),(0,n.jsx)(i.ErrorBoundary,{children:t}),(0,n.jsx)(i.ReactResizeDetector,{targetRef:this.exbMapUiRef,handleHeight:!0,onResize:this.onResize})]})})})})]})}_renderMobileTool(){let e=this.getIcon();e||(e={icon:b,onIconClick:()=>null});const t=this.getExpandPanel();return(0,n.jsxs)("div",{className:"exbmap-ui exbmap-ui-tool",children:[(0,n.jsx)("div",{style:{},ref:e=>{this.iconContainer=e},className:(0,i.classNames)("exbmap-ui-tool border-0 esri-widget--button-like",{selected:this.toolName===this.props.activeToolName&&t}),title:this.props.toolJson.isShowIconTitle?this.getTitle():"",onClick:e=>{this._onIconClick(e)},children:(0,n.jsx)(g.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:e.icon})}),this.toolName===this.props.activeToolName&&t&&i.ReactDOM.createPortal((0,n.jsx)(f,{onDestroyed:()=>{this.onClosePanel()},children:(0,n.jsxs)("div",{className:"w-100 h-100 d-flex flex-column",children:[(0,n.jsxs)("div",{className:"w-100 justify-content-between d-flex exbmap-ui-expand-content-header",style:{padding:"10px",fontWeight:"bold"},children:[(0,n.jsx)("div",{className:"panel-title text-truncate w-100",title:this.getTitle(),children:this.getTitle()}),(0,n.jsx)("div",{style:{zIndex:1,pointerEvents:"auto",width:"40px",height:"30px"},onClick:()=>{this.props.onActiveToolNameChange(null)},className:"d-flex justify-content-end align-items-start",children:(0,n.jsx)(g.Icon,{className:"panel-icon",width:20,height:20,icon:w,color:"#6e6e6e"})})]}),(0,n.jsx)("div",{className:"flex-grow-1 w-100",style:{position:"relative"},children:(0,n.jsx)(M,{className:"w-100 h-100",style:{position:"absolute",paddingLeft:"10px",paddingRight:"10px"},children:(0,n.jsx)(i.ErrorBoundary,{children:this.getExpandPanel()})})})]})}),document.getElementById(`${this.props.jimuMapView.id}-bottom-panel`))]})}getExpandPanelPlacementClassName(){return this.props.toolJson.panelPlacement?`expand-placement-${this.props.toolJson.panelPlacement.split("-")[0]}`:null}render(){return this._getContent()}}class x extends i.React.PureComponent{constructor(e){super(e),this.state={}}onRef(e){e&&(this.container=e,this.tryUpdateZoomElement())}componentDidUpdate(){this.tryUpdateZoomElement()}tryUpdateZoomElement(){if(!this.container)return;const e=this.props.jimuMapView,t=(null==e?void 0:e.view)||null;this.zoomElement&&(this.zoomElement.view===t&&this.zoomElement.parentNode===this.container||this.destroyZoomElement()),!this.zoomElement&&this.props.mapComponentsLoaded&&this.container&&t&&(this.zoomElement=document.createElement("arcgis-zoom"),this.zoomElement.view=t,this.container.appendChild(this.zoomElement))}destroyZoomElement(){this.zoomElement&&(this.zoomElement.destroy(),this.zoomElement=null)}componentWillUnmount(){this.destroyZoomElement()}getStyle(){return i.css`
      .esri-widget--button {
        appearance: none !important;
      }

      arcgis-zoom {
        box-shadow: none;

        div.arcgis-zoom {
          box-shadow: none;
        }

        calcite-button {
          border: none;
        }
      }
    `}render(){return(0,n.jsx)("div",{className:"zoom-map-tool",css:this.getStyle(),ref:e=>{this.onRef(e)}})}}const N=i.React.createContext({isShowMapSwitchBtn:!1,dataSourceIds:[],activeDataSourceId:null,switchMap:()=>null,fullScreenMap:()=>null,initialMapState:null,mapComponentId:null});class C extends i.React.PureComponent{constructor(e){super(e),this.generateViewPointFromInitialMapState=e=>"2d"===e.viewType?new this.Viewpoint({targetGeometry:this.Extent.fromJSON(e.extent),rotation:e.rotation}):this.Viewpoint.fromJSON(e.viewPoint),this.state={apiLoaded:!1}}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/geometry/Extent","esri/Viewpoint"]).then(e=>{[this.Extent,this.Viewpoint]=e,this.setState({apiLoaded:!0})})}componentDidUpdate(e){var t;const i=this.props.mapComponentsLoaded&&this.state.apiLoaded;if(!i||!this.container)return;const o=(null===(t=this.props.jimuMapView)||void 0===t?void 0:t.view)||null,s=((null==e?void 0:e.initialMapState)||null)!==(this.props.initialMapState||null);if(this.homeElement&&(this.homeElement.view!==o||this.homeElement.parentNode!==this.container||s)&&this.destroyHomeElement(),!this.homeElement&&this.props.mapComponentsLoaded&&i&&this.container&&o){let e=this.props.initialMapState?this.generateViewPointFromInitialMapState(this.props.initialMapState):this.props.jimuMapView.view.map.initialViewProperties.viewpoint;e&&(e=e.clone()),this.homeElement=document.createElement("arcgis-home"),this.homeElement.view=this.props.jimuMapView.view,this.homeElement.viewpoint=e,this.container.appendChild(this.homeElement)}if(s&&o&&this.homeElement){const e=this.homeElement.viewpoint;e&&o.goTo(e,{animate:!1})}}destroyHomeElement(){this.homeElement&&(this.homeElement.destroy(),this.homeElement=null)}componentWillUnmount(){this.destroyHomeElement()}getStyle(){return i.css`
      .esri-widget--button {
        appearance: none !important;
      }
    `}render(){return(0,n.jsx)("div",{className:"home-map-tool",css:this.getStyle(),ref:e=>{this.container||(this.container=e)}})}}class I extends i.React.PureComponent{constructor(e){super(e),this.state={}}onRef(e){e&&(this.container=e,this.tryUpdateCompassElement())}componentDidUpdate(){this.tryUpdateCompassElement()}tryUpdateCompassElement(){if(!this.container)return;const e=this.props.jimuMapView,t=(null==e?void 0:e.view)||null;this.compassElement&&(this.compassElement.view===t&&this.compassElement.parentNode===this.container||this.destroyCompassElement()),!this.compassElement&&this.props.mapComponentsLoaded&&this.container&&t&&(this.compassElement=document.createElement("arcgis-compass"),this.compassElement.view=t,this.container.appendChild(this.compassElement))}destroyCompassElement(){if(this.compassElement){const e=this.compassElement.view;e&&!e.destroyed?this.compassElement.destroy():this.compassElement.parentNode&&this.compassElement.parentNode.removeChild(this.compassElement),this.compassElement=null}}componentWillUnmount(){this.destroyCompassElement()}render(){return(0,n.jsx)("div",{className:"compass-map-tool",ref:e=>{this.onRef(e)}})}}class j extends i.React.PureComponent{constructor(e){super(e),this.state={}}onRef(e){e&&(this.container=e,this.tryUpdateNavigationToggleElement())}componentDidUpdate(){this.tryUpdateNavigationToggleElement()}tryUpdateNavigationToggleElement(){if(!this.container)return;const e=this.props.jimuMapView,t=(null==e?void 0:e.view)||null;this.navigationToggleElement&&(this.navigationToggleElement.view===t&&this.navigationToggleElement.parentNode===this.container||this.destroyNavigationToggleElement()),!this.navigationToggleElement&&this.props.mapComponentsLoaded&&this.container&&t&&"3d"===t.type&&(this.navigationToggleElement=document.createElement("arcgis-navigation-toggle"),this.navigationToggleElement.view=t,this.container.appendChild(this.navigationToggleElement))}destroyNavigationToggleElement(){var e,t;if(this.navigationToggleElement){if("function"==typeof this.navigationToggleElement.destroy)null===(t=(e=this.navigationToggleElement).destroy)||void 0===t||t.call(e);else{const e=this.navigationToggleElement.parentNode;e&&e.removeChild(this.navigationToggleElement)}this.navigationToggleElement=null}}componentWillUnmount(){this.destroyNavigationToggleElement()}render(){return(0,n.jsx)("div",{className:"navigation-map-tool",ref:e=>{this.onRef(e)}})}}class L extends i.React.PureComponent{constructor(e){super(e),this.state={apiLoaded:!1}}getStyle(){const e=this.props.isMobile?"height: 32px;":"height: 48px; padding: 0px 16px 16px 16px;";return i.css`
      arcgis-search {
        /* Use height and overflow to avoid arcgis-search flickering during initialization */
        ${e}
        width: 100%;
      }
    `}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/portal/Portal"]).then(e=>{[this.Portal]=e,this.setState({apiLoaded:!0})})}onRef(e){e&&(this.container=e,this.tryUpdateSearchElement())}componentDidUpdate(){this.tryUpdateSearchElement()}tryUpdateSearchElement(){if(!this.container)return;const e=this.props.jimuMapView,t=(null==e?void 0:e.view)||null;this.searchElement&&(this.searchElement.view===t&&this.searchElement.parentNode===this.container||this.destroySearchElement()),!this.searchElement&&this.props.mapComponentsLoaded&&this.state.apiLoaded&&this.container&&t&&(this.searchElement=document.createElement("arcgis-search"),this.searchElement.view=t,this.searchElement.portal=new this.Portal({url:(0,i.getAppStore)().getState().portalUrl}),this.searchElement.position="manual",this.container.appendChild(this.searchElement))}destroySearchElement(){this.searchElement&&(this.searchElement.destroy(),this.searchElement=null)}componentWillUnmount(){this.destroySearchElement()}render(){const e=this.props.mapComponentsLoaded&&this.state.apiLoaded;return(0,n.jsx)("div",{css:this.getStyle(),className:"w-100 search-map-tool",ref:e=>{this.onRef(e)},children:!e&&(0,n.jsx)("div",{className:"exbmap-basetool-loader"})})}}class D extends i.React.PureComponent{constructor(e){super(e),this.state={}}onRef(e){e&&(this.container=e,this.tryUpdateLayerListElement())}componentDidUpdate(){this.tryUpdateLayerListElement()}tryUpdateLayerListElement(){if(!this.container)return;const e=this.props.jimuMapView,t=(null==e?void 0:e.view)||null;this.props.mapComponentsLoaded&&this.container&&t?(this.layerListElement&&this.layerListElement.parentNode!==this.container&&this.destroyLayerListElement(),this.layerListElement?this.layerListElement.view!==t&&(this.layerListElement.view=t):(this.layerListElement=document.createElement("arcgis-layer-list"),this.layerListElement.view=t,this.container.appendChild(this.layerListElement))):this.destroyLayerListElement()}destroyLayerListElement(){this.layerListElement&&(this.layerListElement.destroy(),this.layerListElement=null)}componentWillUnmount(){this.destroyLayerListElement()}getStyle(){return i.css`
      width: 100%;
      min-height: 32px;
      position: relative;

      arcgis-layer-list {
        width: 100%;
      }
    `}render(){return(0,n.jsx)("div",{className:"layers-map-tool",ref:e=>{this.onRef(e)},css:this.getStyle()})}}class T extends i.React.PureComponent{constructor(e){super(e),this.state={apiLoaded:!1}}onRef(e){e&&(this.container=e,this.tryUpdateLegendElement())}componentDidUpdate(){this.tryUpdateLegendElement()}tryUpdateLegendElement(){if(!this.container)return;const e=this.props.jimuMapView,t=(null==e?void 0:e.view)||null;this.props.mapComponentsLoaded&&this.container&&t?(this.legendElement&&this.legendElement.parentNode!==this.container&&this.destroyLegendElement(),this.legendElement?this.legendElement.view!==t&&(this.legendElement.view=t):(this.legendElement=document.createElement("arcgis-legend"),this.legendElement.view=t,this.container.appendChild(this.legendElement))):this.destroyLegendElement()}destroyLegendElement(){this.legendElement&&(this.legendElement.destroy(),this.legendElement=null)}componentWillUnmount(){this.destroyLegendElement()}getStyle(){return i.css`
      width: 100%;
      min-height: 32px;
      position: relative;

      arcgis-legend {
        width: 100%;
      }
    `}render(){return(0,n.jsx)("div",{className:"legend-map-tool",ref:e=>{this.onRef(e)},css:this.getStyle()})}}const O={Zoom:class extends v{constructor(){super(...arguments),this.toolName="Zoom"}getTitle(){return this.props.intl.formatMessage({id:"ZoomLabel",defaultMessage:g.defaultMessages.ZoomLabel})}getIcon(){return null}getExpandPanel(){return(0,n.jsx)(x,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded})}},Home:class extends v{constructor(){super(...arguments),this.toolName="Home",this.getHomeContent=e=>(0,n.jsx)(C,{jimuMapView:this.props.jimuMapView,initialMapState:e,mapComponentsLoaded:this.props.mapComponentsLoaded})}getTitle(){return this.props.intl.formatMessage({id:"HomeLabel",defaultMessage:g.defaultMessages.HomeLabel})}getIcon(){return null}getExpandPanel(){return(0,n.jsx)(N.Consumer,{children:({initialMapState:e})=>this.getHomeContent(e)})}},Navigation:class extends v{constructor(){super(...arguments),this.toolName="Navigation"}getTitle(){return"Navigation"}getIcon(){return null}getExpandPanel(){return(0,n.jsx)(j,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded})}static isAvailable(e){var t,i;return"3d"===(null===(i=null===(t=e.jimuMapView)||void 0===t?void 0:t.view)||void 0===i?void 0:i.type)}},Compass:class extends v{constructor(){super(...arguments),this.toolName="Compass"}getTitle(){return this.props.intl.formatMessage({id:"CompassLabel",defaultMessage:g.defaultMessages.CompassLabel})}getIcon(){return null}getExpandPanel(){return(0,n.jsx)(I,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded})}},Search:class extends v{constructor(){super(...arguments),this.toolName="Search"}getTitle(){return this.props.intl.formatMessage({id:"SearchLabel",defaultMessage:g.defaultMessages.SearchLabel})}getIcon(){return{icon:r(3077)}}getExpandPanel(){return this.props.isMobile?(0,n.jsx)("div",{style:{position:"relative",minHeight:"32px",width:"100%"},children:(0,n.jsx)(L,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded,isMobile:this.props.isMobile})}):(0,n.jsx)("div",{style:{position:"relative",width:"283px",minHeight:"32px"},children:(0,n.jsx)(L,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded,isMobile:this.props.isMobile})})}},Layers:class extends v{constructor(e){super(e),this.toolName="Layers",this.handleTabIndexChange=e=>{this.setState({activeTabIndex:e})},this.handleKeyDown=(e,t)=>{"Enter"!==e.key&&" "!==e.key||this.handleTabIndexChange(t)},this.state={activeTabIndex:0}}getTitle(){return this.props.intl.formatMessage({id:"LayersLabel",defaultMessage:g.defaultMessages.LayersLabel})}getIcon(){return{icon:r(97984)}}getExpandPanel(){return(0,n.jsxs)("div",{style:{width:this.props.isMobile?"100%":"250px",minHeight:"32px",position:"relative"},className:(0,i.classNames)({"exbmap-ui-pc-expand-maxheight":!this.props.isMobile}),children:[(0,n.jsxs)(g.Nav,{tabs:!0,style:{borderRadius:0},children:[(0,n.jsx)(g.NavItem,{children:(0,n.jsx)(g.NavLink,{style:{borderBottomLeftRadius:0,borderBottomRightRadius:0},active:0===this.state.activeTabIndex,onClick:()=>{this.handleTabIndexChange(0)},onKeyDown:e=>{this.handleKeyDown(e,0)},children:this.props.intl.formatMessage({id:"LayersLabelLayer",defaultMessage:g.defaultMessages.LayersLabelLayer})})}),(0,n.jsx)(g.NavItem,{children:(0,n.jsx)(g.NavLink,{style:{borderBottomLeftRadius:0,borderBottomRightRadius:0},active:1===this.state.activeTabIndex,onClick:()=>{this.handleTabIndexChange(1)},onKeyDown:e=>{this.handleKeyDown(e,1)},children:this.props.intl.formatMessage({id:"LayersLabelLegend",defaultMessage:g.defaultMessages.LayersLabelLegend})})})]}),(0,n.jsx)("div",{className:"mt-1"}),0===this.state.activeTabIndex&&(0,n.jsx)(D,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded}),1===this.state.activeTabIndex&&(0,n.jsx)(T,{jimuMapView:this.props.jimuMapView,mapComponentsLoaded:this.props.mapComponentsLoaded})]})}},MapSwitch:class extends v{constructor(){super(...arguments),this.toolName="MapSwitch",this.switchMap=()=>null,this.handleKeyDown=(e,t)=>{"Enter"!==e.key&&" "!==e.key||(null==e||e.preventDefault(),t())},this.getContent=(e,t,o,s,a)=>{const l=()=>{(0,i.getAppStore)().dispatch(i.appActions.requestAutoControlMapWidget(a,a)),s()};if(e){if(this.props.isMobile)return(0,n.jsx)("div",{className:"exbmap-ui-tool esri-widget--button-like",onClick:l,style:{marginTop:"10px"},role:"button",tabIndex:0,onKeyDown:e=>{this.handleKeyDown(e,l)},"aria-label":this.props.intl.formatMessage({id:"SwitchMap",defaultMessage:g.defaultMessages.SwitchMap}),children:(0,n.jsx)(g.Icon,{width:16,height:16,className:"exbmap-ui-tool-icon",icon:this.getIcon().icon})});{let e=null;return e=window.jimuConfig.isBuilder?(0,i.getAppStore)().getState().appStateInBuilder.appConfig.dataSources:(0,i.getAppStore)().getState().appConfig.dataSources,(0,n.jsxs)("div",{css:this.getStyle(),onClick:l,role:"button",tabIndex:0,onKeyDown:e=>{this.handleKeyDown(e,l)},"aria-label":this.props.intl.formatMessage({id:"SwitchMap",defaultMessage:g.defaultMessages.SwitchMap}),children:[(0,n.jsx)("div",{title:e[t[0]]?e[t[0]].label:null,className:(0,i.classNames)("mapthumb-item",{front:t[0]!==o},{back:t[0]===o}),children:(0,n.jsx)(m,{mapItemId:e[t[0]]?e[t[0]].itemId:null,portUrl:e[t[0]]?e[t[0]].portalUrl:null,usedInSetting:!1})}),(0,n.jsx)("div",{title:e[t[1]]?e[t[1]].label:null,className:(0,i.classNames)("mapthumb-item",{front:t[1]!==o},{back:t[1]===o}),children:(0,n.jsx)(m,{mapItemId:e[t[1]]?e[t[1]].itemId:null,portUrl:e[t[1]]?e[t[1]].portalUrl:null,usedInSetting:!1})})]})}}return null},this.getIconContent=(e,t,i,o)=>e?(this.switchMap=o,super.render()):null}static getIsNeedSetting(){return!1}getStyle(){return i.css`
      width: ${i.polished.rem(68)};
      height: ${i.polished.rem(52)};
      cursor: pointer;
      position: relative;

      .mapthumb-item {
        position: absolute;
        width: ${i.polished.rem(64)};
        height: ${i.polished.rem(48)};
        transition: bottom 0.5s, left 0.5s, top 0.5s, right 0.5s, z-index 0.5s;
      }

      .front {
        z-index: 1;
        bottom: 0;
        left: 0;
      }

      .back {
        z-index: 0;
        top: 0;
        right: 0;
      }
    `}getTitle(){return"MapSwitch"}getIcon(){return{icon:r(8634),onIconClick:()=>{this.switchMap()}}}getExpandPanel(){return this.props.toolJson.isOnlyExpanded?(0,n.jsx)(N.Consumer,{children:({isShowMapSwitchBtn:e,dataSourceIds:t,activeDataSourceId:i,switchMap:o,mapComponentId:s})=>this.getContent(e,t,i,o,s)}):null}render(){return this.props.toolJson.isOnlyExpanded?super.render():(0,n.jsx)(N.Consumer,{children:({isShowMapSwitchBtn:e,dataSourceIds:t,activeDataSourceId:i,switchMap:o})=>this.getIconContent(e,t,i,o)})}}},P=O;class A extends S{render(){const e=P[this.props.toolName];let t=!0;if(t=!!e&&("function"!=typeof e.isAvailable||e.isAvailable(this.props)),t){const t=this.props.layoutConfig.elements[this.props.toolName];return(0,n.jsx)("div",{className:(0,i.classNames)(this.props.className,"exbmap-ui exbmap-ui-tool-shell divitem",t.className,{"exbmap-ui-hidden-element":this.props.isHidden,"mb-0 mr-0":this.props.isLastElement,"rounded-pill":["Compass"].includes(this.props.toolName)}),children:(0,n.jsx)(e,{toolJson:t,toolName:this.props.toolName,isMobile:this.props.isMobile,jimuMapView:this.props.jimuMapView,activeToolName:this.props.activeToolName,onActiveToolNameChange:this.props.onActiveToolNameChange,intl:this.props.intl,mapComponentsLoaded:this.props.mapComponentsLoaded})})}return this.props.isMobile?(0,n.jsx)("span",{}):null}}class E extends S{getStyle(){const e=this.props.layoutConfig.layout[this.props.groupName]&&this.props.layoutConfig.layout[this.props.groupName].position,t=this.props.layoutConfig.elements[this.props.groupName].direction;return i.css`
      position: ${e?"absolute":"relative"};
      top: ${e?e.top:null}px;
      bottom: ${e?e.bottom:null}px;
      left: ${e?e.left:null}px;
      right: ${e?e.right:null}px;
      display: flex;
      flex-flow: ${"vertical"===t?"column":"row"};
      align-items: flex-start;

      > .exbmap-ui + .exbmap-ui {
        margin-top: ${"vertical"===t?"10px":0};
        margin-left: ${"horizontal"===t?"10px":0};
      }

      .exbmap-ui-group-expand-icon {
        fill: black;
        left: 8px;
        top: 8px;
        position: absolute;
        display: block;
      }

      .expand-mobile-panel {
        background-color: var(--ref-palette-white);
        box-shadow: rgba(0, 0, 0, 0.3) 0px 0px 2px;
        border-radius: 10px 10px 0px 0px;
      }

      .expand-mobile-panel-transition {
        transition: height 0.3s;
      }

      .expand-mobile-panel-touch-container {
        top: 0;
        position: absolute;
        width: 100%;
        height: 31px;
      }

      .expand-mobile-panel-bar {
        width: 36px;
        height: 4px;
        background-color: #434343;
        border-radius: 2px;
      }
      `}constructor(e){super(e),this.moveY=0,this.startY=0,this.sliding=!1,this.startDrag=!1,this.currentBottomPanelHeight=0,this.thumbMapElementNames=["FullScreen","Zoom","MapSwitch"],this.exbMapUiGroupCon=i.React.createRef(),this.checkIsHiddenElement=e=>!!this.props.hiddenElementNames&&!!this.props.hiddenElementNames.includes(e),this.start=(e,t)=>{if(this.startDrag=!0,"touch"===t){this.moveY=0;const t=e.touches[0];this.startY=t.clientY}"mouse"===t&&(this.moveY=0,this.startY=e.clientY),document.getElementById(`${this.props.jimuMapView.id}-bottom-panel`).classList.remove("expand-mobile-panel-transition")},this.move=(e,t)=>{if("touch"===t){this.sliding=!0;const t=e.touches[0];this.moveY=-1*(t.clientY-this.startY)}if("mouse"===t&&this.startDrag&&(this.sliding=!0,this.moveY=-1*(e.clientY-this.startY)),"mouse"===t&&!this.startDrag)return;let i=150;this.state.bottomPanelHeight+this.moveY>i&&(i=this.state.bottomPanelHeight+this.moveY),document.getElementById(`${this.props.jimuMapView.id}-bottom-panel`).style.height=`${i}px`,this.currentBottomPanelHeight=i;const o=this.state.widgetHeight-i;o>360&&this.props.onSetHiddenElementNames([]),o>200&&o<=360&&this.props.onSetHiddenElementNames(this.props.layoutConfig.mobileResponsiveStrategy.stage1),o>54&&o<=200&&this.props.onSetHiddenElementNames(this.props.layoutConfig.mobileResponsiveStrategy.stage2),o<54&&this.props.onSetHiddenElementNames(this.props.layoutConfig.mobileResponsiveStrategy.stage3)},this.end=(e,t)=>{if("mouse"!==t||this.startDrag){if(this.startDrag=!1,this.sliding=!1,document.getElementById(`${this.props.jimuMapView.id}-bottom-panel`).classList.add("expand-mobile-panel-transition"),"touch"===t&&Math.abs(this.moveY)<10)return document.getElementById(`${this.props.jimuMapView.id}-bottom-panel`).style.height=`${this.state.bottomPanelHeight}px`,void(this.currentBottomPanelHeight=this.state.bottomPanelHeight);if(this.moveY>=0){let e=0;e=this.currentBottomPanelHeight>=150&&this.currentBottomPanelHeight<.6*this.state.widgetHeight?.6*this.state.widgetHeight:this.currentBottomPanelHeight>=.6*this.state.widgetHeight&&this.currentBottomPanelHeight<this.state.widgetHeight?this.state.widgetHeight-20:150,this.setState({bottomPanelHeight:e},()=>{this.checkResponsive()}),this.currentBottomPanelHeight=e}else{let e=0;e=this.currentBottomPanelHeight>150&&this.currentBottomPanelHeight<.6*this.state.widgetHeight?150:this.currentBottomPanelHeight>=.6*this.state.widgetHeight&&this.currentBottomPanelHeight<this.state.widgetHeight?.6*this.state.widgetHeight:150,this.setState({bottomPanelHeight:e},()=>{this.checkResponsive()}),this.currentBottomPanelHeight=e}}},this.checkResponsive=()=>{if(this.state.isThumbMap)return void this.props.onSetHiddenElementNames([]);if(0===this.state.bottomPanelHeight)return this.props.onActiveToolNameChange(null),void this.props.onSetHiddenElementNames([]);const e=this.state.widgetHeight-this.state.bottomPanelHeight;e>360&&this.props.onSetHiddenElementNames([]),e>200&&e<=360&&this.props.onSetHiddenElementNames(this.props.layoutConfig.mobileResponsiveStrategy.stage1),e>54&&e<=200&&this.props.onSetHiddenElementNames(this.props.layoutConfig.mobileResponsiveStrategy.stage2),e<54&&this.props.onSetHiddenElementNames(this.props.layoutConfig.mobileResponsiveStrategy.stage3)},this.onResize=({width:e,height:t})=>{e<320&&t<380?this.setState({widgetWidth:e,widgetHeight:t,isThumbMap:!0},()=>{this.checkResponsive()}):this.setState({widgetWidth:e,widgetHeight:t,isThumbMap:!1},()=>{this.checkResponsive()})},this.returnNullNode=e=>this.props.isMobile?(0,n.jsx)("span",{},e):null,this.checkIsLastElement=(e,t)=>{const i=t.toolName,o=this.props.layoutConfig,s=o.layout[e.groupName].children,a=s.indexOf(i);if(a===s.length-1)return!0;if(a<s.length-1){let e=!0;for(let t=a+1;t<s.length;t++){const i=s[t];if("GROUP"!==o.elements[s[t]].type&&this.shouldRenderTool(i,o)){e=!1;break}}return e}},this.getGroupContent=e=>{if(e){const t=e.layout[this.props.groupName]&&e.layout[this.props.groupName].children;return this.checkIsShowGroup(e,t)?(0,n.jsxs)("div",{ref:this.exbMapUiGroupCon,css:this.getStyle(),className:(0,i.classNames)("exbmap-ui exbmap-ui-group",this.props.className,{"exbmap-ui-hidden-element":this.props.isHidden}),style:this.props.style,children:[t.map((t,i)=>e.elements[t]?"GROUP"===e.elements[t].type?(0,n.jsx)(E,{groupName:t,isHidden:this.checkIsHiddenElement(t),className:e.elements[t].className,style:e.elements[t].style,layoutConfig:e,toolConfig:this.props.toolConfig,isMobile:this.props.isMobile,intl:this.props.intl,mapComponentsLoaded:this.props.mapComponentsLoaded,jimuMapView:this.props.jimuMapView,activeToolName:this.props.activeToolName,hiddenElementNames:this.props.hiddenElementNames,onActiveToolNameChange:this.props.onActiveToolNameChange,isThumbMap:this.props.isMainGroup?this.state.isThumbMap:this.props.isThumbMap},i):"TOOL"===e.elements[t].type&&this.shouldRenderTool(t,e)?(0,n.jsx)(A,{toolName:t,isHidden:this.checkIsHiddenElement(t),layoutConfig:e,activeToolName:this.props.activeToolName,toolConfig:this.props.toolConfig,jimuMapView:this.props.jimuMapView,onActiveToolNameChange:this.props.onActiveToolNameChange,intl:this.props.intl,mapComponentsLoaded:this.props.mapComponentsLoaded,isMobile:this.props.isMobile,isLastElement:this.checkIsLastElement(e.elements[this.props.groupName],e.elements[t])},i):this.returnNullNode(i):this.returnNullNode(i)),this.props.isMobile&&this.props.isMainGroup&&(0,n.jsx)(i.ReactResizeDetector,{targetRef:this.exbMapUiGroupCon,handleWidth:!0,handleHeight:!0,onResize:this.onResize}),this.props.isMainGroup&&(0,n.jsxs)("div",{className:"exbmap-ui w-100",style:{position:"relative",pointerEvents:"auto",overflow:"hidden",touchAction:"none",display:!this.props.isMobile||this.state.isThumbMap||this.props.isThumbMap?"none":"block"},ref:e=>{e&&e.addEventListener("touchmove",e=>{e.preventDefault()},{passive:!1})},children:[(0,n.jsx)("div",{id:`${this.props.jimuMapView.id}-bottom-panel`,className:"exbmap-ui w-100 expand-mobile-panel expand-mobile-panel-transition",style:{overflow:"hidden",pointerEvents:"auto",position:"relative",touchAction:"none",height:`${this.sliding?this.currentBottomPanelHeight:this.state.bottomPanelHeight}px`}}),this.props.activeToolName&&(0,n.jsx)("div",{style:{touchAction:"none"},className:"expand-mobile-panel-touch-container d-flex justify-content-center align-items-center",onMouseDown:e=>{this.start(e,"mouse")},onMouseMove:e=>{this.move(e,"mouse")},onMouseLeave:e=>{this.end(e,"mouse")},onMouseUp:e=>{this.end(e,"mouse")},onTouchStart:e=>{this.start(e,"touch")},onTouchMove:e=>{this.move(e,"touch")},onTouchEnd:e=>{this.end(e,"touch")},children:(0,n.jsx)("div",{className:"expand-mobile-panel-bar"})})]})]}):this.returnNullNode()}return this.returnNullNode()},this.checkIsShowGroup=(e,t)=>{if(t&&0!==t.length){const i=[];this.findAllToolNames(e,t,i);let o=!1;for(let t=0;t<i.length;t++){const s=i[t];if(this.shouldRenderTool(s,e)){o=!0;break}}return o}return!1},this.findAllToolNames=(e,t,i)=>{if(t&&0!==t.length)for(let o=0;o<t.length;o++)if("GROUP"===e.elements[t[o]].type){const s=e.elements[t[o]].groupName;this.findAllToolNames(e,e.layout[s]&&e.layout[s].children,i)}else i.push(t[o])},this.state={bottomPanelHeight:0,isThumbMap:!!this.props.isMobile}}componentDidUpdate(e,t){if(this.props.activeToolName!==e.activeToolName){if(this.props.activeToolName&&e.activeToolName)return;this.props.activeToolName&&!e.activeToolName&&this.props.isMobile&&this.props.isMainGroup&&(this.setState({bottomPanelHeight:150},()=>{this.checkResponsive()}),this.currentBottomPanelHeight=150),!this.props.activeToolName&&e.activeToolName&&this.props.isMobile&&this.props.isMainGroup&&(this.setState({bottomPanelHeight:0},()=>{this.checkResponsive()}),this.currentBottomPanelHeight=0)}}shouldRenderTool(e,t){return!!P[e]&&(!P[e].getIsNeedSetting()||this.props.toolConfig&&this.props.toolConfig[`can${e}`]||t.lockToolNames&&t.lockToolNames.includes(e))}render(){return this.getGroupContent(this.props.layoutConfig)}}class R extends i.React.PureComponent{constructor(e){super(e),this.getMaxHeightForPcExpand=e=>{if(e){if(e<65)return null;{const t=e-65;return t<300?t:300}}return null},this.handleActiveNameChange=e=>{this.setState({activeToolName:e})},this.handSetHiddenElementNames=e=>{this.setState({hiddenElementNames:e})},this.getLayoutContent=e=>e&&this.props.toolConfig?(0,n.jsx)("div",{css:this.getStyle(),children:Object.keys(e.layout).map((t,i)=>e.elements[t]&&"GROUP"===e.elements[t].type&&e.layout[t].position?(0,n.jsx)(E,{className:e.elements[t].className,style:e.elements[t].style,isResponsive:e.elements[t].isResponsive,isMobile:this.props.isMobile,isMainGroup:!0,layoutConfig:e,toolConfig:this.props.toolConfig,onActiveToolNameChange:this.handleActiveNameChange,jimuMapView:this.props.jimuMapView,groupName:t,activeToolName:this.state.activeToolName,hiddenElementNames:e.mobileResponsiveStrategy&&this.state.hiddenElementNames,intl:this.props.intl,mapComponentsLoaded:this.props.mapComponentsLoaded,onSetHiddenElementNames:this.handSetHiddenElementNames},i):null)}):null,this.state={activeToolName:null,toolsContentInMobileExpandPanel:null,hiddenElementNames:[]},this.contentRef=document.createElement("div"),this.contentRef.className="exbmap-ui esri-ui-inner-container exbmap-ui-layout"}getStyle(){return i.css`
      z-index: 0;

      .expand-panel-transition {
        transition: opacity 0.3s, right 0.3s;
      }

      .scale-attribution-xy-group {
        > div:first-of-type:nth-last-of-type(1) {
          width: 100%;
          max-width: 100% !important;
        }
      }

      .exbmap-ui-hidden-element {
        display: none !important;
      }

      .exbmap-ui-pc-expand-maxheight {
        max-height: ${this.getMaxHeightForPcExpand(this.props.widgetHeight)}px;
        overflow: auto;
      }
      `}componentDidMount(){this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container&&this.props.jimuMapView.view.ui.container.appendChild(this.contentRef)}render(){return this.props.jimuMapView&&this.props.jimuMapView.view&&this.props.jimuMapView.view.ui&&this.props.jimuMapView.view.ui.container?(0,n.jsx)("div",{children:i.ReactDOM.createPortal(this.getLayoutContent(this.props.layoutConfig),this.contentRef)}):null}}const k=[{elements:{navigator:{type:"GROUP",groupName:"navigator",direction:"vertical"},interact:{type:"GROUP",groupName:"interact",direction:"vertical",isResponsive:!0},bottom:{type:"GROUP",groupName:"bottom",direction:"vertical",className:"w-100"},"bottom-line1":{type:"GROUP",groupName:"bottom-line1",direction:"horizontal",className:"d-flex align-items-center justify-content-between w-100 scale-attribution-xy-group",style:{marginBottom:0}},"bottom-line2":{type:"GROUP",groupName:"bottom-line2",direction:"horizontal",className:"d-flex align-items-center justify-content-between w-100",style:{paddingLeft:"15px",paddingRight:"15px",marginBottom:"10px"}},attributionGroup:{type:"GROUP",groupName:"attributionGroup",direction:"horizontal",style:{maxWidth:"60%"}},Zoom:{type:"TOOL",toolName:"Zoom",isOnlyExpanded:!0,isShowIconTitle:!1},Home:{type:"TOOL",toolName:"Home",isOnlyExpanded:!0,isShowIconTitle:!1},Compass:{type:"TOOL",toolName:"Compass",isOnlyExpanded:!0,isShowIconTitle:!1},Navigation:{type:"TOOL",toolName:"Navigation",isOnlyExpanded:!0,isShowIconTitle:!1},Locate:{type:"TOOL",toolName:"Locate",isOnlyExpanded:!0,isShowIconTitle:!1},Layers:{type:"TOOL",toolName:"Layers",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},BaseMap:{type:"TOOL",toolName:"BaseMap",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},Measure:{type:"TOOL",toolName:"Measure",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},MapSwitch:{type:"TOOL",toolName:"MapSwitch",isOnlyExpanded:!0,isShowIconTitle:!0},FullScreen:{type:"TOOL",toolName:"FullScreen",isOnlyExpanded:!1,isShowIconTitle:!0},ScaleBar:{type:"TOOL",toolName:"ScaleBar",isOnlyExpanded:!0,isShowIconTitle:!1},Attribution:{type:"TOOL",toolName:"Attribution",isOnlyExpanded:!0,isShowIconTitle:!1,className:"w-100"},Search:{type:"TOOL",toolName:"Search",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"}},layout:{navigator:{children:["Zoom","Home","Navigation","Locate","Compass"],position:{top:15,left:15}},interact:{children:["Search","Layers","BaseMap","Measure"],position:{top:15,right:15}},"bottom-line1":{children:["ScaleBar","attributionGroup"]},"bottom-line2":{children:["MapSwitch","FullScreen"]},bottom:{children:["bottom-line2","bottom-line1"],position:{bottom:0,left:0}},attributionGroup:{children:["Attribution"]}}},{elements:{navigator:{type:"GROUP",groupName:"navigator",direction:"vertical"},interact:{type:"GROUP",groupName:"interact",direction:"horizontal",isResponsive:!0},fullScreenGroup:{type:"GROUP",groupName:"fullScreenGroup",direction:"horizontal"},bottom:{type:"GROUP",groupName:"bottom",direction:"vertical",className:"w-100"},"bottom-line1":{type:"GROUP",groupName:"bottom-line1",direction:"horizontal",className:"d-flex align-items-center justify-content-between w-100 scale-attribution-xy-group",style:{marginBottom:0}},"bottom-line2":{type:"GROUP",groupName:"bottom-line2",direction:"horizontal",className:"d-flex align-items-end justify-content-between w-100",style:{paddingLeft:"15px",paddingRight:"15px",marginBottom:"10px"}},attributionGroup:{type:"GROUP",groupName:"attributionGroup",direction:"horizontal",style:{maxWidth:"60%"},className:"attibute-group"},Zoom:{type:"TOOL",toolName:"Zoom",isOnlyExpanded:!0,isShowIconTitle:!1},Home:{type:"TOOL",toolName:"Home",isOnlyExpanded:!0,isShowIconTitle:!1},Compass:{type:"TOOL",toolName:"Compass",isOnlyExpanded:!0,isShowIconTitle:!1},Navigation:{type:"TOOL",toolName:"Navigation",isOnlyExpanded:!0,isShowIconTitle:!1},Locate:{type:"TOOL",toolName:"Locate",isOnlyExpanded:!0,isShowIconTitle:!1},Layers:{type:"TOOL",toolName:"Layers",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"},BaseMap:{type:"TOOL",toolName:"BaseMap",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"},Measure:{type:"TOOL",toolName:"Measure",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"},MapSwitch:{type:"TOOL",toolName:"MapSwitch",isOnlyExpanded:!0,isShowIconTitle:!0},FullScreen:{type:"TOOL",toolName:"FullScreen",isOnlyExpanded:!1,isShowIconTitle:!0},ScaleBar:{type:"TOOL",toolName:"ScaleBar",isOnlyExpanded:!0,isShowIconTitle:!1},Attribution:{type:"TOOL",toolName:"Attribution",isOnlyExpanded:!0,isShowIconTitle:!1,className:"w-100"},Search:{type:"TOOL",toolName:"Search",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"bottom"}},layout:{navigator:{children:["Compass","Locate","Navigation","Zoom","Home"]},interact:{children:["Search","Layers","BaseMap","Measure"],position:{top:15,left:15}},fullScreenGroup:{children:["FullScreen"],position:{top:15,right:15}},"bottom-line1":{children:["ScaleBar","attributionGroup"]},"bottom-line2":{children:["MapSwitch","navigator"]},bottom:{children:["bottom-line2","bottom-line1"],position:{bottom:0,left:0}},attributionGroup:{children:["Attribution"]}}}],z=[{elements:{mainGroup:{type:"GROUP",groupName:"mainGroup",direction:"vertical",style:{position:"absolute"},className:"d-flex flex-column"},topGroup:{type:"GROUP",groupName:"topGroup",direction:"horizontal",className:"d-flex w-100 align-items-center justify-content-between",style:{padding:"10px"}},midGroup:{type:"GROUP",groupName:"midGroup",direction:"horizontal",className:"flex-grow-1 d-flex w-100 justify-content-between"},"midGroup-left":{type:"GROUP",groupName:"midGroup-left",direction:"vertical",className:"h-100 d-flex flex-column-reverse",style:{paddingLeft:"10px",paddingRight:"10px",paddingBottom:"10px"}},"midGroup-left-content":{type:"GROUP",groupName:"midGroup-left-content",direction:"vertical"},"midGroup-right":{type:"GROUP",groupName:"midGroup-right",direction:"vertical",className:"h-100 d-flex flex-column justify-content-between",style:{paddingRight:"10px",paddingLeft:"10px",paddingBottom:"10px"}},"midGroup-right-content-top":{type:"GROUP",groupName:"midGroup-right-content-top",direction:"vertical"},"midGroup-right-content-bottom":{type:"GROUP",groupName:"midGroup-right-content-bottom",direction:"vertical"},bottomGroup:{type:"GROUP",groupName:"bottomGroup",direction:"vertical"},Search:{type:"TOOL",toolName:"Search",isOnlyExpanded:!0,isShowIconTitle:!1,className:"flex-grow-1"},FullScreen:{type:"TOOL",toolName:"FullScreen",isOnlyExpanded:!1,isShowIconTitle:!0},Locate:{type:"TOOL",toolName:"Locate",isOnlyExpanded:!0,isShowIconTitle:!1},Compass:{type:"TOOL",toolName:"Compass",isOnlyExpanded:!0,isShowIconTitle:!1,className:"mb-0"},MapSwitch:{type:"TOOL",toolName:"MapSwitch",isOnlyExpanded:!0,isShowIconTitle:!0},Zoom:{type:"TOOL",toolName:"Zoom",isOnlyExpanded:!0,isShowIconTitle:!1},Home:{type:"TOOL",toolName:"Home",isOnlyExpanded:!0,isShowIconTitle:!1},Layers:{type:"TOOL",toolName:"Layers",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},BaseMap:{type:"TOOL",toolName:"BaseMap",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"},Measure:{type:"TOOL",toolName:"Measure",isOnlyExpanded:!1,isShowIconTitle:!0,panelPlacement:"left-start"}},layout:{mainGroup:{children:["topGroup","midGroup","bottomGroup"],position:{top:0,left:0,bottom:0,right:0}},topGroup:{children:["Search","FullScreen"]},midGroup:{children:["midGroup-left","midGroup-right"]},"midGroup-left":{children:["midGroup-left-content"]},"midGroup-left-content":{children:["Compass","MapSwitch"]},"midGroup-right":{children:["midGroup-right-content-top","midGroup-right-content-bottom"]},"midGroup-right-content-top":{children:["Layers","BaseMap","Measure"]},"midGroup-right-content-bottom":{children:["Zoom","Home","Locate"]}},mobileResponsiveStrategy:{stage1:["midGroup-left-content","midGroup-right-content-bottom"],stage2:["midGroup-left-content","midGroup-right-content-bottom","midGroup-right-content-top"],stage3:["topGroup","midGroup-left-content","midGroup-right-content-bottom","midGroup-right-content-top"]},lockToolNames:[]}];var U=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};const V=r(8634);var F;!function(e){e.Loading="LOADING",e.Loadok="LOADOK",e.LoadError="LOADERROR"}(F||(F={}));class B extends i.React.PureComponent{constructor(e){super(e),this.widgetContainer=i.React.createRef(),this.highLightHandles={},this.mapBaseViewEventHandles={},this.startRenderMap=()=>{(0,y.loadArcGISJSAPIModules)(["esri/geometry/Extent","esri/Viewpoint","esri/core/reactiveUtils"]).then(e=>{[this.Extent,this.Viewpoint,this.reactiveUtils]=e,this.setState({isModulesLoaded:!0})})},this.analysisMapView=()=>U(this,void 0,void 0,function*(){return this.mapView?yield Promise.resolve(null):this.MapView?(this.initMapView(),yield Promise.resolve(null)):yield(0,y.loadArcGISJSAPIModules)(["esri/geometry/Geometry","esri/webmap/InitialViewProperties","esri/Basemap","esri/layers/TileLayer","esri/views/MapView","esri/WebMap","esri/portal/Portal","esri/portal/PortalItem"]).then(e=>U(this,void 0,void 0,function*(){return[this.Geometry,this.InitialViewProperties,this.Basemap,this.TileLayer,this.MapView,this.WebMap,this.Portal,this.PortalItem]=e,this.initMapView(),yield Promise.resolve(null)}))}),this.analysisSceneView=()=>U(this,void 0,void 0,function*(){return this.sceneView?yield Promise.resolve(null):this.SceneView?(this.initSceneView(),yield Promise.resolve(null)):yield(0,y.loadArcGISJSAPIModules)(["esri/views/SceneView","esri/WebScene","esri/portal/Portal","esri/portal/PortalItem"]).then(e=>U(this,void 0,void 0,function*(){return[this.SceneView,this.WebScene,this.Portal,this.PortalItem]=e,this.initSceneView(),yield Promise.resolve(null)}))}),this.generateViewPointFromInitialMapState=e=>"2d"===e.viewType?new this.Viewpoint({targetGeometry:this.Extent.fromJSON(e.extent),rotation:e.rotation}):this.Viewpoint.fromJSON(e.viewPoint),this.cloneMap=e=>{let t=null;const o=e.getDataSourceJson();let s=null;if(o.type===i.DataSourceTypes.WebMap&&(s=this.WebMap),o.type===i.DataSourceTypes.WebScene&&(s=this.WebScene),o.portalUrl){const e=new this.Portal({url:i.portalUrlUtils.getPlatformUrlByOrgUrl(o.portalUrl)});t=new s({portalItem:new this.PortalItem({id:o.itemId,portal:e})})}else t=new s({portalItem:new this.PortalItem({id:o.itemId})});return t},this.getInitViewPointForDefaultWebMap=()=>{const e=this.props.defaultMapInfo&&this.props.defaultMapInfo.defaultExtent;let t=null;return t=this.props.baseWidgetProps.jimuMapConfig.initialMapState&&this.props.baseWidgetProps.jimuMapConfig.initialMapState.viewPoint?this.generateViewPointFromInitialMapState(this.props.baseWidgetProps.jimuMapConfig.initialMapState):new this.Viewpoint({targetGeometry:new this.Extent({xmin:e&&e.xmin,ymin:e&&e.ymin,xmax:e&&e.xmax,ymax:e&&e.ymax,spatialReference:{wkid:e.spatialReference.wkid}})}),t},this.getDefaultWebMap=()=>{const e=this.props.defaultMapInfo&&this.props.defaultMapInfo.defaultExtent;let t=null;t=new this.Viewpoint({targetGeometry:new this.Extent({xmin:e&&e.xmin,ymin:e&&e.ymin,xmax:e&&e.xmax,ymax:e&&e.ymax,spatialReference:{wkid:e.spatialReference.wkid}})});return new this.WebMap({portalItem:{id:this.props.defaultMapInfo.defaultMapId,portal:{url:(0,i.getAppStore)().getState().portalUrl}},initialViewProperties:new this.InitialViewProperties({spatialReference:e&&e.spatialReference,viewpoint:t})})},this.initMapView=()=>{if(this.extentWatch=null,this.mapView)return;let e;if(this.props.isDefaultMap){e={map:this.getDefaultWebMap(),container:this.mapContainer,viewpoint:this.getInitViewPointForDefaultWebMap(),rotation:this.props.baseWidgetProps.jimuMapConfig.initialMapState&&this.props.baseWidgetProps.jimuMapConfig.initialMapState.rotation}}else{const t=this.cloneMap(this.state.mapDs);e=this.props.baseWidgetProps.jimuMapConfig.initialMapState?{map:t,container:this.mapContainer,viewpoint:this.props.baseWidgetProps.jimuMapConfig.initialMapState&&this.generateViewPointFromInitialMapState(this.props.baseWidgetProps.jimuMapConfig.initialMapState)}:{map:t,container:this.mapContainer}}e.timeZone="system",this.mapView=new this.MapView(e),y.MapViewManager.getInstance().createJimuMapView({mapWidgetId:this.props.baseWidgetProps.id,dataSourceId:this.props.dataSourceId,view:this.mapView,mapViewManager:y.MapViewManager.getInstance()}).then(()=>{this.setState({mapLoadStatus:F.Loadok},()=>{this.props.onMapLoaded(this.props.dataSourceId,F.Loadok)});const e=`${this.props.baseWidgetProps.id}-${this.props.dataSourceId}`,t=y.MapViewManager.getInstance().getJimuMapViewById(e);t&&(this.props.onJimuMapViewCreated(t),this.setState({mapBaseJimuMapView:t})),this.extentWatch||(this.extentWatch=this.reactiveUtils.watch(()=>{var e;return null===(e=this.mapView)||void 0===e?void 0:e.extent},e=>{if(!e)return;const t=this.mapView.viewpoint.clone(),o=this.mapView.stationary,s=new i.ExtentChangeMessage(this.props.baseWidgetProps.id,e,t,o);s.addRelatedWidgetId(this.props.baseWidgetProps.id),this.props.onExtentChanged(this.props.dataSourceId,s);const a=this.mapView;this.watchStationaryHandle&&(this.watchStationaryHandle.remove(),this.watchStationaryHandle=null),this.watchStationaryHandle=this.reactiveUtils.watch(()=>null==a?void 0:a.stationary,()=>{if(a.stationary){const e=a.viewpoint.clone(),t=a.extent.clone(),o=!0,s=new i.ExtentChangeMessage(this.props.baseWidgetProps.id,t,e,o);s.addRelatedWidgetId(this.props.baseWidgetProps.id),this.props.onExtentChanged(this.props.dataSourceId,s)}})})),setTimeout(()=>{this.goHome(!1)},500)}),this.bindMapBaseViewEvent(this.mapView)},this.initSceneView=()=>{if(this.extentWatch=null,this.sceneView)return;const e=this.cloneMap(this.state.mapDs);let t;t=this.props.baseWidgetProps.jimuMapConfig.initialMapState?{map:e,container:this.mapContainer,qualityProfile:"low",popup:{defaultPopupTemplateEnabled:!0},viewpoint:this.props.baseWidgetProps.jimuMapConfig.initialMapState&&this.generateViewPointFromInitialMapState(this.props.baseWidgetProps.jimuMapConfig.initialMapState)}:{map:e,container:this.mapContainer,qualityProfile:"low",popup:{defaultPopupTemplateEnabled:!0}},this.sceneView=new this.SceneView(t),y.MapViewManager.getInstance().createJimuMapView({mapWidgetId:this.props.baseWidgetProps.id,dataSourceId:this.props.dataSourceId,view:this.sceneView,mapViewManager:y.MapViewManager.getInstance()}),this.sceneView.when(()=>{this.setState({mapLoadStatus:F.Loadok},()=>{this.props.onMapLoaded(this.props.dataSourceId,F.Loadok)});const e=`${this.props.baseWidgetProps.id}-${this.props.dataSourceId}`,t=y.MapViewManager.getInstance().getJimuMapViewById(e);t&&(this.props.onJimuMapViewCreated(t),this.setState({mapBaseJimuMapView:t})),this.extentWatch||(this.extentWatch=this.reactiveUtils.watch(()=>{var e;return null===(e=this.sceneView)||void 0===e?void 0:e.extent},e=>{if(!e)return;const t=this.sceneView,o=t.viewpoint.clone(),s=t.stationary,a=new i.ExtentChangeMessage(this.props.baseWidgetProps.id,e,o,s);a.addRelatedWidgetId(this.props.baseWidgetProps.id),this.props.onExtentChanged(this.props.dataSourceId,a),this.watchStationaryHandle&&(this.watchStationaryHandle.remove(),this.watchStationaryHandle=null),this.watchStationaryHandle=this.reactiveUtils.watch(()=>null==t?void 0:t.stationary,()=>{if(t.stationary){const e=t.viewpoint.clone(),o=t.extent.clone(),s=!0,a=new i.ExtentChangeMessage(this.props.baseWidgetProps.id,o,e,s);a.addRelatedWidgetId(this.props.baseWidgetProps.id),this.props.onExtentChanged(this.props.dataSourceId,a)}})})),setTimeout(()=>{this.goHome(!1)},500)}),this.bindMapBaseViewEvent(this.sceneView)},this.updateMapView=e=>{e.disablePopUp?(this.mapView.closePopup(),this.mapView.popupEnabled=!1):this.mapView.popupEnabled=!0,this.mapView.ui&&(this.mapView.ui.components=[])},this.updateSceneView=e=>{e.disablePopUp?(this.sceneView.closePopup(),this.sceneView.popupEnabled=!1):this.sceneView.popupEnabled=!0,this.sceneView.ui&&(this.sceneView.ui.components=[])},this.bindMapBaseViewEvent=e=>{e&&(this.mapBaseViewEventHandles["mouse-wheel"]&&(this.mapBaseViewEventHandles["mouse-wheel"].remove(),this.mapBaseViewEventHandles["mouse-wheel"]=null),this.mapBaseViewEventHandles["mouse-wheel"]=e.on("mouse-wheel",t=>{if(this.props.baseWidgetProps.jimuMapConfig.disableScroll)return t.stopPropagation(),void this.handleDisableWheel();this.props.onViewChanged&&this.props.onViewChanged({dataSourceId:this.props.dataSourceId,viewpoint:e.viewpoint.clone()})}),this.mapBaseViewEventHandles.drag&&(this.mapBaseViewEventHandles.drag.remove(),this.mapBaseViewEventHandles.drag=null),this.mapBaseViewEventHandles.drag=e.on("drag",()=>{this.props.onViewChanged&&this.props.onViewChanged({dataSourceId:this.props.dataSourceId,viewpoint:e.viewpoint.clone()})}),this.mapBaseViewEventHandles.click&&(this.mapBaseViewEventHandles.click.remove(),this.mapBaseViewEventHandles.click=null),this.mapBaseViewEventHandles.click=e.on("click",()=>{for(const e in this.highLightHandles)this.highLightHandles[e].remove()}))},this.getMapDsId=()=>this.state.mapDs&&this.state.mapDs.id,this.onDataSourceCreated=e=>{this.setState({mapDs:e,preMapDs:this.state.mapDs})},this.onCreateDataSourceFailed=e=>{console.warn(e),this.setState({mapLoadStatus:F.LoadError,mapDs:null,preMapDs:this.state.mapDs},()=>{this.props.onMapLoaded(this.props.dataSourceId,F.LoadError),y.MapViewManager.getInstance().createJimuMapView({mapWidgetId:this.props.baseWidgetProps.id,dataSourceId:this.props.dataSourceId,view:null,mapViewManager:y.MapViewManager.getInstance()})})},this.setViewPoint=e=>{e&&this.state.mapDs&&(this.state.mapDs.type===i.DataSourceTypes.WebMap&&this.mapView&&(this.mapView.viewpoint=e),this.state.mapDs.type===i.DataSourceTypes.WebScene&&this.sceneView&&(this.sceneView.viewpoint=e))},this.getMapLoadStatus=()=>this.state.mapLoadStatus,this.getViewPoint=()=>this.state.mapDs?this.state.mapDs.type===i.DataSourceTypes.WebMap?this.mapView&&this.mapView.viewpoint?this.mapView.viewpoint.clone():null:this.state.mapDs.type===i.DataSourceTypes.WebScene?this.sceneView&&this.sceneView.viewpoint?(this.sceneView.goTo(this.sceneView.viewpoint.camera,{animate:!1}),this.sceneView.viewpoint.clone()):null:void 0:null,this.getViewType=()=>this.state.mapDs&&this.state.mapDs.type,this.goToTilt=e=>{this.sceneView&&this.sceneView.goTo({tilt:e})},this.goHome=e=>U(this,void 0,void 0,function*(){if(!this.state.mapDs)return yield Promise.resolve(null);const t=this.getMapBaseInitViewPoint();return this.state.mapDs.type===i.DataSourceTypes.WebMap&&this.mapView?this.mapView.goTo(t,{animate:e}):this.state.mapDs.type===i.DataSourceTypes.WebScene&&this.sceneView?this.sceneView.goTo(t,{animate:e}):yield Promise.resolve(null)}),this.getMapBaseInitViewPoint=()=>{var e,t,i;return this.props.isDefaultMap?this.getInitViewPointForDefaultWebMap():this.props.baseWidgetProps.jimuMapConfig.initialMapState?this.generateViewPointFromInitialMapState(this.props.baseWidgetProps.jimuMapConfig.initialMapState):null===(i=null===(t=null===(e=this.state.mapDs.map)||void 0===e?void 0:e.initialViewProperties)||void 0===t?void 0:t.viewpoint)||void 0===i?void 0:i.clone()},this.formatMessage=e=>this.props.baseWidgetProps.intl.formatMessage({id:e,defaultMessage:g.defaultMessages[e]}),this.handleDisableWheel=()=>{this.widgetContainer.current.style.pointerEvents="none",setTimeout(()=>{this.widgetContainer.current.style.pointerEvents="auto"},50)},this.getLayoutConfig=()=>"xsmall"===this.state.widthBreakpoint?z[0]:this.props.baseWidgetProps.jimuMapConfig.layoutIndex?k[this.props.baseWidgetProps.jimuMapConfig.layoutIndex]:k[0],this.onResize=({width:e,height:t})=>{e&&t&&(e<=545&&e>0?this.setState({widthBreakpoint:"xsmall",widgetHeight:t}):this.setState({widthBreakpoint:"other",widgetHeight:t}))},this.getMapSwitchForErrorMap=()=>(0,n.jsx)(N.Consumer,{children:({isShowMapSwitchBtn:e,dataSourceIds:t,activeDataSourceId:i,switchMap:o})=>(0,n.jsx)("div",{className:"mapswitch-container",style:{display:e?"block":"none",marginBottom:"xsmall"===this.state.widthBreakpoint?10:0},children:(0,n.jsx)("div",{onClick:e=>{e.preventDefault(),o()},className:"jimu-widget esri-widget--button-like",children:(0,n.jsx)(g.Icon,{icon:V,width:16,height:16,className:"mapswitch-icon"})})})}),this.state={mapLoadStatus:F.Loading,widthBreakpoint:null,mapBaseJimuMapView:null,dataSourceId:null,widgetHeight:null}}componentDidMount(){0===this.widgetContainer.current.getElementsByClassName("widget-map").length&&(this.mapContainer||(this.mapContainer=document&&document.createElement("div"),this.mapContainer.className="jimu-widget widget-map"),this.widgetContainer.current.appendChild(this.mapContainer)),!this.props.startLoadModules||this.state.isModulesLoaded?(this.getMapDsId()||this.props.isDefaultMap)&&(this.state.mapDs||this.props.isDefaultMap)&&(this.props.isDefaultMap?this.analysisMapView().then(()=>{this.updateMapView(this.props.baseWidgetProps.jimuMapConfig)}):(this.state.mapDs.type===i.DataSourceTypes.WebMap&&this.analysisMapView().then(()=>{this.updateMapView(this.props.baseWidgetProps.jimuMapConfig)}),this.state.mapDs.type===i.DataSourceTypes.WebScene&&this.analysisSceneView().then(()=>{this.updateSceneView(this.props.baseWidgetProps.jimuMapConfig)}))):this.startRenderMap()}componentDidUpdate(){if(!this.state.isModulesLoaded)return;const e=this.getMapDsId(),t=this.state.preMapDs&&this.state.preMapDs.id,o=this.state.mapDs&&this.state.mapDs.getDataSourceJson().itemId,s=this.state.preMapDs&&this.state.preMapDs.getDataSourceJson().itemId;if(e!==t||o!==s){this.mapView=null,this.sceneView=null;const e=this.state.preMapDs&&`${this.props.baseWidgetProps.id}-${this.state.preMapDs.id}`;if(e&&y.MapViewManager.getInstance().destroyJimuMapView(e),this.state.mapLoadStatus===F.LoadError&&!this.state.mapDs)return void this.setState({preMapDs:this.state.mapDs});this.setState({preMapDs:this.state.mapDs,mapLoadStatus:F.Loading})}this.props.isDefaultMap&&(this.sceneView=null,this.analysisMapView().then(()=>{this.updateMapView(this.props.baseWidgetProps.jimuMapConfig)})),this.state.mapDs&&(this.state.mapDs.type===i.DataSourceTypes.WebMap&&(this.sceneView=null,this.analysisMapView().then(()=>{this.updateMapView(this.props.baseWidgetProps.jimuMapConfig)})),this.state.mapDs.type===i.DataSourceTypes.WebScene&&(this.mapView=null,this.analysisSceneView().then(()=>{this.updateSceneView(this.props.baseWidgetProps.jimuMapConfig)})))}static getDerivedStateFromProps(e,t){return e.dataSourceId!==t.dataSourceId?{dataSourceId:e.dataSourceId,mapLoadStatus:F.Loading}:null}componentWillUnmount(){const e=`${this.props.baseWidgetProps.id}-${this.props.dataSourceId}`;y.MapViewManager.getInstance().destroyJimuMapView(e),this.mapView&&!this.mapView.destroyed&&(this.mapView.container=null,this.mapView=null),this.sceneView&&!this.sceneView.destroyed&&(this.sceneView.container=null,this.sceneView=null),this.highLightHandles={},this.extentWatch&&(this.extentWatch.remove(),this.extentWatch=null),this.watchStationaryHandle&&(this.watchStationaryHandle.remove(),this.watchStationaryHandle=null)}render(){let e=null;if(this.props.baseWidgetProps.useDataSources)for(let t=0;t<this.props.baseWidgetProps.useDataSources.length;t++)this.props.baseWidgetProps.useDataSources[t].dataSourceId===this.props.dataSourceId&&(e=this.props.baseWidgetProps.useDataSources[t]);return(0,n.jsxs)("div",{className:"jimu-widget",style:{position:"relative"},ref:this.widgetContainer,children:[this.state.mapLoadStatus===F.Loading&&(0,n.jsx)("div",{className:"jimu-widget widget-map-background",children:(0,n.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})}),this.state.mapLoadStatus===F.LoadError&&(0,n.jsxs)("div",{className:"jimu-widget widget-map-background",children:[this.getMapSwitchForErrorMap(),(0,n.jsx)("div",{className:"jimu-widget d-flex justify-content-center align-items-center",children:"map failed"})]}),this.state.mapBaseJimuMapView&&this.state.widthBreakpoint&&(0,n.jsx)(R,{isMobile:"xsmall"===this.state.widthBreakpoint,jimuMapView:this.state.mapBaseJimuMapView,appMode:this.props.baseWidgetProps.appMode,intl:this.props.baseWidgetProps.intl,mapComponentsLoaded:this.props.mapComponentsLoaded,layoutConfig:this.getLayoutConfig(),toolConfig:this.props.baseWidgetProps.jimuMapConfig.toolConfig?this.props.baseWidgetProps.jimuMapConfig.toolConfig:{},widgetHeight:"xsmall"===this.state.widthBreakpoint?null:this.state.widgetHeight}),!this.props.isDefaultMap&&(0,n.jsx)("div",{style:{position:"absolute",display:"none"},children:(0,n.jsx)(i.DataSourceComponent,{useDataSource:e,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})}),(0,n.jsx)(i.ReactResizeDetector,{targetRef:this.widgetContainer,handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}}var G=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};const W={firstMapVisible:[{zIndex:6,opacity:1},{zIndex:5,opacity:0}],secondMapVisible:[{zIndex:5,opacity:0},{zIndex:6,opacity:1}]};class H extends i.React.PureComponent{constructor(e){super(e),this.mutableStatePropsMap={},this.reInitWidgetInstance=e=>{this.state=e,this.isReIniting=!0},this.changeInitialMapDataSourceID=(e,t)=>{var i,o;if(this.props.baseWidgetProps.useDataSources.length>1){const s=null===(i=this.firstMapInstance)||void 0===i?void 0:i.current,a=null===(o=this.secondMapInstance)||void 0===o?void 0:o.current;this.state.currentMapIndex?this.state.firstMapDsId&&this.state.firstMapDsId===e?(this.startChangeInitialMapAnimation(t),s.goHome(!1)):a.goHome(!1):this.state.secondMapDsId&&this.state.secondMapDsId===e?(this.startChangeInitialMapAnimation(t),a.goHome(!1)):s.goHome(!1)}},this.startChangeInitialMapAnimation=e=>{var t,i;const o=Object.assign({},this.state),s=null===(t=this.firstMapInstance)||void 0===t?void 0:t.current,a=null===(i=this.secondMapInstance)||void 0===i?void 0:i.current;if(this.state.currentMapIndex){o.currentMapIndex=0,o.multiMapStyle=W.firstMapVisible;const t=a&&a.getViewPoint&&a.getViewPoint();t&&s&&s.setViewPoint&&s.setViewPoint(t),this.setState(o,()=>{e()})}else{o.currentMapIndex=1,o.multiMapStyle=W.secondMapVisible;const t=s&&s.getViewPoint&&s.getViewPoint();t&&a&&a.setViewPoint&&a.setViewPoint(t),this.setState(o,()=>{e()})}},this.switchMap=()=>G(this,void 0,void 0,function*(){var e,t;if(!this.props.baseWidgetProps.useDataSources||this.props.baseWidgetProps.useDataSources.length<2)return void(yield Promise.resolve());const i=Object.assign({},this.state);i.useAnimation=!0;const o=null===(e=this.firstMapInstance)||void 0===e?void 0:e.current,s=null===(t=this.secondMapInstance)||void 0===t?void 0:t.current;if(this.state.currentMapIndex){i.currentMapIndex=0,i.multiMapStyle=W.firstMapVisible;const e=s&&s.getViewPoint&&s.getViewPoint();e&&o&&o.setViewPoint&&o.setViewPoint(e)}else{i.currentMapIndex=1,i.multiMapStyle=W.secondMapVisible;const e=o&&o.getViewPoint&&o.getViewPoint();e&&s&&s.setViewPoint&&s.setViewPoint(e)}if(o&&s){const e=o.getViewType(),t=s.getViewType();e&&t&&e!==t&&(o.goToTilt(0),s.goToTilt(0),this.state.currentMapIndex?setTimeout(()=>{o.goToTilt(45)},300):setTimeout(()=>{s.goToTilt(45)},300))}return new Promise((e,t)=>{this.setState(i,()=>{this.confirmJimuMapViewIsActive(),setTimeout(()=>{this.setState({useAnimation:!1},()=>{e(null)})},500)})})}),this.handleMutableStatePropsChanged=(e,t,i)=>{},this.handleViewChanged=e=>{var t,i,o,s;if(null===e.viewpoint){const e=null===(t=this.firstMapInstance)||void 0===t?void 0:t.current,o=null===(i=this.secondMapInstance)||void 0===i?void 0:i.current;return e&&e.goHome(!1),void(o&&o.goHome(!1))}const a=this.getCurrentVisibleDsId();if(a===e.dataSourceId){if(this.state.firstMapDsId&&this.state.firstMapDsId!==a){const t=null===(o=this.firstMapInstance)||void 0===o?void 0:o.current;t&&t.setViewPoint(e.viewpoint)}if(this.state.secondMapDsId&&this.state.secondMapDsId!==a){const t=null===(s=this.secondMapInstance)||void 0===s?void 0:s.current;t&&t.setViewPoint(e.viewpoint)}this.props.onViewPointChanged&&this.props.onViewPointChanged(e.viewpoint)}},this.handleExtentChanged=(e,t)=>{this.getCurrentVisibleDsId()===e&&(i.MessageManager.getInstance().publishMessage(t),this.props.onExtentChanged&&this.props.onExtentChanged(t.extent))},this.handleMapLoaded=(e,t)=>{this.forceUpdate()},this.handleJimuMapViewCreated=e=>{this.props.onJimuMapViewCreated&&this.props.onJimuMapViewCreated(e),this.confirmJimuMapViewIsActive()},this.confirmJimuMapViewIsActive=()=>{if(this.props.isDefaultMap){const e=`${this.props.baseWidgetProps.id}-null`,t=y.MapViewManager.getInstance().getJimuMapViewById(e);return void(t&&this.setActiveJimuMapView(t,!0))}const e=[];this.state.firstMapDsId&&e.push(this.state.firstMapDsId),this.state.secondMapDsId&&e.push(this.state.secondMapDsId);const t=this.getCurrentVisibleDsId();for(let i=0;i<e.length;i++){const o=`${this.props.baseWidgetProps.id}-${e[i]}`,s=y.MapViewManager.getInstance().getJimuMapViewById(o);s&&(e[i]===t?this.setActiveJimuMapView(s,!0):this.setActiveJimuMapView(s,!1))}},this.isShowMapSwitchBtn=()=>{var e,t;const i=null===(e=this.firstMapInstance)||void 0===e?void 0:e.current,o=null===(t=this.secondMapInstance)||void 0===t?void 0:t.current;return!(!i||!o)&&(i.getMapLoadStatus()!==F.Loading&&o.getMapLoadStatus()!==F.Loading||void 0)},this.getCurrentVisibleDsId=()=>1===this.state.multiMapStyle[0].opacity?this.state.firstMapDsId:this.state.secondMapDsId,this.handleViewGroupCreate=e=>{this.props.onViewGroupCreate&&this.props.onViewGroupCreate(e)},this.firstMapInstance=i.React.createRef(),this.secondMapInstance=i.React.createRef(),this.state={currentMapIndex:0,multiMapStyle:W.firstMapVisible,firstMapDsId:null,secondMapDsId:null,useAnimation:!1,useDataSources:null,currentJimuMapView:null},this.mutableStatePropsMap={},this.useMapWidgetIds=this.props.baseWidgetProps.id?(0,i.Immutable)([this.props.baseWidgetProps.id]):(0,i.Immutable)([])}componentDidMount(){if(!this.isReIniting&&this.props.baseWidgetProps.useDataSources){const e=this.props.baseWidgetProps.jimuMapConfig.initialMapDataSourceID;e?e===(this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId)?this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId}):e===(this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId)?this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId}):this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId}):this.setState({firstMapDsId:this.props.baseWidgetProps.useDataSources[0]&&this.props.baseWidgetProps.useDataSources[0].dataSourceId,secondMapDsId:this.props.baseWidgetProps.useDataSources[1]&&this.props.baseWidgetProps.useDataSources[1].dataSourceId})}}static getDerivedStateFromProps(e,t){if(e.baseWidgetProps.useDataSources!==t.useDataSources){return H.getChangedState(t.firstMapDsId,t.secondMapDsId,e.baseWidgetProps.useDataSources)}return null}componentDidUpdate(e,t,i){this.isReIniting?this.isReIniting=!1:(this.props.baseWidgetProps.jimuMapConfig.initialMapDataSourceID!==e.baseWidgetProps.jimuMapConfig.initialMapDataSourceID&&this.changeInitialMapDataSourceID(this.props.baseWidgetProps.jimuMapConfig.initialMapDataSourceID,this.confirmJimuMapViewIsActive),this.props.baseWidgetProps.useDataSources!==e.baseWidgetProps.useDataSources&&this.confirmJimuMapViewIsActive())}setActiveJimuMapView(e,t){e.isActive!==t&&(t?(e.setIsActive(t),this.setState({currentJimuMapView:e}),this.props.onActiveViewChange&&this.props.onActiveViewChange(e)):e.setIsActive(t))}render(){return(0,n.jsxs)(N.Provider,{value:{isShowMapSwitchBtn:this.props.baseWidgetProps.useDataSources&&this.props.baseWidgetProps.useDataSources.length>1&&this.isShowMapSwitchBtn(),dataSourceIds:[this.state.firstMapDsId,this.state.secondMapDsId],activeDataSourceId:this.getCurrentVisibleDsId(),switchMap:this.switchMap,fullScreenMap:this.props.fullScreenMap,initialMapState:this.props.baseWidgetProps.jimuMapConfig&&this.props.baseWidgetProps.jimuMapConfig.initialMapState,mapComponentId:this.props.baseWidgetProps.id},children:[!this.props.isDefaultMap&&(0,n.jsxs)("div",{className:"jimu-widget",style:{position:"relative"},children:[(0,n.jsx)("div",{className:(0,i.classNames)("jimu-widget",{"multisourcemap-item-appear":this.state.useAnimation&&this.state.multiMapStyle[0].opacity,"multisourcemap-item-disappear":this.state.useAnimation&&!this.state.multiMapStyle[0].opacity,"multisourcemap-item-appear-noanimate":this.state.multiMapStyle[0].opacity,"multisourcemap-item-disappear-noanimate":!this.state.multiMapStyle[0].opacity}),style:{position:"absolute",zIndex:this.state.multiMapStyle[0].zIndex},children:this.state.firstMapDsId&&(0,n.jsx)(B,{ref:this.firstMapInstance,baseWidgetProps:this.props.baseWidgetProps,startLoadModules:this.props.startLoadModules,dataSourceId:this.state.firstMapDsId,mapComponentsLoaded:this.props.mapComponentsLoaded,onViewChanged:this.handleViewChanged,onMapLoaded:this.handleMapLoaded,onMutableStatePropsChanged:this.handleMutableStatePropsChanged,onExtentChanged:(e,t)=>{this.handleExtentChanged(e,t)},onJimuMapViewCreated:this.handleJimuMapViewCreated})}),(0,n.jsx)("div",{className:(0,i.classNames)("jimu-widget",{"multisourcemap-item-appear":this.state.useAnimation&&this.state.multiMapStyle[1].opacity,"multisourcemap-item-disappear":this.state.useAnimation&&!this.state.multiMapStyle[1].opacity,"multisourcemap-item-appear-noanimate":this.state.multiMapStyle[1].opacity,"multisourcemap-item-disappear-noanimate":!this.state.multiMapStyle[1].opacity}),style:{position:"absolute",zIndex:this.state.multiMapStyle[1].zIndex},children:this.state.secondMapDsId&&(0,n.jsx)(B,{ref:this.secondMapInstance,baseWidgetProps:this.props.baseWidgetProps,startLoadModules:this.props.startLoadModules,dataSourceId:this.state.secondMapDsId,mapComponentsLoaded:this.props.mapComponentsLoaded,onViewChanged:this.handleViewChanged,onMapLoaded:this.handleMapLoaded,onMutableStatePropsChanged:this.handleMutableStatePropsChanged,onExtentChanged:(e,t)=>{this.handleExtentChanged(e,t)},onJimuMapViewCreated:this.handleJimuMapViewCreated})})]}),this.props.isDefaultMap&&(0,n.jsx)("div",{className:"jimu-widget",style:{position:"relative"},children:(0,n.jsx)("div",{className:(0,i.classNames)("jimu-widget multisourcemap-item-appear-noanimate"),style:{position:"absolute",zIndex:6},children:(0,n.jsx)(B,{ref:this.firstMapInstance,isDefaultMap:this.props.isDefaultMap,baseWidgetProps:this.props.baseWidgetProps,startLoadModules:this.props.startLoadModules,defaultMapInfo:this.props.defaultMapInfo,dataSourceId:null,mapComponentsLoaded:this.props.mapComponentsLoaded,onViewChanged:this.handleViewChanged,onMapLoaded:this.handleMapLoaded,onMutableStatePropsChanged:this.handleMutableStatePropsChanged,onExtentChanged:(e,t)=>{this.handleExtentChanged(e,t)},onJimuMapViewCreated:this.handleJimuMapViewCreated})})}),(0,n.jsx)(y.JimuMapViewComponent,{useMapWidgetId:this.useMapWidgetIds[0],onViewGroupCreate:this.handleViewGroupCreate})]})}}H.getChangedState=(e,t,i)=>{const o={};if(i&&i[0]){const s=[],a=[];for(let t=0;t<i.length;t++)e!==i[t].dataSourceId?s.push(i[t].dataSourceId):a.push(i[t].dataSourceId);a.length>0?(o.firstMapDsId=e,o.secondMapDsId=s[0]):0===a.length&&(s.includes(t)?(s.splice(s.indexOf(t),1),o.firstMapDsId=s[0],o.secondMapDsId=t):(o.firstMapDsId=s[0],o.secondMapDsId=s[1]))}else o.firstMapDsId=null,o.secondMapDsId=null;return o.firstMapDsId!==e?o.firstMapDsId?(o.multiMapStyle=W.firstMapVisible,o.currentMapIndex=0):o.secondMapDsId?(o.multiMapStyle=W.secondMapVisible,o.currentMapIndex=1):(o.multiMapStyle=W.firstMapVisible,o.currentMapIndex=0):o.secondMapDsId?o.secondMapDsId!==t&&(o.multiMapStyle=W.secondMapVisible,o.currentMapIndex=1):(o.multiMapStyle=W.firstMapVisible,o.currentMapIndex=0),o};const Q=H;function J(e){return!window.jimuConfig.isInBuilder||e!==i.AppMode.Design}class Y extends i.React.PureComponent{constructor(e){super(e),this.handleJimuMapViewCreated=e=>{this.props.onJimuMapViewCreated&&this.props.onJimuMapViewCreated(e)},this.state={defaultMapInfo:null}}componentDidMount(){y.portalUtils.getDefaultWebMap((0,i.getAppStore)().getState().portalUrl).then(e=>{this.setState({defaultMapInfo:e})})}render(){return(0,n.jsxs)("div",{className:"w-100 h-100",children:[!this.state.defaultMapInfo&&(0,n.jsx)("div",{className:"widget-map jimu-widget",children:(0,n.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})}),this.state.defaultMapInfo&&(0,n.jsx)("div",{className:(0,i.classNames)("jimu-widget",{"map-is-design-mode":!J(this.props.baseWidgetProps.appMode)}),children:(0,n.jsx)(Q,{ref:this.props.setMultiSourceMapInstance,fullScreenMap:this.props.fullScreenMap,baseWidgetProps:this.props.baseWidgetProps,startLoadModules:this.props.startLoadModules,mapComponentsLoaded:this.props.mapComponentsLoaded,isDefaultMap:!0,onViewPointChanged:this.props.onViewPointChanged,onExtentChanged:this.props.onExtentChanged,onViewGroupCreate:this.props.onViewGroupCreate,onActiveViewChange:this.props.onActiveViewChange,defaultMapInfo:this.state.defaultMapInfo,onJimuMapViewCreated:this.handleJimuMapViewCreated},0)})]})}}function q(e,t){var i;if(e||(e=""),!t)return"";const o=t.sys.color.primary.main,s=t.sys.spacing(2),a=t.sys.spacing(4);return`\n    ${e}.exbmap-ui-popper {\n      .exbmap-ui-expand-content {\n        transition: opacity 250ms ease-in-out, margin 250ms ease-in-out;\n        min-height: 10px;\n\n        .exbmap-ui-expand-content-header {\n          padding: ${s} ${a} ${s};\n        }\n\n        .panel-title {\n          font-weight: ${null===(i=null==t?void 0:t.ref.typeface)||void 0===i?void 0:i.fontWeightRegular};\n        }\n\n        .panel-icon { /* <-- Need To use the tertiary button */\n          cursor: pointer;\n          &:hover {\n            color: ${o};\n          }\n        }\n\n        .esri-search {\n          padding: 0 ${a} ${a};\n        }\n\n        .esri-widget {\n          font-family: inherit;\n          background-color: transparent;\n          color: inherit;\n        }\n      }\n\n      [data-popper-placement^='bottom'] {\n        margin-top: 4px !important;\n      }\n\n      [data-popper-placement^='left'] {\n        margin-right: 4px !important;\n      }\n\n      [data-popper-placement^='right'] {\n        margin-left: 4px !important;\n      }\n\n      [data-popper-placement^='top'] {\n        margin-bottom: 4px !important;\n      }\n    }\n  `}var $=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};class Z extends i.React.PureComponent{constructor(e){super(e),this.multiSourceMapInstance=null,this.startRenderMap=()=>{setTimeout(()=>{this.setState({startLoadModules:!0})},100)},this.getPlaceHolderImage=()=>{let e=this.props.jimuMapConfig.placeholderImage;if(e){const t=new RegExp("^(.)+/sharing/rest/content/items/(.)+/info/(.)+"),o=i.SessionManager.getInstance().getMainSession();t.test(e)&&o&&(e+=`?token=${null==o?void 0:o.token}`)}return e},this.fullScreenMap=()=>{if(i.utils.isTouchDevice())if("fixed"===this.container.style.position)this.container.style.height=`${this.containerClientRect.height}px`,this.container.style.width=`${this.containerClientRect.width}px`,this.container.style.top=`${this.containerClientRect.top}px`,this.container.style.left=`${this.containerClientRect.left}px`,setTimeout(()=>{this.container.style.transition=null,this.container.style.position="relative",this.container.style.zIndex="0",this.container.style.height="100%",this.container.style.width="100%",this.container.style.top="0",this.container.style.left="0",this.container.style.backgroundColor="none",this.parentContainer.appendChild(this.container)},100);else{const e=this.container.getBoundingClientRect();this.containerClientRect=e,this.container.style.height=`${e.height}px`,this.container.style.width=`${e.width}px`,this.container.style.position="fixed",this.container.style.top=`${e.top}px`,this.container.style.left=`${e.left}px`,g.MobilePanelManager.getInstance().checkDomIsContained(this.container)?this.container.style.zIndex="502":this.container.style.zIndex="105",document&&document.body.appendChild(this.container),setTimeout(()=>{this.container.style.transition="top 0.3s, bottom 0.3s, left 0.3s, right 0.3s, height 0.3s, width 0.3s",this.container.style.top="0px",this.container.style.left="0px",this.container.style.right="0px",this.container.style.bottom="0px",this.container.style.height=null,this.container.style.width=null,this.container.style.backgroundColor="#fff"},100)}else{const e=this.container;if(!document)return;document.fullscreenElement===e&&document.exitFullscreen();const t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if(void 0!==window.ActiveXObject){const e=new ActiveXObject("WScript.Shell");null!==e&&e.SendKeys("{F11}")}}},this.handleViewGroupCreate=e=>{e&&e.setMapWidgetInstance(this),this.props.onViewGroupCreate&&this.props.onViewGroupCreate(e)},this.handleJimuMapViewCreated=e=>{this.props.onJimuMapViewCreated&&this.props.onJimuMapViewCreated(e)},this.switchMap=()=>$(this,void 0,void 0,function*(){if(this.multiSourceMapInstance)return yield this.multiSourceMapInstance.switchMap();yield Promise.resolve()}),this.setMultiSourceMapInstance=e=>{this.multiSourceMapInstance=e},this.state={startLoadModules:!1,mapComponentsLoaded:!1};const t=Math.random().toString().slice(2);this.mapRootClassName=`jimu-map-root-${e.widgetId}-${t}`}componentDidMount(){this.state.startLoadModules||!window.jimuConfig.isInBuilder&&this.props.jimuMapConfig.canPlaceHolder||this.startRenderMap(),(0,i.loadArcGISMapComponents)().then(()=>{this.setState({mapComponentsLoaded:!0})}).catch(e=>{console.error("loadArcGISMapComponents error",e),this.setState({mapComponentsLoaded:!1})})}render(){const e=((e,t)=>{var i;if(!e)return"";const o=`.${t}`,s=e.sys.color.primary.main,a=e.sys.color.action.default,n=null===(i=e.sys.color.action.selected)||void 0===i?void 0:i.default,l=e.sys.color.action.hover,r=e.sys.color.action.text,c=e.sys.color.action.disabled.default,d=e.sys.color.action.disabled.text,p=e.sys.color.action.selected.default,u=e.sys.color.action.selected.hover,h=e.sys.color.action.selected.text,m=e.sys.color.surface.overlay,g=e.sys.color.surface.overlayText,y="rgba(0, 0, 0, 0.2)";return`\n    ${o} {\n      /* Zoom, Home, Locate, Compass */\n      arcgis-zoom, arcgis-home, arcgis-locate, arcgis-compass {\n        --calcite-color-foreground-1: ${a};\n        --calcite-color-text-3: ${r};\n\n        &:hover {\n          --calcite-color-transparent-hover: ${l};\n          --calcite-color-text-1: ${r};\n        }\n      }\n\n      arcgis-zoom[state="disabled"], arcgis-home[state="disabled"], arcgis-locate[state="disabled"], arcgis-compass[state="disabled"] {\n        --calcite-color-foreground-1: ${c};\n        --calcite-color-text-3: ${d};\n\n        &:hover {\n          --calcite-color-transparent-hover: ${c};\n          --calcite-color-text-1: ${d};\n        }\n      }\n\n      /* remove the unexpected focus ring of whole component when child button gets focus */\n      arcgis-zoom, arcgis-compass, arcgis-navigation-toggle, arcgis-search {\n        &:focus, &:focus-visible {\n          outline-width: 0;\n        }\n      }\n\n      arcgis-zoom, arcgis-home, arcgis-locate {\n        --calcite-button-corner-radius: 0px;\n      }\n\n      arcgis-compass {\n        --calcite-button-corner-radius: 50%;\n      }\n\n      /* Toggle */\n      arcgis-navigation-toggle {\n        --calcite-action-corner-radius: 0;\n        --calcite-color-text-3: ${r};\n        --calcite-action-text-color: ${r};\n\n        /* normal */\n        --calcite-color-foreground-1: ${a};\n\n        /* hover */\n        --calcite-action-background-color-hover: ${l};\n\n        /* active */\n        --calcite-color-foreground-3: ${n};\n\n        /* focus */\n        --calcite-offset-invert-focus: 1;\n      }\n\n      /* Search */\n      arcgis-search {\n        /* Use overflow to avoid arcgis-search flickering during initialization */\n        overflow: hidden;\n\n        /* corder radius */\n        --calcite-button-corner-radius: 0;\n        --calcite-corner-radius-sharp: 0;\n        --calcite-corner-radius-round: 0;\n\n        /* left dropdown button with arrow */\n        --calcite-button-background-color: var(--sys-color-action);\n        --calcite-button-text-color: var(--sys-color-action-text);\n\n        /* calcite-autocomplete: input */\n        --calcite-autocomplete-input-background-color: var(--sys-color-action-input-field);\n        --calcite-autocomplete-input-text-color: var(--sys-color-action-input-field-text);\n        --calcite-autocomplete-input-placeholder-text-color: var(--sys-color-action-input-field-text);\n        --calcite-autocomplete-input-actions-background-color: var(--sys-color-action);\n\n        /* calcite-autocomplete: input left search icon */\n        --calcite-autocomplete-input-icon-color: var(--sys-color-action-input-field-text);\n\n        /* calcite-autocomplete: input right clear button */\n        --calcite-autocomplete-input-actions-background-color-hover: var(--sys-color-action-hover);\n        --calcite-autocomplete-input-actions-icon-color: var(--sys-color-action-text);\n        --calcite-autocomplete-input-actions-icon-color-hover: var(--sys-color-action-text);\n\n        /* geocoding service list */\n        --calcite-dropdown-background-color: var(--sys-color-surface-overlay);\n        --calcite-dropdown-item-background-color-hover: ${y};\n        --calcite-dropdown-group-title-text-color: var(--sys-color-surface-overlay-text);\n        --calcite-dropdown-item-text-color-press: var(--sys-color-surface-overlay-text);\n\n        /* search suggestion list */\n        /* --calcite-autocomplete-background-color: var(--sys-color-surface-overlay); */ /* can't used, it also affects list item background color */\n        --calcite-color-foreground-1: ${m}; /* used as list item background color */\n        --calcite-color-foreground-2: ${y}; /* used as list item hover background color */\n        --calcite-autocomplete-text-color: var(--sys-color-surface-overlay-text);\n        --calcite-autocomplete-heading-text-color: var(--sys-color-surface-overlay-text);\n\n        /* focus */\n        &:focus {\n          /* the focus ring of left dropdown button is cut off if arcgisSearch.style.overflow is hidden */\n          overflow: visible;\n        }\n      }\n\n      /* Layers */\n      arcgis-layer-list {\n        --calcite-corner-radius-sharp: 0;\n        --calcite-list-background-color: ${m};\n        --calcite-list-background-color-hover: ${y};\n        --calcite-list-background-color-press: ${y};\n        --calcite-list-label-text-color: ${g};\n      }\n\n      /* Attribution */\n      .esri-attribution.esri-widget {\n        font-size: 12px;\n        color: #323232; /* Original color from API is used here */\n        background-color: rgba(255,255,255,0.65); /* Original color from API is used here */\n      }\n\n      /* Popup */\n      .esri-popup__main-container {\n        /* popup background color */\n        background-color: ${m};\n        --calcite-ui-foreground-1: ${m};\n        --calcite-color-foreground-1: ${m};\n\n        /* popup title color */\n        --calcite-ui-text-2: ${g};\n        --calcite-color-text-2: ${g};\n        --calcite-color-text-1: ${g};\n        .esri-widget__heading.esri-features__heading {\n          color: ${g};\n        }\n\n        /* popup icon color */\n        --calcite-ui-text-3: ${g};\n        --calcite-color-text-3: ${g};\n\n        /* override popup table color */\n        .esri-widget__table {\n          color: ${g};\n        }\n\n        /* select feature list & search result list */\n        --calcite-list-background-color: ${m};\n        --calcite-list-background-color-hover: ${y};\n        --calcite-list-background-color-press: ${y};\n\n        /* search result collapse title */\n        arcgis-search-result-renderer {\n          --calcite-block-header-background-color-hover: ${y};\n          --calcite-block-header-background-color-press: ${y};\n        }\n\n        /* buttons */\n        --calcite-button-text-color: ${g};\n        --calcite-action-background-color-hover: ${y};\n        --calcite-color-foreground-2: ${y};\n        --calcite-action-background-color-press: ${y};\n        --calcite-action-background-color-pressed: ${y};\n        --calcite-action-text-color-press: ${g};\n        --calcite-action-text-color-pressed: ${g};\n\n        .esri-widget {\n          font-family: inherit;\n          background-color: transparent;\n          color: inherit;\n        }\n      }\n      .esri-popup__pointer-direction {\n        background-color: ${m};\n      }\n      .esri-popup__navigation {\n        background: transparent;\n      }\n\n      /* similar like calcite-button.esri-widget--button of esri-widget */\n      .esri-widget--button-like {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        margin: 0;\n        padding: 0;\n        overflow: hidden;\n        width: 32px;\n        height: 32px;\n        cursor: pointer;\n        text-decoration: none;\n        font-style: normal;\n\n        background-color: ${a};\n        color: ${r};\n\n        &:hover {\n          background-color: ${l};\n          color: ${r};\n        }\n\n        &.selected {\n          color: ${h};\n          background-color: ${p};\n        }\n\n        &.selected:hover {\n          color: ${h};\n          background-color: ${u};\n        }\n\n        &.disabled {\n          background-color: ${c};\n          color: ${d};\n        }\n      }\n\n      /* exbmap-ui */\n      .exbmap-ui-tool-shell {\n        box-shadow: 0 1px 2px 0 ${y};\n      }\n      .exbmap-ui-tool,\n      .exbmap-ui-tool-panel {\n        pointer-events: auto;\n        position: relative;\n      }\n\n      /* exbmap-basetool-loader */\n      .exbmap-basetool-loader {\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        width: 100%;\n        animation: esri-fade-in 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:before {\n        background-color: transparent;\n        width: 100%;\n        z-index: 0;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n\n      .exbmap-basetool-loader:after {\n        background-color: ${s};\n        width: 20%;\n        z-index: 0;\n        animation: looping-progresss-bar-ani 1500ms linear infinite;\n        content: "";\n        opacity: 1;\n        position: absolute;\n        height: 2px;\n        top: 0;\n        transition: opacity 500ms ease-in-out;\n      }\n    }\n\n    /* Map widget places map tool popper (both pc popper and mobile panel) at document.body */\n    ${q(o,e)}\n\n    /* JimuMap places map tool popper (both pc popper and fake mobile panel) at JimuMap */\n    ${o} {\n      ${q("",e)}\n    }\n`})(this.props.theme,this.mapRootClassName);return(0,n.jsxs)(i.React.Fragment,{children:[this.renderContent(),(0,n.jsx)(t.Global,{styles:e})]})}renderContent(){const e=(0,i.classNames)(this.props.className,"jimu-widget",this.mapRootClassName);return this.state.startLoadModules?this.props.useDataSources&&this.props.useDataSources[0]&&this.props.useDataSources[0].dataSourceId?(0,n.jsx)("div",{className:e,ref:e=>{this.parentContainer=e},children:(0,n.jsx)("div",{className:(0,i.classNames)(this.props.className,"jimu-widget"),ref:e=>{this.container=e},children:(0,n.jsx)("div",{className:(0,i.classNames)("jimu-widget",{"map-is-design-mode":!J(this.props.appMode)}),children:(0,n.jsx)(Q,{fullScreenMap:this.fullScreenMap,baseWidgetProps:this.props,startLoadModules:this.state.startLoadModules,mapComponentsLoaded:this.state.mapComponentsLoaded,onViewPointChanged:this.props.onViewPointChanged,onExtentChanged:this.props.onExtentChanged,onActiveViewChange:this.props.onActiveViewChange,onViewGroupCreate:this.handleViewGroupCreate,ref:this.setMultiSourceMapInstance,onJimuMapViewCreated:this.handleJimuMapViewCreated})})})}):(0,n.jsx)("div",{className:e,ref:e=>{this.parentContainer=e},children:(0,n.jsx)("div",{className:(0,i.classNames)(this.props.className,"jimu-widget"),ref:e=>{this.container=e},children:(0,n.jsx)("div",{className:(0,i.classNames)("jimu-widget",{"map-is-design-mode":!J(this.props.appMode)}),children:(0,n.jsx)(Y,{fullScreenMap:this.fullScreenMap,baseWidgetProps:this.props,startLoadModules:this.state.startLoadModules,mapComponentsLoaded:this.state.mapComponentsLoaded,isDefaultMap:!0,setMultiSourceMapInstance:this.setMultiSourceMapInstance,onViewPointChanged:this.props.onViewPointChanged,onExtentChanged:this.props.onExtentChanged,onActiveViewChange:this.props.onActiveViewChange,onViewGroupCreate:this.handleViewGroupCreate,onJimuMapViewCreated:this.handleJimuMapViewCreated})})})}):(0,n.jsx)("div",{className:e,children:(0,n.jsx)("div",{className:"widget-map jimu-widget",children:(0,n.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})})})}}const _=i.ReactRedux.connect(e=>window.jimuConfig.isBuilder?{appMode:i.AppMode.Run}:{appMode:e&&e.appRuntimeInfo&&e.appRuntimeInfo.appMode})((0,t.withTheme)((0,i.injectIntl)(Z))),K=(0,t.withStyles)(_,"JimuMap");class X extends i.React.PureComponent{constructor(e){super(e),this.handleClickOk=()=>{const e=this.state.currentJimuMapView;if(!e)return;const t=e.view;if(t&&t.viewpoint&&t.extent){const i=e.dataSourceId?e.dataSourceId:void 0,o=this.props.jimuMapConfig.setIn(["initialMapState","viewPoint"],t.viewpoint.toJSON()).setIn(["initialMapState","extent"],t.extent.toJSON()).setIn(["initialMapState","rotation"],t.viewpoint.rotation).setIn(["initialMapState","viewType"],t.type).setIn(["initialMapDataSourceID"],i);this.props.onConfigChanged&&this.props.onConfigChanged(o),this.setState({isShowDialog:!1})}},this.handleClickClose=()=>{this.setState({isShowDialog:!1})},this.showDialog=()=>{this.setState({isShowDialog:!0})},this.handleActiveViewChange=e=>{this.setState({currentJimuMapView:e})},this.getWidgetSize=()=>{const e=this.querySelector(`div.widget-renderer[data-widgetid="${this.props.id}"]`);let t=null;if(e){const i=e.getBoundingClientRect();t={width:i.width,height:i.height};const o=t.width+100,s=t.height+200;if(document.body.clientWidth>=o&&document.body.clientHeight>=s)return t}else t={width:document.body.clientWidth-100,height:document.body.clientHeight-300};return this.getRightSize(t)},this.getRightSize=e=>{const t=document.body.clientWidth-100<1280?document.body.clientWidth-100:1280,i=document.body.clientHeight-300<800?document.body.clientHeight-300:800;if(t/i>=e.width/e.height){const t=i;return{width:t*e.width/e.height,height:t}}return{width:t,height:t*e.height/e.width}},this.state={isShowDialog:!1,currentJimuMapView:null}}querySelector(e){const t=document.querySelector(`iframe[name="${i.APP_FRAME_NAME_IN_BUILDER}"]`);if(t){return(t.contentDocument||t.contentWindow.document).querySelector(e)}return null}getGlobalStyle(){return i.css`
      .map-states-editor-alert-popup {
        justify-content: center;
        max-width: max-content !important;
      }
    `}render(){let e=null;e=this.props.isUseWidgetSize?this.getWidgetSize():this.getRightSize({width:document.body.clientWidth-100,height:document.body.clientHeight-300});const o=this.props.jimuMapConfig?this.props.jimuMapConfig.set("toolConfig",{canZoom:!0,canHome:!0,canSearch:!0,canCompass:!0}):(0,i.Immutable)({});return(0,n.jsxs)("div",{css:this.getGlobalStyle(),children:[(0,n.jsx)(t.Global,{styles:this.getGlobalStyle()}),(0,n.jsx)(g.Button,{size:"sm",onClick:this.showDialog,children:this.props.buttonLabel}),this.state.isShowDialog&&(0,n.jsx)(g.AlertPopup,{className:"map-states-editor-alert-popup",isOpen:this.state.isShowDialog,title:this.props.title,onClickOk:()=>{this.handleClickOk()},onClickClose:()=>{this.handleClickClose()},children:(0,n.jsx)("div",{style:{width:`${e&&e.width}px`,height:`${e&&e.height}px`},children:(0,n.jsx)("div",{className:"w-100 h-100",style:{backgroundColor:"gray"},children:(0,n.jsx)(K,{id:this.props.id+"editor",useDataSources:this.props.useDataSources,jimuMapConfig:o,onActiveViewChange:e=>{this.handleActiveViewChange(e)}})})})})]})}}const ee=(e,t)=>isNaN(e)?0:Number(Number(e).toFixed(t)),te=e=>{if(e){const t=e.toRgba();return`rgba(${t[0]},${t[1]},${t[2]},${parseFloat(Number(t[3]).toFixed(3))})`}return null},ie=e=>{const t=(null==e?void 0:e.clone()).color;return(null==t?void 0:t.a)||0},oe=(e,t)=>{var o,s;const a=i.utils.formatPercentageNumber(t);return null!==(s=null===(o=(0,i.getAppStore)().getState().appContext)||void 0===o?void 0:o.isRTL)&&void 0!==s&&s?a+": "+e:e+": "+a};const se=e=>{const t=[];var i,o;return t[0]=e.r,t[1]=e.g,t[2]=e.b,t[3]=(e.a-(i=0))*(255-(o=0))/(1-i)+o,t},ae=e=>{const t=[];return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=Number(e[3]/255).toFixed(3),t},ne=e=>{var t,i,o;let s=null===(t=null==e?void 0:e.font)||void 0===t?void 0:t.family;return"bold"===(null===(i=null==e?void 0:e.font)||void 0===i?void 0:i.weight)&&(s+=" Bold"),"italic"===(null===(o=null==e?void 0:e.font)||void 0===o?void 0:o.style)&&(s+=" Italic"),s.toLocaleLowerCase().includes("bold")||s.toLocaleLowerCase().includes("italic")||(s+=" Regular"),s},le=(e,t)=>{const o=(0,g.getButtonIconSizeNumber)(t);return i.css`
  position: relative;

  &.symbol-item {
    .icon-btn-sizer { /* inner wrapper in jimu-btn*/
      width: 100%;
      height: 100%;
    }
  }

  &.inner-preview {
    cursor: default !important;
    max-height: 32px;
  }
  &.inner-preview.has-text-symbol {
    max-height: unset;
  }

  &.symbol-in-list {
    border: none;
  }

  &.selector-previewer {
    .icon-btn-sizer {
      width: ${o}px;
      height: ${o}px;
    }
  }

  &.symbol-item-active {
    border: 1px solid ${e.sys.color.primary.main};
  }

  .symbol-wrapper {
    width: 100%;
    height: 100%;

    .outer-preview-btn {
      max-width: ${o}px;
      max-height: ${o}px;
    }
    .inner-preview-btn {
      width: ${o}px;
      height: ${o}px;
    }

    /* Only FireFox cut off text icon preview ,#Extensions/issues/23107 */
    text {
      white-space: pre;
    }
  }
  /* scale display of polyline-symbol ,#13458 */
  .jimu-polyline-symbol {
    width: 200%;
    transform: scaleX(0.5);
  }
  /* align text preview ,#Extensions/issues/22518, #27244 */
  .jimu-text-symbol {
    margin-left: 2px;
  }
  `};var re=r(48013),ce=r.n(re),de=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i};const pe=e=>{const t=window.SVG,{className:o}=e,s=de(e,["className"]),a=(0,i.classNames)("jimu-icon jimu-icon-component",o);return t?(0,n.jsx)(t,Object.assign({className:a,src:ce()},s)):(0,n.jsx)("svg",Object.assign({className:a},s))};class ue extends i.React.PureComponent{constructor(e){super(e),this.symbolUtils=null,this.Color=null,this.ApiSyncRenderSymbolFlag=!1,this.renderPreviewHTMLPromise=null,this.innerIconWH=16,this.onHandleSymbolClick=()=>{this.props.onClick&&(this.props.isActive?this.props.onClick(null,null):this.props.onClick(this.props.index,this.props.symbol))},this.state={symbolLoading:!0,apiLoaded:!1}}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/symbols/support/symbolUtils","esri/Color"]).then(e=>{[this.symbolUtils,this.Color]=e,this.setState({apiLoaded:!0})})}componentDidUpdate(e,t){var o,s;this.innerIconWH=(0,g.getButtonIconSizeNumber)(this.props.btnSize||"default"),this.state.apiLoaded&&this.props.symbol&&(this.ApiSyncRenderSymbolFlag&&i.lodash.isDeepEqual(null===(o=e.symbol)||void 0===o?void 0:o.toJSON(),null===(s=this.props.symbol)||void 0===s?void 0:s.toJSON())||(this.ApiSyncRenderSymbolFlag=!0,this.btnContainerRef.innerHTML&&(this.btnContainerRef.innerHTML=""),this.setState({symbolLoading:!0},()=>{const e={node:this.btnContainerRef,scale:!0,size:{width:2*this.innerIconWH,height:"text"===this.props.symbol.type?12:3}},t=((e,t)=>{if(!e||"text"!==e.type)return e;const i=e.clone();return i.text=" Aa ",i.angle=0,i.font.size=16,i.backgroundColor||(i.backgroundColor=new t([255,255,255,0])),i})(this.props.symbol,this.Color);this.renderPreviewHTMLPromise=this.symbolUtils.renderPreviewHTML(t,e),this.renderPreviewHTMLPromise.then(e=>{var t;const i=Array.from(e.children);if((null==i?void 0:i.length)>1){i.slice(0,-1).forEach(t=>e.removeChild(t))}const o=e.children[0],s="0,0,"+parseFloat(null==o?void 0:o.getAttribute("width"))+","+parseFloat(null==o?void 0:o.getAttribute("height"));if(o&&"text"!==this.props.symbol.type&&(null==o||o.setAttribute("viewBox",s)),null===(t=this.props.symbol)||void 0===t?void 0:t.type.includes("picture-marker")){null==o||o.setAttribute("style","width: 100%; height: 100%;");const e=null==o?void 0:o.querySelector("image");null==e||e.setAttribute("style","width: 100%; height: 100%;"),null==e||e.setAttribute("preserveAspectRatio","")}this.setState({symbolLoading:!1})})})))}render(){var e,t;const o=null===(e=this.props.a11yNeedFocus)||void 0===e||e?"button":"div",s=(null===(t=this.props.symbol)||void 0===t?void 0:t.type)===Ae.Text.toLocaleLowerCase();return(0,n.jsxs)(g.Button,{tag:o,onClick:this.onHandleSymbolClick,className:(0,i.classNames)("w-100 h-100 justify-content-center d-flex align-items-center symbol-item",{"symbol-item-active":this.props.isActive,"symbol-in-list":!this.props.isSelectorPreview,"selector-previewer":this.props.isSelectorPreview,"inner-preview":this.props.isInnerPreviewBtn,"has-text-symbol":s}),css:le(this.props.theme,this.props.btnSize||"default"),size:this.props.btnSize,ref:this.props.btnRef,type:"tertiary",disableHoverEffect:this.props.isInnerPreviewBtn,disableRipple:this.props.isInnerPreviewBtn,icon:!0,children:[this.state.symbolLoading&&(0,n.jsx)(pe,{color:this.props.theme.ref.palette.neutral[600]}),(0,n.jsx)("div",{ref:e=>{this.btnContainerRef=e},css:{width:this.innerIconWH,height:this.innerIconWH},className:(0,i.classNames)("justify-content-center align-items-center symbol-wrapper",{"outer-preview-btn":this.props.isSelectorPreview,"d-flex":!this.state.symbolLoading,"d-none":this.state.symbolLoading,"jimu-polyline-symbol":this.props.jimuSymbolType===Ae.Polyline,"jimu-text-symbol":s})})]})}}const he=ue,me=(i.React.forwardRef((e,t)=>(0,n.jsx)(he,Object.assign({btnRef:t},e))),i.React.memo(e=>{const o=(0,t.useTheme)(),s=(0,i.useIntl)();return(0,n.jsxs)("div",{className:"jimu-symbol-list-preview w-100 d-flex mb-1",children:[(0,n.jsx)("div",{className:"justify-content-start d-flex align-items-center mr-5",children:s.formatMessage({id:"drawToolPreview",defaultMessage:g.defaultMessages.drawToolPreview})}),(0,n.jsx)("div",{className:"preview-item justify-content-center d-flex mt-1 mb-1 ml-4",children:(0,n.jsx)(he,{theme:o,jimuSymbolType:null,symbol:e.symbol,isInnerPreviewBtn:!0,a11yNeedFocus:!1})})]})})),ge={Point:(null,{type:"esriSMS",color:[0,0,128,128],angle:0,xoffset:0,yoffset:0,size:18,style:"esriSMSCircle",outline:{type:"esriSLS",color:[0,0,128,255],width:1,style:"esriSLSSolid"}}),Polyline:(null,{color:[130,130,130,255],style:"esriSLSSolid",type:"esriSLS",width:2}),Polygon:(null,{color:[150,150,150,51],outline:{color:[50,50,50,255],style:"esriSLSSolid",type:"esriSLS",width:2},style:"esriSFSSolid",type:"esriSFS"}),Text:(null,{type:"esriTS",text:"Enter text",font:{family:"Arial",size:22,style:"normal",weight:"normal"},color:[0,0,0,255],haloColor:[255,255,255,255],haloSize:1})},ye=()=>{const e=(0,i.useIntl)().formatMessage({id:"drawToolTextPlaceholder",defaultMessage:g.defaultMessages.drawToolTextPlaceholder}),[t,o]=i.React.useState(null);i.hooks.useEffectOnce(()=>{(0,i.loadArcGISJSAPIModules)(["esri/symbols/support/jsonUtils"]).then(e=>{const[t]=e;o({jsonUtils:t})})});return i.React.useCallback((i,o)=>{let s;return s=(null==t?void 0:t.jsonUtils)&&!i?((e,t,i)=>{let o=null;switch(e){case Ae.Point:o=null==t?void 0:t.fromJSON(ge.Point);break;case Ae.Polyline:o=null==t?void 0:t.fromJSON(ge.Polyline);break;case Ae.Polygon:o=null==t?void 0:t.fromJSON(ge.Polygon);break;case Ae.Text:o=null==t?void 0:t.fromJSON(ge.Text),i&&(o.text=i);break;default:o=null}return o})(o,null==t?void 0:t.jsonUtils,e):i,s},[null==t?void 0:t.jsonUtils,e])},Se=i.React.memo(e=>{const t=isNaN(e.opacityPercentage)?"":e.opacityPercentage;return(0,n.jsxs)("div",{className:"d-flex style-setting--input-unit",css:i.css`
        &.style-setting--input-unit {

          border-radius: 2px;
          height: 26px;
          flex-grow: 1;
          z-index: 0;

          &:focus-within {
            z-index: 1;
          }

          input {
            width: 45px;
            height: 100%;
            font-size: 12px;
            padding: 0;
            text-align: center;
          }
          .style-setting--unit-selector {
            background: var(--ref-palette-neutral-300);
            color: var(--ref-palette-neutral-700);
            height: 26px;
            width: auto;
            min-width: 0;
            padding: 0;
            margin-left: 0;
            font-size: 12px;

            border: 1px solid var(--ref-palette-neutral-500);
            border-top-right-radius: 2px;
            border-bottom-right-radius: 2px;

            width: 26px;
            margin-left: -1px;
            z-index: -1;
          }
        }
      `,children:[(0,n.jsx)("div",{className:"numeric-input",children:(0,n.jsx)(g.NumericInput,{size:"sm",min:0,max:100,required:!0,precision:0,value:t,showHandlers:!1,onChange:t=>{const i=ee(t,1)/100;if("symbol"===e.mode){const t=e.symbol.clone();t.color.a=i,e.onSymbolChanged(t)}else e.onValueChanged(i)}})}),(0,n.jsx)("div",{className:"d-flex align-items-center justify-content-center style-setting--unit-selector",children:"%"})]})});var Me=r(54337),fe=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};class be extends i.React.PureComponent{constructor(e){super(e),this.jsonUtils=null,this.Portal=null,this.portal=null,this.portalUrl=null,this.allPointSymbolList={},this.setInitialPointSymbolList=e=>{if(e){const t="Basic";let i=!1;for(let o=0;o<e.length;o++)if(e[o].title===t){this.fetchPointSymbolListByItemId(e[o].id),i=!0;break}!i&&e&&e.length>0&&this.fetchPointSymbolListByItemId(e[0].id)}},this.handleSymbolSelected=(e,t)=>{this.setState({symbolSelectedInfo:{listItemId:this.state.currentPointSymbolListItemId,symbolIdx:e}}),this.props.onSymbolChanged(t)},this._isSymbolItemSelected=e=>{const t=this.state.currentPointSymbolListItemId===this.state.symbolSelectedInfo.listItemId,i=e===this.state.symbolSelectedInfo.symbolIdx;return t&&i},this.renderPointSymbolList=()=>{var e;return this.jsonUtils?this.state.showLoadingUI?(0,n.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"}):null===(e=this.state.pointSymbolList)||void 0===e?void 0:e.map((e,t)=>{const i=this.jsonUtils.fromJSON(e);return(0,n.jsx)("div",{className:"symbol-item-wrapper mt-1",children:(0,n.jsx)(he,{theme:this.props.theme,jimuSymbolType:Ae.Point,index:t,symbol:i,isActive:this._isSymbolItemSelected(t),onClick:this.handleSymbolSelected})},t)}):null},this.fetchSymbolSetInfos=()=>fe(this,void 0,void 0,function*(){return this.state.symbolSetInfos&&this.state.symbolSetInfos.length>0?yield Promise.resolve(this.state.symbolSetInfos):yield this.getSymbolSetGroupId().then(e=>fe(this,void 0,void 0,function*(){return yield this.getSymbolSetInfos(e).then(e=>fe(this,void 0,void 0,function*(){return yield Promise.resolve(e)}))}))}),this.getSymbolSetGroupId=()=>fe(this,void 0,void 0,function*(){return this.portal?yield this.portal.queryGroups({query:this.portal.symbolSetsGroupQuery,disableExtraQuery:!0}).then(e=>fe(this,void 0,void 0,function*(){const t=e.results[0];return yield Promise.resolve(t.id)}),()=>fe(this,void 0,void 0,function*(){return yield Promise.reject(new Error(null))})):yield Promise.reject(new Error(null))}),this.getSymbolSetInfos=e=>fe(this,void 0,void 0,function*(){let t="group:"+e+' AND type:"Symbol Set"';const i=[];return this.portal?(t+=' AND (typekeywords:"by value" AND typekeywords:"marker")',yield this.portal.queryItems({query:t,num:20,sortField:"title",disableExtraQuery:!0}).then(e=>fe(this,void 0,void 0,function*(){const t=e.results;let o,s,a,n;if(t){for(let e=0;e<t.length;e++){const l=t[e];o=l.typeKeywords.join(" "),o.indexOf("marker")>-1&&(s=l.title,a={name:s,id:l.id,title:l.title,keywords:o,dataUrl:this.getItemUrl(this.portalUrl,l.id)},n=o.indexOf("default")>-1,n?(a.defaultType=!0,i.unshift(a)):i.push(a))}return yield Promise.resolve(i)}return yield Promise.reject(new Error(null))}))):yield Promise.resolve(null)}),this.onSelectChanged=e=>{const t=e.target.value;this.fetchPointSymbolListByItemId(t)},this.fetchPointSymbolListByItemId=e=>{this.allPointSymbolList[e]?this.setState({pointSymbolList:this.allPointSymbolList[e],currentPointSymbolListItemId:e}):(this.setState({pointSymbolList:[],currentPointSymbolListItemId:e}),this.requestPointSymJson(e))},this.requestPointSymJson=e=>{this.setState({showLoadingUI:!0});const t=this.getItemUrl(this.portalUrl,e);i.esri.restRequest.request(t).then(t=>{this.allPointSymbolList[e]=t,this.setState({pointSymbolList:t,showLoadingUI:!1})},e=>{console.error(e),this.setState({showLoadingUI:!1})})},this.getItemUrl=(e,t)=>{let i="";const o=this.getBaseItemUrl(e);return o&&t&&(i=o+"/"+t+"/data"),i},this.getBaseItemUrl=e=>{let t="";const i=this.portalUrl;return i&&(t=i+"/sharing/rest/content/items"),t},this.getPointSymbolParamsSetting=()=>this.props.symbol?"simple-marker"===this.props.symbol.type?this.getPointSymbolParamsSettingForSimpleMarker():"picture-marker"===this.props.symbol.type?this.getPointSymbolParamsSettingForPictureMarker():null:null,this.updateSymbolSize=e=>{const t=this.props.symbol.clone();"simple-marker"===t.type&&(t.size=e),"picture-marker"===t.type&&(t.width=e,t.height=e),this.props.onSymbolChanged(t)},this.updateSymbolFillColor=e=>{const t=this.props.symbol.clone();t.color=e,this.props.onSymbolChanged(t)},this.updateSymbolOutLineColor=e=>{const t=this.props.symbol.clone();t.outline.color=e,this.props.onSymbolChanged(t)},this.updateSymbolOutLineWeight=e=>{const t=this.props.symbol.clone();t.outline.width=e,this.props.onSymbolChanged(t)},this.updateSymbolOpacity=e=>{const t=this.props.symbol.clone();t.color.a=ee(e,1),this.props.onSymbolChanged(t)},this.getPointSymbolParamsSettingForSimpleMarker=()=>{const e=this.props.symbol,t=e.outline,o=te(t.color),s=t.width,a="x"===e.style||"cross"===e.style,l=ie(this.props.symbol),r=(100*l).toFixed(1),c=this.props.intl.formatMessage({id:"drawToolOpacity",defaultMessage:g.defaultMessages.drawToolOpacity}),d=oe(c,r);return(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)("div",{className:"params-setting-row-one w-100 d-flex align-items-center justify-content-between mb-2",children:[(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:60},min:1,max:50,required:!0,value:e.size,onChange:this.updateSymbolSize}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)("div",{style:{position:"relative"},children:(0,n.jsx)(Me.ColorPicker,{disabled:a,color:te(e.color),onChange:this.updateSymbolFillColor})}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)("div",{style:{position:"relative"},children:(0,n.jsx)(Me.ColorPicker,{color:o,onChange:this.updateSymbolOutLineColor,outline:!0})}),(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:60},min:1,max:20,required:!0,value:s,onChange:this.updateSymbolOutLineWeight})]}),(0,n.jsxs)("div",{className:"params-setting-row-two w-100 d-flex align-items-center justify-content-between pt-1",children:[(0,n.jsx)(g.Slider,{title:d,value:l,min:0,max:1,step:.1,className:"slider mr-2",onChange:e=>{this.updateSymbolOpacity(e.currentTarget.value)}}),(0,n.jsx)(Se,{mode:"symbol",symbol:this.props.symbol,opacityPercentage:Number(r),onSymbolChanged:this.props.onSymbolChanged})]})]})},this.getPointSymbolParamsSettingForPictureMarker=()=>{const e=this.props.symbol;return(0,n.jsx)("div",{className:"w-100 d-flex align-items-center",children:(0,n.jsx)(g.NumericInput,{style:{width:80},size:"sm",min:1,max:50,required:!0,value:e.width,onChange:this.updateSymbolSize})})},this.state={apiLoaded:!1,symbolSetInfos:[],pointSymbolList:[],currentPointSymbolListItemId:null,symbolSelectedInfo:{listItemId:null,symbolIdx:null},showLoadingUI:!0},this.portalUrl=i.portalUrlUtils.getPlatformUrlByOrgUrl((0,i.getAppStore)().getState().portalUrl)}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/symbols/support/jsonUtils","esri/portal/Portal"]).then(e=>{[this.jsonUtils,this.Portal]=e,this.portal=new this.Portal({url:this.portalUrl}),this.setState({apiLoaded:!0},()=>{"function"==typeof this.props.onA11yFocus&&this.props.onA11yFocus()})})}componentDidUpdate(e,t){!t.apiLoaded&&this.state.apiLoaded&&this.portal.load().then(()=>{this.fetchSymbolSetInfos().then(e=>{this.setState({symbolSetInfos:e},()=>{this.setInitialPointSymbolList(this.state.symbolSetInfos)})})})}render(){const e=this.props.intl.formatMessage({id:"drawToolSource",defaultMessage:g.defaultMessages.drawToolSource});return(0,n.jsxs)("div",{className:"w-100 ",children:[(0,n.jsxs)("div",{className:"d-flex w-100 justify-content-between align-items-center mb-4",children:[(0,n.jsx)("div",{className:"mr-5 keep-line",children:e}),(0,n.jsx)(g.Select,{className:"ml-5 p-1 points-source-selector","aria-label":e,onChange:this.onSelectChanged,value:this.state.currentPointSymbolListItemId,children:this.state.symbolSetInfos.map((e,t)=>(0,n.jsx)("option",{value:e.id,title:e.title,children:(0,n.jsxs)("div",{className:"text-truncate",children:[" ",e.title," "]})},t))})]}),(0,n.jsx)("div",{className:"symbol-list-wrapper p-1 mb-4",children:this.renderPointSymbolList()}),(0,n.jsx)("div",{className:"params-settings w-100",children:this.getPointSymbolParamsSetting()})]})}}const we=[{tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},{tags:["solid"],title:"Red Thin",style:"esriSLSSolid",color:[192,80,77,255],width:3,name:"Red 1",type:"esriSLS"},{tags:["solid"],title:"Olive Green Thin",style:"esriSLSSolid",color:[155,187,89,255],width:3,name:"Olive Green 1",type:"esriSLS"},{tags:["solid"],title:"Purple Thin",style:"esriSLSSolid",color:[128,100,162,255],width:3,name:"Purple 1",type:"esriSLS"},{tags:["solid","blue","river"],title:"Aqua Thin",style:"esriSLSSolid",color:[75,172,198,255],width:3,name:"Aqua 1",type:"esriSLS"},{tags:["solid"],title:"Orange Thin",style:"esriSLSSolid",color:[247,150,70,255],width:3,name:"Orange 1",type:"esriSLS"},{tags:["solid"],title:"Blue",style:"esriSLSSolid",color:[79,129,189,255],width:5,name:"Blue 2",type:"esriSLS"},{tags:["solid"],title:"Red",style:"esriSLSSolid",color:[192,80,77,255],width:5,name:"Red 2",type:"esriSLS"},{tags:["solid"],title:"Olive Green",style:"esriSLSSolid",color:[155,187,89,255],width:5,name:"Olive Green 2",type:"esriSLS"},{tags:["solid"],title:"Purple",style:"esriSLSSolid",color:[128,100,162,255],width:5,name:"Purple 2",type:"esriSLS"},{tags:["solid","blue"],title:"Aqua",style:"esriSLSSolid",color:[75,172,198,255],width:5,name:"Aqua 2",type:"esriSLS"},{tags:["solid"],title:"Orange",style:"esriSLSSolid",color:[247,150,70,255],width:5,name:"Orange 2",type:"esriSLS"},{tags:["solid"],title:"Blue Thick",style:"esriSLSSolid",color:[79,129,189,255],width:7,name:"Blue 3",type:"esriSLS"},{tags:["solid","interstate","highway"],title:"Red Thick",style:"esriSLSSolid",color:[192,80,77,255],width:7,name:"Red 3",type:"esriSLS"},{tags:["solid"],title:"Olive Green Thick",style:"esriSLSSolid",color:[155,187,89,255],width:7,name:"Olive Green 3",type:"esriSLS"},{tags:["solid"],title:"Purple Thick",style:"esriSLSSolid",color:[128,100,162,255],width:7,name:"Purple 3",type:"esriSLS"},{tags:["solid","blue"],title:"Aqua Thick",style:"esriSLSSolid",color:[75,172,198,255],width:7,name:"Aqua 3",type:"esriSLS"},{tags:["solid"],title:"Orange Thick",style:"esriSLSSolid",color:[247,150,70,255],width:7,name:"Orange 3",type:"esriSLS"},{tags:["dashed"],title:"Blue Dash",style:"esriSLSDash",color:[79,129,189,255],width:3,name:"ColoredLineBlue4",type:"esriSLS"},{tags:["dashed"],title:"Red Dash",style:"esriSLSDash",color:[192,80,77,255],width:3,name:"ColoredLineRed4",type:"esriSLS"},{tags:["dashed"],title:"Olive Green Dash",style:"esriSLSDash",color:[155,187,89,255],width:3,name:"ColoredLineOliveGreen4",type:"esriSLS"},{tags:["dashed"],title:"Purple Dash ",style:"esriSLSDash",color:[128,100,162,255],width:3,name:"ColoredLinePurple4",type:"esriSLS"},{tags:["blue","dashed"],title:"Aqua Dash",style:"esriSLSDash",color:[75,172,198,255],width:3,name:"ColoredLineAqua4",type:"esriSLS"},{tags:["dashed"],title:"Orange Dash",style:"esriSLSDash",color:[247,150,70,255],width:3,name:"ColoredLineOrange4",type:"esriSLS"},{tags:["dotted"],title:"Blue Dot",style:"esriSLSDot",color:[79,129,189,255],width:3,name:"Blue Dot",type:"esriSLS"},{tags:["dotted"],title:"Red Dot",style:"esriSLSDot",color:[192,80,77,255],width:3,name:"Red Dot",type:"esriSLS"},{tags:["dotted"],title:"Olive Green Dot",style:"esriSLSDot",color:[155,187,89,255],width:3,name:"Olive Green Dot",type:"esriSLS"},{tags:["dotted"],title:"Purple Dot ",style:"esriSLSDot",color:[128,100,162,255],width:3,name:"Purple Dot",type:"esriSLS"},{tags:["blue","dotted"],title:"Aqua Dot",style:"esriSLSDot",color:[75,172,198,255],width:3,name:"Aqua Dot",type:"esriSLS"},{tags:["dotted"],title:"Orange Dot",style:"esriSLSDot",color:[247,150,70,255],width:3,name:"Orange Dot",type:"esriSLS"},{tags:["dashed","dotted"],title:"Blue Dash Dot",style:"esriSLSDashDot",color:[79,129,189,255],width:3,name:"Blue Dash Dot",type:"esriSLS"},{tags:["dashed","dotted"],title:"Red Dash Dot",style:"esriSLSDashDot",color:[192,80,77,255],width:3,name:"Red Dash Dot",type:"esriSLS"},{tags:["dashed","dotted"],title:"Olive Green Dash Dot",style:"esriSLSDashDot",color:[155,187,89,255],width:3,name:"Olive Green Dash Dot",type:"esriSLS"},{tags:["dashed","dotted"],title:"Purple Dash Dot ",style:"esriSLSDashDot",color:[128,100,162,255],width:3,name:"Purple Dash Dot",type:"esriSLS"},{tags:["blue","dashed","dotted"],title:"Aqua Dash Dot",style:"esriSLSDashDot",color:[75,172,198,255],width:3,name:"Aqua Dash Dot",type:"esriSLS"},{tags:["dashed","dotted"],title:"Orange Dash Dot",style:"esriSLSDashDot",color:[247,150,70,255],width:3,name:"Orange Dash Dot",type:"esriSLS"},{tags:["dashed","dotted"],title:"Blue Dash Dot Dot",style:"esriSLSDashDotDot",color:[79,129,189,255],width:3,name:"ColoredLineBlue5",type:"esriSLS"},{tags:["dashed","dotted"],title:"Red Dash Dot Dot",style:"esriSLSDashDotDot",color:[192,80,77,255],width:3,name:"ColoredLineRed5",type:"esriSLS"},{tags:["dashed","dotted"],title:"Olive Green Dash Dot Dot",style:"esriSLSDashDotDot",color:[155,187,89,255],width:3,name:"ColoredLineOliveGreen5",type:"esriSLS"},{tags:["dashed","dotted"],title:"Purple Dash Dot Dot ",style:"esriSLSDashDotDot",color:[128,100,162,255],width:3,name:"ColoredLinePurple5",type:"esriSLS"},{tags:["blue"],title:"Aqua Dash Dot Dot",style:"esriSLSDashDotDot",color:[75,172,198,255],width:3,name:"ColoredLineAqua5",type:"esriSLS"},{tags:["dashed","dotted"],title:"Orange Dash Dot Dot",style:"esriSLSDashDotDot",color:[247,150,70,255],width:3,name:"ColoredLineOrange5",type:"esriSLS"},{tags:["solid"],title:"Black",style:"esriSLSSolid",color:[0,0,0,255],width:3,name:"Gray 1",type:"esriSLS"},{tags:["solid"],title:"Gray 80",style:"esriSLSSolid",color:[51,51,51,255],width:3,name:"Gray 2",type:"esriSLS"},{tags:["solid"],title:"Gray 60",style:"esriSLSSolid",color:[119,119,119,255],width:3,name:"Gray 3",type:"esriSLS"},{tags:["solid"],title:"Gray 40",style:"esriSLSSolid",color:[187,187,187,255],width:3,name:"Gray 4",type:"esriSLS"},{tags:["solid"],title:"Gray 20",style:"esriSLSSolid",color:[221,221,221,255],width:3,name:"Gray 5",type:"esriSLS"},{tags:["solid"],title:"White",style:"esriSLSSolid",color:[255,255,255,255],width:3,name:"Gray 6",type:"esriSLS"},{tags:["green","solid"],title:"Lime",style:"esriSLSSolid",color:[0,255,0,255],width:5,name:"Lime",type:"esriSLS"},{tags:["solid"],title:"Brown",style:"esriSLSSolid",color:[165,42,42,255],width:5,name:"Brown",type:"esriSLS"},{tags:["solid"],title:"Green",style:"esriSLSSolid",color:[0,128,0,255],width:5,name:"Green",type:"esriSLS"},{tags:["solid"],title:"Yellow",style:"esriSLSSolid",color:[255,255,0,255],width:5,name:"Yellow",type:"esriSLS"},{tags:["blue","solid"],title:"Navy",style:"esriSLSSolid",color:[0,0,128,255],width:5,name:"Navy",type:"esriSLS"}],ve=[{intl:"Dash",label:"dash",value:"dash",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 1.5H38.75" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="7 7"/></svg>'},{intl:"DashDot",label:"dash dot",value:"dash-dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H5.9375C6.48978 0.5 6.9375 0.947715 6.9375 1.5C6.9375 2.05228 6.48978 2.5 5.9375 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM10.3125 1.5C10.3125 0.947715 10.7602 0.5 11.3125 0.5H12.6875C13.2398 0.5 13.6875 0.947715 13.6875 1.5C13.6875 2.05228 13.2398 2.5 12.6875 2.5H11.3125C10.7602 2.5 10.3125 2.05228 10.3125 1.5ZM17 1.5C17 0.947715 17.4477 0.5 18 0.5H22.6875C23.2398 0.5 23.6875 0.947715 23.6875 1.5C23.6875 2.05228 23.2398 2.5 22.6875 2.5H18C17.4477 2.5 17 2.05228 17 1.5ZM27.0625 1.5C27.0625 0.947715 27.5102 0.5 28.0625 0.5H29.4375C29.9898 0.5 30.4375 0.947715 30.4375 1.5C30.4375 2.05228 29.9898 2.5 29.4375 2.5H28.0625C27.5102 2.5 27.0625 2.05228 27.0625 1.5ZM34 0.5C33.4477 0.5 33 0.947715 33 1.5C33 2.05228 33.4477 2.5 34 2.5H38.6875C39.2398 2.5 39.6875 2.05228 39.6875 1.5C39.6875 0.947715 39.2398 0.5 38.6875 0.5H34Z" fill="black"/></svg>'},{intl:"Dot",label:"dot",value:"dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H1.78571C2.338 0.5 2.78571 0.947715 2.78571 1.5C2.78571 2.05228 2.338 2.5 1.78571 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM12.2143 1.5C12.2143 0.947715 12.662 0.5 13.2143 0.5H14.2857C14.838 0.5 15.2857 0.947715 15.2857 1.5C15.2857 2.05228 14.838 2.5 14.2857 2.5H13.2143C12.662 2.5 12.2143 2.05228 12.2143 1.5ZM24.7143 1.5C24.7143 0.947715 25.162 0.5 25.7143 0.5H26.7857C27.338 0.5 27.7857 0.947715 27.7857 1.5C27.7857 2.05228 27.338 2.5 26.7857 2.5H25.7143C25.162 2.5 24.7143 2.05228 24.7143 1.5ZM37.2143 1.5C37.2143 0.947715 37.662 0.5 38.2143 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H38.2143C37.662 2.5 37.2143 2.05228 37.2143 1.5Z" fill="black"/></svg>'},{intl:"LongDash",label:"long dash",value:"long-dash",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H13.1818C13.7341 0.5 14.1818 0.947715 14.1818 1.5C14.1818 2.05228 13.7341 2.5 13.1818 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM25.8182 1.5C25.8182 0.947715 26.2659 0.5 26.8182 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H26.8182C26.2659 2.5 25.8182 2.05228 25.8182 1.5Z" fill="black"/></svg>'},{intl:"LongDashDot",label:"long dash dot",value:"long-dash-dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H9.78659C10.3389 0.5 10.7866 0.947715 10.7866 1.5C10.7866 2.05228 10.3389 2.5 9.78659 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM18.5427 1.5C18.5427 0.947715 18.9904 0.5 19.5427 0.5H20.4573C21.0096 0.5 21.4573 0.947715 21.4573 1.5C21.4573 2.05228 21.0096 2.5 20.4573 2.5H19.5427C18.9904 2.5 18.5427 2.05228 18.5427 1.5ZM29.2134 1.5C29.2134 0.947715 29.6611 0.5 30.2134 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H30.2134C29.6611 2.5 29.2134 2.05228 29.2134 1.5Z" fill="black"/></svg>'},{intl:"LongDashDotDot",label:"long dash dot dot",value:"long-dash-dot-dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H7.89557C8.44785 0.5 8.89557 0.947715 8.89557 1.5C8.89557 2.05228 8.44785 2.5 7.89557 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM14.4905 1.5C14.4905 0.947715 14.9382 0.5 15.4905 0.5H16.2025C16.7548 0.5 17.2025 0.947715 17.2025 1.5C17.2025 2.05228 16.7548 2.5 16.2025 2.5H15.4905C14.9382 2.5 14.4905 2.05228 14.4905 1.5ZM22.7975 1.5C22.7975 0.947715 23.2452 0.5 23.7975 0.5H24.5095C25.0618 0.5 25.5095 0.947715 25.5095 1.5C25.5095 2.05228 25.0618 2.5 24.5095 2.5H23.7975C23.2452 2.5 22.7975 2.05228 22.7975 1.5ZM31.1044 1.5C31.1044 0.947715 31.5521 0.5 32.1044 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H32.1044C31.5521 2.5 31.1044 2.05228 31.1044 1.5Z" fill="black"/></svg>'},{intl:"ShortDash",label:"short dash",value:"short-dash",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H6.76471C7.31699 0.5 7.76471 0.947715 7.76471 1.5C7.76471 2.05228 7.31699 2.5 6.76471 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM13.4853 1.5C13.4853 0.947715 13.933 0.5 14.4853 0.5H25.5147C26.067 0.5 26.5147 0.947715 26.5147 1.5C26.5147 2.05228 26.067 2.5 25.5147 2.5H14.4853C13.933 2.5 13.4853 2.05228 13.4853 1.5ZM32.2353 1.5C32.2353 0.947715 32.683 0.5 33.2353 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H33.2353C32.683 2.5 32.2353 2.05228 32.2353 1.5Z" fill="black"/></svg>'},{intl:"ShortDashDot",label:"short dash dot",value:"short-dash-dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H5.06356C5.61584 0.5 6.06356 0.947715 6.06356 1.5C6.06356 2.05228 5.61584 2.5 5.06356 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM9.1483 1.5C9.1483 0.947715 9.59602 0.5 10.1483 0.5H11.1017C11.654 0.5 12.1017 0.947715 12.1017 1.5C12.1017 2.05228 11.654 2.5 11.1017 2.5H10.1483C9.59602 2.5 9.1483 2.05228 9.1483 1.5ZM15.1864 1.5C15.1864 0.947715 15.6342 0.5 16.1864 0.5H23.8136C24.3658 0.5 24.8136 0.947715 24.8136 1.5C24.8136 2.05228 24.3658 2.5 23.8136 2.5H16.1864C15.6342 2.5 15.1864 2.05228 15.1864 1.5ZM27.8983 1.5C27.8983 0.947715 28.346 0.5 28.8983 0.5H29.8517C30.404 0.5 30.8517 0.947715 30.8517 1.5C30.8517 2.05228 30.404 2.5 29.8517 2.5H28.8983C28.346 2.5 27.8983 2.05228 27.8983 1.5ZM33.9364 1.5C33.9364 0.947715 34.3842 0.5 34.9364 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H34.9364C34.3842 2.5 33.9364 2.05228 33.9364 1.5Z" fill="black"/></svg>'},{intl:"ShortDashDotDot",label:"short dash dot dot",value:"short-dash-dot-dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H4.13462C4.6869 0.5 5.13462 0.947715 5.13462 1.5C5.13462 2.05228 4.6869 2.5 4.13462 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM6.98077 1.5C6.98077 0.947715 7.42848 0.5 7.98077 0.5H8.70192C9.25421 0.5 9.70192 0.947715 9.70192 1.5C9.70192 2.05228 9.25421 2.5 8.70192 2.5H7.98077C7.42848 2.5 6.98077 2.05228 6.98077 1.5ZM11.5481 1.5C11.5481 0.947715 11.9958 0.5 12.5481 0.5H13.2692C13.8215 0.5 14.2692 0.947715 14.2692 1.5C14.2692 2.05228 13.8215 2.5 13.2692 2.5H12.5481C11.9958 2.5 11.5481 2.05228 11.5481 1.5ZM16.1154 1.5C16.1154 0.947715 16.5631 0.5 17.1154 0.5H22.8846C23.4369 0.5 23.8846 0.947715 23.8846 1.5C23.8846 2.05228 23.4369 2.5 22.8846 2.5H17.1154C16.5631 2.5 16.1154 2.05228 16.1154 1.5ZM25.7308 1.5C25.7308 0.947715 26.1785 0.5 26.7308 0.5H27.4519C28.0042 0.5 28.4519 0.947715 28.4519 1.5C28.4519 2.05228 28.0042 2.5 27.4519 2.5H26.7308C26.1785 2.5 25.7308 2.05228 25.7308 1.5ZM30.2981 1.5C30.2981 0.947715 30.7458 0.5 31.2981 0.5H32.0192C32.5715 0.5 33.0192 0.947715 33.0192 1.5C33.0192 2.05228 32.5715 2.5 32.0192 2.5H31.2981C30.7458 2.5 30.2981 2.05228 30.2981 1.5ZM34.8654 1.5C34.8654 0.947715 35.3131 0.5 35.8654 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H35.8654C35.3131 2.5 34.8654 2.05228 34.8654 1.5Z" fill="black"/></svg>'},{intl:"ShortDot",label:"short dot",value:"short-dot",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H1.74342C2.29571 0.5 2.74342 0.947715 2.74342 1.5C2.74342 2.05228 2.29571 2.5 1.74342 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5ZM6.00658 1.5C6.00658 0.947715 6.45429 0.5 7.00658 0.5H7.99342C8.54571 0.5 8.99342 0.947715 8.99342 1.5C8.99342 2.05228 8.54571 2.5 7.99342 2.5H7.00658C6.45429 2.5 6.00658 2.05228 6.00658 1.5ZM12.2566 1.5C12.2566 0.947715 12.7043 0.5 13.2566 0.5H14.2434C14.7957 0.5 15.2434 0.947715 15.2434 1.5C15.2434 2.05228 14.7957 2.5 14.2434 2.5H13.2566C12.7043 2.5 12.2566 2.05228 12.2566 1.5ZM18.5066 1.5C18.5066 0.947715 18.9543 0.5 19.5066 0.5H20.4934C21.0457 0.5 21.4934 0.947715 21.4934 1.5C21.4934 2.05228 21.0457 2.5 20.4934 2.5H19.5066C18.9543 2.5 18.5066 2.05228 18.5066 1.5ZM24.7566 1.5C24.7566 0.947715 25.2043 0.5 25.7566 0.5H26.7434C27.2957 0.5 27.7434 0.947715 27.7434 1.5C27.7434 2.05228 27.2957 2.5 26.7434 2.5H25.7566C25.2043 2.5 24.7566 2.05228 24.7566 1.5ZM31.0066 1.5C31.0066 0.947715 31.4543 0.5 32.0066 0.5H32.9934C33.5457 0.5 33.9934 0.947715 33.9934 1.5C33.9934 2.05228 33.5457 2.5 32.9934 2.5H32.0066C31.4543 2.5 31.0066 2.05228 31.0066 1.5ZM37.2566 1.5C37.2566 0.947715 37.7043 0.5 38.2566 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H38.2566C37.7043 2.5 37.2566 2.05228 37.2566 1.5Z" fill="black"/></svg>'},{intl:"Solid",label:"solid",value:"solid",img:'<svg width="40" height="3" viewBox="0 0 40 3" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 1.5C0.25 0.947715 0.697715 0.5 1.25 0.5H38.75C39.3023 0.5 39.75 0.947715 39.75 1.5C39.75 2.05228 39.3023 2.5 38.75 2.5H1.25C0.697715 2.5 0.25 2.05228 0.25 1.5Z" fill="black"/></svg>'}],xe=e=>{const t=e.ref.palette.black;return`\n  .line-options-img {\n    display: flex;\n    width: 40px;\n    color: ${t} !important;\n\n    path {\n      stroke: ${t} !important;\n      transform: translateY(50%);\n    }\n  }\n  `},Ne=e=>i.css`
    &.jimu-symbol-list {
      color: var(--sys-color-surface-overlay-text);

      /* preview */
      .jimu-symbol-list-preview {
        .preview-item {
          min-height: 32px;
          max-height: 80px;
          max-width: 80px;
        }
      }

      .keep-line {
        word-break: keep-all;
      }

      .points-source-selector {
        overflow: hidden;
      }

      /* setting row */
      .params-settings {
        .divide-line {
          border-right: 1px solid ${null==e?void 0:e.ref.palette.neutral[500]};
          height: 26px;
        }

        /* overwrite styles for InputUnitSetting */
        .numeric-input {
          .jimu-numeric-input-input {
            border-top-left-radius: var(--sys-shape-input-field);
            border-bottom-left-radius: var(--sys-shape-input-field);
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
          }
        }
        .style-setting--input-unit {
          .style-setting--unit-selector{
            border-top-right-radius: var(--sys-shape-input-field);
            border-bottom-right-radius: var(--sys-shape-input-field);
          }
        }

        .params-setting-row-one {
          ${xe(e)}
        }

        .params-setting-row-two {
          .slider {
            /* width: calc(100% - 80px) sub-repo-issue: #27242 */
          }
          .input-unit {
            width: 70px
          }
        }

        /* text */
        .text-opacity-row {
          .style-setting--input-unit {
            flex-grow: unset;
          }
        }
        .params-setting-row-color {
          .slider {
            width: calc(100% - 40px)
          }
        }
        .params-setting-row-outline {
          .slider {
            width: calc(100% - 110px)
          }
        }
      }

      /* symbols wrapper */
      .symbol-list-wrapper {
        display: flex;
        flex-wrap: wrap;

        background-color: var(--sys-color-action-input-field);
        border: 1px solid var(--sys-color-divider-primary);

        max-height: 150px;
        min-width: 200px;
        overflow-y: auto;
      }

      .symbol-item-wrapper {
        /* 16.66666%; */
        flex: 0 0 calc(100%/${6});

        width: 32px;
        height: 32px;
      }
    }
  `;class Ce extends i.React.PureComponent{constructor(e){super(e),this.jsonUtils=null,this.handleSymbolSelected=(e,t)=>{this.setState({currentIndex:e}),this.props.onSymbolChanged(t)},this.onSelectChanged=e=>{const t=e.target.value,i=this.props.symbol.clone();i.style=t,this.props.onSymbolChanged(i)},this.updateSymbolLineWidth=e=>{const t=this.props.symbol.clone();t.width=e,this.props.onSymbolChanged(t)},this.updateSymbolOpacity=e=>{const t=this.props.symbol.clone();t.color.a=ee(e,1),this.props.onSymbolChanged(t)},this.updateSymbolFillColor=e=>{const t=this.props.symbol.clone();t.color=e,this.props.onSymbolChanged(t)},this.renderPolylineSymbolList=()=>{if(this.jsonUtils){return we.map((e,t)=>{const i=this.jsonUtils.fromJSON(e);return(0,n.jsx)("div",{className:"symbol-item-wrapper mt-1",children:(0,n.jsx)(he,{theme:this.props.theme,jimuSymbolType:Ae.Polyline,index:t,symbol:i,isActive:this.state.currentIndex===t,onClick:this.handleSymbolSelected},t)},t)})}return null},this.getPolylineSymbolParamsSetting=()=>{if(this.props.symbol){const e=this.props.symbol.clone(),t=e.color,o=null==e?void 0:e.style,s=null==e?void 0:e.width,a=ie(this.props.symbol),l=(100*a).toFixed(1),r=this.props.intl.formatMessage({id:"drawToolOpacity",defaultMessage:g.defaultMessages.drawToolOpacity}),c=oe(r,l);return(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)("div",{className:"params-setting-row-one w-100 d-flex align-items-center justify-content-between mb-2",children:[(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:80},min:1,max:20,required:!0,value:s,onChange:this.updateSymbolLineWidth}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(g.Select,{size:"sm",value:o,onChange:this.onSelectChanged,style:{width:"80px"},children:ve.map((e,t)=>{return(0,n.jsx)(g.Option,{title:this.props.intl.formatMessage({id:`drawTool${e.intl}`,defaultMessage:g.defaultMessages[`drawTool${e.intl}`]}),value:e.value,label:e.label,children:(0,n.jsx)("div",{css:(o=this.props.theme,i.css`
    ${xe(o)}
  `),children:(0,n.jsx)(g.SVG,{className:"mx-2 line-options-img",src:`${e.img}`})})},t);var o})}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(Me.ColorPicker,{color:te(t),onChange:this.updateSymbolFillColor,outline:!0})]}),(0,n.jsxs)("div",{className:"params-setting-row-two w-100 d-flex align-items-center pt-1",children:[(0,n.jsx)(g.Slider,{title:c,value:a,min:0,max:1,step:.1,className:"slider mr-2",onChange:e=>{this.updateSymbolOpacity(e.currentTarget.value)}}),(0,n.jsx)(Se,{mode:"symbol",symbol:this.props.symbol,opacityPercentage:Number(l),onSymbolChanged:this.props.onSymbolChanged})]})]})}return null},this.state={apiLoaded:!1,currentIndex:null}}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/symbols/support/jsonUtils"]).then(e=>{[this.jsonUtils]=e,this.setState({apiLoaded:!0},()=>{"function"==typeof this.props.onA11yFocus&&this.props.onA11yFocus()})})}render(){return(0,n.jsxs)("div",{className:"w-100 ",children:[(0,n.jsx)("div",{className:"symbol-list-wrapper p-1 mb-4",children:this.renderPolylineSymbolList()}),(0,n.jsx)("div",{className:"params-settings w-100",children:this.getPolylineSymbolParamsSetting()})]})}}const Ie=[{tags:["opaque"],title:"Blue",style:"esriSFSSolid",color:[79,129,189,255],name:"Blue 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}},{tags:["opaque"],title:"Red",style:"esriSFSSolid",color:[192,80,77,255],name:"Red 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[160,63,60,255],width:1.5,type:"esriSLS"}},{tags:["opaque"],title:"Olive Green",style:"esriSFSSolid",color:[155,187,89,255],name:"Olive Green 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[115,140,61,255],width:1.5,type:"esriSLS"}},{tags:["opaque"],title:"Purple",style:"esriSFSSolid",color:[128,100,162,255],name:"Purple 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[140,125,158,255],width:1.5,type:"esriSLS"}},{tags:["opaque","blue"],title:"Aqua",style:"esriSFSSolid",color:[75,172,198,255],name:"Aqua 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[63,131,150,255],width:1.5,type:"esriSLS"}},{tags:["opaque"],title:"Orange",style:"esriSFSSolid",color:[239,132,38,255],name:"Orange 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[184,115,59,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque"],title:"Blue",style:"esriSFSSolid",color:[79,129,189,128],name:"Blue 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque"],title:"Red",style:"esriSFSSolid",color:[192,80,77,128],name:"Red 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[160,63,60,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque"],title:"Olive Green",style:"esriSFSSolid",color:[155,187,89,128],name:"Olive Green 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[115,140,61,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque"],title:"Purple",style:"esriSFSSolid",color:[128,100,162,128],name:"Purple 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[140,125,158,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque","blue"],title:"Aqua",style:"esriSFSSolid",color:[75,172,198,128],name:"Aqua 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[63,131,150,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque"],title:"Orange",style:"esriSFSSolid",color:[239,132,38,128],name:"Orange 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[184,115,59,255],width:1.5,type:"esriSLS"}},{tags:["semi-opaque"],title:"Blue",style:"esriSFSSolid",color:[220,232,255,255],name:"Blue 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[108,151,203,255],width:1.5,type:"esriSLS"}},{tags:[""],title:"Red",style:"esriSFSSolid",color:[255,199,198,255],name:"Red 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[207,101,99,255],width:1.5,type:"esriSLS"}},{title:"Olive Green",style:"esriSFSSolid",color:[235,254,208,255],name:"Olive Green 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[166,191,116,255],width:1.5,type:"esriSLS"}},{title:"Purple",style:"esriSFSSolid",color:[224,212,242,255],name:"Purple 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[145,122,171,255],width:1.5,type:"esriSLS"}},{tags:["blue"],title:"Aqua",style:"esriSFSSolid",color:[194,240,255,255],name:"Aqua 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[101,179,200,255],width:1.5,type:"esriSLS"}},{title:"Orange",style:"esriSFSSolid",color:[255,214,180,255],name:"Orange 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[251,164,93,255],width:1.5,type:"esriSLS"}},{tags:["white","outline"],title:"Blue",style:"esriSFSSolid",color:[108,151,203,255],name:"Blue 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[255,255,255,255],width:2,type:"esriSLS"}},{tags:["white","outline"],title:"Red",style:"esriSFSSolid",color:[207,101,99,255],name:"Red 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[255,255,255,255],width:2,type:"esriSLS"}},{tags:["white","outline"],title:"Olive Green",style:"esriSFSSolid",color:[166,191,116,255],name:"Olive Green 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[255,255,255,255],width:2,type:"esriSLS"}},{tags:["white","outline","blue"],title:"Aqua",style:"esriSFSSolid",color:[101,179,200,255],name:"Purple 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[255,255,255,255],width:2,type:"esriSLS"}},{tags:["white","outline"],title:"Red",style:"esriSFSSolid",color:[246,91,60,255],name:"Aqua 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[255,255,255,255],width:2,type:"esriSLS"}},{tags:["white","outline"],title:"Orange",style:"esriSFSSolid",color:[251,164,93,255],name:"Orange 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[255,255,255,255],width:2,type:"esriSLS"}},{tags:["hollow"],title:"Blue",style:"esriSFSSolid",color:[108,151,203,0],name:"Blue 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[108,151,203,255],width:2,type:"esriSLS"}},{tags:["hollow"],title:"Red",style:"esriSFSSolid",color:[207,101,99,0],name:"Red 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[207,101,99,255],width:2,type:"esriSLS"}},{tags:["hollow"],title:"Olive Green",style:"esriSFSSolid",color:[166,191,116,0],name:"Olive Green 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[166,191,116,255],width:2,type:"esriSLS"}},{tags:["hollow"],title:"Aqua",style:"esriSFSSolid",color:[101,179,200,0],name:"Purple 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[101,179,200,255],width:2,type:"esriSLS"}},{tags:["hollow","blue"],title:"Red",style:"esriSFSSolid",color:[246,91,60,0],name:"Aqua 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[246,91,60,255],width:2,type:"esriSLS"}},{tags:["hollow"],title:"Orange",style:"esriSFSSolid",color:[251,164,93,0],name:"Orange 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[251,164,93,255],width:2,type:"esriSLS"}},{tags:["no outline"],title:"Blue",style:"esriSFSSolid",color:[58,120,192,255],name:"Blue 4",type:"esriSFS",outline:{style:"esriSLSNull",width:0,type:"esriSLS"}},{tags:["no outline"],title:"Red",style:"esriSFSSolid",color:[184,55,52,255],name:"Red 4",type:"esriSFS",outline:{style:"esriSLSNull",width:0,type:"esriSLS"}},{tags:["no outline"],title:"Olive Green",style:"esriSFSSolid",color:[142,179,65,255],name:"Olive Green 4",type:"esriSFS",outline:{style:"esriSLSNull",width:0,type:"esriSLS"}},{tags:["no outline"],title:"Purple",style:"esriSFSSolid",color:[111,79,150,255],name:"Purple 4",type:"esriSFS",outline:{style:"esriSLSNull",width:0,type:"esriSLS"}},{tags:["no outline","blue"],title:"Aqua",style:"esriSFSSolid",color:[47,157,187,255],name:"Aqua 4",type:"esriSFS",outline:{style:"esriSLSNull",width:0,type:"esriSLS"}},{tags:["no outline"],title:"Orange",style:"esriSFSSolid",color:[239,132,38,255],name:"Orange 4",type:"esriSFS",outline:{style:"esriSLSNull",width:0,type:"esriSLS"}},{title:"Black",style:"esriSFSSolid",color:[0,0,0,255],name:"Gray 7",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1,type:"esriSLS"}},{title:"Gray 80",style:"esriSFSSolid",color:[51,51,51,255],name:"Gray 8",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1,type:"esriSLS"}},{title:"Gray 60",style:"esriSFSSolid",color:[119,119,119,255],name:"Gray 9",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1,type:"esriSLS"}},{title:"Gray 40",style:"esriSFSSolid",color:[187,187,187,255],name:"Gray 10",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1,type:"esriSLS"}},{title:"Gray 20",style:"esriSFSSolid",color:[221,221,221,255],name:"Gray 11",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1,type:"esriSLS"}},{title:"White",style:"esriSFSSolid",color:[255,255,255,255],name:"Gray 12",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1,type:"esriSLS"}},{title:"Gray (opacity 50)",style:"esriSFSSolid",color:[1,1,1,153],name:"Gray 1",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1.5,type:"esriSLS"}},{title:"Gray (opacity 50)",style:"esriSFSSolid",color:[51,51,51,128],name:"Gray 2",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1.5,type:"esriSLS"}},{title:"Gray (opacity 50)",style:"esriSFSSolid",color:[119,119,119,128],name:"Gray 3",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1.5,type:"esriSLS"}},{title:"Gray (opacity 50)",style:"esriSFSSolid",color:[187,187,187,128],name:"Gray 4",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1.5,type:"esriSLS"}},{title:"Gray (opacity 50)",style:"esriSFSSolid",color:[221,221,221,128],name:"Gray 5",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1.5,type:"esriSLS"}},{title:"Gray (opacity 50)",style:"esriSFSSolid",color:[221,221,221,128],name:"Gray 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[0,0,0,255],width:1.5,type:"esriSLS"}},{tags:["green","blue","outline"],title:"Lime",style:"esriSFSSolid",color:[0,255,0,128],name:"Lime",type:"esriSFS",outline:{style:"esriSLSSolid",color:[71,105,146,255],width:1.5,type:"esriSLS"}},{tags:["blue","outline"],title:"Brown",style:"esriSFSSolid",color:[165,42,42,128],name:"Brown",type:"esriSFS",outline:{style:"esriSLSSolid",color:[71,105,146,255],width:1.5,type:"esriSLS"}},{tags:["blue","outline"],title:"Green",style:"esriSFSSolid",color:[0,128,0,128],name:"Green",type:"esriSFS",outline:{style:"esriSLSSolid",color:[71,105,146,255],width:1.5,type:"esriSLS"}},{tags:["blue","outline"],title:"Yellow",style:"esriSFSSolid",color:[255,255,0,128],name:"Yellow",type:"esriSFS",outline:{style:"esriSLSSolid",color:[71,105,146,255],width:1.5,type:"esriSLS"}},{tags:["blue","outline"],title:"Navy",style:"esriSFSSolid",color:[0,0,128,128],name:"Navy",type:"esriSFS",outline:{style:"esriSLSSolid",color:[71,105,146,255],width:1.5,type:"esriSLS"}}];class je extends i.React.PureComponent{constructor(e){super(e),this.jsonUtils=null,this.handleSymbolSelected=(e,t)=>{this.setState({currentIndex:e}),this.props.onSymbolChanged(t)},this.renderPolygonSymbolList=()=>this.jsonUtils?Ie.map((e,t)=>{const i=this.jsonUtils.fromJSON(e);return(0,n.jsx)("div",{className:"symbol-item-wrapper mt-1",children:(0,n.jsx)(he,{theme:this.props.theme,jimuSymbolType:Ae.Polygon,index:t,symbol:i,isActive:this.state.currentIndex===t,onClick:this.handleSymbolSelected},t)},t)}):null,this.getPolygonSymbolParamsSetting=()=>{if(this.props.symbol){const e=this.props.symbol.clone(),t=e.color,o=null==e?void 0:e.outline,s=te(null==o?void 0:o.color),a=null==o?void 0:o.width,l=ie(this.props.symbol),r=(100*l).toFixed(1),c=this.props.intl.formatMessage({id:"drawToolOpacity",defaultMessage:g.defaultMessages.drawToolOpacity}),d=oe(c,r);return(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)("div",{className:"w-100 d-flex justify-content-between align-items-center mb-2",children:[(0,n.jsx)(Me.ColorPicker,{color:te(t),onChange:this.updateSymbolFillColor}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)("div",{style:{position:"relative"},children:(0,n.jsx)(Me.ColorPicker,{color:s,onChange:this.updateSymbolOutLineColor,outline:!0})}),(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:80},min:0,max:20,required:!0,value:a,onChange:this.updateSymbolOutLineWeight})]}),(0,n.jsxs)("div",{className:"params-setting-row-two w-100 d-flex align-items-center pt-1",children:[(0,n.jsx)(g.Slider,{title:d,value:l,min:0,max:1,step:.1,className:"slider mr-2",onChange:e=>{this.updateSymbolOpacity(e.currentTarget.value)}}),(0,n.jsx)(Se,{mode:"symbol",symbol:this.props.symbol,opacityPercentage:Number(r),onSymbolChanged:this.props.onSymbolChanged})]})]})}return null},this.updateSymbolOutLineWeight=e=>{const t=this.props.symbol.clone();t.outline.width=e,this.props.onSymbolChanged(t)},this.updateSymbolOutLineColor=e=>{const t=this.props.symbol.clone();t.outline.color=e,this.props.onSymbolChanged(t)},this.updateSymbolFillColor=e=>{const t=this.props.symbol.clone();t.color=e,this.props.onSymbolChanged(t)},this.updateSymbolOpacity=e=>{const t=this.props.symbol.clone();t.color.a=ee(e,1),this.props.onSymbolChanged(t)},this.state={apiLoaded:!1,currentIndex:null}}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/symbols/support/jsonUtils"]).then(e=>{[this.jsonUtils]=e,this.setState({apiLoaded:!0},()=>{"function"==typeof this.props.onA11yFocus&&this.props.onA11yFocus()})})}render(){return(0,n.jsxs)("div",{className:"w-100 ",children:[(0,n.jsx)("div",{className:"symbol-list-wrapper p-1 mb-4",children:this.renderPolygonSymbolList()}),(0,n.jsx)("div",{className:"params-settings w-100",children:this.getPolygonSymbolParamsSetting()})]})}}var Le=r(74305),De=r.n(Le),Te=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(i[o[s]]=e[o[s]])}return i};const Oe=e=>{const t=window.SVG,{className:o}=e,s=Te(e,["className"]),a=(0,i.classNames)("jimu-icon jimu-icon-component",o);return t?(0,n.jsx)(t,Object.assign({className:a,src:De()},s)):(0,n.jsx)("svg",Object.assign({className:a},s))};class Pe extends i.React.PureComponent{getInitBgInfo(){return{backgroundColor:[255,255,255,191],borderLineColor:[168,168,168,255],borderLineSize:1}}constructor(e){var t;super(e),this.jsonUtils=null,this.Color=null,this._defaultTextCache="",this.is3DMode=()=>this.props.jimuMapView&&"3d"===this.props.jimuMapView.view.type,this.handleTextChanged=e=>{const t=this.props.symbol.toJSON();t.text=e;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.onFontChanged=e=>{const t=e.target.value,i=this.props.symbol.toJSON(),o={"Abril Fatface Regular":{font:{family:"Abril Fatface",style:"normal",weight:"normal"}},"Alegreya Bold":{font:{family:"Alegreya",style:"normal",weight:"bold"}},"Alegreya Bold Italic":{font:{family:"Alegreya",style:"italic",weight:"bold"}},"Alegreya Italic":{font:{family:"Alegreya",style:"italic",weight:"normal"}},"Alegreya Regular":{font:{family:"Alegreya",style:"normal",weight:"normal"}},"Alegreya SC Bold":{font:{family:"Alegreya SC",style:"normal",weight:"bold"}},"Alegreya SC Italic":{font:{family:"Alegreya SC",style:"italic",weight:"normal"}},"Alegreya SC Regular":{font:{family:"Alegreya SC",style:"normal",weight:"normal"}},"Alegreya Sans Italic":{font:{family:"Alegreya Sans",style:"italic",weight:"normal"}},"Amarante Regular":{font:{family:"Amarante",style:"normal",weight:"normal"}},"Amatic SC Bold":{font:{family:"Amatic SC",style:"normal",weight:"bold"}},"Arial Bold":{font:{family:"Arial",style:"normal",weight:"bold"}},"Arial Bold Italic":{font:{family:"Arial",style:"italic",weight:"bold"}},"Arial Italic":{font:{family:"Arial",style:"italic",weight:"normal"}},"Arial Regular":{font:{family:"Arial",style:"normal",weight:"normal"}},"Arial Unicode MS Bold":{font:{family:"Arial Unicode MS",style:"normal",weight:"bold"}},"Arial Unicode MS Regular":{font:{family:"Arial Unicode MS",style:"normal",weight:"normal"}},"Atomic Age Regular":{font:{family:"Atomic Age",style:"normal",weight:"normal"}},"Audiowide Regular":{font:{family:"Audiowide",style:"normal",weight:"normal"}},"Avenir Next LT Pro Bold":{font:{family:"Avenir Next LT Pro",style:"normal",weight:"bold"}},"Avenir Next LT Pro Bold Italic":{font:{family:"Avenir Next LT Pro",style:"italic",weight:"bold"}},"Avenir Next LT Pro Demi Italic":{font:{family:"Avenir Next LT Pro Demi",style:"italic",weight:"normal"}},"Avenir Next LT Pro Italic":{font:{family:"Avenir Next LT Pro",style:"italic",weight:"normal"}},"Avenir Next LT Pro Light":{font:{family:"Avenir Next LT Pro Light",style:"normal",weight:"normal"}},"Avenir Next LT Pro Light Italic":{font:{family:"Avenir Next LT Pro Light",style:"italic",weight:"normal"}},"Avenir Next LT Pro Medium Bold":{font:{family:"Avenir Next LT Pro Medium",style:"normal",weight:"bold"}},"Avenir Next LT Pro Medium Bold Italic":{font:{family:"Avenir Next LT Pro Medium",style:"italic",weight:"bold"}},"Avenir Next LT Pro Regular":{font:{family:"Avenir Next LT Pro",style:"normal",weight:"normal"}},"Avenir Next LT Pro Regular Bold":{font:{family:"Avenir Next LT Pro Regular",style:"normal",weight:"bold"}},"BellTopo Sans Bold":{font:{family:"BellTopo Sans",style:"normal",weight:"bold"}},"BellTopo Sans Bold Italic":{font:{family:"BellTopo Sans",style:"italic",weight:"bold"}},"BellTopo Sans Italic":{font:{family:"BellTopo Sans",style:"italic",weight:"normal"}},"BellTopo Sans Regular":{font:{family:"BellTopo Sans",style:"normal",weight:"normal"}},"Belleza Regular":{font:{family:"Belleza",style:"normal",weight:"normal"}},"Black Ops One Regular":{font:{family:"Black Ops One",style:"normal",weight:"normal"}},"Cabin Sketch Bold":{font:{family:"Cabin Sketch",style:"normal",weight:"bold"}},"Cabin Sketch Regular":{font:{family:"Cabin Sketch",style:"normal",weight:"normal"}},"Coming Soon Regular":{font:{family:"Coming Soon",style:"normal",weight:"normal"}},"FGDC GeoAge Regular":{font:{family:"FGDC GeoAge",style:"normal",weight:"normal"}},"Homemade Apple Regular":{font:{family:"Homemade Apple",style:"normal",weight:"normal"}},"IM FELL DW Pica PRO Italic":{font:{family:"IM FELL DW Pica PRO",style:"italic",weight:"normal"}},"IM FELL DW Pica PRO Regular":{font:{family:"IM FELL DW Pica PRO",style:"normal",weight:"normal"}},"Josefin Sans Regular":{font:{family:"Josefin Sans",style:"normal",weight:"normal"}},"Josefin Sans Semibold Italic":{font:{family:"Josefin Sans Semibold",style:"italic",weight:"bold"}},"Josefin Slab Bold":{font:{family:"Josefin Slab",style:"normal",weight:"bold"}},"Josefin Slab Bold Italic":{font:{family:"Josefin Slab",style:"italic",weight:"bold"}},"Josefin Slab Italic":{font:{family:"Josefin Slab",style:"italic",weight:"normal"}},"Josefin Slab Light Italic":{font:{family:"Josefin Slab Light",style:"italic",weight:"normal"}},"Josefin Slab Regular":{font:{family:"Josefin Slab",style:"normal",weight:"normal"}},"Josefin Slab Semibold Italic":{font:{family:"Josefin Slab Semibold",style:"italic",weight:"bold"}},"Josefin Slab Thin Italic":{font:{family:"Josefin Slab Thin",style:"italic",weight:"normal"}},"Just Another Hand Regular":{font:{family:"Just Another Hand",style:"normal",weight:"normal"}},"Muli Italic":{font:{family:"Muli",style:"italic",weight:"normal"}},"Muli Light":{font:{family:"Muli Light",style:"normal",weight:"normal"}},"Muli Light Italic":{font:{family:"Muli Light",style:"italic",weight:"normal"}},"Muli Regular":{font:{family:"Muli",style:"normal",weight:"normal"}},"Oswald Regular":{font:{family:"Oswald",style:"normal",weight:"normal"}},"Pacifico Regular":{font:{family:"Pacifico",style:"normal",weight:"normal"}},"Raleway Bold":{font:{family:"Raleway",style:"normal",weight:"bold"}},"Raleway Italic":{font:{family:"Raleway",style:"italic",weight:"normal"}},"Raleway Regular":{font:{family:"Raleway",style:"normal",weight:"normal"}},"Reenie Beanie Regular":{font:{family:"Reenie Beanie",style:"normal",weight:"normal"}},"Roboto Light Italic":{font:{family:"Roboto Light",style:"italic",weight:"normal"}},"Roboto Regular":{font:{family:"Roboto",style:"normal",weight:"normal"}},"Sacramento Regular":{font:{family:"Sacramento",style:"normal",weight:"normal"}},"Source Sans Pro Bold":{font:{family:"Source Sans Pro",style:"normal",weight:"bold"}},"Source Sans Pro Italic":{font:{family:"Source Sans Pro",style:"italic",weight:"normal"}},"Source Sans Pro Light":{font:{family:"Source Sans Pro",style:"normal",weight:"normal"}},"Source Sans Pro Regular":{font:{family:"Source Sans Pro",style:"normal",weight:"normal"}},"Special Elite Regular":{font:{family:"Special Elite",style:"normal",weight:"normal"}},"Vollkorn Bold":{font:{family:"Vollkorn",style:"normal",weight:"bold"}},"Vollkorn Regular":{font:{family:"Vollkorn",style:"normal",weight:"normal"}},"Vollkorn SC Bold":{font:{family:"Vollkorn SC",style:"normal",weight:"bold"}},"Vollkorn SC Regular":{font:{family:"Vollkorn SC",style:"normal",weight:"normal"}},"Waiting for the Sunrise Regular":{font:{family:"Waiting for the Sunrise",style:"normal",weight:"normal"}}}[t];i.font=Object.assign(i.font,{family:o.font.family,style:o.font.style,weight:o.font.weight});const s=this.jsonUtils.fromJSON(i);this.props.onSymbolChanged(s)},this.handleSizeChanged=e=>{const t=this.props.symbol.toJSON();t.font.size=e;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.handleColorChanged=e=>{const t=this.props.symbol.toJSON();let i=this.Color.fromString(e).toRgba();i=se(this.Color.fromArray(i)),t.color=i;const o=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(o)},this.handleColorAlphaChanged=e=>{const t=this.props.symbol.toJSON();t.color[3]=e,t.color=se(this.Color.fromArray(t.color));const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.handleHaloSizeChanged=e=>{const t=this.props.symbol.toJSON();t.haloSize=e;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.handleHaloColorChanged=e=>{const t=this.props.symbol.toJSON();let i=this.Color.fromString(e).toRgba();i=se(this.Color.fromArray(i)),t.haloColor=i;const o=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(o)},this.handleAngleChanged=e=>{const t=this.props.symbol.toJSON();t.angle=e;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.handleSliderAngleChanged=e=>{if(!this.state.apiLoaded)return;const t=e.currentTarget,o=parseFloat(t.value);i.lodash.throttle(()=>{this.handleAngleChanged(o)},80)()},this.handleIsShowLocationMeasurementChanged=e=>{this.setState({enableBackground:e});const t=this.props.symbol.toJSON();e?(t.backgroundColor||(t.backgroundColor=this._cacheBgInfo.backgroundColor),t.borderLineColor||(t.borderLineColor=this._cacheBgInfo.borderLineColor),t.borderLineSize||(t.borderLineSize=this._cacheBgInfo.borderLineSize)):(t.backgroundColor&&delete t.backgroundColor,t.borderLineColor&&delete t.borderLineColor,t.borderLineSize&&delete t.borderLineSize);const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.handleBackgroundColorChanged=e=>{const t=this.props.symbol.toJSON();let i=this.Color.fromString(e).toRgba();i=se(this.Color.fromArray(i)),t.backgroundColor=i,this._cacheBgInfo.backgroundColor=t.backgroundColor;const o=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(o)},this.handleBackgroundColorAlphaChanged=e=>{this.state.apiLoaded&&i.lodash.throttle(()=>{const t=this.props.symbol.toJSON();t.backgroundColor[3]=e,t.backgroundColor=se(this.Color.fromArray(t.backgroundColor)),this._cacheBgInfo.backgroundColor=t.backgroundColor;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},80)()},this.handleBorderLineSizeChanged=e=>{const t=this.props.symbol.toJSON();t.borderLineSize=e,this._cacheBgInfo.borderLineSize=t.borderLineSize;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.handleBorderLineColorChanged=e=>{const t=this.props.symbol.toJSON();let i=this.Color.fromString(e).toRgba();i=se(this.Color.fromArray(i)),t.borderLineColor=i,this._cacheBgInfo.borderLineColor=t.borderLineColor;const o=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(o)},this.handleBorderLineColorAlphaChanged=e=>{const t=this.props.symbol.toJSON();t.borderLineColor[3]=e,t.borderLineColor=se(this.Color.fromArray(t.borderLineColor)),this._cacheBgInfo.borderLineColor=t.borderLineColor;const i=this.jsonUtils.fromJSON(t);this.props.onSymbolChanged(i)},this.getTextAreaValue=e=>this.state.showTextInTextArea?e:"",this.state={apiLoaded:!1,showTextInTextArea:!1,enableBackground:!1},this._defaultTextCache=null!==(t=this.props.defaultText)&&void 0!==t?t:"",this._cacheBgInfo=this.getInitBgInfo()}componentDidMount(){this.state.apiLoaded||(0,y.loadArcGISJSAPIModules)(["esri/symbols/support/jsonUtils","esri/symbols/TextSymbol","esri/Color"]).then(e=>{[this.jsonUtils,this.TextSymbol,this.Color]=e,this.setState({apiLoaded:!0},()=>{})})}render(){var e,t,o,s,a,l,r,c,d;const p=null===(e=this.props.symbol)||void 0===e?void 0:e.toJSON();if("esriTS"!==(null==p?void 0:p.type))return null;const u=null!==(t=p.backgroundColor)&&void 0!==t?t:this._cacheBgInfo.backgroundColor,h=null!==(o=p.borderLineColor)&&void 0!==o?o:this._cacheBgInfo.borderLineColor,m=null!==(s=p.borderLineSize)&&void 0!==s?s:this._cacheBgInfo.borderLineSize,y=this.props.intl.formatMessage({id:"drawToolRotation",defaultMessage:g.defaultMessages.drawToolRotation}),S=this.props.intl.formatMessage({id:"drawToolOpacity",defaultMessage:g.defaultMessages.drawToolOpacity}),M=this.props.intl.formatMessage({id:"background",defaultMessage:g.defaultMessages.background}),f=this.props.intl.formatMessage({id:"fontSize",defaultMessage:g.defaultMessages.fontSize}),b=this.props.intl.formatMessage({id:"fontColor",defaultMessage:g.defaultMessages.fontColor}),w=this.props.intl.formatMessage({id:"haloColor",defaultMessage:g.defaultMessages.haloColor}),v=this.props.intl.formatMessage({id:"haloSize",defaultMessage:g.defaultMessages.haloSize});return(0,n.jsx)("div",{className:"w-100 params-settings",css:(this.props.theme,i.css`
    .text-content-input {

      .form-control {
        height: 74px;
        resize: none;
        /*border: none;*/
      }
    }
  `),children:(0,n.jsxs)("div",{className:"d-flex flex-column w-100 justify-content-between",children:[(0,n.jsxs)("div",{className:"d-flex w-100 justify-content-between align-items-center mt-2 mb-3",children:[(0,n.jsx)("div",{className:"mr-5 keep-line",css:{alignSelf:"flex-start"},children:this.props.intl.formatMessage({id:"drawToolContent",defaultMessage:g.defaultMessages.drawToolContent})}),(0,n.jsx)(g.TextArea,{name:"text",className:"text-content-input ml-5",defaultValue:this.getTextAreaValue(null==p?void 0:p.text),placeholder:this.props.intl.formatMessage({id:"drawToolTextPlaceholder",defaultMessage:g.defaultMessages.drawToolTextPlaceholder}),onChange:e=>{const t=""!==e.target.value;this.setState({showTextInTextArea:t},()=>{const t=""===e.target.value?this._defaultTextCache:e.target.value;this.handleTextChanged(t)})}})]}),(0,n.jsx)("div",{className:"d-flex w-100 align-items-center mb-1",children:this.props.intl.formatMessage({id:"drawToolFont",defaultMessage:g.defaultMessages.drawToolFont})}),(0,n.jsx)("div",{className:"d-flex w-100 align-items-center mb-2",children:(0,n.jsx)(g.Select,{className:"font-family-selector",onChange:this.onFontChanged,value:ne(p),children:Object.keys({"Abril Fatface Regular":{font:{family:"Abril Fatface",style:"normal",weight:"normal"}},"Alegreya Bold":{font:{family:"Alegreya",style:"normal",weight:"bold"}},"Alegreya Bold Italic":{font:{family:"Alegreya",style:"italic",weight:"bold"}},"Alegreya Italic":{font:{family:"Alegreya",style:"italic",weight:"normal"}},"Alegreya Regular":{font:{family:"Alegreya",style:"normal",weight:"normal"}},"Alegreya SC Bold":{font:{family:"Alegreya SC",style:"normal",weight:"bold"}},"Alegreya SC Italic":{font:{family:"Alegreya SC",style:"italic",weight:"normal"}},"Alegreya SC Regular":{font:{family:"Alegreya SC",style:"normal",weight:"normal"}},"Alegreya Sans Italic":{font:{family:"Alegreya Sans",style:"italic",weight:"normal"}},"Amarante Regular":{font:{family:"Amarante",style:"normal",weight:"normal"}},"Amatic SC Bold":{font:{family:"Amatic SC",style:"normal",weight:"bold"}},"Arial Bold":{font:{family:"Arial",style:"normal",weight:"bold"}},"Arial Bold Italic":{font:{family:"Arial",style:"italic",weight:"bold"}},"Arial Italic":{font:{family:"Arial",style:"italic",weight:"normal"}},"Arial Regular":{font:{family:"Arial",style:"normal",weight:"normal"}},"Arial Unicode MS Bold":{font:{family:"Arial Unicode MS",style:"normal",weight:"bold"}},"Arial Unicode MS Regular":{font:{family:"Arial Unicode MS",style:"normal",weight:"normal"}},"Atomic Age Regular":{font:{family:"Atomic Age",style:"normal",weight:"normal"}},"Audiowide Regular":{font:{family:"Audiowide",style:"normal",weight:"normal"}},"Avenir Next LT Pro Bold":{font:{family:"Avenir Next LT Pro",style:"normal",weight:"bold"}},"Avenir Next LT Pro Bold Italic":{font:{family:"Avenir Next LT Pro",style:"italic",weight:"bold"}},"Avenir Next LT Pro Demi Italic":{font:{family:"Avenir Next LT Pro Demi",style:"italic",weight:"normal"}},"Avenir Next LT Pro Italic":{font:{family:"Avenir Next LT Pro",style:"italic",weight:"normal"}},"Avenir Next LT Pro Light":{font:{family:"Avenir Next LT Pro Light",style:"normal",weight:"normal"}},"Avenir Next LT Pro Light Italic":{font:{family:"Avenir Next LT Pro Light",style:"italic",weight:"normal"}},"Avenir Next LT Pro Medium Bold":{font:{family:"Avenir Next LT Pro Medium",style:"normal",weight:"bold"}},"Avenir Next LT Pro Medium Bold Italic":{font:{family:"Avenir Next LT Pro Medium",style:"italic",weight:"bold"}},"Avenir Next LT Pro Regular":{font:{family:"Avenir Next LT Pro",style:"normal",weight:"normal"}},"Avenir Next LT Pro Regular Bold":{font:{family:"Avenir Next LT Pro Regular",style:"normal",weight:"bold"}},"BellTopo Sans Bold":{font:{family:"BellTopo Sans",style:"normal",weight:"bold"}},"BellTopo Sans Bold Italic":{font:{family:"BellTopo Sans",style:"italic",weight:"bold"}},"BellTopo Sans Italic":{font:{family:"BellTopo Sans",style:"italic",weight:"normal"}},"BellTopo Sans Regular":{font:{family:"BellTopo Sans",style:"normal",weight:"normal"}},"Belleza Regular":{font:{family:"Belleza",style:"normal",weight:"normal"}},"Black Ops One Regular":{font:{family:"Black Ops One",style:"normal",weight:"normal"}},"Cabin Sketch Bold":{font:{family:"Cabin Sketch",style:"normal",weight:"bold"}},"Cabin Sketch Regular":{font:{family:"Cabin Sketch",style:"normal",weight:"normal"}},"Coming Soon Regular":{font:{family:"Coming Soon",style:"normal",weight:"normal"}},"FGDC GeoAge Regular":{font:{family:"FGDC GeoAge",style:"normal",weight:"normal"}},"Homemade Apple Regular":{font:{family:"Homemade Apple",style:"normal",weight:"normal"}},"IM FELL DW Pica PRO Italic":{font:{family:"IM FELL DW Pica PRO",style:"italic",weight:"normal"}},"IM FELL DW Pica PRO Regular":{font:{family:"IM FELL DW Pica PRO",style:"normal",weight:"normal"}},"Josefin Sans Regular":{font:{family:"Josefin Sans",style:"normal",weight:"normal"}},"Josefin Sans Semibold Italic":{font:{family:"Josefin Sans Semibold",style:"italic",weight:"bold"}},"Josefin Slab Bold":{font:{family:"Josefin Slab",style:"normal",weight:"bold"}},"Josefin Slab Bold Italic":{font:{family:"Josefin Slab",style:"italic",weight:"bold"}},"Josefin Slab Italic":{font:{family:"Josefin Slab",style:"italic",weight:"normal"}},"Josefin Slab Light Italic":{font:{family:"Josefin Slab Light",style:"italic",weight:"normal"}},"Josefin Slab Regular":{font:{family:"Josefin Slab",style:"normal",weight:"normal"}},"Josefin Slab Semibold Italic":{font:{family:"Josefin Slab Semibold",style:"italic",weight:"bold"}},"Josefin Slab Thin Italic":{font:{family:"Josefin Slab Thin",style:"italic",weight:"normal"}},"Just Another Hand Regular":{font:{family:"Just Another Hand",style:"normal",weight:"normal"}},"Muli Italic":{font:{family:"Muli",style:"italic",weight:"normal"}},"Muli Light":{font:{family:"Muli Light",style:"normal",weight:"normal"}},"Muli Light Italic":{font:{family:"Muli Light",style:"italic",weight:"normal"}},"Muli Regular":{font:{family:"Muli",style:"normal",weight:"normal"}},"Oswald Regular":{font:{family:"Oswald",style:"normal",weight:"normal"}},"Pacifico Regular":{font:{family:"Pacifico",style:"normal",weight:"normal"}},"Raleway Bold":{font:{family:"Raleway",style:"normal",weight:"bold"}},"Raleway Italic":{font:{family:"Raleway",style:"italic",weight:"normal"}},"Raleway Regular":{font:{family:"Raleway",style:"normal",weight:"normal"}},"Reenie Beanie Regular":{font:{family:"Reenie Beanie",style:"normal",weight:"normal"}},"Roboto Light Italic":{font:{family:"Roboto Light",style:"italic",weight:"normal"}},"Roboto Regular":{font:{family:"Roboto",style:"normal",weight:"normal"}},"Sacramento Regular":{font:{family:"Sacramento",style:"normal",weight:"normal"}},"Source Sans Pro Bold":{font:{family:"Source Sans Pro",style:"normal",weight:"bold"}},"Source Sans Pro Italic":{font:{family:"Source Sans Pro",style:"italic",weight:"normal"}},"Source Sans Pro Light":{font:{family:"Source Sans Pro",style:"normal",weight:"normal"}},"Source Sans Pro Regular":{font:{family:"Source Sans Pro",style:"normal",weight:"normal"}},"Special Elite Regular":{font:{family:"Special Elite",style:"normal",weight:"normal"}},"Vollkorn Bold":{font:{family:"Vollkorn",style:"normal",weight:"bold"}},"Vollkorn Regular":{font:{family:"Vollkorn",style:"normal",weight:"normal"}},"Vollkorn SC Bold":{font:{family:"Vollkorn SC",style:"normal",weight:"bold"}},"Vollkorn SC Regular":{font:{family:"Vollkorn SC",style:"normal",weight:"normal"}},"Waiting for the Sunrise Regular":{font:{family:"Waiting for the Sunrise",style:"normal",weight:"normal"}}}).map((e,t)=>(0,n.jsx)(g.Option,{title:e,value:e,label:e,children:e},t))})}),(0,n.jsx)("div",{className:"params-setting-row-two w-100 d-flex align-items-center justify-content-between mb-3 pt-1",children:this.Color&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:60},min:5,max:125,required:!0,value:null===(a=null==p?void 0:p.font)||void 0===a?void 0:a.size,onChange:this.handleSizeChanged,title:f+":"+(null===(l=null==p?void 0:p.font)||void 0===l?void 0:l.size),"aria-label":f+":"+(null===(r=null==p?void 0:p.font)||void 0===r?void 0:r.size)}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(Me.ColorPicker,{disableAlpha:!1,onChange:this.handleColorChanged,color:te(this.Color.fromArray(ae(p.color))),title:b+":"+te(this.Color.fromArray(ae(p.color))),"aria-label":b+":"+te(this.Color.fromArray(ae(p.color)))}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(Me.ColorPicker,{type:"icon-only",icon:(0,n.jsx)(Oe,{color:te(this.Color.fromArray(ae(p.haloColor)))}),color:te(this.Color.fromArray(ae(p.haloColor))),onChange:this.handleHaloColorChanged,title:w+":"+te(this.Color.fromArray(ae(p.haloColor))),"aria-label":w+":"+te(this.Color.fromArray(ae(p.haloColor)))}),(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:60},min:0,max:10,required:!0,value:p.haloSize,onChange:this.handleHaloSizeChanged,title:v+":"+p.haloSize,"aria-label":v+":"+p.haloSize})]})}),!this.is3DMode()&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)("div",{className:"d-flex w-100 align-items-center",children:y}),(0,n.jsxs)("div",{className:"d-flex w-100 justify-content-between align-items-center mb-3 pt-1",children:[(0,n.jsx)(g.Slider,{className:"slider mr-2","data-field":"space",onChange:this.handleSliderAngleChanged,value:p.angle,title:y+": "+p.angle,min:0,max:360,style:{flex:1}}),(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:60},min:0,max:360,required:!0,value:p.angle,onChange:this.handleAngleChanged})]})]}),(0,n.jsx)("div",{className:"d-flex w-100 align-items-center",children:S}),(0,n.jsx)("div",{className:"text-opacity-row w-100 d-flex align-items-center justify-content-between mb-3 pt-1",children:this.Color&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)(g.Slider,{className:"slider mr-2","data-field":"space",onChange:e=>{this.handleColorAlphaChanged(parseFloat(e.currentTarget.value))},value:this.props.symbol.color.a,title:oe(S,(100*(null===(d=null===(c=this.props.symbol)||void 0===c?void 0:c.color)||void 0===d?void 0:d.a)).toFixed(1)),step:.1,min:0,max:1,style:{flex:1}}),(0,n.jsx)(Se,{mode:"number",symbol:this.props.symbol,opacityPercentage:Number((100*this.props.symbol.color.a).toFixed(1)),onValueChanged:this.handleColorAlphaChanged})]})}),(0,n.jsxs)(g.Label,{check:!0,className:"d-flex justify-content-between pb-3",children:[M,(0,n.jsx)(g.Switch,{className:"d-flex","aria-label":M,checked:this.state.enableBackground,onChange:()=>{this.handleIsShowLocationMeasurementChanged(!this.state.enableBackground)}})]}),this.state.enableBackground&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)("div",{className:"d-flex w-100 align-items-center",children:this.props.intl.formatMessage({id:"color",defaultMessage:g.defaultMessages.color})}),(0,n.jsx)("div",{className:"params-setting-row-color w-100 d-flex align-items-center justify-content-between mb-3 pt-1",children:this.Color&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)(Me.ColorPicker,{disableAlpha:!1,color:te(this.Color.fromArray(ae(u))),onChange:this.handleBackgroundColorChanged}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(g.Slider,{className:"slider","data-field":"space",onChange:e=>{this.handleBackgroundColorAlphaChanged(parseFloat(e.currentTarget.value))},value:ae(u)[3],title:oe(S,(100*ae(u)[3]).toFixed(1)),step:.1,min:0,max:1})]})}),!this.is3DMode()&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)("div",{className:"d-flex w-100 align-items-center",children:this.props.intl.formatMessage({id:"drawToolOutline",defaultMessage:g.defaultMessages.drawToolOutline})}),(0,n.jsx)("div",{className:"params-setting-row-outline w-100 d-flex align-items-center justify-content-between pt-1 pb-2",children:this.Color&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)(Me.ColorPicker,{disableAlpha:!1,color:te(this.Color.fromArray(ae(h))),onChange:this.handleBorderLineColorChanged}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(g.NumericInput,{size:"sm",style:{width:60},min:0,max:18,required:!0,value:m,onChange:this.handleBorderLineSizeChanged}),(0,n.jsx)("div",{className:"divide-line"}),(0,n.jsx)(g.Slider,{className:"slider","data-field":"space",onChange:e=>{this.handleBorderLineColorAlphaChanged(parseFloat(e.currentTarget.value))},value:ae(h)[3],title:oe(S,(100*ae(h)[3]).toFixed(1)),step:.1,min:0,max:1})]})})]})]})]})})}}var Ae;!function(e){e.Point="Point",e.Polyline="Polyline",e.Polygon="Polygon",e.Text="Text"}(Ae||(Ae={}));const Ee=i.React.memo(e=>{const o=(0,t.useTheme)(),s=(0,i.useIntl)(),{onPointSymbolChanged:a,onPolylineSymbolChanged:l,onPolygonSymbolChanged:r,onTextSymbolChanged:c,onA11yFocus:d,showSymbolPreview:p=!0}=e,u=ye(),h=u(e.symbol,e.jimuSymbolType),[m,y]=i.React.useState(h);i.React.useEffect(()=>{y(u(e.symbol,e.jimuSymbolType))},[e.symbol,e.jimuSymbolType,u]);const S=i.React.useCallback(e=>{y(e),void 0!==a&&a(e)},[y,a]),M=i.React.useCallback(e=>{y(e),void 0!==l&&l(e)},[y,l]),f=i.React.useCallback(e=>{y(e),void 0!==r&&r(e)},[y,r]),b=i.React.useCallback(e=>{y(e),void 0!==c&&c(e)},[y,c]);i.React.useEffect(()=>{d()},[e.jimuSymbolType,d]);const[w,v]=i.React.useState(!e.isShow);i.hooks.useUpdateEffect(()=>{v(!1)},[e.isShow]);const x=e.jimuSymbolType===Ae.Point,N=e.jimuSymbolType===Ae.Polyline,C=e.jimuSymbolType===Ae.Polygon,I=e.jimuSymbolType===Ae.Text,j=e.isShow?"d-flex":"d-none",L=x?"d-flex "+g.FOCUSABLE_CONTAINER_CLASS:"d-none",D=N?"d-flex "+g.FOCUSABLE_CONTAINER_CLASS:"d-none",T=C?"d-flex "+g.FOCUSABLE_CONTAINER_CLASS:"d-none",O=I?"d-flex "+g.FOCUSABLE_CONTAINER_CLASS:"d-none";return(0,n.jsxs)("div",{className:(0,i.classNames)(e.className,"jimu-symbol-list px-4 py-1 pb-4"),css:Ne(o),children:[p&&(x||N||C||I)&&(0,n.jsxs)("div",{className:"pt-0",children:[" ",(0,n.jsx)(me,{symbol:m})," "]}),!w&&(0,n.jsxs)("div",{className:j,children:[(0,n.jsx)("div",{className:"w-100 "+L,children:(0,n.jsx)(be,{intl:s,theme:o,symbol:m,onSymbolChanged:S,onA11yFocus:d})}),(0,n.jsx)("div",{className:"w-100 "+D,children:(0,n.jsx)(Ce,{intl:s,theme:o,symbol:m,onSymbolChanged:M,onA11yFocus:e.onA11yFocus})}),(0,n.jsx)("div",{className:"w-100 "+T,children:(0,n.jsx)(je,{intl:s,theme:o,symbol:m,onSymbolChanged:f,onA11yFocus:e.onA11yFocus})}),(0,n.jsx)("div",{className:"w-100 "+O,children:(0,n.jsx)(Pe,{jimuMapView:e.jimuMapView,intl:s,theme:o,symbol:m,defaultText:null==h?void 0:h.text,onSymbolChanged:b,onA11yFocus:e.onA11yFocus})})]})]})}),Re=()=>i.css`
    .content-container {
      width: 250px; /* width for FF ,#14111 */
    }
  `,{useState:ke,useEffect:ze,useCallback:Ue,useRef:Ve}=i.React,Fe=i.React.memo(e=>{var o;const s=(0,t.useTheme)(),a=Ve(null),{onPopperToggle:l}=e,[r,c]=ke(!1),d=Ue((e,t)=>{let i=e,o=r!==e;t&&(o=!0,i=!1),o&&c(e),"function"==typeof l&&o&&l(e)},[l,r]);ze(()=>()=>{d(!1,!0)},[]);const p=Ue((e,t)=>{let o=!1;("pageOrSizeMode"===t||e.key&&"Escape"===(null==e?void 0:e.key))&&(o=!0),e.key||(o=!0),o&&(d(!1,!0),(0,i.focusElementInKeyboardMode)(null==a?void 0:a.current))},[d,a]),[u,h]=ke(0);i.hooks.useUpdateEffect(()=>{h(e=>e+1)},[r]);const[m,y]=i.React.useState(!0);i.hooks.useUpdateEffect(()=>{m||y(!0)},[m]);const S=i.React.useCallback(()=>{y(!1)},[y]),{onPointSymbolChanged:M,onPolylineSymbolChanged:f,onPolygonSymbolChanged:b,onTextSymbolChanged:w,onCreated:v}=e,x=ye(),N=x(e.symbol,e.jimuSymbolType),[C,I]=ke(N);i.React.useEffect(()=>{I(x(e.symbol,e.jimuSymbolType))},[e.symbol,e.jimuSymbolType,x]);const j=Ue(e=>{I(e),void 0!==M&&M(e)},[I,M]),L=Ue(e=>{I(e),void 0!==f&&f(e)},[I,f]),D=Ue(e=>{I(e),void 0!==b&&b(e)},[I,b]),T=Ue(e=>{I(e),void 0!==w&&w(e)},[I,w]);ze(()=>{"function"==typeof v&&v({symbol:N})},[v,N]);const O={boundary:document.body,rootBoundary:"document"},P=null===(o=e.isShowPreviewBtn)||void 0===o||o;return(0,n.jsxs)("div",{className:"jimu-symbol-selector",children:[P&&(0,n.jsx)(he,{theme:s,jimuSymbolType:e.jimuSymbolType,isSelectorPreview:!0,symbol:C,onClick:()=>{d(!r)},className:"symbol-selector-preview-btn",btnSize:e.btnSize,btnRef:a}),(null==a?void 0:a.current)&&(0,n.jsx)(g.Popper,{reference:a.current,placement:"bottom",arrowOptions:!0,open:r,keepMount:!0,version:u,toggle:p,autoFocus:m,forceLatestFocusElements:!0,css:Re(),shiftOptions:O,children:(0,n.jsx)("div",{className:"content-container",children:(0,n.jsx)(Ee,{symbol:C,jimuSymbolType:e.jimuSymbolType,isShow:r,className:"content-container",onPointSymbolChanged:j,onPolylineSymbolChanged:L,onPolygonSymbolChanged:D,onTextSymbolChanged:T,onA11yFocus:S})})})]})}),Be=(0,t.withStyles)((0,t.withTheme)(Fe),"SymbolSelector"),Ge="SymbolChanged",We="JimuSymbolTypeChanged",He="SymbolCallBacksChanged",Qe="DefaultSymbolsChanged",Je="PointSymbolChanged",Ye="PolylineSymbolChanged",qe="PolygonSymbolChanged",$e="TextSymbolChanged",Ze=e=>({type:We,payload:e}),_e=e=>{var t,i,o,s;return{symbol:null,jimuSymbolType:null,callBacks:{onPointSymbolChanged:null,onPolylineSymbolChanged:null,onPolygonSymbolChanged:null,onTextSymbolChanged:null},defaultSymbols:{pointSymbol:null!==(t=null==e?void 0:e.pointSymbol)&&void 0!==t?t:null,polylineSymbol:null!==(i=null==e?void 0:e.polylineSymbol)&&void 0!==i?i:null,polygonSymbol:null!==(o=null==e?void 0:e.polygonSymbol)&&void 0!==o?o:null,textSymbol:null!==(s=null==e?void 0:e.textSymbol)&&void 0!==s?s:null},pointSymbol:null,polylineSymbol:null,polygonSymbol:null,textSymbol:null}},Ke=(e,t)=>{switch(t.type){case Ge:return Object.assign(Object.assign({},e),{symbol:t.payload});case Qe:return Object.assign(Object.assign({},e),{defaultSymbols:t.payload});case He:return Object.assign(Object.assign({},e),{callBacks:Object.assign(e.callBacks,t.payload)});case We:return Object.assign(Object.assign({},e),{jimuSymbolType:t.payload});case Je:return Object.assign(Object.assign({},e),{pointSymbol:t.payload});case Ye:return Object.assign(Object.assign({},e),{polylineSymbol:t.payload});case qe:return Object.assign(Object.assign({},e),{polygonSymbol:t.payload});case $e:return Object.assign(Object.assign({},e),{textSymbol:t.payload});default:throw new Error}},Xe=i.React.createContext(null),et=e=>{const[t,o]=i.React.useReducer(Ke,e.initStates,_e);return(0,n.jsx)(Xe.Provider,{value:{symbolContextStates:t,dispatchSymbolActions:o},children:e.children})};var tt,it;!function(e){e.Point="point",e.Polyline="polyline",e.Polygon="polygon",e.Rectangle="rectangle",e.Circle="circle",e.Text="text",e.FreehandPolyline="freehandPolyline",e.FreehandPolygon="freehandPolygon"}(tt||(tt={})),function(e){e.RectangleSelection="rectangle-selection",e.LassoSelection="lasso-selection"}(it||(it={}));const ot="customEditTool";var st,at,nt;!function(e){e.RelativeToGround="relative-to-ground",e.RelativeToScene="relative-to-scene",e.OnTheGround="on-the-ground"}(st||(st={})),function(e){e.Single="single",e.Continuous="continuous",e.Update="update"}(at||(at={})),function(e){e.Flexible="Flexible",e.Prescriptive="Prescriptive"}(nt||(nt={}));var lt,rt,ct,dt;!function(e){e.Acres="acres",e.Ares="ares",e.Hectares="hectares",e.SquareFeet="square-feet",e.SquareMeters="square-meters",e.SquareYards="square-yards",e.SquareKilometers="square-kilometers",e.SquareMiles="square-miles"}(lt||(lt={})),function(e){e.Meters="meters",e.Feet="feet",e.Kilometers="kilometers",e.Miles="miles",e.NauticalMiles="nautical-miles",e.Yards="yards"}(rt||(rt={})),function(e){e.DD="dd",e.DMS="dms"}(ct||(ct={})),function(e){e.Position="pos",e.GeodesicLength="geodesicLength",e.PlanarLength="planarLength",e.GeodesicArea="geodesicArea",e.PlanarArea="planarArea"}(dt||(dt={}));const pt=()=>{const e=e=>(0,i.useIntl)().formatMessage({id:e,defaultMessage:g.defaultMessages[e]});return[{activated:!0,type:Ae.Point,value:ct.DD,note:e("unitsLabelDD"),label:"Y\xb0N, X\xb0E"},{activated:!0,type:Ae.Point,value:ct.DMS,note:e("unitsLabelDMS"),label:"Y\xb0A'B\"N, X\xb0C'D\"E"},{activated:!0,type:Ae.Polyline,value:rt.Kilometers,note:e("unitsLabelKilometers"),label:"km"},{activated:!0,type:Ae.Polyline,value:rt.Meters,note:e("unitsLabelMeters"),label:"m"},{activated:!0,type:Ae.Polyline,value:rt.Miles,note:e("unitsLabelMiles"),label:"mi"},{activated:!0,type:Ae.Polyline,value:rt.Feet,note:e("unitsLabelFeet"),label:"ft"},{activated:!0,type:Ae.Polyline,value:rt.NauticalMiles,note:e("unitsLabelNauticalMiles"),label:"nmi"},{activated:!0,type:Ae.Polyline,value:rt.Yards,note:e("unitsLabelYards"),label:"yd"},{activated:!0,type:Ae.Polygon,value:lt.SquareKilometers,note:e("unitsLabelSquareKilometers"),label:"sq km"},{activated:!0,type:Ae.Polygon,value:lt.SquareMeters,note:e("unitsLabelSquareMeters"),label:"sq m"},{activated:!0,type:Ae.Polygon,value:lt.Hectares,note:e("unitsLabelHectares"),label:"ha"},{activated:!0,type:Ae.Polygon,value:lt.Acres,note:e("unitsLabelAcres"),label:"ac"},{activated:!0,type:Ae.Polygon,value:lt.SquareMiles,note:e("unitsLabelSquareMiles"),label:"sq mi"},{activated:!0,type:Ae.Polygon,value:lt.SquareFeet,note:e("unitsLabelSquareFeet"),label:"sq ft"},{activated:!0,type:Ae.Polygon,value:lt.SquareYards,note:e("unitsLabelSquareYards"),label:"sq yd"}]},ut="MeasurementsRuntimeInfoChanged",ht="MeasurementsUnitsInfosChanged",mt=e=>({type:ut,payload:e||{}}),gt=e=>({measurementsRuntimeInfo:(0,i.Immutable)({enableMeasurements:!1,isMeasuring:!1,isShowLocationM:!1,isShowLengthM:!1,isShowAreaM:!1,isShowPerimeterM:!1,coordUnit:null,linearUnit:null,arealUnit:null,perimeterUnit:null,fontsColor:"",fontsSize:14,haloColor:"",haloSize:1,decimalPlaces:{point:3,line:3,area:3}}),measurementsUnitsInfos:e}),yt=(e,t)=>{switch(t.type){case ut:return Object.assign(Object.assign({},e),{measurementsRuntimeInfo:e.measurementsRuntimeInfo.merge(t.payload,{deep:!0})});case ht:return t.payload&&void 0!==t.payload.length&&t.payload.length>0?Object.assign(Object.assign({},e),{measurementsUnitsInfos:t.payload}):Object.assign({},e);default:throw new Error}},St=i.React.createContext(null),Mt=e=>{const t=pt(),[o,s]=i.React.useReducer(yt,t,gt);return(0,n.jsx)(St.Provider,{value:{measurementsContextStates:o,dispatchMeasurementsActions:s},children:e.children})},ft=(e,t)=>{let i=[];switch(e){case Ae.Point:i=bt(t);break;case Ae.Polyline:i=wt(t);break;case Ae.Polygon:i=vt(t);break;default:i=[{activated:"",value:"",note:"",label:""}]}return i},bt=e=>e.filter(e=>e.type===Ae.Point),wt=e=>e.filter(e=>e.type===Ae.Polyline),vt=e=>e.filter(e=>e.type===Ae.Polygon),xt=(e,t)=>{let i;switch(e){case Ct.Coord:i=Ae.Point;break;case Ct.Perimeter:case Ct.Linear:i=Ae.Polyline;break;case Ct.Areal:i=Ae.Polygon}const o=t.filter(e=>e.type===i).find(e=>e.activated);return o?o.value:null},Nt=(e,t,i)=>{let o;switch(e){case Ct.Coord:o=t.coordUnit;break;case Ct.Linear:o=t.linearUnit;break;case Ct.Areal:o=t.arealUnit;break;case Ct.Perimeter:o=t.perimeterUnit}return void 0!==i.find(e=>!e.activated&&e.value===o)};var Ct;!function(e){e.Coord="coord",e.Linear="linear",e.Areal="areal",e.Perimeter="perimeter"}(Ct||(Ct={}));const It=i.React.memo(e=>{const t=pt(),[o,s]=i.React.useState(()=>ft(Ae.Point,t)),[a,l]=i.React.useState(()=>ft(Ae.Polyline,t)),[r,c]=i.React.useState(()=>ft(Ae.Polygon,t)),[d,p]=i.React.useState((0,i.Immutable)({enableMeasurements:e.measurementsRuntimeInfo.enableMeasurements,isMeasuring:!1,isShowLocationM:!1,isShowLengthM:!1,isShowAreaM:!1,isShowPerimeterM:!1,coordUnit:xt(Ct.Coord,e.measurementsUnitsInfos),linearUnit:xt(Ct.Linear,e.measurementsUnitsInfos),arealUnit:xt(Ct.Areal,e.measurementsUnitsInfos),perimeterUnit:xt(Ct.Perimeter,e.measurementsUnitsInfos),fontsColor:e.measurementsRuntimeInfo.fontsColor,fontsSize:e.measurementsRuntimeInfo.fontsSize,haloColor:e.measurementsRuntimeInfo.haloColor,haloSize:e.measurementsRuntimeInfo.haloSize})),u=i.React.useCallback(()=>{const t=o.map(t=>{let i=Object.assign({},t);return e.measurementsUnitsInfos.forEach(e=>{e.value===t.value&&(i=Object.assign(Object.assign({},i),e))}),i});s(t)},[e.measurementsUnitsInfos,s,e.currentJimuSymbolType]),h=i.React.useCallback(()=>{const t=a.map(t=>{let i=Object.assign({},t);return e.measurementsUnitsInfos.forEach(e=>{e.value===t.value&&(i=Object.assign(Object.assign({},i),e))}),i});l(t)},[e.measurementsUnitsInfos,l,e.currentJimuSymbolType]),m=i.React.useCallback(()=>{const t=r.map(t=>{let i=Object.assign({},t);return e.measurementsUnitsInfos.forEach(e=>{e.value===t.value&&(i=Object.assign(Object.assign({},i),e))}),i});c(t)},[e.measurementsUnitsInfos,c,e.currentJimuSymbolType]);i.React.useEffect(()=>{function t(){let t=(0,i.Immutable)({});const o=Nt(Ct.Linear,d,e.measurementsUnitsInfos);if(o){const i=xt(Ct.Linear,e.measurementsUnitsInfos);t=t.setIn(["linearUnit"],i)}const s=Nt(Ct.Perimeter,d,e.measurementsUnitsInfos);if(s){const i=xt(Ct.Perimeter,e.measurementsUnitsInfos);t=t.setIn(["perimeterUnit"],i)}(o||s)&&p(d.merge(t))}switch(e.currentJimuSymbolType){case Ae.Point:u(),function(){if(Nt(Ct.Coord,d,e.measurementsUnitsInfos)){const t=xt(Ct.Coord,e.measurementsUnitsInfos);p(d.setIn(["coordUnit"],t))}}();break;case Ae.Polyline:h(),t();break;case Ae.Polygon:h(),t(),m(),function(){if(Nt(Ct.Areal,d,e.measurementsUnitsInfos)){const t=xt(Ct.Areal,e.measurementsUnitsInfos);p(d.setIn(["arealUnit"],t))}}()}},[e.measurementsUnitsInfos]),i.React.useEffect(()=>{switch(e.predefinedJimuSymbolType){case Ae.Point:u();break;case Ae.Polyline:h();break;case Ae.Polygon:h(),m()}},[e.predefinedJimuSymbolType,e.measurementsUnitsInfos,u,h,m]),i.React.useEffect(()=>{e.predefinedJimuSymbolType===e.currentJimuSymbolType&&e.onMInfoSingletonChanged(d.merge({enableMeasurements:e.measurementsRuntimeInfo.enableMeasurements,fontsColor:e.measurementsRuntimeInfo.fontsColor,fontsSize:e.measurementsRuntimeInfo.fontsSize}))},[d,e.currentJimuSymbolType,e.measurementsRuntimeInfo.enableMeasurements,e.measurementsRuntimeInfo.fontsColor,e.measurementsRuntimeInfo.fontsSize]);i.React.useEffect(()=>{let t=!1;switch(e.currentJimuSymbolType){case Ae.Point:t=d.isShowLocationM;break;case Ae.Polyline:t=d.isShowLengthM;break;case Ae.Polygon:t=d.isShowAreaM||d.isShowPerimeterM}p(d.setIn(["isMeasuring"],t))},[e.currentJimuSymbolType,d.isShowLocationM,d.isShowLengthM,d.isShowAreaM,d.isShowPerimeterM]);const y=(0,i.useIntl)().formatMessage({id:"drawToolShowLocationMeasurement",defaultMessage:g.defaultMessages.drawToolShowLocationMeasurement}),S=(0,i.useIntl)().formatMessage({id:"drawToolShowLengthMeasurement",defaultMessage:g.defaultMessages.drawToolShowLengthMeasurement}),M=(0,i.useIntl)().formatMessage({id:"drawToolShowAreaMeasurement",defaultMessage:g.defaultMessages.drawToolShowAreaMeasurement}),f=(0,i.useIntl)().formatMessage({id:"drawToolShowPerimeterMeasurement",defaultMessage:g.defaultMessages.drawToolShowPerimeterMeasurement}),b=(0,i.useIntl)().formatMessage({id:"drawToolUnit",defaultMessage:g.defaultMessages.drawToolUnit});return(0,n.jsx)("div",{className:"measurements-setting-panel w-100 pt-0 px-4 pb-3",children:e.measurementsRuntimeInfo.enableMeasurements&&(0,n.jsxs)(i.React.Fragment,{children:[e.predefinedJimuSymbolType===Ae.Point&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)(g.Label,{className:"d-flex unit-label justify-content-between align-items-center",title:y,children:[(0,n.jsx)("div",{className:"d-flex mr-2",children:y}),(0,n.jsx)(g.Switch,{className:"d-flex","aria-label":y,checked:d.isShowLocationM,onChange:()=>{var e;e=!d.isShowLocationM,p(d.setIn(["isShowLocationM"],e))}})]}),d.isMeasuring&&(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-2",children:[(0,n.jsx)(g.Label,{className:"d-flex unit-label flex-wrap justify-content-start align-items-center mr-5 mb-0",title:b,children:b}),(0,n.jsx)(g.Select,{size:"sm",className:"d-flex unit-selector justify-content-center mt-1 mb-1 ml-4 p-1 ","aria-label":b,value:d.coordUnit,onChange:e=>{const t=e.target.value;p(d.setIn(["coordUnit"],t))},children:o.map((e,t)=>e.activated&&(0,n.jsx)(g.Option,{title:null==e?void 0:e.note,value:null==e?void 0:e.value,label:null==e?void 0:e.label,children:null==e?void 0:e.note},t))})]})]}),e.predefinedJimuSymbolType===Ae.Polyline&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)(g.Label,{className:"d-flex unit-label justify-content-between align-items-center",title:S,children:[(0,n.jsx)("div",{className:"d-flex mr-2",children:S}),(0,n.jsx)(g.Switch,{className:"d-flex","aria-label":S,checked:d.isShowLengthM,onChange:()=>{var e;e=!d.isShowLengthM,p(d.setIn(["isShowLengthM"],e))}})]}),d.isMeasuring&&(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-2",children:[(0,n.jsx)(g.Label,{className:"d-flex unit-label justify-content-start align-items-center mr-5 mb-0",title:b,children:b}),(0,n.jsx)(g.Select,{size:"sm",className:"d-flex unit-selector justify-content-center mt-1 mb-1 ml-4 p-1 ","aria-label":b,value:d.linearUnit,onChange:e=>{const t=e.target.value;p(d.setIn(["linearUnit"],t))},children:a.map((e,t)=>e.activated&&(0,n.jsx)(g.Option,{title:null==e?void 0:e.note,value:null==e?void 0:e.value,label:null==e?void 0:e.label,children:null==e?void 0:e.note},t))})]})]}),e.predefinedJimuSymbolType===Ae.Polygon&&(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)(g.Label,{className:"d-flex unit-label justify-content-between align-items-center mb-0",title:M,children:[(0,n.jsx)("div",{className:"d-flex mr-2",children:M}),(0,n.jsx)(g.Switch,{className:"d-flex","aria-label":M,checked:d.isShowAreaM,onChange:()=>{var e;e=!d.isShowAreaM,p(d.setIn(["isShowAreaM"],e))}})]}),d.isShowAreaM&&(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-2",children:[(0,n.jsx)(g.Label,{className:"d-flex unit-label justify-content-start align-items-center mr-5 mb-0",title:b,children:b}),(0,n.jsx)(g.Select,{size:"sm",className:"d-flex unit-selector justify-content-center mt-1 mb-1 ml-4 p-1 ","aria-label":b,value:d.arealUnit,onChange:e=>{const t=e.target.value;p(d.setIn(["arealUnit"],t))},children:r.map((e,t)=>e.activated&&(0,n.jsx)(g.Option,{title:null==e?void 0:e.note,value:null==e?void 0:e.value,label:null==e?void 0:e.label,children:null==e?void 0:e.note},t))})]})]}),(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsxs)(g.Label,{className:"d-flex unit-label justify-content-between align-items-center pt-4 mb-0",title:f,children:[(0,n.jsx)("div",{className:"d-flex mr-2",children:f}),(0,n.jsx)(g.Switch,{className:"d-flex","aria-label":f,checked:d.isShowPerimeterM,onChange:()=>{var e;e=!d.isShowPerimeterM,p(d.setIn(["isShowPerimeterM"],e))}})]}),d.isShowPerimeterM&&(0,n.jsxs)("div",{className:"d-flex justify-content-between align-items-center mt-2",children:[(0,n.jsx)(g.Label,{className:"d-flex unit-label justify-content-start align-items-center mr-5 mb-0",title:b,children:b}),(0,n.jsx)(g.Select,{size:"sm",className:"d-flex unit-selector unit-selector justify-content-center mt-1 mb-1 ml-4 p-1 ","aria-label":b,value:d.perimeterUnit,onChange:e=>{const t=e.target.value;p(d.setIn(["perimeterUnit"],t))},children:a.map((e,t)=>e.activated&&(0,n.jsx)(g.Option,{title:null==e?void 0:e.note,value:null==e?void 0:e.value,label:null==e?void 0:e.label,children:null==e?void 0:e.note},t))})]})]})]})]})})});const jt=i.React.memo(e=>{var t;const[o,s]=i.React.useState(null);i.React.useEffect(()=>{e.onMeasurementsInfoChanged(o)},[o]);const a=e.jimuSymbolType===Ae.Point?"d-flex":"d-none",l=e.jimuSymbolType===Ae.Polyline?"d-flex":"d-none",r=e.jimuSymbolType===Ae.Polygon?"d-flex":"d-none",c=null!==(t=null==o?void 0:o.enableMeasurements)&&void 0!==t&&t;return(0,n.jsxs)("div",{className:"measurements-container "+(c?" ":"d-none "),css:i.css`
    &.measurements-container {
      .measurements-setting-panel {
        .unit-label {
          cursor: pointer;
          word-break: keep-all;
        }
        .unit-selector {
          overflow: hidden;
        }
      }
    }
  `,children:[(0,n.jsx)("div",{className:a,children:(0,n.jsx)(It,{predefinedJimuSymbolType:Ae.Point,currentJimuSymbolType:e.jimuSymbolType,measurementsRuntimeInfo:e.measurementsRuntimeInfo,measurementsUnitsInfos:e.measurementsUnitsInfos,onMInfoSingletonChanged:s})}),(0,n.jsx)("div",{className:l,children:(0,n.jsx)(It,{predefinedJimuSymbolType:Ae.Polyline,currentJimuSymbolType:e.jimuSymbolType,measurementsRuntimeInfo:e.measurementsRuntimeInfo,measurementsUnitsInfos:e.measurementsUnitsInfos,onMInfoSingletonChanged:s})}),(0,n.jsx)("div",{className:r,children:(0,n.jsx)(It,{predefinedJimuSymbolType:Ae.Polygon,currentJimuSymbolType:e.jimuSymbolType,measurementsRuntimeInfo:e.measurementsRuntimeInfo,measurementsUnitsInfos:e.measurementsUnitsInfos,onMInfoSingletonChanged:s})})]})}),Lt=i.React.memo(e=>(0,n.jsxs)(i.React.Fragment,{children:[(0,n.jsx)(Ee,{jimuMapView:e.jimuMapView,symbol:e.symbol,jimuSymbolType:e.jimuSymbolType,isShow:e.isShow,onPointSymbolChanged:e.onPointSymbolChanged,onPolylineSymbolChanged:e.onPolylineSymbolChanged,onPolygonSymbolChanged:e.onPolygonSymbolChanged,onTextSymbolChanged:e.onTextSymbolChanged,onA11yFocus:e.onA11yFocus}),!e.isCustomEditingFlag&&(0,n.jsx)(jt,{symbol:e.symbol,jimuSymbolType:e.jimuSymbolType,measurementsRuntimeInfo:e.measurementsRuntimeInfo,measurementsUnitsInfos:e.measurementsUnitsInfos,onMeasurementsInfoChanged:e.handleMeasurementsInfoChanged})]}));var Dt;function Tt(e,t){return e?i.css`
      &.auto-width-container {
        max-width: ${t}px
      }
  `:i.css`
      &.auto-width-container {
        min-width: ${t}px
      }
    `}!function(e){e.Panel="Panel",e.Toolbar="Toolbar",e.Hidden="Hidden"}(Dt||(Dt={}));const Ot=i.React.memo(e=>{const o=(0,t.useTheme)(),{measurementsContextStates:s,dispatchMeasurementsActions:a}=i.React.useContext(St),{symbolContextStates:l,dispatchSymbolActions:r}=i.React.useContext(Xe),c=i.React.useCallback(e=>{a(mt(e))},[a]),d=i.React.useCallback(e=>{r((e=>({type:Je,payload:e}))(e))},[r]),p=i.React.useCallback(e=>{r((e=>({type:Ye,payload:e}))(e))},[r]),u=i.React.useCallback(e=>{r((e=>({type:qe,payload:e}))(e))},[r]),h=i.React.useCallback(e=>{r((e=>({type:$e,payload:e}))(e))},[r]),m=i.React.useRef(null);i.React.useEffect(()=>()=>{var t,i;e.sketchContainer&&(null===(t=m.current)||void 0===t||t.unobserve(e.sketchContainer)),null===(i=m.current)||void 0===i||i.disconnect()},[e.sketchContainer]);const[g,y]=i.React.useState(null),S=e.arrangement===Dt.Panel&&e.isAutoWidth&&!!e.sketchContainer;return i.React.useEffect(()=>{e.sketchContainer&&(m.current=new ResizeObserver(i.lodash.throttle(e=>{var t;const i=null===(t=e[0])||void 0===t?void 0:t.target,o=S?i.offsetWidth:i.scrollWidth;y(o)},50)),m.current.observe(e.sketchContainer))},[S,e.sketchContainer]),(0,n.jsx)(i.React.Fragment,{children:(0,n.jsx)("div",{className:"jimu-symbol-selector jimu-symbol-list w-100",css:Ne(o),children:(0,n.jsx)("div",{className:"auto-width-container",css:Tt(S,g),children:(0,n.jsx)(Lt,{jimuMapView:e.jimuMapView,symbol:l.symbol,jimuSymbolType:l.jimuSymbolType,isShow:e.isShow,onPointSymbolChanged:d,onPolylineSymbolChanged:p,onPolygonSymbolChanged:u,onTextSymbolChanged:h,measurementsRuntimeInfo:s.measurementsRuntimeInfo,measurementsUnitsInfos:s.measurementsUnitsInfos,handleMeasurementsInfoChanged:c,isCustomEditingFlag:e.isCustomEditingFlag,onA11yFocus:e.onA11yFocus})})})})}),Pt=r(87616),At=i.React.memo(e=>{var t;const o=(0,i.useIntl)(),{sketchContextStates:s}=i.React.useContext(Wi),[a,l]=i.React.useState(null),r=i.React.useCallback(e=>{var t,i;"function"==typeof(null===(t=s.callBacks)||void 0===t?void 0:t.onJimuDrawCreated)&&(null===(i=s.callBacks)||void 0===i||i.onJimuDrawCreated(e)),e.sketchToolbarDom&&l(e.sketchToolbarDom)},[s.callBacks]),c=i.React.useRef(null),d=i.React.useCallback(()=>{setTimeout(()=>{const e=(0,g.getFocusableElements)(c.current);(0,i.focusElementInKeyboardMode)(e[0])},50)},[]);i.React.useEffect(()=>{d()},[e.popperPositionRef,d]);const p=i.React.useCallback(()=>{let e=!1;return null!=s.activeTool&&it.RectangleSelection!==s.activeTool&&it.LassoSelection!==s.activeTool||(e=!0),e},[s.activeTool]),u=p()?"d-flex":"d-none",h=p()?"d-none":"d-flex",m=null!==(t=e.disableSymbolSelector)&&void 0!==t&&t,y=o.formatMessage({id:"drawToolSelectDrawMode",defaultMessage:g.defaultMessages.drawToolSelectDrawMode});return(0,n.jsxs)("div",{className:"panel-layout-container d-flex p-4 ",children:[(0,n.jsxs)("div",{className:"select-draw-mode-tips",children:[" ",y," "]}),(0,n.jsx)(Ai,{jimuMapView:e.jimuMapView,operatorWidgetId:e.operatorWidgetId,onJimuDrawCreated:r}),(0,n.jsx)("div",{className:"symbol-list-container align-items-center",ref:e=>{c.current=e},children:!m&&(0,n.jsxs)(i.React.Fragment,{children:[u&&(0,n.jsx)("div",{className:"panel-layout-place-holder align-items-center justify-content-center w-100 h-100 "+u,children:(0,n.jsx)("img",{alt:y,src:Pt})}),(0,n.jsx)("div",{className:"panel-layout-symbol-list-container "+h,children:(0,n.jsx)(Ot,{jimuMapView:e.jimuMapView,isShow:!p(),arrangement:Dt.Panel,isAutoWidth:e.isAutoWidth,sketchContainer:a,onA11yFocus:d,isCustomEditingFlag:e.isCustomEditingFlag})})]})})]})}),Et=i.React.memo(e=>{var t,o;const{sketchContextStates:s}=i.React.useContext(Wi),[a,l]=i.React.useState(!1),r=i.React.useCallback((t,i)=>{let o=t,s=a!==o;i&&(s=!0,o=!1),l(o),"function"==typeof e.onPopperToggle&&s&&e.onPopperToggle(o)},[e,a]);i.React.useEffect(()=>()=>{r(!1,!0)},[]);const{currentActiveToolChanged:c}=e,d=i.React.useCallback((t,o)=>{var s;const a="pageOrSizeMode"===o;let n=a,l=!1;if((a||t&&t.key&&"Escape"===(null==t?void 0:t.key))&&(c(null),l=!0,n=!0),l){r(!1,n);const t=null===(s=e.popperPositionRef)||void 0===s?void 0:s.parentElement;t&&(t.tabIndex=0,(0,i.focusElementInKeyboardMode)(t),t.removeAttribute("tabIndex"))}},[e.popperPositionRef,r,c]),[p,u]=i.React.useState(null!==(t=e.popperVersion)&&void 0!==t?t:0);i.React.useEffect(()=>{u(e=>e+1)},[a,e.popperVersion,e.popperPositionRef,e.popperIsVisible]);const[h,m]=i.React.useState(!0);g.hooks.useUpdateEffect(()=>{h||m(!0)},[h,e.popperPositionRef]);const y=i.React.useCallback(()=>{m(!1)},[m]),S={boundary:document.body,rootBoundary:"document"},M=null!==(o=e.disableSymbolSelector)&&void 0!==o&&o;return(0,n.jsxs)("div",{className:"toolbar-layout-container",children:[(0,n.jsx)(Ai,{jimuMapView:e.jimuMapView,operatorWidgetId:e.operatorWidgetId,onJimuDrawCreated:s.callBacks.onJimuDrawCreated}),(0,n.jsx)("div",{className:"symbol-list-container",children:!M&&(0,n.jsx)(g.Popper,{reference:e.popperPositionRef,placement:"bottom",offsetOptions:12,arrowOptions:!0,open:e.isCustomEditingFlag||e.popperIsVisible,keepMount:!0,version:p,toggle:d,autoFocus:h,forceLatestFocusElements:!0,css:Re(),shiftOptions:S,autoUpdate:!0,children:(0,n.jsx)("div",{className:"content-container",children:(0,n.jsx)(Ot,{jimuMapView:e.jimuMapView,isShow:e.isCustomEditingFlag||e.popperIsVisible,onA11yFocus:y,isCustomEditingFlag:e.isCustomEditingFlag})})})})]})});function Rt(e){const t=e.ref.palette.neutral[500];return i.css`
    &.jimu-draw-layouts-container {
      overflow-y: auto;
      /* box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2); */

      .panel-layout-container {
        flex-direction: column;
        min-height: 444px;

        .select-draw-mode-tips {
          min-width: 250px;
          font-size: ${i.polished.rem(13)};
          font-weight: 500;
          line-height: 18px;
          color: var(--sys-color-surface-paper-text);
        }

        .panel-layout-place-holder {
          min-height: 300px;
        }
      }

      .toolbar-layout-container {
        .jimu-draw-tool {
          .jimu-draw-sketch-tools {
            background-color: transparent; /* sub-repo:#27088, bg & border cover tools ONLY */
            border: 1px ${t} solid;
          }

          .jimu-draw-api-loader {
            padding: 0.5rem;
          }
        }
      }
    }

    /* Support API responsive width calculation ,#23565 */
    /* when (width > 280), hidden x scrollbar */
    &.jimu-draw-layouts-container.toolbar.not-autoWidth:not(.scrollable-x) {
      overflow-x: hidden;
    }
    /* support API responsive width calculation ,#27376 */
    /* when (width < 280), the x scrollbar appears */
    &.jimu-draw-layouts-container.scrollable-x {
      overflow: auto;
    }

    &.jimu-draw-layouts-container.panel{
      background-color: var(--sys-color-surface-paper); /* bg & border cover all panel */
      /*border: 1px ${t} solid;*/
    }

    &.jimu-draw-layouts-container.hide-bg-color {
      background-color: transparent !important;

      .jimu-draw-sketch-tools {
        background-color: transparent !important;
      }
    }
    &.jimu-draw-layouts-container.hide-border {
      border: none !important;
      box-shadow: unset !important;

      .jimu-draw-sketch-tools {
        border: none !important;
      }
    }
    &.jimu-draw-layouts-container.is-shape-border {
      border-radius: var(--sys-shape-2);
    }
  `}const kt=i.React.memo(e=>{var o,s,a,l,r,c,d,p,u;const h=(0,t.useTheme)(),{layoutContextStates:m,dispatchLayoutActions:g}=i.React.useContext(Qt),{sketchContextStates:y,dispatchSketchActions:S}=i.React.useContext(Wi),{dispatchSymbolActions:M}=i.React.useContext(Xe);i.React.useEffect(()=>{g(Bt(e.uiOptions)),M(Ze(null))},[e.uiOptions,g,M]);const f=i.React.useCallback(e=>{S(Fi(e))},[S]),b=i.ReactRedux.useSelector(e=>{var t;return(null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.appMode)===i.AppMode.Design}),w=null!==(s=null===(o=e.uiOptions)||void 0===o?void 0:o.arrangement)&&void 0!==s?s:Dt.Toolbar,v=w===Dt.Panel?"panel ":"toolbar ",x=(null===(a=e.uiOptions)||void 0===a?void 0:a.isHideBgColor)?"hide-bg-color ":"",N=(null===(l=e.uiOptions)||void 0===l?void 0:l.isHideBorder)?"hide-border ":"",C=(null===(r=e.uiOptions)||void 0===r?void 0:r.isShape)?" is-shape-border ":"",I=y.activeTool===tt.Point||y.activeTool===tt.Polyline||y.activeTool===tt.Polygon||y.activeTool===tt.Rectangle||y.activeTool===tt.Circle||y.activeTool===tt.FreehandPolyline||y.activeTool===tt.FreehandPolygon||y.activeTool===tt.Text,j=w===Dt.Panel?"surface-1 border-0 ":"",L=(null===(c=e.uiOptions)||void 0===c?void 0:c.isAutoWidth)?" autoWidth ":"not-autoWidth",D=null===(d=y.sketchRef)||void 0===d?void 0:d.updateGraphics;let T=!1;var O;T=w===Dt.Toolbar?"additional-bts-edit"===(null==(O=m.symbolsWrapperPositionRef)?void 0:O.getAttribute("data-testid")):["customEditTool","transform","reshape","move"].includes(y.activeTool);const P=!!(null==D?void 0:D.at(0))&&T,A=i.React.useRef(null),E=i.React.useRef(null);return i.React.useEffect(()=>()=>{var e,t;A.current&&(null===(e=E.current)||void 0===e||e.unobserve(A.current)),null===(t=E.current)||void 0===t||t.disconnect()},[]),i.React.useEffect(()=>{var e;E.current=new ResizeObserver(i.lodash.throttle(e=>{var t,i,o;(null===(t=e[0])||void 0===t?void 0:t.target).offsetWidth<280?null===(i=A.current)||void 0===i||i.classList.add("scrollable-x"):null===(o=A.current)||void 0===o||o.classList.remove("scrollable-x")},50)),null===(e=E.current)||void 0===e||e.observe(A.current)}),(0,n.jsx)(i.React.Fragment,{children:h&&(0,n.jsxs)("div",{className:v+j+"jimu-draw-layouts-container h-100 "+x+N+L+C,css:Rt(h),ref:e=>{A.current=e},children:[w===Dt.Panel&&(0,n.jsx)(i.React.Fragment,{children:(0,n.jsx)(At,{jimuMapView:e.jimuMapView,operatorWidgetId:e.operatorWidgetId,disableSymbolSelector:m.disableSymbolSelector,isAutoWidth:null===(p=e.uiOptions)||void 0===p?void 0:p.isAutoWidth,isAutoHeight:null===(u=e.uiOptions)||void 0===u?void 0:u.isAutoHeight,popperPositionRef:m.symbolsWrapperPositionRef,isCustomEditingFlag:P})}),w===Dt.Toolbar&&(0,n.jsx)(i.React.Fragment,{children:(0,n.jsx)(Et,{jimuMapView:e.jimuMapView,operatorWidgetId:e.operatorWidgetId,disableSymbolSelector:m.disableSymbolSelector,popperPositionRef:m.symbolsWrapperPositionRef,popperIsVisible:I&&m.isExpandSymbolList&&!b,popperVersion:0,currentActiveToolChanged:f,isCustomEditingFlag:P})})]})})}),zt="UIOptionsChanged",Ut="DisableSymbolSelectorChanged",Vt="IsExpandSymbolListChanged",Ft="SymbolsWrapperPositionRefChanged",Bt=e=>({type:zt,payload:null!=e?e:{}}),Gt=e=>({type:Ut,payload:e}),Wt=e=>({enableSymbolSelectorFunRef:null,uiOptions:{arrangement:Dt.Toolbar,isHideBorder:!1,isShape:!0},disableSymbolSelector:!1,isExpandSymbolList:!0,symbolsWrapperPositionRef:null}),Ht=(e,t)=>{switch(t.type){case zt:return Object.assign(Object.assign({},e),{uiOptions:Object.assign(e.uiOptions,t.payload)});case Ut:return Object.assign(Object.assign({},e),{disableSymbolSelector:t.payload});case Vt:return Object.assign(Object.assign({},e),{isExpandSymbolList:t.payload});case Ft:return Object.assign(Object.assign({},e),{symbolsWrapperPositionRef:t.payload});default:throw new Error}},Qt=i.React.createContext(null),Jt=e=>{const[t,o]=i.React.useReducer(Ht,e.initStates,Wt);return t.enableSymbolSelectorFunRef=i.React.useCallback(e=>{o(Gt(e))},[o]),(0,n.jsx)(Qt.Provider,{value:{layoutContextStates:t,dispatchLayoutActions:o},children:e.children})},Yt="Undo",qt="Redo",$t="Clear",Zt="pushRecord",_t=e=>({_MAX_RECORDS_NUM:5,_currentIdx:0,_graphicsRecords:[[]],currentRecord:[],version:0,canUndo:!1,canRedo:!1,canClear:!1}),Kt=(e,t)=>{const i=t._currentIdx+1;i<t._graphicsRecords.length-1?t._graphicsRecords.splice(i,t._MAX_RECORDS_NUM,e):t._graphicsRecords.push(e),t._graphicsRecords.length>t._MAX_RECORDS_NUM&&t._graphicsRecords.shift();const o=t._graphicsRecords.length-1,s=t._graphicsRecords[o];return Object.assign(Object.assign({},t),{_graphicsRecords:t._graphicsRecords,_currentIdx:o,currentRecord:s,canUndo:Xt(o),canRedo:ei(o,t._graphicsRecords),canClear:ti(s)})},Xt=e=>!!(e>0),ei=(e,t)=>!!(e<t.length-1),ti=e=>!!(e&&e.length>0),ii=(e,t)=>e>-1&&e<t._graphicsRecords.length,oi=(e,t)=>{switch(t.type){case Yt:{const t=e._currentIdx-1,i=e._graphicsRecords[t],o=Xt(t),s=ei(t,e._graphicsRecords),a=ti(i);return ii(t,e)?Object.assign(Object.assign({},e),{_currentIdx:t,currentRecord:i,version:e.version+1,canUndo:o,canRedo:s,canClear:a}):Object.assign(Object.assign({},e),{canUndo:o,canRedo:s,canClear:a})}case qt:{const t=e._currentIdx+1,i=e._graphicsRecords[t],o=Xt(t),s=ei(t,e._graphicsRecords),a=ti(i);return ii(t,e)?Object.assign(Object.assign({},e),{_currentIdx:t,currentRecord:i,version:e.version+1,canUndo:o,canRedo:s,canClear:a}):Object.assign(Object.assign({},e),{canUndo:o,canRedo:s,canClear:a})}case $t:return Kt([],e);case Zt:return Kt(t.payload,e);default:throw new Error}},si=i.React.createContext(null),ai=e=>{const[t,o]=i.React.useReducer(oi,e.initStates,_t);return(0,n.jsx)(si.Provider,{value:{graphicsUndoRedoContextStates:t,dispatchGraphicsUndoRedoActions:o},children:e.children})},ni=(e,t)=>{var i,o,s,a,n,l;return{creationMode:(e=>null!=e?e:at.Continuous)(e.creationMode),visibleElements:(e=>{let t=null!=e?e:{settingsMenu:!1};return void 0===(null==e?void 0:e.settingsMenu)&&(t=Object.assign(t,{settingsMenu:!1})),void 0===(null==e?void 0:e.labelsToggle)&&(t=Object.assign(t,{labelsToggle:!1})),t})(e.visibleElements),updateOnGraphicClick:null===(i=e.updateOnGraphicClick)||void 0===i||i,defaultCreateOptions:null!==(o=e.defaultCreateOptions)&&void 0!==o?o:null,defaultUpdateOptions:null!==(s=e.defaultUpdateOptions)&&void 0!==s?s:null,snappingOptions:null!==(a=e.snappingOptions)&&void 0!==a?a:(e=>null!=e?e:{enabled:!1,featureSources:[]})(e.snappingOptions),tooltipOptions:null!==(n=e.tooltipOptions)&&void 0!==n?n:{enabled:!1},labelOptions:null!==(l=e.labelOptions)&&void 0!==l?l:{enabled:!1}}},li=(e,t,i)=>[tt.Polyline,tt.FreehandPolyline].includes(e)?(t.polylineSymbol||(t.polylineSymbol=i(null,Ae.Polyline)),t.polylineSymbol):[tt.Polygon,tt.Rectangle,tt.Circle,tt.FreehandPolygon].includes(e)?(t.polygonSymbol||(t.polygonSymbol=i(null,Ae.Polygon)),t.polygonSymbol):[tt.Text].includes(e)?(t.textSymbol||(t.textSymbol=i(null,Ae.Text)),t.textSymbol):(t.pointSymbol||(t.pointSymbol=i(null,Ae.Point)),t.pointSymbol),ri=e=>{switch(e){case tt.Point:return Ae.Point;case tt.Polyline:case tt.FreehandPolyline:return Ae.Polyline;case tt.Polygon:case tt.Rectangle:case tt.Circle:case tt.FreehandPolygon:return Ae.Polygon;case tt.Text:return Ae.Text;default:return null}},ci=(e,t)=>{null==e||e.forEach(e=>{if(e){const i=!(t||e.attributes&&e.attributes.jimuDrawId);(t||i)&&di(e)}})},di=e=>{e.attributes||(e.attributes={}),e.attributes.jimuDrawId=e.uid},pi=e=>{const t=[];return null==e||e.forEach(e=>{const i=(e=>e&&e.attributes&&e.attributes.jimuDrawId?e.attributes.jimuDrawId:null)(e);null!==i&&t.push(i)}),t},ui=e=>{if(!Array.isArray(e)||0===e.length)return!1;const t=e.map(e=>(e=>{if(!e)return null;switch(e.type){case"simple-marker":case"picture-marker":case"point-3d":return Ae.Point;case"simple-line":case"line-3d":return Ae.Polyline;case"simple-fill":case"polygon-3d":return Ae.Polygon;case"text":return Ae.Text;default:return null}})(e.symbol)).filter(e=>null!==e),i=t[0];return!(!i||t.length!==e.length)&&t.every(e=>e===i)},hi=e=>{var t;let i=null===(t=null==e?void 0:e.geometry)||void 0===t?void 0:t.type;return i===tt.Point&&tt.Text===e.symbol.type&&(i=tt.Text),i};var mi=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};const gi=(e,t,i,o,s,a)=>mi(void 0,void 0,void 0,function*(){const{mode:n,isUpdate:l,IsDeletingFlag:r}=e,{projectionTools:c,Graphic:d,i18nFormatNumber:p,MEASUREMENTS_NLS:u}=s;switch(n){case dt.Position:{const n=yield xi(e,t,i,o,s,a);yield Si(t,i),yield i.applyEdits({addFeatures:n.map(e=>e.labelGraphic)});break}case dt.GeodesicLength:if(r)yield Si(t,i);else{const e=yield Ci({mode:n,isUpdate:l},t,i,o,{projectionTools:c,Graphic:d,i18nFormatNumber:p,MEASUREMENTS_NLS:u},a);yield Si(t,i),yield i.applyEdits({addFeatures:e.map(e=>e.labelGraphic)})}break;case dt.GeodesicArea:{const e=yield Ii({mode:n,isUpdate:l},t,i,o,{projectionTools:c,Graphic:d,i18nFormatNumber:p,MEASUREMENTS_NLS:u},a);yield Si(t,i),yield i.applyEdits({addFeatures:e.map(e=>e.labelGraphic)});break}default:throw new Error}}),yi=(e,t)=>mi(void 0,void 0,void 0,function*(){const i=pi([e]);return yield null==t?void 0:t.queryFeatures({where:"(jimuDrawId IN ("+i.join(",")+"))"})}),Si=(e,t)=>mi(void 0,void 0,void 0,function*(){const i=pi(e);let o=[];if(i.length>0){o=(yield t.queryFeatures({where:"(jimuDrawId IN ("+i.join(",")+"))"})).features}const s={deleteFeatures:o};yield t.applyEdits(s)}),Mi=(e,t,i)=>mi(void 0,void 0,void 0,function*(){return i.isLoaded()||(yield i.load()),new Promise(o=>{o(i.execute(e,{unit:t}))})}),fi=(e,t,i)=>mi(void 0,void 0,void 0,function*(){return i.isLoaded()||(yield i.load()),new Promise(o=>{o(i.execute(e,{unit:t}))})}),bi=e=>{switch(e.geometry.type){case tt.Point:return dt.Position;case tt.Polyline:return dt.GeodesicLength;case tt.Polygon:return dt.GeodesicArea;default:throw new Error}},wi=(e,t)=>{let i="";switch(e){case dt.Position:i=t.location;break;case dt.PlanarLength:case dt.GeodesicLength:i=t.length;break;case dt.PlanarArea:case dt.GeodesicArea:i=t.area}return i+" "},vi=(e,t,i,o)=>{const s=null!=e?e:0;let a,n;if(s){let l=3;switch(t){case dt.GeodesicLength:l=o.line;break;case dt.GeodesicArea:l=o.area;break;default:throw new Error}a=s.toFixed(l),n=i(e,{maximumFractionDigits:l})}return{lengthString:a,i18nLength:n}},xi=(e,t,i,o,s,a)=>mi(void 0,void 0,void 0,function*(){var a,n;const{mode:l,isUpdate:r}=e,{coordinateFormatter:c,projectionTools:d,Graphic:p,MEASUREMENTS_NLS:u}=s,h=[];for(const e of t){const t=e.geometry,s=(yield yi(e,i)).features[0],m=null==s?void 0:s.attributes;(null===(a=null==s?void 0:s.attributes)||void 0===a?void 0:a.mInfo)&&(s.attributes.mInfo=JSON.parse(null===(n=null==s?void 0:s.attributes)||void 0===n?void 0:n.mInfo));let g=o.coordUnit;r&&(g=m.mInfo.mRuntimeInfo.coordUnit);let y=u.coordUnit;r&&(y=m.mInfo.coordUnitNls);let S=wi(l,u);const M=o.decimalPlaces;S+=(yield Ni(t,g,c,d,M));let f=o;r&&(f=m.mInfo.mRuntimeInfo);const b={mRuntimeInfo:f,coordUnitNls:y};let w=e.attributes;r&&(w=Object.assign(Object.assign({},m),e.attributes)),void 0!==w.OBJECTID&&delete w.OBJECTID;const v=new p({geometry:t,symbol:null,attributes:Object.assign(Object.assign({},w),{mLabel:S,mInfo:JSON.stringify(b)})});h.push({mResults:"",label:S,labelGraphic:v})}return h}),Ni=(e,t,i,o,s)=>mi(void 0,void 0,void 0,function*(){var a;let n="";try{yield i.load();const l=null!==(a=(yield o.project([e]))[0])&&void 0!==a?a:null;n=i.toLatitudeLongitude(l,t,s.point)}catch(e){throw new Error(e)}return n}),Ci=(e,t,i,o,s,a)=>mi(void 0,void 0,void 0,function*(){var n,l,r;const{mode:c,isUpdate:d,isPerimeterUnit:p}=e,{projectionTools:u,Graphic:h,i18nFormatNumber:m,MEASUREMENTS_NLS:g}=s,y=[];for(const e of t){const t=e.geometry,s=yield u.project([t]),S=(yield yi(e,i)).features[0],M=null==S?void 0:S.attributes;(null===(n=null==S?void 0:S.attributes)||void 0===n?void 0:n.mInfo)&&(S.attributes.mInfo=JSON.parse(null===(l=null==S?void 0:S.attributes)||void 0===l?void 0:l.mInfo));let f=p?o.perimeterUnit:o.linearUnit;d&&(f=p?M.mInfo.mRuntimeInfo.perimeterUnit:M.mInfo.mRuntimeInfo.linearUnit);let b=p?g.perimeterUnit:g.linearUnit;d&&(b=p?M.mInfo.perimeterUnitNls:M.mInfo.linearUnitNls);const w=yield Mi(null!==(r=s[0])&&void 0!==r?r:null,f,a.geodeticLengthOperator),v=o.decimalPlaces,{lengthString:x,i18nLength:N}=vi(w,dt.GeodesicLength,m,v);let C=wi(c,g);C=C+N+" "+b;let I=o;d&&(I=M.mInfo.mRuntimeInfo);const j={mRuntimeInfo:I,linearUnitNls:p?null:b,perimeterUnitNls:p?b:null};let L=e.attributes;d&&(L=Object.assign(Object.assign({},M),e.attributes)),void 0!==L.OBJECTID&&delete L.OBJECTID;const D=new h({geometry:t.extent.center,symbol:null,attributes:Object.assign(Object.assign({},L),{mLabel:C,mInfo:JSON.stringify(j)})});y.push({mResults:x,label:C,labelGraphic:D})}return y}),Ii=(e,t,i,o,s,a)=>mi(void 0,void 0,void 0,function*(){var n,l,r;const{mode:c,isUpdate:d}=e,{projectionTools:p,Graphic:u,i18nFormatNumber:h,MEASUREMENTS_NLS:m}=s,g=[];for(const e of t){let t="";const s=(yield yi(e,i)).features[0],y=null==s?void 0:s.attributes;(null===(n=null==s?void 0:s.attributes)||void 0===n?void 0:n.mInfo)&&(s.attributes.mInfo=JSON.parse(null===(l=null==s?void 0:s.attributes)||void 0===l?void 0:l.mInfo));let S,M="";const f=d?y.mInfo.mRuntimeInfo.isShowPerimeterM:o.isShowPerimeterM;if(f){const s=dt.GeodesicLength,n=!0,l=yield Ci({mode:s,isUpdate:d,isPerimeterUnit:n},[e],i,o,{projectionTools:p,Graphic:u,i18nFormatNumber:h,MEASUREMENTS_NLS:m},a);M=l[0].label,S=l[0].labelGraphic.attributes.mInfo,S&&(S=JSON.parse(S)),t+=M}let b="";const w=e.geometry;let v,x;if(d?y.mInfo.mRuntimeInfo.isShowAreaM:o.isShowAreaM){let e=o.arealUnit;d&&(e=y.mInfo.mRuntimeInfo.arealUnit),v=m.arealUnit,d&&(v=y.mInfo.arealUnitNls);const i=yield p.project([w]),s=yield fi(null!==(r=i[0])&&void 0!==r?r:null,e,a.geodeticAreaOperator),n=o.decimalPlaces,{lengthString:l,i18nLength:u}=vi(s,dt.GeodesicArea,h,n);x=l,b=wi(c,m)+u+" "+v,o.isShowPerimeterM&&(t+=" \r\n"),t+=b}const N=w.extent.center;let C=o;d&&(C=y.mInfo.mRuntimeInfo);const I={mRuntimeInfo:C,perimeterUnitNls:f?S.perimeterUnitNls:null,arealUnitNls:v};let j=e.attributes;d&&(j=Object.assign(Object.assign({},y),e.attributes)),void 0!==j.OBJECTID&&delete j.OBJECTID;const L=new u({geometry:N,symbol:null,attributes:Object.assign(Object.assign({},j),{mLabel:t,mInfo:JSON.stringify(I)})});g.push({mResults:x,label:t,labelGraphic:L})}return g});var ji=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};const Li=i.React.memo(e=>{const[t,o]=i.React.useState(null);i.hooks.useEffectOnce(()=>{(0,y.loadArcGISJSAPIModules)(["esri/geometry/SpatialReference","esri/geometry/support/webMercatorUtils","esri/rest/geometryService"]).then(e=>{let t=null,i=null,s=null;[t,i,s]=e,o({SpatialReference:t,webMercatorUtils:i,geometryService:s})})});const s=i.React.useCallback(e=>ji(void 0,void 0,void 0,function*(){var o;const s=t.SpatialReference.WGS84,a=null!==(o=e[0])&&void 0!==o?o:null;let n=[];if(t.webMercatorUtils.canProject(a.spatialReference,s))n.push(yield t.webMercatorUtils.project(a,s));else try{n=yield t.geometryService.project(i.utils.getGeometryService(),{geometries:e,outSpatialReference:s})}catch(e){throw new Error(e)}return n}),[null==t?void 0:t.webMercatorUtils,null==t?void 0:t.geometryService,null==t?void 0:t.SpatialReference.WGS84]);return i.React.useEffect(()=>{e.onLoad({project:s})},[e,s]),null});function Di(e){return i.css`
    &.jimu-draw-tool {
      position: relative;
      min-height: 45px;

      .jimu-draw-api-loader {
        display: flex;
        width: 100%;
        height: 45px;
        padding: 0.5rem 0;

        .skeleton {
          display: flex;
          width: 100%;
          height: 100%;
          background-color: ${e.ref.palette.neutral[300]}
        }
      }

      .esri-widget {
        background-color: transparent;
      }

      .jimu-draw-sketch-tools {
        min-height: 44px;
        /*flex-wrap: wrap;*/

        .esri-sketch {
          display: block; /* TODO hack for APIv4.32: https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/67103 */
          padding: 6px 8px;

          /* common */
          background-color: var(--sys-color-surface-paper); /* sub-repo:#27088 */
          --calcite-color-foreground-1: var(--sys-color-surface-paper) !important;
          --calcite-color-text-3: var(--sys-color-surface-paper-text); /* for Icon color */
          --calcite-action-bar-corner-radius: 0; /* border-radius UI ,#26875 */

          /* hover */
          --calcite-color-foreground-2: var(--sys-color-action-selected-hover);

          /* focus: hover & active */
          --calcite-action-text-color-press: var(--sys-color-action-selected-text);
          --calcite-color-foreground-3: var(--sys-color-action-selected);

          /* border radius */
          --calcite-action-corner-radius: var(--sys-shape-1);

          /* a11y */
          /*  Calcite component have a highlight similar to 508, after the mouse clicked ,#ExperienceBuilder-Web-Extensions/issues/27925
          --calcite-color-brand: var(--sys-color-action-focus); */
          /*--calcite-action-background-color: transparent !important;  toolbar background */
          --tw-ring-offset-shadow: none;
          /*--calcite-spacing-sm: 0;*/ /* CAN NOT be modified, otherwise the spacing of the setting menu will be messed up */
          /*
          --calcite-action-corner-radius: 0;
          --calcite-action-pad-corner-radius: 0;*/

          /* enhance color contrast when hovering on the snapping layers and grid options ,#23070 */
          --calcite-block-header-background-color-hover: var(--sys-color-action-hover);

          /* polyfill css for theme change ,#11593 */
          > .esri-sketch__panel {
            display: flex;

            .esri-sketch__tool-section {
              display: flex;
            }
          }
          /*
          .esri-sketch__button {
            background-color: transparent;
            &.esri-sketch__button--selected {
              &, &:hover {
                {getBoxInterpolationStyles(buttonDefaultVariant?.active)};
              }
            }
            &:focus {
              color: {buttonDefaultVariant?.default?.color};
            }
          }
          .esri-sketch__tool-section {
            border-color: {theme.ref.palette.neutral[700]};
          }
          */

          /* close-btn & popup's radius, sub-repo#25315 */
          --calcite-popover-corner-radius: 0px;

          /* Incorrect hover color ,#27068 */
          --calcite-color-text-1: var(--sys-color-surface-paper-text); /* popper-title */
          .esri-sketch__popover-wrapper {
            --calcite-color-brand-hover: var(--sys-color-action-selected-text);
            --calcite-color-status-info: var(--sys-color-surface-paper-text);
            --calcite-switch-background-color-hover: var(--sys-color-primary-dark);
            /* snapping layers hover color, sub-repo#25315 */
            --calcite-list-background-color: var(--sys-color-surface-paper) !important;
            --calcite-list-background-color-hover: var(--sys-color-action-hover);
            --calcite-font-family: var(--sys-typography-body-font-family);
            --calcite-list-label-text-color: var(--sys-color-surface-paper-text);
          }
          /* close icon is not recognized in the hover state ,#25315 ,#27124 */
          --calcite-color-transparent-hover: var(--sys-color-action-selected-hover);

          /* a11y */
          button:focus {
            outline-offset: -2px;
          }
        }

        .esri-sketch > div:first-of-type { /* TODO hack for APIv4.32 */
          display: flex;
        }

        .esri-sketch__panel {
          justify-content: flex-start;
        }

        .panel & {
          border: none !important; /* sub repo ,#12605 */
        }

         /* Because of the rounding limit of the layout when switching mode, 1px needs to be added here ,#22941 */
        .additional-bts {
          padding-left: 0;
          padding-right: 0;
          order: 9999; /* TODO hack for APIv4.32 */
        }

        .appended-btn {
          border: none;
          white-space: nowrap;
          height: 32px;
        }
        .appended-btn:first-of-type {
          border-left-color: var(--calcite-action-group-border-color, var(--calcite-color-border-3));
          border-left-style: solid;
          border-left-width: 1px;
        }
        .appended-btn:hover {
          color: var(--calcite-action-text-color-press);
          background-color: var(--calcite-color-foreground-3);
        }
      }

      .jimu-draw-sketch-tools.hide-border {
        .toolbar & {
          border: none;
        }
      }

      .can-not-edit-tips {
        background-color: var(--calcite-color-background);
        color: var(--sys-color-surface-paper-text);
        min-height: 54px;
        text-align: center;
      }
    }

    &.jimu-draw-tool.hide-bg-color {
      background-color: transparent !important;
    }
  `}var Ti=function(e,t,i,o){return new(i||(i=Promise))(function(s,a){function n(e){try{r(o.next(e))}catch(e){a(e)}}function l(e){try{r(o.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(n,l)}r((o=o.apply(e,t||[])).next())})};const Oi=i.React.memo(e=>{var o,s,a,l,r,c,d,p,u,h,m,S,M,f;const b=(0,t.useTheme)(),w=(0,i.useIntl)(),v=i.React.useCallback((e,t)=>w.formatNumber(e,t),[w]),x=i.React.useMemo(()=>[tt.Point,tt.Polyline,tt.Polygon,tt.Rectangle,tt.Circle,tt.Text,tt.FreehandPolyline,tt.FreehandPolygon],[]),N=i.React.useRef(null),{getMeasurementsNls:C}=(e=>{const t=(0,i.useIntl)().formatMessage({id:"drawToolLocationTip",defaultMessage:g.defaultMessages.drawToolLocationTip}),o=(0,i.useIntl)().formatMessage({id:"drawToolLengthTip",defaultMessage:g.defaultMessages.drawToolLengthTip}),s=(0,i.useIntl)().formatMessage({id:"drawToolAreaTip",defaultMessage:g.defaultMessages.drawToolAreaTip}),a=(0,i.useIntl)().formatMessage({id:"unitsNameDD",defaultMessage:g.defaultMessages.unitsNameDD}),n=(0,i.useIntl)().formatMessage({id:"unitsNameDMS",defaultMessage:g.defaultMessages.unitsNameDMS}),l=(0,i.useIntl)().formatMessage({id:"unitsNameMeters",defaultMessage:g.defaultMessages.unitsNameMeters}),r=(0,i.useIntl)().formatMessage({id:"unitsNameFeet",defaultMessage:g.defaultMessages.unitsNameFeet}),c=(0,i.useIntl)().formatMessage({id:"unitsNameKilometers",defaultMessage:g.defaultMessages.unitsNameKilometers}),d=(0,i.useIntl)().formatMessage({id:"unitsNameMiles",defaultMessage:g.defaultMessages.unitsNameMiles}),p=(0,i.useIntl)().formatMessage({id:"unitsNameNauticalMiles",defaultMessage:g.defaultMessages.unitsNameNauticalMiles}),u=(0,i.useIntl)().formatMessage({id:"unitsNameYards",defaultMessage:g.defaultMessages.unitsNameYards}),h=(0,i.useIntl)().formatMessage({id:"unitsNameAcres",defaultMessage:g.defaultMessages.unitsNameAcres}),m=(0,i.useIntl)().formatMessage({id:"unitsNameAres",defaultMessage:g.defaultMessages.unitsNameAres}),y=(0,i.useIntl)().formatMessage({id:"unitsNameHectares",defaultMessage:g.defaultMessages.unitsNameHectares}),S=(0,i.useIntl)().formatMessage({id:"unitsNameSquareFeet",defaultMessage:g.defaultMessages.unitsNameSquareFeet}),M=(0,i.useIntl)().formatMessage({id:"unitsNameSquareMeters",defaultMessage:g.defaultMessages.unitsNameSquareMeters}),f=(0,i.useIntl)().formatMessage({id:"unitsNameSquareYards",defaultMessage:g.defaultMessages.unitsNameSquareYards}),b=(0,i.useIntl)().formatMessage({id:"unitsNameSquareKilometers",defaultMessage:g.defaultMessages.unitsNameSquareKilometers}),w=(0,i.useIntl)().formatMessage({id:"unitsNameSquareMiles",defaultMessage:g.defaultMessages.unitsNameSquareMiles}),v=i.React.useCallback(e=>{let t="";switch(e.coordUnit){case ct.DD:t=a;break;case ct.DMS:t=n}return t},[a,n]),x=i.React.useCallback((e,t)=>{let i="";switch(t?e.perimeterUnit:e.linearUnit){case rt.Meters:i=l;break;case rt.Feet:i=r;break;case rt.Kilometers:i=c;break;case rt.Miles:i=d;break;case rt.NauticalMiles:i=p;break;case rt.Yards:i=u}return i},[l,r,c,d,p,u]),N=i.React.useCallback(e=>{let t="";switch(e.arealUnit){case lt.Acres:t=h;break;case lt.Ares:t=m;break;case lt.Hectares:t=y;break;case lt.SquareFeet:t=S;break;case lt.SquareMeters:t=M;break;case lt.SquareYards:t=f;break;case lt.SquareKilometers:t=b;break;case lt.SquareMiles:t=w}return t},[h,m,y,S,M,f,b,w]),C=i.React.useRef({location:t,length:o,area:s,coordUnit:v(e),linearUnit:x(e),arealUnit:N(e),perimeterUnit:x(e,!0)});return{getMeasurementsNls:e=>{const t=v(e),i=x(e),o=N(e),s=x(e,!0);return Object.assign(Object.assign({},C.current),{coordUnit:t,linearUnit:i,arealUnit:o,perimeterUnit:s})}}})(e.measurementsRuntimeInfo);N.current=C;const I=i.React.useRef(void 0),j=i.ReactRedux.useSelector(t=>{var i;return(null===(i=t.mapWidgetsInfo[e.jimuMapView.mapWidgetId])||void 0===i?void 0:i.autoControlWidgetId)===e.operatorWidgetId}),[L,D]=i.React.useState(null);i.hooks.useEffectOnce(()=>{(0,y.loadArcGISJSAPIModules)(["esri/widgets/Sketch","esri/widgets/Sketch/SketchViewModel","esri/layers/GraphicsLayer","esri/Graphic","esri/geometry/coordinateFormatter","esri/symbols/TextSymbol","esri/layers/FeatureLayer","esri/layers/GroupLayer","esri/applications/ExperienceBuilder/sketchUtils","esri/core/reactiveUtils","esri/geometry/operators/lengthOperator","esri/geometry/operators/geodeticLengthOperator","esri/geometry/operators/areaOperator","esri/geometry/operators/geodeticAreaOperator"]).then(e=>{let t=null,i=null,o=null,s=null,a=null,n=null,l=null,r=null,c=null,d=null,p=null,u=null,h=null,m=null;[t,i,o,s,a,n,l,r,c,d,p,u,h,m]=e,D({Sketch:t,SketchViewModel:i,GraphicsLayer:o,Graphic:s,coordinateFormatter:a,TextSymbol:n,FeatureLayer:l,GroupLayer:r,SketchUtils:c,ReactiveUtils:d,lengthOperator:p,geodeticLengthOperator:u,areaOperator:h,geodeticAreaOperator:m})})});const T=i.React.useRef({pointSymbol:null,polylineSymbol:null,polygonSymbol:null,textSymbol:null}),O=i.React.useRef(!1),P=ye();i.React.useEffect(()=>{var t,i,o,s,a,n,l,r;O.current||(T.current={pointSymbol:null!==(i=null===(t=e.defaultSymbols)||void 0===t?void 0:t.pointSymbol)&&void 0!==i?i:li(tt.Point,T.current,P),polylineSymbol:null!==(s=null===(o=e.defaultSymbols)||void 0===o?void 0:o.polylineSymbol)&&void 0!==s?s:li(tt.Polyline,T.current,P),polygonSymbol:null!==(n=null===(a=e.defaultSymbols)||void 0===a?void 0:a.polygonSymbol)&&void 0!==n?n:li(tt.Polygon,T.current,P),textSymbol:null!==(r=null===(l=e.defaultSymbols)||void 0===l?void 0:l.textSymbol)&&void 0!==r?r:li(tt.Text,T.current,P)},O.current=!0)},[P,e.defaultSymbols]);const{getLayersGroupByJimuMapId:A,getCanvasLayer:E,getMeasurementsLayer:R,addLayersToMap:k,changeLayerElev:z,removeAllLayersFromMap:U,updateMeasurementsLayerListMode:V}=(e=>{var t,o,s,a,n,l,r,c;const d=(0,i.useIntl)(),p=i.React.useRef(new Map),u=i.React.useRef(new Map),h=i.React.useRef(""),m=i.React.useRef("");i.React.useEffect(()=>{h.current=e.jimuMapView.id,m.current=e.jimuMapView.mapWidgetId});const S=i.React.useCallback(t=>{var i;const o="jimu-draw-layer-"+e.jimuMapView.id+"-"+t;return u.current.set(e.jimuMapView.id+"-canvasLayerId",o),new(null===(i=e.apiModules)||void 0===i?void 0:i.GraphicsLayer)({id:o,title:d.formatMessage({id:"drawCanvasLayerTitle",defaultMessage:g.defaultMessages.drawCanvasLayerTitle}),elevationInfo:{mode:e.elevationInfo}})},[null===(t=e.apiModules)||void 0===t?void 0:t.GraphicsLayer,e.elevationInfo,e.jimuMapView.id,d]),M=i.React.useCallback(t=>{var i,o,s,a,n,l;const r="jimu-draw-measurements-layer-"+e.jimuMapView.id+"-"+t;u.current.set(e.jimuMapView.id+"-measurementsLayerId",r);const c="2d"===(null===(i=e.jimuMapView)||void 0===i?void 0:i.view.type),p=c?"text":"label-3d",h=(null===(o=e.measurementsRuntimeInfo)||void 0===o?void 0:o.fontsColor)||[0,0,0],m=(null===(s=e.measurementsRuntimeInfo)||void 0===s?void 0:s.fontsSize)||12,y=(null===(a=e.measurementsRuntimeInfo)||void 0===a?void 0:a.haloColor)||[255,255,255,.8],S=(null===(n=e.measurementsRuntimeInfo)||void 0===n?void 0:n.haloSize)||1;let M={type:p};return M=c?Object.assign(Object.assign({},M),{type:"text",color:h,haloColor:y,haloSize:S,font:{size:m}}):Object.assign(Object.assign({},M),{symbolLayers:[{type:"text",material:{color:h},size:m,halo:{color:y,size:S}}],verticalOffset:{screenLength:40,maxWorldLength:500,minWorldLength:50},callout:{type:"line",size:1.5,color:"white",border:{color:"black"}}}),new(null===(l=e.apiModules)||void 0===l?void 0:l.FeatureLayer)({id:r,legendEnabled:!1,title:d.formatMessage({id:"drawMeasurementsLayerTitle",defaultMessage:g.defaultMessages.drawMeasurementsLayerTitle}),geometryType:"point",source:[],objectIdField:"OBJECTID",elevationInfo:{mode:st.RelativeToGround},hasZ:!0,popupEnabled:!1,popupTemplate:null,outFields:["*"],labelsVisible:!0,screenSizePerspectiveEnabled:!1,fields:[{name:"OBJECTID",type:"oid"},{name:"jimuDrawId",type:"integer"},{name:"mLabel",type:"string"},{name:"mInfo",type:"string"}],labelingInfo:[{labelExpressionInfo:{expression:"$feature.mLabel"},symbol:M}]})},[null===(o=e.apiModules)||void 0===o?void 0:o.FeatureLayer,e.jimuMapView,e.measurementsRuntimeInfo,d]),f=i.React.useCallback(e=>{const t=void 0!==e?e:h.current;return p.current.get(t)},[]),b=i.React.useCallback(t=>{var i,o,s,a;const n=null===(i=f(t))||void 0===i?void 0:i.layers;let l=null==n?void 0:n.find(e=>e.id.startsWith("jimu-draw-layer-"));const r=null===(o=u.current)||void 0===o?void 0:o.get(e.jimuMapView.id+"-canvasLayerId");if(!l&&r){const t=null===(a=null===(s=e.jimuMapView)||void 0===s?void 0:s.view)||void 0===a?void 0:a.allLayerViews.find(e=>e.layer.id.startsWith(r));l=null==t?void 0:t.layer}return l},[null===(a=null===(s=e.jimuMapView)||void 0===s?void 0:s.view)||void 0===a?void 0:a.allLayerViews,e.jimuMapView.id,f]),w=i.React.useCallback(t=>{var i,o,s,a;const n=null===(i=f(t))||void 0===i?void 0:i.layers;let l=null==n?void 0:n.find(e=>e.id.startsWith("jimu-draw-measurements-layer-"));const r=null===(o=u.current)||void 0===o?void 0:o.get(e.jimuMapView.id+"-measurementsLayerId");if(!l&&r){const t=null===(a=null===(s=e.jimuMapView)||void 0===s?void 0:s.view)||void 0===a?void 0:a.allLayerViews.find(e=>e.layer.id.startsWith(r));l=null==t?void 0:t.layer}return l},[null===(l=null===(n=e.jimuMapView)||void 0===n?void 0:n.view)||void 0===l?void 0:l.allLayerViews,e.jimuMapView.id,f]),v=i.React.useCallback(t=>{var i;const o=(new Date).getTime(),s=S(o),a=M(o),n="jimu-draw-groupLayer-"+e.jimuMapView.id+"-"+o,l=new(null===(i=e.apiModules)||void 0===i?void 0:i.GroupLayer)({id:n,listMode:null!=t?t:"hide",title:d.formatMessage({id:"drawLayerGroupTitle",defaultMessage:g.defaultMessages.drawLayerGroupTitle}),layers:[a,s],visibilityMode:"independent"});return e.jimuMapView.view.map.findLayerById(l.id)||e.jimuMapView.view.map.add(l),l},[null===(r=e.apiModules)||void 0===r?void 0:r.GroupLayer,e.jimuMapView.id,null===(c=e.jimuMapView.view)||void 0===c?void 0:c.map,S,M,d]),x=i.React.useCallback(t=>{let i=f();return i||(i=v(t),p.current.set(e.jimuMapView.id,i)),i},[e.jimuMapView,f,v]),N=i.React.useCallback(()=>{const t=b();t&&(t.elevationInfo={mode:e.elevationInfo})},[e.elevationInfo,b]),C=i.React.useCallback(e=>{const t=w();t&&(t.listMode=e?"show":"hide")},[w]),I=i.React.useCallback(e=>{const t=null!=e?e:m.current,i=y.MapViewManager.getInstance().getJimuMapViewGroup(t);if(i)for(const e in i.jimuMapViews){const t=f(e),i=y.MapViewManager.getInstance().getJimuMapViewById(e);t&&i&&i.view.map.remove(t),p.current.set(i.id,null)}},[f]);return{getLayersGroupByJimuMapId:f,getCanvasLayer:b,getMeasurementsLayer:w,addLayersToMap:x,changeLayerElev:N,updateMeasurementsLayerListMode:C,removeAllLayersFromMap:I}})({jimuMapView:e.jimuMapView,apiModules:L,elevationInfo:e.elevationInfo,measurementsRuntimeInfo:e.measurementsRuntimeInfo}),F=i.React.useRef(null);F.current=A;const B=i.React.useRef(null);B.current=E;const G=i.React.useRef(null);G.current=R;const W=i.React.useRef(null);W.current=k;const H=i.React.useRef(null);H.current=z;const Q=i.React.useRef(null);Q.current=U;const J=i.React.useRef(null);J.current=V;const Y=i.React.useRef(null),q=i.React.useCallback(()=>{(null==Y?void 0:Y.current)&&setTimeout(()=>{var e;null===(e=Y.current.viewModel)||void 0===e||e.cancel()},80)},[]),$=i.React.useCallback(()=>{var e;(null==Y?void 0:Y.current)&&(null===(e=Y.current)||void 0===e||e.destroy())},[]),Z=i.React.useRef(null),[_,K]=i.React.useState(null),X=i.React.useRef(!1),ee=i.React.useCallback(()=>{X.current=!1},[]),te=i.React.useCallback(()=>{X.current=!0},[]),[ie,oe]=i.React.useState(0),se=e.currentSymbolTypeChanged,ae=e.currentActiveToolChanged,ne=i.React.useCallback(e=>{ae(e),K(e),se(ri(e)),oe(ie+1)},[ie,se,ae]);i.React.useRef(null).current=ne;const{jimuMapView:le,layerListMode:re,creationMode:ce,visibleElements:de,updateOnGraphicClick:pe,defaultCreateOptions:ue,defaultUpdateOptions:he,snappingOptions:me,tooltipOptions:ge,labelOptions:Se,disableSymbolSelector:Me,measurementsRuntimeInfo:fe,onJimuDrawCreated:be,onToolsActivated:we,currentSymbolChanged:ve,currentActiveBtnChanged:xe,onDrawingStarted:Ne,onDrawingFinished:Ce,onDrawingCanceled:Ie,onDrawingUpdated:je,enableSymbolSelector:Le}=e,De=i.React.useRef(null);De.current=fe;const Te=i.React.useRef(null),Oe=i.React.useRef(null),Pe=i.React.useCallback(()=>{const t=Te.current;if(e.operatorWidgetId&&(j&&null===t&&(0,i.getAppStore)().dispatch(i.appActions.releaseAutoControlMapWidget(e.jimuMapView.mapWidgetId)),j||null===t||(0,i.getAppStore)().dispatch(i.appActions.requestAutoControlMapWidget(e.jimuMapView.mapWidgetId,e.operatorWidgetId))),x.includes(t)){we&&we(t),((e,t,i,o)=>{if(e!==t)switch(t){case tt.Point:i.viewModel.pointSymbol=o.pointSymbol;break;case tt.Polyline:case tt.FreehandPolyline:i.viewModel.polylineSymbol=o.polylineSymbol;break;case tt.Polygon:case tt.Rectangle:case tt.Circle:case tt.FreehandPolygon:i.viewModel.polygonSymbol=o.polygonSymbol;break;case tt.Text:i.viewModel.textSymbol=o.textSymbol}})(_,t,Y.current,T.current),ve(li(t,T.current,P));const e=((e,t)=>{let i=null;switch(e){case tt.Point:case tt.Polyline:case tt.Polygon:case tt.Rectangle:case tt.Circle:case tt.FreehandPolyline:case tt.FreehandPolygon:i=e+"-button";break;case tt.Text:i="custom-text"}return t.querySelector('calcite-action[data-testid="'+i+'"]')})(t,it.current);e&&xe(e);setTimeout(()=>{ne(t)},"text"===t?200:0)}else ne(t)},[x,ne,_,P,xe,ve,we,j,e.jimuMapView.mapWidgetId,e.operatorWidgetId]),Ae=e.setIsExpandSymbolList,Ee=w.formatMessage({id:"collapse",defaultMessage:g.defaultMessages.collapse}),Re=w.formatMessage({id:"expand",defaultMessage:g.defaultMessages.expand}),ke=i.React.useCallback(()=>{((e,t,i,o)=>{const s=null==e?void 0:e.querySelector('calcite-action[data-testid="additional-bts-expand-collapse"]');null==s||s.setAttribute("title",t?i:o)})(it.current,e.isExpandSymbolList,Re,Ee),Ae(!e.isExpandSymbolList),oe(ie+1)},[Ae,oe,ie,e.isExpandSymbolList,Re,Ee]),ze=i.React.useRef(null);ze.current=ke;const Ue=e.onDrawingCleared,Ve=null===(o=e.uiOptions)||void 0===o?void 0:o.arrangement,[Fe,Be]=i.React.useState(!1),Ge=i.React.useCallback(()=>{var t,i;const o=null===(t=e.visibleElements.createTools)||void 0===t?void 0:t.customText,s=w.formatMessage({id:"drawToolClearBtn",defaultMessage:g.defaultMessages.drawToolClearBtn}),a=w.formatMessage({id:"collapse",defaultMessage:g.defaultMessages.collapse}),n=w.formatMessage({id:"expand",defaultMessage:g.defaultMessages.expand});let l=[];if(o){l=[{toolName:"text",icon:"text",label:w.formatMessage({id:"drawTipsText",defaultMessage:g.defaultMessages.drawTipsText}),toolKey:"text"}]}else l=[];const r=[{icon:"erase",position:"settings-after",id:"additional-bts-clearAll",text:s,onclick:()=>{var e,t;(e=G.current()).queryFeatures().then(t=>{const i={deleteFeatures:t.features};e.applyEdits(i)}),(t=B.current())&&t.removeAll(),"function"==typeof Ue&&Ue()}}];Ve!==Dt.Toolbar||void 0!==Me&&Me||r.push({icon:"center-vertical",position:"settings-after",id:"additional-bts-expand-collapse",text:e.isExpandSymbolList?a:n,onclick:()=>{ze.current()}});const c=ui(Y.current.updateGraphics.toArray());Y.current.updateGraphics.length>0&&!c?Be(!0):c&&r.push({icon:"add-in-edit",position:"after-selection-set",id:"additional-bts-edit",text:w.formatMessage({id:"editFeatures",defaultMessage:g.defaultMessages.editFeatures}),onclick:()=>{if(Te.current===ot)xe(null),Te.current=null;else{Te.current=ot;const e=hi(Y.current.updateGraphics.at(0));ve(li(e,T.current,P)),se(ri(e));const t=it.current.querySelector('calcite-action[data-testid="additional-bts-edit"]');t&&xe(t)}}}),null===(i=null==L?void 0:L.SketchUtils)||void 0===i||i.setCustomTools(Y.current,l,[...r])},[null==L?void 0:L.SketchUtils,null===(s=e.visibleElements.createTools)||void 0===s?void 0:s.customText,w,e.isExpandSymbolList,Ve,Me,Ue,P,se,ve,xe]),We=i.React.useRef(null);We.current=Ge;const He=i.React.useCallback(()=>{var t,i,o,s;"3d"===(null===(i=null===(t=e.jimuMapView)||void 0===t?void 0:t.view)||void 0===i?void 0:i.type)?null===(o=Y.current)||void 0===o||o.set({defaultCreateOptions:{hasZ:!0}}):null===(s=Y.current)||void 0===s||s.set({defaultCreateOptions:{hasZ:!1}})},[e.jimuMapView]),Qe=i.React.useCallback(()=>{var t;let i=null;(null===(t=e.uiOptions)||void 0===t?void 0:t.isAutoWidth)&&(i=new Map,i.set("selectionTools",!1),i.set("createTools",!1),i.set("undoRedo",!1),i.set("settings",!1),i.set("selectionSet",!1));const o=null==Y?void 0:Y.current;o&&(o.groupAllowCollapseOptions=i)},[null===(a=e.uiOptions)||void 0===a?void 0:a.isAutoWidth]),Je=i.React.useCallback(()=>{Oe.current&&clearTimeout(Oe.current),q(),$(),ne(null),Q.current()},[q,$,ne]);i.React.useEffect(()=>()=>{Je()},[]);const Ye=i.React.useCallback(()=>{var e,t,i;if(Je(),!(null==le?void 0:le.view)||!L)return;W.current(re);const{creationMode:o,visibleElements:s,updateOnGraphicClick:a,defaultCreateOptions:n,defaultUpdateOptions:l,snappingOptions:r,tooltipOptions:c,labelOptions:d}=ni({creationMode:ce,visibleElements:de,updateOnGraphicClick:pe,defaultCreateOptions:ue,defaultUpdateOptions:he,snappingOptions:me,tooltipOptions:ge,labelOptions:Se},B.current());Y.current=new L.Sketch({container:Z.current,creationMode:o,availableCreateTools:x,visibleElements:s,tooltipOptions:c,labelOptions:d,viewModel:new L.SketchViewModel({view:le.view,layer:B.current(),updateOnGraphicClick:a,defaultCreateOptions:n,defaultUpdateOptions:l,snappingOptions:r,pointSymbol:null!==(e=T.current.pointSymbol)&&void 0!==e?e:null,polylineSymbol:null!==(t=T.current.polylineSymbol)&&void 0!==t?t:null,polygonSymbol:null!==(i=T.current.polygonSymbol)&&void 0!==i?i:null}),scale:"s"}),He(),We.current(),Qe(),Y.current.when(()=>{"function"==typeof be&&be(Object.assign({sketch:Y.current,getGraphicsLayer:()=>Y.current.layer,completeOperation:at,destroy:Je,sketchToolbarDom:it.current},{enableSymbolSelector:Le}))}),L.ReactiveUtils.watch(()=>[Y.current.activeTool,Y.current._activeCustomToolOptions],()=>{var e,t;const i=Te.current;Te.current=Y.current.activeTool,"point"===Y.current.activeTool&&"text"===(null===(t=null===(e=Y.current)||void 0===e?void 0:e._activeCustomToolOptions)||void 0===t?void 0:t.toolKey)&&(Te.current=Y.current._activeCustomToolOptions.toolKey),i!==Te.current&&("function"==typeof Y.current.dismissFloatingElements&&Y.current.dismissFloatingElements(),clearTimeout(Oe.current),Pe())}),Y.current.on("create",e=>{if("start"===e.state&&Ne&&Ne(),"complete"===e.state&&Ce&&(null==e?void 0:e.graphic)&&(ci([e.graphic]),Ce(e.graphic),(e=>e.enableMeasurements&&e.isMeasuring)(De.current.asMutable()))){const t=bi(e.graphic);e.tool===tt.Point&&"text"===Te.current||gi({mode:t,IsDeletingFlag:!1,isUpdate:!1},[e.graphic],G.current(),De.current.asMutable(),{coordinateFormatter:L.coordinateFormatter,projectionTools:nt.current,Graphic:L.Graphic,i18nFormatNumber:v,MEASUREMENTS_NLS:null==N?void 0:N.current(De.current)},{lengthOperator:L.lengthOperator,geodeticLengthOperator:L.geodeticLengthOperator,areaOperator:L.areaOperator,geodeticAreaOperator:L.geodeticAreaOperator})}"cancel"===e.state&&Ie&&Ie()}),Y.current.on("update",e=>{if(je&&!e.aborted){const t=setTimeout(()=>{ci(e.graphics),je({type:"modified",graphics:e.graphics})},200);clearTimeout(t)}"start"===e.state&&e.graphics&&We.current(),"complete"===e.state&&je&&(Be(!1),setTimeout(()=>{ci(e.graphics);const t=e.aborted?"aborted":"complete";je({type:t,graphics:e.graphics});const i=X.current;i?Si(e.graphics,G.current()):((e,t,i,o,s,a)=>{mi(void 0,void 0,void 0,function*(){const{coordinateFormatter:n,projectionTools:l,Graphic:r,i18nFormatNumber:c,MEASUREMENTS_NLS:d}=s;for(const s of e)if((yield yi(s,t)).features.length>0){const e=bi(s);gi({mode:e,IsDeletingFlag:o,isUpdate:!0},[s],t,i,{coordinateFormatter:n,projectionTools:l,Graphic:r,i18nFormatNumber:c,MEASUREMENTS_NLS:d},a)}})})(e.graphics,G.current(),De.current.asMutable(),i,{coordinateFormatter:L.coordinateFormatter,projectionTools:nt.current,Graphic:L.Graphic,i18nFormatNumber:v,MEASUREMENTS_NLS:null==N?void 0:N.current(De.current)},{lengthOperator:L.lengthOperator,geodeticLengthOperator:L.geodeticLengthOperator,areaOperator:L.areaOperator,geodeticAreaOperator:L.geodeticAreaOperator})},50))}),Y.current.viewModel.on("duplicate",e=>Ti(void 0,void 0,void 0,function*(){if("duplicate"===e.type&&e.graphics)for(const t of e.graphics){const e=yield yi(t,G.current());if((null==e?void 0:e.features.length)>0){ci([t],!0);const e=bi(t);yield gi({mode:e,IsDeletingFlag:!1,isUpdate:!1},[t],G.current(),De.current.asMutable(),{coordinateFormatter:L.coordinateFormatter,projectionTools:nt.current,Graphic:L.Graphic,i18nFormatNumber:v,MEASUREMENTS_NLS:null==N?void 0:N.current(De.current)},{lengthOperator:L.lengthOperator,geodeticLengthOperator:L.geodeticLengthOperator,areaOperator:L.areaOperator,geodeticAreaOperator:L.geodeticAreaOperator})}}})),Y.current.on("delete",e=>{te(),setTimeout(()=>{ci(e.graphics),je&&je({type:"deleted",graphics:e.graphics}),Si(e.graphics,G.current()),ee()},300)}),Y.current.updateGraphics.on("change",function(e){})},[L,le.view,re,ce,ue,he,pe,de,me,ge,Se,x,Ie,Ce,Ne,je,be,Je,Le,v,ee,te,Pe,He,Qe]);i.React.useEffect(()=>{Y&&Y.current||Ye()},[L,e.jimuMapView]),i.React.useEffect(()=>{if(Y&&Y.current){q();const{creationMode:e,visibleElements:t,updateOnGraphicClick:i,defaultCreateOptions:o,defaultUpdateOptions:s,snappingOptions:a,tooltipOptions:n,labelOptions:l}=ni({creationMode:ce,visibleElements:de,updateOnGraphicClick:pe,defaultCreateOptions:ue,defaultUpdateOptions:he,snappingOptions:me,tooltipOptions:ge,labelOptions:Se},B.current()),r=Y.current;r.creationMode=e,r.visibleElements=t,r.tooltipOptions=n,r.labelOptions=l,We.current(),r.viewModel.updateOnGraphicClick=i,r.viewModel.defaultCreateOptions=o,r.viewModel.defaultUpdateOptions=s,r.viewModel.snappingOptions=a,(null==r?void 0:r.destroyed)||r.renderNow()}},[q,ce,de,pe,ue,he,me,ge,Se]);const qe=i.React.useCallback(()=>{I.current&&e.jimuMapView.mapWidgetId!==I.current&&Q.current(I.current),I.current=e.jimuMapView.mapWidgetId},[e.jimuMapView]),$e=i.React.useRef(void 0);$e.current=e.layerListMode,i.React.useEffect(()=>{if(Y&&Y.current){q(),He(),qe(),W.current($e.current);const t=Y.current;t.viewModel.view=e.jimuMapView.view,t.viewModel.layer=B.current(),(null==t?void 0:t.destroyed)||t.renderNow()}},[q,qe,e.jimuMapView,He]),i.React.useEffect(()=>{var t,i;const o=F.current();if(o){const s=null!==(t=e.layerListMode)&&void 0!==t?t:"hide";o.listMode=s,J.current(null===(i=e.measurementsRuntimeInfo)||void 0===i?void 0:i.enableMeasurements)}},[e.layerListMode,null===(l=e.measurementsRuntimeInfo)||void 0===l?void 0:l.enableMeasurements]),i.React.useEffect(()=>{var t;J.current(null===(t=e.measurementsRuntimeInfo)||void 0===t?void 0:t.enableMeasurements)},[null===(r=e.measurementsRuntimeInfo)||void 0===r?void 0:r.enableMeasurements]),i.React.useEffect(()=>{H.current()},[e.elevationInfo]),i.React.useEffect(()=>{Qe()},[null===(c=e.uiOptions)||void 0===c?void 0:c.isAutoWidth,Qe]);const Ze=i.React.useCallback((e,t)=>{Y&&(null==Y?void 0:Y.current)&&(Y.current.activeTool!==e||t)&&(Y.current.viewModel.create(e),Y.current.renderNow())},[]);i.React.useEffect(()=>{null!==Te.current&&e.operatorWidgetId&&!j&&q()},[j,e.operatorWidgetId,q]);const _e=i.React.useCallback(()=>{var t,i,o;const s=null!==(t=e.pointSymbol)&&void 0!==t?t:null!==(o=null===(i=e.defaultSymbols)||void 0===i?void 0:i.pointSymbol)&&void 0!==o?o:T.current.pointSymbol;T.current.pointSymbol=s,Y.current.viewModel.pointSymbol=s},[e.pointSymbol,null===(d=e.defaultSymbols)||void 0===d?void 0:d.pointSymbol]),Ke=i.React.useCallback(()=>{var t,i,o;const s=null!==(t=e.polylineSymbol)&&void 0!==t?t:null!==(o=null===(i=e.defaultSymbols)||void 0===i?void 0:i.polylineSymbol)&&void 0!==o?o:T.current.polylineSymbol;T.current.polylineSymbol=s,Y.current.viewModel.polylineSymbol=s},[e.polylineSymbol,null===(p=e.defaultSymbols)||void 0===p?void 0:p.polylineSymbol]),Xe=i.React.useCallback(()=>{var t,i,o;const s=null!==(t=e.polygonSymbol)&&void 0!==t?t:null!==(o=null===(i=e.defaultSymbols)||void 0===i?void 0:i.polygonSymbol)&&void 0!==o?o:T.current.polygonSymbol;T.current.polygonSymbol=s,Y.current.viewModel.polygonSymbol=s},[e.polygonSymbol,null===(u=e.defaultSymbols)||void 0===u?void 0:u.polygonSymbol]),et=i.React.useCallback(()=>{var t,i,o;const s=null!==(t=e.textSymbol)&&void 0!==t?t:null!==(o=null===(i=e.defaultSymbols)||void 0===i?void 0:i.textSymbol)&&void 0!==o?o:T.current.textSymbol;T.current.textSymbol=s,Y.current.viewModel.textSymbol=s},[e.textSymbol,null===(h=e.defaultSymbols)||void 0===h?void 0:h.textSymbol]);i.React.useEffect(()=>{var t,i,o,s,a,n;const l=Te.current===ot,r=hi(null===(i=null===(t=Y.current)||void 0===t?void 0:t.updateGraphics)||void 0===i?void 0:i.at(0)),c=ui(null===(s=null===(o=Y.current)||void 0===o?void 0:o.updateGraphics)||void 0===s?void 0:s.toArray());if(l&&c&&r){let t=null;switch(r){case tt.Point:t=e.pointSymbol;break;case tt.Polyline:t=e.polylineSymbol;break;case tt.Polygon:t=e.polygonSymbol;break;case tt.Text:t=e.textSymbol;break;default:t=null}if(t)return void(null===(n=null===(a=Y.current)||void 0===a?void 0:a.updateGraphics)||void 0===n||n.forEach(function(e,i){e.symbol=t}))}let d=!1;const p=Te.current!==_;switch(_){case tt.Point:d=p,_e();break;case tt.Polyline:case tt.FreehandPolyline:d=p,Ke();break;case tt.Polygon:case tt.Rectangle:case tt.Circle:case tt.FreehandPolygon:d=p,Xe();break;case tt.Text:d=p,et()}if(d){Ze(_,!0)}},[e.pointSymbol,e.polylineSymbol,e.polygonSymbol,e.textSymbol,_,e.measurementsRuntimeInfo,L,v,_e,Ke,Xe,et,Ze]),i.React.useEffect(()=>{Ze(_)},[_,Ze]);const it=i.React.useRef(null),at=()=>Ti(void 0,void 0,void 0,function*(){return new Promise((e,t)=>{Y&&Y.current&&["move","transform","reshape"].includes(Y.current.activeTool)?(Y.current.complete(),setTimeout(()=>{e()},500)):e()})}),nt=i.React.useRef(null),dt=((e,t)=>{var i,o;let s=!1;const a=e;if(a&&!t){const e=null===(i=a["rectangle-selection"])||void 0===i||i,t=null===(o=a["lasso-selection"])||void 0===o||o;s=!e&&!t}return s?"hide-selection-tools":""})(null===(m=e.visibleElements)||void 0===m?void 0:m.selectionTools,null===(S=e.updateOnGraphicClick)||void 0===S||S),pt=null!=(ut=null===(M=e.uiOptions)||void 0===M?void 0:M.isHideBgColor)&&ut?"hide-bg-color ":"";var ut;const ht=null!=(mt=null===(f=e.uiOptions)||void 0===f?void 0:f.isHideBorder)&&mt?"hide-border ":"";var mt;const gt=w.formatMessage({id:"drawToolSelectDrawMode",defaultMessage:g.defaultMessages.drawToolSelectDrawMode}),yt=w.formatMessage({id:"canNotEditWithDifferentGeometries",defaultMessage:g.defaultMessages.canNotEditWithDifferentGeometries});return(0,n.jsxs)("div",{className:"jimu-draw-tool "+pt,css:Di(b),role:"group","aria-label":gt,children:[!L&&(0,n.jsx)("div",{className:"jimu-draw-api-loader align-items-center justify-content-center",children:(0,n.jsx)("div",{className:"skeleton"})}),(0,n.jsxs)("div",{className:"w-100 ",ref:e=>{it.current=e},css:i.css`
      .jimu-draw-sketch-tools.hide-selection-tools > .esri-sketch__panel > .esri-sketch__tool-section:first-of-type {
        display: none;
      }
  `,children:[(0,n.jsx)("div",{className:"jimu-draw-sketch-tools d-flex align-items-center border-0 "+ht+dt,children:(0,n.jsx)("div",{ref:e=>{Z.current=e}})}),Fe&&(0,n.jsx)("div",{className:"can-not-edit-tips d-flex align-items-center justify-content-center surface-1 border-0 ",children:yt}),(0,n.jsx)(Li,{onLoad:e=>{nt.current=e}})]})]})}),Pi=i.React.memo(e=>{var t;const{layoutContextStates:o,dispatchLayoutActions:s}=i.React.useContext(Qt),{sketchContextStates:a,dispatchSketchActions:l}=i.React.useContext(Wi),{symbolContextStates:r,dispatchSymbolActions:c}=i.React.useContext(Xe),{measurementsContextStates:d}=i.React.useContext(St),{dispatchGraphicsUndoRedoActions:p}=i.React.useContext(si),u=i.React.useRef(null);i.React.useEffect(()=>{u.current=a.getGraphicsLayerFunRef},[e,a]);const h=i.React.useCallback(e=>{var t;const i=u.current&&(null===(t=u.current().graphics)||void 0===t?void 0:t.items),o=[];i.forEach(e=>{o.push(e.toJSON())}),p({type:Zt,payload:o}),"function"==typeof a.callBacks.onDrawingFinished&&a.callBacks.onDrawingFinished(e)},[a.callBacks,p]),m=i.React.useCallback(e=>{c((e=>({type:Ge,payload:e}))(e))},[c]),g=i.React.useCallback(e=>{c(Ze(e))},[c]),y=i.React.useCallback(e=>{l(Fi(e))},[l]),S=i.React.useCallback(e=>{s((e=>({type:Ft,payload:e}))(e))},[s]),M=i.React.useCallback(e=>{s((e=>({type:Vt,payload:e}))(e))},[s]);return(0,n.jsx)(i.React.Fragment,{children:e.jimuMapView&&(0,n.jsx)(Oi,{jimuMapView:e.jimuMapView,operatorWidgetId:e.operatorWidgetId,creationMode:a.drawingOptions.creationMode,visibleElements:a.drawingOptions.visibleElements,snappingOptions:a.drawingOptions.snappingOptions,tooltipOptions:a.drawingOptions.tooltipOptions,labelOptions:a.drawingOptions.labelOptions,updateOnGraphicClick:a.drawingOptions.updateOnGraphicClick,defaultCreateOptions:a.drawingOptions.defaultCreateOptions,defaultUpdateOptions:a.drawingOptions.defaultUpdateOptions,elevationInfo:a.drawingOptions.drawingElevationMode3D,layerListMode:null!==(t=a.drawingOptions.layerListMode)&&void 0!==t?t:"hide",defaultSymbols:r.defaultSymbols,pointSymbol:r.pointSymbol,polylineSymbol:r.polylineSymbol,polygonSymbol:r.polygonSymbol,textSymbol:r.textSymbol,onJimuDrawCreated:e=>{l(Vi(e))},onToolsActivated:e=>{var t;"function"==typeof(null===(t=a.callBacks)||void 0===t?void 0:t.onToolsActivated)&&a.callBacks.onToolsActivated(e)},onDrawingCleared:()=>{var e;"function"==typeof(null===(e=a.callBacks)||void 0===e?void 0:e.onDrawingCleared)&&a.callBacks.onDrawingCleared()},onDrawingStarted:()=>{"function"==typeof a.callBacks.onDrawingStarted&&a.callBacks.onDrawingStarted()},onDrawingCanceled:()=>{"function"==typeof a.callBacks.onDrawingCanceled&&a.callBacks.onDrawingCanceled()},onDrawingFinished:h,onDrawingUpdated:e=>{"function"==typeof a.callBacks.onDrawingUpdated&&a.callBacks.onDrawingUpdated(e)},currentSymbolChanged:m,currentSymbolTypeChanged:g,currentActiveToolChanged:y,uiOptions:o.uiOptions,disableSymbolSelector:o.disableSymbolSelector,currentActiveBtnChanged:S,isExpandSymbolList:o.isExpandSymbolList,setIsExpandSymbolList:M,enableSymbolSelector:o.enableSymbolSelectorFunRef,measurementsRuntimeInfo:d.measurementsRuntimeInfo})})}),Ai=i.React.memo(e=>{const{sketchContextStates:t}=i.React.useContext(Wi),{layoutContextStates:o}=i.React.useContext(Qt);return i.React.useEffect(()=>{"function"==typeof e.onJimuDrawCreated&&t.sketchRef&&e.onJimuDrawCreated({sketch:t.sketchRef,getGraphicsLayer:t.getGraphicsLayerFunRef,completeOperation:t.completeDrawFunRef,destroy:t.destroy,enableSymbolSelector:o.enableSymbolSelectorFunRef,sketchToolbarDom:t.sketchToolbarDom})},[e.onJimuDrawCreated,t.sketchRef,t.getGraphicsLayerFunRef,t.completeDrawFunRef]),(0,n.jsx)(Pi,Object.assign({},e))}),Ei="SketchChanged",Ri="IsDisplayCanvasLayerChanged",ki="ActiveToolChanged",zi="DrawingOptionsChanged",Ui="CallBacksChanged",Vi=e=>({type:Ei,payload:e}),Fi=e=>({type:ki,payload:e}),Bi=e=>({sketchRef:null,getGraphicsLayerFunRef:null,completeDrawFunRef:null,destroy:null,isDisplayCanvasLayer:!1,activeTool:null,drawingOptions:{creationMode:at.Continuous,drawingElevationMode3D:st.OnTheGround,visibleElements:{createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0,customText:!1},undoRedoMenu:!0,settingsMenu:!1,snappingControlsElements:{selfEnabledToggle:!1,featureEnabledToggle:!1,gridEnabledToggle:!1}},snappingOptions:{enabled:!1},tooltipOptions:{enabled:!1},labelOptions:{enabled:!1},updateOnGraphicClick:!0,defaultCreateOptions:{hasZ:!0},defaultUpdateOptions:{enableZ:!1}},callBacks:{onJimuDrawCreated:null,onToolsActivated:null,onDrawingCleared:null},sketchToolbarDom:null}),Gi=(e,t)=>{switch(t.type){case Ei:const i=t.payload;return Object.assign(Object.assign({},e),{sketchRef:i.sketch,getGraphicsLayerFunRef:i.getGraphicsLayer,completeDrawFunRef:i.completeOperation,destroy:i.destroy,sketchToolbarDom:i.sketchToolbarDom});case Ri:return Object.assign(Object.assign({},e),{isDisplayCanvasLayer:t.payload});case ki:return Object.assign(Object.assign({},e),{activeTool:t.payload});case zi:return Object.assign(Object.assign({},e),{drawingOptions:Object.assign(e.drawingOptions,t.payload)});case Ui:return Object.assign(Object.assign({},e),{callBacks:Object.assign(e.callBacks,t.payload)});default:throw new Error}},Wi=i.React.createContext(null),Hi=e=>{const[t,o]=i.React.useReducer(Gi,e.initStates,Bi);return(0,n.jsx)(Wi.Provider,{value:{sketchContextStates:t,dispatchSketchActions:o},children:e.children})},Qi=i.React.memo(e=>{const{dispatchSketchActions:t}=i.React.useContext(Wi),{dispatchLayoutActions:o}=i.React.useContext(Qt),{dispatchSymbolActions:s}=i.React.useContext(Xe),{dispatchMeasurementsActions:a}=i.React.useContext(St);return i.React.useEffect(()=>{var i;t((i=e.isDisplayCanvasLayer,{type:Ri,payload:i}))},[e.isDisplayCanvasLayer,t]),i.React.useEffect(()=>{var i;t((i=e.drawingOptions,{type:zi,payload:null!=i?i:{}}))},[t,e.drawingOptions]),i.React.useEffect(()=>{var i;t((i={onJimuDrawCreated:e.onJimuDrawCreated,onToolsActivated:e.onToolsActivated,onDrawingCleared:e.onDrawingCleared,onDrawingStarted:e.onDrawingStarted,onDrawingCanceled:e.onDrawingCanceled,onDrawingFinished:e.onDrawingFinished,onDrawingUpdated:e.onDrawingUpdated},{type:Ui,payload:null!=i?i:{}}))},[t,e.onJimuDrawCreated,e.onToolsActivated,e.onDrawingCleared,e.onDrawingStarted,e.onDrawingCanceled,e.onDrawingFinished,e.onDrawingUpdated]),i.React.useEffect(()=>{o(Gt(e.disableSymbolSelector))},[e.disableSymbolSelector,o]),i.React.useEffect(()=>{var t;s((t=e.defaultSymbols,{type:Qe,payload:t}))},[e.defaultSymbols,s]),i.React.useEffect(()=>{var t;s((t={onPointSymbolChanged:e.onPointSymbolChanged,onPolylineSymbolChanged:e.onPolylineSymbolChanged,onPolygonSymbolChanged:e.onPolygonSymbolChanged},{type:He,payload:null!=t?t:{}}))},[s,e.onPointSymbolChanged,e.onPolylineSymbolChanged,e.onPolygonSymbolChanged]),i.React.useEffect(()=>{a(mt(Object.assign({},e.measurementsInfo)))},[e.measurementsInfo,a]),i.React.useEffect(()=>{var t;a((t=e.measurementsUnitsInfos,{type:ht,payload:t}))},[e.measurementsUnitsInfos,a]),(0,n.jsx)(kt,{jimuMapView:e.jimuMapView,operatorWidgetId:e.operatorWidgetId,uiOptions:e.uiOptions})}),Ji=i.React.memo(e=>(0,n.jsx)(Mt,{initStates:null,children:(0,n.jsx)(ai,{initStates:null,children:(0,n.jsx)(Hi,{initStates:null,children:(0,n.jsx)(et,{initStates:e.defaultSymbols,children:(0,n.jsx)(Jt,{initStates:null,children:(0,n.jsx)(Qi,Object.assign({},e))})})})})}));(0,t.registerStyles)("jimu-ui/advanced/map/",e)})(),c})())}}});