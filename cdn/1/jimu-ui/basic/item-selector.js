System.register(["jimu-core","jimu-theme","jimu-ui"],(function(e,t){var s={},i={},o={};return{setters:[function(e){s.DataSourceTypes=e.DataSourceTypes,s.React=e.React,s.SessionManager=e.SessionManager,s.SupportedItemTypes=e.SupportedItemTypes,s.classNames=e.classNames,s.css=e.css,s.dataSourceUtils=e.dataSourceUtils,s.esri=e.esri,s.getAppStore=e.getAppStore,s.injectIntl=e.injectIntl,s.jsx=e.jsx,s.moduleLoader=e.moduleLoader,s.polished=e.polished,s.portalUrlUtils=e.portalUrlUtils,s.requestUtils=e.requestUtils},function(e){i.registerStyles=e.registerStyles,i.withStyles=e.withStyles},function(e){o.Button=e.Button,o.Icon=e.Icon,o.Link=e.Link,o.Loading=e.Loading,o.LoadingType=e.LoadingType,o.PanelHeader=e.PanelHeader,o.Popper=e.Popper,o.defaultMessages=e.defaultMessages}],execute:function(){e((()=>{var e={42957:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 2.443L5.851 14 0 8.115l1.45-1.538 4.31 4.334L14.463 1 16 2.443z" fill="#000"></path></svg>'},93898:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.003 4.404l.778.778a.5.5 0 10.707-.707l-2.12-2.122a.5.5 0 00-.708.708l.63.63A4.481 4.481 0 003.307 6.5c0 .515.087 1.01.246 1.47a9.794 9.794 0 001.014-.144 3.49 3.49 0 01-.26-1.326c0-.786.26-1.512.697-2.096zM7.806 3c-.396 0-.778.066-1.134.188l-.767-.768A4.483 4.483 0 017.806 2c1.477 0 2.787.711 3.608 1.81-.23.26-.465.507-.702.738A3.497 3.497 0 007.806 3zm-1.76 6.525c-.443.126-.87.223-1.276.296a4.483 4.483 0 002.536 1.152V13h-1.5a.5.5 0 000 1h4a.5.5 0 000-1h-1.5v-2.027a4.5 4.5 0 003.952-5.14 14.98 14.98 0 01-.958.881 3.5 3.5 0 01-5.255 2.811zm7.348-6.307a.49.49 0 01.123.691c-3.456 4.73-8.25 5.903-10.712 5.872a.47.47 0 01-.453-.523.537.537 0 01.544-.476c2.197.003 6.592-1.072 9.796-5.438a.514.514 0 01.702-.126z" fill="#000"></path></svg>'},46530:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 4s-2.267-.168-3-.5c-.385-.174-.628-.478-.86-.767C8.837 2.353 8.554 2 8 2c-.554 0-.837.353-1.14.733-.232.289-.475.593-.86.767-.734.332-3 .5-3 .5s.077 3.846 1 6c.87 2.03 4 4 4 4s.288-.181.713-.49a3.5 3.5 0 003.916-5.788C12.963 5.862 13 4 13 4zm-1.299 3.212c.061-.38.11-.761.151-1.128.048-.44.081-.845.103-1.18a16.064 16.064 0 01-1.371-.204c-.326-.065-.701-.155-.996-.289-.626-.283-1.032-.8-1.25-1.078a5.88 5.88 0 00-.078-.1c-.214-.26-.248-.24-.258-.234L8 3l-.002-.001c-.01-.006-.044-.025-.258.235l-.079.1c-.217.276-.623.794-1.249 1.077-.295.134-.67.224-.996.288a16.061 16.061 0 01-1.371.204c.022.336.055.74.103 1.18.133 1.217.372 2.591.771 3.523.336.783 1.174 1.656 2.05 2.389.241.202.475.385.685.543a3.5 3.5 0 014.047-5.327zM13 10.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" fill="#000"></path></svg>'},97472:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 4s-2.267-.168-3-.5c-.385-.174-.628-.478-.86-.767C8.837 2.353 8.554 2 8 2c-.554 0-.837.353-1.14.733-.232.289-.475.593-.86.767-.734.332-3 .5-3 .5s.077 3.846 1 6c.87 2.03 4 4 4 4s3.13-1.97 4-4c.923-2.154 1-6 1-6zm-5 8.791a16.97 16.97 0 001.032-.796c.875-.733 1.713-1.606 2.049-2.389.4-.932.638-2.306.771-3.522.048-.44.081-.845.103-1.18a16.064 16.064 0 01-1.371-.204c-.326-.065-.701-.155-.996-.289-.626-.283-1.032-.8-1.25-1.078a5.88 5.88 0 00-.078-.1c-.214-.26-.248-.24-.258-.234L8 3l-.002-.001c-.01-.006-.044-.025-.258.235a5.88 5.88 0 00-.079.1c-.217.276-.623.794-1.249 1.077-.295.134-.67.224-.996.288a16.061 16.061 0 01-1.371.204c.022.336.055.74.103 1.18.133 1.217.372 2.591.771 3.523.336.783 1.174 1.656 2.05 2.389.384.322.749.595 1.031.796z" fill="#000"></path></svg>'},88866:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5.5a1 1 0 100-2 1 1 0 000 2zM6.5 7.5A.5.5 0 017 7h1.5v4.5h1a.5.5 0 010 1h-3a.5.5 0 010-1h1V8H7a.5.5 0 01-.5-.5z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 16A8 8 0 118 0a8 8 0 010 16zm0-1A7 7 0 108 1a7 7 0 000 14z" fill="#000"></path></svg>'},50342:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 11.5l5.354-5.354-.708-.707L7 10.086 4.354 7.439l-.708.707L7 11.5z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M0 8a8 8 0 1016 0A8 8 0 000 8zm15 0A7 7 0 111 8a7 7 0 0114 0z" fill="#000"></path></svg>'},48891:e=>{"use strict";e.exports=s},34796:e=>{"use strict";e.exports=i},30726:e=>{"use strict";e.exports=o}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{"use strict";r.r(a),r.d(a,{DataBadge:()=>$,ItemCategory:()=>E,ItemDetail:()=>R,ItemSelector:()=>W,ItemTypes:()=>s.SupportedItemTypes,SortField:()=>z,SortOrder:()=>L});var e={};r.r(e),r.d(e,{DataBadge:()=>l,ItemDetail:()=>o,ItemSelector:()=>i});var t=r(34796),s=r(48891);function i(e){const t=e.theme;return s.css`
    .modal-dialog{
      max-width: auto;
    }

    .mt-13{
      margin-top: ${s.polished.rem(13)};
    }

    .ds-thumbnail{
      width:  ${s.polished.rem(18)};
      height:  ${s.polished.rem(18)};
      background-color: ${t.colors.palette.info[400]};
    }

    .ds-type{
      font-size: ${s.polished.rem(13)};
      color: ${t.colors.palette.dark[800]};
      max-width: ${s.polished.rem(168)};
    }

    .item-selector{
      width: 100%;
      height: 100%;
      padding: 0;
      position: relative;

      .item-list-container{
        overflow-x: auto;
        overflow-y: auto;
        padding-top: 0.25rem;
        height: calc(100% - ${s.polished.rem(100)});
      }

      .item-border-color-cyan{
        border: ${s.polished.rem(2)} solid ${t.colors.palette.primary[700]} !important;
      }

      @media only screen and (max-width: 1210px){
        .item-list{
          width: 540px;
        }
      }

      @media only screen and (min-width: 1210px){
        .item-list{
          width: 810px;
        }
      }

      @media only screen and (min-width: 1480px){
        .item-list{
          width: 1080px;
        }
      }

      @media only screen and (min-width: 1750px){
        .item-list{
          width: 1350px;
        }
      }

      @media only screen and (min-width: 2020px){
        .item-list{
          width: 1620px;
        }
      }

      @media only screen and (min-width: 2290px){
        .item-list{
          width: 1890px;
        }
      }

      @media only screen and (min-width: 2560px){
        .item-list{
            width: 2160px;
        }
      }

      @media only screen and (min-width: 2830px){
        .item-list{
            width: 2430px;
        }
      }

      @media only screen and (min-width: 3100px){
        .item-list{
            width: 2700px;
        }
      }

      .item-list{
        display: flex;
        flex-wrap: wrap;
        margin-left: -0.5rem;
        margin-right: -0.5rem;
        overflow: visible;
        min-width: ${s.polished.rem(540)};

        .item{
          width: ${s.polished.rem(240)};
          margin: 0 ${s.polished.rem(15)} ${s.polished.rem(30)} ${s.polished.rem(15)};

          .two-line-truncate{
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            word-break: break-word;
            word-wrap: break-word;
          }

          .item-active-border-transparent{
            border: ${s.polished.rem(2)} solid transparent;

            &:hover{
              border-color: ${t.colors.palette.primary[700]};
            }
          }

          .item-card-container.item-border-transparent{
            border: ${s.polished.rem(1)} solid transparent;
          }

          .item-card-container{
            padding-bottom: 122%;
            position: relative;
            overflow: hidden;

            &:hover{
              border-color: transparent !important;
            }

            .mt-10{
              margin-top: 10px;
            }

            .item-card{
              position: absolute;
              background-color: ${t.colors.secondary};

              .item-info-container{
                padding: ${s.polished.rem(12)};
              }

              .item-icon{
                cursor: pointer;
                width: ${s.polished.rem(50)};
                margin-right: -4px;
              }

              .item-sub-label{
                width: 80%;
                max-height: ${s.polished.rem(58)};
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
              }

              .item-label{
                font-size: ${s.polished.rem(16)};
                line-height: ${s.polished.rem(20)};
                color: ${t.colors.palette.dark[800]};
                height: ${s.polished.rem(40)};
              }

              .item-sub-label{
                font-size: ${s.polished.rem(13)};
                color: ${t.colors.palette.dark[600]};
              }

              .item-thumbnail{
                background-size: 100% 100%;
                background-position: top center;
                cursor: pointer;
                height: 56%;
              }

              .item-badge-container{
                position: absolute;
                top: ${s.polished.rem(8)};
                left: ${s.polished.rem(8)};
              }

              .item-active-icon, .item-part-active-icon{
                position: absolute;
                top: -2px;
                right: -2px;

                .item-active-icon-container, .item-part-active-icon-container{
                  width: ${s.polished.rem(26)};
                  height: ${s.polished.rem(26)};
                  line-height: ${s.polished.rem(26)};
                  color: ${t.colors.secondary};
                  background-color: ${t.colors.palette.primary[700]};
                }

                .item-part-active-icon-container{
                  padding: ${s.polished.rem(3)};
                }

              }

              .item-part-active-icon-container{
                .item-part-active-icon-innerbox{
                  width: ${s.polished.rem(18)};
                  height: ${s.polished.rem(18)};
                  background-color: ${t.colors.palette.secondary[300]};
                  >div{
                    width: ${s.polished.rem(10)};
                    height: ${s.polished.rem(10)};
                    border-radius: ${s.polished.rem(1)};
                    background-color: ${t.colors.palette.primary[700]};
                  }
                }
              }
            }
          }
        }
      }

    }

  `}function o(e){const t=e.theme;return s.css`
  .component-item-detail{
    background: ${t.colors.palette.light[300]};
    overflow: auto;
    padding: 0 16px 16px 16px;
    border-left: 1px solid ${t.colors.palette.light[800]};
    border-right: 1px solid ${t.colors.palette.light[800]};
    .ml-12{
      margin-left: ${s.polished.rem(12)};
    }
    .container-fluid{
      padding: 0 !important;
    }
    z-index: 3;
    font-size: ${s.polished.rem(14)};
    .small-text{
      font-size: ${s.polished.rem(13)};
    }
    .html-container{
      *{
        color: ${t.colors.black} !important;
        font-size: ${s.polished.rem(14)} !important;
        font-weight: normal !important;
        font-family: inherit !important;
        background: ${t.colors.palette.light[300]} !important;
      }
    }
    .item-header{
      height: 41px;
      border-bottom: 1px solid ${t.colors.palette.light[800]};
      height: ${s.polished.rem(45)};
      margin-left: -16px;
      margin-right: -16px;
      .item-header-title{
        font-size: 16px;
        line-height: 41px;
      }
    }
    .item-close{
      cursor: pointer;
      margin-right: -4px;
    }
    .item-img{
      img{
        width: 100%;
      }
    }
    .item-line{
      width: 100%;
      height: 1px;
      border-bottom: 1px solid ${t.colors.palette.light[800]};
    }
    .item-detial-title, .item-detial-title:hover, .item-detial-title:focus, .item-detial-title:active{
      outline: none;
      box-shadow: 0 0 0 !important;
      border: 0 !important;
      font-size: 16px;
      white-space: normal !important;
      color: ${t.colors.black};
      .item-detial-title-text{
        max-width: 290px;
      }
    }

    .ds-thumbnail{
      width:  ${s.polished.rem(18)};
      height:  ${s.polished.rem(18)};
      background-color: ${t.colors.palette.info[400]};
    }

    .ds-type{
      font-size: ${s.polished.rem(13)};
      color: ${t.colors.palette.dark[800]};
      max-width: ${s.polished.rem(168)};
    }
  }

  `}function l(e){const t=e.theme;return s.css`
    .badge{
      width: ${s.polished.rem(18)};
      height: ${s.polished.rem(18)};
      border-radius: ${s.polished.rem(9)};
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 2px;
      svg{
        color: ${t.colors.black};
      }
    }

    .auth{
      background-color: ${t.colors.palette.success[300]};
    }

    .living-atlas, .primium, .subscriber{
      background-color: ${t.colors.palette.info[500]};
    }

  `}var n=r(30726),p=r(50342),c=r.n(p);const d=e=>{const{className:t}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,s.classNames)("jimu-icon-component",t);return s.React.createElement(n.Icon,Object.assign({className:o,icon:c()},i))};var m=r(93898),h=r.n(m);const u=e=>{const{className:t}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,s.classNames)("jimu-icon-component",t);return s.React.createElement(n.Icon,Object.assign({className:o,icon:h()},i))};var g=r(97472),v=r.n(g);const f=e=>{const{className:t}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,s.classNames)("jimu-icon-component",t);return s.React.createElement(n.Icon,Object.assign({className:o,icon:v()},i))};var y=r(46530),x=r.n(y);const w=e=>{const{className:t}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,s.classNames)("jimu-icon-component",t);return s.React.createElement(n.Icon,Object.assign({className:o,icon:x()},i))};var b=function(e,t,s,i){return new(s||(s=Promise))((function(o,r){function a(e){try{n(i.next(e))}catch(e){r(e)}}function l(e){try{n(i.throw(e))}catch(e){r(e)}}function n(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,l)}n((i=i.apply(e,t||[])).next())}))};const N={};class S extends s.React.PureComponent{constructor(e){super(e),this.__unmounted=!1,this.fetchItemInfo=(e,t,i=!0)=>b(this,void 0,void 0,(function*(){if(!e||!t)return yield Promise.reject();const o=this.getCachePromiseId(e,t);return i&&N[o]||(N[o]=s.requestUtils.requestWrapper(t,(i=>b(this,void 0,void 0,(function*(){return yield s.esri.restPortal.getItem(e,{portal:s.portalUrlUtils.getPortalRestUrl(t),authentication:i})}))))),yield N[o]})),this.getCachePromiseId=(e,t)=>`${t}-${e}`,this.state={item:null}}componentDidMount(){this.__unmounted=!1,!this.props.item&&this.props.itemId&&this.props.portalUrl&&this.fetchItemInfo(this.props.itemId,this.props.portalUrl).then((e=>{this.__unmounted||this.setState({item:e})}))}componentDidUpdate(e,t){this.props.item||e.portalUrl===this.props.portalUrl&&e.itemId===this.props.itemId||this.fetchItemInfo(this.props.itemId,this.props.portalUrl,!1).then((e=>{this.__unmounted||this.setState({item:e})}),(()=>{this.__unmounted||this.setState({item:null})})),this.props.item&&this.setState({item:null})}componentWillUnmount(){this.__unmounted=!0}render(){var e,t;if(!this.props.item&&!this.props.url&&!this.state.item)return null;const i=this.props.item||this.state.item,o=s.dataSourceUtils.isOriginDataPremium(i,this.props.url),r=s.dataSourceUtils.isOriginDataSubscriber(i,this.props.url),a=(null===(t=null===(e=null==i?void 0:i.contentStatus)||void 0===e?void 0:e.toLowerCase())||void 0===t?void 0:t.indexOf("authoritative"))>-1||r,l="livingatlas"===(null==i?void 0:i.groupDesignations)||r,p=this.props.intl.formatMessage({id:"authoritativeBadgeTooltip",defaultMessage:n.defaultMessages.authoritativeBadgeTooltip}),c=this.props.intl.formatMessage({id:"livingAtlasBadgeTooltip",defaultMessage:n.defaultMessages.livingAtlasBadgeTooltip}),m=this.props.intl.formatMessage({id:"premiumBadgeTooltip",defaultMessage:n.defaultMessages.premiumBadgeTooltip}),h=this.props.intl.formatMessage({id:"subscriberBadgeTooltip",defaultMessage:n.defaultMessages.subscriberBadgeTooltip});return(0,s.jsx)("div",{className:(0,s.classNames)("h-100 d-flex justify-content-center align-items-center",{[this.props.className]:!!this.props.className}),id:this.props.id},a&&(0,s.jsx)("div",{className:"auth badge"},(0,s.jsx)(d,{className:"auth-icon",size:"s",title:p,role:"img"})),l&&(0,s.jsx)("div",{className:"living-atlas badge"},(0,s.jsx)(u,{className:"living-atlas-icon",size:"s",title:c,role:"img"})),o&&(0,s.jsx)("div",{className:"primium badge"},(0,s.jsx)(w,{className:"primium-icon",size:"s",title:m,role:"img"})),r&&!o&&(0,s.jsx)("div",{className:"subscriber badge"},(0,s.jsx)(f,{className:"subscriber-icon",size:"s",title:h,role:"img"})))}}const I=(0,t.withStyles)((0,s.injectIntl)(S),"DataBadge"),$=I,j=new(0,s.esri.Sanitizer);let O=null;class M extends s.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.closeBtnRef=s.React.createRef(),this.onKeyDown=e=>{var t,s,i;"Esc"!==e.key&&"Escape"!==e.key||(e.target===this.closeBtnRef.current?null===(s=(t=this.props).onClose)||void 0===s||s.call(t):null===(i=this.closeBtnRef.current)||void 0===i||i.focus())},this.state={dataComponentsUtils:null,AllDataSourceTypes:null}}componentDidMount(){O||(O=s.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector")),O.then((e=>{const{dataComponentsUtils:t,AllDataSourceTypes:s}=e;this.__unmount||this.setState({dataComponentsUtils:t,AllDataSourceTypes:s})}))}componentWillUnmount(){this.__unmount=!0}render(){var e,t,i;if(!this.props.item)return null;const o=s.SessionManager.getInstance().getSessionByUrl(this.props.portalUrl),r=this.props.item.thumbnail&&this.props.portalUrl?(null==o?void 0:o.token)?`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}?token=${o.token}`:`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}`:"Web Scene"===this.props.item.type?"https://static.arcgis.com/images/scene.png":"https://static.arcgis.com/images/desktopapp.png",a=this.props.item.id&&this.props.portalUrl?`${this.props.portalUrl.replace(/\/sharing\/rest/,"").replace(/\/$/,"")}/home/item.html?id=${this.props.item.id}`:null,{title:l,owner:p,modified:c,description:d,snippet:m}=this.props.item,h=j.sanitize(d),u=j.sanitize(m),g=this.props.item.id,v=null===(e=this.state.dataComponentsUtils)||void 0===e?void 0:e.getDsJsonFromItem(g,this.props.item,this.props.portalUrl),f=null===(t=this.state.dataComponentsUtils)||void 0===t?void 0:t.getDsTypeString(null==v?void 0:v.type,this.props.intl),y=`${g}-desc`;return(0,s.jsx)("div",{className:(0,s.classNames)("h-100",{[this.props.className]:!!this.props.className}),onKeyDown:this.onKeyDown},(0,s.jsx)("div",{className:"h-100 component-item-detail",style:this.props.style},!this.props.hideHeader&&(0,s.jsx)("div",{className:"item-header d-flex justify-content-between"},(0,s.jsx)(n.PanelHeader,{level:1,className:"p-3",showClose:!!this.props.onClose,onClose:this.props.onClose,closeButtonRef:this.closeBtnRef,title:this.props.intl.formatMessage({id:"details",defaultMessage:n.defaultMessages.details})})),(0,s.jsx)("div",{className:"container-fluid"},(0,s.jsx)(n.Link,{to:a,className:"col item-detial-title p-0 text-left mt-3",themeStyle:{type:"link"},target:"_blank","aria-label":l,"aria-describedby":y},(0,s.jsx)("div",{className:"item-img"},(0,s.jsx)("img",{src:r,alt:l})),(0,s.jsx)("div",{className:"mt-2 mb-2"},(0,s.jsx)("h5",{className:"w-100 text-truncate item-detial-title",title:l},l))),(0,s.jsx)("div",{className:"container-fluid",id:y},(0,s.jsx)("div",{className:"d-flex align-items-center w-100 mt-1",title:f},(0,s.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},(0,s.jsx)(n.Icon,{icon:null===(i=this.state.dataComponentsUtils)||void 0===i?void 0:i.getDsIcon(v),className:"text-dark",size:"12"})),(0,s.jsx)("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},(0,s.jsx)("div",{className:"text-truncate ds-type-name"},f))),(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("div",{className:"col small-text"},`${this.props.intl.formatMessage({id:"owner",defaultMessage:n.defaultMessages.owner})}: ${p}`)),(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("div",{className:"col small-text"},`${this.props.intl.formatMessage({id:"updated",defaultMessage:n.defaultMessages.updated})}: ${this.props.intl.formatDate(new Date(c))}`)),(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("div",{className:"ml-12"},(0,s.jsx)(I,{item:this.props.item}))),(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("div",{className:"col item-line"})),m&&(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("p",{className:"col html-container",dangerouslySetInnerHTML:{__html:u}})),(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("h6",{className:"col"},this.props.intl.formatMessage({id:"description",defaultMessage:n.defaultMessages.description}))),(0,s.jsx)("div",{className:"row mt-2 mb-2"},(0,s.jsx)("div",{className:"col html-container",dangerouslySetInnerHTML:{__html:h}}))))))}}const R=(0,s.injectIntl)((0,t.withStyles)(M,"ItemDetail"));var D=r(88866),U=r.n(D);const k=e=>{const{className:t}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,s.classNames)("jimu-icon-component",t);return s.React.createElement(n.Icon,Object.assign({className:o,icon:U()},i))};var P=r(42957),T=r.n(P);const A=e=>{const{className:t}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(s[i[o]]=e[i[o]])}return s}(e,["className"]),o=(0,s.classNames)("jimu-icon-component",t);return s.React.createElement(n.Icon,Object.assign({className:o,icon:T()},i))};let C=null;class _ extends s.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.onItemClicked=e=>{this.props.selected||this.props.partSelected?this.props.onRemoveDataClicked(e,this.props.item):this.props.onAddDataClicked(e,this.props.item)},this.onItemKeyDown=e=>{e.target!==e.currentTarget||"Enter"!==e.key&&" "!==e.key||this.onItemClicked(e)},this.onToggleDetail=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.props.onToggleDetail(e,this.props.item)},this.state={dataComponentsUtils:null}}componentDidMount(){C||(C=s.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector")),C.then((e=>{const{dataComponentsUtils:t}=e;this.__unmount||this.setState({dataComponentsUtils:t})}))}componentWillUnmount(){this.__unmount=!0}render(){var e,t,i;if(!this.props.item)return null;const o=this.props.item.id,r=null===(e=this.state.dataComponentsUtils)||void 0===e?void 0:e.getDsJsonFromItem(o,this.props.item,this.props.portalUrl);if(this.props.hideSingleLayer&&((null==r?void 0:r.type)===s.DataSourceTypes.FeatureLayer||(null==r?void 0:r.type)===s.DataSourceTypes.SceneLayer))return null;const a=s.SessionManager.getInstance().getSessionByUrl(this.props.portalUrl),l=this.props.item.thumbnail&&this.props.portalUrl?(null==a?void 0:a.token)?`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}?token=${a.token}`:`${this.props.portalUrl.replace(/\/$/,"")}/sharing/rest/content/items/${this.props.item.id}/info/${this.props.item.thumbnail}`:"Web Scene"===this.props.item.type?"https://static.arcgis.com/images/scene.png":"https://static.arcgis.com/images/desktopapp.png",p=null===(t=this.state.dataComponentsUtils)||void 0===t?void 0:t.getDsTypeString(null==r?void 0:r.type,this.props.intl),c=`${this.props.item.id}-type-desc`,d=`${this.props.item.id}-owner-desc`,m=`${this.props.item.id}-badge-desc`;return s.React.createElement("div",{className:"item",onClick:this.onItemClicked,onKeyDown:this.onItemKeyDown,role:"option",tabIndex:0,"aria-label":this.props.item.title,"aria-describedby":`${c} ${d} ${m}`,"aria-checked":!!this.props.selected||!!this.props.partSelected&&"mixed"},s.React.createElement("div",{className:(0,s.classNames)("item-active-border-transparent",{"item-border-color-cyan":this.props.selected||this.props.partSelected})},s.React.createElement("div",{className:"item-card-container"},s.React.createElement("div",{className:"h-100 w-100 item-card"},s.React.createElement("div",{className:"item-badge-container"},s.React.createElement(I,{item:this.props.item,id:m})),s.React.createElement("div",{className:(0,s.classNames)({"item-active-icon":this.props.selected},{"d-none":!this.props.selected})},s.React.createElement("div",{className:"text-center item-active-icon-container"},s.React.createElement(A,{size:"m"}))),s.React.createElement("div",{className:(0,s.classNames)({"item-part-active-icon":this.props.partSelected},{"d-none":!this.props.partSelected})},s.React.createElement("div",{className:"item-part-active-icon-container"},s.React.createElement("div",{className:"item-part-active-icon-innerbox d-flex justify-content-center align-items-center"},s.React.createElement("div",null)))),s.React.createElement("div",{className:"w-100 item-thumbnail",style:{backgroundImage:`url(${l})`}}),s.React.createElement("div",{className:"w-100 nav flex-column item-info-container"},s.React.createElement("div",{className:"two-line-truncate item-label",title:this.props.item.title},this.props.item.title),s.React.createElement("div",{className:"d-flex align-items-center w-100 mt-13",title:p},s.React.createElement("div",{className:"d-flex align-items-center justify-content-center flex-shrink-0 ds-thumbnail"},s.React.createElement(n.Icon,{icon:null===(i=this.state.dataComponentsUtils)||void 0===i?void 0:i.getDsIcon(r),className:"text-dark",size:"12"})),s.React.createElement("div",{className:"flex-grow-1 text-truncate pl-2 ds-type"},s.React.createElement("div",{className:"text-truncate ds-type-name",id:c},p))),s.React.createElement("div",{className:"d-flex justify-content-between align-items-center mt-10"},s.React.createElement("div",{className:"text-truncate item-sub-label",title:this.props.intl.formatMessage({id:"owner",defaultMessage:n.defaultMessages.owner})},this.props.item.owner||"",s.React.createElement("span",{className:"sr-only",id:d},this.props.intl.formatMessage({id:"ownerIs",defaultMessage:n.defaultMessages.ownerIs},{ownerName:this.props.item.owner||""}))),s.React.createElement("div",{className:"mw-50 d-flex align-items-top justify-content-end item-icon",title:this.props.intl.formatMessage({id:"details",defaultMessage:n.defaultMessages.details})},s.React.createElement(n.Button,{type:"tertiary",size:"sm",icon:!0,onClick:this.onToggleDetail,ref:this.props.infoBtnRef},s.React.createElement(k,null)))))))))}}var E,z,L;!function(e){e.MyContent="MY_CONTENT",e.MyGroup="MY_GROUP",e.MyOrganization="MY_ORGANIZATION",e.Public="PUBLIC",e.LivingAtlas="LIVING_ATLAS"}(E||(E={})),function(e){e.Modified="modified",e.Title="title",e.Views="numViews"}(z||(z={})),function(e){e.Desc="desc",e.Asc="asc"}(L||(L={}));let B=null;class G extends s.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.pageStart=0,this.pageSize=document?Math.max(3,Math.min(10,Math.ceil((document.body.clientWidth-440)/240)))*Math.ceil((document.body.clientHeight-180)/290):60,this.setItems=(e,t,i,o,r,a,l)=>{this.fetchLivingAtlasGroupId().then((n=>{const p=this.getSearchRequestOptions(e,t,i,n,o,r,a,l);if(!p)return void this.setState({loaded:!0,items:[]});const c=this.getPortalUrl();s.esri.restPortal.searchItems(p).then((e=>{var t;if(!this.__unmount){const s=null===(t=e.results)||void 0===t?void 0:t.map((e=>Object.assign(Object.assign({},e),{portalUrl:c})));this.setState({loaded:!0,items:l?this.state.items.concat(s):s})}}),(e=>{this.__unmount||this.setState({loaded:!0,items:[]}),console.error(e)}))}))},this.getSearchRequestOptions=(e,t,i,o,r,a,l,n)=>{let p=l?`(${l}) AND`:"";Array.isArray(e)?e.forEach(((t,i)=>{let o="";t===s.SupportedItemTypes.FeatureCollection?o+=' AND NOT typekeywords:("Map Notes" OR "Route Layer")':t===s.SupportedItemTypes.SceneService&&(o+=' AND typekeywords:("3DObject" OR "Point")'),p+=0===i?` ((type: "${t}"${o})`:` OR (type: "${t}"${o})`,i===e.length-1&&(p+=")")})):p+=` type:"${e}"`;const c=t;n&&(this.pageStart=this.state.items.length+1);const d=(0,s.getAppStore)().getState(),m=d&&d.user;return m&&this.props.category===E.MyContent?(p+=` AND owner:${m.username}`,a&&(p+=` AND ownerfolder: ${a}`)):m&&this.props.category===E.MyOrganization?p+=` AND orgid:${m.orgId}`:m&&this.props.category===E.MyGroup?(null==r?void 0:r.length)>0?p+=` AND (access:shared OR access:public OR access:org) AND (group:(${r.reduce(((e,t,s)=>0===s?t:`${e} OR ${t}`),"")}))`:p=null:this.props.category===E.LivingAtlas&&(o?p+=` AND group:${o}`:p=null),p?{q:p+' AND NOT type:"Web Mapping Application"',sortField:c,sortOrder:i||"desc",num:this.pageSize,start:this.pageStart,authentication:s.SessionManager.getInstance().getSessionByUrl(this.getPortalUrl())}:null},this.getPortalUrl=()=>{var e,t;return this.props.category===E.Public&&(null===(t=null===(e=(0,s.getAppStore)().getState())||void 0===e?void 0:e.portalSelf)||void 0===t?void 0:t.isPortal)?"https://www.arcgis.com":this.props.portalUrl},this.fetchLivingAtlasGroupId=()=>{return e=this,t=void 0,o=function*(){if(B)return yield B;const e=(0,s.getAppStore)().getState().portalSelf,t=null==e?void 0:e.livingAtlasGroupQuery;if(t){const e={num:1,start:0,sortField:"title",sortOrder:"asc",q:t,authentication:s.SessionManager.getInstance().getSessionByUrl(this.getPortalUrl())};B=s.esri.restPortal.searchGroups(e).then((e=>{var t;return null===(t=null==e?void 0:e.results[0])||void 0===t?void 0:t.id}))}else B=Promise.resolve(null);return B},new((i=void 0)||(i=Promise))((function(s,r){function a(e){try{n(o.next(e))}catch(e){r(e)}}function l(e){try{n(o.throw(e))}catch(e){r(e)}}function n(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,l)}n((o=o.apply(e,t||[])).next())}));var e,t,i,o},this.getWhetherItemSelected=e=>this.props.selectedItems&&this.props.selectedItems.some((t=>t.id===e.id)),this.getWhetherItemPartSelected=e=>this.props.partSelectedItems&&this.props.partSelectedItems.some((t=>t.id===e.id)),this.onScroll=e=>{const t=e.target.clientHeight,s=e.target.scrollHeight-(t+e.target.scrollTop)<=10;this.state.loaded&&s&&(this.setState({loaded:!1}),this.setItems(this.props.itemType,this.props.sortField,this.props.sortOrder,this.getRealGroupIds(),this.props.folderId,this.props.searchValue,!0))},this.onToggleDetail=(e,t)=>{var s;this.setState({showDetailItem:(null===(s=this.state.showDetailItem)||void 0===s?void 0:s.id)===(null==t?void 0:t.id)?null:t})},this.onCloseDetailClicked=()=>{var e,t;null===(t=null===(e=this.showDetailItemRef.current)||void 0===e?void 0:e.focus)||void 0===t||t.call(e),this.setState({showDetailItem:null})},this.onAddDataClicked=(e,t)=>{let s;s=this.props.isRadio?[t]:this.props.selectedItems.concat(t),this.props.onSelect&&this.props.onSelect(s,t)},this.onRemoveDataClicked=(e,t)=>{const s=this.props.selectedItems.filter((e=>e.id!==t.id));this.props.onRemove&&this.props.onRemove(s,t)},this.showDetailItemRef=s.React.createRef(),this.state={loaded:!1,items:[],showDetailItem:null}}componentDidMount(){this.__unmount=!1,this.setItems(this.props.itemType,this.props.sortField,this.props.sortOrder,this.getRealGroupIds(),this.props.folderId,this.props.searchValue)}componentDidUpdate(e,t){e.portalUrl===this.props.portalUrl&&e.category===this.props.category&&e.isRadio===this.props.isRadio&&this.isItemTypeSame(e.itemType,this.props.itemType)&&e.sortField===this.props.sortField&&e.searchValue===this.props.searchValue&&e.sortOrder===this.props.sortOrder&&e.folderId===this.props.folderId&&e.groupId===this.props.groupId||(this.setState({loaded:!1}),this.pageStart=0,this.contentNode&&(this.contentNode.scrollTop=0),this.setItems(this.props.itemType,this.props.sortField,this.props.sortOrder,this.getRealGroupIds(),this.props.folderId,this.props.searchValue))}componentWillUnmount(){this.__unmount=!0,this.contentNode&&this.contentNode.removeEventListener("scroll",this.onScroll)}isItemTypeSame(e,t){const s=Array.isArray(e),i=Array.isArray(t);return s&&i?e.length===t.length&&e.every((e=>t.some((t=>t===e)))):e===t}getRealGroupIds(){return this.props.groupId?[this.props.groupId]:this.getAllGroupIds()}getAllGroupIds(){var e,t;const i=null===(t=null===(e=(0,s.getAppStore)())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.user;return((null==i?void 0:i.groups)||[]).map((e=>e.id))}render(){const e=(0,s.jsx)("div",{className:"item-list"},this.state.items&&this.state.items.map(((e,t)=>{var i;return(0,s.jsx)(_,{selected:this.getWhetherItemSelected(e),partSelected:this.getWhetherItemPartSelected(e),key:t,item:e,portalUrl:this.getPortalUrl(),onAddDataClicked:this.onAddDataClicked,intl:this.props.intl,infoBtnRef:(null===(i=this.state.showDetailItem)||void 0===i?void 0:i.id)===e.id&&this.showDetailItemRef,onRemoveDataClicked:this.onRemoveDataClicked,onToggleDetail:this.onToggleDetail,hideSingleLayer:this.props.hideSingleLayer})})));return(0,s.jsx)("div",{className:(0,s.classNames)("w-100 h-100",{[this.props.className]:!!this.props.className})},(0,s.jsx)("div",{className:"item-selector"},(0,s.jsx)("div",{role:"listbox",className:"w-100 h-100 d-flex flex-wrap justify-content-center align-items-start item-list-container",onScroll:this.onScroll,ref:e=>{this.contentNode=e}},e,!this.state.loaded||this.state.items&&0!==this.state.items.length?null:(0,s.jsx)("div",{className:"w-100 h-100 p-2"},this.props.intl.formatMessage({id:"noItemFoundWarning",defaultMessage:n.defaultMessages.noItemFoundWarning}))),this.props.detailReference&&(0,s.jsx)(n.Popper,{open:!!this.state.showDetailItem,reference:this.props.detailReference,placement:"right-start",offset:[0,0],className:"h-100",style:{width:"260px"},zIndex:99999,disableOverlayManager:!0},(0,s.jsx)(R,{item:this.state.showDetailItem,portalUrl:this.getPortalUrl(),onClose:this.onCloseDetailClicked})),!this.state.loaded&&(0,s.jsx)(n.Loading,{type:n.LoadingType.Primary})))}}const W=(0,t.withStyles)((0,s.injectIntl)(G),"ItemSelector");(0,t.registerStyles)("jimu-ui/basic/item-components/",e)})(),a})())}}}));