System.register(["jimu-core","jimu-core/emotion","jimu-theme","jimu-ui"],function(e,t){var s={},a={},r={},l={};return{setters:[function(e){s.BrowserSizeMode=e.BrowserSizeMode,s.ClauseCascade=e.ClauseCascade,s.ClauseDisplayType=e.ClauseDisplayType,s.ClauseLabelDisplay=e.ClauseLabelDisplay,s.ClauseLogic=e.ClauseLogic,s.ClauseOperator=e.ClauseOperator,s.ClauseSourceType=e.ClauseSourceType,s.ClauseType=e.ClauseType,s.DataSourceManager=e.DataSourceManager,s.EMPTY_OPTION_VALUE=e.EMPTY_OPTION_VALUE,s.EsriFieldType=e.EsriFieldType,s.Immutable=e.Immutable,s.JimuFieldType=e.JimuFieldType,s.QueryScope=e.QueryScope,s.React=e.React,s.ReactRedux=e.ReactRedux,s.SqlExpressionMode=e.SqlExpressionMode,s.SqlQuerySortOrder=e.SqlQuerySortOrder,s.classNames=e.classNames,s.css=e.css,s.dataSourceUtils=e.dataSourceUtils,s.dateUtils=e.dateUtils,s.defaultMessages=e.defaultMessages,s.focusElementInKeyboardMode=e.focusElementInKeyboardMode,s.i18n=e.i18n,s.injectIntl=e.injectIntl,s.lodash=e.lodash,s.moduleLoader=e.moduleLoader,s.polished=e.polished},function(e){a.jsx=e.jsx,a.jsxs=e.jsxs},function(e){r.colorUtils=e.colorUtils,r.registerStyles=e.registerStyles,r.withStyles=e.withStyles,r.withTheme=e.withTheme},function(e){l.AdvancedButtonGroup=e.AdvancedButtonGroup,l.AdvancedSelect=e.AdvancedSelect,l.Button=e.Button,l.Checkbox=e.Checkbox,l.Dropdown=e.Dropdown,l.DropdownButton=e.DropdownButton,l.DropdownItem=e.DropdownItem,l.DropdownMenu=e.DropdownMenu,l.InputGroup=e.InputGroup,l.Modal=e.Modal,l.ModalBody=e.ModalBody,l.ModalFooter=e.ModalFooter,l.ModalHeader=e.ModalHeader,l.NumericInput=e.NumericInput,l.Option=e.Option,l.Popper=e.Popper,l.QueryScopeContext=e.QueryScopeContext,l.Radio=e.Radio,l.Select=e.Select,l.TextInput=e.TextInput,l.Typography=e.Typography,l.defaultMessages=e.defaultMessages}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=r},9044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M6 6.5a.5.5 0 0 1 1 0v6a.5.5 0 0 1-1 0zM9.5 6a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 1 0v-6a.5.5 0 0 0-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M11 0H5a1 1 0 0 0-1 1v2H.5a.5.5 0 0 0 0 1h1.6l.81 11.1a1 1 0 0 0 .995.9h8.19a1 1 0 0 0 .995-.9L13.9 4h1.6a.5.5 0 0 0 0-1H12V1a1 1 0 0 0-1-1m0 3V1H5v2zm1.895 1h-9.79l.8 11h8.19z" clip-rule="evenodd"></path></svg>'},14321:e=>{"use strict";e.exports=l},22390:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><g id="Directional/up-bottom"><path id="up" fill="#000" d="m12 9-4 5-4-5z"></path></g></svg>'},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},30655:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},67386:e=>{"use strict";e.exports=a},72823:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 1C4.15 1 1 4.15 1 8s3.15 7 7 7 7-3.15 7-7-3.15-7-7-7m1.167 11.667H6.834v-2.334h2.333zm-2.333-4.5V3.333h2.333v4.834z" clip-rule="evenodd"></path></svg>'},75560:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.3 15.6A7.3 7.3 0 1 0 8.3 1a7.3 7.3 0 0 0 0 14.6M8.3 2A6.3 6.3 0 1 1 2 8.3 6.307 6.307 0 0 1 8.3 2m3.5 6.8h-4v-5h1v4h3z" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=s},82188:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><g id="Directional/up-top"><path id="up" fill="#000" d="m4 7 4-5 4 5z"></path></g></svg>'},90847:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><g id="Directional/up-down" fill="#000"><path id="up" d="m4 7 4-5 4 5z"></path><path id="up_2" d="m12 9-4 5-4-5z"></path></g></svg>'}},t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";i.r(o),i.d(o,{ClauseInputEditor:()=>l,ClauseRelationship:()=>N,InputEditorRender:()=>Pt,SqlExpressionRuntime:()=>qt,SqlExpressionSizeMode:()=>r,_SqlExpressionRuntime:()=>_t,getCamelCase:()=>U,getClauseArrayByChange:()=>P,getClauseDefaultLabel:()=>$,getClauseLabel:()=>W,getClauseValObjByOperator:()=>Dt,getCodedValueInputEditorsByOperatorAndSourceType:()=>wt,getDefaultClauseSet:()=>xt,getDefaultClauseValObj:()=>Tt,getDefaultGroupExpression:()=>At,getDefaultSingleClause:()=>Et,getDisplayTypes:()=>Mt,getInputEditor:()=>bt,getInputEditorListByOperatorAndSourceType:()=>Nt,getJimuFieldNamesBySqlExpression:()=>R,getKeysInSqlExprBuilder:()=>H,getOperatorsByShortType:()=>A,getShownClauseNumberByExpression:()=>q,getTotalClauseNumberByExpression:()=>z,getUpdatedGroupExpression:()=>Ft,isAskForValueSupportedByOperatorAndSourceType:()=>jt,isCaseSensitiveSupportedByOperatorAndSourceType:()=>Vt,isSqlExpressionValid:()=>_,updateSQLExpressionByVersion:()=>G});var e={};i.r(e),i.d(e,{SqlExpressionClauseRuntime:()=>s,VIDoubleDateOnlyPicker:()=>d,VIDoubleDateTimePicker:()=>d,VIDoubleNumberSelector:()=>d,VIDoubleTimeOnlyPicker:()=>d,VIPillSelector:()=>a,VIPredefinedSelector:()=>u,VITimeOnlyPicker:()=>p});var t=i(79244);function s(e){return t.css`
    margin: 10px 0;

    .sql-expression-label, .sql-expression-display-label{
      width: 100%;
      font-size: ${t.polished.rem(13)};
      color: inherit;
    }
    .sql-expression-input{
      width: 100%;

    }
    .sql-expression-hint{
      margin-top: 4px;
      font-style: italic;
    }

    .clause-inline {
      display: flex;
      justify-content: space-between;
      align-items: center;

      .sql-expression-label {
        width: calc(40% - 8px);
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .sql-expression-label, .sql-expression-display-label {
        line-height: 32px;
      }
      .sql-expression-input{
        width: calc(60% - 8px);
      }
    }

  `}function a(e){const s=e.theme;return t.css`
    /** setting */
    .pill-selector-button{
      justify-content: space-between;
      display: flex;
      align-items: center;

      .pill-display-label{
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        width: calc(100% - 20px);
      }
    }

    .pill-selector-popper{
      padding: 12px;
      max-width: 320px;
      max-height: 320px;
      overflow-y: auto;

      .jimu-btn{
        margin: 4px;
        max-width: 100%;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
    }

    /** runtime */
    .pill-runtime-container{
      /* width: calc(100% + 10px); */
      width: 100%;
      .pill-btn-container{
        overflow-y: auto;
        margin-left: -5px;
        margin-top: -5px;

        .pill-btn{
          margin: 5px;
          max-width: calc(100% - 10px);
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden;
          /* &:first-of-type{
            margin-left: 0;
          }
          &:last-of-type{
            margin-right: 0;
          } */

          &.pill-dash-btn{
            border: 1px dashed ${s.sys.color.divider.tertiary};
          }
        }

        &.skeleton-btn-container {
          display: flex;
          flex-wrap: wrap;
          overflow-y: visible;
          div {
            margin: 5px;
            height: 32px;
            background-color: ${s.sys.color.action.disabled.default};
            &.pill-skeleton1 {
              width: 72px;
            }
            &.pill-skeleton2 {
              width: 48px;
            }
            &.pill-skeleton3 {
              width: 64px;
            }
          }
        }
      }

      &.block-pills .pill-btn{
        display: block;
        margin-top: 10px;
      }
    }
  `}var r,l,n=i(1888);function u(e){const s=e.theme;return t.css`
    .predefined-list{
      min-height: 150px;

      .predefined-list-header{
        border-bottom: 1px solid ${s.sys.color.divider.secondary};
        line-height: 30px;

        .dragIcon{
          width: 26px;
        }
      }

      .predefined-list-content{
        max-height: calc(100vh - 255px);
        overflow-y: auto;

        .jimu-tree-item_template-card .jimu-tree-item__body{
          background-color: ${n.colorUtils.colorMixOpacity(s.sys.color.action.default,.5)};
        }

        .predefined-item{
          display: flex;
          flex-grow: 1;
          padding: 5px 0px;
          margin-bottom: 2px;
        }
      }

      .predefined-value, .predefined-label{
        width: 160px;
        display: flex;
        justify-content: space-between;
        &.value-input-isValid{
          outline: 1px solid ${s.sys.color.error.light};

          button:focus, input:focus, .dropdown-button[aria-expanded="true"] {
            border: none !important;
          }
        }
        .predefined-button-con {
          margin-left: 1px;
        }
      }
      .predefined-label {
        margin-left: 1.5rem;
      }

      .predefined-cbx{
        display: flex;
        width: 150px;
        justify-content: center;
        align-items: center;
      }

      .predefined-delete{
        width:100px;
        text-align: right;
      }

    }

    .invalid-label{
      color: ${s.sys.color.error.light};
      font-size: 12px;
      margin-top: '-32px';
      margin-bottom: '8px'
    }
  `}function p(e){const s=e.theme;return t.css`
    .time-input-group {
      display: flex;
      align-items: center;
      width: 100%;
      .time-input{
        flex-grow: 1;
        font-size: 14px;
        width: calc(100% - 32px);
        &:focus {
          border: 1px solid ${s.sys.color.action.focus} !important;
        }
        .jimu-interactive-node:focus-within {
          outline-offset: -2px;
          z-index: 1;
        }
      }
      .time-icon-button {
        margin-left: -1px;
      }
    }
  `}function d(e){return t.css`
    justify-content: space-between;
    .double-input-connector{
      width: 30px;
      min-width: 30px;
      margin: 0 0.25rem;
      text-align: center;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }
  `}function c(e,t=!1){const s="calc(100% - 8px)",a={inputEditorWidth:`calc(${s} * 0.44)`,dropDownWidth:`calc(${s} * 0.32)`,hasConnector:{inputEditorWidth:"calc((100% - 38px) * 0.5)"}};return e&&(t?(a.inputEditorWidth="calc(calc(100% - 4px) * 0.6)",a.dropDownWidth="calc(calc(100% - 4px) * 0.4)"):a.inputEditorWidth="100%"),a}!function(e){e.Small="SMALL",e.Medium="MEDIUM",e.Large="LARGE"}(r||(r={})),function(e){e.DoubleNumberSelector="DOUBLE_NUMBER_SELECTOR",e.TextInput="TEXT_BOX",e.UniquePredefinedSelector="UNIQUE_PREDEFINED_SELECTOR",e.MultiplePredefinedSelector="MULTIPLE_PREDEFINED_SELECTOR",e.FieldSelector="FIELD_SELECTOR",e.SimpleSelect="SIMPLE_SELECT",e.SimpleExpandedList="SIMPLE_EXPANDED_LIST",e.UniquePillWrapSelector="UNIQUE_PILL_WRAP_SELECTOR",e.MultipleSelect="MULTIPLE_SELECT",e.MultipleExpandedList="MULTIPLE_EXPANDED_LIST",e.MultiplePillWrapSelector="MULTIPLE_PILL_WRAP_SELECTOR",e.DatePicker="DATE_PICKER",e.DateTimePicker="DATE_TIME_PICKER",e.DateRangeSelector="DATE_RANGE_SELECTOR",e.DoubleDatePicker="DOUBLE_DATE_PICKER",e.DoubleDateTimePicker="DOUBLE_DATE_TIME_PICKER",e.NumberListSelector="NUMBER_LIST_SELECTOR",e.DateOnlyPicker="DATE_ONLY_PICKER",e.DoubleDateOnlyPicker="DOUBLE_DATE_ONLY_PICKER",e.TimeOnlyPicker="TIME_ONLY_PICKER",e.DoubleTimeOnlyPicker="DOUBLE_TIME_ONLY_PICKER",e.BlankSelector="BLANK_SELECTOR"}(l||(l={}));const h=[l.FieldSelector],m=[l.SimpleSelect,l.SimpleExpandedList,l.UniquePillWrapSelector],v=[l.MultipleSelect,l.MultipleExpandedList,l.MultiplePillWrapSelector],y=[l.TextInput],g=[l.TextInput],S=[l.DoubleNumberSelector],O=[l.DateTimePicker,l.DatePicker],I=[l.DateOnlyPicker],f=[l.TimeOnlyPicker],C=[l.DoubleDatePicker,l.DoubleDateTimePicker],b=[l.DoubleDateOnlyPicker],T=[l.DoubleTimeOnlyPicker],E=[l.NumberListSelector],x=[l.SimpleSelect,l.SimpleExpandedList,l.UniquePillWrapSelector],V=[l.BlankSelector],j=[l.UniquePredefinedSelector],w=[l.MultiplePredefinedSelector],D=[l.SimpleSelect,l.SimpleExpandedList,l.UniquePillWrapSelector],M=[l.MultipleSelect,l.MultipleExpandedList,l.MultiplePillWrapSelector],N={[t.ClauseOperator.StringOperatorIs]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,codedValueInputEditors:x,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorIsNot]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,codedValueInputEditors:x,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorContains]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorDoesNotContain]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorStartsWith]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorDoesNotStartWith]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorEndsWith]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorDoesNotEndWith]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:y,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorIsAnyOf]:{[t.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:v,codedValueInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorIsNoneOf]:{[t.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:v,codedValueInputEditors:v,supportAskForValue:!0,supportCaseSensitive:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorIsBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V,supportCaseSensitive:!0}},[t.ClauseOperator.StringOperatorIsNotBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V,supportCaseSensitive:!0}},[t.ClauseOperator.NumberOperatorIs]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:g,codedValueInputEditors:x,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsNot]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:g,codedValueInputEditors:x,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsAtLeast]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,supportAskForValue:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsAtMost]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,supportAskForValue:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsLessThan]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,supportAskForValue:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsGreaterThan]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:g,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,supportAskForValue:!0},[t.ClauseSourceType.SingleSelectFromPredefined]:{normalInputEditors:j,normalInputEditorsAtRuntime:D,codedValueInputEditors:j,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:S,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsNotBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:S,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsAnyOf]:{[t.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:v,codedValueInputEditors:v,supportAskForValue:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsNoneOf]:{[t.ClauseSourceType.MultipleSelectFromUnique]:{normalInputEditors:v,codedValueInputEditors:v,supportAskForValue:!0},[t.ClauseSourceType.MultipleSelectFromPredefined]:{normalInputEditors:w,normalInputEditorsAtRuntime:M,codedValueInputEditors:w,supportAskForValue:!0}},[t.ClauseOperator.NumberOperatorIsBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.NumberOperatorIsNotBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.DateOperatorIsOn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsNotOn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsIn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:[l.DateRangeSelector],supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsNotIn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:[l.DateRangeSelector],supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsBefore]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOperatorIsAfter]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOperatorIsOnOrBefore]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOperatorIsOnOrAfter]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:O,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOperatorIsInTheLast]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:E,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsNotInTheLast]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:E,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsInTheNext]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:E,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsNotInTheNext]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:E,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:C,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsNotBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:C,supportAskForValue:!0}},[t.ClauseOperator.DateOperatorIsBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.DateOperatorIsNotBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.DateOnlyOperatorIsOn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:I,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0}},[t.ClauseOperator.DateOnlyOperatorIsNotOn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:I,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0}},[t.ClauseOperator.DateOnlyOperatorIsBefore]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:I,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOnlyOperatorIsAfter]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:I,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOnlyOperatorIsOnOrBefore]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:I,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOnlyOperatorIsOnOrAfter]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:I,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.DateOnlyOperatorIsBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:b,supportAskForValue:!0}},[t.ClauseOperator.DateOnlyOperatorIsNotBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:b,supportAskForValue:!0}},[t.ClauseOperator.DateOnlyOperatorIsBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.DateOnlyOperatorIsNotBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.TimeOnlyOperatorIsOn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0}},[t.ClauseOperator.TimeOnlyOperatorIsNotOn]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h},[t.ClauseSourceType.SingleSelectFromUnique]:{normalInputEditors:m,codedValueInputEditors:x,supportAskForValue:!0}},[t.ClauseOperator.TimeOnlyOperatorIsBefore]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.TimeOnlyOperatorIsAfter]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.TimeOnlyOperatorIsOnOrBefore]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.TimeOnlyOperatorIsOnOrAfter]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:f,supportAskForValue:!0},[t.ClauseSourceType.Field]:{normalInputEditors:h}},[t.ClauseOperator.TimeOnlyOperatorIsBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:T,supportAskForValue:!0}},[t.ClauseOperator.TimeOnlyOperatorIsNotBetween]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:T,supportAskForValue:!0}},[t.ClauseOperator.TimeOnlyOperatorIsBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}},[t.ClauseOperator.TimeOnlyOperatorIsNotBlank]:{[t.ClauseSourceType.UserInput]:{normalInputEditors:V}}};function A(e,s){let a=[];return e===t.JimuFieldType.String?a=s===t.EsriFieldType.GlobalID||s===t.EsriFieldType.GUID?[t.ClauseOperator.StringOperatorIs,t.ClauseOperator.StringOperatorIsNot,t.ClauseOperator.StringOperatorIsAnyOf,t.ClauseOperator.StringOperatorIsNoneOf,t.ClauseOperator.StringOperatorIsBlank,t.ClauseOperator.StringOperatorIsNotBlank]:[t.ClauseOperator.StringOperatorIs,t.ClauseOperator.StringOperatorIsNot,t.ClauseOperator.StringOperatorStartsWith,t.ClauseOperator.StringOperatorDoesNotStartWith,t.ClauseOperator.StringOperatorEndsWith,t.ClauseOperator.StringOperatorDoesNotEndWith,t.ClauseOperator.StringOperatorContains,t.ClauseOperator.StringOperatorDoesNotContain,t.ClauseOperator.StringOperatorIsAnyOf,t.ClauseOperator.StringOperatorIsNoneOf,t.ClauseOperator.StringOperatorIsBlank,t.ClauseOperator.StringOperatorIsNotBlank]:e===t.JimuFieldType.Number?a=[t.ClauseOperator.NumberOperatorIs,t.ClauseOperator.NumberOperatorIsNot,t.ClauseOperator.NumberOperatorIsAtLeast,t.ClauseOperator.NumberOperatorIsAtMost,t.ClauseOperator.NumberOperatorIsLessThan,t.ClauseOperator.NumberOperatorIsGreaterThan,t.ClauseOperator.NumberOperatorIsBetween,t.ClauseOperator.NumberOperatorIsNotBetween,t.ClauseOperator.NumberOperatorIsAnyOf,t.ClauseOperator.NumberOperatorIsNoneOf,t.ClauseOperator.NumberOperatorIsBlank,t.ClauseOperator.NumberOperatorIsNotBlank]:e===t.JimuFieldType.Date?a=[t.ClauseOperator.DateOperatorIsOn,t.ClauseOperator.DateOperatorIsNotOn,t.ClauseOperator.DateOperatorIsIn,t.ClauseOperator.DateOperatorIsNotIn,t.ClauseOperator.DateOperatorIsBefore,t.ClauseOperator.DateOperatorIsAfter,t.ClauseOperator.DateOperatorIsOnOrBefore,t.ClauseOperator.DateOperatorIsOnOrAfter,t.ClauseOperator.DateOperatorIsInTheLast,t.ClauseOperator.DateOperatorIsNotInTheLast,t.ClauseOperator.DateOperatorIsInTheNext,t.ClauseOperator.DateOperatorIsNotInTheNext,t.ClauseOperator.DateOperatorIsBetween,t.ClauseOperator.DateOperatorIsNotBetween,t.ClauseOperator.DateOperatorIsBlank,t.ClauseOperator.DateOperatorIsNotBlank]:e===t.JimuFieldType.DateOnly?a=[t.ClauseOperator.DateOnlyOperatorIsOn,t.ClauseOperator.DateOnlyOperatorIsNotOn,t.ClauseOperator.DateOnlyOperatorIsBefore,t.ClauseOperator.DateOnlyOperatorIsAfter,t.ClauseOperator.DateOnlyOperatorIsOnOrBefore,t.ClauseOperator.DateOnlyOperatorIsOnOrAfter,t.ClauseOperator.DateOnlyOperatorIsBetween,t.ClauseOperator.DateOnlyOperatorIsNotBetween,t.ClauseOperator.DateOnlyOperatorIsBlank,t.ClauseOperator.DateOnlyOperatorIsNotBlank]:e===t.JimuFieldType.TimeOnly&&(a=[t.ClauseOperator.TimeOnlyOperatorIsOn,t.ClauseOperator.TimeOnlyOperatorIsNotOn,t.ClauseOperator.TimeOnlyOperatorIsBefore,t.ClauseOperator.TimeOnlyOperatorIsAfter,t.ClauseOperator.TimeOnlyOperatorIsOnOrBefore,t.ClauseOperator.TimeOnlyOperatorIsOnOrAfter,t.ClauseOperator.TimeOnlyOperatorIsBetween,t.ClauseOperator.TimeOnlyOperatorIsNotBetween,t.ClauseOperator.TimeOnlyOperatorIsBlank,t.ClauseOperator.TimeOnlyOperatorIsNotBlank]),a}var F=i(14321);const k=[t.ClauseSourceType.SingleSelectFromUnique,t.ClauseSourceType.MultipleSelectFromUnique];function P(e,t,s){const a=s.split("_"),r=parseInt(a[a.length-1]);let l=e.slice(0,r);return t&&(l=l.concat(t)),l=l.concat(e.slice(r+1,e.length)),l}function U(e){return(e=e.toLowerCase()).replace(/\_(\w)/g,function(e,t){return t.toUpperCase()})}function L(e,s,a){const r={sql:"",logicalOperator:e.logicalOperator,parts:[]},l=s.askForValueOptions.cascade,i=a.split("_");let o=null,n=parseInt(i[1]);return i.length>2&&(o=parseInt(i[1]),n=parseInt(i[3])),l===t.ClauseCascade.Previous?e.parts.some((e,t)=>{if(null!==o)if(t<o)r.parts.push(e);else{if(t!==o)return!0;{const t=e,s={type:t.type,logicalOperator:t.logicalOperator,parts:[]};t.parts.some((e,t)=>!(t<n)||(s.parts.push(e),!1)),r.parts.push(s)}}else{if(!(t<n))return!0;r.parts.push(e)}return!1}):l===t.ClauseCascade.All&&e.parts.some((e,t)=>{if(null!==o)if(t!==o)r.parts.push(e);else{const t=e,s={type:t.type,logicalOperator:t.logicalOperator,parts:[]};t.parts.forEach((e,t)=>{t!==n&&s.parts.push(e)}),r.parts.push(s)}else t!==n&&r.parts.push(e);return!1}),r}function B(e,s,a,r){let l=null;return k.includes(s.valueOptions.sourceType)&&s.askForValueOptions&&s.askForValueOptions.cascade!==t.ClauseCascade.None&&(l=L(e,s,a),l=t.dataSourceUtils.getArcGISSQL((0,t.Immutable)(l),r).sqlExpression),l}function R(e){if(!e)return[];const s={};!function e(a){a.parts&&a.parts.forEach(function(a){if(a.type===t.ClauseType.Set)e(a);else{s[a.jimuFieldName]=!0}})}(e);return Object.keys(s).map(e=>e)}function _(e){let s=!0;return e?(function e(a){a.parts&&a.parts.forEach(function(a){if(a.type===t.ClauseType.Set)e(a);else{a.valueOptions.isValid||(s=!1)}})}(e),s):s}function q(e){let s=0;return e&&e.parts.forEach(e=>{e.type===t.ClauseType.Single&&e.displayType!==t.ClauseDisplayType.None?s++:e.type===t.ClauseType.Set&&e.parts.forEach(e=>{e.displayType!==t.ClauseDisplayType.None&&s++})}),s}function z(e){let s=0;return e&&e.parts.forEach(e=>{e.type===t.ClauseType.Single?s++:s+=e.parts.length}),s}function W(e,s,a,r=!1){const{displayType:l,displayLabel:i,askForValueOptions:o}=e;let n="";return l!==t.ClauseDisplayType.None&&(n=l===t.ClauseDisplayType.UseAskForValue?o.label:i,null===n&&(n=$(e,s,a,r))),n}function $(e,s,a,r=!1){var l;if(!s)return"";let i=(s.alias||s.name)+" "+a;if(r&&(i=a),e.displayType===t.ClauseDisplayType.UseLabel){const a=null===(l=e.valueOptions)||void 0===l?void 0:l.value;if(a){i=`${i} ${a.map(e=>s.type===t.JimuFieldType.String?`'${null==e?void 0:e.label}'`:(null==e?void 0:e.label)||"?").join(", ")}`}}return i}function H(e,s){const a=[];return e.parts.forEach((e,r)=>{const l=`${s}.parts[${r}]`;e.type===t.ClauseType.Single?a.push(...Q(e,l,r)):e.parts.forEach((e,t)=>{a.push(...Q(e,`${l}.parts[${t}]`,t,r))})}),a}function Q(e,s,a,r){const l=[],i=r?"i18nClauseValueInSet":"i18nClauseValue",o={index:a+1+""};let n="";return r?(o.setIndex=r+1+"",n=`Clause set ${r+1} / Clause ${a+1}`):n=`Clause ${a+1}`,e.displayType===t.ClauseDisplayType.UseLabel&&e.displayLabel?l.push({keyType:"value",key:`${s}.displayLabel`,label:{key:"i18nClauseDisplayLabel",enLabel:F.defaultMessages.i18nClauseDisplayLabel},nav:{key:i,values:o,enLabel:n},valueType:"text"}):e.displayType===t.ClauseDisplayType.UseAskForValue&&e.askForValueOptions&&(e.askForValueOptions.label&&l.push({keyType:"value",key:`${s}.askForValueOptions.label`,label:{key:"i18nClauseLabel",enLabel:F.defaultMessages.i18nClauseLabel},nav:{key:i,values:o,enLabel:n},valueType:"text"}),e.askForValueOptions.hint&&l.push({keyType:"value",key:`${s}.askForValueOptions.hint`,label:{key:"i18nClauseHint",enLabel:F.defaultMessages.i18nClauseHint},nav:{key:i,values:o,enLabel:n},valueType:"text"})),l}function G(e,s,a){let r=null;if(e.parts){const l=e.asMutable({deep:!0});return r=l.parts,r.forEach(e=>{e.type===t.ClauseType.Set?e.parts.forEach(e=>{K(e,s,a)}):K(e,s,a)}),l}return null}function K(e,s,a){if("1.1.0"===s&&!e.displayType)if(e.askForValueOptions){if(e.displayType=t.ClauseDisplayType.UseAskForValue,""!==e.askForValueOptions.label){const s=$(e,e.jimuFieldName?(0,t.Immutable)(a.getSchema().fields[e.jimuFieldName]):null,t.i18n.getIntl().formatMessage({id:U(e.operator)}));e.askForValueOptions.label===s&&(e.askForValueOptions.label=null),e.askForValueOptions.label=null}}else e.displayType=t.ClauseDisplayType.None}var Y=i(67386);class J extends t.React.PureComponent{constructor(e){super(e),this.setStateForDisplayUI=()=>{const e=this.props.fieldObj?this.props.fieldObj.type:null;this.setState({displayUI:this.getDisplayUI(e)})},this.getInputValue=(e=this.props.value)=>{var t,s,a;return null!==(a=null===(s=null===(t=e.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)&&void 0!==a?a:""},this.getDisplayUI=e=>{let s="";switch(e){case t.JimuFieldType.Number:s="number";break;case t.JimuFieldType.String:case null:s="text"}return s},this.onNumberChange=e=>{this.setState({inputValue:e})},this.onAcceptNumericValue=e=>{const t=null!=e?e:void 0;this.onChange(t)},this.onTextChange=e=>{this.setState({inputValue:e.target.value})},this.onAcceptTextValue=e=>{(e=e.trim())!==this.state.inputValue&&this.setState({inputValue:e}),this.onChange(e||void 0)},this.onChange=e=>{var t,s;if(!this.props.fieldObj||(null===(s=null===(t=this.props.value.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)===e)return;const a=void 0!==e?[{value:e,label:e+""}]:null,r=Tt(this.props.value.sourceType,this.props.value.inputEditor,a);this.props&&this.props.onChange(r)},this.state={displayUI:null,inputValue:this.getInputValue()}}componentDidMount(){const e=this.props.fieldObj?this.props.fieldObj.type:null;this.setState({displayUI:this.getDisplayUI(e)})}componentDidUpdate(e,t){const{fieldObj:s,value:a}=this.props;s===e.fieldObj&&a.sourceType===e.value.sourceType&&a.inputEditor===e.value.inputEditor||this.setStateForDisplayUI();const r=this.getInputValue();r!==this.getInputValue(e.value)&&this.setState({inputValue:r})}render(){const e=this.props.runtime?void 0:"sm",t=c(this.props.isSmallSize||this.props.runtime).inputEditorWidth;return"number"===this.state.displayUI?(0,Y.jsx)(F.NumericInput,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],size:e,style:{width:t},showHandlers:!1,value:this.state.inputValue,onChange:this.onNumberChange,onAcceptValue:this.onAcceptNumericValue}):(0,Y.jsx)(F.TextInput,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],size:e,style:{width:t},value:this.state.inputValue,onChange:this.onTextChange,onAcceptValue:this.onAcceptTextValue})}}const X=J;class Z extends t.React.PureComponent{constructor(e){super(e),this.getSelectedFields=()=>{const e=this.props.value.value;return e?(0,t.Immutable)([e[0].value]):null},this.onChange=e=>{const t=e[0],s={value:t.jimuName,label:t.alias?t.alias:t.name},a=Tt(this.props.value.sourceType,this.props.value.inputEditor,[s]);this.props&&this.props.onChange(a)},this.state={FieldSelector:null,type:this.props.fieldObj.type}}componentDidMount(){this.__unmount=!1,t.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector").then(e=>{this.__unmount||this.setState({FieldSelector:e.FieldSelector})})}componentWillUnmount(){this.__unmount=!0}componentDidUpdate(e,t){this.props.fieldObj!==e.fieldObj&&this.setState({type:this.props.fieldObj.type})}render(){return this.state.FieldSelector?(0,Y.jsx)("div",{style:{width:c(this.props.isSmallSize).inputEditorWidth},children:(0,Y.jsx)(this.state.FieldSelector,{"aria-label":this.props["aria-label"],types:(0,t.Immutable)([this.state.type]),dataSources:[this.props.dataSource],onChange:this.onChange,hiddenFields:(0,t.Immutable)([this.props.fieldObj.jimuName]),selectedFields:this.getSelectedFields(),isDataSourceDropDownHidden:!0,useDropdown:!0,dropdownProps:{size:this.props.runtime?void 0:"sm"}})}):null}}const ee=Z;class te extends t.React.PureComponent{constructor(){super(...arguments),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onValue1Change=e=>{var t,s;this.value1=null!=e?e:void 0,this.value1!==(null===(s=null===(t=this.props.value.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)&&this.onChange()},this.onValue2Change=e=>{var t,s;this.value2=null!=e?e:void 0,this.value2!==(null===(s=null===(t=this.props.value.value)||void 0===t?void 0:t[1])||void 0===s?void 0:s.value)&&this.onChange()},this.onChange=()=>{const e=[],t=void 0!==this.value1&&null!==this.value1?{value:this.value1,label:this.value1+""}:null,s=void 0!==this.value2&&null!==this.value2?{value:this.value2,label:this.value2+""}:null;e.push(t),e.push(s);const a=Tt(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(a)}}render(){var e,s;const a=this.props.runtime?void 0:"sm";this.value1=(null===(e=this.props.value)||void 0===e?void 0:e.value)&&this.props.value.value[0]?this.props.value.value[0].value:null,this.value2=(null===(s=this.props.value)||void 0===s?void 0:s.value)&&this.props.value.value[1]?this.props.value.value[1].value:null;const r=c(!1);return(0,Y.jsxs)("div",{className:(0,t.classNames)(this.props.className,"double-number-picker d-flex align-items-center"),children:[(0,Y.jsx)(F.NumericInput,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],size:a,style:{width:r.hasConnector.inputEditorWidth},showHandlers:!1,value:this.value1,onAcceptValue:this.onValue1Change}),(0,Y.jsx)("div",{className:"double-input-connector",children:this.i18nMessage("andLowerCase")}),(0,Y.jsx)(F.NumericInput,{"aria-label":this.i18nMessage("andLowerCase"),size:a,style:{width:r.hasConnector.inputEditorWidth},showHandlers:!1,value:this.value2,onAcceptValue:this.onValue2Change})]})}}const se=(0,n.withStyles)((0,t.injectIntl)(te),"VIDoubleNumberSelector");var ae=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};class re extends t.React.PureComponent{constructor(){super(...arguments),this.onValueChange=e=>{const t=Tt(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)},this.useDynamicValues=()=>this.props.runtime&&!this.props.codedValues}render(){const e=this.props.value&&this.props.value.value?this.props.value.value:[],s=this.props,{value:a,fieldObj:r,isMultiple:i,codedValues:o,browserSizeMode:n,runtime:u}=s,p=ae(s,["value","fieldObj","isMultiple","codedValues","browserSizeMode","runtime"]),d=!!u&&(a.inputEditor===l.SimpleExpandedList||a.inputEditor===l.MultipleExpandedList);return(0,Y.jsx)("div",{style:{width:c(this.props.isSmallSize||this.props.runtime).inputEditorWidth},children:(0,Y.jsx)(F.AdvancedSelect,Object.assign({},p,{staticValues:o,field:r,selectedValues:e,isMultiple:i,allTag:"allDynamicTag",appendToBody:!!u,hideOptions:n!==t.BrowserSizeMode.Small||!u,autoUpdate:!0,strategy:u?"absolute":"fixed",useCodedValues:!this.useDynamicValues(),isExpandedList:d,hideSearchInput:d,hideBottomTools:d,size:u?void 0:"sm",onChange:this.onValueChange}))})}}const le=t.ReactRedux.connect((e,t)=>({browserSizeMode:(window.jimuConfig.isBuilder?e.appStateInBuilder:e).browserSizeMode}))(re);var ie=i(30655),oe=i.n(ie),ne=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const ue=e=>{const s=window.SVG,{className:a}=e,r=ne(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:oe()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var pe=function(e,t,s,a){return new(s||(s=Promise))(function(r,l){function i(e){try{n(a.next(e))}catch(e){l(e)}}function o(e){try{n(a.throw(e))}catch(e){l(e)}}function n(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}n((a=a.apply(e,t||[])).next())})};class de extends t.React.PureComponent{constructor(e){super(e),this.getDataSource=()=>this.dsManager.createLocalDataSource(this.props.dataSource,this.localDsRandomId),this.sortValuePairs=e=>{if(!e)return null;const{sortList:s=!0,sortType:a="LABEL",sortOrder:r=t.SqlQuerySortOrder.Asc}=this.props;if(!s)return[...e];const l=r===t.SqlQuerySortOrder.Asc?1:-1,i="LABEL"===a?"label":"value";return[...e].sort((e,t)=>{var s;let r;return r="number"==typeof e[i]&&"VALUE"===a?e[i]-t[i]:null===(s=e[i])||void 0===s?void 0:s.localeCompare(t[i],this.props.intl.locale,{numeric:!0,sensitivity:"base"}),l>0?r:-r})},this.isMultiple=()=>this.props.value.sourceType===t.ClauseSourceType.MultipleSelectFromUnique||this.props.value.sourceType===t.ClauseSourceType.MultipleSelectFromPredefined,this.i18nMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]},t),this.updateList=(...e)=>pe(this,[...e],void 0,function*(e=this.props.fieldObj){if(this._isMounted&&!this.props.codedValues&&e){const s={field:e,dataSource:this.dataSource,sqlExpression:this.props.sqlExpression,scope:this.context.scope,widgetId:this.context.widgetId},a=yield t.dataSourceUtils.queryFeatureCountByField(s),r=yield this.getListByPageSize(a,1);this._isMounted&&r&&this.setState({isListReady:!0,list:r.list,listWithSetValues:this.getListWithSetValues(r.list)})}}),this.getListByPageSize=(e,s)=>pe(this,void 0,void 0,function*(){var a,r;const{codedValues:l,fieldObj:i,sqlExpression:o,sortOrder:n}=this.props;if(this._isMounted&&!l&&i){const l=Math.max(null!==(r=null===(a=this.props.dataSource)||void 0===a?void 0:a.getQueryPageSize())&&void 0!==r?r:0,20),u={field:i,dataSource:this.dataSource,sqlExpression:o,scope:this.context.scope,widgetId:this.context.widgetId,pageSize:l*s,sortOrder:n},p=yield t.dataSourceUtils.queryValueLabelsByFieldAndPageSize(u);return this._isMounted&&p&&p.list.length<20&&e&&p.recordLength<e?this.getListByPageSize(e,s+1):Promise.resolve(p)}}),this.getListWithSetValues=e=>{var t;const s=(null===(t=this.props.value)||void 0===t?void 0:t.value)||[];let a=e;return this.props.codedValues||(a=this.sortValuePairs(e.concat(s))),a.forEach((e,t)=>{var s;e.value===(null===(s=a[t+1])||void 0===s?void 0:s.value)&&a.splice(t,1)}),a},this.getDisplayLabel=e=>{let t="";const s=e.value||[],a=s.length;return t=this.isMultiple()?this.i18nMessage("numSelected",{number:a}):a?s[0].label:this.i18nMessage("allTag"),t},this.onTogglePopper=()=>{setTimeout(()=>{this.setState({isOpen:!this.state.isOpen})},100)},this.isPillActive=e=>{var t;return!!((null===(t=this.props.value)||void 0===t?void 0:t.value)?this.props.value.value:[]).filter(t=>t.value===e).length},this.onPillClick=(e,s)=>{var a;const r=s.target.className.indexOf("active")<0;if(!this.isMultiple()&&!r)return;let l=r?[e]:[];this.isMultiple()?null===(a=this.props.value.value)||void 0===a||a.forEach(t=>{(r||!r&&e.value!==t.value)&&l.push({value:t.value,label:t.label})}):(this.setState({isOpen:!1}),l.length&&l[0].value===t.EMPTY_OPTION_VALUE&&(l=[])),l=l.length?l:null;const i=Tt(this.props.value.sourceType,this.props.value.inputEditor,l,!0,this.props.value.inputEditorAtRuntime);this.props&&this.props.onChange(i)},this.getSkeletons=()=>(0,Y.jsxs)("div",{className:"pill-btn-container skeleton-btn-container",children:[(0,Y.jsx)("div",{className:"pill-skeleton1"}),(0,Y.jsx)("div",{className:"pill-skeleton2"}),(0,Y.jsx)("div",{className:"pill-skeleton3"})]}),this.getPills=e=>{const s=this.i18nMessage("allTag"),{isEmptyOptionHidden:a=!1}=this.props,r=this.isMultiple()||a;return(0,Y.jsx)("div",{className:"pill-btn-container",children:(0,Y.jsxs)(F.AdvancedButtonGroup,{wrap:!0,gap:"12px",role:"radiogroup","aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],children:[!r&&(0,Y.jsx)(F.Button,{className:"pill-btn",size:this.props.runtime?void 0:"sm",role:"radio",value:t.EMPTY_OPTION_VALUE,active:null===this.props.value.value,"aria-checked":null===this.props.value.value,onClick:e=>{this.onPillClick({value:t.EMPTY_OPTION_VALUE,label:s},e)},children:s}),e.map((e,s)=>{if(null!==e.value){const a=0===(this.props.codedValues||this.state.list).filter(t=>t.value===e.value).length,r=this.isPillActive(e.value);return(0,Y.jsx)(F.Button,{className:(0,t.classNames)("pill-btn",{"pill-dash-btn":a&&r}),size:this.props.runtime?void 0:"sm",value:e.value,role:"radio",active:r,"aria-checked":r,onClick:t=>{this.onPillClick(e,t)},children:e.label},s)}return null})]})})},de.count++,this.dsManager=t.DataSourceManager.getInstance(),this.localDsRandomId=ce(),this.dataSource=this.getDataSource();const s=this.sortValuePairs(this.props.codedValues);this.state={list:[],listWithSetValues:[],codedValues:s,isOpen:!1,isListReady:null!==s},this._isMounted=!0}componentDidMount(){this.updateList()}componentWillUnmount(){this._isMounted=!1,this.dsManager.destroyDataSource(this.dataSource.id)}componentDidUpdate(e){var t,s;this.props.fieldObj!==e.fieldObj||this.props.codedValues!==e.codedValues||(null===(t=this.props.sqlExpression)||void 0===t?void 0:t.sql)!==(null===(s=e.sqlExpression)||void 0===s?void 0:s.sql)||this.props.sortOrder!==e.sortOrder||this.props.sortType!==e.sortType?(!this.props.codedValues||this.props.codedValues===e.codedValues&&this.props.sortOrder===e.sortOrder&&this.props.sortType===e.sortType||this.setState({isListReady:!0,codedValues:this.sortValuePairs(this.props.codedValues)}),this.updateList()):this.props.dataSourceInfo!==e.dataSourceInfo||this.props.dataSourceBelongInfo!==e.dataSourceBelongInfo?(this.dataSource=this.getDataSource(),this.updateList()):this.props.value!==e.value&&this.setState({listWithSetValues:this.getListWithSetValues(this.state.list)})}render(){const{className:e,value:s,runtime:a}=this.props,r=this.getDisplayLabel(s);let l=this.state.codedValues||this.state.listWithSetValues;return l.length>20&&(l=l.slice(0,20)),(0,Y.jsx)("div",{className:(0,t.classNames)(e,"h-100"),children:a?(0,Y.jsx)("div",{className:"pill-runtime-container",children:this.state.isListReady?this.getPills(l):this.getSkeletons()}):(0,Y.jsxs)("div",{className:"h-100 d-flex",children:[(0,Y.jsxs)(F.Button,{size:"sm",type:"default",className:"pill-selector-button h-100",ref:e=>{this.pillButton=e},title:r,style:{width:c(this.props.isSmallSize||a).inputEditorWidth,justifyContent:this.isMultiple()||null!==s.value?"space-between":"flex-end"},onClick:this.onTogglePopper,children:[(0,Y.jsx)("div",{className:"pill-display-label",children:r}),(0,Y.jsx)(ue,{size:"s"})]}),(0,Y.jsx)(F.Popper,{open:this.state.isOpen,toggle:this.onTogglePopper,className:e,arrowOptions:!0,reference:this.pillButton,children:(0,Y.jsx)("div",{className:"pill-selector-popper",children:(0,Y.jsx)("div",{className:"pill-setting-container",children:this.state.isListReady?this.getPills(l):this.getSkeletons()})})})]})})}}de.contextType=F.QueryScopeContext,de.count=-1;const ce=()=>`PILL_SELECT-${de.count}`,he=t.ReactRedux.connect((e,t)=>{const s=window.jimuConfig.isBuilder?e.appStateInBuilder:e;return s&&t.dataSource?{dataSourceInfo:s.dataSourcesInfo[t.dataSource.id]||null,dataSourceBelongInfo:t.dataSource.isDataView?s.dataSourcesInfo[t.dataSource.belongToDataSource.id]:null}:{dataSourceInfo:null,dataSourceBelongInfo:null}})(de),me=(0,n.withStyles)((0,t.injectIntl)(he),"VIPillSelector");class ve extends t.React.PureComponent{constructor(e){super(e),this.getInputEditor=e=>{let t="";switch(e){case l.DatePicker:case l.DoubleDatePicker:t="date";break;case l.DateTimePicker:case l.DoubleDateTimePicker:t="datetime";break;default:t=null}return t},this.onChange=(e,t)=>{const s=e?[{value:e,label:t||"",isUTC:!0}]:null,a=Tt(this.props.value.sourceType,this.props.value.inputEditor,s);this.props&&this.props.onChange(a)},this.getValueWithTZ=()=>{var e,s,a;const{value:r,dataSource:l}=this.props;if(!(null===(e=r.value)||void 0===e?void 0:e[0])||"string"==typeof(null===(s=r.value)||void 0===s?void 0:s[0].value))return r;const i=null===(a=r.value)||void 0===a?void 0:a[0].value,o=t.dataSourceUtils.getDateFieldValue(i,l);return(0,t.Immutable)(r).setIn(["value","0","value"],o).asMutable({deep:!0})},this.getDateFromUTC=e=>{const s=e.value;let a=new Date(s);return e.isUTC||(a=new Date(s+t.dataSourceUtils.getLocalTimeOffset())),a},this.state={value:this.getValueWithTZ(),DatePicker:null,displayUI:null}}componentDidMount(){this.__unmount=!1,t.moduleLoader.loadModule("jimu-ui/basic/date-picker").then(e=>{this.__unmount||(this.props.value.inputEditor?this.setState({DatePicker:e.DatePicker,displayUI:this.getInputEditor(this.props.value.inputEditor)}):this.setState({DatePicker:e.DatePicker}))})}componentWillUnmount(){this.__unmount=!0}componentDidUpdate(e,t){this.__unmount||(this.props.fieldObj!==e.fieldObj||this.props.value.sourceType!==e.value.sourceType||this.props.value.inputEditor!==e.value.inputEditor?this.setState({displayUI:this.getInputEditor(this.props.value.inputEditor)}):this.props.value!==e.value&&this.setState({value:this.getValueWithTZ()}))}render(){var e;const{runtime:s,style:a,fieldObj:r,dataSource:l,isSmallSize:i}=this.props,{value:o}=this.state;if(!this.state.DatePicker)return null;let n=null,u=null===(e=null==r?void 0:r.format)||void 0===e?void 0:e.dateFormat,p=!1,d=!1;if(this.state.displayUI){if(null==o?void 0:o.value){const e=o.value[0].value;n="string"==typeof e?e:this.getDateFromUTC(o.value[0])}"date"===this.state.displayUI?u?u.indexOf("Time")>0&&(u=u.split("24")[0].split("ShortTime")[0].split("LongTime")[0]):u=t.dateUtils.DATE_TIME_DEFAULT_FORMAT.date:"datetime"===this.state.displayUI&&(p=!0,u?u.indexOf("Time")<0&&(u=u+" "+t.dateUtils.DATE_TIME_DEFAULT_FORMAT.time):u=t.dateUtils.DATE_TIME_DEFAULT_FORMAT.dateTime,u.indexOf("LongTime")>=0&&(d=!0))}return(0,Y.jsx)(this.state.DatePicker,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],style:a||{width:c(i||s).inputEditorWidth},strategy:s?"absolute":"fixed",disablePortal:!s,selectedDate:n,showTimeInput:p,isLongTime:d,format:u,showQuickNavToToday:s,supportVirtualDateList:!s,showTwoMonths:s,showDoneButton:!0,dataSource:l,onChange:(e,t)=>{this.onChange(e,t)}})}}const ye=ve;class ge extends t.React.PureComponent{constructor(e){super(e),this.onChange=(e,s)=>{let a=null;if(e){let r=e;"number"==typeof e&&(r=t.dateUtils.getStrictYMDFormat(e)),a=[{value:r,label:s||""}]}const r=Tt(this.props.value.sourceType,this.props.value.inputEditor,a);this.props&&this.props.onChange(r)},this.getTimesByDateValue=()=>{var e,s;const{value:a}=this.props;return(null===(e=a.value)||void 0===e?void 0:e[0])?t.dateUtils.isStrictYMDFormat(null===(s=a.value)||void 0===s?void 0:s[0].value)?t.dateUtils.getDateByStrictYMDFormat(a.value[0].value):a.value[0].value:null},this.state={value:this.getTimesByDateValue(),DatePicker:null}}componentDidMount(){this.__unmount=!1,t.moduleLoader.loadModule("jimu-ui/basic/date-picker").then(e=>{this.__unmount||this.setState({DatePicker:e.DatePicker})})}componentWillUnmount(){this.__unmount=!0}componentDidUpdate(e,t){this.__unmount||this.props.value!==e.value&&this.setState({value:this.getTimesByDateValue()})}render(){var e;const{runtime:s,style:a,fieldObj:r,isSmallSize:l}=this.props,{value:i}=this.state;if(!this.state.DatePicker)return null;const o=(null===(e=null==r?void 0:r.format)||void 0===e?void 0:e.dateFormat)||t.dateUtils.DATE_TIME_DEFAULT_FORMAT.date;return(0,Y.jsx)(this.state.DatePicker,{className:"date-only-picker",style:a||{width:c(l||s).inputEditorWidth},strategy:s?"absolute":"fixed",disablePortal:!s,selectedDate:i,format:o,showQuickNavToToday:s,supportVirtualDateList:!s,showTwoMonths:s,showDoneButton:!0,onChange:(e,t)=>{this.onChange(e,t)},"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"]})}}const Se=ge;var Oe=i(75560),Ie=i.n(Oe),fe=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const Ce=e=>{const s=window.SVG,{className:a}=e,r=fe(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:Ie()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};class be extends t.React.PureComponent{constructor(e){var s;super(e),this.getStylesForTimeInputPopper=()=>t.css`
      .popper-box .time-inputs {
        margin: 12px;
      }
    `,this.getInputValue=(e=this.props.value)=>{var t,s,a,r;return null!==(r=null===(a=null===(s=null===(t=e.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)||void 0===a?void 0:a.toString())&&void 0!==r?r:""},this.getInputValueLabel=e=>{var s;return t.dateUtils.formatTimeValueByEsriFormat(e,null===(s=this.props.fieldObj.format)||void 0===s?void 0:s.dateFormat,this.props.intl)},this.popperToggle=()=>{this.setState({isOpen:!this.state.isOpen}),this.state.isOpen&&(this.onValueChanged(this.state.inputValue),(0,t.focusElementInKeyboardMode)(this.inputBtnRef.current))},this.timeInputChange=e=>{var t,s;const a=e.target.value;(null===(s=null===(t=this.props.value.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)&&!a?this.timeInputAccepted(null):this.setState({inputValueLabel:a})},this.timeInputAccepted=e=>{var t,s;const{isLongTime:a}=this.state;let r=!1;if(e){let t,s=0;if((e=e.toUpperCase()).includes("AM")||e.includes("PM")){r=(a?/^(0?[1-9]|1[0-2]):[0-5][0-9]:[0-5][0-9]\s?(AM|PM)$/:/^(0?[1-9]|1[0-2]):[0-5][0-9]\s?(AM|PM)$/).test(e),r&&(t=e.split(" ")[0].split(":"),s=e.includes("PM")?12:0)}else{r=(a?/^([01]?\d|2[0-3]):([0-5]?\d):([0-5]?\d)$/:/^([01]?\d|2[0-3]):([0-5]?\d)$/).test(e),r&&(t=e.split(":"))}r?e=`${this.getPrefix(parseInt(t[0]),s)}:${this.getPrefix(parseInt(t[1]))}${a?":"+this.getPrefix(parseInt(t[2])):""}`:this.setState({inputValueLabel:this.getInputValueLabel(this.state.inputValue)})}else r=!0;const l=r?e:(null===(s=null===(t=this.props.value.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)||null;this.onValueChanged(l)},this.getPrefix=(e,t=0)=>("0"+(e+t)).slice(-2),this.timeValueChange=(e,t,s)=>{if(null!==e){const a=`${this.getPrefix(e)}:${this.getPrefix(t)}${this.state.isLongTime?":"+this.getPrefix(s):""}`;this.setState({inputValue:a});const r=this.getInputValueLabel(a);this.setState({inputValueLabel:r})}},this.onValueChanged=e=>{var t,s;if((null===(s=null===(t=this.props.value.value)||void 0===t?void 0:t[0])||void 0===s?void 0:s.value)===e)return;const a=e?[{value:e,label:e}]:null,r=Tt(this.props.value.sourceType,this.props.value.inputEditor,a);this.props&&this.props.onChange(r)},this.inputBtnRef=t.React.createRef();const a=this.getInputValue();this.state={TimeInput:null,isOpen:!1,inputValue:a,inputValueLabel:this.getInputValueLabel(a),isLongTime:!(null===(s=this.props.fieldObj.format)||void 0===s?void 0:s.dateFormat)||this.props.fieldObj.format.dateFormat.includes("LongTime")}}componentDidMount(){this.__unmount=!1,t.moduleLoader.loadModule("jimu-ui/basic/date-picker").then(e=>{this.__unmount||this.setState({TimeInput:e.TimeInput})})}componentDidUpdate(e,t){if(this.__unmount)return;const s=this.getInputValue();s!==this.getInputValue(e.value)&&this.setState({inputValue:s,inputValueLabel:this.getInputValueLabel(s)})}componentWillUnmount(){this.__unmount=!0}render(){const{runtime:e,style:t,isSmallSize:s}=this.props,a=this.props.runtime?void 0:"sm",r=this.props.intl.formatMessage({id:"timePicker",defaultMessage:F.defaultMessages.timePicker});return(0,Y.jsxs)("div",{className:"time-only-picker "+this.props.className,style:t||{width:c(s||e).inputEditorWidth},children:[(0,Y.jsxs)("div",{className:"time-input-group d-flex align-items-center",children:[(0,Y.jsx)(F.TextInput,{className:"time-input border-right-0",type:"text",size:a,value:this.state.inputValueLabel,allowClear:e,onChange:this.timeInputChange,onAcceptValue:this.timeInputAccepted,"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"]}),(0,Y.jsx)(F.Button,{icon:!0,type:"default",size:a,className:"time-icon-button border-left-0",ref:this.inputBtnRef,"aria-label":r,"aria-haspopup":"true","aria-expanded":this.state.isOpen,onClick:this.popperToggle,children:(0,Y.jsx)(Ce,{className:"text-default"})})]}),this.state.TimeInput&&(0,Y.jsx)(F.Popper,{css:this.getStylesForTimeInputPopper(),arrowOptions:!0,"aria-label":r,reference:this.inputBtnRef,open:this.state.isOpen,toggle:this.popperToggle,children:(0,Y.jsx)(this.state.TimeInput,{isLongTime:this.state.isLongTime,disabled:!1,value:this.state.inputValue,onChange:this.timeValueChange})})]})}}const Te=(0,n.withStyles)((0,t.injectIntl)(be),"VITimeOnlyPicker"),Ee=[t.dateUtils.VirtualDateType.ThisWeek,t.dateUtils.VirtualDateType.ThisMonth,t.dateUtils.VirtualDateType.ThisQuarter,t.dateUtils.VirtualDateType.ThisYear];class xe extends t.React.PureComponent{constructor(){super(...arguments),this.onValueChange=(e,t)=>{let s=null;""!==t&&(s=[{value:t,label:""}]);const a=Tt(this.props.value.sourceType,this.props.value.inputEditor,s);this.props&&this.props.onChange(a)}}render(){const e=this.props.value&&this.props.value.value?this.props.value.value[0].value:"";return(0,Y.jsxs)(F.Select,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],size:this.props.runtime?void 0:"sm",style:{width:c(this.props.isSmallSize||this.props.runtime).inputEditorWidth},value:e,onChange:this.onValueChange,children:[(0,Y.jsx)(F.Option,{value:"",children:"\xa0"},0),Ee.map((e,t)=>{const s=U(e),a=this.props.intl.formatMessage({id:s,defaultMessage:F.defaultMessages[s]});return(0,Y.jsx)(F.Option,{value:e,children:a},t)})]})}}const Ve=(0,t.injectIntl)(xe);class je extends t.React.PureComponent{constructor(){super(...arguments),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onChange=()=>{const e=(this.value1.value||[null]).concat(this.value2.value||[null]),t=Tt(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)}}render(){const e=this.props.value,s=(null==e?void 0:e.value)&&e.value[0]?[e.value[0]]:null,a=(null==e?void 0:e.value)&&e.value[1]?[e.value[1]]:null;this.value1=Tt(e.sourceType,e.inputEditor,s),this.value2=Tt(e.sourceType,e.inputEditor,a);const r=c(!1);return(0,Y.jsxs)("div",{className:(0,t.classNames)(this.props.className,"double-datetime-picker d-flex align-items-center w-100"),children:[(0,Y.jsx)(ye,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],style:{width:r.hasConnector.inputEditorWidth},value:this.value1,fieldObj:this.props.fieldObj,runtime:this.props.runtime,dataSource:this.props.dataSource,onChange:e=>{this.value1=e,this.onChange()}}),(0,Y.jsx)("div",{className:"double-input-connector",children:this.i18nMessage("andLowerCase")}),(0,Y.jsx)(ye,{"aria-label":this.i18nMessage("andLowerCase"),style:{width:r.hasConnector.inputEditorWidth},value:this.value2,fieldObj:this.props.fieldObj,runtime:this.props.runtime,dataSource:this.props.dataSource,onChange:e=>{this.value2=e,this.onChange()}})]})}}const we=(0,n.withStyles)((0,t.injectIntl)(je),"VIDoubleDateTimePicker");class De extends t.React.PureComponent{constructor(){super(...arguments),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onChange=()=>{const e=(this.value1.value||[null]).concat(this.value2.value||[null]),t=Tt(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)}}render(){const e=this.props.value,s=(null==e?void 0:e.value)&&e.value[0]?[e.value[0]]:null,a=(null==e?void 0:e.value)&&e.value[1]?[e.value[1]]:null;this.value1=Tt(e.sourceType,e.inputEditor,s),this.value2=Tt(e.sourceType,e.inputEditor,a);const r=c(!1);return(0,Y.jsxs)("div",{className:(0,t.classNames)(this.props.className,"double-datetime-picker double-date-only-picker d-flex align-items-center w-100"),children:[(0,Y.jsx)(Se,{"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],style:{width:r.hasConnector.inputEditorWidth},runtime:this.props.runtime,fieldObj:this.props.fieldObj,value:this.value1,onChange:e=>{this.value1=e,this.onChange()}}),(0,Y.jsx)("div",{className:"double-input-connector",children:this.i18nMessage("andLowerCase")}),(0,Y.jsx)(Se,{"aria-label":this.i18nMessage("andLowerCase"),style:{width:r.hasConnector.inputEditorWidth},runtime:this.props.runtime,fieldObj:this.props.fieldObj,value:this.value2,onChange:e=>{this.value2=e,this.onChange()}})]})}}const Me=(0,n.withStyles)((0,t.injectIntl)(De),"VIDoubleDateOnlyPicker");class Ne extends t.React.PureComponent{constructor(){super(...arguments),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onChange=()=>{const e=(this.value1.value||[null]).concat(this.value2.value||[null]),t=Tt(this.props.value.sourceType,this.props.value.inputEditor,e);this.props&&this.props.onChange(t)}}render(){const{className:e,value:s,runtime:a,fieldObj:r,"aria-label":l,"aria-describedby":i}=this.props,o=(null==s?void 0:s.value)&&s.value[0]?[s.value[0]]:null,n=(null==s?void 0:s.value)&&s.value[1]?[s.value[1]]:null;this.value1=Tt(s.sourceType,s.inputEditor,o),this.value2=Tt(s.sourceType,s.inputEditor,n);const u=c(!1);return(0,Y.jsxs)("div",{className:(0,t.classNames)(e,"double-datetime-picker double-time-only-picker d-flex align-items-center w-100"),children:[(0,Y.jsx)(Te,{"aria-label":l,"aria-describedby":i,style:{width:u.hasConnector.inputEditorWidth},runtime:a,fieldObj:r,value:this.value1,onChange:e=>{this.value1=e,this.onChange()}}),(0,Y.jsx)("div",{className:"double-input-connector",children:this.i18nMessage("andLowerCase")}),(0,Y.jsx)(Te,{"aria-label":this.i18nMessage("andLowerCase"),style:{width:u.hasConnector.inputEditorWidth},runtime:a,fieldObj:r,value:this.value2,onChange:e=>{this.value2=e,this.onChange()}})]})}}const Ae=(0,n.withStyles)((0,t.injectIntl)(Ne),"VIDoubleTimeOnlyPicker"),Fe=[t.dateUtils.TimeUnit.Minute,t.dateUtils.TimeUnit.Hour,t.dateUtils.TimeUnit.Day,t.dateUtils.TimeUnit.Week,t.dateUtils.TimeUnit.Month,t.dateUtils.TimeUnit.Year];class ke extends t.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onUnitSelect=e=>{e!==this.props.value.value[0].label&&this.onChange(this.getInputValue(),e)},this.getInputValue=(e=this.props.value)=>{const t=e.value[0];return t.value?t.value:null},this.onInputChange=e=>{this.setState({inputValue:e})},this.onAcceptNumericValue=(e,t)=>{const s=e+""!="NaN"&&e>0?e:null;this.state.inputValue<=0&&this.setState({inputValue:null}),s!==this.getInputValue()&&this.onChange(s,t)},this.onChange=(e,t)=>{const s=[{value:e,label:t}],a=Tt(this.props.value.sourceType,this.props.value.inputEditor,s);this.props&&this.props.onChange(a)},this.toggle=()=>{this.setState({isOpen:!this.state.isOpen})},this.state={isOpen:!1,inputValue:this.getInputValue()}}componentDidUpdate(e,t){const s=this.getInputValue();s!==this.getInputValue(e.value)&&this.setState({inputValue:s})}render(){const{value:e,runtime:t,isSmallSize:s}=this.props,a=e.value[0].label,r=this.i18nMessage(U(a)),l=c(s||t,!0);return(0,Y.jsxs)("div",{className:"d-flex number-list-selector",style:{justifyContent:t?"space-between":"flex-start"},children:[(0,Y.jsx)(F.NumericInput,{size:t?void 0:"sm","aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"],style:{width:l.inputEditorWidth},placeholder:this.i18nMessage("amount"),showHandlers:!1,value:this.state.inputValue,onChange:this.onInputChange,onAcceptValue:e=>{this.onAcceptNumericValue(e,a)}}),(0,Y.jsxs)(F.Dropdown,{className:"ml-1",style:{width:l.dropDownWidth},isOpen:this.state.isOpen,toggle:this.toggle,menuRole:"listbox",activeIcon:!0,"aria-label":this.i18nMessage("unit"),children:[(0,Y.jsx)(F.DropdownButton,{type:"default",size:t?void 0:"sm",arrow:(0,Y.jsx)(ue,{size:"s"}),onClick:this.toggle,title:r,role:"combobox",children:r}),(0,Y.jsxs)(F.DropdownMenu,{showArrow:!0,children:[(0,Y.jsx)(F.DropdownItem,{header:!0,children:this.i18nMessage("selectUnit")}),Fe.map((e,t)=>(0,Y.jsx)(F.DropdownItem,{onClick:()=>{this.onUnitSelect(e)},active:a===e,children:this.i18nMessage(U(e))},t))]})]})]})}}const Pe=(0,t.injectIntl)(ke);var Ue=i(23662),Le=i.n(Ue),Be=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const Re=e=>{const s=window.SVG,{className:a}=e,r=Be(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:Le()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var _e=i(9044),qe=i.n(_e),ze=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const We=e=>{const s=window.SVG,{className:a}=e,r=ze(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:qe()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var $e=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const He=t.React.forwardRef((e,t)=>{const{onKeyDown:s,onClick:a}=e,r=$e(e,["onKeyDown","onClick"]);return(0,Y.jsx)(F.Button,Object.assign({ref:t},r,{onClick:a,onKeyDown:e=>{!a||"Enter"!==e.key&&" "!==e.key||e.preventDefault()},onKeyUp:e=>{!a||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),a(e))}}))});class Qe extends t.React.PureComponent{constructor(e){super(e),this.externalDsStyle={maxWidth:"960px"},this.i18nMessage=e=>{const{intl:t}=this.props;return t?t.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}):""},this.getFilteredCodedValues=()=>{let e=this.props.codedValues;return e&&this.props.excludeValues.forEach(t=>{const s=e.findIndex(e=>e.value===t.value);e=s>=0?e.slice(0,s).concat(e.slice(s+1,e.length)):e}),e},this.getSqlExpressionByExcludedValues=()=>{const{excludeValues:e,dataSource:s,field:a}=this.props;let r=null;if(e){const l=e.asMutable({deep:!0}).filter(e=>e.value!==t.EMPTY_OPTION_VALUE).map(e=>t.dataSourceUtils.createSQLClause(null==a?void 0:a.jimuName,t.ClauseOperator.StringOperatorIsNot,[{value:e.value,label:e.value+""}]));r=t.dataSourceUtils.createSQLExpression(t.ClauseLogic.And,l,s)}return r},this.onSelectValueChange=e=>{null===e?this.onChange({value:t.EMPTY_OPTION_VALUE,label:null,alias:null}):this.onChange({value:e[0].value,label:e[0].label,alias:e[0].label})},this.onNumberValueBlur=e=>{const t=parseFloat(e.target.value),s=t+""!="NaN"?t:null;if(s===this.props.value.value)return;const a=null===s?null:s+"";this.onChange({value:s,label:a,alias:a})},this.onNumberValueKeyUp=()=>{this.numberValueInputRef.blur()},this.onStringValueChange=e=>{const t=e.target.value;this.setState({currentValue:t})},this.onStringValueAccept=e=>{let s=""!==(e=e.trim())?e:null,a=s;e===this.allTag&&(s=t.EMPTY_OPTION_VALUE,a=null),s!==this.props.value.value&&this.onChange({value:s,label:e,alias:a})},this.onAliasUpdate=e=>{let t=e.trim();this.isEmptyItem()&&t===this.allTag&&(t=null),t!==this.props.value.alias&&(t=""!==t?t:this.props.value.alias,this.onChange({value:this.props.value.value,label:t,alias:t,selected:this.props.value.selected}))},this.onAliasChange=e=>{this.setState({currentAlias:e.target.value})},this.setSelected=()=>{this.onChange({value:this.props.value.value,label:this.props.value.label,alias:this.props.value.alias,selected:!this.props.value.selected})},this.onChange=e=>{var s;const a=null!==(s=e.selected)&&void 0!==s?s:this.props.value.selected;this.props&&this.props.onChange(this.props.index,(0,t.Immutable)({value:e.value,label:e.label,alias:e.alias,selected:a}))},this.deleteItem=()=>{this.props&&this.props.onChange(this.props.index,null)},this.toggleAdvancedSelect=()=>{if(this.state.isOpen){t.lodash.debounce(()=>{(0,t.focusElementInKeyboardMode)(this.dropdownBtnRef)},200)()}this.setState({isOpen:!this.state.isOpen})},this.isEmptyItem=(e=this.props.value)=>(null==e?void 0:e.value)===t.EMPTY_OPTION_VALUE,this.getInputValue=()=>{const{value:e}=this.props;return this.isEmptyItem(e)?this.allTag:e.value},this.getInputAlias=(e=this.props.value)=>e.alias||(this.isEmptyItem(e)?this.allTag:""),this.getItem=()=>{const{value:e,isMultiple:s,dataSource:a,field:r,excludeValues:l}=this.props;let i=!1;this.props.allValues.forEach((t,s)=>{if(null===e.value||t.value===e.value&&s<this.props.index)return i=!0,!0});const o=this.isEmptyItem(e),n=this.getInputAlias(e),u=s||l.filter(e=>e.value===t.EMPTY_OPTION_VALUE).length>0;return(0,Y.jsx)(t.React.Fragment,{children:(0,Y.jsxs)("div",{className:"d-flex justify-content-between ml-2",children:[(0,Y.jsx)("div",{className:(0,t.classNames)("predefined-value",{"value-input-isValid":i}),children:this.state.isOpen?(0,Y.jsx)(F.AdvancedSelect,{size:"sm",useKeyUpEvent:!0,appendToBody:!1,strategy:"fixed",dataSource:a,sqlExpression:this.state.sqlExpression,field:r,staticValues:this.state.filteredCodedValues,sortType:"VALUE",selectedValues:[e],isEmptyOptionHidden:u,isOpen:this.state.isOpen,toggle:this.toggleAdvancedSelect,onChange:this.onSelectValueChange}):(0,Y.jsxs)(F.InputGroup,{children:[this.props.field.type===t.JimuFieldType.Number?(0,Y.jsx)(F.NumericInput,{size:"sm","data-draggable":"true",showHandlers:!1,disabled:o,ref:e=>{this.numberValueInputRef=e},value:this.state.currentValue,onBlur:this.onNumberValueBlur,onPressEnter:this.onNumberValueKeyUp}):(0,Y.jsx)(F.TextInput,{size:"sm","data-draggable":"true",disabled:o,ref:e=>{this.stringValueInputRef=e},value:this.state.currentValue||"",onChange:this.onStringValueChange,onAcceptValue:this.onStringValueAccept}),(0,Y.jsx)("div",{className:"predefined-button-con",children:(0,Y.jsx)(He,{icon:!0,size:"sm",type:"default",className:"border-left-0",ref:e=>{this.dropdownBtnRef=e},onClick:()=>{this.setState({isOpen:!0})},children:(0,Y.jsx)(ue,{size:"s"})})})]})}),(0,Y.jsx)("div",{className:"predefined-label",children:(0,Y.jsx)(F.TextInput,{size:"sm",type:"text",className:"w-100","data-draggable":"true",ref:e=>{this.aliasInputRef=e},value:this.state.currentAlias,onChange:this.onAliasChange,onAcceptValue:this.onAliasUpdate})}),(0,Y.jsx)("div",{className:"predefined-cbx",children:this.props.isMultiple?(0,Y.jsx)(F.Checkbox,{className:"mt-1",checked:e.selected,onChange:this.setSelected,"aria-label":null!=n?n:"","aria-checked":e.selected}):(0,Y.jsx)(F.Radio,{style:{cursor:"pointer"},checked:e.selected,onChange:this.setSelected,"aria-label":null!=n?n:"","aria-checked":e.selected})}),(0,Y.jsx)("div",{className:"predefined-delete",children:(0,Y.jsx)(He,{type:"tertiary",onClick:this.deleteItem,icon:!0,size:"sm",title:this.i18nMessage("delete"),"aria-label":this.i18nMessage("delete"),children:(0,Y.jsx)(We,{})})})]})})},this.allTag=this.i18nMessage("allTag"),this.state={currentValue:this.getInputValue(),currentAlias:this.getInputAlias(),filteredCodedValues:this.getFilteredCodedValues(),sqlExpression:this.getSqlExpressionByExcludedValues(),isOpen:!1}}componentDidUpdate(e,t){const{value:s}=this.props;e.value.value!==s.value?this.setState({currentValue:this.getInputValue(),currentAlias:this.getInputAlias()}):e.value.alias!==s.alias&&this.state.currentAlias!==s.alias?this.setState({currentAlias:this.getInputAlias()}):e.excludeValues!==this.props.excludeValues&&this.setState({filteredCodedValues:this.getFilteredCodedValues(),sqlExpression:this.getSqlExpressionByExcludedValues()})}render(){return(0,Y.jsx)("div",{className:"predefined-item",children:this.getItem()})}}const Ge=(0,t.injectIntl)(Qe);var Ke=i(22390),Ye=i.n(Ke),Je=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const Xe=e=>{const s=window.SVG,{className:a}=e,r=Je(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:Ye()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var Ze=i(82188),et=i.n(Ze),tt=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const st=e=>{const s=window.SVG,{className:a}=e,r=tt(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:et()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var at=i(90847),rt=i.n(at),lt=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const it=e=>{const s=window.SVG,{className:a}=e,r=lt(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:rt()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var ot=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};class nt extends t.React.PureComponent{constructor(e){super(e),this.externalDsStyle={maxWidth:"960px"},this.i18nMessage=e=>{const{intl:t}=this.props;return t?t.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}):""},this.addItem=()=>{const e=this.props.isMultiple||0!==this.props.values.length?{value:null,label:null,alias:null,selected:!1}:{value:t.EMPTY_OPTION_VALUE,label:null,alias:null,selected:!0},s=this.props.values.concat({value:e.value,label:e.label,alias:e.label,selected:e.selected});this.props.onChange(s)},this.onChange=(e,s)=>{const a=this.props.values.asMutable({deep:!0}),r=a[e].selected;let l=a.slice(0,e);s&&(l=l.concat(s)),l=l.concat(a.slice(e+1,a.length)),(null==s?void 0:s.selected)&&!this.props.isMultiple?l.forEach(e=>{e.selected&&e.value!==s.value&&(e.selected=!1)}):r&&null===s&&!this.props.isMultiple&&l[0]&&(l[0].selected=!0),this.props.onChange((0,t.Immutable)(l))},this.createItemElement=(e,t,s)=>(0,Y.jsx)(Ge,Object.assign({index:s,value:e,excludeValues:this.props.values.filter(t=>t.value!==e.value&&null!==t.value),allValues:this.props.values},t,{onChange:this.onChange}),s),this.getSortedItems=(e,t)=>{const s=this.props.values.asMutable({deep:!0});return"NUMBER"===this.props.field.type&&"value"===e?s.sort((s,a)=>{const r="asc"===t?1:-1;return s[e]>a[e]?1*r:-1*r}):s.sort((s,a)=>{var r;const[l,i]="asc"===t?[s[e],a[e]]:[a[e],s[e]];return null===(r=String(l))||void 0===r?void 0:r.localeCompare(String(i),this.props.intl.locale,{numeric:!0,sensitivity:"base"})}),s},this.getTitleForSortButton=e=>{let t="sort";return"asc"===e?t="sortedAscending":"desc"===e&&(t="sortedDescending"),this.i18nMessage(t)},this.getAriaLabelForSortButton=(e,t)=>{let s="unsorted";return"asc"===t?s="ascending":"desc"===t&&(s="descending"),this.i18nMessage("value"===e?"sortValueColumn":"sortLabelColumn")+". "+this.i18nMessage(s)},this.getUpDownButton=e=>{const{sortType:t,sortDirection:s}=this.state,a=t===e?s:null;return(0,Y.jsxs)(F.Button,{icon:!0,size:"sm",type:"tertiary",disableHoverEffect:!0,disableRipple:!0,title:this.getTitleForSortButton(a),"aria-label":this.getAriaLabelForSortButton(t,a),onClick:()=>{let a=null;a=t===e?"asc"===s?"desc":"desc"===s?null:"asc":"asc",this.setState({sortType:e,sortDirection:a})},children:["asc"===a&&(0,Y.jsx)(st,{}),"desc"===a&&(0,Y.jsx)(Xe,{}),null===a&&(0,Y.jsx)(it,{})]})},this.state={ListTreeModule:null,sortType:"alias",sortDirection:null}}componentDidMount(){this.__unmount=!1,t.moduleLoader.loadModule("jimu-ui/basic/list-tree").then(e=>{this.__unmount||this.setState({ListTreeModule:e})})}componentDidUpdate(e,s){if(this.__unmount)return;const{sortType:a,sortDirection:r}=this.state;if(s.sortType!==a||s.sortDirection!==r&&null!==r){const e=this.getSortedItems(a,r);this.props.onChange((0,t.Immutable)(e))}}componentWillUnmount(){this.__unmount=!0}render(){const e=this.props,{values:s,onChange:a}=e,r=ot(e,["values","onChange"]),{List:l,TreeItemActionType:i}=this.state.ListTreeModule||{};return(0,Y.jsxs)("div",{className:"predefined-container",children:[(0,Y.jsx)("div",{className:"d-flex justify-content-end",children:(0,Y.jsxs)(F.Button,{size:"sm",onClick:()=>{this.addItem()},type:"default","aria-label":this.i18nMessage("add"),children:[(0,Y.jsx)(Re,{className:"mr-1"}),this.i18nMessage("add")]})}),(0,Y.jsxs)("div",{className:"predefined-list",children:[(0,Y.jsx)("div",{className:"d-flex predefined-list-header pl-2",children:(0,Y.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Y.jsxs)("div",{className:"predefined-value ml-3",children:[(0,Y.jsx)("span",{children:this.i18nMessage("value")}),this.getUpDownButton("value")]}),(0,Y.jsxs)("div",{className:"predefined-label",children:[(0,Y.jsx)("span",{children:this.i18nMessage("label")}),this.getUpDownButton("alias")]}),(0,Y.jsx)("div",{className:"predefined-cbx",children:this.i18nMessage("default")}),(0,Y.jsx)("div",{className:"predefined-delete"})]})}),(0,Y.jsx)("div",{className:"predefined-list-content",children:this.state.ListTreeModule&&(0,Y.jsx)(l,{size:"sm",className:"setting-ui-unit-list",itemsJson:this.props.values.asMutable({deep:!0}).map((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`})),dndEnabled:!0,onDidDrop:(e,s)=>{const{itemJsons:[,a]}=s.props;this.props.onChange((0,t.Immutable)(a.map(e=>e.itemStateDetailContent))),this.setState({sortType:"alias",sortDirection:null})},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:i.RenderOverrideItem,children:[{name:i.RenderOverrideItemDroppableContainer,children:[{name:i.RenderOverrideItemDraggableContainer,children:[{name:i.RenderOverrideItemBody,children:[{name:i.RenderOverrideItemDragHandle},{name:i.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(e,t)=>{const{itemJsons:s}=t.props,a=s[0],l=s[1];return this.createItemElement(a.itemStateDetailContent,r,l.indexOf(a))}})})]})]})}}const ut=(0,t.injectIntl)(nt);var pt=i(72823),dt=i.n(pt),ct=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const ht=e=>{const s=window.SVG,{className:a}=e,r=ct(e,["className"]),l=(0,t.classNames)("jimu-icon jimu-icon-component",a);return s?(0,Y.jsx)(s,Object.assign({className:l,src:dt()},r)):(0,Y.jsx)("svg",Object.assign({className:l},r))};var mt=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};class vt extends t.React.PureComponent{constructor(e){var s,a;super(e),this.externalDsStyle={maxWidth:"700px"},this.i18nMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]},t),this.handleToggle=e=>{var s;e?this.setState({isOpen:!this.state.isOpen}):(0,t.focusElementInKeyboardMode)(null===(s=this.headerRef.parentElement)||void 0===s?void 0:s.nextSibling)},this.handleOkBtn=()=>{if(!this.isPredefinedValid())return void this.setState({isValid:!1});this.handleToggle(!0);const{value:e,onChange:t}=this.props;t(Tt(e.sourceType,e.inputEditor,this.state.value,!0,this.getInputEditorAtRuntime(e)))},this.getInputEditorAtRuntime=e=>{const{sourceType:s,inputEditorAtRuntime:a}=e;return a||(s===t.ClauseSourceType.SingleSelectFromPredefined?l.SimpleSelect:l.MultipleSelect)},this.isPredefinedValid=()=>{let e=!1;if(this.state.value){const t=this.state.value.asMutable({deep:!0}).map(e=>e.value).filter(e=>null!==e);e=Array.from(new Set(t)).length===this.state.value.length}return e},this.handleCancelBtn=()=>{var e,s;this.setState({isValid:!0,value:(0,t.Immutable)(null!==(s=null===(e=this.props.value)||void 0===e?void 0:e.value)&&void 0!==s?s:[])}),this.handleToggle(!0)},this.onSettingValueChange=e=>{this.setState({value:e,isValid:!0})},this.isValuesSet=()=>this.state.value.length>0,this.onValueChangeForRuntime=e=>{const s=e?e.map(e=>e.value):[t.EMPTY_OPTION_VALUE],a=this.state.value.asMutable({deep:!0});a.forEach(e=>{e.selected=s.includes(e.value)});const{value:r,onChange:l}=this.props;l(Tt(r.sourceType,r.inputEditor,a,!0,r.inputEditorAtRuntime))},this.getValuesForRuntime=(e,s)=>{const a=[];if(e.forEach(e=>{const s=e.value===t.EMPTY_OPTION_VALUE&&null===e.alias?this.i18nMessage("allTag"):e.alias;a.push({value:e.value,label:s,selected:e.selected})}),s)return{selectedValues:a.filter(e=>e.selected),staticValues:a};{const e=a.filter(e=>e.selected),t=e.length>0?e:null;return{valueOptions:Object.assign({},this.props.value,{value:t}),staticValues:a}}},this.state={isValid:!0,isOpen:!!e.isOpen,value:(0,t.Immutable)(null!==(a=null===(s=this.props.value)||void 0===s?void 0:s.value)&&void 0!==a?a:[])}}componentDidUpdate(e,s){var a,r;this.props.value!==e.value&&this.setState({value:(0,t.Immutable)(null!==(r=null===(a=this.props.value)||void 0===a?void 0:a.value)&&void 0!==r?r:[])})}render(){const e=this.props,{runtime:s,value:a,fieldObj:r,isMultiple:i,intl:o,browserSizeMode:n}=e,u=mt(e,["runtime","value","fieldObj","isMultiple","intl","browserSizeMode"]),p={width:c(this.props.isSmallSize||s).inputEditorWidth};if(s){const e=a&&a.value?a.value:[],s=a.inputEditorAtRuntime||(a.sourceType===t.ClauseSourceType.SingleSelectFromUnique?l.SimpleSelect:l.MultipleSelect),o=s===l.SimpleExpandedList||s===l.MultipleExpandedList,d=s===l.SimpleSelect||s===l.MultipleSelect||o,c=this.getValuesForRuntime(e,d);return(0,Y.jsx)("div",{style:p,children:d?(0,Y.jsx)(F.AdvancedSelect,Object.assign({},u,{field:r,isMultiple:i,isExpandedList:o,hideSearchInput:o,hideBottomTools:o,hideOptions:n!==t.BrowserSizeMode.Small,selectedValues:c.selectedValues,staticValues:c.staticValues,sortList:!1,isEmptyOptionHidden:!0,onChange:this.onValueChangeForRuntime})):(0,Y.jsx)(me,Object.assign({},u,{runtime:!0,fieldObj:r,isEmptyOptionHidden:!0,value:c.valueOptions,codedValues:c.staticValues,sortList:!1,onChange:e=>{this.onValueChangeForRuntime(e.value||[{value:t.EMPTY_OPTION_VALUE}])}}))})}const d=this.i18nMessage(i?"multiplePredefinedLabel":"uniquePredefinedLabel"),h=o.formatMessage({id:"ok",defaultMessage:t.defaultMessages.ok}),m=o.formatMessage({id:"cancel",defaultMessage:t.defaultMessages.cancel});return(0,Y.jsx)("div",{style:p,children:(0,Y.jsxs)("div",{className:"w-100",children:[(0,Y.jsx)(F.Button,{className:(0,t.classNames)("w-100 h-100 nowrap",{"frame-active":this.isValuesSet()}),type:"secondary",size:"sm",onClick:()=>{this.handleToggle(!0)},title:d,"aria-label":d,children:(0,Y.jsx)("div",{className:"w-100 px-2 text-truncate",children:d})}),(0,Y.jsxs)(F.Modal,{backdrop:"static",centered:!0,isOpen:this.state.isOpen,toggle:()=>{this.handleToggle(void 0)},contentClassName:"border-0 h-100",className:this.props.className,style:this.externalDsStyle,returnfocusafterclose:"true",size:"lg",children:[(0,Y.jsx)(F.ModalHeader,{tag:"h4",toggle:this.handleCancelBtn,children:(0,Y.jsx)("span",{ref:e=>{this.headerRef=e},children:d})}),(0,Y.jsx)(F.ModalBody,{children:(0,Y.jsx)(ut,Object.assign({},u,{field:r,values:this.state.value,isMultiple:i,onChange:this.onSettingValueChange}))}),(0,Y.jsx)(F.ModalFooter,{children:(0,Y.jsxs)("div",{className:"m-0 w-100 d-block",children:[!this.state.isValid&&(0,Y.jsxs)("div",{className:"invalid-label",children:[(0,Y.jsx)(ht,{color:this.props.theme.sys.color.error.light,className:"mr-2"}),this.i18nMessage("predefinedValueInValidTip")]}),(0,Y.jsxs)("div",{className:"d-flex",children:[(0,Y.jsx)(F.Button,{type:"primary",onClick:this.handleOkBtn,className:"ml-auto mr-2",style:{minWidth:"64px"},"aria-label":h,children:h}),(0,Y.jsx)(F.Button,{type:"secondary",onClick:this.handleCancelBtn,style:{minWidth:"64px"},"aria-label":m,children:m})]})]})})]})]})})}}const yt=t.ReactRedux.connect((e,t)=>({browserSizeMode:(window.jimuConfig.isBuilder?e.appStateInBuilder:e).browserSizeMode}))(vt),gt=(0,n.withStyles)((0,n.withTheme)((0,t.injectIntl)(yt)),"VIPredefinedSelector");class St extends t.React.PureComponent{render(){return(0,Y.jsx)("div",{})}}const Ot=St;var It=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(s[a[r]]=e[a[r]])}return s};const ft={[l.TextInput]:X,[l.DoubleNumberSelector]:se,[l.FieldSelector]:ee,[l.SimpleSelect]:le,[l.SimpleExpandedList]:le,[l.UniquePillWrapSelector]:me,[l.MultipleSelect]:le,[l.MultipleExpandedList]:le,[l.MultiplePillWrapSelector]:me,[l.UniquePredefinedSelector]:gt,[l.MultiplePredefinedSelector]:gt,[l.DatePicker]:ye,[l.DateTimePicker]:ye,[l.DateOnlyPicker]:Se,[l.TimeOnlyPicker]:Te,[l.DateRangeSelector]:Ve,[l.DoubleDatePicker]:we,[l.DoubleDateTimePicker]:we,[l.DoubleDateOnlyPicker]:Me,[l.DoubleTimeOnlyPicker]:Ae,[l.NumberListSelector]:Pe,[l.BlankSelector]:Ot},Ct=[l.MultipleSelect,l.MultipleExpandedList,l.MultiplePredefinedSelector];function bt(e){const{valueOptions:t,onChange:s}=e,a=It(e,["valueOptions","onChange"]),r=ft[e.valueOptions.inputEditor],l=Object.assign({value:t},a),i=Ct.includes(t.inputEditor);return(0,Y.jsx)(r,Object.assign({},l,{isMultiple:i,onChange:s}))}function Tt(e,s,a,r,i){const o={isValid:void 0===r||r,sourceType:e||t.ClauseSourceType.UserInput,inputEditor:s||l.TextInput,value:a||(s===l.NumberListSelector?[{value:null,label:t.dateUtils.TimeUnit.Day}]:null)};return i&&(o.inputEditorAtRuntime=i),o}function Et(){return{type:t.ClauseType.Single,jimuFieldName:"",operator:null,valueOptions:Tt(null,null,null,!1),displayType:t.ClauseDisplayType.None,askForValueOptions:null,displayLabel:null}}function xt(){const e=Et(),s=Et();return{type:t.ClauseType.Set,logicalOperator:t.ClauseLogic.And,parts:[e,s]}}function Vt(e,t){return N[e][t].supportCaseSensitive||!1}function jt(e,t){return N[e][t].supportAskForValue||!1}function wt(e,t){return N[e][t].codedValueInputEditors||null}function Dt(e,s,a){const r=t.ClauseSourceType.UserInput;return Tt(r,Nt(e,r,s,a)[0])}function Mt(e,s,a,r,i){const o={},n={};let u=null,p=null,d=l.TextInput;const c=N[a];if(c){for(const e in c)o[e]=[],n[e]=[],p=p||e;Object.keys(o).forEach(l=>{var c;u&&(r=null);const h=Nt(a,l,r,i);o[l]=h.inputEditorTypes,n[l]=h.inputEditorTypesAtRuntime,u=u||h.codedValues,l===p&&(d=h.inputEditorTypes[0],l===t.ClauseSourceType.UserInput&&s.type===t.JimuFieldType.Date&&[t.ClauseOperator.DateOperatorIsOn,t.ClauseOperator.DateOperatorIsNotOn,t.ClauseOperator.DateOperatorIsBefore,t.ClauseOperator.DateOperatorIsAfter,t.ClauseOperator.DateOperatorIsOnOrBefore,t.ClauseOperator.DateOperatorIsOnOrAfter].includes(a)&&(null===(c=s.format)||void 0===c?void 0:c.dateFormat)&&!s.format.dateFormat.includes("Time")&&(d=h.inputEditorTypes[1])),e===t.SqlExpressionMode.Simple&&(o[l]=[l===p?d:h.inputEditorTypes[0]],delete o[t.ClauseSourceType.SingleSelectFromPredefined],delete o[t.ClauseSourceType.MultipleSelectFromPredefined])})}else p=t.ClauseSourceType.UserInput,o[p]=[d];return{displayTypes:o,displayTypesAtRuntime:n,codedValues:u,defaultSourceType:p,defaultInputEditorType:d}}function Nt(e,s,a,r){s=s||t.ClauseSourceType.UserInput;const i=N[e];let o=[],n=null,u=null;if(i){const e=i[s];o=e.normalInputEditors,n=e.normalInputEditorsAtRuntime,e.codedValueInputEditors&&a&&r&&(u=null==a?void 0:a.getFieldCodedValueList(r),(null==u?void 0:u.length)>0&&(o=e.codedValueInputEditors))}else o=[l.TextInput];return{inputEditorTypes:o,inputEditorTypesAtRuntime:n,codedValues:u}}function At(e,s){const a=[],r=e.map(e=>e.id),l=function(e,s,a){if(!e){const r=s.getSchema().fields,l=A((a=a||r[Object.keys(r)[0]]).type,a.esriType)[0],i=Mt(t.SqlExpressionMode.All,a,l,s,a.jimuName),o=Tt(i.defaultSourceType,i.defaultInputEditorType,null,!1);e={type:t.ClauseType.Single,jimuFieldName:a.jimuName,operator:l,displayType:t.ClauseDisplayType.None,askForValueOptions:null,displayLabel:null,valueOptions:o}}return e}(null,e[0],s);return a.push({dataSourceId:r[0],fieldList:[l.jimuFieldName],logicalOperator:t.ClauseLogic.And,clause:l}),r.slice(1,r.length).forEach(e=>{a.push(function(e){return{dataSourceId:e,logicalOperator:t.ClauseLogic.And,fieldList:[]}}(e))}),(0,t.Immutable)(a)}function Ft(e,s,a=!1,r){if(!e)return null;let l;return a?(l=e.asMutable({deep:!0}),l.push({dataSourceId:s[0].dataSourceId,logicalOperator:t.ClauseLogic.And,fieldList:r||[]})):l=e.filter(e=>!s.some(t=>t.dataSourceId===e.dataSourceId)),(0,t.Immutable)(l)}class kt extends t.React.PureComponent{constructor(e){super(e),this._setStateForInputEditor=()=>{const e=this.props.customProps&&"object"==typeof this.props.customProps?this.props.customProps:{},s=Object.assign({valueOptions:this.props.valueOptions,fieldObj:this.props.fieldObj,onChange:this.props.onChange,dataSource:this.props.dataSource,codedValues:this.props.codedValues||null,sortType:this.props.sortType||"VALUE",sortOrder:this.props.sortOrder||t.SqlQuerySortOrder.Asc,runtime:this.props.runtime||!1,sqlExpression:this.props.sqlExpression||null,isSmallSize:this.props.isSmallSize,"aria-label":this.props["aria-label"],"aria-describedby":this.props["aria-describedby"]},e);this.setState({inputEditor:bt(s)})},this.state={inputEditor:null}}componentDidMount(){this._setStateForInputEditor()}componentDidUpdate(e,t){var s,a;(null===(s=this.props.dataSource)||void 0===s?void 0:s.id)===(null===(a=e.dataSource)||void 0===a?void 0:a.id)&&this.props.fieldObj===e.fieldObj&&this.props.valueOptions===e.valueOptions&&this.props.codedValues===e.codedValues&&this.props.sqlExpression===e.sqlExpression&&this.props.isSmallSize===e.isSmallSize&&this.props.sortType===e.sortType&&this.props.sortOrder===e.sortOrder||this._setStateForInputEditor()}render(){return(0,Y.jsx)("div",{className:"input-editor w-100 h-100 "+(this.props.isFromBuilder?"is-sql-builder":""),children:this.state.inputEditor})}}const Pt=kt;class Ut extends t.React.PureComponent{constructor(e){var s;super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.getCodedValues=()=>{let e=null;if(this.props.clause.valueOptions.sourceType===t.ClauseSourceType.UserInput){e=Nt(this.props.clause.operator,this.props.clause.valueOptions.sourceType,this.props.dataSource,this.props.clause.jimuFieldName).codedValues}return e},this.onValueOptsChange=e=>{const t=Object.assign({},this.props.clause,{valueOptions:e});this.props&&this.props.onChange(t,this.props.id)},this.hintId=(null===(s=this.props.clause.askForValueOptions)||void 0===s?void 0:s.hint)?`clause-hint-${Math.round(1e9*Math.random())}`:null}render(){this.fieldObj=(0,t.Immutable)(this.props.dataSource.getSchema().fields[this.props.clause.jimuFieldName]);const e=this.i18nMessage(U(this.props.clause.operator)),s=W(this.props.clause,this.fieldObj,e),{displayType:a,askForValueOptions:r}=this.props.clause,{hint:l,sortType:i="VALUE",sortOrder:o=t.SqlQuerySortOrder.Asc}=r||{};return(0,Y.jsxs)("div",{className:(0,t.classNames)("sql-expression-single",this.props.className,{"m-0":a===t.ClauseDisplayType.None}),children:[a===t.ClauseDisplayType.UseAskForValue&&(0,Y.jsxs)(t.React.Fragment,{children:[(0,Y.jsxs)("div",{className:r.display===t.ClauseLabelDisplay.Inline&&""!==r.label?"clause-inline":"clause-block",children:[""!==r.label&&(0,Y.jsx)("div",{className:"sql-expression-label",children:s}),(0,Y.jsx)("div",{className:"sql-expression-input",children:(0,Y.jsx)(Pt,{"aria-label":s,"aria-describedby":this.hintId,sortType:i,sortOrder:o,onChange:this.onValueOptsChange,dataSource:this.props.dataSource,codedValues:this.getCodedValues(),valueOptions:this.props.clause.valueOptions,fieldObj:this.fieldObj,runtime:!0,sqlExpression:B(this.props.expression,this.props.clause,this.props.id,this.props.dataSource)})})]}),l&&(0,Y.jsx)(F.Typography,{variant:"label2",color:"paperHint",className:"w-100 sql-expression-hint",id:this.hintId,children:l})]}),a===t.ClauseDisplayType.UseLabel&&(0,Y.jsx)("div",{className:"w-100 sql-expression-display-label",children:s})]})}}const Lt=(0,n.withStyles)((0,t.injectIntl)(Ut),"SqlExpressionClauseRuntime");class Bt extends t.React.PureComponent{constructor(e){super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onClauseChange=(e,s)=>{const a=P(this.state.partsArray,e,s),r=0===this.state.partsArray.length?null:{type:t.ClauseType.Set,logicalOperator:this.props.clauseSet.logicalOperator,parts:a};this.props.onChange&&this.props.onChange(r,this.props.id),this.setState({partsArray:a})},this.state={partsArray:this.props.clauseSet&&this.props.clauseSet.parts?this.props.clauseSet.parts:[]}}componentDidUpdate(e,t){this.props.clauseSet!==e.clauseSet&&this.setState({partsArray:this.props.clauseSet.parts})}render(){return(0,Y.jsx)("div",{className:this.props.className?this.props.className:"",children:0===this.state.partsArray.length?null:(0,Y.jsx)("div",{className:"sql-expression-set",children:this.state.partsArray.map((e,s)=>{const a=this.props.id+"_clause_"+s;return e.displayLabel!==t.ClauseDisplayType.None&&(0,Y.jsx)(Lt,{id:a,clause:e,isHosted:this.props.isHosted,expression:this.props.expression,dataSource:this.props.dataSource,onChange:this.onClauseChange},s.toString())})})})}}const Rt=(0,n.withTheme)((0,t.injectIntl)(Bt));class _t extends t.React.PureComponent{constructor(e){var s;super(e),this.i18nMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:F.defaultMessages[e]}),this.onChange=(e,s)=>{const a=P(this.props.expression.parts.asMutable({deep:!0}),e,s);let r=(0,t.Immutable)({sql:this.props.expression.sql,displaySQL:this.props.expression.displaySQL,logicalOperator:this.props.expression.logicalOperator,parts:a});const l=t.dataSourceUtils.getArcGISSQL(r,this.props.dataSource);r=r.set("sql",l.sql).set("displaySQL",l.displaySQL),this.props.onChange&&this.props.onChange(r)};const a=this.props.dataSource;a&&(this.isHosted=t.dataSourceUtils.isAGOLHostedService(a.getDataSourceJson().url||(null===(s=a.layer)||void 0===s?void 0:s.url))),this.state={}}render(){return(0,Y.jsx)("div",{className:this.props.className?this.props.className:"",children:(0,Y.jsx)(F.QueryScopeContext.Provider,{value:{scope:this.props.queryScope||t.QueryScope.InRuntimeView,widgetId:this.props.widgetId},children:(0,Y.jsx)("div",{style:this.props.style,className:"sql-expression-builder",children:this.props.expression?(0,Y.jsx)("div",{className:"sql-expression-container",children:0===this.props.expression.parts.length?(0,Y.jsx)("div",{className:"no-data-tip",children:this.i18nMessage("noClauseTip")}):this.props.expression.parts.map((e,s)=>e.type===t.ClauseType.Single?e.displayLabel!==t.ClauseDisplayType.None&&(0,Y.jsx)(Lt,{id:"clause_"+s,expression:this.props.expression,clause:e,isHosted:this.isHosted,dataSource:this.props.dataSource,onChange:this.onChange},s):(0,Y.jsx)(Rt,{id:"clauseset_"+s,expression:this.props.expression,clauseSet:e,isHosted:this.isHosted,dataSource:this.props.dataSource,onChange:this.onChange},s))}):(0,Y.jsx)("div",{className:"no-data-tip",children:this.i18nMessage("noAddedDataSourceCanBeUsed")})})})})}}const qt=(0,n.withTheme)((0,t.injectIntl)(_t));(0,n.registerStyles)("jimu-ui/basic/sql-expression-runtime/",e)})(),o})())}}});