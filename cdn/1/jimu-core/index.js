/*! For license information please see index.js.LICENSE.txt */
System.register(["jimu-core/react","jimu-core/react-dom","jimu-core/react-dom/client","jimu-core/emotion","jimu-core"],function(e,t){var n={},r={},i={},o={},s={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(i,"__esModule",{value:!0}),{setters:[function(e){Object.keys(e).forEach(function(t){n[t]=e[t]})},function(e){Object.keys(e).forEach(function(t){r[t]=e[t]})},function(e){Object.keys(e).forEach(function(t){i[t]=e[t]})},function(e){o.Fragment=e.Fragment,o.css=e.css,o.jsx=e.jsx,o.jsxs=e.jsxs},function(e){s.EConsentMode=e.EConsentMode,s.arcadeContentUtils=e.arcadeContentUtils,s.getAppStore=e.getAppStore,s.utils=e.utils}],execute:function(){e((()=>{var e={124:(e,t,n)=>{var r=n(9325);e.exports=function(){return r.Date.now()}},133:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6 2H3v3h3zM2 1v5h5V1zM0 14.09c1.2.503 2.493.746 3.793.711 1.832 0 3.02-.4 4.207-.8s2.374-.8 4.207-.8A6.62 6.62 0 0 1 16 14.291L13.867 1.686a8.2 8.2 0 0 0-3.161-.674A6.9 6.9 0 0 0 8 1.506v1.062q.174-.06.339-.12a5.9 5.9 0 0 1 2.367-.434c.773.01 1.54.146 2.27.4l1.72 10.162a8.3 8.3 0 0 0-2.489-.376 12.8 12.8 0 0 0-4.526.852c-1.24.484-2.557.737-3.888.748a9.5 9.5 0 0 1-2.669-.363L2.214 7H1.2zM11 5H9v2h2zM8 4v3H5v4h7V4zm-2 6V8h2v2zm3-2h2v2H9z" clip-rule="evenodd"></path></svg>'},144:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t,n=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(e){if(!n)return null;throw e}}},270:(e,t,n)=>{"use strict";const r=n(3908),i=n(8311);e.exports=(e,t,n)=>{let o=null,s=null,a=null;try{a=new i(t,n)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(o&&1!==s.compare(e)||(o=e,s=new r(o,n)))}),o}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},430:e=>{"use strict";e.exports=JSON.parse('{"Dateline Standard Time":-12,"UTC-11":-11,"Hawaiian Standard Time":-10,"Alaskan Standard Time":-9,"Pacific Standard Time":-8,"Pacific Standard Time (Mexico)":-8,"Mountain Standard Time":-7,"Mountain Standard Time (Mexico)":-7,"US Mountain Standard Time":-7,"Canada Central Standard Time":-6,"Central America Standard Time":-6,"Central Standard Time":-6,"Central Standard Time (Mexico)":-6,"Eastern Standard Time":-5,"SA Pacific Standard Time":-5,"US Eastern Standard Time":-5,"Venezuela Standard Time":-3.5,"Atlantic Standard Time":-4,"Central Brazilian Standard Time":-4,"Pacific SA Standard Time":-4,"SA Western Standard Time":-4,"Paraguay Standard Time":-4,"Newfoundland Standard Time":-2.5,"E. South America Standard Time":-3,"Greenland Standard Time":-3,"Montevideo Standard Time":-3,"SA Eastern Standard Time":-3,"Argentina Standard Time":-3,"Mid-Atlantic Standard Time":-2,"UTC-2":-2,"Azores Standard Time":-1,"Cabo Verde Standard Time":-1,"GMT Standard Time":0,"Greenwich Standard Time":0,"Morocco Standard Time":0,"UTC":0,"Central Europe Standard Time":1,"Central European Standard Time":1,"Romance Standard Time":1,"W. Central Africa Standard Time":1,"W. Europe Standard Time":1,"Namibia Standard Time":1,"E. Europe Standard Time":2,"Egypt Standard Time":2,"FLE Standard Time":2,"GTB Standard Time":2,"Israel Standard Time":2,"Jordan Standard Time":2,"Middle East Standard Time":2,"South Africa Standard Time":2,"Syria Standard Time":2,"Turkey Standard Time":2,"Arab Standard Time":3,"Arabic Standard Time":3,"E. Africa Standard Time":3,"Kaliningrad Standard Time":3,"Iran Standard Time":3.5,"Russian Standard Time":4,"Arabian Standard Time":4,"Azerbaijan Standard Time":4,"Caucasus Standard Time":4,"Georgian Standard Time":4,"Mauritius Standard Time":4,"Afghanistan Standard Time":4.5,"West Asia Standard Time":5,"Pakistan Standard Time":5,"India Standard Time":5.5,"Sri Lanka Standard Time":5.5,"Nepal Standard Time":5,"Ekaterinburg Standard Time":6,"Central Asia Standard Time":6,"Bangladesh Standard Time":6,"Myanmar Standard Time":6.5,"N. Central Asia Standard Time":7,"SE Asia Standard Time":7,"North Asia Standard Time":8,"China Standard Time":8,"Singapore Standard Time":8,"Taipei Standard Time":8,"W. Australia Standard Time":8,"Ulaanbaatar Standard Time":8,"North Asia East Standard Time":9,"Korea Standard Time":9,"Tokyo Standard Time":9,"AUS Central Standard Time":9.5,"Cen. Australia Standard Time":9.5,"Yakutsk Standard Time":10,"AUS Eastern Standard Time":10,"E. Australia Standard Time":10,"Tasmania Standard Time":10,"West Pacific Standard Time":10,"Vladivostok Standard Time":11,"Central Pacific Standard Time":11,"Magadan Standard Time":12,"Fiji Standard Time":12,"New Zealand Standard Time":12,"UTC+12":12,"Tonga Standard Time":13,"Samoa Standard Time":-11}')},560:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},597:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 12"><path fill="#000" fill-rule="evenodd" d="M0 0v12l4-4h6zm3.586 7L1 9.586V2.08L7.15 7z" clip-rule="evenodd"></path></svg>'},659:(e,t,n)=>{var r=n(1873),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},819:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.915 1A1.5 1.5 0 1 0 1 2.915v10.17A1.5 1.5 0 1 0 2.915 15h10.17a1.5 1.5 0 1 0 1.276-1.994l-2.272-3.975c.255-.269.411-.632.411-1.031 0-.4-.156-.762-.41-1.031l2.27-3.975q.07.006.14.006a1.5 1.5 0 1 0-1.415-2zm0 13h10.17q.076-.211.207-.389l-2.204-4.114L11 9.5a1.5 1.5 0 1 1 .088-2.997l2.204-4.114A1.5 1.5 0 0 1 13.085 2H2.915c-.151.426-.489.764-.915.915v10.17c.426.151.764.489.915.915" clip-rule="evenodd"></path></svg>'},880:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 2h5v12H2zM1 14V1h7v13h2.5V4H9V3h2.5v11H14V7h-1.5V6H15v8h1v1H0v-1zM3 3h1v1H3zm1 3H3v1h1zM3 9h1v1H3zm3-6H5v1h1zM5 6h1v1H5zm1 3H5v1h1z" clip-rule="evenodd"></path></svg>'},909:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t,n)=>{const i=new r(e,n),o=new r(t,n);return i.compare(o)||i.compareBuild(o)}},914:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m8 0 8 6-8 6-8-6zM1.887 6 8 10.82 14.113 6 8 1.18zM0 9.81.563 9 8 14.775 15.437 9l.563.81L8 16z" clip-rule="evenodd"></path></svg>'},986:(e,t,n)=>{"use strict";n.d(t,{isAllowedToTrack:()=>s});var r=n(9244);function i(){return`${r.utils.getLocalStorageAppKey()}-cookie-confirmations`}function o(){var e,t;const n=i(),o=r.utils.readLocalStorage(n);let s=null;if(s=window.jimuConfig.isInBuilder?(0,r.getAppStore)().getState().appStateInBuilder.appConfig:(0,r.getAppStore)().getState().appConfig,o){const n=JSON.parse(o).confirmTime;return!((null===(e=null==s?void 0:s.cookieBanner)||void 0===e?void 0:e.renewTime)&&n<(null===(t=null==s?void 0:s.cookieBanner)||void 0===t?void 0:t.renewTime))}return!1}function s(){var e,t,n;let s=null;if(s=window.jimuConfig.isInBuilder?null===(e=(0,r.getAppStore)().getState().appStateInBuilder)||void 0===e?void 0:e.appConfig:(0,r.getAppStore)().getState().appConfig,(null===(t=null==s?void 0:s.cookieBanner)||void 0===t?void 0:t.enable)&&(null===(n=null==s?void 0:s.cookieBanner)||void 0===n?void 0:n.consentMode)===r.EConsentMode.Required){if(!o())return!1;if(!(o()?JSON.parse(r.utils.readLocalStorage(i())):null).performance)return!1}return!0}},1100:e=>{e.exports={indexOf:function(e,t){var n,r;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var r,i;if(Array.prototype.forEach)return e.forEach(t,n);for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}},1123:e=>{"use strict";const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},1219:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#151515" fill-rule="evenodd" d="M15 3.6 11.4 0H2v16h13zM14 15H3V1h7v4h4zM11 4h3v-.31L11.31 1H11zM7 4a1 1 0 1 1-2 0 1 1 0 0 1 2 0M5 7.5h7v-1H5z" clip-rule="evenodd"></path><path fill="#000" fill-rule="evenodd" d="M9 10H6v2h3zM5 9v4h5V9z" clip-rule="evenodd"></path></svg>'},1261:(e,t,n)=>{"use strict";const r=n(3908),i=n(8311),o=n(5580);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach(e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!o(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),!s||n&&!o(n,s)||(n=s)}return n&&e.test(n)?n:null}},1330:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2"></path><path fill="#000" fill-rule="evenodd" d="m11.002 7.002-3 3-3-3v-4a2.893 2.893 0 0 1 3-3 2.893 2.893 0 0 1 3 3zm-3-6h-.038a1.893 1.893 0 0 0-1.963 1.962l.001.018v3.606l2 2 2-2V2.964A1.894 1.894 0 0 0 8.04 1z" clip-rule="evenodd"></path><path fill="#000" d="M4.072 1.908a10.4 10.4 0 0 1-1.939-.433L0 13.077c1.2.504 2.493.746 3.793.711A10.7 10.7 0 0 0 7 13.31v1.678H2v1h11v-1H8v-2a11.9 11.9 0 0 1 4.207-.8A6.62 6.62 0 0 1 16 13.277L13.867 1.674a8.2 8.2 0 0 0-2.236-.61 3.5 3.5 0 0 1 .336 1.066q.514.097 1.009.27l1.72 9.163a8.3 8.3 0 0 0-2.489-.376 12.8 12.8 0 0 0-4.526.852l-.604.204-.363.108a9.7 9.7 0 0 1-2.921.436 9.5 9.5 0 0 1-2.668-.363l1.81-9.697q.53.115 1.068.18v-.173a3.4 3.4 0 0 1 .069-.826"></path></svg>'},1539:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4 2H2v2h2zM2 1H1v4h4V1H2m-.619 5L0 14.29s3.2 1.6 8 0 8 0 8 0L13.867 1.487a9.76 9.76 0 0 0-5.867 0 9.7 9.7 0 0 1-2 .408v1.048a8.3 8.3 0 0 0 2.372-.527 6.3 6.3 0 0 1 2.334-.402c.768.006 1.533.097 2.28.272l1.76 10.56c-.834-.18-1.685-.27-2.538-.268-1.54.01-3.067.267-4.524.762-1.253.428-2.567.65-3.891.66a9.5 9.5 0 0 1-2.67-.363L2.395 6zM10 5H8v2h2zM7 4v3H4v4h7V4zm-2 6V8h2v2zm3-2h2v2H8z" clip-rule="evenodd"></path></svg>'},1729:(e,t,n)=>{"use strict";const r=n(144);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},1763:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t)=>r(e,t,!0)},1800:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},1832:(e,t,n)=>{"use strict";const r=n(144);e.exports=(e,t)=>{const n=r(e,null,!0),i=r(t,null,!0),o=n.compare(i);if(0===o)return null;const s=o>0,a=s?n:i,l=s?i:n,u=!!a.prerelease.length;if(!!l.prerelease.length&&!u){if(!l.patch&&!l.minor)return"major";if(0===l.compareMain(a))return l.minor&&!l.patch?"minor":"patch"}const c=u?"pre":"";return n.major!==i.major?c+"major":n.minor!==i.minor?c+"minor":n.patch!==i.patch?c+"patch":"prerelease"}},1873:(e,t,n)=>{var r=n(9325).Symbol;e.exports=r},2048:(e,t,n)=>{var r=n(6018).FilterCSS,i=n(6018).getDefaultWhiteList,o=n(9349);function s(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var a=new r;function l(e){return e.replace(u,"&lt;").replace(c,"&gt;")}var u=/</g,c=/>/g,d=/"/g,p=/&quot;/g,f=/&#([a-zA-Z0-9]*);?/gim,h=/&colon;?/gim,g=/&newline;?/gim,m=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,v=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,y=/u\s*r\s*l\s*\(.*/gi;function S(e){return e.replace(d,"&quot;")}function b(e){return e.replace(p,'"')}function w(e){return e.replace(f,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function I(e){return e.replace(h,":").replace(g," ")}function E(e){for(var t="",n=0,r=e.length;n<r;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return o.trim(t)}function O(e){return e=E(e=I(e=w(e=b(e))))}function C(e){return e=l(e=S(e))}t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},t.getDefaultWhiteList=s,t.onTag=function(e,t,n){},t.onIgnoreTag=function(e,t,n){},t.onTagAttr=function(e,t,n){},t.onIgnoreTagAttr=function(e,t,n){},t.safeAttrValue=function(e,t,n,r){if(n=O(n),"href"===t||"src"===t){if("#"===(n=o.trim(n)))return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"tel:"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&"ftp://"!==n.substr(0,6)&&"./"!==n.substr(0,2)&&"../"!==n.substr(0,3)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(m.lastIndex=0,m.test(n))return""}else if("style"===t){if(v.lastIndex=0,v.test(n))return"";if(y.lastIndex=0,y.test(n)&&(m.lastIndex=0,m.test(n)))return"";!1!==r&&(n=(r=r||a).process(n))}return n=C(n)},t.escapeHtml=l,t.escapeQuote=S,t.unescapeQuote=b,t.escapeHtmlEntities=w,t.escapeDangerHtml5Entities=I,t.clearNonPrintableCharacter=E,t.friendlyAttrValue=O,t.escapeAttrValue=C,t.onIgnoreTagStripAll=function(){return""},t.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var n=!Array.isArray(e),r=[],i=!1;return{onIgnoreTag:function(s,a,l){if(function(t){return!!n||-1!==o.indexOf(e,t)}(s)){if(l.isClosing){var u="[/removed]",c=l.position+10;return r.push([!1!==i?i:l.position,c]),i=!1,u}return i||(i=l.position),"[removed]"}return t(s,a,l)},remove:function(e){var t="",n=0;return o.forEach(r,function(r){t+=e.slice(n,r[0]),n=r[1]}),t+=e.slice(n)}}},t.stripCommentTag=function(e){for(var t="",n=0;n<e.length;){var r=e.indexOf("\x3c!--",n);if(-1===r){t+=e.slice(n);break}t+=e.slice(n,r);var i=e.indexOf("--\x3e",r);if(-1===i)break;n=i+3}return t},t.stripBlankChar=function(e){var t=e.split("");return(t=t.filter(function(e){var t=e.charCodeAt(0);return 127!==t&&(!(t<=31)||(10===t||13===t))})).join("")},t.cssFilter=a,t.getDefaultCSSWhiteList=i},2111:(e,t,n)=>{"use strict";const r=n(4641),i=n(3999),o=n(5580),s=n(4089),a=n(7059),l=n(5200);e.exports=(e,t,n,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,u);case"!=":return i(e,n,u);case">":return o(e,n,u);case">=":return s(e,n,u);case"<":return a(e,n,u);case"<=":return l(e,n,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},2443:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M14 2v12H2V2zm-1 1H3v10h10zm-5 7.5L6 9l-2 1.5L6 12zm2-3.833 2 1.5-2 1.5-2-1.5zM8 5.5 6 4 4 5.5 6 7z" clip-rule="evenodd"></path></svg>'},2525:(e,t,n)=>{"use strict";const r=n(7638),i=n(560);e.exports=(e,t,n)=>{const o=[];let s=null,a=null;const l=e.sort((e,t)=>i(e,t,n));for(const e of l){r(e,t,n)?(a=e,s||(s=e)):(a&&o.push([s,a]),a=null,s=null)}s&&o.push([s,null]);const u=[];for(const[e,t]of o)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const c=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return c.length<d.length?c:t}},2528:e=>{"use strict";e.exports=JSON.parse('{"exbVersion":"1.19.0","exbBuildNum":"1201","exbBuildCommit":"c3471543b9e1900f104077869f3cd1304b1bb56b","exbBuildBranch":"origin/release/dev1.19","exbExtensionsBuildCommit":"1ec6bb2fc5fdc18010f66fcbd75da41f7ed84054","exbExtensionsBuildBranch":"origin/release/dev1.19","exbBuildDate":"20251107.091849.CST","productVersion":"ArcGIS Experience Builder"}')},2529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.027 0A8 8 0 1 1 0 8a8 8 0 0 1 8.027-8m-2.07 1.303A7 7 0 0 0 2.256 4h1.6a8.3 8.3 0 0 1 2.103-2.697M3.453 5H1.674a7 7 0 0 0-.656 2.5H3.01q.06-1.336.441-2.5m.56 2.5a8.1 8.1 0 0 1 .5-2.5H7.5v2.5zm-1.001 1H1.018c.062.89.291 1.733.656 2.5h1.778a9.3 9.3 0 0 1-.441-2.5M4.512 11a8.1 8.1 0 0 1-.5-2.5H7.5V11zm-.657 1h-1.6a7 7 0 0 0 3.702 2.697A8.3 8.3 0 0 1 3.855 12M7.5 14.61V12H4.985q.869 1.516 2.515 2.61M7.5 4V1.39Q5.854 2.484 4.985 4zm2.543 10.697A7 7 0 0 0 13.745 12h-1.6a8.3 8.3 0 0 1-2.102 2.697M12.548 11h1.778c.365-.767.594-1.61.656-2.5H12.99a9.3 9.3 0 0 1-.441 2.5m-.56-2.5a8.1 8.1 0 0 1-.5 2.5H8.5V8.5zm1.001-1h1.993a7 7 0 0 0-.656-2.5h-1.778q.381 1.164.441 2.5M11.488 5q.434 1.146.5 2.5H8.5V5zm.657-1h1.6a7 7 0 0 0-3.703-2.697Q11.408 2.473 12.145 4M8.5 1.39Q10.146 2.484 11.015 4H8.5zM8.5 12h2.515q-.869 1.516-2.515 2.61z" clip-rule="evenodd"></path></svg>'},2552:(e,t,n)=>{var r=n(1873),i=n(659),o=n(9350),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},2581:e=>{"use strict";e.exports=r},2618:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#040303" fill-rule="evenodd" d="M7 13v2H2v1h11v-1H8v-2h8L14 1H2L0 13zM2.847 2 1.18 12h3.697a1.58 1.58 0 0 1 .107-1.323A1.37 1.37 0 0 1 4 9.387c0-.165.03-.303.07-.424.032-.094.07-.178.105-.257a1.1 1.1 0 0 0 .115-.34c.029-.282-.084-.321-.084-.575a1.62 1.62 0 0 1 1.591-1.643 1.44 1.44 0 0 1 1.086.47A1.45 1.45 0 0 1 8.266 5.53a1.5 1.5 0 0 1 .453.073q.114.037.221.093a2 2 0 0 1 .555-.606l.094-.064a3 3 0 0 0-.066-.414 1.32 1.32 0 0 1 .32-1.09l.068-.078a1.7 1.7 0 0 1 .468-.353 1.4 1.4 0 0 1 .074-.442c.086-.246.231-.466.422-.643L10.872 2zm3.46 10h3.479l.062-.035c.223-.125.447-.251.447-.541 0-.174-.184-.24-.184-.41 0-.213.127-.341.253-.468.064-.064.127-.127.174-.201a.5.5 0 0 0 .079-.265v-.502a.2.2 0 0 1 .035-.115c.075-.116.26-.178.41-.178a.7.7 0 0 1 .3.088c.095.044.19.089.299.089.242 0 .372-.17.502-.339s.26-.338.501-.338c.11 0 .185.052.245.13.056.073.099.172.142.273.06.141.123.287.23.38a1.48 1.48 0 0 0 .906.432h.3l-1.334-8h-1.175a.5.5 0 0 1 .018.133.43.43 0 0 1-.057.219 1 1 0 0 1-.065.091 1 1 0 0 1-.082.086l-.104.092c-.07.06-.14.12-.195.188a.5.5 0 0 0-.092.16l-.008.028-.008.038a.4.4 0 0 0-.006.076q0 .045.008.097l.017.093.005.026c.016.086.033.176.035.26a.5.5 0 0 1-.011.129c-.035.141-.154.24-.466.218a.3.3 0 0 0-.16.052c-.16.099-.328.31-.304.435l.011.054c.082.397.22 1.069-.371 1.386-.22.12-.34.333-.454.535-.145.257-.28.495-.599.495-.174 0-.293-.09-.413-.18-.119-.09-.238-.18-.411-.18a.45.45 0 0 0-.184.052.47.47 0 0 0-.253.436c0 .367-.308.977-.798.977a.64.64 0 0 1-.617-.308l-.007-.011a1.7 1.7 0 0 0-.252-.375.48.48 0 0 0-.359-.154.617.617 0 0 0-.59.643q.002.11.022.202l.029.12c.026.098.051.196.051.32 0 .194-.077.336-.154.477-.077.142-.154.283-.154.476a.405.405 0 0 0 .437.36q.13-.002.223-.028.085-.024.158-.055a.8.8 0 0 1 .416-.071c.108.01.185.077.237.162a.7.7 0 0 1 .094.289l.003.063c0 .274-.196.47-.392.665-.141.141-.282.283-.35.454-.06.153-.062.33.049.553.06.118.234.173.432.222m8.513 0h-3.645a1.5 1.5 0 0 0 .12-.576q0-.183-.053-.358c.152-.176.263-.383.326-.607l.093.003c.3.002.593-.09.836-.266q.06.066.126.124c.42.411.977.654 1.564.68h.43v-.215z" clip-rule="evenodd"></path></svg>'},2773:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M16 1.5a1.5 1.5 0 0 1-2.147 1.354l-11 11a1.5 1.5 0 1 1-.707-.707l11-11A1.5 1.5 0 1 1 16 1.5" clip-rule="evenodd"></path></svg>'},2799:(e,t)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,S=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case d:case o:case a:case s:case f:return e;default:switch(e=e&&e.$$typeof){case u:case p:case m:case g:case l:return e;default:return t}}case i:return t}}}function I(e){return w(e)===d}t.AsyncMode=c,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=p,t.Fragment=o,t.Lazy=m,t.Memo=g,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return I(e)||w(e)===c},t.isConcurrentMode=I,t.isContextConsumer=function(e){return w(e)===u},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===p},t.isFragment=function(e){return w(e)===o},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===g},t.isPortal=function(e){return w(e)===i},t.isProfiler=function(e){return w(e)===a},t.isStrictMode=function(e){return w(e)===s},t.isSuspense=function(e){return w(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===a||e===s||e===f||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===u||e.$$typeof===p||e.$$typeof===y||e.$$typeof===S||e.$$typeof===b||e.$$typeof===v)},t.typeOf=w},2938:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t)=>new r(e,t).major},2943:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.653 13.854a.485.485 0 0 1 0-.708L10.24 8 4.653 2.854a.485.485 0 0 1 0-.708.54.54 0 0 1 .738 0l5.956 5.5a.485.485 0 0 1 0 .708l-5.956 5.5a.54.54 0 0 1-.738 0" clip-rule="evenodd"></path></svg>'},3001:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m4 2 8 6-8 6z"></path></svg>'},3007:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t,n,i,o)=>{"string"==typeof n&&(o=i,i=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,i,o).version}catch(e){return null}}},3195:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M0 3.307V15l5.722-2.117 4.528 1.937L16 12.693V1l-5.722 2.117L5.75 1.18zm1 10.286V3.974l4-1.48v9.619zm5-1.65 4 1.711V4.057L6 2.346zm5 1.563V3.887l4-1.48v9.619z" clip-rule="evenodd"></path></svg>'},3473:(e,t,n)=>{var r=n(7043),i=n(5323);n(1100);function o(e){return null==e}function s(e){(e=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{})).whiteList=e.whiteList||r.whiteList,e.onAttr=e.onAttr||r.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||r.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||r.safeAttrValue,this.options=e}s.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,n=t.whiteList,r=t.onAttr,s=t.onIgnoreAttr,a=t.safeAttrValue;return i(e,function(e,t,i,l,u){var c=n[i],d=!1;if(!0===c?d=c:"function"==typeof c?d=c(l):c instanceof RegExp&&(d=c.test(l)),!0!==d&&(d=!1),l=a(i,l)){var p,f={position:t,sourcePosition:e,source:u,isWhite:d};return d?o(p=r(i,l,f))?i+":"+l:p:o(p=s(i,l,f))?void 0:p}})},e.exports=s},3509:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2H3v12h5zM2 1v13H0v1h16v-1h-3V8.69l-4-2V1zm7 6.809V14h3V9.309zM5 3H4v1h1zM4 6h1v1H4zm1 3H4v1h1zm1-6h1v1H6zm1 3H6v1h1zM6 9h1v1H6z" clip-rule="evenodd"></path></svg>'},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3874:(e,t,n)=>{"use strict";const r=n(8311);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},3904:(e,t,n)=>{"use strict";const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):(!(t=o(t)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}e.exports=i;const o=n(8587),{safeRe:s,t:a}=n(9718),l=n(2111),u=n(7272),c=n(3908),d=n(8311)},3908:(e,t,n)=>{"use strict";const r=n(7272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(6874),{safeRe:s,t:a}=n(9718),l=n(8587),{compareIdentifiers:u}=n(1123);class c{constructor(e,t){if(t=l(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?s[a.PRERELEASELOOSE]:s[a.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=c},3927:(e,t,n)=>{"use strict";const r=n(909);e.exports=(e,t)=>e.sort((e,n)=>r(e,n,t))},3999:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>0!==r(e,t,n)},4005:(e,t,n)=>{var r=n(2048),i=n(5930),o=n(8327);function s(e,t){return new o(t).process(e)}(t=e.exports=s).filterXSS=s,t.FilterXSS=o,function(){for(var e in r)t[e]=r[e];for(var n in i)t[n]=i[n]}(),"undefined"!=typeof window&&(window.filterXSS=e.exports),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)},4041:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M5.53 6.937v4.356l5.386-1.905-.604-.45.604-.805 2.368 1.479-8.753 3.095V6.888a1.5 1.5 0 1 1 2.055-1.183l.827.482-.731.731-.556-.324c-.167.157-.37.276-.595.343M5.6 5.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0" clip-rule="evenodd"></path><path fill="#000" d="m8.307 7.414-.707.707.707.707.707-.707.707.707.707-.707-.707-.707.707-.707L9.721 6l-.707.707L8.307 6l-.707.707z"></path><path fill="#000" fill-rule="evenodd" d="M8 14.29c4.8-1.6 8 0 8 0L13.867 1.487a9.76 9.76 0 0 0-5.867 0 9.74 9.74 0 0 1-5.867 0L0 14.29s3.2 1.6 8 0m4.208-1.712c-1.54.01-3.067.267-4.524.762-1.253.428-2.567.65-3.891.66a9.5 9.5 0 0 1-2.67-.363L2.941 2.722a12 12 0 0 0 2.353.241 8.3 8.3 0 0 0 3.078-.547 6.3 6.3 0 0 1 2.334-.402c.768.006 1.533.097 2.28.272l1.76 10.56c-.834-.18-1.685-.27-2.538-.268" clip-rule="evenodd"></path></svg>'},4089:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>r(e,t,n)>=0},4128:(e,t,n)=>{var r=n(1800),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},4146:(e,t,n)=>{"use strict";var r=n(4363),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(h){var i=f(n);i&&i!==h&&e(t,i,r)}var s=c(n);d&&(s=s.concat(d(n)));for(var a=l(t),g=l(n),m=0;m<s.length;++m){var v=s[m];if(!(o[v]||r&&r[v]||g&&g[v]||a&&a[v])){var y=p(n,v);try{u(t,v,y)}catch(e){}}}}return t}},4203:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.5 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m-2 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3M15 10.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0" clip-rule="evenodd"></path></svg>'},4213:function(e,t,n){var r,i,o;i=[],void 0===(o="function"==typeof(r=function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){l(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,t,n){var a=s.URL||s.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):i(l.href)?r(e,t,n):o(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(l.href)},4e4),setTimeout(function(){o(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,s){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,s),n);else if(i(e))r(e,n,s);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){o(a)})}}:function(e,t,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return r(e,t,n);var o="application/octet-stream"===e.type,l=/constructor/i.test(s.HTMLElement)||s.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&l||a)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},c.readAsDataURL(e)}else{var d=s.URL||s.webkitURL,p=d.createObjectURL(e);i?i.location=p:location.href=p,i=null,setTimeout(function(){d.revokeObjectURL(p)},4e4)}});s.saveAs=l.saveAs=l,e.exports=l})?r.apply(t,i):r)||(e.exports=o)},4277:(e,t,n)=>{"use strict";const r=n(909);e.exports=(e,t)=>e.sort((e,n)=>r(n,e,t))},4308:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M10.95 1 6 3.95l4.95 2.95 4.95-2.95zm0 1.164L7.953 3.95l2.997 1.785 2.996-1.785z" clip-rule="evenodd"></path><path fill="#000" d="M0 4.5h5v-1H0zM0 12.5h5v-1H0z"></path><path fill="#000" fill-rule="evenodd" d="M6 11.95 10.95 9l4.95 2.95-4.95 2.95zm1.953 0 2.997-1.786 2.996 1.786-2.996 1.785z" clip-rule="evenodd"></path></svg>'},4363:(e,t,n)=>{"use strict";e.exports=n(2799)},4394:(e,t,n)=>{var r=n(2552),i=n(346);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},4493:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t)=>new r(e,t).patch},4558:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M0 3.5 6 0l6 3.5L6 7zm1.985 0L6 1.158 10.015 3.5 6 5.842zM8 8.5 12 6l4 2.5-4 2.5zm1.887 0L12 7.18l2.113 1.32L12 9.82z" clip-rule="evenodd"></path><path fill="#000" d="M3 6.5 4 7v2h3v1H4v3.5h3v1H3zM8 13l2.4-1.5.943.59-1.456.91L12 14.32 14.113 13l-1.456-.91.943-.59L16 13l-4 2.5z"></path></svg>'},4641:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>0===r(e,t,n)},4644:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M4 3H3v1h1z"></path><path fill="#000" fill-rule="evenodd" d="M1 7V1h6v6zm1-5h4v4H2z" clip-rule="evenodd"></path><path fill="#000" d="M4 10H3v1h1zM4 12H3v1h1zM10 8h1v1h-1zM10 12h1v1h-1z"></path><path fill="#000" fill-rule="evenodd" d="M1 8v6H0v1h16v-1h-2V6H8v8H7V8zm5 6V9H2v5zm7-7v7H9V7z" clip-rule="evenodd"></path><path fill="#000" d="M10 10h1v1h-1z"></path></svg>'},4682:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14M8 4a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0l.35-3.507A.905.905 0 0 0 8 4m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},4747:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.547 1.788A.5.5 0 0 1 3 1.5h9.167c.358 0 .699.147.947.403.249.255.386.599.386.954v1.714a.5.5 0 0 1-1 0V2.857a.37.37 0 0 0-.103-.257.32.32 0 0 0-.23-.1h-8.1l4.317 5.18a.5.5 0 0 1 0 .64L4.068 13.5h8.099a.32.32 0 0 0 .23-.1.37.37 0 0 0 .103-.257v-1.714a.5.5 0 1 1 1 0v1.714c0 .355-.137.699-.386.954-.248.257-.59.403-.947.403H3a.5.5 0 0 1-.384-.82L7.349 8 2.616 2.32a.5.5 0 0 1-.069-.532" clip-rule="evenodd"></path></svg>'},4840:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},4848:(e,t,n)=>{"use strict";e.exports=n(9698)},4882:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m13 11-1-6H4l-1 6zM4.847 6l-.25 1.5h1.7l.15-1.5zm-.667 4 .25-1.5h1.768l-.15 1.5zm2.872 0 .15-1.5h1.595l.15 1.5zm2.9 0-.15-1.5h1.768l.25 1.5zm-.25-2.5h1.7l-.25-1.5h-1.6zm-2.4 0h1.396L8.548 6H7.451z" clip-rule="evenodd"></path><path fill="#000" fill-rule="evenodd" d="M8 14.29c4.8-1.6 8 0 8 0L13.867 1.487a9.76 9.76 0 0 0-5.867 0 9.74 9.74 0 0 1-5.867 0L0 14.29s3.2 1.6 8 0m4.208-1.712c-1.54.01-3.067.267-4.524.762-1.253.428-2.567.65-3.891.66a9.5 9.5 0 0 1-2.67-.363L2.941 2.722a12 12 0 0 0 2.353.241 8.3 8.3 0 0 0 3.078-.547 6.3 6.3 0 0 1 2.334-.402c.768.006 1.533.097 2.28.272l1.76 10.56c-.834-.18-1.685-.27-2.538-.268" clip-rule="evenodd"></path></svg>'},4931:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m9.513 3.47 4.324 8.03H2.224l3.158-6.948L7.43 7.113zM7.79 8.5h3.296L9.487 5.53zm3.834 1H4.231l-.454 1h8.386zm-4.364-1H4.686l.932-2.052z" clip-rule="evenodd"></path><path fill="#000" fill-rule="evenodd" d="M16 14.29s-3.2-1.6-8 0-8 0-8 0L2.133 1.487a9.74 9.74 0 0 0 5.867 0 9.76 9.76 0 0 1 5.867 0zm-8.316-.95a14.3 14.3 0 0 1 4.524-.762c.853-.002 1.704.088 2.538.267l-1.76-10.559a10.3 10.3 0 0 0-2.28-.272 6.3 6.3 0 0 0-2.334.402 8.3 8.3 0 0 1-3.078.547 12 12 0 0 1-2.353-.24L1.123 13.636c.868.247 1.767.37 2.67.363a12.3 12.3 0 0 0 3.891-.66" clip-rule="evenodd"></path></svg>'},5032:(e,t,n)=>{"use strict";const r=n(8311),i=n(3904),{ANY:o}=i,s=n(7638),a=n(560),l=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],c=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?l:u}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=u}const r=new Set;let i,c,f,h,g,m,v;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,n):"<"===t.operator||"<="===t.operator?c=p(c,t,n):r.add(t.semver);if(r.size>1)return null;if(i&&c){if(f=a(i.semver,c.semver,n),f>0)return null;if(0===f&&(">="!==i.operator||"<="!==c.operator))return null}for(const e of r){if(i&&!s(e,String(i),n))return null;if(c&&!s(e,String(c),n))return null;for(const r of t)if(!s(e,String(r),n))return!1;return!0}let y=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver,S=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;y&&1===y.prerelease.length&&"<"===c.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(v=v||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,i)if(S&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===S.major&&e.semver.minor===S.minor&&e.semver.patch===S.patch&&(S=!1),">"===e.operator||">="===e.operator){if(h=d(i,e,n),h===e&&h!==i)return!1}else if(">="===i.operator&&!s(i.semver,String(e),n))return!1;if(c)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(g=p(c,e,n),g===e&&g!==c)return!1}else if("<="===c.operator&&!s(c.semver,String(e),n))return!1;if(!e.operator&&(c||i)&&0!==f)return!1}return!(i&&m&&!c&&0!==f)&&(!(c&&v&&!i&&0!==f)&&(!S&&!y))},d=(e,t,n)=>{if(!e)return t;const r=a(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,n)=>{if(!e)return t;const r=a(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=c(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},5033:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#151515" fill-rule="evenodd" d="M0 14.09 1.2 7h1.014l-1.09 6.437a9.5 9.5 0 0 0 2.669.363 11 11 0 0 0 3.888-.748 12.8 12.8 0 0 1 4.526-.852 8.3 8.3 0 0 1 2.489.376l-1.72-10.163a7.2 7.2 0 0 0-2.27-.399 5.9 5.9 0 0 0-2.367.434q-.165.06-.339.12V1.506a6.9 6.9 0 0 1 2.706-.493 8.2 8.2 0 0 1 3.161.674L16 14.29a6.62 6.62 0 0 0-3.793-1.089c-3.665 0-4.749 1.6-8.414 1.6A9.2 9.2 0 0 1 0 14.089zM4 11V7h4V4h4v7zm4-2.5a.954.954 0 0 1-.995 1.062h-.002L7 10h1zm3 1.5v-.487A2.96 2.96 0 0 1 9.5 10zM9 7h2V5H9zm0 1v1h.5a2.7 2.7 0 0 0 1.5-.721V8zm-4 2h1v-.5c0-.574.312-.889.93-.936l.068-.005L7 8.5c.002-.173.043-.344.119-.5H5zM2 6V1h5v5zm1.564-2.19c.075-.288.228-.55.442-.756a.9.9 0 0 1 .74-.179c.077-.32.226-.62.436-.875H3v2.34a.56.56 0 0 0 .336-.09 1 1 0 0 0 .228-.44M6 2.56a1.26 1.26 0 0 0-.297.609 1 1 0 0 1-.279.544.87.87 0 0 1-.756.161l-.05-.009q-.065.135-.11.276c-.09.328-.268.625-.516.859H6z" clip-rule="evenodd"></path></svg>'},5160:(e,t,n)=>{"use strict";var r=n(8972);var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useSyncExternalStore,s=r.useRef,a=r.useEffect,l=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,c){var d=s(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=l(function(){function e(e){if(!a){if(a=!0,o=e,e=r(e),void 0!==c&&p.hasValue){var t=p.value;if(c(t,e))return s=t}return s=e}if(t=s,i(o,e))return t;var n=r(e);return void 0!==c&&c(t,n)?(o=e,t):(o=e,s=n)}var o,s,a=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,n,r,c]);var f=o(e,d[0],d[1]);return a(function(){p.hasValue=!0,p.value=f},[f]),u(f),f}},5200:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>r(e,t,n)<=0},5323:(e,t,n)=>{var r=n(1100);e.exports=function(e,t){";"!==(e=r.trimRight(e))[e.length-1]&&(e+=";");var n=e.length,i=!1,o=0,s=0,a="";function l(){if(!i){var n=r.trim(e.slice(o,s)),l=n.indexOf(":");if(-1!==l){var u=r.trim(n.slice(0,l)),c=r.trim(n.slice(l+1));if(u){var d=t(o,a.length,u,c,n);d&&(a+=d+"; ")}}}o=s+1}for(;s<n;s++){var u=e[s];if("/"===u&&"*"===e[s+1]){var c=e.indexOf("*/",s+2);if(-1===c)break;o=(s=c+1)+1,i=!1}else"("===u?i=!0:")"===u?i=!1:";"===u?i||l():"\n"===u&&l()}return r.trim(a)}},5342:(e,t,n)=>{"use strict";const r=n(7075);e.exports=(e,t,n)=>r(e,t,"<",n)},5571:(e,t,n)=>{"use strict";const r=n(7075);e.exports=(e,t,n)=>r(e,t,">",n)},5580:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>r(e,t,n)>0},5737:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m14 4-6 8-6-8z"></path></svg>'},5930:(e,t,n)=>{var r=n(9349);function i(e){var t,n=r.spaceIndex(e);return t=-1===n?e.slice(1,-1):e.slice(1,n+1),"/"===(t=r.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function o(e){return"</"===e.slice(0,2)}var s=/[^a-zA-Z0-9\\_:.-]/gim;function a(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}}function l(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"'"===n||'"'===n?t:-1}}function u(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}}function c(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}t.parseTag=function(e,t,n){"use strict";var r="",s=0,a=!1,l=!1,u=0,c=e.length,d="",p="";e:for(u=0;u<c;u++){var f=e.charAt(u);if(!1===a){if("<"===f){a=u;continue}}else if(!1===l){if("<"===f){r+=n(e.slice(s,u)),a=u,s=u;continue}if(">"===f){r+=n(e.slice(s,a)),d=i(p=e.slice(a,u+1)),r+=t(a,r.length,d,p,o(p)),s=u+1,a=!1;continue}if('"'===f||"'"===f)for(var h=1,g=e.charAt(u-h);""===g.trim()||"="===g;){if("="===g){l=f;continue e}g=e.charAt(u-++h)}}else if(f===l){l=!1;continue}}return s<e.length&&(r+=n(e.substr(s))),r},t.parseAttr=function(e,t){"use strict";var n=0,i=0,o=[],d=!1,p=e.length;function f(e,n){if(!((e=(e=r.trim(e)).replace(s,"").toLowerCase()).length<1)){var i=t(e,n||"");i&&o.push(i)}}for(var h=0;h<p;h++){var g,m=e.charAt(h);if(!1!==d||"="!==m)if(!1===d||h!==i)if(/\s|\n|\t/.test(m)){if(e=e.replace(/\s|\n|\t/g," "),!1===d){if(-1===(g=a(e,h))){f(r.trim(e.slice(n,h))),d=!1,n=h+1;continue}h=g-1;continue}if(-1===(g=u(e,h-1))){f(d,c(r.trim(e.slice(n,h)))),d=!1,n=h+1;continue}}else;else{if(-1===(g=e.indexOf(m,h+1)))break;f(d,r.trim(e.slice(i+1,g))),d=!1,n=(h=g)+1}else d=e.slice(n,h),n=h+1,i='"'===e.charAt(n)||"'"===e.charAt(n)?n:l(e,h+1)}return n<e.length&&(!1===d?f(e.slice(n)):f(d,c(r.trim(e.slice(n))))),r.trim(o.join(" "))}},6018:(e,t,n)=>{var r=n(7043),i=n(3473);for(var o in(t=e.exports=function(e,t){return new i(t).process(e)}).FilterCSS=i,r)t[o]=r[o];"undefined"!=typeof window&&(window.filterCSS=e.exports)},6170:(e,t,n)=>{"use strict";const r=n(3908),i=n(144),{safeRe:o,t:s}=n(9718);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){const r=t.includePrerelease?o[s.COERCERTLFULL]:o[s.COERCERTL];let i;for(;(i=r.exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),r.lastIndex=i.index+i[1].length+i[2].length;r.lastIndex=-1}else n=e.match(t.includePrerelease?o[s.COERCEFULL]:o[s.COERCE]);if(null===n)return null;const a=n[2],l=n[3]||"0",u=n[4]||"0",c=t.includePrerelease&&n[5]?`-${n[5]}`:"",d=t.includePrerelease&&n[6]?`+${n[6]}`:"";return i(`${a}.${l}.${u}${c}${d}`,t)}},6254:(e,t,n)=>{"use strict";const r=n(3908);e.exports=(e,t)=>new r(e,t).minor},6300:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M15 7.5a.52.52 0 0 1-.516.527H2.976L6.473 11.6a.535.535 0 0 1 0 .746.51.51 0 0 1-.73 0L1 7.5l4.743-4.846a.51.51 0 0 1 .73 0 .535.535 0 0 1 0 .746L2.976 6.973h11.508c.285 0 .516.236.516.527"></path></svg>'},6374:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#151515" fill-rule="evenodd" d="M2 0v9h1V1h7v4h4v4h1V3.6L11.4 0zm12 4h-3V1h.31L14 3.69zM1.5 13.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2M14.57 10h1.05l-1.615 5.059h-.994L11.421 10h1.047l1.044 3.317zM4 11v3h2v1H3v-5h3v1zm4 0v1h2v3H7v-1h2v-1H7v-3h3v1z" clip-rule="evenodd"></path></svg>'},6420:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6.973 11.484c0 .285.236.516.527.516a.52.52 0 0 0 .527-.516V1.976L10.6 4.473c.206.202.54.202.746 0a.51.51 0 0 0 0-.73L7.5 0 3.654 3.743a.51.51 0 0 0 0 .73c.206.202.54.202.746 0l2.573-2.497zM1 8v7h13V8h1v8H0V8z" clip-rule="evenodd"></path></svg>'},6780:(e,t,n)=>{"use strict";const r=n(8311);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t,n))},6874:e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},6942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},6953:(e,t,n)=>{"use strict";const r=n(144);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},7043:(e,t)=>{function n(){var e={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return e}var r=/javascript\s*\:/gim;t.whiteList=n(),t.getDefaultWhiteList=n,t.onAttr=function(e,t,n){},t.onIgnoreAttr=function(e,t,n){},t.safeAttrValue=function(e,t){return r.test(t)?"":t}},7059:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>r(e,t,n)<0},7075:(e,t,n)=>{"use strict";const r=n(3908),i=n(3904),{ANY:o}=i,s=n(8311),a=n(7638),l=n(5580),u=n(7059),c=n(5200),d=n(4089);e.exports=(e,t,n,p)=>{let f,h,g,m,v;switch(e=new r(e,p),t=new s(t,p),n){case">":f=l,h=c,g=u,m=">",v=">=";break;case"<":f=u,h=d,g=l,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let s=null,a=null;if(r.forEach(e=>{e.semver===o&&(e=new i(">=0.0.0")),s=s||e,a=a||e,f(e.semver,s.semver,p)?s=e:g(e.semver,a.semver,p)&&(a=e)}),s.operator===m||s.operator===v)return!1;if((!a.operator||a.operator===m)&&h(e,a.semver))return!1;if(a.operator===v&&g(e,a.semver))return!1}return!0}},7272:e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},7332:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M0 6.5V0h9v6.5zM2.5 1H1v1.5h1.5zm1 0H5v1.5H3.5zm0 2.5H5v2H3.5zm2.5 0v2h2v-2zM6 1v1.5h2V1zM2.5 3.5v2H1v-2zM7 16V9.5h9V16zm2.5-5.5H8V13h1.5zm1 0H12V13h-1.5zm0 3.5H12v1h-1.5zm2.5 0v1h2v-1zm0-3.5V13h2v-2.5zM9.5 14v1H8v-1z" clip-rule="evenodd"></path><path fill="#000" d="M11.32 3h-1.5V2h1.5a2.5 2.5 0 0 1 2.5 2.5v1.793l1.329-1.329a.5.5 0 1 1 .707.708l-2.182 2.182a.5.5 0 0 1-.707 0l-2.183-2.182a.5.5 0 0 1 .708-.708l1.328 1.329V4.5a1.5 1.5 0 0 0-1.5-1.5M6.182 13h-1.5a1.5 1.5 0 0 1-1.5-1.5V9.707l1.328 1.329a.5.5 0 1 0 .708-.708L3.036 8.146a.5.5 0 0 0-.708 0L.146 10.328a.5.5 0 1 0 .708.708l1.328-1.329V11.5a2.5 2.5 0 0 0 2.5 2.5h1.5z"></path></svg>'},7350:(e,t,n)=>{var r=n(8221),i=n(3805);e.exports=function(e,t,n){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),r(e,t,{leading:o,maxWait:t,trailing:s})}},7386:e=>{"use strict";e.exports=o},7390:(e,t,n)=>{var r;!function(){"use strict";var i=function e(t){var n,r=Symbol.for("react.element"),i=Symbol.for("react.transitional.element"),o={use_static:!1};function s(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function a(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:n})}"object"!=typeof(n=t)||Array.isArray(n)||null===n||void 0!==t.use_static&&(o.use_static=Boolean(t.use_static));var l="__immutable_invariants_hold";function u(e){return"object"!=typeof e||(null===e||Boolean(Object.getOwnPropertyDescriptor(e,l)))}function c(e,t){return e===t||e!=e&&t!=t}function d(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var p=["setPrototypeOf"],f=(p.concat(["push","pop","sort","splice","shift","unshift","reverse"]),["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]));function h(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function g(e,t){return a(e,l,!0),e}function m(e,t){var n=e[t];a(e,t,function(){return G(n.apply(e,arguments))})}function v(e,t,n){var r=n&&n.deep;if(e in this&&(r&&this[e]!==t&&d(t)&&d(this[e])&&(t=G.merge(this[e],t,{deep:!0,mode:"replace"})),c(this[e],t)))return this;var i=O.call(this);return i[e]=G(t),b(i)}p.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]),h.prototype=new Error,h.prototype.constructor=Error;var y=G([]);function S(e,t,n){var r=e[0];if(1===e.length)return v.call(this,r,t,n);var i,o=e.slice(1),s=this[r];if("object"==typeof s&&null!==s)i=G.setIn(s,o,t);else{var a=o[0];i=""!==a&&isFinite(a)?S.call(y,o,t):_.call(L,o,t)}if(r in this&&s===i)return this;var l=O.call(this);return l[r]=i,b(l)}function b(e){for(var t in f){if(f.hasOwnProperty(t))m(e,f[t])}o.use_static||(a(e,"flatMap",I),a(e,"asObject",C),a(e,"asMutable",O),a(e,"set",v),a(e,"setIn",S),a(e,"update",N),a(e,"updateIn",U),a(e,"getIn",F));for(var n=0,r=e.length;n<r;n++)e[n]=G(e[n]);return g(e)}function w(){return new Date(this.getTime())}function I(e){if(0===arguments.length)return this;var t,n=[],r=this.length;for(t=0;t<r;t++){var i=e(this[t],t,this);Array.isArray(i)?n.push.apply(n,i):n.push(i)}return b(n)}function E(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach(function(e,t,n){"number"==typeof e&&(n[t]=e.toString())}),e=function(e,n){return-1!==t.indexOf(n)}}var n=s(this);for(var r in this)this.hasOwnProperty(r)&&!1===e(this[r],r)&&(n[r]=this[r]);return V(n)}function O(e){var t,n,r=[];if(e&&e.deep)for(t=0,n=this.length;t<n;t++)r.push(T(this[t]));else for(t=0,n=this.length;t<n;t++)r.push(this[t]);return r}function C(e){"function"!=typeof e&&(e=function(e){return e});var t,n={},r=this.length;for(t=0;t<r;t++){var i=e(this[t],t,this),o=i[0],s=i[1];n[o]=s}return V(n)}function T(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,l)||e instanceof Date?e:G.asMutable(e,{deep:!0})}function x(e,t){for(var n in e)Object.getOwnPropertyDescriptor(e,n)&&(t[n]=e[n]);return t}function A(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var n,r,i=Array.isArray(e),o=t&&t.deep,a=t&&t.mode||"merge",l=t&&t.merger;function u(e,r,i){var a,u=G(r[i]),p=l&&l(e[i],u,t),f=e[i];void 0===n&&void 0===p&&e.hasOwnProperty(i)&&c(u,f)||(c(f,a=void 0!==p?p:o&&d(f)&&d(u)?G.merge(f,u,t):u)&&e.hasOwnProperty(i)||(void 0===n&&(n=x(e,s(e))),n[i]=a))}if(i)for(var p=0,f=e.length;p<f;p++){var h=e[p];for(r in h)h.hasOwnProperty(r)&&u(void 0!==n?n:this,h,r)}else{for(r in e)Object.getOwnPropertyDescriptor(e,r)&&u(this,e,r);"replace"===a&&function(e,t){for(var r in e)t.hasOwnProperty(r)||(void 0===n&&(n=x(e,s(e))),delete n[r])}(this,e)}return void 0===n?this:V(n)}function D(e,t){var n=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return G.merge(this,e,{deep:n,mode:"replace"})}var R,P,j,L=G({});function _(e,t,n){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var r=e[0];if(1===e.length)return M.call(this,r,t,n);var i,o=e.slice(1),a=this[r];if(i=this.hasOwnProperty(r)&&"object"==typeof a&&null!==a?G.setIn(a,o,t):_.call(L,o,t),this.hasOwnProperty(r)&&a===i)return this;var l=x(this,s(this));return l[r]=i,V(l)}function M(e,t,n){var r=n&&n.deep;if(this.hasOwnProperty(e)&&(r&&this[e]!==t&&d(t)&&d(this[e])&&(t=G.merge(this[e],t,{deep:!0,mode:"replace"})),c(this[e],t)))return this;var i=x(this,s(this));return i[e]=G(t),V(i)}function N(e,t){var n=Array.prototype.slice.call(arguments,2),r=this[e];return G.set(this,e,t.apply(r,[r].concat(n)))}function k(e,t){for(var n=0,r=t.length;null!=e&&n<r;n++)e=e[t[n]];return n&&n==r?e:void 0}function U(e,t){var n=Array.prototype.slice.call(arguments,2),r=k(this,e);return G.setIn(this,e,t.apply(r,[r].concat(n)))}function F(e,t){var n=k(this,e);return void 0===n?t:n}function B(e){var t,n=s(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(n[t]=T(this[t]));else for(t in this)this.hasOwnProperty(t)&&(n[t]=this[t]);return n}function $(){return{}}function V(e){return o.use_static||(a(e,"merge",A),a(e,"replace",D),a(e,"without",E),a(e,"asMutable",B),a(e,"set",M),a(e,"setIn",_),a(e,"update",N),a(e,"updateIn",U),a(e,"getIn",F)),g(e)}function G(e,t,n){if(u(e)||function(e){return"object"==typeof e&&null!==e&&(e.$$typeof===i||e.$$typeof===r)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(G);if(Array.isArray(e))return b(e.slice());if(e instanceof Date)return s=new Date(e.getTime()),o.use_static||a(s,"asMutable",w),g(s);var s,l=t&&t.prototype,c=(l&&l!==Object.prototype?function(){return Object.create(l)}:$)();for(var d in e)Object.getOwnPropertyDescriptor(e,d)&&(c[d]=G(e[d],void 0,n));return V(c)}function W(e){return function(){var t=[].slice.call(arguments),n=t.shift();return e.apply(n,t)}}function H(e,t){return function(){var n=[].slice.call(arguments),r=n.shift();return Array.isArray(r)?t.apply(r,n):e.apply(r,n)}}return G.from=G,G.isImmutable=u,G.ImmutableError=h,G.merge=W(A),G.replace=W(D),G.without=W(E),G.asMutable=(R=B,P=O,j=w,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?P.apply(t,e):t instanceof Date?j.apply(t,e):R.apply(t,e)}),G.set=H(M,v),G.setIn=H(_,S),G.update=W(N),G.updateIn=W(U),G.getIn=W(F),G.flatMap=W(I),G.asObject=W(C),o.use_static||(G.static=e({use_static:!0})),Object.freeze(G),G}();void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}()},7414:(e,t,n)=>{"use strict";const r=n(144);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},7442:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 3H3v10h5zM3 2H2v12h7V2H3m1.833 2.834h2.75v.916h-2.75zm2.75 1.833h-2.75v.916h2.75zm2.75 2.75h1.833v.916h-1.833zm1.833 1.833h-1.833v.917h1.833zM4.833 8.5h2.75v.917h-2.75zM14 7.583H9.416V8.5h3.667v4.583H9.416V14H14V7.583" clip-rule="evenodd"></path></svg>'},7631:(e,t,n)=>{"use strict";const r=n(8311);e.exports=(e,t)=>new r(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},7638:(e,t,n)=>{"use strict";const r=n(8311);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},7896:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15 1.53V0H1v1.53h.07l5.374 5.288v6.121l2.26 2.224a.5.5 0 0 0 .852-.356V6.825l5.382-5.295zM2 1h12v.049L8.556 6.406l-.001 7.207-1.111-1.093V6.399L2 1.042z" clip-rule="evenodd"></path></svg>'},7927:e=>{"use strict";e.exports=function(e,t,n,r,i,o,s,a){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,o,s,a],c=0;(l=new Error(t.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},8030:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#151515" fill-rule="evenodd" d="M3.793 14.8A9.2 9.2 0 0 1 0 14.089l1.01-5.97v1.866a.99.99 0 0 0 .55.88l-.435 2.572a9.5 9.5 0 0 0 2.668.363 11 11 0 0 0 3.888-.748 12.8 12.8 0 0 1 4.526-.852 8.3 8.3 0 0 1 2.489.376l-.284-1.674c.393-.14.664-.501.688-.917v-.63a1.09 1.09 0 0 0-1.1-1h-.018l-.197-1.162V6a1 1 0 0 0-.326-.73l-.483-2.857a7.2 7.2 0 0 0-2.27-.4 5.9 5.9 0 0 0-2.367.435A7.8 7.8 0 0 1 5.294 3a11.4 11.4 0 0 1-2.359-.26L2.553 5H2.01a.97.97 0 0 0-.497.152l.62-3.664A10.4 10.4 0 0 0 5.294 2c2.688 0 2.721-.986 5.412-.986a8.2 8.2 0 0 1 3.161.674L16 14.29a6.62 6.62 0 0 0-3.793-1.09c-3.665 0-4.749 1.6-8.414 1.6M2.01 9.985h.785v-1.85h.011l1.407 1.85H5v-.3L3.563 7.877 5 6.2v-.18q.002-.01.004-.021h-.796L2.795 7.713V6H2.01zm11.99 0v-.628h-1.215V6H12v3.985zM6 6.02V10h.865V6.73l.013-.012L8.09 10h.865l1.188-3.282h.013V10H11V6.02H9.601l-1.07 3.02h-.014L7.446 6.02z" clip-rule="evenodd"></path></svg>'},8221:(e,t,n)=>{var r=n(3805),i=n(124),o=n(9374),s=Math.max,a=Math.min;e.exports=function(e,t,n){var l,u,c,d,p,f,h=0,g=!1,m=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,r=u;return l=u=void 0,h=t,d=e.apply(r,n)}function S(e){var n=e-f;return void 0===f||n>=t||n<0||m&&e-h>=c}function b(){var e=i();if(S(e))return w(e);p=setTimeout(b,function(e){var n=t-(e-f);return m?a(n,c-(e-h)):n}(e))}function w(e){return p=void 0,v&&l?y(e):(l=u=void 0,d)}function I(){var e=i(),n=S(e);if(l=arguments,u=this,f=e,n){if(void 0===p)return function(e){return h=e,p=setTimeout(b,t),g?y(e):d}(f);if(m)return clearTimeout(p),p=setTimeout(b,t),y(f)}return void 0===p&&(p=setTimeout(b,t)),d}return t=o(t)||0,r(n)&&(g=!!n.leading,c=(m="maxWait"in n)?s(o(n.maxWait)||0,t):c,v="trailing"in n?!!n.trailing:v),I.cancel=function(){void 0!==p&&clearTimeout(p),h=0,l=f=u=p=void 0},I.flush=function(){return void 0===p?d:w(i())},I}},8249:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1 2h14v12H1zm13 1H2v4h12zm0 5h-3v2h3zm0 3h-3v2h3zm-4 2v-2H6v2zm-5 0v-2H2v2zm-3-3h3V8H2zm8-2v2H6V8z" clip-rule="evenodd"></path></svg>'},8311:(e,t,n)=>{"use strict";const r=/\s+/g;class i{constructor(e,t){if(t=s(t),e instanceof i)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new i(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(r," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!v(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&g)|(this.options.loose&&m))+":"+e,n=o.get(t);if(n)return n;const r=this.options.loose,i=r?c[d.HYPHENRANGELOOSE]:c[d.HYPHENRANGE];e=e.replace(i,R(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(c[d.COMPARATORTRIM],p),l("comparator trim",e),e=e.replace(c[d.TILDETRIM],f),l("tilde trim",e),e=e.replace(c[d.CARETTRIM],h),l("caret trim",e);let s=e.split(" ").map(e=>b(e,this.options)).join(" ").split(/\s+/).map(e=>D(e,this.options));r&&(s=s.filter(e=>(l("loose invalid filter",e,this.options),!!e.match(c[d.COMPARATORLOOSE])))),l("range list",s);const u=new Map,y=s.map(e=>new a(e,this.options));for(const e of y){if(v(e))return[e];u.set(e.value,e)}u.size>1&&u.has("")&&u.delete("");const S=[...u.values()];return o.set(t,S),S}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Range is required");return this.set.some(n=>S(n,t)&&e.set.some(e=>S(e,t)&&n.every(n=>e.every(e=>n.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(P(this.set[t],e,this.options))return!0;return!1}}e.exports=i;const o=new(n(8794)),s=n(8587),a=n(3904),l=n(7272),u=n(3908),{safeRe:c,t:d,comparatorTrimReplace:p,tildeTrimReplace:f,caretTrimReplace:h}=n(9718),{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:m}=n(6874),v=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,S=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(e=>i.intersects(e,t)),i=r.pop();return n},b=(e,t)=>(l("comp",e,t),e=O(e,t),l("caret",e),e=I(e,t),l("tildes",e),e=T(e,t),l("xrange",e),e=A(e,t),l("stars",e),e),w=e=>!e||"x"===e.toLowerCase()||"*"===e,I=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{const n=t.loose?c[d.TILDELOOSE]:c[d.TILDE];return e.replace(n,(t,n,r,i,o)=>{let s;return l("tilde",e,t,n,r,i,o),w(n)?s="":w(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:w(i)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(l("replaceTilde pr",o),s=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,l("tilde return",s),s})},O=(e,t)=>e.trim().split(/\s+/).map(e=>C(e,t)).join(" "),C=(e,t)=>{l("caret",e,t);const n=t.loose?c[d.CARETLOOSE]:c[d.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(t,n,i,o,s)=>{let a;return l("caret",e,t,n,i,o,s),w(n)?a="":w(i)?a=`>=${n}.0.0${r} <${+n+1}.0.0-0`:w(o)?a="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:s?(l("replaceCaret pr",s),a="0"===n?"0"===i?`>=${n}.${i}.${o}-${s} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${s} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${s} <${+n+1}.0.0-0`):(l("no pr"),a="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),l("caret return",a),a})},T=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map(e=>x(e,t)).join(" ")),x=(e,t)=>{e=e.trim();const n=t.loose?c[d.XRANGELOOSE]:c[d.XRANGE];return e.replace(n,(n,r,i,o,s,a)=>{l("xRange",e,n,r,i,o,s,a);const u=w(i),c=u||w(o),d=c||w(s),p=d;return"="===r&&p&&(r=""),a=t.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&p?(c&&(o=0),s=0,">"===r?(r=">=",c?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===r&&(r="<",c?i=+i+1:o=+o+1),"<"===r&&(a="-0"),n=`${r+i}.${o}.${s}${a}`):c?n=`>=${i}.0.0${a} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${o}.0${a} <${i}.${+o+1}.0-0`),l("xRange return",n),n})},A=(e,t)=>(l("replaceStars",e,t),e.trim().replace(c[d.STAR],"")),D=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),R=e=>(t,n,r,i,o,s,a,l,u,c,d,p)=>`${n=w(r)?"":w(i)?`>=${r}.0.0${e?"-0":""}`:w(o)?`>=${r}.${i}.0${e?"-0":""}`:s?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=w(u)?"":w(c)?`<${+u+1}.0.0-0`:w(d)?`<${u}.${+c+1}.0-0`:p?`<=${u}.${c}.${d}-${p}`:e?`<${u}.${c}.${+d+1}-0`:`<=${l}`}`.trim(),P=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(l(e[n].semver),e[n].semver!==a.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},8327:(e,t,n)=>{var r=n(6018).FilterCSS,i=n(2048),o=n(5930),s=o.parseTag,a=o.parseAttr,l=n(9349);function u(e){return null==e}function c(e){(e=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=i.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=function(e){var t={};for(var n in e)Array.isArray(e[n])?t[n.toLowerCase()]=e[n].map(function(e){return e.toLowerCase()}):t[n.toLowerCase()]=e[n];return t}(e.whiteList||e.allowList):e.whiteList=i.whiteList,e.onTag=e.onTag||i.onTag,e.onTagAttr=e.onTagAttr||i.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||i.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||i.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||i.safeAttrValue,e.escapeHtml=e.escapeHtml||i.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new r(e.css))}c.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,n=t.whiteList,r=t.onTag,o=t.onIgnoreTag,c=t.onTagAttr,d=t.onIgnoreTagAttr,p=t.safeAttrValue,f=t.escapeHtml,h=this.cssFilter;t.stripBlankChar&&(e=i.stripBlankChar(e)),t.allowCommentTag||(e=i.stripCommentTag(e));var g=!1;t.stripIgnoreTagBody&&(g=i.StripTagBody(t.stripIgnoreTagBody,o),o=g.onIgnoreTag);var m=s(e,function(e,t,i,s,g){var m={sourcePosition:e,position:t,isClosing:g,isWhite:Object.prototype.hasOwnProperty.call(n,i)},v=r(i,s,m);if(!u(v))return v;if(m.isWhite){if(m.isClosing)return"</"+i+">";var y=function(e){var t=l.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=l.trim(e.slice(t+1,-1)))[e.length-1];return n&&(e=l.trim(e.slice(0,-1))),{html:e,closing:n}}(s),S=n[i],b=a(y.html,function(e,t){var n=-1!==l.indexOf(S,e),r=c(i,e,t,n);return u(r)?n?(t=p(i,e,t,h))?e+'="'+t+'"':e:u(r=d(i,e,t,n))?void 0:r:r});return s="<"+i,b&&(s+=" "+b),y.closing&&(s+=" /"),s+=">"}return u(v=o(i,s,m))?f(s):v},f);return g&&(m=g.remove(m)),m},e.exports=c},8418:(e,t,n)=>{"use strict";e.exports=n(5160)},8427:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15 3.5v9c0 1.933-3.134 3.5-7 3.5s-7-1.567-7-3.5v-9C1 1.567 4.134 0 8 0s7 1.567 7 3.5M2 5.304V6.5C2 7.692 4.615 9 8 9s6-1.308 6-2.5V5.304C12.775 6.32 10.546 7 8 7s-4.775-.68-6-1.696M8 10c2.546 0 4.775-.68 6-1.696V9.5c0 1.192-2.615 2.5-6 2.5s-6-1.308-6-2.5V8.304C3.225 9.32 5.454 10 8 10m6 1.304C12.775 12.32 10.546 13 8 13s-4.775-.68-6-1.696V12.5C2 13.692 4.615 15 8 15s6-1.308 6-2.5zM14 3.5C14 4.692 11.385 6 8 6S2 4.692 2 3.5 4.615 1 8 1s6 1.308 6 2.5" clip-rule="evenodd"></path></svg>'},8587:e=>{"use strict";const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},8629:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6 3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0M0 14.09 1.2 7h1.014l-1.09 6.437a9.5 9.5 0 0 0 2.669.363 11 11 0 0 0 3.888-.748 12.8 12.8 0 0 1 4.526-.852 8.3 8.3 0 0 1 2.489.376l-1.72-10.163a7.2 7.2 0 0 0-2.27-.399 5.9 5.9 0 0 0-2.367.434q-.165.06-.339.12V1.506a6.9 6.9 0 0 1 2.706-.493 8.2 8.2 0 0 1 3.161.674L16 14.29a6.62 6.62 0 0 0-3.793-1.089c-1.833 0-3.02.4-4.207.8s-2.375.8-4.207.8A9.2 9.2 0 0 1 0 14.09M10 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4m-3.223.916 1.5-1-.554-.832-1.5 1zm.444-5.798 1.092.898-.635.773-1.093-.899zM5 11.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0m1 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0" clip-rule="evenodd"></path></svg>'},8794:e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},8816:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M5 1H2v1h3zM0 14.09 1.2 7h1.014l-1.09 6.437a9.5 9.5 0 0 0 2.669.363 11 11 0 0 0 3.888-.748 12.8 12.8 0 0 1 4.526-.852 8.3 8.3 0 0 1 2.489.376l-1.72-10.163a7.2 7.2 0 0 0-2.27-.399 5.9 5.9 0 0 0-2.367.434q-.165.06-.339.12V1.506a6.9 6.9 0 0 1 2.706-.493 8.2 8.2 0 0 1 3.161.674L16 14.29a6.62 6.62 0 0 0-3.793-1.089c-1.833 0-3.02.4-4.207.8s-2.375.8-4.207.8A9.2 9.2 0 0 1 0 14.09M2 3h5v1H2zm6 3V5H2v1z" clip-rule="evenodd"></path></svg>'},8964:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m9.5.332-.641.189-7.5 2.5L1 3.126V12H0v1h7v2H2v1h11v-1H8v-2h8v-1H9.5V6H14v6h1V5H9.5zM8.5 12V1.67L2 3.874V12z" clip-rule="evenodd"></path></svg>'},8972:e=>{"use strict";e.exports=n},9244:e=>{"use strict";e.exports=s},9325:(e,t,n)=>{var r=n(4840),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},9349:e=>{e.exports={indexOf:function(e,t){var n,r;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var r,i;if(Array.prototype.forEach)return e.forEach(t,n);for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}}},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},9374:(e,t,n)=>{var r=n(4128),i=n(3805),o=n(4394),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||l.test(e)?u(e.slice(2),n?2:8):s.test(e)?NaN:+e}},9381:e=>{"use strict";e.exports=i},9589:(e,t,n)=>{"use strict";const r=n(9718),i=n(6874),o=n(3908),s=n(1123),a=n(144),l=n(6953),u=n(7414),c=n(3007),d=n(1832),p=n(2938),f=n(6254),h=n(4493),g=n(1729),m=n(560),v=n(9970),y=n(1763),S=n(909),b=n(3927),w=n(4277),I=n(5580),E=n(7059),O=n(4641),C=n(3999),T=n(4089),x=n(5200),A=n(2111),D=n(6170),R=n(3904),P=n(8311),j=n(7638),L=n(7631),_=n(9628),M=n(270),N=n(1261),k=n(3874),U=n(7075),F=n(5571),B=n(5342),$=n(6780),V=n(2525),G=n(5032);e.exports={parse:a,valid:l,clean:u,inc:c,diff:d,major:p,minor:f,patch:h,prerelease:g,compare:m,rcompare:v,compareLoose:y,compareBuild:S,sort:b,rsort:w,gt:I,lt:E,eq:O,neq:C,gte:T,lte:x,cmp:A,coerce:D,Comparator:R,Range:P,satisfies:j,toComparators:L,maxSatisfying:_,minSatisfying:M,minVersion:N,validRange:k,outside:U,gtr:F,ltr:B,intersects:$,simplifyRange:V,subset:G,SemVer:o,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},9628:(e,t,n)=>{"use strict";const r=n(3908),i=n(8311);e.exports=(e,t,n)=>{let o=null,s=null,a=null;try{a=new i(t,n)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(o&&-1!==s.compare(e)||(o=e,s=new r(o,n)))}),o}},9698:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element");function r(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},9718:(e,t,n)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=n(6874),s=n(7272),a=(t=e.exports={}).re=[],l=t.safeRe=[],u=t.src=[],c=t.safeSrc=[],d=t.t={};let p=0;const f="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",o],[f,i]],g=(e,t,n)=>{const r=(e=>{for(const[t,n]of h)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=p++;s(e,i,t),d[e]=i,u[i]=t,c[i]=r,a[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(r,n?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),g("MAINVERSION",`(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})\\.(${u[d.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})\\.(${u[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${u[d.NONNUMERICIDENTIFIER]}|${u[d.NUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${u[d.NONNUMERICIDENTIFIER]}|${u[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASE",`(?:-(${u[d.PRERELEASEIDENTIFIER]}(?:\\.${u[d.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${u[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[d.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${f}+`),g("BUILD",`(?:\\+(${u[d.BUILDIDENTIFIER]}(?:\\.${u[d.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${u[d.MAINVERSION]}${u[d.PRERELEASE]}?${u[d.BUILD]}?`),g("FULL",`^${u[d.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${u[d.MAINVERSIONLOOSE]}${u[d.PRERELEASELOOSE]}?${u[d.BUILD]}?`),g("LOOSE",`^${u[d.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${u[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${u[d.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:\\.(${u[d.XRANGEIDENTIFIER]})(?:${u[d.PRERELEASE]})?${u[d.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[d.XRANGEIDENTIFIERLOOSE]})(?:${u[d.PRERELEASELOOSE]})?${u[d.BUILD]}?)?)?`),g("XRANGE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${u[d.GTLT]}\\s*${u[d.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),g("COERCE",`${u[d.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",u[d.COERCEPLAIN]+`(?:${u[d.PRERELEASE]})?`+`(?:${u[d.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",u[d.COERCE],!0),g("COERCERTLFULL",u[d.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${u[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${u[d.LONETILDE]}${u[d.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${u[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${u[d.LONECARET]}${u[d.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${u[d.LONECARET]}${u[d.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${u[d.GTLT]}\\s*(${u[d.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${u[d.GTLT]}\\s*(${u[d.LOOSEPLAIN]}|${u[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${u[d.XRANGEPLAIN]})\\s+-\\s+(${u[d.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${u[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[d.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},9970:(e,t,n)=>{"use strict";const r=n(560);e.exports=(e,t,n)=>r(t,e,n)}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{"use strict";a.r(l),a.d(l,{APP_FRAME_NAME_IN_BUILDER:()=>qa,AbstractDataAction:()=>iL,AbstractMessageAction:()=>oS,AdvancedExpressionPartType:()=>bR,AjaxState:()=>Na,AllDataSourceTypes:()=>Qa,AnimationComponent:()=>tK,AnimationContext:()=>XJ,AnimationDirection:()=>FJ,AnimationEffectType:()=>UJ,AnimationLight:()=>iK,AnimationPlayMode:()=>BJ,AnimationStartMode:()=>$J,AnimationTriggerType:()=>NJ,AnimationType:()=>kJ,AppDialog:()=>jK,AppKeyboardComponent:()=>CB,AppMode:()=>ka,AppRoot:()=>T$,AppStateManager:()=>qS,AppType:()=>dl,AppVersionManager:()=>qj,ArcGISDependencyDefineExtension:()=>xY,ArcadeContentAllKeys:()=>ZR,ArcadeContentCapability:()=>JR,ArcadeContentResolverComponent:()=>F$,ArcadeContentStyleKeys:()=>QR,ArcadeContentValueKeys:()=>XR,ArcadeProfileContextProvider:()=>j$,ArcadeProfileType:()=>eP,BaseVersionManager:()=>zj,BaseWidget:()=>Xj,BrowserSizeMode:()=>La,ButtonClickMessage:()=>rS,CONSTANTS:()=>o,ClauseCascade:()=>nO,ClauseDisplayType:()=>lO,ClauseLabelDisplay:()=>aO,ClauseLogic:()=>tO,ClauseOperator:()=>rO,ClauseSourceType:()=>iO,ClauseType:()=>sO,ConfigManager:()=>eL,ContainerType:()=>Vh,DEFAULT_HOVER_PROPS:()=>_K,DEFAULT_VARIANTS:()=>zJ,DataActionManager:()=>hb,DataLevel:()=>rL,DataRecordSetChangeMessage:()=>Zy,DataRecordsSelectionChangeMessage:()=>Yy,DataSourceComponent:()=>RB,DataSourceError:()=>gl,DataSourceFilterChangeMessage:()=>Qy,DataSourceManager:()=>mA,DataSourceSelectionMode:()=>sl,DataSourceSelectionTypes:()=>hl,DataSourceStatus:()=>Ya,DataSourceTypes:()=>Xa,DataSourcesChangeMessage:()=>eS,DataSourcesChangeType:()=>zy,DialogInteractionType:()=>Yh,DialogMode:()=>Kh,DummyDataAction:()=>oL,DummyMessageAction:()=>sS,DynamicIconPosition:()=>qP,DynamicStyleConditionOperator:()=>HP,DynamicStyleConditionSourceType:()=>zP,DynamicStyleCustomExpressionSourceType:()=>WP,DynamicStyleCustomStatisticsMethod:()=>VP,DynamicStyleReferenceValueSourceType:()=>GP,DynamicStyleResolverComponent:()=>rV,DynamicStyleSourceType:()=>KP,DynamicStyleType:()=>JP,EConsentMode:()=>tg,ECookieBannerLayout:()=>ng,EMPTY_OPTION_VALUE:()=>oO,ESRI_DATE_FORMAT_ARRAY:()=>Wa,ESRI_OBJECTID_TYPE:()=>IR,EXPRESSION_LOAD_PREFIX:()=>ER,ErrorBoundary:()=>O$,EsriFieldType:()=>Ma,ExBAddedJSAPIProperties:()=>Ka,ExportCSV:()=>vL,ExportFormat:()=>Qh,ExportGeoJSON:()=>DL,ExportJson:()=>dL,ExpressionFunctions:()=>SR,ExpressionPartType:()=>yR,ExpressionResolverComponent:()=>G$,ExpressionResolverErrorCode:()=>B$,ExtensionManager:()=>GI,ExtentChangeMessage:()=>Xy,ExternalResolvablePromise:()=>Qg,FixedPosition:()=>Xh,FocusVisibility:()=>U_,FormattedDate:()=>Aj,FormattedMessage:()=>Lj,FormattedNumber:()=>Rj,FormattedPlural:()=>Mj,FormattedRelativeTime:()=>Gj,FormattedTime:()=>Dj,GridItemType:()=>Wh,GuideLevels:()=>J_,GuideManager:()=>X_,GuideTypes:()=>q_,HashParamsType:()=>fl,HoverType:()=>LK,INTERACTIVE_CLASS:()=>j_,IdManager:()=>Hv,Immutable:()=>Ye,IntlProvider:()=>Ny,JSAPILayerTypes:()=>al,JimuCoreDataSourceFactoryUriExtension:()=>MW,JimuFieldType:()=>_a,JimuMapViewStatus:()=>ll,KEYBOARD_NAV_CLASS:()=>P_,Keyboard:()=>OB,LayoutItemType:()=>$v,LayoutParentType:()=>Gh,LayoutType:()=>Vv,LinkType:()=>Fa,LoadingHandler:()=>GW,LocationChangeMessage:()=>tS,MessageActionConnectionType:()=>Wj,MessageCarryData:()=>Wy,MessageManager:()=>db,MessageType:()=>Gy,MultipleDataSourceComponent:()=>A$,MutableStoreManager:()=>Fy,OpenTypes:()=>Ba,OrderRule:()=>uO,PageMode:()=>Jh,PagePart:()=>Ha,PageType:()=>qh,PageVisibilityContext:()=>Wv,ParentAnimationMode:()=>VJ,PermissionList:()=>h$,QueryScope:()=>il,RawIntlProvider:()=>Py,React:()=>F,ReactDOM:()=>B,ReactDOMClient:()=>$,ReactRedux:()=>e,ReactResizeDetector:()=>Qn,RecordSetChangeType:()=>Hy,RepeatedDataSourceProvider:()=>$y,ResolveExpressionErrorCode:()=>OR,ResourceType:()=>Ja,ScreenTransitionType:()=>Hh,ScreenTriggerType:()=>zh,SelectDataRecordMessage:()=>nS,ServiceManager:()=>fA,SessionChangedReasonType:()=>Sv,SessionManager:()=>Tv,SetFilter:()=>V_,SignInErrorCode:()=>yv,SqlExpressionMode:()=>eO,SqlQuerySortOrder:()=>ol,StatisticType:()=>wR,StringSelectionChangeMessage:()=>Ky,SupportedItemTypes:()=>tl,SupportedJSAPILayerTypes:()=>nl,SupportedLayerServiceTypes:()=>Za,SupportedLayerTypesInWebMapSpec:()=>rl,SupportedServerTypes:()=>el,SupportedUtilityType:()=>Zh,SystemErrorCode:()=>cl,SystemErrorType:()=>ul,ThemeCommonColorKeys:()=>TG,ThemeFontVariantKeys:()=>CG,ThemeThemeAlertColorKeys:()=>xG,ThemeThemeColorKeys:()=>DG,ThemeThemeMainColorKeys:()=>AG,TimezoneConfig:()=>eg,TrackingManager:()=>o$,TransitionContainer:()=>dY,TransitionDirection:()=>JK,TransitionType:()=>KK,USER_SETTING_FILE_KEY:()=>RG,UrlGeneralConfig:()=>pl,UrlInfoPartType:()=>PG,UrlManager:()=>nL,UrlProtocol:()=>za,UtilityManager:()=>Lx,ViewChangeMessage:()=>iS,ViewVisibilityContext:()=>Gv,WIDGET_PREFIX_FOR_A11Y_SKIP:()=>L_,WidgetManager:()=>vb,WidgetState:()=>Ua,WidgetType:()=>$a,WidgetVersionManager:()=>Kj,_ExpressionResolverComponent:()=>V$,appActions:()=>A,appConfigUtils:()=>h,arcadeContentUtils:()=>P,cancelablePromise:()=>N,clamp:()=>lY,classNames:()=>Ze(),configTranslationUtils:()=>M,createAppStore:()=>CE,createIntl:()=>og,createIntlCache:()=>oh,createSelector:()=>UY,css:()=>sg.css,dataSourceUtils:()=>C,dateUtils:()=>s,defaultMessages:()=>Xg,dynamicStyleUtils:()=>_,esri:()=>VY,expressionUtils:()=>j,extensionSpec:()=>c,focusElementInKeyboardMode:()=>k_,geometryUtils:()=>O,getA11yProps:()=>F_,getAppStore:()=>TE,getHoverEffect:()=>zK,getHoverStyle:()=>qK,getIndexFromProgress:()=>aY,getMessageTypeLabel:()=>Jy,getNextAnimationId:()=>GJ,getTransition:()=>uY,getWidgetIdsInRootContainers:()=>B_,groupExpressionPartsByFunction:()=>GR,hooks:()=>k,i18n:()=>y,indexedDBUtils:()=>m,init:()=>UW,injectIntl:()=>Ly,invariant:()=>zn,isDirectionalTransition:()=>pY,isIntegerProgress:()=>sY,isKeyboardMode:()=>N_,jimuHistory:()=>v,jsx:()=>sg.jsx,keyMap:()=>dR,keyboardUtils:()=>D,loadArcGISJSAPIModule:()=>Bg,loadArcGISJSAPIModules:()=>Fg,loadArcGISMapComponents:()=>$g,loadDependencies:()=>Ng,loadDependency:()=>Mg,lodash:()=>$Y,messageActionUtils:()=>L,moduleLoader:()=>w,motion:()=>U,observeStore:()=>xE,polished:()=>GY,portalUrlUtils:()=>u,portalUtils:()=>f,prepareLocalVariants:()=>JJ,prepareOneByOneTransition:()=>KJ,prepareOneByOneVariants:()=>YJ,privilegeUtils:()=>p,proxyUtils:()=>T,queryString:()=>_t,requestUtils:()=>x,resolveExpression:()=>YR,saveAs:()=>Zn.saveAs,semver:()=>lt,serviceUrlUtils:()=>d,sharedThemeUtils:()=>I,translatedLocales:()=>WY,urlManagerUtils:()=>g,urlUtils:()=>b,useIntersection:()=>QJ,useIntl:()=>Ij,utilityUtils:()=>R,utils:()=>S,uuidv1:()=>at,version:()=>BY,withRepeatedDataSource:()=>Vy,xss:()=>ut});var e={};a.r(e),a.d(e,{Provider:()=>Fe,ReactReduxContext:()=>_e,batch:()=>Ke,connect:()=>Ue,createDispatchHook:()=>We,createSelectorHook:()=>qe,createStoreHook:()=>Ve,shallowEqual:()=>ye,useDispatch:()=>He,useSelector:()=>Je,useStore:()=>Ge});var t={};a.r(t),a.d(t,{exclude:()=>Lt,extract:()=>xt,parse:()=>At,parseUrl:()=>Rt,pick:()=>jt,stringify:()=>Dt,stringifyUrl:()=>Pt});var n={};a.r(n),a.d(n,{ApiKey:()=>qr,ApiKeyManager:()=>zr,ApplicationCredentialsManager:()=>Wr,ApplicationSession:()=>Hr,ArcGISAccessDeniedError:()=>Nr,ArcGISAuthError:()=>Ar,ArcGISIdentityManager:()=>oi,ArcGISJobError:()=>kr,ArcGISRequestError:()=>fr,ArcGISTokenRequestError:()=>Mr,ArcGISTokenRequestErrorCodes:()=>Lr,Blob:()=>dr,ErrorTypes:()=>_r,File:()=>cr,FormData:()=>ur,JOB_STATUSES:()=>ui,Job:()=>di,NODEJS_DEFAULT_REFERER_HEADER:()=>Cr,UserSession:()=>si,appendCustomParams:()=>jr,canUseOnlineToken:()=>Zr,checkForErrors:()=>Dr,cleanUrl:()=>Ur,decodeParam:()=>Fr,decodeQueryString:()=>Br,encodeFormData:()=>pr,encodeParam:()=>ar,encodeQueryString:()=>lr,exchangeToken:()=>ai,fetchToken:()=>Vr,getDefaultRequestOptions:()=>xr,getFetch:()=>Or,getOnlineEnvironment:()=>Xr,getRegisteredNoCorsDomains:()=>yr,internalRequest:()=>Rr,isFederated:()=>Qr,isNoCorsDomain:()=>wr,isNoCorsRequestRequired:()=>Ir,isOnline:()=>Kr,normalizeOnlinePortalUrl:()=>Yr,platformSelf:()=>li,processParams:()=>sr,registerNoCorsDomains:()=>Sr,request:()=>Pr,requiresFormData:()=>or,revokeToken:()=>ti,sendNoCorsRequest:()=>vr,setDefaultRequestOptions:()=>Tr,validateAppAccess:()=>ei,warn:()=>Er,withOptions:()=>pi});var r={};a.r(r),a.d(r,{SearchQueryBuilder:()=>so,acceptInvitation:()=>Fo,addGroupUsers:()=>ho,addItemData:()=>wi,addItemPart:()=>uo,addItemRelationship:()=>Ii,addItemResource:()=>Ei,bboxToString:()=>mi,cancelItemUpload:()=>po,commitItemUpload:()=>co,createFolder:()=>Ci,createGroup:()=>bo,createGroupNotification:()=>wo,createItem:()=>xi,createItemInFolder:()=>Ti,createOrgNotification:()=>Po,declineInvitation:()=>Bo,determineOwner:()=>hi,determineUsername:()=>Lo,ensureMembership:()=>Zo,exportItem:()=>Ai,getGroup:()=>Hi,getGroupCategorySchema:()=>zi,getGroupContent:()=>qi,getGroupUsers:()=>Ji,getItem:()=>Pi,getItemBaseUrl:()=>ji,getItemData:()=>Li,getItemGroups:()=>ki,getItemInfo:()=>Bi,getItemMetadata:()=>$i,getItemParts:()=>Fi,getItemResource:()=>Ni,getItemResources:()=>Mi,getItemStatus:()=>Ui,getPortal:()=>is,getPortalSettings:()=>os,getPortalUrl:()=>fi,getRelatedItems:()=>_i,getSelf:()=>rs,getSharingUrl:()=>Yi,getUniqueServiceName:()=>ns,getUser:()=>_o,getUserContent:()=>Oi,getUserInvitation:()=>Uo,getUserInvitations:()=>ko,getUserMembership:()=>Zi,getUserNotifications:()=>$o,getUserProperties:()=>zo,getUserTags:()=>Mo,getUserUrl:()=>No,inviteGroupUsers:()=>yo,isBBox:()=>gi,isItemOwner:()=>Xi,isItemSharedWithGroup:()=>Yo,isOrgAdmin:()=>Qi,isServiceNameAvailable:()=>ts,joinGroup:()=>Do,leaveGroup:()=>Ro,moveItem:()=>bi,protectGroup:()=>Io,protectItem:()=>Gi,reassignItem:()=>eo,removeFolder:()=>io,removeGroup:()=>Oo,removeGroupUsers:()=>vo,removeItem:()=>to,removeItemRelationship:()=>no,removeItemResource:()=>ro,removeItemThumbnail:()=>oo,removeNotification:()=>Vo,scrubControlChars:()=>Ri,searchCommunityUsers:()=>Wo,searchGroupContent:()=>To,searchGroupUsers:()=>Ki,searchGroups:()=>Co,searchItems:()=>lo,searchUsers:()=>Go,setItemAccess:()=>Jo,setUserProperties:()=>qo,shareItemWithGroup:()=>Xo,unprotectGroup:()=>Eo,unprotectItem:()=>Wi,unshareItemWithGroup:()=>es,updateGroup:()=>xo,updateItem:()=>vi,updateItemInfo:()=>yi,updateItemResource:()=>Si,updateUser:()=>Ho,updateUserMemberships:()=>Ao});var i={};a.r(i),a.d(i,{addAttachment:()=>as,addFeatures:()=>ss,addToServiceDefinition:()=>ls,applyEdits:()=>us,createFeatureService:()=>cs,decodeValues:()=>ps,deleteAttachments:()=>gs,deleteFeatures:()=>hs,getAllLayersAndTables:()=>ys,getAttachments:()=>Ss,getFeature:()=>Es,getLayer:()=>ds,getService:()=>bs,getServiceAdminInfo:()=>ws,getViewSources:()=>Is,parseServiceUrl:()=>vs,queryAllFeatures:()=>Cs,queryFeatures:()=>Os,queryRelated:()=>Ts,updateAttachment:()=>As,updateFeatures:()=>xs,updateServiceDefinition:()=>Ds});var o={};a.r(o),a.d(o,{ADD_MARKER_LAYER_ID:()=>Ud,ADD_TO_MAP_DATA_ID_PREFIX:()=>kd,ARCADE_AI_ASSISTANT_APP_VERSION:()=>Vd,BREAK_POINTS:()=>Id,CURRENT_PAGE:()=>jd,DATA_SOURCES_PROFILE_ARCADE_CONTENT_ID_PREFIX:()=>Bd,DATA_VIEW_ID_FOR_NO_SELECTION:()=>Dd,DEFAULT_PAGE_WIDTH:()=>Od,DEFAULT_QUERY_PAGE_SIZE:()=>Ld,DEFAULT_VIEWPORT_SIZE:()=>Ed,EnableClassicThemeSelectorQueryParam:()=>Wd,FEATURE_PROFILE_ARCADE_CONTENT_ID_PREFIX:()=>Fd,MAX_DATA_SOURCES_PROFILE_ARCADE_CONTENT_PER_PAGE:()=>$d,OUTPUT_DATA_VIEW_ID:()=>Rd,REPEAT_CONTEXT_DATA_VIEW_ID:()=>Pd,SCREEN_RESOLUTIONS:()=>Td,SELECTION_DATA_VIEW_ID:()=>Ad,SHARED_THEME:()=>xd,SHOW_ON_MAP_DATA_ID_PREFIX:()=>Nd,TYPE_KEYWORDS_OF_EXPRESS_APP:()=>Md,USER_LOCALE_KEY:()=>_d,translatedLocales:()=>Gd});var s={};a.r(s),a.d(s,{DATE_TIME_DEFAULT_ESRI_FORMAT:()=>ap,DATE_TIME_DEFAULT_FORMAT:()=>lp,ESRI_DATE_FORMAT_MAP:()=>sp,TimeUnit:()=>op,VirtualDateType:()=>ip,formatDate:()=>yp,formatDateTime:()=>vp,formatDateValue:()=>pp,formatDateValueByEsriFormat:()=>cp,formatTime:()=>Sp,formatTimeValueByEsriFormat:()=>dp,getDateByStrictYMDFormat:()=>Ip,getDateOptions:()=>gp,getDateTimeOptions:()=>hp,getEsriDateFormat:()=>up,getIntlOptions:()=>fp,getRealDateByVirtualDate:()=>Ep,getStrictYMDFormat:()=>wp,getTimeOption:()=>mp,isStrictYMDFormat:()=>bp});var u={};a.r(u),a.d(u,{fixPortalUrlProtocol:()=>Cg,getBaseGroupUrl:()=>lg,getBaseItemUrl:()=>gg,getBaseUserUrl:()=>vg,getContentUrl:()=>Sg,getHomeIndexUrl:()=>Eg,getHomeMapViewerUrl:()=>Og,getItemUrl:()=>mg,getPlatformUrlByOrgUrl:()=>xg,getPortalProxyUrl:()=>Tg,getPortalRestUrl:()=>cg,getPortalSelfInfoUrl:()=>ag,getPortalUrlFromLocation:()=>ug,getPortalUrlFromRestUrl:()=>dg,getStandardPortalUrl:()=>hg,getUserContentUrl:()=>bg,getUserItemsUrl:()=>wg,getUserUrl:()=>yg,isAGOLDomain:()=>fg,isPlatformUrl:()=>Ag,isSamePortalUrl:()=>pg,shareItemUrl:()=>Ig});var c={};a.r(c),a.d(c,{DummyExtension:()=>Pg,EP_BUILDER_ONLY_EXTENSIONS:()=>Rg,EP_SUPPORT_MULTIPLE_EXTENSIONS:()=>Dg,ExtensionPoints:()=>rg});var d={};a.r(d),a.d(d,{getServerRootUrl:()=>Jg,getServiceRootUrl:()=>qg,isServerUrl:()=>zg,isServiceUrl:()=>Hg});var p={};a.r(p),a.d(p,{CheckTarget:()=>Km,canCreateItem:()=>cv,canPublishFeatures:()=>dv,checkAccess:()=>Qm,checkEditAppPermission:()=>tv,checkExbAccess:()=>ev,getAccessCapabilities:()=>Zm,getInvalidMessage:()=>nv,getItemInfo:()=>pv,getPortalVersion:()=>iv,getRestrictedPageIds:()=>vv,getUser:()=>uv,isItemInTheUpdatedGroup:()=>mv,isPortal1061OrBefore:()=>ov,isPortal1080OrBefore:()=>sv,shouldCheckAppAccess:()=>fv});var f={};a.r(f),a.d(f,{clearPortalSelf:()=>Lv,clearPortalSigninSettings:()=>_v,getAppInfo:()=>Nv,getPortalSelf:()=>Pv,getPortalSigninSettings:()=>jv,initPortalSelf:()=>Rv,removeAppInfo:()=>kv,shouldShowClassificationBanner:()=>Fv,shouldShowClassificationConfig:()=>Bv,validateClientId:()=>Uv});var h={};a.r(h),a.d(h,{APP_RESOURCE_URL:()=>Yv,addLayoutLabel:()=>sy,addWebmapOrWebsceneToAppConfig:()=>Iy,addWidgetDefaultLabelAndIcon:()=>oy,addWidgetManifestProperties:()=>iy,fixLayoutIds:()=>fy,fullMatchBlobUrl:()=>Kv,fullMatchResourceUrl:()=>Qv,getAllWidgets:()=>cy,getAllWidgetsInSameRootContainer:()=>Ty,getClientQueryEnabledMapWidgetId:()=>Cy,getConnectionInfoFromAppConfig:()=>by,getDataSourceJsonById:()=>Ey,getLayoutIdInSizeMode:()=>my,getRealAppResourceUrl:()=>ey,getResourceUrlsInString:()=>Zv,getSizeModeOfALayout:()=>vy,getUniqueId:()=>ay,getUniqueLabel:()=>ly,getWidgetContext:()=>ry,getWidgetIdByOutputDataSource:()=>yy,getWidgetMessageActionJsons:()=>dy,isFullReplace:()=>qv,isTwoViewsInSaveSection:()=>py,matchBlobUrl:()=>Jv,matchResourceUrl:()=>Xv,parseUniqueLabel:()=>uy,processResourceUrl:()=>ty,restoreResourceUrl:()=>ny,setConnectionInfoToAppConfig:()=>wy,updateControllerWidgetId:()=>gy,updateStateWhenAppConfigChange:()=>hy,validateConnectionsOfAppConfig:()=>Sy});var g={};a.r(g),a.d(g,{compatibleParseOldUrlRule:()=>LS,encodeForCompatibleMode:()=>jS,encodeRFC3986URIComponent:()=>TS,filterWidgetsEnable:()=>bS,filterWidgetsEnabledParams:()=>wS,getAppConfig:()=>gS,getFullEncodedUrlHashObject:()=>DS,getFullEncodedUrlHashWidgetParams:()=>RS,isDataSelectionEnable:()=>PS,isWidgetEnable:()=>vS,isWidgetParamsEnable:()=>yS,isWidgetsHashParamsType:()=>SS,parseDsQueryObject:()=>CS,parseHashObjToStr:()=>ES,parseHashObject:()=>xS,parseHashStrToObj:()=>IS,parseQueryObjToStr:()=>OS,stringifyHashObject:()=>AS,updateUrl:()=>mS});var m={};a.r(m),a.d(m,{IndexedDBCache:()=>$S,getDBName:()=>WS,whenRequest:()=>VS,whenTransaction:()=>GS});var v={};a.r(v),a.d(v,{HistoryContext:()=>XS,HistoryProvider:()=>QS,browserHistory:()=>JS,changeDialog:()=>ob,changeHashObjectByDataSourceSelection:()=>sb,changePage:()=>nb,changeQueryObject:()=>eb,changeQueryObjectByDataSourceGDBVersion:()=>ab,changeUrlHashObject:()=>tb,changeView:()=>rb,changeViewBySectionNavInfo:()=>ib,putBrowserHistoryLocalState:()=>KS,restoreBrowserHistoryLocalState:()=>YS,withHistory:()=>ZS});var y={};a.r(y),a.d(y,{changeLocale:()=>Rb,findLocale:()=>Db,getBrowserLanguage:()=>bb,getDecimalSeparator:()=>Ab,getIntl:()=>Tb,getLocaleToLoad:()=>Sb,getTranslatedLocale:()=>wb,isRTLLocale:()=>Ob,isSameLanguage:()=>Ib,loadLocaleMessages:()=>Eb,resetIntls:()=>xb,setRTL:()=>_b});var S={};a.r(S),a.d(S,{AppHigherVersionStateType:()=>Kb,applyMixins:()=>aw,calculateDigits:()=>vw,changeAppConfig:()=>Ww,checkAppHigherVersionState:()=>Tw,diffArrays:()=>$w,findViewportSize:()=>rw,formatNumber:()=>jw,formatPercentageNumber:()=>Lw,formatPixelNumber:()=>_w,getBrowserSizeMode:()=>nw,getButtonStyles:()=>Ub,getGeometryService:()=>Xb,getGeometryType:()=>Yb,getIntlOption:()=>ww,getJimuThemeModule:()=>Mw,getJimuUiModule:()=>Nw,getLocalStorageAppKey:()=>hw,getNavButtonGroupStyles:()=>Vb,getNavStyles:()=>$b,getOverlayUniqueId:()=>yw,getPaginationStyles:()=>Gb,getPanelCallbackNamesFromPanelState:()=>Zb,getPaperStyles:()=>zb,getParentWindow:()=>Vw,getSizeModeWidth:()=>iw,getSliderStyles:()=>Hb,getUID:()=>gw,getUUID:()=>mw,getValue:()=>Vu,getWidgetCallbackNamesFromWidgetState:()=>Qb,hyphenateStyleName:()=>dw,isArrayContainSameItems:()=>lw,isDeepEqual:()=>wd,isExpressMode:()=>Gw,isInIFrame:()=>tw,isTouchDevice:()=>ew,isWidgetSelected:()=>Fw,iterateDeepObject:()=>kw,loadstyle:()=>sw,memoize:()=>Iw,readLocalStorage:()=>Ow,readLocalStorageKeys:()=>Ew,readSessionStorage:()=>Aw,readSessionStorageKeys:()=>xw,removeFromLocalStorage:()=>Rw,removeFromSessionStorage:()=>Pw,replaceI18nPlaceholdersInObject:()=>Sw,replaceStringInObject:()=>Uw,setLocalStorage:()=>Cw,setRef:()=>Bw,setSessionStorage:()=>Dw,showApp:()=>bw,styleObjectToString:()=>pw,tryGet:()=>fw,wait:()=>Hw});var b={};a.r(b),a.d(b,{appendQueryParam:()=>oI,changeUrl:()=>LI,checkAbsoluteUrl:()=>Kw,createHref:()=>Qw,createLocation:()=>Xw,createShortUrl:()=>jI,fixDialogLabel:()=>yI,fixPageLabel:()=>vI,fixViewLabel:()=>SI,getAbsoluteRootUrl:()=>OI,getAppIdPageIdFromUrl:()=>dI,getAppUrl:()=>TI,getArcgisOnlineOrgId:()=>RI,getArcgisOnlineUrl:()=>DI,getCanonicalPageUrl:()=>xI,getDataSourceInfosFromUrlParams:()=>aI,getDialogIdFromIdOrLabel:()=>gI,getExperienceBuilderOnlineUrl:()=>AI,getFixedRootPath:()=>EI,getFolder:()=>Yw,getHrefFromLinkTo:()=>CI,getPageIdFromIdOrLabel:()=>fI,getPageLinkInfo:()=>bI,getPageLinkUrl:()=>II,getProtocol:()=>eI,getSectionNavInfoFromQueryObject:()=>cI,getUrlHost:()=>rI,getViewIdFromIdOrLabel:()=>hI,isAbsoluteUrl:()=>Jw,isZoomToSelection:()=>PI,normalize:()=>sI,parseAppPath:()=>pI,parseUrl:()=>qw,removeProtocol:()=>nI,removeSearchFromUrl:()=>iI,setProtocol:()=>tI,splitDataSToParts:()=>uI,updateQueryStringParameter:()=>Zw});var w={};a.r(w),a.d(w,{deleteModule:()=>$I,getJimuForBuilderModules:()=>BI,getModuleSync:()=>MI,loadModule:()=>NI,loadModules:()=>kI,resolveModuleFullPath:()=>FI,resolveModuleFullUrl:()=>UI});var I={};a.r(I),a.d(I,{createSharedThemeVariables:()=>zI});var E={};a.r(E),a.d(E,{createDataSourceJson:()=>aC,createDataSourceJsonByItemData:()=>dC,createDataSourceJsonByItemInfo:()=>uC,createDataSourceJsonByJSAPILayer:()=>lC,createDataSourceJsonByLayerDefinition:()=>pC,getDataSourceTypeFromArcGISWholeServiceUrl:()=>fC});var O={};a.r(O),a.d(O,{convertGeometryJsonToGeometryInstance:()=>KC,createBuffer:()=>qC,projectDataRecordsToSpatialReference:()=>HC,projectToSpatialReference:()=>zC});var C={};a.r(C),a.d(C,{NON_COUNT_AFFECTING_QUERY_PARAMS_KEYS:()=>xx,_getFixedLayerIdByLayerDefinition:()=>TT,areDatesInUnknownTimezone:()=>yx,areDerivedFromSameMain:()=>VT,areFieldCodedValuesAffectedByTypeIdField:()=>pT,areQueryParamsEmpty:()=>Ax,changeJSAPIGeometryTypeToRestAPIGeometryType:()=>hO,changeJimuArcGISQueryToJSAPIQuery:()=>EO,changeJimuRecordsToJSAPIGraphics:()=>gO,changeJimuTimeToJSAPITimeExtent:()=>vO,changeRestAPIGeometryTypeToJSAPIGeometryType:()=>fO,changeToJSAPIGraphic:()=>wO,changeToRestAPIFeature:()=>bO,checkIsSuggestionRepeat:()=>UC,containsNonLatinCharacter:()=>HO,convertFieldToJimuField:()=>oT,convertStringToNumber:()=>VC,createJSAPIFeatureLayerByDataSourceFromFeatureCollectionItem:()=>vx,createJSAPIFeatureLayerByRecords:()=>dO,createRestAPILayerByDataSource:()=>mx,createRestFeatureLayerByRecords:()=>pO,createSQLClause:()=>eC,createSQLClauseSet:()=>tC,createSQLExpression:()=>nC,dataSourceJsonCreator:()=>E,doesDsSupportQuery:()=>Dx,doesJSAPILayerSupportTime:()=>nx,ensureWhereClauseMatchesSubtype:()=>XO,fetchAssociatedFeatureLayerDefinition:()=>vC,fetchAssociatedFeatureLayerUrl:()=>yC,fetchAssociatedFeatureServicePortalItem:()=>bC,fetchSuggestionByFullText:()=>_C,fetchSuggestionByWhere:()=>LC,filterAttachments:()=>iT,findAssociatedFeatureLayerUrl:()=>wC,findMapServiceDataSource:()=>ax,fixLayerId:()=>IT,getArcGISSQL:()=>NO,getAssumedAssociatedLayerUrl:()=>SC,getChildDataSourceId:()=>DT,getChildDsJsonFromRootDs:()=>wx,getCodedValueListForCodedValueOrSubtypeField:()=>dT,getDataSourceIdByJSAPILayer:()=>UT,getDataSourceProxyUrl:()=>xC,getDataViewId:()=>zT,getDateFieldValue:()=>Ix,getDateFieldValueWithoutTzOffset:()=>Ex,getDisplayValueForCodedValueOrSubtype:()=>uT,getDisplayValueForCodedValueOrSubtypeBatch:()=>cT,getDisplayedSQLExpressionFromGroupSQLExpression:()=>iC,getDsIcon:()=>DC,getDsTypeString:()=>AC,getExportOptions:()=>px,getFieldInfoByFieldName:()=>lT,getFixedLayerIdByLayer:()=>ET,getFixedLayerIdByLayerDefinition:()=>CT,getFullArcGISServiceUrl:()=>TC,getJSAPILayer:()=>lx,getJimuDataSourceRelationship:()=>Tx,getJimuLayerIdByJSAPILayer:()=>kT,getLabelFromArcGISServiceUrl:()=>IC,getLayerDefinition:()=>cx,getLayerDefinitionIntersection:()=>hx,getLocalTimeOffset:()=>qO,getMainDataSourceId:()=>WT,getMainOriginDataSource:()=>Cx,getMergedSQLExpressions:()=>rC,getOriginDataLabel:()=>NT,getPopupInfo:()=>dx,getPopupInfoIntersection:()=>fx,getQueryParamsAndOptions:()=>RT,getRealDataSourceId:()=>_T,getRegOfSearchText:()=>NC,getRelatedMainDataSourceWithOriginInfo:()=>gx,getRestAPILayer:()=>ux,getRootDataSourceId:()=>HT,getSQL:()=>$C,getSQLExpressionFromGroupSQLExpression:()=>oC,getSortedArrayByLabel:()=>AT,getSortedDataViewIds:()=>Rx,getSuggestionItem:()=>BC,getSuggestions:()=>MC,getTimeZoneOffsetByName:()=>Sx,getTimezoneAPIFromRuntime:()=>bx,getUrlByLayer:()=>LT,getUseDataSourceByDataSource:()=>MT,getUseDataSourceByDataSourceId:()=>qT,getUsedFieldsFromFeatureLayerQueryParams:()=>Ox,getWhetherDataSourceHasSameSourceWithJSAPILayer:()=>FT,getWhetherUseProxy:()=>Mx,handleGlobalIdField:()=>MO,isAGOLHostedService:()=>wT,isDataView:()=>GT,isDerivedFrom:()=>$T,isFeatureLayerDsOrSceneLayerDsOrImageryLayer:()=>CO,isItemMixin:()=>TO,isJSAPILayerTypeSupported:()=>xT,isNumericalField:()=>aT,isOwnerOrOrgAdminOfDataSource:()=>XT,isSelectionView:()=>YT,isSupportedArcGISService:()=>OC,isSupportedSingleArcGISLayerService:()=>CC,isSupportedWholeArcGISService:()=>EC,isWhereClauseEmpty:()=>ZO,mapUseDataSource:()=>KT,mapUseDataSources:()=>JT,mergeSubtypeSublayerWhereClausesToSubtypeGroupLayer:()=>YO,mergeTimeExtent:()=>rx,parserSQL:()=>UO,queryAllAttachments:()=>rT,queryFeatureCountByField:()=>PT,queryRecordsByFullText:()=>kC,querySuggestions:()=>jC,queryValueLabelsByFieldAndPageSize:()=>jT,selectBySelectionMode:()=>QC,supportAttachment:()=>ex,supportReplica:()=>QT,supportSymbol:()=>ZT,supportTime:()=>tx});var T={};a.r(T),a.d(T,{getProxyReferrers:()=>Bx,getProxyUrl:()=>Nx,getWhetherUseProxy:()=>Mx,isDataSourcePremium:()=>Wx,isDataSourceSubscriber:()=>Gx,isDataSourceSubscriberOrPremium:()=>Hx,isPremium:()=>Vx,isSubscriber:()=>$x,isUtilityPremium:()=>qx,isUtilitySubscriber:()=>zx,registerProxyReferrer:()=>Ux,unregisterProxyReferrer:()=>Fx});var x={};a.r(x),a.d(x,{deleteRequestCache:()=>lA,deleteSettledRequestCacheByPartialKeys:()=>uA,getRequestCache:()=>sA,isURLCacheable:()=>dA,registerCacheableUrl:()=>oA,requestWrapper:()=>eA,setRequestCache:()=>aA});var A={};a.r(A),a.d(A,{ActionKeys:()=>vA,CurrentGuideChange:()=>oR,MapWidgetInfoAdded:()=>sD,MapWidgetInfoRemoved:()=>lD,MapWidgetInfoUpdated:()=>aD,OpenCookieBannerByPrivacyPanel:()=>rR,OpenCookieBannerByUrl:()=>iR,OpenCookieBannerSetting:()=>tR,OpenCookieSettingsWindow:()=>nR,ThemeModeChanged:()=>jD,activateWidget:()=>_A,activeOverlay:()=>MD,activePagePartChanged:()=>PD,activePrintPreview:()=>XD,addToRegisterClientIdList:()=>qD,appConfigChanged:()=>SA,appConfigLoaded:()=>yA,appIdChanged:()=>IA,appInfoChanged:()=>wA,appModeChanged:()=>BA,appPathChanged:()=>bA,appRuntimeInfoInit:()=>AD,batchUpdateDataSourceInfo:()=>XA,browserSizeModeChanged:()=>vD,changeDataSourceGDBVersion:()=>JA,changeDynamicStylePreviewConditionInfo:()=>sR,changeDynamicStylePreviewRepeatedRecordInfo:()=>aR,clearAnimationPreview:()=>VD,clearDataSourceInfo:()=>KA,clearSystemError:()=>zD,clipboardChanged:()=>TD,closeOverlay:()=>_D,closeWidget:()=>PA,closeWidgets:()=>jA,currentDialogChanged:()=>ED,currentPageChanged:()=>ID,dataSourceCountStatusChanged:()=>GA,dataSourceInstanceStatusChanged:()=>WA,dataSourceSaveStatusChanged:()=>HA,dataSourceSelectedIndexesChanged:()=>fD,dataSourceSelectionChanged:()=>hD,dataSourceSourceVersionAdded:()=>qA,dataSourceStatusChanged:()=>VA,dataSourceVersionAdded:()=>zA,dialogInfosChanged:()=>OD,i18nMessagesLoaded:()=>NA,initAppContext:()=>MA,initStoreExtensionState:()=>uD,jimuMapViewAdded:()=>tD,jimuMapViewRemoved:()=>rD,jimuMapViewUpdated:()=>nD,layoutClassLoaded:()=>$A,networkStatusChanged:()=>wD,openOverlay:()=>LD,openWidget:()=>DA,openWidgets:()=>RA,queryObjectChanged:()=>kA,quitPrintPreview:()=>QD,releaseAutoControlMapWidget:()=>oD,removeFromRegisterClientIdList:()=>JD,requestAutoControlMapWidget:()=>iD,resetWidgetsState:()=>LA,saveThumbnailUrl:()=>eR,screenGroupNavInfoChanged:()=>FD,screenPanelVisibleChanged:()=>BD,sectionNavInfoChanged:()=>UD,selectionChanged:()=>CD,setAppInBuilder:()=>FA,setDataLastRefreshTime:()=>ZA,setDataNeedRefresh:()=>QA,setDataSourcePreloadData:()=>bD,setIsBusy:()=>kD,setNoPermissionPages:()=>lR,setPortalInfo:()=>pD,setPortalSelf:()=>RD,setSystemError:()=>HD,setWidgetIsInlineEditingState:()=>yD,setWidgetPreloadProps:()=>SD,setupAnimationPreview:()=>$D,setupHoverPreview:()=>GD,themeVariablesChanged:()=>DD,updateDataSourceInfo:()=>YA,updateNoPermissionResourceChangedFlag:()=>KD,updateResourceSessions:()=>YD,updateStoreState:()=>xD,updateWidgetQuery:()=>eD,urlHashObjectChanged:()=>UA,userLocaleChanged:()=>WD,userSignIn:()=>gD,userSignOut:()=>mD,utilityStateChange:()=>ZD,widgetClassLoaded:()=>EA,widgetConfigLoaded:()=>TA,widgetMutableStatePropChange:()=>dD,widgetRuntimeInfoChange:()=>AA,widgetStatePropChange:()=>cD,widgetToolbarStateChange:()=>xA,widgetUpgraded:()=>CA,widgetsUpgraded:()=>OA,zoomScaleChange:()=>ND});var D={};a.r(D),a.d(D,{triggerEvent:()=>pR});var R={};a.r(R),a.d(R,{addNewUtilityByUrl:()=>fR,checkIsUrlExist:()=>hR,getUtilityIdbyServiceUrl:()=>gR});var P={};a.r(P),a.d(P,{canAddNewDataSourcesProfileArcadeContent:()=>oP,doesWidgetHaveRepeatDataSource:()=>nP,getCopiedArcadeContentConfig:()=>lP,getCopiedArcadeContentScript:()=>uP,getWidgetRestAvailableArcadeContentCount:()=>sP,tryGetRepeatedUseDataSource:()=>rP,updateArcadeContentConfigWhenUseDataSourcesChange:()=>cP,validateArcadeScriptResult:()=>pP});var j={};a.r(j),a.d(j,{arcadeConfigToExpression:()=>FP,expressionToArcadeConfig:()=>UP,generateFieldsForUseDataSourcesByExpressionParts:()=>EP,getDataSourceIdsFromExpression:()=>_P,getPercentileParams:()=>MP,getSingleStringExpressionText:()=>PP,getUseDataSourcesByExpressionParts:()=>OP,getUseDataSourcesWithoutFields:()=>jP,getWhetherExpressionValid:()=>TP,getWhetherFieldInDs:()=>AP,isSingleArcadeExpression:()=>DP,isSingleStringExpression:()=>RP,mapExpression:()=>kP,mergeUseDataSources:()=>CP,replaceDataSourceId:()=>NP,whetherHasFieldsInUseDataSources:()=>LP});var L={};a.r(L),a.d(L,{formatValue:()=>BP,getSqlExpressionWidthMessageFieldValues:()=>$P});var _={};a.r(_),a.d(_,{generateFieldsForUseDataSourcesByDynamicStyle:()=>dj,getCopiedDynamicStyleConfig:()=>hj,getExpressionReturnType:()=>tj,getSupportedConditionSourceTypesByRefValueExpressionAndOperator:()=>sj,isArcadeExpression:()=>ZP,isAttributeExpression:()=>XP,isCommonExpression:()=>ej,isStatisticsExpression:()=>QP,updateDynamicStyleWhenUseDataSourcesChange:()=>pj,validateConditionInfo:()=>aj,validateConditionValueOptions:()=>lj});var M={};a.r(M),a.d(M,{getLocaleFromTranslationFile:()=>bj,getTranslationFileName:()=>vj,getTranslationFilePath:()=>mj,getTranslationFullFileName:()=>yj,isTranslationFile:()=>Sj,mergeTranslation:()=>wj});var N={};a.r(N),a.d(N,{CancelablePromise:()=>FL,cancelable:()=>$L,default:()=>BL,isCancelablePromise:()=>VL});var k={};a.r(k),a.d(k,{useArcgisArcadeEditor:()=>T_,useCancelablePromiseMaker:()=>m_,useCheckSmallBrowserSizeMode:()=>g_,useControlled:()=>p_,useDebounceCallback:()=>b_,useEffectOnce:()=>u_,useEffectWithPreviousValues:()=>y_,useEventCallback:()=>d_,useFirstMountState:()=>a_,useForkRef:()=>o_,useForwardRef:()=>s_,useLatest:()=>i_,useLoadArcGISJSAPI:()=>C_,useLoadArcGISJSAPIModule:()=>O_,useLoadedModule:()=>I_,useLoadedModuleComponent:()=>E_,usePrevious:()=>v_,useTranslation:()=>r_,useUnmount:()=>c_,useUpdateEffect:()=>l_,useWidgetActived:()=>h_,useWidgetSelected:()=>f_});var U={};a.r(U),a.d(U,{a:()=>_H,abbr:()=>MH,address:()=>NH,animate:()=>Nq,area:()=>kH,article:()=>UH,aside:()=>FH,audio:()=>BH,b:()=>$H,base:()=>VH,bdi:()=>GH,bdo:()=>WH,big:()=>HH,blockquote:()=>zH,body:()=>qH,button:()=>JH,canvas:()=>KH,caption:()=>YH,circle:()=>kq,cite:()=>XH,clipPath:()=>sJ,code:()=>QH,col:()=>ZH,colgroup:()=>ez,create:()=>LH,data:()=>tz,datalist:()=>nz,dd:()=>rz,defs:()=>Uq,del:()=>iz,desc:()=>Fq,details:()=>oz,dfn:()=>sz,dialog:()=>az,div:()=>lz,dl:()=>uz,dt:()=>cz,ellipse:()=>Bq,em:()=>dz,embed:()=>pz,feBlend:()=>aJ,feColorMatrix:()=>lJ,feComponentTransfer:()=>uJ,feComposite:()=>cJ,feConvolveMatrix:()=>dJ,feDiffuseLighting:()=>pJ,feDisplacementMap:()=>fJ,feDistantLight:()=>hJ,feDropShadow:()=>gJ,feFlood:()=>mJ,feFuncA:()=>vJ,feFuncB:()=>yJ,feFuncG:()=>SJ,feFuncR:()=>bJ,feGaussianBlur:()=>wJ,feImage:()=>IJ,feMerge:()=>EJ,feMergeNode:()=>OJ,feMorphology:()=>CJ,feOffset:()=>TJ,fePointLight:()=>xJ,feSpecularLighting:()=>AJ,feSpotLight:()=>DJ,feTile:()=>RJ,feTurbulence:()=>PJ,fieldset:()=>fz,figcaption:()=>hz,figure:()=>gz,filter:()=>Wq,footer:()=>mz,foreignObject:()=>jJ,form:()=>vz,g:()=>$q,h1:()=>yz,h2:()=>Sz,h3:()=>bz,h4:()=>wz,h5:()=>Iz,h6:()=>Ez,head:()=>Oz,header:()=>Cz,hgroup:()=>Tz,hr:()=>xz,html:()=>Az,i:()=>Dz,iframe:()=>Rz,image:()=>Vq,img:()=>Pz,input:()=>jz,ins:()=>Lz,kbd:()=>_z,keygen:()=>Mz,label:()=>Nz,legend:()=>kz,li:()=>Uz,line:()=>Gq,linearGradient:()=>LJ,link:()=>Fz,main:()=>Bz,map:()=>$z,mark:()=>Vz,marker:()=>Hq,mask:()=>zq,menu:()=>Gz,menuitem:()=>Wz,metadata:()=>qq,meter:()=>Hz,nav:()=>zz,object:()=>qz,ol:()=>Jz,optgroup:()=>Kz,option:()=>Yz,output:()=>Xz,p:()=>Qz,param:()=>Zz,path:()=>Jq,pattern:()=>Kq,picture:()=>eq,polygon:()=>Yq,polyline:()=>Xq,pre:()=>tq,progress:()=>nq,q:()=>rq,radialGradient:()=>_J,rect:()=>Qq,rp:()=>iq,rt:()=>oq,ruby:()=>sq,s:()=>aq,samp:()=>lq,script:()=>uq,section:()=>cq,select:()=>dq,small:()=>pq,source:()=>fq,span:()=>hq,stop:()=>Zq,strong:()=>gq,style:()=>mq,sub:()=>vq,summary:()=>yq,sup:()=>Sq,svg:()=>eJ,symbol:()=>tJ,table:()=>bq,tbody:()=>wq,td:()=>Iq,text:()=>nJ,textPath:()=>MJ,textarea:()=>Eq,tfoot:()=>Oq,th:()=>Cq,thead:()=>Tq,time:()=>xq,title:()=>Aq,tr:()=>Dq,track:()=>Rq,tspan:()=>rJ,u:()=>Pq,ul:()=>jq,use:()=>iJ,video:()=>Lq,view:()=>oJ,wbr:()=>_q,webview:()=>Mq});var F=a(8972),B=a(2581),$=a(9381),V=a(8418),G=F.version.startsWith("19"),W=Symbol.for(G?"react.transitional.element":"react.element"),H=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),ne=X,re=ee;function ie(e){if("object"==typeof e&&null!==e){const{$$typeof:t}=e;switch(t){case W:switch(e=e.type){case z:case J:case q:case Q:case Z:return e;default:switch(e=e&&e.$$typeof){case Y:case X:case te:case ee:case K:return e;default:return t}}case H:return t}}}function oe(e,t,n,r,{areStatesEqual:i,areOwnPropsEqual:o,areStatePropsEqual:s}){let a,l,u,c,d,p=!1;function f(p,f){const h=!o(f,l),g=!i(p,a,f,l);return a=p,l=f,h&&g?(u=e(a,l),t.dependsOnOwnProps&&(c=t(r,l)),d=n(u,c,l),d):h?(e.dependsOnOwnProps&&(u=e(a,l)),t.dependsOnOwnProps&&(c=t(r,l)),d=n(u,c,l),d):g?function(){const t=e(a,l),r=!s(t,u);return u=t,r&&(d=n(u,c,l)),d}():d}return function(i,o){return p?f(i,o):(a=i,l=o,u=e(a,l),c=t(r,l),d=n(u,c,l),p=!0,d)}}function se(e){return function(t){const n=e(t);function r(){return n}return r.dependsOnOwnProps=!1,r}}function ae(e){return e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function le(e,t){return function(t,{displayName:n}){const r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e,void 0)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=ae(e);let i=r(t,n);return"function"==typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=ae(i),i=r(t,n)),i},r}}function ue(e,t){return(n,r)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${r.wrappedComponentName}.`)}}function ce(e,t,n){return{...n,...e,...t}}function de(e){e()}var pe={notify(){},get:()=>[]};function fe(e,t){let n,r=pe,i=0,o=!1;function s(){u.onStateChange&&u.onStateChange()}function a(){i++,n||(n=t?t.addNestedSub(s):e.subscribe(s),r=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){de(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){r&&null!==e&&(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}())}function l(){i--,n&&0===i&&(n(),n=void 0,r.clear(),r=pe)}const u={addNestedSub:function(e){a();const t=r.subscribe(e);let n=!1;return()=>{n||(n=!0,t(),l())}},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:s,isSubscribed:function(){return o},trySubscribe:function(){o||(o=!0,a())},tryUnsubscribe:function(){o&&(o=!1,l())},getListeners:()=>r};return u}var he=(()=>!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement))(),ge=(()=>"undefined"!=typeof navigator&&"ReactNative"===navigator.product)(),me=(()=>he||ge?F.useLayoutEffect:F.useEffect)();function ve(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function ye(e,t){if(ve(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!ve(e[n[r]],t[n[r]]))return!1;return!0}var Se={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},be={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},we={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Ie={[ne]:{$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},[re]:we};function Ee(e){return ie(e)===ee?we:Ie[e.$$typeof]||Se}var Oe=Object.defineProperty,Ce=Object.getOwnPropertyNames,Te=Object.getOwnPropertySymbols,xe=Object.getOwnPropertyDescriptor,Ae=Object.getPrototypeOf,De=Object.prototype;function Re(e,t){if("string"!=typeof t){if(De){const n=Ae(t);n&&n!==De&&Re(e,n)}let n=Ce(t);Te&&(n=n.concat(Te(t)));const r=Ee(e),i=Ee(t);for(let o=0;o<n.length;++o){const s=n[o];if(!(be[s]||i&&i[s]||r&&r[s])){const n=xe(t,s);try{Oe(e,s,n)}catch(e){}}}}return e}var Pe=Symbol.for("react-redux-context"),je="undefined"!=typeof globalThis?globalThis:{};function Le(){if(!F.createContext)return{};const e=je[Pe]??=new Map;let t=e.get(F.createContext);return t||(t=F.createContext(null),e.set(F.createContext,t)),t}var _e=Le(),Me=[null,null];function Ne(e,t,n,r,i,o){e.current=r,n.current=!1,i.current&&(i.current=null,o())}function ke(e,t){return e===t}var Ue=function(e,t,n,{pure:r,areStatesEqual:i=ke,areOwnPropsEqual:o=ye,areStatePropsEqual:s=ye,areMergedPropsEqual:a=ye,forwardRef:l=!1,context:u=_e}={}){const c=u,d=function(e){return e?"function"==typeof e?le(e):ue(e,"mapStateToProps"):se(()=>({}))}(e),p=function(e){return e&&"object"==typeof e?se(t=>function(e,t){const n={};for(const r in e){const i=e[r];"function"==typeof i&&(n[r]=(...e)=>t(i(...e)))}return n}(e,t)):e?"function"==typeof e?le(e):ue(e,"mapDispatchToProps"):se(e=>({dispatch:e}))}(t),f=function(e){return e?"function"==typeof e?function(e){return function(t,{displayName:n,areMergedPropsEqual:r}){let i,o=!1;return function(t,n,s){const a=e(t,n,s);return o?r(a,i)||(i=a):(o=!0,i=a),i}}}(e):ue(e,"mergeProps"):()=>ce}(n),h=Boolean(e);return e=>{const t=e.displayName||e.name||"Component",n=`Connect(${t})`,r={shouldHandleStateChanges:h,displayName:n,wrappedComponentName:t,WrappedComponent:e,initMapStateToProps:d,initMapDispatchToProps:p,initMergeProps:f,areStatesEqual:i,areStatePropsEqual:s,areOwnPropsEqual:o,areMergedPropsEqual:a};function u(t){const[n,i,o]=F.useMemo(()=>{const{reactReduxForwardedRef:e,...n}=t;return[t.context,e,n]},[t]),s=F.useMemo(()=>c,[n,c]),a=F.useContext(s),l=Boolean(t.store)&&Boolean(t.store.getState)&&Boolean(t.store.dispatch),u=Boolean(a)&&Boolean(a.store);const d=l?t.store:a.store,p=u?a.getServerState:d.getState,f=F.useMemo(()=>function(e,{initMapStateToProps:t,initMapDispatchToProps:n,initMergeProps:r,...i}){return oe(t(e,i),n(e,i),r(e,i),e,i)}(d.dispatch,r),[d]),[g,m]=F.useMemo(()=>{if(!h)return Me;const e=fe(d,l?void 0:a.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]},[d,l,a]),v=F.useMemo(()=>l?a:{...a,subscription:g},[l,a,g]),y=F.useRef(void 0),S=F.useRef(o),b=F.useRef(void 0),w=F.useRef(!1),I=F.useRef(!1),E=F.useRef(void 0);me(()=>(I.current=!0,()=>{I.current=!1}),[]);const O=F.useMemo(()=>()=>b.current&&o===S.current?b.current:f(d.getState(),o),[d,o]),C=F.useMemo(()=>e=>g?function(e,t,n,r,i,o,s,a,l,u,c){if(!e)return()=>{};let d=!1,p=null;const f=()=>{if(d||!a.current)return;const e=t.getState();let n,f;try{n=r(e,i.current)}catch(e){f=e,p=e}f||(p=null),n===o.current?s.current||u():(o.current=n,l.current=n,s.current=!0,c())};return n.onStateChange=f,n.trySubscribe(),f(),()=>{if(d=!0,n.tryUnsubscribe(),n.onStateChange=null,p)throw p}}(h,d,g,f,S,y,w,I,b,m,e):()=>{},[g]);var T,x,A;let D;T=Ne,x=[S,y,w,o,b,m],me(()=>T(...x),A);try{D=F.useSyncExternalStore(C,O,p?()=>f(p(),o):O)}catch(e){throw E.current&&(e.message+=`\nThe error may be correlated with this previous error:\n${E.current.stack}\n\n`),e}me(()=>{E.current=void 0,b.current=void 0,y.current=D});const R=F.useMemo(()=>F.createElement(e,{...D,ref:i}),[i,e,D]);return F.useMemo(()=>h?F.createElement(s.Provider,{value:v},R):R,[s,R,v])}const g=F.memo(u);if(g.WrappedComponent=e,g.displayName=u.displayName=n,l){const t=F.forwardRef(function(e,t){return F.createElement(g,{...e,reactReduxForwardedRef:t})});return t.displayName=n,t.WrappedComponent=e,Re(t,e)}return Re(g,e)}};var Fe=function(e){const{children:t,context:n,serverState:r,store:i}=e,o=F.useMemo(()=>{const e=fe(i);return{store:i,subscription:e,getServerState:r?()=>r:void 0}},[i,r]),s=F.useMemo(()=>i.getState(),[i]);me(()=>{const{subscription:e}=o;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),s!==i.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[o,s]);const a=n||_e;return F.createElement(a.Provider,{value:o},t)};function Be(e=_e){return function(){return F.useContext(e)}}var $e=Be();function Ve(e=_e){const t=e===_e?$e:Be(e),n=()=>{const{store:e}=t();return e};return Object.assign(n,{withTypes:()=>n}),n}var Ge=Ve();function We(e=_e){const t=e===_e?Ge:Ve(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var He=We(),ze=(e,t)=>e===t;function qe(e=_e){const t=e===_e?$e:Be(e),n=(e,n={})=>{const{equalityFn:r=ze}="function"==typeof n?{equalityFn:n}:n;const i=t(),{store:o,subscription:s,getServerState:a}=i,l=(F.useRef(!0),F.useCallback({[e.name]:t=>e(t)}[e.name],[e])),u=(0,V.useSyncExternalStoreWithSelector)(s.addNestedSub,o.getState,a||o.getState,l,r);return F.useDebugValue(u),u};return Object.assign(n,{withTypes:()=>n}),n}var Je=qe(),Ke=de,Ye=a(7390),Xe=a.n(Ye),Qe=a(6942),Ze=a.n(Qe);let et;const tt=new Uint8Array(16);function nt(){if(!et){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");et=crypto.getRandomValues.bind(crypto)}return et(tt)}const rt=[];for(let e=0;e<256;++e)rt.push((e+256).toString(16).slice(1));function it(e,t=0){return(rt[e[t+0]]+rt[e[t+1]]+rt[e[t+2]]+rt[e[t+3]]+"-"+rt[e[t+4]]+rt[e[t+5]]+"-"+rt[e[t+6]]+rt[e[t+7]]+"-"+rt[e[t+8]]+rt[e[t+9]]+"-"+rt[e[t+10]]+rt[e[t+11]]+rt[e[t+12]]+rt[e[t+13]]+rt[e[t+14]]+rt[e[t+15]]).toLowerCase()}const ot={};function st(e,t,n,r,i,o,s=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(o){if(s<0||s+16>o.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`)}else o=new Uint8Array(16),s=0;t??=Date.now(),n??=0,r??=16383&(e[8]<<8|e[9]),i??=e.slice(10,16);const a=(1e4*(268435455&(t+=122192928e5))+n)%4294967296;o[s++]=a>>>24&255,o[s++]=a>>>16&255,o[s++]=a>>>8&255,o[s++]=255&a;const l=t/4294967296*1e4&268435455;o[s++]=l>>>8&255,o[s++]=255&l,o[s++]=l>>>24&15|16,o[s++]=l>>>16&255,o[s++]=r>>>8|128,o[s++]=255&r;for(let e=0;e<6;++e)o[s++]=i[e];return o}const at=function(e,t,n){let r;const i=e?._v6??!1;if(e){const t=Object.keys(e);1===t.length&&"_v6"===t[0]&&(e=void 0)}if(e)r=st(e.random??e.rng?.()??nt(),e.msecs,e.nsecs,e.clockseq,e.node,t,n);else{const e=Date.now(),o=nt();!function(e,t,n){e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0);e.node||(e.node=n.slice(10,16),e.node[0]|=1,e.clockseq=16383&(n[8]<<8|n[9]));e.msecs=t}(ot,e,o),r=st(o,ot.msecs,ot.nsecs,i?void 0:ot.clockseq,i?void 0:ot.node,t,n)}return t??it(r)};var lt=a(9589),ut=a(4005);const ct="%[a-f0-9]{2}",dt=new RegExp("("+ct+")|([^%]+?)","gi"),pt=new RegExp("("+ct+")+","gi");function ft(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(1===e.length)return e;t=t||1;const n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],ft(n),ft(r))}function ht(e){try{return decodeURIComponent(e)}catch{let t=e.match(dt)||[];for(let n=1;n<t.length;n++)t=(e=ft(t,n).join("")).match(dt)||[];return e}}function gt(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){const t={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"};let n=pt.exec(e);for(;n;){try{t[n[0]]=decodeURIComponent(n[0])}catch{const e=ht(n[0]);e!==n[0]&&(t[n[0]]=e)}n=pt.exec(e)}t["%C2"]="\ufffd";const r=Object.keys(t);for(const n of r)e=e.replace(new RegExp(n,"g"),t[n]);return e}(e)}}function mt(e,t){const n={};if(Array.isArray(t))for(const r of t){const t=Object.getOwnPropertyDescriptor(e,r);t?.enumerable&&Object.defineProperty(n,r,t)}else for(const r of Reflect.ownKeys(e)){const i=Object.getOwnPropertyDescriptor(e,r);if(i.enumerable){t(r,e[r],e)&&Object.defineProperty(n,r,i)}}return n}function vt(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];const n=e.indexOf(t);return-1===n?[]:[e.slice(0,n),e.slice(n+t.length)]}const yt=e=>null==e,St=e=>encodeURIComponent(e).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),bt=Symbol("encodeFragmentIdentifier");function wt(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function It(e,t){return t.encode?t.strict?St(e):encodeURIComponent(e):e}function Et(e,t){return t.decode?gt(e):e}function Ot(e){return Array.isArray(e)?e.sort():"object"==typeof e?Ot(Object.keys(e)).sort((e,t)=>Number(e)-Number(t)).map(t=>e[t]):e}function Ct(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function Tt(e,t,n){return"string"===n&&"string"==typeof e?e:"function"==typeof n&&"string"==typeof e?n(e):"boolean"===n&&null===e||("boolean"!==n||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?"boolean"!==n||null===e||"1"!==e.toLowerCase()&&"0"!==e.toLowerCase()?"string[]"===n&&"none"!==t.arrayFormat&&"string"==typeof e?[e]:"number[]"!==n||"none"===t.arrayFormat||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?"number"!==n||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?Number(e):e:"true"===e.toLowerCase():Number(e):[Number(e)]:"1"===e.toLowerCase():"true"===e.toLowerCase())}function xt(e){const t=(e=Ct(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function At(e,t){wt((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...t}).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[...r[e],n]:r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!i&&Et(n,e).includes(e.arrayFormatSeparator);n=o?Et(n,e):n;const s=i||o?n.split(e.arrayFormatSeparator).map(t=>Et(t,e)):null===n?n:Et(n,e);r[t]=s};case"bracket-separator":return(t,n,r)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i)return void(r[t]=n?Et(n,e):n);const o=null===n?[]:Et(n,e).split(e.arrayFormatSeparator);void 0!==r[t]?r[t]=[...r[t],...o]:r[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[...[n[e]].flat(),t]:n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){if(""===i)continue;const e=t.decode?i.replaceAll("+"," "):i;let[o,s]=vt(e,"=");void 0===o&&(o=e),s=void 0===s?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?s:Et(s,t),n(Et(o,t),s,r)}for(const[e,n]of Object.entries(r))if("object"==typeof n&&null!==n&&"string"!==t.types[e])for(const[r,i]of Object.entries(n)){const o=t.types[e]?t.types[e].replace("[]",""):void 0;n[r]=Tt(i,t,o)}else"object"==typeof n&&null!==n&&"string"===t.types[e]?r[e]=Object.values(n).join(t.arrayFormatSeparator):r[e]=Tt(n,t,t.types[e]);return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((e,t)=>{const n=r[t];return e[t]=Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?Ot(n):n,e},Object.create(null))}function Dt(e,t){if(!e)return"";wt((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);const n=n=>t.skipNull&&yt(e[n])||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[It(t,e),"[",i,"]"].join("")]:[...n,[It(t,e),"[",It(i,e),"]=",It(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[It(t,e),"[]"].join("")]:[...n,[It(t,e),"[]=",It(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[It(t,e),":list="].join("")]:[...n,[It(t,e),":list=",It(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:(i=null===i?"":i,0===r.length?[[It(n,e),t,It(i,e)].join("")]:[[r,It(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,It(t,e)]:[...n,[It(t,e),"=",It(r,e)].join("")]}}(t),i={};for(const[t,r]of Object.entries(e))n(t)||(i[t]=r);const o=Object.keys(i);return!1!==t.sort&&o.sort(t.sort),o.map(n=>{const i=e[n];return void 0===i?"":null===i?It(n,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?It(n,t)+"[]":i.reduce(r(n),[]).join("&"):It(n,t)+"="+It(i,t)}).filter(e=>e.length>0).join("&")}function Rt(e,t){t={decode:!0,...t};let[n,r]=vt(e,"#");return void 0===n&&(n=e),{url:n?.split("?")?.[0]??"",query:At(xt(e),t),...t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:Et(r,t)}:{}}}function Pt(e,t){t={encode:!0,strict:!0,[bt]:!0,...t};const n=Ct(e.url).split("?")[0]||"";let r=Dt({...At(xt(e.url),{sort:!1,...t}),...e.query},t);r&&=`?${r}`;let i=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);if("string"==typeof e.fragmentIdentifier){const r=new URL(n);r.hash=e.fragmentIdentifier,i=t[bt]?r.hash:`#${e.fragmentIdentifier}`}return`${n}${r}${i}`}function jt(e,t,n){n={parseFragmentIdentifier:!0,[bt]:!1,...n};const{url:r,query:i,fragmentIdentifier:o}=Rt(e,n);return Pt({url:r,query:mt(i,t),fragmentIdentifier:o},n)}function Lt(e,t,n){return jt(e,Array.isArray(t)?e=>!t.includes(e):(e,n)=>!t(e,n),n)}const _t=t;function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mt.apply(null,arguments)}function Nt(e,t){return Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nt(e,t)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kt(e)}function Ut(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ut=function(){return!!e})()}function Ft(e){var t="function"==typeof Map?new Map:void 0;return Ft=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(Ut())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&Nt(i,n.prototype),i}(e,arguments,kt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Nt(n,e)},Ft(e)}function Bt(){var e;return(e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e]}var $t={symbols:{"*":{infix:{symbol:"*",f:function(e,t){return e*t},notation:"infix",precedence:4,rightToLeft:0,argCount:2},symbol:"*",regSymbol:"\\*"},"/":{infix:{symbol:"/",f:function(e,t){return e/t},notation:"infix",precedence:4,rightToLeft:0,argCount:2},symbol:"/",regSymbol:"/"},"+":{infix:{symbol:"+",f:function(e,t){return e+t},notation:"infix",precedence:2,rightToLeft:0,argCount:2},prefix:{symbol:"+",f:Bt,notation:"prefix",precedence:3,rightToLeft:0,argCount:1},symbol:"+",regSymbol:"\\+"},"-":{infix:{symbol:"-",f:function(e,t){return e-t},notation:"infix",precedence:2,rightToLeft:0,argCount:2},prefix:{symbol:"-",f:function(e){return-e},notation:"prefix",precedence:3,rightToLeft:0,argCount:1},symbol:"-",regSymbol:"-"},",":{infix:{symbol:",",f:function(){return Array.of.apply(Array,arguments)},notation:"infix",precedence:1,rightToLeft:0,argCount:2},symbol:",",regSymbol:","},"(":{prefix:{symbol:"(",f:Bt,notation:"prefix",precedence:0,rightToLeft:0,argCount:1},symbol:"(",regSymbol:"\\("},")":{postfix:{symbol:")",f:void 0,notation:"postfix",precedence:0,rightToLeft:0,argCount:1},symbol:")",regSymbol:"\\)"},min:{func:{symbol:"min",f:function(){return Math.min.apply(Math,arguments)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"min",regSymbol:"min\\b"},max:{func:{symbol:"max",f:function(){return Math.max.apply(Math,arguments)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"max",regSymbol:"max\\b"}}},Vt=$t;var Gt=function(e){var t,n;function r(t){return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this)}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,Nt(t,n),r}(Ft(Error)),Wt=/((?!\w)a|na|hc|mc|dg|me[r]?|xe|ni(?![a-zA-Z])|mm|cp|tp|xp|q(?!s)|hv|xamv|nimv|wv|sm|s(?!\D|$)|ged|darg?|nrut)/g;function Ht(e,t){var n,r=e.pop();return t.push(r.f.apply(r,(n=[]).concat.apply(n,t.splice(-r.argCount)))),r.precedence}function zt(e,t){var n,r=function(e){var t={};return t.symbols=e?Mt({},Vt.symbols,e.symbols):Mt({},Vt.symbols),t}(t),i=[r.symbols["("].prefix],o=[],s=new RegExp("\\d+(?:\\.\\d+)?|"+Object.keys(r.symbols).map(function(e){return r.symbols[e]}).sort(function(e,t){return t.symbol.length-e.symbol.length}).map(function(e){return e.regSymbol}).join("|")+"|(\\S)","g");s.lastIndex=0;var a=!1;do{var l=(n=s.exec(e))||[")",void 0],u=l[0],c=l[1],d=r.symbols[u],p=d&&!d.prefix&&!d.func,f=!d||!d.postfix&&!d.infix;if(c||(a?f:p))throw new Gt(37,n?n.index:e.length,e);if(a){var h=d.postfix||d.infix;do{var g=i[i.length-1];if((h.precedence-g.precedence||g.rightToLeft)>0)break}while(Ht(i,o));a="postfix"===h.notation,")"!==h.symbol&&(i.push(h),a&&Ht(i,o))}else if(d){if(i.push(d.prefix||d.func),d.func&&(!(n=s.exec(e))||"("!==n[0]))throw new Gt(38,n?n.index:e.length,e)}else o.push(+u),a=!0}while(n&&i.length);if(i.length)throw new Gt(39,n?n.index:e.length,e);if(n)throw new Gt(40,n?n.index:e.length,e);return o.pop()}function qt(e){return e.split("").reverse().join("")}function Jt(e,t){var n=qt(e),r=n.match(Wt);if(r&&!r.every(function(e){return e===r[0]}))throw new Gt(41);return""+zt(qt(n.replace(Wt,"")),t)+(r?qt(r[0]):"")}function Kt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Yt(e,t){return e.substr(-t.length)===t}var Xt=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function Qt(e){return"string"!=typeof e?e:e.match(Xt)?parseFloat(e):e}var Zt=function(e){return function(t,n){void 0===n&&(n="16px");var r=t,i=n;if("string"==typeof t){if(!Yt(t,"px"))throw new Gt(69,e,t);r=Qt(t)}if("string"==typeof n){if(!Yt(n,"px"))throw new Gt(70,e,n);i=Qt(n)}if("string"==typeof r)throw new Gt(71,t,e);if("string"==typeof i)throw new Gt(72,n,e);return""+r/i+e}},en=(Zt("em"),/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/);function tn(e){if("string"!=typeof e)return[e,""];var t=e.match(en);return t?[parseFloat(e),t[2]]:[e,void 0]}var nn=Zt("rem");function rn(e){return Math.round(255*e)}function on(e,t,n){return rn(e)+","+rn(t)+","+rn(n)}function sn(e,t,n,r){if(void 0===r&&(r=on),0===t)return r(n,n,n);var i=(e%360+360)%360/60,o=(1-Math.abs(2*n-1))*t,s=o*(1-Math.abs(i%2-1)),a=0,l=0,u=0;i>=0&&i<1?(a=o,l=s):i>=1&&i<2?(a=s,l=o):i>=2&&i<3?(l=o,u=s):i>=3&&i<4?(l=s,u=o):i>=4&&i<5?(a=s,u=o):i>=5&&i<6&&(a=o,u=s);var c=n-o/2;return r(a+c,l+c,u+c)}var an={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var ln=/^#[a-fA-F0-9]{6}$/,un=/^#[a-fA-F0-9]{8}$/,cn=/^#[a-fA-F0-9]{3}$/,dn=/^#[a-fA-F0-9]{4}$/,pn=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,fn=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,hn=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,gn=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function mn(e){if("string"!=typeof e)throw new Gt(3);var t=function(e){if("string"!=typeof e)return e;var t=e.toLowerCase();return an[t]?"#"+an[t]:e}(e);if(t.match(ln))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(un)){var n=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:n}}if(t.match(cn))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(dn)){var r=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:r}}var i=pn.exec(t);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var o=fn.exec(t.substring(0,50));if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10),alpha:parseFloat(""+o[4])>1?parseFloat(""+o[4])/100:parseFloat(""+o[4])};var s=hn.exec(t);if(s){var a="rgb("+sn(parseInt(""+s[1],10),parseInt(""+s[2],10)/100,parseInt(""+s[3],10)/100)+")",l=pn.exec(a);if(!l)throw new Gt(4,t,a);return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)}}var u=gn.exec(t.substring(0,50));if(u){var c="rgb("+sn(parseInt(""+u[1],10),parseInt(""+u[2],10)/100,parseInt(""+u[3],10)/100)+")",d=pn.exec(c);if(!d)throw new Gt(4,t,c);return{red:parseInt(""+d[1],10),green:parseInt(""+d[2],10),blue:parseInt(""+d[3],10),alpha:parseFloat(""+u[4])>1?parseFloat(""+u[4])/100:parseFloat(""+u[4])}}throw new Gt(5)}function vn(e){return function(e){var t,n=e.red/255,r=e.green/255,i=e.blue/255,o=Math.max(n,r,i),s=Math.min(n,r,i),a=(o+s)/2;if(o===s)return void 0!==e.alpha?{hue:0,saturation:0,lightness:a,alpha:e.alpha}:{hue:0,saturation:0,lightness:a};var l=o-s,u=a>.5?l/(2-o-s):l/(o+s);switch(o){case n:t=(r-i)/l+(r<i?6:0);break;case r:t=(i-n)/l+2;break;default:t=(n-r)/l+4}return t*=60,void 0!==e.alpha?{hue:t,saturation:u,lightness:a,alpha:e.alpha}:{hue:t,saturation:u,lightness:a}}(mn(e))}var yn=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e};function Sn(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function bn(e){return Sn(Math.round(255*e))}function wn(e,t,n){return yn("#"+bn(e)+bn(t)+bn(n))}function In(e,t,n){return sn(e,t,n,wn)}function En(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return In(e,t,n);if("object"==typeof e&&void 0===t&&void 0===n)return In(e.hue,e.saturation,e.lightness);throw new Gt(1)}function On(e,t,n,r){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r)return r>=1?In(e,t,n):"rgba("+sn(e,t,n)+","+r+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?In(e.hue,e.saturation,e.lightness):"rgba("+sn(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new Gt(2)}function Cn(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return yn("#"+Sn(e)+Sn(t)+Sn(n));if("object"==typeof e&&void 0===t&&void 0===n)return yn("#"+Sn(e.red)+Sn(e.green)+Sn(e.blue));throw new Gt(6)}function Tn(e,t,n,r){if("string"==typeof e&&"number"==typeof t){var i=mn(e);return"rgba("+i.red+","+i.green+","+i.blue+","+t+")"}if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r)return r>=1?Cn(e,t,n):"rgba("+e+","+t+","+n+","+r+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?Cn(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new Gt(7)}function xn(e){if("object"!=typeof e)throw new Gt(8);if(function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&"number"==typeof e.alpha}(e))return Tn(e);if(function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&("number"!=typeof e.alpha||void 0===e.alpha)}(e))return Cn(e);if(function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&"number"==typeof e.alpha}(e))return On(e);if(function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&("number"!=typeof e.alpha||void 0===e.alpha)}(e))return En(e);throw new Gt(8)}function An(e,t,n){return function(){var r=n.concat(Array.prototype.slice.call(arguments));return r.length>=t?e.apply(this,r):An(e,t,r)}}function Dn(e){return An(e,e.length,[])}Dn(function(e,t){if("transparent"===t)return t;var n=vn(t);return xn(Mt({},n,{hue:n.hue+parseFloat(e)}))});function Rn(e,t,n){return Math.max(e,Math.min(t,n))}var Pn=Dn(function(e,t){if("transparent"===t)return t;var n=vn(t);return xn(Mt({},n,{lightness:Rn(0,1,n.lightness-parseFloat(e))}))}),jn=Pn;Dn(function(e,t){if("transparent"===t)return t;var n=vn(t);return xn(Mt({},n,{saturation:Rn(0,1,n.saturation-parseFloat(e))}))});function Ln(e){if("transparent"===e)return 0;var t=mn(e),n=Object.keys(t).map(function(e){var n=t[e]/255;return n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}),r=n[0],i=n[1],o=n[2];return parseFloat((.2126*r+.7152*i+.0722*o).toFixed(3))}function _n(e,t){var n=Ln(e),r=Ln(t);return parseFloat((n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)).toFixed(2))}var Mn=Dn(function(e,t){if("transparent"===t)return t;var n=vn(t);return xn(Mt({},n,{lightness:Rn(0,1,n.lightness+parseFloat(e))}))}),Nn=Mn;var kn=Dn(function(e,t,n){if("transparent"===t)return n;if("transparent"===n)return t;if(0===e)return n;var r=mn(t),i=Mt({},r,{alpha:"number"==typeof r.alpha?r.alpha:1}),o=mn(n),s=Mt({},o,{alpha:"number"==typeof o.alpha?o.alpha:1}),a=i.alpha-s.alpha,l=2*parseFloat(e)-1,u=((l*a===-1?l:l+a)/(1+l*a)+1)/2,c=1-u;return Tn({red:Math.floor(i.red*u+s.red*c),green:Math.floor(i.green*u+s.green*c),blue:Math.floor(i.blue*u+s.blue*c),alpha:i.alpha*parseFloat(e)+s.alpha*(1-parseFloat(e))})}),Un=kn;Dn(function(e,t){if("transparent"===t)return t;var n=mn(t);return Tn(Mt({},n,{alpha:Rn(0,1,(100*("number"==typeof n.alpha?n.alpha:1)+100*parseFloat(e))/100)}))});var Fn="#000",Bn="#fff";Dn(function(e,t){if("transparent"===t)return t;var n=vn(t);return xn(Mt({},n,{saturation:Rn(0,1,n.saturation+parseFloat(e))}))});Dn(function(e,t){return"transparent"===t?t:xn(Mt({},vn(t),{hue:parseFloat(e)}))});Dn(function(e,t){return"transparent"===t?t:xn(Mt({},vn(t),{lightness:parseFloat(e)}))});Dn(function(e,t){return"transparent"===t?t:xn(Mt({},vn(t),{saturation:parseFloat(e)}))});var $n=Dn(function(e,t){return"transparent"===t?t:Un(parseFloat(e),"rgb(0, 0, 0)",t)}),Vn=$n;var Gn=Dn(function(e,t){return"transparent"===t?t:Un(parseFloat(e),"rgb(255, 255, 255)",t)}),Wn=Gn;Dn(function(e,t){if("transparent"===t)return t;var n=mn(t);return Tn(Mt({},n,{alpha:Rn(0,1,+(100*("number"==typeof n.alpha?n.alpha:1)-100*parseFloat(e)).toFixed(2)/100)}))});function Hn(e,t){var n,r,i=Kt(e);if(!t&&0!==t)throw new Gt(62);if("Top"===i||"Bottom"===i)return(n={})["border"+i+"RightRadius"]=t,n["border"+i+"LeftRadius"]=t,n;if("Left"===i||"Right"===i)return(r={})["borderTop"+i+"Radius"]=t,r["borderBottom"+i+"Radius"]=t,r;throw new Gt(63)}var zn=a(7927),qn=a(8221),Jn=a(7350);function Kn({skipOnMount:e=!1,refreshMode:t,refreshRate:n=1e3,refreshOptions:r,handleWidth:i=!0,handleHeight:o=!0,targetRef:s,observerOptions:a,onResize:l}={}){const u=(0,F.useRef)(e),c=(e=>{const t=F.useRef(e);return F.useEffect(()=>{t.current=e}),F.useMemo(()=>(...e)=>{var n;return null===(n=t.current)||void 0===n?void 0:n.call(t,...e)},[])})(l),[d,p]=(0,F.useState)({width:void 0,height:void 0}),{refProxy:f,refElement:h}=(e=>{const[t,n]=F.useState((null==e?void 0:e.current)||null);return e&&setTimeout(()=>{e.current!==t&&n(e.current)},0),{refProxy:F.useMemo(()=>new Proxy(e=>{e!==t&&n(e)},{get:(e,n)=>"current"===n?t:e[n],set:(e,t,r)=>("current"===t?n(r):e[t]=r,!0)}),[t]),refElement:t,setRefElement:n}})(s),{box:g}=a||{},m=(0,F.useCallback)(e=>{if(!i&&!o)return;if(u.current)return void(u.current=!1);e.forEach(e=>{const t=((e,t)=>{var n,r;const i=null===(n=e.borderBoxSize)||void 0===n?void 0:n[0],o=null===(r=e.contentBoxSize)||void 0===r?void 0:r[0];return"border-box"===t&&i?{width:i.inlineSize,height:i.blockSize}:"content-box"===t&&o?{width:o.inlineSize,height:o.blockSize}:{width:e.contentRect.width,height:e.contentRect.height}})(e,g);p(n=>((e,t)=>i&&e.width!==t.width||o&&e.height!==t.height)(n,t)?(null==c||c({width:t.width,height:t.height,entry:e}),t):n)})},[i,o,u,g]),v=(0,F.useCallback)(((e,t,n,r)=>{switch(t){case"debounce":return qn(e,n,r);case"throttle":return Jn(e,n,r);default:return e}})(m,t,n,r),[m,t,n,r]);return(0,F.useEffect)(()=>{let e;if(h)try{e=new window.ResizeObserver(v),e.observe(h,a)}catch(e){console.warn("ResizeObserver not supported or failed to initialize:",e)}else(d.width||d.height)&&(null==c||c({width:null,height:null,entry:null}),p({width:void 0,height:void 0}));return()=>{var t,n,r;null===(t=null==e?void 0:e.disconnect)||void 0===t||t.call(e),null===(r=(n=v).cancel)||void 0===r||r.call(n)}},[v,h]),Object.assign({ref:f},d)}const{useState:Yn,useEffect:Xn}=F,Qn=function(e){const{onResize:t,targetRef:n,refreshMode:r,refreshRate:i,handleWidth:o,handleHeight:s}=e,[a,l]=Yn({});return Xn(()=>{a&&Object.keys(a).length&&t(a)},[a]),Kn({onResize:e=>{l(e)},targetRef:n,refreshMode:r,refreshRate:i,handleWidth:o,handleHeight:s}),null};var Zn=a(4213),er=function(e,t){return er=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},er(e,t)};function tr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}er(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var nr=function(){return nr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},nr.apply(this,arguments)};function rr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;function ir(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;"function"==typeof SuppressedError&&SuppressedError;function or(e){return Object.keys(e).some(t=>{let n=e[t];if(!n)return!1;n&&n.toParam&&(n=n.toParam());switch(n.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function sr(e){const t={};return Object.keys(e).forEach(n=>{var r,i;let o=e[n];if(o&&o.toParam&&(o=o.toParam()),!o&&0!==o&&"boolean"!=typeof o&&"string"!=typeof o)return;let s;switch(o.constructor.name){case"Array":const e=null===(i=null===(r=o[0])||void 0===r?void 0:r.constructor)||void 0===i?void 0:i.name;s="Array"===e?o:"Object"===e?JSON.stringify(o):o.join(",");break;case"Object":s=JSON.stringify(o);break;case"Date":s=o.valueOf();break;case"Function":s=null;break;case"Boolean":s=o+"";break;default:s=o}(s||0===s||"string"==typeof s||Array.isArray(s))&&(t[n]=s)}),t}function ar(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map(t=>ar(e,t)).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function lr(e){const t=sr(e);return Object.keys(t).map(e=>ar(e,t[e])).join("&")}const ur=globalThis.FormData,cr=globalThis.File,dr=globalThis.Blob;function pr(e,t){const n=or(e)||t,r=sr(e);if(n){const e=new ur;return Object.keys(r).forEach(t=>{if("undefined"!=typeof Blob&&r[t]instanceof Blob){const n=r.fileName||r[t].name||t;e.append(t,r[t],n)}else e.append(t,r[t])}),e}return lr(e)}class fr extends Error{constructor(e,t,n,r,i){super(e);const o=new.target.prototype;Object.setPrototypeOf(this,o),e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=n,this.url=r,this.options=i}}const hr={noCorsDomains:[],crossOriginNoCorsDomains:{},pendingNoCorsRequests:{}},gr="ARCGIS_REST_JS_NO_CORS";globalThis[gr]||(globalThis[gr]=Object.assign({},hr));const mr=globalThis[gr];function vr(e){const t=new URL(e);e=t.origin+t.pathname,t.search.includes("f=json")&&(e+="?f=json");const n=t.origin;return mr.pendingNoCorsRequests[n]||(mr.pendingNoCorsRequests[n]=fetch(e,{mode:"no-cors",credentials:"include",cache:"no-store"}).then(e=>{-1===mr.noCorsDomains.indexOf(n)&&mr.noCorsDomains.push(n),mr.crossOriginNoCorsDomains[n.toLowerCase()]=Date.now(),delete mr.pendingNoCorsRequests[n]}).catch(e=>(delete mr.pendingNoCorsRequests[n],Promise.reject(new Error(`no-cors request to ${n} failed`))))),mr.pendingNoCorsRequests[n]}function yr(){return mr.noCorsDomains}function Sr(e){e.forEach(e=>{e=e.toLowerCase(),/^https?:\/\//.test(e)?br(e):(br("http://"+e),br("https://"+e))})}function br(e){const t=new URL(e).origin;-1===mr.noCorsDomains.indexOf(t)&&mr.noCorsDomains.push(t)}function wr(e){let t=!1;if(mr.noCorsDomains.length){const n=new URL(e).origin.toLowerCase();t=mr.noCorsDomains.some(e=>n.includes(e))}return t}function Ir(e){let t=!1;if(wr(e)){const n=new URL(e).origin.toLowerCase(),r=mr.crossOriginNoCorsDomains[n]||0;Date.now()-36e5>r&&(t=!0)}return t}function Er(e){console&&console.warn&&console.warn.apply(console,[e])}function Or(){return Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.Request})}const Cr="@esri/arcgis-rest-js";function Tr(e,t){e.authentication&&!t&&Er("You should not set `authentication` as a default in a shared environment such as a web server which will process multiple users requests. You can call `setDefaultRequestOptions` with `true` as a second argument to disable this warning."),globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS=e}function xr(){return globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}}}class Ar extends fr{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",n,r,i){super(e,t,n,r,i),this.name="ArcGISAuthError",this.message="AUTHENTICATION_ERROR_CODE"===t?e:`${t}: ${e}`;const o=new.target.prototype;Object.setPrototypeOf(this,o)}retry(e,t=1){let n=0;const r=(i,o)=>{n+=1,e(this.url,this.options).then(e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return Rr(this.url,t)}).then(e=>{i(e)}).catch(e=>{"ArcGISAuthError"===e.name&&n<t?r(i,o):e.name===this.name&&e.message===this.message&&n>=t?o(this):o(e)})};return new Promise((e,t)=>{r(e,t)})}}function Dr(e,t,n,r,i){if(e.code>=400){const{message:n,code:i}=e;throw new fr(n,i,e,t,r)}if(e.error){const{message:n,code:o,messageCode:s}=e.error,a=s||o||"UNKNOWN_ERROR_CODE";if(498===o||499===o)throw i||new Ar(n,a,e,t,r);throw new fr(n,a,e,t,r)}if("failed"===e.status||"failure"===e.status){let n,i="UNKNOWN_ERROR_CODE";try{n=JSON.parse(e.statusMessage).message,i=JSON.parse(e.statusMessage).code}catch(t){n=e.statusMessage||e.message}throw new fr(n,i,e,t,r)}return e}function Rr(e,t){const n=xr(),r=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},n),t),{params:Object.assign(Object.assign({},n.params),t.params),headers:Object.assign(Object.assign({},n.headers),t.headers)}),{httpMethod:i,rawResponse:o}=r,s=Object.assign({f:"json"},r.params);let a=null;const l={method:i,signal:r.signal,credentials:r.credentials||"same-origin"};let u;if(wr(e)&&(l.credentials="include"),r.headers&&r.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(l.credentials="include"),"string"==typeof r.authentication){const e=r.authentication;u={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)},r.authentication.startsWith("AAPK")||r.authentication.startsWith("AAPT")||r.authentication.startsWith("AATK")||r.authentication.startsWith("AAST")||r.suppressWarnings||globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING||(Er("Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information."),globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=!0)}else u=r.authentication;const c=e;let d=!1;"undefined"!=typeof window&&(d=function(e,t){var n;if((t||window)&&e){const r=null===(n=(t=t||window).location)||void 0===n?void 0:n.origin;return e.startsWith(r)}return!1}(e));const p=!d&&Ir(e);r.headers&&r.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(l.credentials="include");let f=Promise.resolve();return p&&(l.credentials="include",f=vr(e)),f.then(()=>u?u.getToken(e).catch(t=>(t.url=e,t.options=r,a=t,Promise.resolve(""))):Promise.resolve("")).then(t=>{t.length&&(s.token=t),u&&u.getDomainCredentials&&(l.credentials=u.getDomainCredentials(e));const n={};if("GET"===l.method){s.token&&r.hideToken&&"undefined"==typeof window&&(n["X-Esri-Authorization"]=`Bearer ${s.token}`,delete s.token);const i=""===lr(s)?e:e+"?"+lr(s);r.maxUrlLength&&i.length>r.maxUrlLength||!r.maxUrlLength&&i.length>2e3||s.token&&r.hideToken?(l.method="POST",t.length&&r.hideToken&&(s.token=t,delete n["X-Esri-Authorization"])):e=i}const i=new RegExp("/items/.+/updateResources").test(e);return"POST"===l.method&&(l.body=pr(s,i)),l.headers=Object.assign(Object.assign({},n),r.headers),("undefined"==typeof window||window&&void 0===window.document)&&!l.headers.referer&&(l.headers.referer=Cr),or(s)||i||(l.headers["Content-Type"]="application/x-www-form-urlencoded"),globalThis.fetch?globalThis.fetch(e,l):Or().then(({fetch:t})=>t(e,l))}).then(t=>{if(!t.ok)return t.json().then(n=>{const{status:i,statusText:o}=t,{message:s,details:a}=n.error,l=`${s}. ${a?a.join(" "):""}`.trim();throw new fr(l,`HTTP ${i} ${o}`,n,e,r)}).catch(n=>{if("ArcGISRequestError"===n.name)throw n;const{status:i,statusText:o}=t;throw new fr(o,`HTTP ${i}`,t,e,r)});if(o)return t;switch(s.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}}).then(t=>{if("json"!==s.f&&"geojson"!==s.f||o)return t;{const n=Dr(t,c,0,r,a);if(t&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(e)&&Array.isArray(t.authorizedCrossOriginNoCorsDomains)&&Sr(t.authorizedCrossOriginNoCorsDomains),a){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];r.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+864e5)},a=null}return n}})}function Pr(e,t={params:{f:"json"}}){const{request:n}=t,r=rr(t,["request"]);return n?n(e,r):Rr(e,r).catch(e=>e instanceof Ar&&t.authentication&&"string"!=typeof t.authentication&&t.authentication.canRefresh&&t.authentication.refreshCredentials?e.retry(()=>t.authentication.refreshCredentials(),1):Promise.reject(e))}function jr(e,t,n){const r=Object.assign(Object.assign({params:{}},n),e);return r.params=t.reduce((t,n)=>((e[n]||"boolean"==typeof e[n]||"number"==typeof e[n]&&0===e[n])&&(t[n]=e[n]),t),r.params),["params","httpMethod","rawResponse","authentication","hideToken","portal","credentials","maxUrlLength","headers","signal","suppressWarnings","request"].reduce((e,t)=>(r[t]&&(e[t]=r[t]),e),{})}var Lr,_r;!function(e){e.TOKEN_REFRESH_FAILED="TOKEN_REFRESH_FAILED",e.GENERATE_TOKEN_FOR_SERVER_FAILED="GENERATE_TOKEN_FOR_SERVER_FAILED",e.REFRESH_TOKEN_EXCHANGE_FAILED="REFRESH_TOKEN_EXCHANGE_FAILED",e.NOT_FEDERATED="NOT_FEDERATED",e.UNKNOWN_ERROR_CODE="UNKNOWN_ERROR_CODE"}(Lr||(Lr={}));class Mr extends Error{constructor(e="UNKNOWN_ERROR",t=Lr.UNKNOWN_ERROR_CODE,n,r,i){super(e);const o=new.target.prototype;Object.setPrototypeOf(this,o),this.name="ArcGISTokenRequestError",this.message=`${t}: ${e}`,this.originalMessage=e,this.code=t,this.response=n,this.url=r,this.options=i}}class Nr extends Error{constructor(){super("The user has denied your authorization request.");const e=new.target.prototype;Object.setPrototypeOf(this,e),this.name="ArcGISAccessDeniedError"}}class kr extends Error{constructor(e="Unknown error",t){super(e);const n=new.target.prototype;Object.setPrototypeOf(this,n),this.name="ArcGISJobError",this.message=`${t.status}: ${e}`,this.status=t.status,this.id=t.id,this.jobInfo=t}}function Ur(e){return"string"!=typeof e||"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}function Fr(e){const[t,n]=e.split("=");return{key:decodeURIComponent(t),value:decodeURIComponent(n)}}function Br(e){return!e||e.length<=0?{}:e.replace(/^#/,"").replace(/^\?/,"").split("&").reduce((e,t)=>{const{key:n,value:r}=Fr(t);return e[n]=r,e},{})}!function(e){e.ArcGISRequestError="ArcGISRequestError",e.ArcGISAuthError="ArcGISAuthError",e.ArcGISAccessDeniedError="ArcGISAccessDeniedError",e.ArcGISTokenRequestError="ArcGISTokenRequestError"}(_r||(_r={}));const $r=3e5;function Vr(e,t){const n=t;return n.rawResponse=!1,Pr(e,n).then(e=>{if("token"in e&&"expires"in e)return{token:e.token,username:t.params.username,expires:new Date(e.expires)};const n={token:e.access_token,username:e.username,expires:new Date(Date.now()+1e3*e.expires_in-$r),ssl:!0===e.ssl};return e.refresh_token&&(n.refreshToken=e.refresh_token),e.refresh_token_expires_in&&(n.refreshTokenExpires=new Date(Date.now()+1e3*e.refresh_token_expires_in-$r)),n})}class Gr{constructor(e){this.portal=e.portal?Ur(e.portal):"https://www.arcgis.com/sharing/rest",this._username=e.username}get username(){return this._username?this._username:this._user&&this._user.username?this._user.username:void 0}getUsername(){return this.username?Promise.resolve(this.username):this.getUser().then(e=>e.username)}getUser(e){if(this._pendingUserRequest)return this._pendingUserRequest;if(this._user)return Promise.resolve(this._user);{const t=`${this.portal}/community/self`,n=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingUserRequest=Pr(t,n).then(e=>(this._user=e,this._pendingUserRequest=null,e)),this._pendingUserRequest}}clearCachedUserInfo(){this._user=null}}class Wr extends Gr{constructor(e){super(e),this.clientId=e.clientId,this.clientSecret=e.clientSecret,this.token=e.token,this.expires=e.expires,this.portal=e.portal||"https://www.arcgis.com/sharing/rest",this.duration=e.duration||7200}static fromCredentials(e){return new Wr(e)}getToken(e,t){return this.token&&this.expires&&this.expires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequest||(this._pendingTokenRequest=this.refreshToken(t)),this._pendingTokenRequest)}refreshToken(e){const t=Object.assign({params:{client_id:this.clientId,client_secret:this.clientSecret,grant_type:"client_credentials",expiration:this.duration}},e);return Vr(`${this.portal}/oauth2/token/`,t).then(e=>(this._pendingTokenRequest=null,this.setToken(e.token),this.setExpires(e.expires),e.token)).catch(e=>{throw new Mr(e.message,Lr.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}refreshCredentials(){return this.clearCachedUserInfo(),this.refreshToken().then(()=>this)}toJSON(){return{type:"ApplicationCredentialsManager",clientId:this.clientId,clientSecret:this.clientSecret,token:this.token,expires:this.expires,portal:this.portal,duration:this.duration}}serialize(){return JSON.stringify(this.toJSON())}static deserialize(e){const t=JSON.parse(e);return new Wr({clientId:t.clientId,clientSecret:t.clientSecret,token:t.token,expires:new Date(t.expires),portal:t.portal,duration:t.duration})}setToken(e){this.token=e}setExpires(e){this.expires=e}}function Hr(e){return console.log("DEPRECATED: 'ApplicationSession' is deprecated. Use 'ApplicationCredentialsManager' instead."),new Wr(e)}class zr extends Gr{constructor(e){super(e),this.portal="https://www.arcgis.com/sharing/rest",this.key=e.key}static fromKey(e){return new zr("string"==typeof e?{key:e}:e)}get token(){return this.key}getToken(e){return Promise.resolve(this.key)}toJSON(){return{type:"ApiKeyManager",token:this.key,username:this.username,portal:this.portal}}serialize(){return JSON.stringify(this)}static deserialize(e){const t=JSON.parse(e);return new zr({key:t.token,username:t.username,portal:t.portal})}}function qr(e){return console.log("DEPRECATED:, 'ApiKey' is deprecated. Use 'ApiKeyManager' instead."),new zr(e)}const Jr=/^https?:\/\/(\S+)\.arcgis\.com.+/;function Kr(e){return Jr.test(e)}function Yr(e){if(!Jr.test(e))return e;switch(Xr(e)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}function Xr(e){if(!Jr.test(e))return null;const t=e.match(Jr)[1].split(".").pop();return t.includes("dev")?"dev":t.includes("qa")?"qa":"production"}function Qr(e,t){const n=Ur(Yr(t)).replace(/https?:\/\//,""),r=Ur(e).replace(/https?:\/\//,"");return new RegExp(r,"i").test(n)}function Zr(e,t){const n=Kr(e),r=Kr(t),i=Xr(e),o=Xr(t);return!(!n||!r||i!==o)}function ei(e,t,n="https://www.arcgis.com/sharing/rest"){return Pr(`${n}/oauth2/validateAppAccess`,{method:"POST",params:{f:"json",client_id:t,token:e}})}function ti(e){const t=`${Ur(e.portal||"https://www.arcgis.com/sharing/rest")}/oauth2/revokeToken/`,n=e.token,r=e.clientId;delete e.portal,delete e.clientId,delete e.token;const i=Object.assign(Object.assign({},e),{httpMethod:"POST",params:{client_id:r,auth_token:n}});return Pr(t,i).then(e=>{if(!e.success)throw new fr("Unable to revoke token",500,e,t,i);return e})}function ni(e,t=window){return!t&&window&&(t=window),t.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function ri(e){!e&&window&&(e=window);return ni(e.crypto.getRandomValues(new Uint8Array(32)))}function ii(e,t,n){return"string"!=typeof t&&t?JSON.stringify(Object.assign({id:e},t)):JSON.stringify({id:e,originalUrl:n})}class oi extends Gr{constructor(e){if(super(e),this.clientId=e.clientId,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this.password=e.password,this._token=e.token,this._tokenExpires=e.tokenExpires,this.portal=e.portal?Ur(e.portal):"https://www.arcgis.com/sharing/rest",this.ssl=e.ssl,this.provider=e.provider||"arcgis",this.tokenDuration=e.tokenDuration||20160,this.redirectUri=e.redirectUri,this.server=e.server,this.referer=e.referer,this.state=e.state,this.federatedServers={},this.trustedDomains=[],e.server){const t=this.getServerRootUrl(e.server);this.federatedServers[t]={token:e.token,expires:e.tokenExpires}}this._pendingTokenRequests={}}get token(){return this._token}get tokenExpires(){return this._tokenExpires}get refreshToken(){return this._refreshToken}get refreshTokenExpires(){return this._refreshTokenExpires}get canRefresh(){return!(!this.username||!this.password)||!!(this.clientId&&this.refreshToken&&this.redirectUri)}static beginOAuth2(e,t){!t&&window&&(t=window);const{portal:n,provider:r,clientId:i,expiration:o,redirectUri:s,popup:a,popupWindowFeatures:l,locale:u,params:c,style:d,pkce:p,state:f}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:!0,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",locale:"",style:"",pkce:!0},e),h=function(e,t){return"string"==typeof e?e:"object"==typeof e?e.id:ri(t)}(f,t),g=`ARCGIS_REST_JS_AUTH_STATE_${i}`;t.localStorage.setItem(g,h);let m=`${Ur(n)}/oauth2/authorize`;const v={client_id:i,response_type:p?"code":"token",expiration:o,redirect_uri:s,state:ii(h,f,t.location.href),locale:u,style:d};let y;if("arcgis"!==r&&(m=`${Ur(n)}/oauth2/social/authorize`,v.socialLoginProviderName=r,v.autoAccountCreateForSocial=!0),p){const e=ri(t),n=`ARCGIS_REST_JS_CODE_VERIFIER_${i}`;t.localStorage.setItem(n,e),y=function(e,t=window){if(!t&&window&&(t=window),e&&t.isSecureContext&&t.crypto&&t.crypto.subtle){const n=(new t.TextEncoder).encode(e);return t.crypto.subtle.digest("SHA-256",n).then(e=>ni(new Uint8Array(e),t))}return Promise.resolve(null)}(e,t).then(function(t){v.code_challenge_method=t?"S256":"plain",v.code_challenge=t||e})}else y=Promise.resolve();return y.then(()=>(m=`${m}?${lr(v)}`,c&&(m=`${m}&${lr(c)}`),a?new Promise((e,r)=>{t.addEventListener(`arcgis-rest-js-popup-auth-${i}`,t=>{if("access_denied"===t.detail.error){const e=new Nr;return r(e),e}if(t.detail.errorMessage){const e=new Ar(t.detail.errorMessage,t.detail.error);return r(e),e}e(new oi({clientId:i,portal:n,ssl:t.detail.ssl,token:t.detail.token,tokenExpires:t.detail.expires,username:t.detail.username,refreshToken:t.detail.refreshToken,refreshTokenExpires:t.detail.refreshTokenExpires,redirectUri:s,state:t.detail.state}))},{once:!0}),t.open(m,"oauth-window",l),t.dispatchEvent(new CustomEvent("arcgis-rest-js-popup-auth-start"))}):void(t.location.href=m)))}static completeOAuth2(e,t){!t&&window&&(t=window);const{portal:n,clientId:r,popup:i,pkce:o,redirectUri:s}=Object.assign({portal:"https://www.arcgis.com/sharing/rest",popup:!0,pkce:!0},e),a=`ARCGIS_REST_JS_AUTH_STATE_${r}`,l=t.localStorage.getItem(a),u=Br(o?t.location.search.replace(/^\?/,""):t.location.hash.replace(/^#/,"")),c=u&&u.state?JSON.parse(u.state):void 0;function d(e,n,o){return t.localStorage.removeItem(a),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${r}`,{detail:{error:n,errorMessage:e}})),void t.close()):(o&&t.history.replaceState(t.history.state,"",o),"access_denied"===n?Promise.reject(new Nr):Promise.reject(new Ar(e,n)))}function p(e,o){return t.localStorage.removeItem(a),i&&t.opener?(t.opener.dispatchEvent(new CustomEvent(`arcgis-rest-js-popup-auth-${r}`,{detail:Object.assign(Object.assign({},e),{state:o})})),void t.close()):(o.originalUrl&&t.history.replaceState(t.history.state,"",o.originalUrl),new oi({clientId:r,portal:n,ssl:e.ssl,token:e.token,tokenExpires:e.expires,username:e.username,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,redirectUri:s||location.href.replace(location.search,""),state:o}))}if(!l||!c)return d("No authentication state was found, call `ArcGISIdentityManager.beginOAuth2(...)` to start the authentication process.","no-auth-state");if(c.id!==l)return d("Saved client state did not match server sent state.","mismatched-auth-state");if(u.error){const e=u.error;return d(u.error_description||"Unknown error",e,c.originalUrl)}if(o&&u.code){const e=Ur(`${n}/oauth2/token/`),i=`ARCGIS_REST_JS_CODE_VERIFIER_${r}`,o=t.localStorage.getItem(i);return t.localStorage.removeItem(i),Vr(e,{httpMethod:"POST",params:{client_id:r,code_verifier:o,grant_type:"authorization_code",redirect_uri:s||location.href.replace(location.search,""),code:u.code}}).then(e=>p(Object.assign(Object.assign({},e),c),c)).catch(e=>d(e.originalMessage,e.code,c.originalUrl))}return!o&&u.access_token?Promise.resolve(p(Object.assign({token:u.access_token,expires:new Date(Date.now()+1e3*parseInt(u.expires_in,10)),ssl:"true"===u.ssl,username:u.username},c),c)):d("Unknown error","oauth-error",c.originalUrl)}static fromParent(e,t){let n;return!t&&window&&(t=window),new Promise((r,i)=>{n=e=>{if(e.source===t.parent&&e.data)try{return r(oi.parentMessageHandler(e))}catch(e){return i(e)}},t.addEventListener("message",n,!1),t.parent.postMessage({type:"arcgis:auth:requestCredential"},e)}).then(e=>(t.removeEventListener("message",n,!1),e))}static authorize(e,t){const{portal:n,clientId:r,expiration:i,redirectUri:o,state:s}=Object.assign({portal:"https://arcgis.com/sharing/rest",expiration:20160},e),a={client_id:r,expiration:i,response_type:"code",redirect_uri:o};s&&(a.state=s);const l=`${n}/oauth2/authorize?${lr(a)}`;t.writeHead(301,{Location:l}),t.end()}static exchangeAuthorizationCode(e,t){const{portal:n,clientId:r,redirectUri:i}=Object.assign({portal:"https://www.arcgis.com/sharing/rest"},e);return Vr(`${n}/oauth2/token`,{params:{grant_type:"authorization_code",client_id:r,redirect_uri:i,code:t}}).then(e=>new oi({clientId:r,portal:n,ssl:e.ssl,redirectUri:i,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,token:e.token,tokenExpires:e.expires,username:e.username})).catch(e=>{throw new Mr(e.message,Lr.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)})}static deserialize(e){const t=JSON.parse(e);return new oi({clientId:t.clientId,refreshToken:t.refreshToken,refreshTokenExpires:t.refreshTokenExpires?new Date(t.refreshTokenExpires):void 0,username:t.username,password:t.password,token:t.token,tokenExpires:t.tokenExpires?new Date(t.tokenExpires):void 0,portal:t.portal,ssl:t.ssl,tokenDuration:t.tokenDuration,redirectUri:t.redirectUri,server:t.server})}static fromCredential(e,t){const n=void 0===e.ssl||e.ssl,r=e.expires||Date.now()+72e5;return t.hasServer?new oi({server:e.server,ssl:n,token:e.token,username:e.userId,tokenExpires:new Date(r)}):new oi({portal:Ur(e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest"),ssl:n,token:e.token,username:e.userId,tokenExpires:new Date(r)})}static parentMessageHandler(e){if("arcgis:auth:credential"===e.data.type){const t=e.data.credential;return function(e){return"string"==typeof e.userId||"number"==typeof e.expires}(t)?oi.fromCredential(t,{hasPortal:!0,hasServer:!1,server:t.server}):new oi(t)}if("arcgis:auth:error"===e.data.type){const t=new Error(e.data.error.message);throw t.name=e.data.error.name,t}throw new Error("Unknown message type.")}static destroy(e){return ti({clientId:e.clientId,portal:e.portal,token:e.refreshToken||e.token})}static fromToken(e){const t=new oi(e);return t.getUser().then(()=>t)}static signIn(e){const t=new oi(e);return t.getUser().then(()=>t)}toCredential(){return{expires:this.tokenExpires.getTime(),server:this.server||this.portal,ssl:this.ssl,token:this.token,userId:this.username}}getPortal(e){if(this._pendingPortalRequest)return this._pendingPortalRequest;if(this._portalInfo)return Promise.resolve(this._portalInfo);{const t=`${this.portal}/portals/self`,n=Object.assign(Object.assign({httpMethod:"GET",authentication:this},e),{rawResponse:!1});return this._pendingPortalRequest=Pr(t,n).then(e=>(this._portalInfo=e,this._pendingPortalRequest=null,e)),this._pendingPortalRequest}}getToken(e,t){return Zr(this.portal,e)||new RegExp(this.portal,"i").test(e)?this.getFreshToken(t):this.getTokenForServer(e,t)}validateAppAccess(e){return this.getToken(this.portal).then(t=>ei(t,e))}toJSON(){return{type:"ArcGISIdentityManager",clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires||void 0,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires||void 0,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,server:this.server}}serialize(){return JSON.stringify(this)}enablePostMessageAuth(e,t){!t&&window&&(t=window),this._hostHandler=this.createPostMessageHandler(e),t.addEventListener("message",this._hostHandler,!1)}disablePostMessageAuth(e){!e&&window&&(e=window),e.removeEventListener("message",this._hostHandler,!1)}refreshCredentials(e){return this.clearCachedUserInfo(),this.username&&this.password?this.refreshWithUsernameAndPassword(e):this.clientId&&this.refreshToken?this.refreshWithRefreshToken():Promise.reject(new Mr("Unable to refresh token. No refresh token or password present.",Lr.TOKEN_REFRESH_FAILED))}getServerRootUrl(e){const[t]=Ur(e).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/),[n,r,i]=t.match(/(https?:\/\/)(.+)/),[o,...s]=i.split("/");return`${r}${o.toLowerCase()}/${s.join("/")}`}getDomainCredentials(e){return this.trustedDomains&&this.trustedDomains.length?(e=e.toLowerCase(),this.trustedDomains.some(t=>e.startsWith(t.toLowerCase()))?"include":"same-origin"):"same-origin"}signOut(){return oi.destroy(this)}createPostMessageHandler(e){return t=>{const n=e.indexOf(t.origin)>-1,r="arcgis:auth:requestCredential"===t.data.type,i=this.tokenExpires.getTime()>Date.now();if(n&&r){let e={};if(i){const t=this.toCredential();t.server=t.server.replace("/sharing/rest",""),e={type:"arcgis:auth:credential",credential:t}}else e={type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Token was expired, and not returned to the child application"}};t.source.postMessage(e,t.origin)}}}getTokenForServer(e,t){const n=this.getServerRootUrl(e),r=this.federatedServers[n];return r&&r.expires&&r.expires.getTime()>Date.now()?Promise.resolve(r.token):(this._pendingTokenRequests[n]||(this._pendingTokenRequests[n]=this.fetchAuthorizedDomains().then(()=>Pr(`${n}/rest/info`,{credentials:this.getDomainCredentials(e)}).then(r=>{if(r.owningSystemUrl){if(Qr(r.owningSystemUrl,this.portal))return Pr(`${r.owningSystemUrl}/sharing/rest/info`,t);throw new Mr(`${e} is not federated with ${this.portal}.`,Lr.NOT_FEDERATED)}if(r.authInfo&&void 0!==this.federatedServers[n])return Promise.resolve({authInfo:r.authInfo});throw new Mr(`${e} is not federated with any portal and is not explicitly trusted.`,Lr.NOT_FEDERATED)}).then(e=>this.token&&this.tokenExpires.getTime()<Date.now()?this.server?this.refreshCredentials().then(()=>({token:this.token,expires:this.tokenExpires})):this.refreshCredentials().then(()=>this.generateTokenForServer(e.authInfo.tokenServicesUrl,n)):this.generateTokenForServer(e.authInfo.tokenServicesUrl,n)).then(e=>(this.federatedServers[n]=e,delete this._pendingTokenRequests[n],e.token)))),this._pendingTokenRequests[n])}generateTokenForServer(e,t){return Pr(e,{params:{token:this.token,serverUrl:t,expiration:this.tokenDuration}}).then(e=>({token:e.token,expires:new Date(e.expires-3e5)})).catch(e=>{throw new Mr(e.message,Lr.GENERATE_TOKEN_FOR_SERVER_FAILED,e.response,e.url,e.options)})}getFreshToken(e){return this.token&&!this.tokenExpires||this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()?Promise.resolve(this.token):(this._pendingTokenRequests[this.portal]||(this._pendingTokenRequests[this.portal]=this.refreshCredentials(e).then(()=>(this._pendingTokenRequests[this.portal]=null,this.token))),this._pendingTokenRequests[this.portal])}refreshWithUsernameAndPassword(e){const t={username:this.username,password:this.password,expiration:this.tokenDuration,client:"referer",referer:this.referer?this.referer:"undefined"!=typeof window&&void 0!==window.document&&window.location&&window.location.origin?window.location.origin:Cr};return(this.server?Pr(`${this.getServerRootUrl(this.server)}/rest/info`).then(n=>Pr(n.authInfo.tokenServicesUrl,Object.assign({params:t},e))):Pr(`${this.portal}/generateToken`,Object.assign({params:t},e))).then(e=>(this.updateToken(e.token,new Date(e.expires)),this)).catch(e=>{throw new Mr(e.message,Lr.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}refreshWithRefreshToken(e){if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()-864e5<Date.now())return this.exchangeRefreshToken(e);const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},e);return Vr(`${this.portal}/oauth2/token`,t).then(e=>this.updateToken(e.token,e.expires)).catch(e=>{throw new Mr(e.message,Lr.TOKEN_REFRESH_FAILED,e.response,e.url,e.options)})}updateToken(e,t){return this._token=e,this._tokenExpires=t,this}exchangeRefreshToken(e){const t=Object.assign({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},e);return Vr(`${this.portal}/oauth2/token`,t).then(e=>(this._token=e.token,this._tokenExpires=e.expires,this._refreshToken=e.refreshToken,this._refreshTokenExpires=e.refreshTokenExpires,this)).catch(e=>{throw new Mr(e.message,Lr.REFRESH_TOKEN_EXCHANGE_FAILED,e.response,e.url,e.options)})}fetchAuthorizedDomains(){return this.server||!this.portal?Promise.resolve(this):this.getPortal().then(e=>(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length&&(this.trustedDomains=e.authorizedCrossOriginDomains.filter(e=>!e.startsWith("http://")).map(e=>e.startsWith("https://")?e:`https://${e}`)),this))}}function si(e){return console.log("DEPRECATED:, 'UserSession' is deprecated. Use 'ArcGISIdentityManager' instead."),new oi(e)}function ai(e,t,n="https://www.arcgis.com/sharing/rest"){return Pr(`${n}/oauth2/exchangeToken`,{method:"POST",params:{f:"json",client_id:t,token:e}}).then(e=>e.token)}function li(e,t,n="https://www.arcgis.com/sharing/rest"){return Pr(`${n}/oauth2/platformSelf?f=json`,{method:"POST",headers:{"X-Esri-Auth-Client-Id":e,"X-Esri-Auth-Redirect-Uri":t},params:{f:"json"}})}var ui;si.beginOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.beginOAuth2' is deprecated. Use 'ArcGISIdentityManager.beginOAuth2' instead."),oi.beginOAuth2(...e)},si.completeOAuth2=function(...e){return console.warn("DEPRECATED:, 'UserSession.completeOAuth2()' is deprecated. Use 'ArcGISIdentityManager.completeOAuth2()' instead."),e.length<=1&&console.warn("WARNING:, 'UserSession.completeOAuth2()' is now async and returns a promise the resolves to an instance of `ArcGISIdentityManager`."),oi.completeOAuth2(...e)},si.fromParent=function(...e){return console.warn("DEPRECATED:, 'UserSession.fromParent' is deprecated. Use 'ArcGISIdentityManager.fromParent' instead."),oi.fromParent(...e)},si.authorize=function(...e){return console.warn("DEPRECATED:, 'UserSession.authorize' is deprecated. Use 'ArcGISIdentityManager.authorize' instead."),oi.authorize(...e)},si.exchangeAuthorizationCode=function(...e){return console.warn("DEPRECATED:, 'UserSession.exchangeAuthorizationCode' is deprecated. Use 'ArcGISIdentityManager.exchangeAuthorizationCode' instead."),oi.exchangeAuthorizationCode(...e)},si.fromCredential=function(...e){return console.log("DEPRECATED:, 'UserSession.fromCredential' is deprecated. Use 'ArcGISIdentityManager.fromCredential' instead."),console.warn("WARNING:, 'UserSession.fromCredential' now requires a `ServerInfo` object from the JS API as a second parameter."),oi.fromCredential(...e)},si.deserialize=function(...e){return console.log("DEPRECATED:, 'UserSession.deserialize' is deprecated. Use 'ArcGISIdentityManager.deserialize' instead."),oi.deserialize(...e)},function(e){e.Success="Succeeded",e.Failed="Failed",e.Waiting="Waiting",e.Cancelled="Cancelled",e.Cancelling="Cancelling",e.New="New",e.Executing="Executing",e.Submitted="Submitted",e.Failure="Failure",e.TimedOut="TimedOut",e.Error="Error",e.Status="Etatus",e.Unknown="Unknown"}(ui||(ui={}));const ci={pollingRate:2e3,startMonitoring:!1};class di{constructor(e){this.executePoll=async()=>{let e;try{e=await this.getJobInfo()}catch(e){return void this.emitter.emit(ui.Error,e)}this.emitter.emit(ui.Status,e),this.emitter.emit(e.status,e)};const{url:t,id:n,pollingRate:r,authentication:i}=Object.assign(Object.assign({},ci),e);var o;this.url=t,this.id=n,this.authentication=i,this._pollingRate=r,this.emitter={all:o=o||new Map,on:function(e,t){var n=o.get(e);n?n.push(t):o.set(e,[t])},off:function(e,t){var n=o.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):o.set(e,[]))},emit:function(e,t){var n=o.get(e);n&&n.slice().map(function(e){e(t)}),(n=o.get("*"))&&n.slice().map(function(n){n(e,t)})}},e.startMonitoring&&this.startEventMonitoring(r)}static deserialize(e,t){const n=Object.assign(Object.assign(Object.assign({},ci),JSON.parse(e)),t);return Pr(`${n.url}/jobs/${n.id}`,{authentication:n.authentication}).then(()=>new di(n))}static fromExistingJob(e){const t=Object.assign(Object.assign({},ci),e);return Pr(`${Ur(t.url.replace(/\/submitJob\/?/,""))}/jobs/${t.id}`,{authentication:t.authentication}).then(()=>new di(t))}static submitJob(e){const{url:t,params:n,authentication:r,pollingRate:i,startMonitoring:o}=Object.assign(Object.assign({},ci),e),s=function(e){return Object.keys(e).reduce((t,n)=>{const r=e[n],i=r.constructor.name;return t[n]="Array"===i?JSON.stringify(r):r,t},{})}(n),a=Ur(t.replace(/\/submitJob\/?/,""));return Pr(a+"/submitJob",{params:s,authentication:r}).then(e=>new di({url:a,authentication:r,id:e.jobId,startMonitoring:o,pollingRate:i}))}get jobUrl(){return`${this.url}/jobs/${this.id}`}get isMonitoring(){return!!this.setIntervalHandler}get pollingRate(){return this._pollingRate}set pollingRate(e){this.stopEventMonitoring(),this.startEventMonitoring(e)}getJobInfo(){return Pr(this.jobUrl,{authentication:this.authentication}).then(e=>{const t=Object.assign({id:e.jobId,status:void 0},e);switch(delete t.jobId,delete t.jobStatus,e.jobStatus){case"esriJobCancelled":t.status=ui.Cancelled;break;case"esriJobCancelling":t.status=ui.Cancelling;break;case"esriJobNew":t.status=ui.New;break;case"esriJobWaiting":t.status=ui.Waiting;break;case"esriJobExecuting":t.status=ui.Executing;break;case"esriJobSubmitted":t.status=ui.Submitted;break;case"esriJobTimedOut":t.status=ui.TimedOut;break;case"esriJobFailed":t.status=ui.Failed;break;case"expectedFailure":t.status=ui.Failure;break;case"esriJobSucceeded":t.status=ui.Success}return t})}on(e,t){this.emitter.on(e,t)}once(e,t){const n=r=>{this.emitter.off(e,n),t(r)};this.emitter.on(e,n),t.__arcgis_job_once_original_function__=n}off(e,t){t.__arcgis_job_once_original_function__?this.emitter.off(e,t.__arcgis_job_once_original_function__):this.emitter.off(e,t)}async getResult(e){return this.waitForCompletion().then(t=>Pr(this.jobUrl+"/"+t.results[e].paramUrl,{authentication:this.authentication}))}toJSON(){return{id:this.id,url:this.url,startMonitoring:this.isMonitoring,pollingRate:this.pollingRate}}serialize(){return JSON.stringify(this)}async waitForCompletion(){const e=await this.getJobInfo();return e.status===ui.Success?Promise.resolve(e):e.status===ui.Cancelling||e.status===ui.Cancelled||e.status===ui.Failed||e.status===ui.Failure||e.status===ui.TimedOut?(this.stopInternalEventMonitoring(),Promise.reject(new kr("Job cancelled or failed.",e))):new Promise((e,t)=>{this.startInternalEventMonitoring(),this.once(ui.Cancelled,e=>{this.stopInternalEventMonitoring(),t(new kr("Job cancelled.",e))}),this.once(ui.TimedOut,e=>{this.stopInternalEventMonitoring(),t(new kr("Job timed out.",e))}),this.once(ui.Failed,e=>{this.stopInternalEventMonitoring(),t(new kr("Job failed.",e))}),this.once(ui.Success,t=>{this.stopInternalEventMonitoring(),e(t)})})}async getAllResults(){return this.waitForCompletion().then(e=>{const t=Object.keys(e.results),n=t.map(t=>Pr(this.jobUrl+"/"+e.results[t].paramUrl,{authentication:this.authentication}).then(e=>e));return Promise.all(n).then(e=>t.reduce((n,r,i)=>(n[t[i]]=e[i],n),{}))})}cancelJob(){return Pr(this.jobUrl+"/cancel",{authentication:this.authentication,params:{id:this.id,returnMessages:!1}}).then(e=>(this.emitter.emit("cancelled",e),e))}startInternalEventMonitoring(e=ci.pollingRate){this._pollingRate=e,this.isMonitoring||(this.setIntervalHandler=setInterval(this.executePoll,this.pollingRate))}stopInternalEventMonitoring(){this.isMonitoring&&!this.didUserEnableMonitoring&&clearTimeout(this.setIntervalHandler)}startEventMonitoring(e=ci.pollingRate){this._pollingRate=e,this.didUserEnableMonitoring=!0,this.isMonitoring||(this.setIntervalHandler=setInterval(this.executePoll,this.pollingRate))}stopEventMonitoring(){this.isMonitoring&&this.didUserEnableMonitoring&&clearTimeout(this.setIntervalHandler)}}function pi(e,t){return(...n)=>{const r="object"==typeof n[n.length-1]?Object.assign(Object.assign({},e),n.pop()):e;return t(...n,r)}}function fi(e={}){return e.portal?Ur(e.portal):e.authentication&&"string"!=typeof e.authentication?e.authentication.portal:"https://www.arcgis.com/sharing/rest"}function hi(e){return e.owner?Promise.resolve(e.owner):e.item&&e.item.owner?Promise.resolve(e.item.owner):e.authentication&&e.authentication.getUsername?e.authentication.getUsername():Promise.reject(new Error("Could not determine the owner of this item. Pass the `owner`, `item.owner`, or `authentication` option."))}function gi(e){return Array.isArray(e)&&Array.isArray(e[0])&&Array.isArray(e[1])}function mi(e){return e.join(",")}function vi(e){return hi(e).then(t=>{const n=e.folderId?`${fi(e)}/content/users/${t}/${e.folderId}/items/${e.item.id}/update`:`${fi(e)}/content/users/${t}/items/${e.item.id}/update`;return e.params=Object.assign(Object.assign({},e.params),e.item),e.params.extent&&gi(e.params.extent)&&(e.params.extent=mi(e.params.extent)),Pr(n,e)})}function yi(e){return hi(e).then(t=>{const n=`${fi(e)}/content/users/${t}/items/${e.id}/updateinfo`;return e.params=Object.assign({folderName:e.folderName,file:e.file},e.params),Pr(n,e)})}function Si(e){return hi(e).then(t=>{const n=`${fi(e)}/content/users/${t}/items/${e.id}/updateResources`;return e.params=Object.assign({file:e.resource,fileName:e.name,resourcesPrefix:e.prefix,text:e.content},e.params),void 0!==e.private&&(e.params.access=e.private?"private":"inherit"),Pr(n,e)})}function bi(e){return hi(e).then(t=>{const n=`${fi(e)}/content/users/${t}/items/${e.itemId}/move`;let r=e.folderId;return r||(r="/"),e.params=Object.assign({folder:r},e.params),Pr(n,e)})}function wi(e){const t=Object.assign({item:{id:e.id,text:e.text,file:e.file}},e);return delete t.id,delete t.data,vi(t)}function Ii(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/addRelationship`,jr(e,["originItemId","destinationItemId","relationshipType"],{params:Object.assign({},e.params)})))}function Ei(e){return hi(e).then(t=>{const n=`${fi(e)}/content/users/${t}/items/${e.id}/addResources`;return e.params=Object.assign({file:e.resource,fileName:e.name,resourcesPrefix:e.prefix,text:e.content,access:e.private?"private":"inherit"},e.params),Pr(n,e)})}const Oi=e=>{const{folderId:t,start:n=1,num:r=10,authentication:i}=e,o=t?`/${t}`:"";return hi(e).then(t=>`${fi(e)}/content/users/${t}${o}`).then(e=>Pr(e,{httpMethod:"GET",authentication:i,params:{start:n,num:r}}))};function Ci(e){return hi(e).then(t=>{const n=`${`${fi(e)}/content/users/${t}`}/createFolder`;return e.params=Object.assign({title:e.title},e.params),Pr(n,e)})}function Ti(e){return e.multipart&&!e.filename?Promise.reject(new Error("The filename is required for a multipart request.")):hi(e).then(t=>{const n=`${fi(e)}/content/users/${t}`;let r=`${n}/addItem`;e.folderId&&(r=`${n}/${e.folderId}/addItem`),e.params=Object.assign(Object.assign({},e.params),e.item),e.params.extent&&gi(e.params.extent)&&(e.params.extent=mi(e.params.extent));return Pr(r,jr(e,["owner","folderId","file","dataUrl","text","async","multipart","filename","overwrite"],{params:Object.assign({},e.params)}))})}function xi(e){return Ti(Object.assign({folderId:null},e))}const Ai=e=>{const{authentication:t,id:n,title:r,exportFormat:i,exportParameters:o}=e;return hi(e).then(t=>`${fi(e)}/content/users/${t}/export`).then(e=>Pr(e,{httpMethod:"POST",authentication:t,params:{itemId:n,title:r,exportFormat:i,exportParameters:o}}))},Di=/[\x00-\x1F\x7F-\x9F\xA0]/g;function Ri(e){return e.replace(Di,"")}function Pi(e,t){return Pr(ji(e,t),Object.assign({httpMethod:"GET"},t))}const ji=(e,t)=>`${"string"==typeof t?t:fi(t)}/content/items/${e}`;function Li(e,t){const n=`${ji(e,t)}/data`,r=Object.assign({httpMethod:"GET",params:{}},t);return r.file&&(r.params.f=null),Pr(n,r).catch(e=>{if(!RegExp(/The string did not match the expected pattern|(Unexpected end of (JSON input|data at line 1 column 1))/i).test(e.message))throw e})}function _i(e){const t=`${ji(e.id,e)}/relatedItems`,n=Object.assign({httpMethod:"GET",params:{direction:e.direction}},e);return"string"==typeof e.relationshipType?n.params.relationshipType=e.relationshipType:n.params.relationshipTypes=e.relationshipType,delete n.direction,delete n.relationshipType,Pr(t,n)}function Mi(e,t){const n=`${ji(e,t)}/resources`,r=Object.assign({},t);return r.params=Object.assign({num:1e3},r.params),Pr(n,r)}function Ni(e,t){const n=t.readAs||"blob";return Vi(e,`/resources/${t.fileName}`,n,t)}function ki(e,t){return Pr(`${ji(e,t)}/groups`,t)}function Ui(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/status`,jr(e,["jobId","jobType"],{params:Object.assign({},e.params)})))}function Fi(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/parts`,e))}function Bi(e,t){const{fileName:n="iteminfo.xml",readAs:r="text"}=t||{};return Vi(e,`/info/${n}`,r,Object.assign({httpMethod:"GET"},t))}function $i(e,t){return Bi(e,Object.assign(Object.assign({},t),{fileName:"metadata/metadata.xml"}))}function Vi(e,t,n,r){const i=`${ji(e,r)}${t}`,o=Object.assign({params:{}},r),s=o.rawResponse;return o.rawResponse=!0,o.params.f=null,Pr(i,o).then(e=>s?e:"json"!==n?e[n]():e.text().then(e=>JSON.parse(Ri(e))))}function Gi(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/protect`,e))}function Wi(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/unprotect`,e))}function Hi(e,t){return Pr(`${fi(t)}/community/groups/${e}`,Object.assign({httpMethod:"GET"},t))}function zi(e,t){return Pr(`${fi(t)}/community/groups/${e}/categorySchema`,Object.assign({httpMethod:"GET"},t))}function qi(e,t){const n=`${fi(t)}/content/groups/${e}`,r=Object.assign(Object.assign({httpMethod:"GET"},{params:{start:1,num:100}}),t);return t&&t.paging&&(r.params=Object.assign({},t.paging)),Pr(n,r)}function Ji(e,t){return Pr(`${fi(t)}/community/groups/${e}/users`,Object.assign({httpMethod:"GET"},t))}function Ki(e,t){return Pr(`${fi(t)}/community/groups/${e}/userlist`,jr(t||{},["name","num","start","sortField","sortOrder","joined","memberType"],{httpMethod:"GET"}))}function Yi(e,t){const n=t||e.authentication.username,r=e.owner||n;return`${fi(e)}/content/users/${encodeURIComponent(r)}/items/${e.id}/share`}function Xi(e,t){const n=t||e.authentication.username;return(e.owner||n)===n}function Qi(e){return e.authentication.getUser().then(e=>e&&"org_admin"===e.role&&!e.roleId)}function Zi(e){return Hi(e.groupId,e).then(e=>e.userMembership.memberType).catch(()=>"none")}function eo(e){return Qi(e).then(t=>{if(!t)throw Error(`Item ${e.id} can not be reassigned because current user is not an organization administrator.`);return Pr(`${fi(e)}/content/users/${e.currentOwner}/items/${e.id}/reassign`,{params:{targetUsername:e.targetUsername,targetFolderName:e.targetFolderName},authentication:e.authentication})})}function to(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/delete`,e))}function no(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/deleteRelationship`,jr(e,["originItemId","destinationItemId","relationshipType"],{params:Object.assign({},e.params)})))}function ro(e){return hi(e).then(t=>{const n=`${fi(e)}/content/users/${t}/items/${e.id}/removeResources`;return e.params=Object.assign(Object.assign({},e.params),{resource:e.resource}),void 0!==e.deleteAll&&(e.params.deleteAll=e.deleteAll),Pr(n,e)})}function io(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${encodeURIComponent(t)}/${e.folderId}/delete`,e))}function oo(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/deleteThumbnail`,e))}class so{constructor(e=""){this.termStack=[],this.rangeStack=[],this.openGroups=0,this.q=e}match(...e){return this.termStack=this.termStack.concat(e),this}in(e){const t=`\`in(${e?`"${e}"`:""})\``;return this.hasRange||this.hasTerms?(e&&"*"!==e&&(this.q+=`${e}:`),this.commit()):(Er(`${t} was called with no call to \`match(...)\` or \`from(...)\`/\`to(...)\`. Your query was not modified.`),this)}startGroup(){return this.commit(),this.openGroups>0&&(this.q+=" "),this.openGroups++,this.q+="(",this}endGroup(){return this.openGroups<=0?(Er("`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified."),this):(this.commit(),this.openGroups--,this.q+=")",this)}and(){return this.addModifier("and")}or(){return this.addModifier("or")}not(){return this.addModifier("not")}from(e){return this.hasTerms?(Er('`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01").  Your query was not modified.'),this):(this.rangeStack[0]=e,this)}to(e){return this.hasTerms?(Er('`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01"). Your query was not modified.'),this):(this.rangeStack[1]=e,this)}boost(e){return this.commit(),this.q+=`^${e}`,this}toParam(){return this.commit(),this.cleanup(),this.q}clone(){return this.commit(),this.cleanup(),new so(this.q+"")}addModifier(e){return this.currentModifer?(Er(`You have called \`${this.currentModifer}()\` after \`${e}()\`. Your current query was not modified.`),this):(this.commit(),""===this.q&&"not"!==e?(Er(`You have called \`${e}()\` without calling another method to modify your query first. Try calling \`match()\` first.`),this):(this.currentModifer=e,this.q+=""===this.q?"":" ",this.q+=`${e.toUpperCase()} `,this))}hasWhiteSpace(e){return/\s/g.test(e)}formatTerm(e){return e instanceof Date?e.getTime():"string"==typeof e&&this.hasWhiteSpace(e)?`"${e}"`:e}commit(){return this.currentModifer=void 0,this.hasRange&&(this.q+=`[${this.formatTerm(this.rangeStack[0])} TO ${this.formatTerm(this.rangeStack[1])}]`,this.rangeStack=[void 0,void 0]),this.hasTerms&&(this.q+=this.termStack.map(e=>this.formatTerm(e)).join(" "),this.termStack=[]),this}get hasTerms(){return this.termStack.length>0}get hasRange(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]}cleanup(){if(this.openGroups>0)for(Er(`Automatically closing ${this.openGroups} group(s). You can use \`endGroup(...)\` to remove this warning.`);this.openGroups>0;)this.q+=")",this.openGroups--;const e=this.q;this.q=e.replace(/( AND ?| NOT ?| OR ?)*$/,""),e!==this.q&&Er("`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified."),this.q=this.q.replace(/(\(\))*/,"")}}function ao(e,t){let n,r;switch(n="string"==typeof e||e instanceof so?{httpMethod:"GET",params:{q:e}}:jr(e,["q","num","start","sortField","sortOrder","searchUserAccess","searchUserName","filter","countFields","countSize","categories","categoryFilters"],{httpMethod:"GET"}),t){case"item":r="/search";break;case"group":r="/community/groups";break;case"groupContent":if("string"==typeof e||e instanceof so||!e.groupId)return Promise.reject(new Error("you must pass a `groupId` option to `searchGroupContent`"));r=`/content/groups/${e.groupId}/search`;break;case"communityUser":r="/community/users";break;default:r="/portals/self/users/search"}return Pr(fi(n)+r,n).then(n=>(n.nextStart&&-1!==n.nextStart&&(n.nextPage=function(){let r;return"string"==typeof e||e instanceof so?r={q:e,start:n.nextStart}:(r=e,r.start=n.nextStart),ao(r,t)}),n))}function lo(e){return ao(e,"item")}function uo(e){const t=e.partNum;return!Number.isInteger(t)||t<1||t>1e4?Promise.reject(new Error("The part number must be an integer between 1 to 10000, inclusive.")):hi(e).then(n=>Pr(`${fi(e)}/content/users/${n}/items/${e.id}/addPart?partNum=${t}`,jr(e,["file"],{params:Object.assign({},e.params)})))}function co(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/commit`,jr(e,[],{params:Object.assign(Object.assign({},e.params),e.item)})))}function po(e){return hi(e).then(t=>Pr(`${fi(e)}/content/users/${t}/items/${e.id}/cancel`,e))}function fo(e,t){if(0===e.length)return[];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function ho(e){const t=e.id,n=`${fi(e)}/community/groups/${t}/addUsers`,r=Object.assign({},e,{admins:void 0,users:void 0}),i=[...go("users",e.users,r),...go("admins",e.admins,r)].map(e=>function(e,t){return Pr(e,t).catch(e=>({errors:[e]}))}(n,e));return Promise.all(i).then(mo)}function go(e,t,n){if(!t||t.length<1)return[];return fo(t,25).map(t=>function(e,t,n){return Object.assign({},n,{[e]:t,params:Object.assign(Object.assign({},n.params),{[e]:t})})}(e,t,n))}function mo(e){const t=e.filter(e=>e.notAdded).reduce((e,t)=>e.concat(t.notAdded),[]),n=e.filter(e=>e.errors).reduce((e,t)=>e.concat(t.errors),[]),r={notAdded:t};return n.length>0&&(r.errors=n),r}function vo(e){const{id:t,users:n}=e,r=`${fi(e)}/community/groups/${t}/removeUsers`,i=fo(n,25).map(t=>(t=>{const n=Object.assign(Object.assign({},e),{users:t,params:{users:t}});return Pr(r,n).catch(e=>({errors:[e]}))})(t));return Promise.all(i).then(e=>{const t=t=>e.filter(e=>e[t]).reduce((e,n)=>e.concat(n[t]),[]),n=t("errors"),r={notRemoved:t("notRemoved")};return n.length?Object.assign(Object.assign({},r),{errors:n}):r})}function yo(e){const t=e.id,n=`${fi(e)}/community/groups/${t}/invite`,r=function(e){const t=fo(e.users,25);return t.map(t=>function(e,t){const n=Object.assign({},t);return n.params=Object.assign(Object.assign({},n.params),{users:e,role:n.role,expiration:n.expiration}),n}(t,e))}(e),i=r.map(e=>function(e,t){return Pr(e,t).catch(e=>({errors:[e]}))}(n,e));return Promise.all(i).then(So)}function So(e){const t=e.every(e=>e.success),n=e.reduce((e,t)=>e.concat(t.errors||[]),[]),r={success:t};return n.length>0&&(r.errors=n),r}function bo(e){const t=`${fi(e)}/community/createGroup`;return e.params=Object.assign(Object.assign({},e.params),e.group),Pr(t,e)}function wo(e){return Pr(`${fi(e)}/community/groups/${e.id}/createNotification`,Object.assign({params:Object.assign({subject:e.subject,message:e.message,users:e.users,notificationChannelType:e.notificationChannelType||"email",clientId:e.clientId,silentNotification:e.silentNotification,notifyAll:!e.users||0===e.users.length},e.params)},e))}function Io(e){return Pr(`${fi(e)}/community/groups/${e.id}/protect`,e)}function Eo(e){return Pr(`${fi(e)}/community/groups/${e.id}/unprotect`,e)}function Oo(e){return Pr(`${fi(e)}/community/groups/${e.id}/delete`,Object.assign({},e))}function Co(e){return ao(e,"group")}function To(e){return ao(e,"groupContent")}function xo(e){const t=`${fi(e)}/community/groups/${e.group.id}/update`;return e.params=Object.assign(Object.assign({},e.params),e.group),Pr(t,e)}function Ao(e){const t=`${fi(e)}/community/groups/${e.id}/updateUsers`,n={authentication:e.authentication,params:{}};return"admin"===e.newMemberType?n.params.admins=e.users:n.params.users=e.users,Pr(t,n)}function Do(e){return Pr(`${fi(e)}/community/groups/${e.id}/join`,e)}function Ro(e){return Pr(`${fi(e)}/community/groups/${e.id}/leave`,e)}function Po(e){const t=`${fi(e)}/portals/self/createNotification`,n=function(e){const t=fo(e.users,e.batchSize||25);return t.map(t=>function(e,t){const n=Object.assign({},t);return n.params=Object.assign(Object.assign({},n.params),{users:e,subject:t.subject,message:t.message,notificationChannelType:n.notificationChannelType}),n}(t,e))}(e),r=n.map(e=>function(e,t){return Pr(e,t).catch(e=>({errors:[e]}))}(t,e));return Promise.all(r).then(jo)}function jo(e){const t=e.every(e=>e.success),n=e.reduce((e,t)=>e.concat(t.errors||[]),[]),r={success:t};return n.length>0&&(r.errors=n),r}async function Lo(e){var t;return e.username?encodeURIComponent(e.username):(null===(t=e.authentication)||void 0===t?void 0:t.username)?encodeURIComponent(e.authentication.username):e.authentication?e.authentication.getUsername().then(encodeURIComponent):void 0}async function _o(e){let t,n={httpMethod:"GET"};if("string"==typeof e)t=`https://www.arcgis.com/sharing/rest/community/users/${e}`;else{const r=await Lo(e);t=`${fi(e)}/community/users/${r}`,n=Object.assign(Object.assign({},e),n)}return Pr(t,n)}async function Mo(e){const t=await Lo(e);return Pr(`${fi(e)}/community/users/${t}/tags`,e)}function No(e){return`${fi(e)}/community/users/${encodeURIComponent(e.username)}`}async function ko(e){let t={httpMethod:"GET"};const n=await Lo(e),r=`${fi(e)}/community/users/${n}/invitations`;return t=Object.assign(Object.assign({},e),t),Pr(r,t)}async function Uo(e){const t=await Lo(e),n=`${fi(e)}/community/users/${t}/invitations/${e.invitationId}`;let r={httpMethod:"GET"};return r=Object.assign(Object.assign({},e),r),Pr(n,r)}async function Fo(e){const t=await Lo(e);return Pr(`${fi(e)}/community/users/${t}/invitations/${e.invitationId}/accept`,Object.assign({},e))}async function Bo(e){const t=await Lo(e);return Pr(`${fi(e)}/community/users/${t}/invitations/${e.invitationId}/decline`,Object.assign({},e))}async function $o(e){let t={httpMethod:"GET"};const n=await Lo(e),r=`${fi(e)}/community/users/${n}/notifications`;return t=Object.assign(Object.assign({},e),t),Pr(r,t)}async function Vo(e){const t=await Lo(e);return Pr(`${fi(e)}/community/users/${t}/notifications/${e.id}/delete`,e)}function Go(e){return ao(e,"user")}function Wo(e){return ao(e,"communityUser")}async function Ho(e){const t=e.user.username||await e.authentication.getUsername(),n=`${fi(e)}/community/users/${encodeURIComponent(t)}/update`;return e.params=Object.assign(Object.assign({},e.user),e.params),delete e.user,Pr(n,e)}async function zo(e,t){const n=`${fi(t)}/community/users/${encodeURIComponent(e)}/properties`,r=await Pr(n,Object.assign({httpMethod:"GET"},t));return r.properties.mapViewer||(r.properties.mapViewer="modern"),r.properties}async function qo(e,t,n){const r=`${fi(n)}/community/users/${encodeURIComponent(e)}/setProperties`,i=Object.assign({httpMethod:"POST",params:{properties:t}},n);try{const e=await Pr(r,i);if(!e.success)throw new Error("Success was false");return e}catch(e){throw new Error(`Failed to set user properties: ${e.message}`)}}async function Jo(e){const t=await e.authentication.getUsername(),n=Yi(e,t);return Xi(e,t)?Ko(n,e):Qi(e).then(r=>{if(r)return Ko(n,e);throw Error(`This item can not be shared by ${t}. They are neither the item owner nor an organization admin.`)})}function Ko(e,t){return t.params=Object.assign({org:!1,everyone:!1},t.params),"private"===t.access&&(t.params.groups=" "),"org"===t.access&&(t.params.org=!0),"public"===t.access&&(t.params.account=!0,t.params.everyone=!0),Pr(e,t)}function Yo(e){return lo({q:`id: ${e.id} AND group: ${e.groupId}`,start:1,num:10,sortField:"title",authentication:e.authentication,httpMethod:"POST"}).then(t=>{let n=!1;if(t.total>0)return n=t.results.some(t=>t.id===e.id),n})}async function Xo(e){return Yo(e).then(async t=>{if(t)return{itemId:e.id,shortcut:!0,notSharedWith:[]};const{owner:n,confirmItemControl:r}=e,i=await e.authentication.getUsername(),o=n||i;if(o!==i){let t=!1,n=!1;return Promise.all([_o({username:i,authentication:e.authentication}),_o({username:o,authentication:e.authentication}),Zi(e)]).then(([i,o,s])=>{const a=!!r;return t="org_admin"===i.role&&!i.roleId,n=i.orgId!==o.orgId,function(e,t,n,r,i,o){const s=[];if(o.groupId!==e.favGroupId)if(t){if(!r)throw Error(`This item can not be shared to shared editing group ${o.groupId} by ${e.username} as they not the item owner or org admin.`);s.push(Zo(e,e,!1,`Error adding ${e.username} as member to edit group ${o.groupId}. Consequently item ${o.id} was not shared to the group.`,o),Zo(e,i,!0,"none"===n?`Error adding user ${i.username} to edit group ${o.groupId}. Consequently item ${o.id} was not shared to the group.`:`Error promoting user ${i.username} to admin in edit group ${o.groupId}. Consequently item ${o.id} was not shared to the group.`,o))}else if(r)s.push(Zo(e,e,!1,`Error adding ${e.username} as member to view group ${o.groupId}. Consequently item ${o.id} was not shared to the group.`,o));else if("none"===n)throw new Error(`This item can not be shared by ${e.username} as they are not a member of the specified group ${o.groupId}.`);return s}(i,a,s,t,o,e)}).then(r=>{const[{revert:i}={promise:Promise.resolve({notAdded:[]}),revert:e=>Promise.resolve(e)}]=r;return Promise.all(r.map(({promise:e})=>e)).then(()=>Qo(e,t,n)).then(e=>i(e))})}return Qo(e)}).then(t=>{if(t.notSharedWith.length)throw Error(`Item ${e.id} could not be shared to group ${e.groupId}.`);return t})}async function Qo(e,t=!1,n=!1){const r=await e.authentication.getUsername(),i=e.owner||r;let o=`${fi(e)}/content/items/${e.id}/share`;return(i===r||t&&!n)&&(o=`${fi(e)}/content/users/${i}/items/${e.id}/share`),e.params={groups:e.groupId,confirmItemControl:e.confirmItemControl},Pr(o,e)}function Zo(e,t,n,r,i){const o=t.groups||[],s=o.find(e=>e.id===i.groupId);if(e.orgId!==t.orgId)throw Error(`User ${t.username} is not a member of the same org as ${e.username}. Consequently they can not be added added to group ${i.groupId} nor can item ${i.id} be shared to the group.`);if(!s&&o.length>511)throw Error(`User ${t.username} already has 512 groups, and can not be added to group ${i.groupId}. Consequently item ${i.id} can not be shared to the group.`);let a,l;if(s)n&&"member"===s.userMembership.memberType?(a=Ao({id:i.groupId,users:[t.username],newMemberType:"admin",authentication:i.authentication}).then(e=>{const t=e.results.reduce((e,t)=>(t.success||e.push(t.username),e),[]);return Promise.resolve({notAdded:t})}).catch(()=>({notAdded:[t.username]})),l=e=>Ao({id:i.groupId,users:[t.username],newMemberType:"member",authentication:i.authentication}).then(()=>e).catch(()=>e)):(a=Promise.resolve({notAdded:[]}),l=e=>Promise.resolve(e));else{const e=n?"admins":"users";a=ho({id:i.groupId,[e]:[t.username],authentication:i.authentication}).then(e=>{if(e.errors&&e.errors.length)throw e.errors[0];return e}).catch(()=>({notAdded:[t.username]})),l=e=>vo({id:i.groupId,users:[t.username],authentication:i.authentication}).then(()=>e)}return{promise:a.then(e=>{if(e.notAdded.length)throw new Error(r);return e}),revert:l}}function es(e){return Yo(e).then(async t=>{if(!t)return Promise.resolve({itemId:e.id,shortcut:!0,notUnsharedFrom:[]});const{owner:n}=e,r=await e.authentication.getUsername();return Promise.all([Zi(e),_o({username:r,authentication:e.authentication})]).then(([t,i])=>{const o=(n||r)===r,s="org_admin"===i.role&&!i.roleId;if(!o&&!s&&["admin","owner"].indexOf(t)<0)throw Error(`This item can not be unshared from group ${e.groupId} by ${r} as they not the item owner, an org admin, group admin or group owner.`);return async function(e){const t=await e.authentication.getUsername(),n=e.owner||t;let r=`${fi(e)}/content/items/${e.id}/unshare`;n===t&&(r=`${fi(e)}/content/users/${n}/items/${e.id}/unshare`);return e.params={groups:e.groupId},Pr(r,e)}(e)}).then(t=>{if(t.notUnsharedFrom.length)throw Error(`Item ${e.id} could not be unshared to group ${e.groupId}`);return t})})}function ts(e,t,n){return Pr(`${n.portal}/portals/self/isServiceNameAvailable`,{params:{name:e,type:t},httpMethod:"GET",authentication:n})}function ns(e,t,n,r){let i=e;return r&&(i=`${e}_${r}`),ts(i,t,n).then(o=>o.available?i:ns(e,t,n,r+=1))}function rs(e){return is(null,e)}function is(e,t){const n=e||"self";return Pr(`${fi(t)}/portals/${n}`,Object.assign({httpMethod:"GET"},t))}function os(e,t){const n=e||"self";return Pr(`${fi(t)}/portals/${n}/settings`,Object.assign({httpMethod:"GET"},t))}function ss(e){return Pr(`${Ur(e.url)}/addFeatures`,jr(e,["features","gdbVersion","returnEditMoment","rollbackOnFailure"],{params:Object.assign({},e.params)}))}function as(e){const t=Object.assign({params:{}},e);return t.params.attachment=e.attachment,Pr(`${Ur(t.url)}/${t.featureId}/addAttachment`,t)}function ls(e,t){const n=`${Ur(e).replace("/rest/services","/rest/admin/services")}/addToDefinition`;return t.params=Object.assign({addToDefinition:{}},t.params),t.layers&&t.layers.length>0&&(t.params.addToDefinition.layers=t.layers),t.tables&&t.tables.length>0&&(t.params.addToDefinition.tables=t.tables),Pr(n,t)}function us(e){return Pr(`${Ur(e.url)}/applyEdits`,jr(e,["adds","updates","deletes","useGlobalIds","attachments","gdbVersion","returnEditMoment","rollbackOnFailure","trueCurveClient"],{params:Object.assign({},e.params)}))}function cs(e){return hi(e).then(t=>{const n=Object.assign(Object.assign({},e),{rawResponse:!1}),r=`${`${fi(e)}/content/users/${t}`}${n.folderId&&"/"!==n.folderId?"/"+n.folderId:""}/createService`;return n.params=Object.assign({createParameters:n.item,outputType:"featureService"},n.params),Pr(r,n)})}function ds(e){return Pr(Ur(e.url),e)}function ps(e){let t;return t=e.fields?Promise.resolve(e.fields):ds({url:e.url}).then(e=>e.fields),t.then(t=>{const n=function(e){return e.reduce((e,t)=>{const n=t.domain;return n&&"codedValue"===n.type&&(e[t.name]=n),e},{})}(t);if(Object.keys(n).length<1)return e.queryResponse;const r=e.queryResponse.features.map(e=>{const t={};for(const r in e.attributes){if(!Object.prototype.hasOwnProperty.call(e.attributes,r))continue;const i=e.attributes[r],o=n[r];t[r]=null!==i&&o?fs(i,o):i}return Object.assign(Object.assign({},e),{attributes:t})});return Object.assign(Object.assign({},e.queryResponse),{features:r})})}function fs(e,t){const n=t.codedValues.find(t=>e===t.code);return n?n.name:e}function hs(e){return Pr(`${Ur(e.url)}/deleteFeatures`,jr(e,["where","objectIds","gdbVersion","returnEditMoment","rollbackOnFailure"],{params:Object.assign({},e.params)}))}function gs(e){const t=Object.assign({params:{}},e);return t.params.attachmentIds=e.attachmentIds,Pr(`${Ur(t.url)}/${t.featureId}/deleteAttachments`,t)}const ms=new RegExp(/.+(?:map|feature|image)server/i);function vs(e){const t=e.match(ms);return t?t[0]:function(e){const t=e.split("?")[0];return Ur(t)}(e)}function ys(e){const{url:t}=e,n=rr(e,["url"]);return Pr(`${vs(t)}/layers`,n)}function Ss(e){const t=Object.assign({httpMethod:"GET"},e);return Pr(`${Ur(t.url)}/${t.featureId}/attachments`,t)}function bs(e){return Pr(Ur(e.url),e)}function ws(e,t){return Pr(e.replace("/rest/services","/rest/admin/services"),{authentication:t,params:{f:"json"}})}function Is(e,t){return Pr(`${e}/sources`,{authentication:t})}function Es(e){const t=`${Ur(e.url)}/${e.id}`,n=Object.assign({httpMethod:"GET"},e);return Pr(t,n).then(e=>n.rawResponse?e:e.feature)}function Os(e){const t=jr(e,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"],{httpMethod:"GET",params:Object.assign({where:"1=1",outFields:"*"},e.params)});return Pr(`${Ur(e.url)}/query`,t)}async function Cs(e){var t,n;let r=0,i=!0,o=null;const s=(await Pr(e.url,{httpMethod:"GET"})).maxRecordCount||2e3,a=null===(t=e.params)||void 0===t?void 0:t.resultRecordCount,l=a&&a<=s?a:s;for(;i;){const t=Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({where:"1=1",outFields:"*"},e.params||{}),{resultOffset:r,resultRecordCount:l})}),a=jr(t,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","resultType","historicMoment","returnTrueCurves","sqlFormat","f"],{httpMethod:"GET",params:Object.assign({where:"1=1",outFields:"*",returnExceededLimitFeatures:!0},t.params)}),u=await Pr(`${Ur(e.url)}/query`,a);o?o.features=o.features.concat(u.features):o=Object.assign({},u);const c=u.features.length,d=u.exceededTransferLimit||(null===(n=u.properties)||void 0===n?void 0:n.exceededTransferLimit);c<s||!d?i=!1:r+=s}return o}function Ts(e){const t=jr(e,["objectIds","relationshipId","definitionExpression","outFields"],{httpMethod:"GET",params:Object.assign({definitionExpression:"1=1",outFields:"*",relationshipId:0},e.params)});return Pr(`${Ur(e.url)}/queryRelatedRecords`,t)}function xs(e){return Pr(`${Ur(e.url)}/updateFeatures`,jr(e,["features","gdbVersion","returnEditMoment","rollbackOnFailure","trueCurveClient"],{params:Object.assign({},e.params)}))}function As(e){const t=Object.assign({params:{}},e);return t.params.attachment=e.attachment,t.params.attachmentId=e.attachmentId,Pr(`${Ur(t.url)}/${t.featureId}/updateAttachment`,t)}function Ds(e,t){const n=`${Ur(e).replace("/rest/services","/rest/admin/services")}/updateDefinition`;return t.params=Object.assign({updateDefinition:{}},t.params),t.updateDefinition&&(t.params.updateDefinition=t.updateDefinition),Pr(n,t)}var Rs=function(){return Rs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Rs.apply(this,arguments)},Ps={exports:{}},js={},Ls={exports:{}},_s={};function Ms(){var e={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return e}var Ns=/javascript\s*\:/gim;_s.whiteList=Ms(),_s.getDefaultWhiteList=Ms,_s.onAttr=function(e,t,n){},_s.onIgnoreAttr=function(e,t,n){},_s.safeAttrValue=function(e,t){return Ns.test(t)?"":t};var ks={indexOf:function(e,t){var n,r;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var r,i;if(Array.prototype.forEach)return e.forEach(t,n);for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}};var Us=function(e,t){";"!==(e=ks.trimRight(e))[e.length-1]&&(e+=";");var n=e.length,r=!1,i=0,o=0,s="";function a(){if(!r){var n=ks.trim(e.slice(i,o)),a=n.indexOf(":");if(-1!==a){var l=ks.trim(n.slice(0,a)),u=ks.trim(n.slice(a+1));if(l){var c=t(i,s.length,l,u,n);c&&(s+=c+"; ")}}}i=o+1}for(;o<n;o++){var l=e[o];if("/"===l&&"*"===e[o+1]){var u=e.indexOf("*/",o+2);if(-1===u)break;i=(o=u+1)+1,r=!1}else"("===l?r=!0:")"===l?r=!1:";"===l?r||a():"\n"===l&&a()}return ks.trim(s)},Fs=_s,Bs=Us;function $s(e){return null==e}function Vs(e){(e=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{})).whiteList=e.whiteList||Fs.whiteList,e.onAttr=e.onAttr||Fs.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||Fs.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||Fs.safeAttrValue,this.options=e}Vs.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,n=t.whiteList,r=t.onAttr,i=t.onIgnoreAttr,o=t.safeAttrValue,s=Bs(e,function(e,t,s,a,l){var u=n[s],c=!1;if(!0===u?c=u:"function"==typeof u?c=u(a):u instanceof RegExp&&(c=u.test(a)),!0!==c&&(c=!1),a=o(s,a)){var d,p={position:t,sourcePosition:e,source:l,isWhite:c};return c?$s(d=r(s,a,p))?s+":"+a:d:$s(d=i(s,a,p))?void 0:d}});return s};var Gs=Vs;!function(e,t){var n=_s,r=Gs;for(var i in(t=e.exports=function(e,t){return new r(t).process(e)}).FilterCSS=r,n)t[i]=n[i]}(Ls,Ls.exports);var Ws=Ls.exports,Hs={indexOf:function(e,t){var n,r;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var r,i;if(Array.prototype.forEach)return e.forEach(t,n);for(r=0,i=e.length;r<i;r++)t.call(n,e[r],r,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1}},zs=Ws.FilterCSS,qs=Ws.getDefaultWhiteList,Js=Hs;function Ks(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var Ys=new zs;function Xs(e){return e.replace(Qs,"&lt;").replace(Zs,"&gt;")}var Qs=/</g,Zs=/>/g,ea=/"/g,ta=/&quot;/g,na=/&#([a-zA-Z0-9]*);?/gim,ra=/&colon;?/gim,ia=/&newline;?/gim,oa=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,sa=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,aa=/u\s*r\s*l\s*\(.*/gi;function la(e){return e.replace(ea,"&quot;")}function ua(e){return e.replace(ta,'"')}function ca(e){return e.replace(na,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function da(e){return e.replace(ra,":").replace(ia," ")}function pa(e){for(var t="",n=0,r=e.length;n<r;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return Js.trim(t)}function fa(e){return e=pa(e=da(e=ca(e=ua(e))))}function ha(e){return e=Xs(e=la(e))}js.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},js.getDefaultWhiteList=Ks,js.onTag=function(e,t,n){},js.onIgnoreTag=function(e,t,n){},js.onTagAttr=function(e,t,n){},js.onIgnoreTagAttr=function(e,t,n){},js.safeAttrValue=function(e,t,n,r){if(n=fa(n),"href"===t||"src"===t){if("#"===(n=Js.trim(n)))return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"tel:"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&"ftp://"!==n.substr(0,6)&&"./"!==n.substr(0,2)&&"../"!==n.substr(0,3)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(oa.lastIndex=0,oa.test(n))return""}else if("style"===t){if(sa.lastIndex=0,sa.test(n))return"";if(aa.lastIndex=0,aa.test(n)&&(oa.lastIndex=0,oa.test(n)))return"";!1!==r&&(n=(r=r||Ys).process(n))}return n=ha(n)},js.escapeHtml=Xs,js.escapeQuote=la,js.unescapeQuote=ua,js.escapeHtmlEntities=ca,js.escapeDangerHtml5Entities=da,js.clearNonPrintableCharacter=pa,js.friendlyAttrValue=fa,js.escapeAttrValue=ha,js.onIgnoreTagStripAll=function(){return""},js.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var n=!Array.isArray(e),r=[],i=!1;return{onIgnoreTag:function(o,s,a){if(function(t){return!!n||-1!==Js.indexOf(e,t)}(o)){if(a.isClosing){var l="[/removed]",u=a.position+10;return r.push([!1!==i?i:a.position,u]),i=!1,l}return i||(i=a.position),"[removed]"}return t(o,s,a)},remove:function(e){var t="",n=0;return Js.forEach(r,function(r){t+=e.slice(n,r[0]),n=r[1]}),t+=e.slice(n)}}},js.stripCommentTag=function(e){for(var t="",n=0;n<e.length;){var r=e.indexOf("\x3c!--",n);if(-1===r){t+=e.slice(n);break}t+=e.slice(n,r);var i=e.indexOf("--\x3e",r);if(-1===i)break;n=i+3}return t},js.stripBlankChar=function(e){var t=e.split("");return(t=t.filter(function(e){var t=e.charCodeAt(0);return 127!==t&&(!(t<=31)||(10===t||13===t))})).join("")},js.cssFilter=Ys,js.getDefaultCSSWhiteList=qs;var ga={},ma=Hs;function va(e){var t,n=ma.spaceIndex(e);return t=-1===n?e.slice(1,-1):e.slice(1,n+1),"/"===(t=ma.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}function ya(e){return"</"===e.slice(0,2)}var Sa=/[^a-zA-Z0-9\\_:.-]/gim;function ba(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}}function wa(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"'"===n||'"'===n?t:-1}}function Ia(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}}function Ea(e){return function(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]}(e)?e.substr(1,e.length-2):e}ga.parseTag=function(e,t,n){var r="",i=0,o=!1,s=!1,a=0,l=e.length,u="",c="";e:for(a=0;a<l;a++){var d=e.charAt(a);if(!1===o){if("<"===d){o=a;continue}}else if(!1===s){if("<"===d){r+=n(e.slice(i,a)),o=a,i=a;continue}if(">"===d){r+=n(e.slice(i,o)),u=va(c=e.slice(o,a+1)),r+=t(o,r.length,u,c,ya(c)),i=a+1,o=!1;continue}if('"'===d||"'"===d)for(var p=1,f=e.charAt(a-p);""===f.trim()||"="===f;){if("="===f){s=d;continue e}f=e.charAt(a-++p)}}else if(d===s){s=!1;continue}}return i<e.length&&(r+=n(e.substr(i))),r},ga.parseAttr=function(e,t){var n=0,r=0,i=[],o=!1,s=e.length;function a(e,n){if(!((e=(e=ma.trim(e)).replace(Sa,"").toLowerCase()).length<1)){var r=t(e,n||"");r&&i.push(r)}}for(var l=0;l<s;l++){var u,c=e.charAt(l);if(!1!==o||"="!==c)if(!1===o||l!==r)if(/\s|\n|\t/.test(c)){if(e=e.replace(/\s|\n|\t/g," "),!1===o){if(-1===(u=ba(e,l))){a(ma.trim(e.slice(n,l))),o=!1,n=l+1;continue}l=u-1;continue}if(-1===(u=Ia(e,l-1))){a(o,Ea(ma.trim(e.slice(n,l)))),o=!1,n=l+1;continue}}else;else{if(-1===(u=e.indexOf(c,l+1)))break;a(o,ma.trim(e.slice(r+1,u))),o=!1,n=(l=u)+1}else o=e.slice(n,l),n=l+1,r='"'===e.charAt(n)||"'"===e.charAt(n)?n:wa(e,l+1)}return n<e.length&&(!1===o?a(e.slice(n)):a(o,Ea(ma.trim(e.slice(n))))),ma.trim(i.join(" "))};var Oa=Ws.FilterCSS,Ca=js,Ta=ga,xa=Ta.parseTag,Aa=Ta.parseAttr,Da=Hs;function Ra(e){return null==e}function Pa(e){(e=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{})).stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=Ca.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=function(e){var t={};for(var n in e)Array.isArray(e[n])?t[n.toLowerCase()]=e[n].map(function(e){return e.toLowerCase()}):t[n.toLowerCase()]=e[n];return t}(e.whiteList||e.allowList):e.whiteList=Ca.whiteList,e.onTag=e.onTag||Ca.onTag,e.onTagAttr=e.onTagAttr||Ca.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||Ca.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||Ca.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||Ca.safeAttrValue,e.escapeHtml=e.escapeHtml||Ca.escapeHtml,this.options=e,!1===e.css?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new Oa(e.css))}Pa.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t=this.options,n=t.whiteList,r=t.onTag,i=t.onIgnoreTag,o=t.onTagAttr,s=t.onIgnoreTagAttr,a=t.safeAttrValue,l=t.escapeHtml,u=this.cssFilter;t.stripBlankChar&&(e=Ca.stripBlankChar(e)),t.allowCommentTag||(e=Ca.stripCommentTag(e));var c=!1;t.stripIgnoreTagBody&&(c=Ca.StripTagBody(t.stripIgnoreTagBody,i),i=c.onIgnoreTag);var d=xa(e,function(e,t,c,d,p){var f={sourcePosition:e,position:t,isClosing:p,isWhite:Object.prototype.hasOwnProperty.call(n,c)},h=r(c,d,f);if(!Ra(h))return h;if(f.isWhite){if(f.isClosing)return"</"+c+">";var g=function(e){var t=Da.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=Da.trim(e.slice(t+1,-1)))[e.length-1];return n&&(e=Da.trim(e.slice(0,-1))),{html:e,closing:n}}(d),m=n[c],v=Aa(g.html,function(e,t){var n=-1!==Da.indexOf(m,e),r=o(c,e,t,n);return Ra(r)?n?(t=a(c,e,t,u))?e+'="'+t+'"':e:Ra(r=s(c,e,t,n))?void 0:r:r});return d="<"+c,v&&(d+=" "+v),g.closing&&(d+=" /"),d+=">"}return Ra(h=i(c,d,f))?l(d):h},l);return c&&(d=c.remove(d)),d};var ja=Pa;!function(e,t){var n=js,r=ga,i=ja;function o(e,t){return new i(t).process(e)}(t=e.exports=o).filterXSS=o,t.FilterXSS=i,function(){for(var e in n)t[e]=n[e];for(var i in r)t[i]=r[i]}(),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=e.exports)}(Ps,Ps.exports);var La,_a,Ma,Na,ka,Ua,Fa,Ba,$a,Va=Ps.exports,Ga=function(){function e(e,t){var n,r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=Rs(Rs({},Va.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(e,t,n,i){return"a"===e&&"href"===t||("img"===e||"source"===e)&&"src"===t?r.sanitizeUrl(n):Va.safeAttrValue(e,t,n,i)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"},e&&!t?n=e:e&&t?((n=Object.create(this.arcgisFilterOptions)).css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(t){if("whiteList"===t)n.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]);else if("css"===t){var i=e.css.whiteList;null!=i&&e.css instanceof Object&&Object.keys(i).forEach(function(e){return n.css.whiteList[e]=i[e]})}else n[t]=e[t]})):((n=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,n.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=n,this._xssFilter=new Va.FilterXSS(n)}return e.prototype.sanitize=function(e,t){switch(void 0===t&&(t={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,t);default:if(t.allowUndefined&&void 0===e)return;return null}},e.prototype.sanitizeUrl=function(e,t){var n=(null!=t?t:{}).isProtocolRequired,r=void 0===n||n,i=this._trim(e.substring(0,e.indexOf(":"))),o="/"===e,s=/^#/.test(e),a=i&&this.allowedProtocols.indexOf(i.toLowerCase())>-1;return o||s||a?Va.escapeAttrValue(e):i||r?"":Va.escapeAttrValue("https://".concat(e))},e.prototype.sanitizeHTMLAttribute=function(e,t,n,r){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(e,t,n,r):Va.safeAttrValue(e,t,n,r)},e.prototype.validate=function(e,t){void 0===t&&(t={});var n=this.sanitize(e,t);return{isValid:e===n,sanitized:n}},e.prototype.encodeHTML=function(e){var t=this;return String(e).replace(/[&<>"'\/]/g,function(e){return t._entityMap[e]})},e.prototype.encodeAttrValue=function(e){var t=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(n,r){return t.test(n)?n:"&#x".concat(Number(e.charCodeAt(r)).toString(16),";")})},e.prototype._extendObjectOfArrays=function(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(n){Array.isArray(e[n])&&Array.isArray(t[n])?t[n]=t[n].concat(e[n]):t[n]=e[n]})}),t},e.prototype._iterateOverObject=function(e,t){var n=this;void 0===t&&(t={});try{var r=!1,i=void 0;if(Array.isArray(e))i=e.reduce(function(e,i){var o=n.validate(i,t);return o.isValid?e.concat([i]):(r=!0,e.concat([o.sanitized]))},[]);else{if(!function(e){if("object"!=typeof e||null===e)return!1;if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e)){if(t.allowUndefined&&void 0===e)return;return null}i=Object.keys(e).reduce(function(i,o){var s=e[o],a=n.validate(s,t);return a.isValid?i[o]=s:(r=!0,i[o]=a.sanitized),i},{})}return r?i:e}catch(e){return null}},e.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},e}();!function(e){e.Small="SMALL",e.Medium="MEDIUM",e.Large="LARGE"}(La||(La={})),function(e){e.String="STRING",e.Number="NUMBER",e.Date="DATE",e.DateOnly="DATE_ONLY",e.TimeOnly="TIME_ONLY"}(_a||(_a={})),function(e){e.BigInteger="esriFieldTypeBigInteger",e.Blob="esriFieldTypeBlob",e.Date="esriFieldTypeDate",e.DateOnly="esriFieldTypeDateOnly",e.TimeOnly="esriFieldTypeTimeOnly",e.Double="esriFieldTypeDouble",e.Geometry="esriFieldTypeGeometry",e.GlobalID="esriFieldTypeGlobalID",e.GUID="esriFieldTypeGUID",e.Integer="esriFieldTypeInteger",e.OID="esriFieldTypeOID",e.Raster="esriFieldTypeRaster",e.Single="esriFieldTypeSingle",e.SmallInteger="esriFieldTypeSmallInteger",e.String="esriFieldTypeString",e.XML="esriFieldTypeXML"}(Ma||(Ma={})),function(e){e.Fetching="FETCHING",e.Success="SUCCESS",e.Error="ERROR"}(Na||(Na={})),function(e){e.Design="DESIGN",e.Run="RUN",e.Express="EXPRESS"}(ka||(ka={})),function(e){e.Opened="OPENED",e.Active="ACTIVE",e.Closed="CLOSED",e.Hidden="HIDDEN"}(Ua||(Ua={})),function(e){e.None="NONE",e.Page="PAGE",e.Dialog="DIALOG",e.View="VIEW",e.WebAddress="WEB_ADDRESS",e.Block="BLOCK",e.Screen="SCREEN",e.PageTop="PAGE_TOP",e.PrintPreview="PRINT_PREVIEW",e.CookieBanner="COOKIE_BANNER"}(Fa||(Fa={})),function(e){e.CurrentWindow="_self",e.TopWindow="_top",e.NewWindow="_blank"}(Ba||(Ba={})),function(e){e.Normal="NORMAL",e.Layout="LAYOUT"}($a||($a={}));const Wa=["shortDate","shortDateLE","longMonthDayYear","dayShortMonthYear","dayShortMonthYearShortTime","dayShortMonthYearShortTime24","dayShortMonthYearLongTime","dayShortMonthYearLongTime24","longDate","longDateShortTime","longDateShortTime24","longDateLongTime","longDateLongTime24","longMonthDayYearShortTime","longMonthDayYearShortTime24","longMonthDayYearLongTime","longMonthDayYearLongTime24","shortDateShortTime","shortDateLEShortTime","shortDateShortTime24","shortDateLEShortTime24","shortDateLongTime","shortDateLELongTime","shortDateLongTime24","shortDateLELongTime24","longMonthYear","shortMonthYear","year"];var Ha,za;!function(e){e.Header="HEADER",e.Footer="FOOTER",e.Body="BODY"}(Ha||(Ha={})),function(e){e.Http="http:",e.Https="https:"}(za||(za={}));const qa="_appWindow";var Ja,Ka,Ya,Xa;!function(e){e.Image="IMAGE",e.Config="CONFIG",e.Translation="TRANSLATION"}(Ja||(Ja={})),function(e){e.EXB_DATA_SOURCE_ID_SET_TO_CREATED_JS_API_LAYER="_exb_data_source_id_set_to_created_js_api_layer",e.EXB_OID="_exb_oid",e.EXB_NOT_EDITABLE="_exb_not_editable",e.EXB_DATA_SOURCE="__exb_data_source",e.EXB_DATA_SET="__exb_data_set",e.EXB_LAYER_VIEW_IGNORE_SPATIAL_FILTER="__exb_layer_view_ignore_spatial_filter",e.EXB_LAYER_FROM_RUNTIME="__exb_layer_from_runtime",e.EXB_DATA_SOURCE_ID="__exb_data_source_id",e.EXB_JIMU_LAYER_VIEW_ID="__exb_jimu_layer_view_id",e.EXB_PREDEFINED_RENDERER="__exb_predefined_renderer",e.EXB_LAYER_REMOVED_BEFORE="__exb_layer_removed_before",e.EXB_LAYER_CREATED_BY_DATA_SOURCE="__exb_layer_created_by_data_source"}(Ka||(Ka={})),function(e){e.NotCreated="NOT_CREATED",e.Created="CREATED",e.CreateError="CREATE_ERROR",e.NotReady="NOT_READY",e.Unloaded="UNLOADED",e.Loading="LOADING",e.Loaded="LOADED",e.LoadError="LOAD_ERROR",e.Saving="SAVING",e.Saved="SAVED",e.SaveError="SAVE_ERROR",e.Closed="CLOSED",e.Connecting="CONNECTING",e.Connected="CONNECTED",e.Closing="CLOSING"}(Ya||(Ya={})),function(e){e.Error="ERROR",e.SimpleLocal="SIMPLE_LOCAL",e.CSV="CSV",e.FeatureLayer="FEATURE_LAYER",e.SceneLayer="SCENE_LAYER",e.SubtypeGroupLayer="SUBTYPE_GROUP_LAYER",e.SubtypeSublayer="SUBTYPE_SUBLAYER",e.GroupLayer="GROUP_LAYER",e.FeatureService="FEATURE_SERVICE",e.MapService="MAP_SERVICE",e.SceneService="SCENE_SERVICE",e.VectorTileService="VECTOR_TILE_SERVICE",e.GeoJSON="GEO_JSON",e.KML="KML",e.WFS="WFS",e.WMS="WMS",e.WMTS="WMTS",e.BuildingSceneLayer="BUILDING_SCENE_LAYER",e.BuildingGroupSubLayer="BUILDING_GROUP_SUBLAYER",e.BuildingComponentSubLayer="BUILDING_COMPONENT_SUBLAYER",e.OrientedImageryLayer="ORIENTED_IMAGERY_LAYER",e.ImageryLayer="IMAGERY_LAYER",e.ImageryTileLayer="IMAGERY_TILE_LAYER",e.ElevationLayer="ELEVATION_LAYER",e.Map="MAP",e.WebMap="WEB_MAP",e.WebScene="WEB_SCENE"}(Xa||(Xa={}));const Qa=Xa;var Za,el,tl,nl,rl,il,ol,sl,al,ll,ul,cl,dl,pl,fl,hl;!function(e){e.FeatureLayer="Feature Layer",e.Table="Table",e.GroupLayer="Group Layer",e.OrientedImageryLayer="Oriented Imagery Layer",e.SceneLayerPoint="Point",e.SceneLayer3DObject="3DObject",e.BuildingSceneLayer="Building",e.BuildingGroupSubLayer="building-group",e.BuildingComponentSubLayer="building-component"}(Za||(Za={})),function(e){e.FeatureService="FeatureServer",e.MapService="MapServer",e.SceneService="SceneServer",e.ImageService="ImageServer",e.VectorTileService="VectorTileServer"}(el||(el={})),function(e){e.WebMap="Web Map",e.WebScene="Web Scene",e.FeatureService="Feature Service",e.MapService="Map Service",e.SceneService="Scene Service",e.ImageService="Image Service",e.VectorTileService="Vector Tile Service",e.FeatureCollection="Feature Collection",e.GroupLayer="Group Layer",e.CSV="CSV",e.GeoJSON="GeoJson",e.KML="KML",e.WFS="WFS",e.WMS="WMS",e.WMTS="WMTS",e.GeometryService="Geometry Service",e.GeocodingService="Geocoding Service",e.GeoprocessingService="Geoprocessing Service",e.NetworkAnalysisService="Network Analysis Service",e.GeoenrichmentService="Geoenrichment service"}(tl||(tl={})),function(e){e.FeatureLayer="feature",e.MapImageLayer="map-image",e.TileLayer="tile",e.GroupLayer="group",e.SceneLayer="scene",e.ImageryLayer="imagery",e.ImageryTileLayer="imagery-tile",e.ElevationLayer="elevation",e.OrientedImageryLayer="oriented-imagery",e.SubtypeGroupLayer="subtype-group",e.SubtypeSublayer="subtype-sublayer",e.VectorTileLayer="vector-tile",e.KMLLayer="kml",e.CSVLayer="csv",e.GeoJSONLayer="geojson",e.WFSLayer="wfs",e.WMSLayer="wms",e.WMTSLayer="wmts",e.BuildingSceneLayer="building-scene",e.BuildingComponentSubLayer="building-component",e.BuildingGroupSubLayer="building-group"}(nl||(nl={})),function(e){e.FeatureLayer="ArcGISFeatureLayer",e.SceneLayer="ArcGISSceneServiceLayer",e.GroupLayer="GroupLayer",e.MapService="ArcGISMapServiceLayer",e.TiledMapService="ArcGISTiledMapServiceLayer",e.VectorTileService="VectorTileLayer",e.ImageService="ArcGISImageServiceLayer",e.TiledImageService="ArcGISTiledImageServiceLayer",e.CSV="CSV",e.GeoJSON="GeoJSON",e.KML="KML",e.WFS="WFS",e.WMS="WMS",e.SubtypeGroupLayer="SubtypeGroupLayer"}(rl||(rl={}));class gl extends Error{constructor(e,t){super(`data source id: ${e}, ${t}`),this.dataSourceId=e}}!function(e){e.InAllData="IN_ALL_DATA",e.InRemoteConfigView="IN_REMOTE_CONFIG_VIEW",e.InConfigView="IN_CONFIG_VIEW",e.InRuntimeView="IN_RUNTIME_VIEW"}(il||(il={})),function(e){e.Asc="ASC",e.Desc="DESC"}(ol||(ol={})),function(e){e.New="New",e.AddToCurrent="AddToCurrent",e.RemoveFromCurrent="RemoveFromCurrent",e.SelectFromCurrent="SelectFromCurrent"}(sl||(sl={})),function(e){e.BaseDynamicLayer="base-dynamic",e.BaseElevationLayer="base-elevation",e.BaseTileLayer="base-tile",e.BingMapsLayer="bing-maps",e.BuildingSceneLayer="building-scene",e.BuildingGroupSublayer="building-group",e.BuildingComponentSublayer="building-component",e.CatalogLayer="catalog",e.CatalogDynamicGroupLayer="catalog-dynamic-group",e.CatalogFootprintLayer="catalog-footprint",e.CSVLayer="csv",e.DimensionLayer="dimension",e.ElevationLayer="elevation",e.FeatureLayer="feature",e.GeoJSONLayer="geojson",e.GeoRSSLayer="geo-rss",e.GraphicsLayer="graphics",e.GroupLayer="group",e.SubtypeGroupLayer="subtype-group",e.SubtypeSublayer="subtype-sublayer",e.ImageryLayer="imagery",e.ImageryTileLayer="imagery-tile",e.IntegratedMesh3DTilesLayer="integrated-mesh-3dtiles",e.OrientedImageryLayer="oriented-imagery",e.IntegratedMeshLayer="integrated-mesh",e.KMLLayer="kml",e.KnowledgeGraphLayer="knowledge-graph",e.KnowledgeGraphSublayer="knowledge-graph-sublayer",e.LineOfSightLayer="line-of-sight",e.MapImageLayer="map-image",e.MapNotesLayer="map-notes",e.MediaLayer="media",e.OGCFeatureLayer="ogc-feature",e.OpenStreetMapLayer="open-street-map",e.PointCloudLayer="point-cloud",e.RouteLayer="route",e.SceneLayer="scene",e.StreamLayer="stream",e.TileLayer="tile",e.UnknownLayer="unknown",e.UnsupportedLayer="unsupported",e.VectorTileLayer="vector-tile",e.VideoLayer="video",e.ViewshedLayer="viewshed",e.VoxelLayer="voxel",e.WCSLayer="wcs",e.WFSLayer="wfs",e.WMSLayer="wms",e.WMTSLayer="wmts",e.WebTileLayer="web-tile"}(al||(al={})),function(e){e.Loading="LOADING",e.Loaded="LOADED",e.Failed="FAILED"}(ll||(ll={})),function(e){e.AppError="APP_ERROR",e.PrivilegeError="PRIVILEGE_ERROR",e.OAuthError="OAUTH_ERROR"}(ul||(ul={})),function(e){e.AppNotPublished="APP_NOT_PUBLISHED",e.AppNotExisted="APP_NOT_EXISTED",e.AppPage404="APP_PAGE_404",e.PrivilegeNullInfo="PRIVILEGE_NULL_INFO",e.PrivilegeInvalidUserLevel="PRIVILEGE_INVALID_USER_LEVEL",e.PrivilegeInvalidPrivilege="PRIVILEGE_INVALID_PRIVILEGE",e.PrivilegeInvalidLicense="PRIVILEGE_INVALID_LICENSE",e.PrivilegeInvalidAppBlockedByOrg="PRIVILEGE_INVALID_APP_BLOCK_BY_ORG",e.PrivilegeInvalidResourceExperience="PRIVILEGE_INVALID_RESOURCE_EXPERIENCE",e.PrivilegeInvalidResourceItem="PRIVILEGE_INVALID_RESOURCE_ITEM",e.PrivilegeInvalidResourcePermission="PRIVILEGE_INVALID_RESOURCE_PERMISSION",e.PrivilegeInvalidResourcePermissionForReadOnly="PRIVILEGE_INVALID_RESOURCE_PERMISSION_FOR_READ_ONLY",e.PrivilegeInvalidMainSession="PRIVILEGE_INVALID_MAIN_SESSION",e.PrivilegeInvalidPagePermission="PRIVILEGE_INVALID_PAGE_PERMISSION",e.OAuthPublicUserLimit="OAUTH_PUBLIC_USER_LIMIT",e.OAuthAppLicenceLimit="OAUTH_APP_LICENCE_LIMIT",e.OAuthOthers="OAUTH_OTHERS"}(cl||(cl={})),function(e){e.Experience="Web Experience",e.Template="Web Experience Template"}(dl||(dl={})),function(e){e.DataSelection="dataSelection"}(pl||(pl={})),function(e){e.Widgets="widgets",e.Data_s="data_s"}(fl||(fl={})),function(e){e.Id="id",e.Where="where",e.Geometry="geometry",e.SpatialRel="spatialRel"}(hl||(hl={}));const ml=Array.isArray;const vl="object"==typeof global&&global&&global.Object===Object&&global;var yl="object"==typeof self&&self&&self.Object===Object&&self;const Sl=vl||yl||Function("return this")();const bl=Sl.Symbol;var wl=Object.prototype,Il=wl.hasOwnProperty,El=wl.toString,Ol=bl?bl.toStringTag:void 0;const Cl=function(e){var t=Il.call(e,Ol),n=e[Ol];try{e[Ol]=void 0;var r=!0}catch(e){}var i=El.call(e);return r&&(t?e[Ol]=n:delete e[Ol]),i};var Tl=Object.prototype.toString;const xl=function(e){return Tl.call(e)};var Al=bl?bl.toStringTag:void 0;const Dl=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Al&&Al in Object(e)?Cl(e):xl(e)};const Rl=function(e){return null!=e&&"object"==typeof e};const Pl=function(e){return"symbol"==typeof e||Rl(e)&&"[object Symbol]"==Dl(e)};var jl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ll=/^\w*$/;const _l=function(e,t){if(ml(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Pl(e))||(Ll.test(e)||!jl.test(e)||null!=t&&e in Object(t))};const Ml=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const Nl=function(e){if(!Ml(e))return!1;var t=Dl(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};const kl=Sl["__core-js_shared__"];var Ul,Fl=(Ul=/[^.]+$/.exec(kl&&kl.keys&&kl.keys.IE_PROTO||""))?"Symbol(src)_1."+Ul:"";const Bl=function(e){return!!Fl&&Fl in e};var $l=Function.prototype.toString;const Vl=function(e){if(null!=e){try{return $l.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var Gl=/^\[object .+?Constructor\]$/,Wl=Function.prototype,Hl=Object.prototype,zl=Wl.toString,ql=Hl.hasOwnProperty,Jl=RegExp("^"+zl.call(ql).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Kl=function(e){return!(!Ml(e)||Bl(e))&&(Nl(e)?Jl:Gl).test(Vl(e))};const Yl=function(e,t){return null==e?void 0:e[t]};const Xl=function(e,t){var n=Yl(e,t);return Kl(n)?n:void 0};const Ql=Xl(Object,"create");const Zl=function(){this.__data__=Ql?Ql(null):{},this.size=0};const eu=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var tu=Object.prototype.hasOwnProperty;const nu=function(e){var t=this.__data__;if(Ql){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return tu.call(t,e)?t[e]:void 0};var ru=Object.prototype.hasOwnProperty;const iu=function(e){var t=this.__data__;return Ql?void 0!==t[e]:ru.call(t,e)};const ou=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ql&&void 0===t?"__lodash_hash_undefined__":t,this};function su(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}su.prototype.clear=Zl,su.prototype.delete=eu,su.prototype.get=nu,su.prototype.has=iu,su.prototype.set=ou;const au=su;const lu=function(){this.__data__=[],this.size=0};const uu=function(e,t){return e===t||e!=e&&t!=t};const cu=function(e,t){for(var n=e.length;n--;)if(uu(e[n][0],t))return n;return-1};var du=Array.prototype.splice;const pu=function(e){var t=this.__data__,n=cu(t,e);return!(n<0)&&(n==t.length-1?t.pop():du.call(t,n,1),--this.size,!0)};const fu=function(e){var t=this.__data__,n=cu(t,e);return n<0?void 0:t[n][1]};const hu=function(e){return cu(this.__data__,e)>-1};const gu=function(e,t){var n=this.__data__,r=cu(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function mu(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}mu.prototype.clear=lu,mu.prototype.delete=pu,mu.prototype.get=fu,mu.prototype.has=hu,mu.prototype.set=gu;const vu=mu;const yu=Xl(Sl,"Map");const Su=function(){this.size=0,this.__data__={hash:new au,map:new(yu||vu),string:new au}};const bu=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};const wu=function(e,t){var n=e.__data__;return bu(t)?n["string"==typeof t?"string":"hash"]:n.map};const Iu=function(e){var t=wu(this,e).delete(e);return this.size-=t?1:0,t};const Eu=function(e){return wu(this,e).get(e)};const Ou=function(e){return wu(this,e).has(e)};const Cu=function(e,t){var n=wu(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Tu(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Tu.prototype.clear=Su,Tu.prototype.delete=Iu,Tu.prototype.get=Eu,Tu.prototype.has=Ou,Tu.prototype.set=Cu;const xu=Tu;function Au(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Au.Cache||xu),n}Au.Cache=xu;const Du=Au;var Ru=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pu=/\\(\\)?/g,ju=function(e){var t=Du(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ru,function(e,n,r,i){t.push(r?i.replace(Pu,"$1"):n||e)}),t});const Lu=ju;const _u=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};var Mu=bl?bl.prototype:void 0,Nu=Mu?Mu.toString:void 0;const ku=function e(t){if("string"==typeof t)return t;if(ml(t))return _u(t,e)+"";if(Pl(t))return Nu?Nu.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};const Uu=function(e){return null==e?"":ku(e)};const Fu=function(e,t){return ml(e)?e:_l(e,t)?[e]:Lu(Uu(e))};const Bu=function(e){if("string"==typeof e||Pl(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};const $u=function(e,t){for(var n=0,r=(t=Fu(t,e)).length;null!=e&&n<r;)e=e[Bu(t[n++])];return n&&n==r?e:void 0};const Vu=function(e,t,n){var r=null==e?void 0:$u(e,t);return void 0===r?n:r};const Gu=function(){this.__data__=new vu,this.size=0};const Wu=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};const Hu=function(e){return this.__data__.get(e)};const zu=function(e){return this.__data__.has(e)};const qu=function(e,t){var n=this.__data__;if(n instanceof vu){var r=n.__data__;if(!yu||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new xu(r)}return n.set(e,t),this.size=n.size,this};function Ju(e){var t=this.__data__=new vu(e);this.size=t.size}Ju.prototype.clear=Gu,Ju.prototype.delete=Wu,Ju.prototype.get=Hu,Ju.prototype.has=zu,Ju.prototype.set=qu;const Ku=Ju;const Yu=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};const Xu=function(e){return this.__data__.has(e)};function Qu(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new xu;++t<n;)this.add(e[t])}Qu.prototype.add=Qu.prototype.push=Yu,Qu.prototype.has=Xu;const Zu=Qu;const ec=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};const tc=function(e,t){return e.has(t)};const nc=function(e,t,n,r,i,o){var s=1&n,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,p=!0,f=2&n?new Zu:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var h=e[d],g=t[d];if(r)var m=s?r(g,h,d,t,e,o):r(h,g,d,e,t,o);if(void 0!==m){if(m)continue;p=!1;break}if(f){if(!ec(t,function(e,t){if(!tc(f,t)&&(h===e||i(h,e,n,r,o)))return f.push(t)})){p=!1;break}}else if(h!==g&&!i(h,g,n,r,o)){p=!1;break}}return o.delete(e),o.delete(t),p};const rc=Sl.Uint8Array;const ic=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n};const oc=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n};var sc=bl?bl.prototype:void 0,ac=sc?sc.valueOf:void 0;const lc=function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new rc(e),new rc(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return uu(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=ic;case"[object Set]":var l=1&r;if(a||(a=oc),e.size!=t.size&&!l)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var c=nc(a(e),a(t),r,i,o,s);return s.delete(e),c;case"[object Symbol]":if(ac)return ac.call(e)==ac.call(t)}return!1};const uc=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e};const cc=function(e,t,n){var r=t(e);return ml(e)?r:uc(r,n(e))};const dc=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o};const pc=function(){return[]};var fc=Object.prototype.propertyIsEnumerable,hc=Object.getOwnPropertySymbols;const gc=hc?function(e){return null==e?[]:(e=Object(e),dc(hc(e),function(t){return fc.call(e,t)}))}:pc;const mc=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};const vc=function(e){return Rl(e)&&"[object Arguments]"==Dl(e)};var yc=Object.prototype,Sc=yc.hasOwnProperty,bc=yc.propertyIsEnumerable,wc=vc(function(){return arguments}())?vc:function(e){return Rl(e)&&Sc.call(e,"callee")&&!bc.call(e,"callee")};const Ic=wc;const Ec=function(){return!1};var Oc="object"==typeof exports&&exports&&!exports.nodeType&&exports,Cc=Oc&&"object"==typeof module&&module&&!module.nodeType&&module,Tc=Cc&&Cc.exports===Oc?Sl.Buffer:void 0;const xc=(Tc?Tc.isBuffer:void 0)||Ec;var Ac=/^(?:0|[1-9]\d*)$/;const Dc=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Ac.test(e))&&e>-1&&e%1==0&&e<t};const Rc=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Pc={};Pc["[object Float32Array]"]=Pc["[object Float64Array]"]=Pc["[object Int8Array]"]=Pc["[object Int16Array]"]=Pc["[object Int32Array]"]=Pc["[object Uint8Array]"]=Pc["[object Uint8ClampedArray]"]=Pc["[object Uint16Array]"]=Pc["[object Uint32Array]"]=!0,Pc["[object Arguments]"]=Pc["[object Array]"]=Pc["[object ArrayBuffer]"]=Pc["[object Boolean]"]=Pc["[object DataView]"]=Pc["[object Date]"]=Pc["[object Error]"]=Pc["[object Function]"]=Pc["[object Map]"]=Pc["[object Number]"]=Pc["[object Object]"]=Pc["[object RegExp]"]=Pc["[object Set]"]=Pc["[object String]"]=Pc["[object WeakMap]"]=!1;const jc=function(e){return Rl(e)&&Rc(e.length)&&!!Pc[Dl(e)]};const Lc=function(e){return function(t){return e(t)}};var _c="object"==typeof exports&&exports&&!exports.nodeType&&exports,Mc=_c&&"object"==typeof module&&module&&!module.nodeType&&module,Nc=Mc&&Mc.exports===_c&&vl.process;const kc=function(){try{var e=Mc&&Mc.require&&Mc.require("util").types;return e||Nc&&Nc.binding&&Nc.binding("util")}catch(e){}}();var Uc=kc&&kc.isTypedArray;const Fc=Uc?Lc(Uc):jc;var Bc=Object.prototype.hasOwnProperty;const $c=function(e,t){var n=ml(e),r=!n&&Ic(e),i=!n&&!r&&xc(e),o=!n&&!r&&!i&&Fc(e),s=n||r||i||o,a=s?mc(e.length,String):[],l=a.length;for(var u in e)!t&&!Bc.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Dc(u,l))||a.push(u);return a};var Vc=Object.prototype;const Gc=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Vc)};const Wc=function(e,t){return function(n){return e(t(n))}};const Hc=Wc(Object.keys,Object);var zc=Object.prototype.hasOwnProperty;const qc=function(e){if(!Gc(e))return Hc(e);var t=[];for(var n in Object(e))zc.call(e,n)&&"constructor"!=n&&t.push(n);return t};const Jc=function(e){return null!=e&&Rc(e.length)&&!Nl(e)};const Kc=function(e){return Jc(e)?$c(e):qc(e)};const Yc=function(e){return cc(e,Kc,gc)};var Xc=Object.prototype.hasOwnProperty;const Qc=function(e,t,n,r,i,o){var s=1&n,a=Yc(e),l=a.length;if(l!=Yc(t).length&&!s)return!1;for(var u=l;u--;){var c=a[u];if(!(s?c in t:Xc.call(t,c)))return!1}var d=o.get(e),p=o.get(t);if(d&&p)return d==t&&p==e;var f=!0;o.set(e,t),o.set(t,e);for(var h=s;++u<l;){var g=e[c=a[u]],m=t[c];if(r)var v=s?r(m,g,c,t,e,o):r(g,m,c,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){f=!1;break}h||(h="constructor"==c)}if(f&&!h){var y=e.constructor,S=t.constructor;y==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof S&&S instanceof S||(f=!1)}return o.delete(e),o.delete(t),f};const Zc=Xl(Sl,"DataView");const ed=Xl(Sl,"Promise");const td=Xl(Sl,"Set");const nd=Xl(Sl,"WeakMap");var rd="[object Map]",id="[object Promise]",od="[object Set]",sd="[object WeakMap]",ad="[object DataView]",ld=Vl(Zc),ud=Vl(yu),cd=Vl(ed),dd=Vl(td),pd=Vl(nd),fd=Dl;(Zc&&fd(new Zc(new ArrayBuffer(1)))!=ad||yu&&fd(new yu)!=rd||ed&&fd(ed.resolve())!=id||td&&fd(new td)!=od||nd&&fd(new nd)!=sd)&&(fd=function(e){var t=Dl(e),n="[object Object]"==t?e.constructor:void 0,r=n?Vl(n):"";if(r)switch(r){case ld:return ad;case ud:return rd;case cd:return id;case dd:return od;case pd:return sd}return t});const hd=fd;var gd="[object Arguments]",md="[object Array]",vd="[object Object]",yd=Object.prototype.hasOwnProperty;const Sd=function(e,t,n,r,i,o){var s=ml(e),a=ml(t),l=s?md:hd(e),u=a?md:hd(t),c=(l=l==gd?vd:l)==vd,d=(u=u==gd?vd:u)==vd,p=l==u;if(p&&xc(e)){if(!xc(t))return!1;s=!0,c=!1}if(p&&!c)return o||(o=new Ku),s||Fc(e)?nc(e,t,n,r,i,o):lc(e,t,l,n,r,i,o);if(!(1&n)){var f=c&&yd.call(e,"__wrapped__"),h=d&&yd.call(t,"__wrapped__");if(f||h){var g=f?e.value():e,m=h?t.value():t;return o||(o=new Ku),i(g,m,n,r,o)}}return!!p&&(o||(o=new Ku),Qc(e,t,n,r,i,o))};const bd=function e(t,n,r,i,o){return t===n||(null==t||null==n||!Rl(t)&&!Rl(n)?t!=t&&n!=n:Sd(t,n,r,i,e,o))};const wd=function(e,t){return bd(e,t)},Id=[576,992],Ed={DESKTOP:{width:1280,height:800},PAD:{width:768,height:1024},PHONE:{width:414,height:896}},Od=960,Cd={};Cd[La.Large]=[{width:1024,height:768},{width:1280,height:800},{width:1280,height:1024},{width:1366,height:768},{width:1440,height:900},{width:1536,height:864},{width:1600,height:900},{width:1920,height:1080}],Cd[La.Medium]=[{width:601,height:962},{width:600,height:1024},{width:768,height:1024},{width:800,height:1280},{width:834,height:1112}],Cd[La.Small]=[{width:360,height:640},{width:360,height:720},{width:360,height:740},{width:375,height:667},{width:414,height:736}];const Td=Cd,xd="themes/shared-theme/",Ad="selection",Dd="no_selection",Rd="output",Pd="repeat_context",jd="current_page",Ld=100,_d="exb_user_locale",Md="ExpressExperienceApp",Nd="layer_of_showOnMap_action_",kd="layer_of_addToMap_action_",Ud="__exb_add_marker_action_layer",Fd="__exb_feature_profile_arcade_content_",Bd="__exb_data_sources_profile_arcade_content_",$d=10,Vd="ExperienceBuilder_2025R3",Gd=["en","ar","bg","bs","ca","cs","da","de","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","no","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw"],Wd=!1;let Hd={};function zd(){return Hd}Math.pow(10,8);const qd=Symbol.for("constructDateFrom");function Jd(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&qd in e?e[qd](t):e instanceof Date?new e.constructor(t):new Date(t)}function Kd(e,t){return Jd(t||e,e)}function Yd(e,t){const n=zd(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,i=Kd(e,t?.in),o=i.getDay(),s=(o<r?7:0)+o-r;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function Xd(e,t){const n=zd(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,i=Kd(e,t?.in),o=i.getDay(),s=6+(o<r?-7:0)-(o-r);return i.setDate(i.getDate()+s),i.setHours(23,59,59,999),i}function Qd(e,t){const n=Kd(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function Zd(e,t){const n=Kd(e,t?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function ep(e,t){const n=Kd(e,t?.in),r=n.getMonth(),i=r-r%3;return n.setMonth(i,1),n.setHours(0,0,0,0),n}function tp(e,t){const n=Kd(e,t?.in),r=n.getMonth(),i=r-r%3+3;return n.setMonth(i,0),n.setHours(23,59,59,999),n}function np(e,t){const n=Kd(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function rp(e,t){const n=Kd(e,t?.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}var ip,op;!function(e){e.Now="NOW",e.Min="MIN",e.Max="MAX",e.Today="TODAY",e.Tomorrow="TOMORROW",e.Yesterday="YESTERDAY",e.ThisWeek="THIS_WEEK",e.ThisMonth="THIS_MONTH",e.ThisQuarter="THIS_QUARTER",e.ThisYear="THIS_YEAR"}(ip||(ip={})),function(e){e.Minute="MINUTE",e.Hour="HOUR",e.Day="DAY",e.Week="WEEK",e.Month="MONTH",e.Year="YEAR"}(op||(op={}));const sp={shortDate:{datePattern:"M/d/y",selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",selector:"date and time"},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",selector:"date and time"},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLongTime24:{datePattern:"M/d/y",timePattern:"H:mm:ss",selector:"date and time"},shortDateLE:{datePattern:"d/M/y",selector:"date"},shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",selector:"date and time"},shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",selector:"date and time"},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",selector:"date and time"},longMonthDayYear:{datePattern:"MMMM d, y",selector:"date"},longMonthDayYearShortTime:{datePattern:"MMMM d, y",timePattern:"h:mm a",selector:"date and time"},longMonthDayYearShortTime24:{datePattern:"MMMM d, y",timePattern:"H:mm",selector:"date and time"},longMonthDayYearLongTime:{datePattern:"MMMM d, y",timePattern:"h:mm:ss a",selector:"date and time"},longMonthDayYearLongTime24:{datePattern:"MMMM d, y",timePattern:"H:mm:ss",selector:"date and time"},dayShortMonthYear:{datePattern:"d MMM y",selector:"date"},dayShortMonthYearShortTime:{datePattern:"d MMM y",timePattern:"h:mm a",selector:"date and time"},dayShortMonthYearShortTime24:{datePattern:"d MMM y",timePattern:"H:mm",selector:"date and time"},dayShortMonthYearLongTime:{datePattern:"d MMM y",timePattern:"h:mm:ss a",selector:"date and time"},dayShortMonthYearLongTime24:{datePattern:"d MMM y",timePattern:"H:mm:ss",selector:"date and time"},longDate:{datePattern:"EEEE, MMMM d, y",selector:"date"},longDateShortTime:{datePattern:"EEEE, MMMM d, y",timePattern:"h:mm a",selector:"date and time"},longDateShortTime24:{datePattern:"EEEE, MMMM d, y",timePattern:"H:mm",selector:"date and time"},longDateLongTime:{datePattern:"EEEE, MMMM d, y",timePattern:"h:mm:ss a",selector:"date and time"},longDateLongTime24:{datePattern:"EEEE, MMMM d, y",timePattern:"H:mm:ss",selector:"date and time"},longMonthYear:{datePattern:"MMMM y",selector:"date"},shortMonthYear:{datePattern:"MMM y",selector:"date"},year:{datePattern:"y",selector:"date"}},ap="shortDateLongTime24",lp={date:"yyyy/MM/dd",time:"H:mm",dateTime:"yyyy/MM/dd H:mm"};function up(e){let t;return t=e&&"object"==typeof e?e:sp[e],t||(console.warn(`Invalid data format ${e}`),null)}function cp(e,t,n){const r=up(t);return r?pp(e,n,null==r?void 0:r.datePattern,null==r?void 0:r.timePattern):n.formatDate(e,{dateStyle:"short",timeStyle:"short"})}function dp(e,t,n){if(!e)return"";const r=e.split(":"),i=new Date(2e3,0,1,parseInt(r[0]),parseInt(r[1]),r[2]?parseInt(r[2]):0),o=up(t);return(null==o?void 0:o.timePattern)?Sp(i,o.timePattern,n):n.formatDate(i,{timeStyle:"medium"})}function pp(e,t,n,r){if(!e)return"";if("number"==typeof e&&(e=new Date(e)),!n&&!r)return t.formatDate(e);return vp(e,{datePattern:n,timePattern:r},t)}const fp=e=>{const t=up(e);if(!t)return;const n=gp(t.datePattern),r=gp(t.timePattern);return Object.assign(Object.assign({},n),r)},hp=e=>{const t=e.datePattern?gp(e.datePattern):{},n=e.timePattern?mp(e.timePattern):{};return Object.assign(Object.assign({},t),n)},gp=e=>{const t={};if(e.includes("y")&&(t.year="numeric"),e.includes("MMMM")?t.month="long":e.includes("MMM")?t.month="short":e.includes("MM")?t.month="2-digit":e.includes("M")&&(t.month="numeric"),e.includes("d")&&(t.day="numeric"),e.includes("EEEE")&&(t.weekday="long"),0!==Object.keys(t).length)return t;console.warn(`Invalid date pattern ${e}`)},mp=(e,t)=>{const n={};if(e.toLowerCase().includes("h")&&(n.hour="numeric"),e.includes("mm")&&(n.minute="2-digit"),e.includes("ss")&&(n.second="2-digit"),t&&e.includes("a")&&(n.hour12=!0),0!==Object.keys(n).length)return n;console.warn(`Not support time pattern ${e}`)};function vp(e,t,n){if(!e)return null;const r=hp(t);return n.formatDate(e,r)}function yp(e,t,n){if(!e)return null;const r=gp(t);return n.formatDate(e,r)}function Sp(e,t,n){if(!e)return null;const r=mp(t,!1);return n.formatDate(e,r)}function bp(e){return/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/.test(e)}function wp(e){return"number"==typeof e&&(e=new Date(e)),`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}-${("0"+e.getDate()).slice(-2)}`}function Ip(e){const t=e.split("-");return new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]))}function Ep(e,t){let n=null;const r=new Date;r.setHours(0,0,0,0);const i=r.getTime(),o=864e5;switch(e){case ip.Today:n=r;break;case ip.Yesterday:n=new Date(i-o);break;case ip.Tomorrow:n=new Date(i+o);break;case ip.ThisWeek:n=[Yd(r,{locale:t.locale}),Xd(r,{locale:t.locale})];break;case ip.ThisMonth:n=[Qd(r),Zd(r)];break;case ip.ThisQuarter:n=[ep(r),tp(r)];break;case ip.ThisYear:n=[np(r),rp(r)]}return n}function Op(e,t){var n=t&&t.cache?t.cache:_p,r=t&&t.serializer?t.serializer:jp;return(t&&t.strategy?t.strategy:Ap)(e,{cache:n,serializer:r})}function Cp(e,t,n,r){var i,o=null==(i=r)||"number"==typeof i||"boolean"==typeof i?r:n(r),s=t.get(o);return void 0===s&&(s=e.call(this,r),t.set(o,s)),s}function Tp(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=n(r),o=t.get(i);return void 0===o&&(o=e.apply(this,r),t.set(i,o)),o}function xp(e,t,n,r,i){return n.bind(t,e,r,i)}function Ap(e,t){return xp(e,this,1===e.length?Cp:Tp,t.cache.create(),t.serializer)}var Dp,Rp,Pp,jp=function(){return JSON.stringify(arguments)},Lp=function(){function e(){this.cache=Object.create(null)}return e.prototype.get=function(e){return this.cache[e]},e.prototype.set=function(e,t){this.cache[e]=t},e}(),_p={create:function(){return new Lp}},Mp={variadic:function(e,t){return xp(e,this,Tp,t.cache.create(),t.serializer)},monadic:function(e,t){return xp(e,this,Cp,t.cache.create(),t.serializer)}};function Np(e){return e.type===Rp.literal}function kp(e){return e.type===Rp.argument}function Up(e){return e.type===Rp.number}function Fp(e){return e.type===Rp.date}function Bp(e){return e.type===Rp.time}function $p(e){return e.type===Rp.select}function Vp(e){return e.type===Rp.plural}function Gp(e){return e.type===Rp.pound}function Wp(e){return e.type===Rp.tag}function Hp(e){return!(!e||"object"!=typeof e||e.type!==Pp.number)}function zp(e){return!(!e||"object"!=typeof e||e.type!==Pp.dateTime)}!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(Dp||(Dp={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(Rp||(Rp={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(Pp||(Pp={}));var qp=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Jp=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function Kp(e){var t={};return e.replace(Jp,function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"long":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),t}var Yp=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function Xp(e){return e.replace(/^(.*?)-/,"")}var Qp=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,Zp=/^(@+)?(\+|#+)?[rs]?$/g,ef=/(\*)(0+)|(#+)(0+)|(0+)/g,tf=/^(0+)$/;function nf(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(Zp,function(e,n,r){return"string"!=typeof r?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===r?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"==typeof r?r.length:0)),""}),t}function rf(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function of(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var n=e.slice(0,2);if("+!"===n?(t.signDisplay="always",e=e.slice(2)):"+?"===n&&(t.signDisplay="exceptZero",e=e.slice(2)),!tf.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function sf(e){var t=rf(e);return t||{}}function af(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];switch(i.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=i.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=Xp(i.options[0]);continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=nr(nr(nr({},t),{notation:"scientific"}),i.options.reduce(function(e,t){return nr(nr({},e),sf(t))},{}));continue;case"engineering":t=nr(nr(nr({},t),{notation:"engineering"}),i.options.reduce(function(e,t){return nr(nr({},e),sf(t))},{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(i.options[0]);continue;case"rounding-mode-floor":t.roundingMode="floor";continue;case"rounding-mode-ceiling":t.roundingMode="ceil";continue;case"rounding-mode-down":t.roundingMode="trunc";continue;case"rounding-mode-up":t.roundingMode="expand";continue;case"rounding-mode-half-even":t.roundingMode="halfEven";continue;case"rounding-mode-half-down":t.roundingMode="halfTrunc";continue;case"rounding-mode-half-up":t.roundingMode="halfExpand";continue;case"integer-width":if(i.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");i.options[0].replace(ef,function(e,n,r,i,o,s){if(n)t.minimumIntegerDigits=r.length;else{if(i&&o)throw new Error("We currently do not support maximum integer digits");if(s)throw new Error("We currently do not support exact integer digits")}return""});continue}if(tf.test(i.stem))t.minimumIntegerDigits=i.stem.length;else if(Qp.test(i.stem)){if(i.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");i.stem.replace(Qp,function(e,n,r,i,o,s){return"*"===r?t.minimumFractionDigits=n.length:i&&"#"===i[0]?t.maximumFractionDigits=i.length:o&&s?(t.minimumFractionDigits=o.length,t.maximumFractionDigits=o.length+s.length):(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length),""});var o=i.options[0];"w"===o?t=nr(nr({},t),{trailingZeroDisplay:"stripIfInteger"}):o&&(t=nr(nr({},t),nf(o)))}else if(Zp.test(i.stem))t=nr(nr({},t),nf(i.stem));else{var s=rf(i.stem);s&&(t=nr(nr({},t),s));var a=of(i.stem);a&&(t=nr(nr({},t),a))}}return t}var lf,uf={"001":["H","h"],419:["h","H","hB","hb"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["h","H","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["h","H","hB","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["h","H","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["h","H","hB","hb"],CU:["h","H","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["h","H","hB","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["h","H","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["h","H","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["h","H","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["h","H","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["h","H","hB","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["h","H","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["h","H","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["h","H","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"en-HK":["h","hb","H","hB"],"en-IL":["H","h","hb","hB"],"en-MY":["h","hb","H","hB"],"es-BR":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function cf(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n,r=e.language;return"root"!==r&&(n=e.maximize().region),(uf[n||""]||uf[r||""]||uf["".concat(r,"-001")]||uf["001"])[0]}var df=new RegExp("^".concat(qp.source,"*")),pf=new RegExp("".concat(qp.source,"*$"));function ff(e,t){return{start:e,end:t}}var hf=!!String.prototype.startsWith&&"_a".startsWith("a",1),gf=!!String.fromCodePoint,mf=!!Object.fromEntries,vf=!!String.prototype.codePointAt,yf=!!String.prototype.trimStart,Sf=!!String.prototype.trimEnd,bf=!!Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},wf=!0;try{wf="a"===(null===(lf=Df("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===lf?void 0:lf[0])}catch(Da){wf=!1}var If,Ef=hf?function(e,t,n){return e.startsWith(t,n)}:function(e,t,n){return e.slice(n,n+t.length)===t},Of=gf?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,r="",i=e.length,o=0;i>o;){if((n=e[o++])>1114111)throw RangeError(n+" is not a valid code point");r+=n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-=65536)>>10),n%1024+56320)}return r},Cf=mf?Object.fromEntries:function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];t[o]=s}return t},Tf=vf?function(e,t){return e.codePointAt(t)}:function(e,t){var n=e.length;if(!(t<0||t>=n)){var r,i=e.charCodeAt(t);return i<55296||i>56319||t+1===n||(r=e.charCodeAt(t+1))<56320||r>57343?i:r-56320+(i-55296<<10)+65536}},xf=yf?function(e){return e.trimStart()}:function(e){return e.replace(df,"")},Af=Sf?function(e){return e.trimEnd()}:function(e){return e.replace(pf,"")};function Df(e,t){return new RegExp(e,t)}if(wf){var Rf=Df("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");If=function(e,t){var n;return Rf.lastIndex=t,null!==(n=Rf.exec(e)[1])&&void 0!==n?n:""}}else If=function(e,t){for(var n=[];;){var r=Tf(e,t);if(void 0===r||_f(r)||Mf(r))break;n.push(r),t+=r>=65536?2:1}return Of.apply(void 0,n)};var Pf=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,n){for(var r=[];!this.isEOF();){var i=this.char();if(123===i){if((o=this.parseArgument(e,n)).err)return o;r.push(o.val)}else{if(125===i&&e>0)break;if(35!==i||"plural"!==t&&"selectordinal"!==t){if(60===i&&!this.ignoreTag&&47===this.peek()){if(n)break;return this.error(Dp.UNMATCHED_CLOSING_TAG,ff(this.clonePosition(),this.clonePosition()))}if(60===i&&!this.ignoreTag&&jf(this.peek()||0)){if((o=this.parseTag(e,t)).err)return o;r.push(o.val)}else{var o;if((o=this.parseLiteral(e,t)).err)return o;r.push(o.val)}}else{var s=this.clonePosition();this.bump(),r.push({type:Rp.pound,location:ff(s,this.clonePosition())})}}}return{val:r,err:null}},e.prototype.parseTag=function(e,t){var n=this.clonePosition();this.bump();var r=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Rp.literal,value:"<".concat(r,"/>"),location:ff(n,this.clonePosition())},err:null};if(this.bumpIf(">")){var i=this.parseMessage(e+1,t,!0);if(i.err)return i;var o=i.val,s=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!jf(this.char()))return this.error(Dp.INVALID_TAG,ff(s,this.clonePosition()));var a=this.clonePosition();return r!==this.parseTagName()?this.error(Dp.UNMATCHED_CLOSING_TAG,ff(a,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Rp.tag,value:r,children:o,location:ff(n,this.clonePosition())},err:null}:this.error(Dp.INVALID_TAG,ff(s,this.clonePosition())))}return this.error(Dp.UNCLOSED_TAG,ff(n,this.clonePosition()))}return this.error(Dp.INVALID_TAG,ff(n,this.clonePosition()))},e.prototype.parseTagName=function(){var e=this.offset();for(this.bump();!this.isEOF()&&Lf(this.char());)this.bump();return this.message.slice(e,this.offset())},e.prototype.parseLiteral=function(e,t){for(var n=this.clonePosition(),r="";;){var i=this.tryParseQuote(t);if(i)r+=i;else{var o=this.tryParseUnquoted(e,t);if(o)r+=o;else{var s=this.tryParseLeftAngleBracket();if(!s)break;r+=s}}}var a=ff(n,this.clonePosition());return{val:{type:Rp.literal,value:r,location:a},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(jf(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var n=this.char();if(39===n){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(n);this.bump()}return Of.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var n=this.char();return 60===n||123===n||35===n&&("plural"===t||"selectordinal"===t)||125===n&&e>0?null:(this.bump(),Of(n))},e.prototype.parseArgument=function(e,t){var n=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(Dp.EXPECT_ARGUMENT_CLOSING_BRACE,ff(n,this.clonePosition()));if(125===this.char())return this.bump(),this.error(Dp.EMPTY_ARGUMENT,ff(n,this.clonePosition()));var r=this.parseIdentifierIfPossible().value;if(!r)return this.error(Dp.MALFORMED_ARGUMENT,ff(n,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(Dp.EXPECT_ARGUMENT_CLOSING_BRACE,ff(n,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Rp.argument,value:r,location:ff(n,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(Dp.EXPECT_ARGUMENT_CLOSING_BRACE,ff(n,this.clonePosition())):this.parseArgumentOptions(e,t,r,n);default:return this.error(Dp.MALFORMED_ARGUMENT,ff(n,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),n=If(this.message,t),r=t+n.length;return this.bumpTo(r),{value:n,location:ff(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,n,r){var i,o=this.clonePosition(),s=this.parseIdentifierIfPossible().value,a=this.clonePosition();switch(s){case"":return this.error(Dp.EXPECT_ARGUMENT_TYPE,ff(o,a));case"number":case"date":case"time":this.bumpSpace();var l=null;if(this.bumpIf(",")){this.bumpSpace();var u=this.clonePosition();if((v=this.parseSimpleArgStyleIfPossible()).err)return v;if(0===(f=Af(v.val)).length)return this.error(Dp.EXPECT_ARGUMENT_STYLE,ff(this.clonePosition(),this.clonePosition()));l={style:f,styleLocation:ff(u,this.clonePosition())}}if((y=this.tryParseArgumentClose(r)).err)return y;var c=ff(r,this.clonePosition());if(l&&Ef(null==l?void 0:l.style,"::",0)){var d=xf(l.style.slice(2));if("number"===s)return(v=this.parseNumberSkeletonFromString(d,l.styleLocation)).err?v:{val:{type:Rp.number,value:n,location:c,style:v.val},err:null};if(0===d.length)return this.error(Dp.EXPECT_DATE_TIME_SKELETON,c);var p=d;this.locale&&(p=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e.charAt(r);if("j"===i){for(var o=0;r+1<e.length&&e.charAt(r+1)===i;)o++,r++;var s=1+(1&o),a=o<2?1:3+(o>>1),l=cf(t);for("H"!=l&&"k"!=l||(a=0);a-- >0;)n+="a";for(;s-- >0;)n=l+n}else n+="J"===i?"H":i}return n}(d,this.locale));var f={type:Pp.dateTime,pattern:p,location:l.styleLocation,parsedOptions:this.shouldParseSkeletons?Kp(p):{}};return{val:{type:"date"===s?Rp.date:Rp.time,value:n,location:c,style:f},err:null}}return{val:{type:"number"===s?Rp.number:"date"===s?Rp.date:Rp.time,value:n,location:c,style:null!==(i=null==l?void 0:l.style)&&void 0!==i?i:null},err:null};case"plural":case"selectordinal":case"select":var h=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(Dp.EXPECT_SELECT_ARGUMENT_OPTIONS,ff(h,nr({},h)));this.bumpSpace();var g=this.parseIdentifierIfPossible(),m=0;if("select"!==s&&"offset"===g.value){if(!this.bumpIf(":"))return this.error(Dp.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,ff(this.clonePosition(),this.clonePosition()));var v;if(this.bumpSpace(),(v=this.tryParseDecimalInteger(Dp.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,Dp.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return v;this.bumpSpace(),g=this.parseIdentifierIfPossible(),m=v.val}var y,S=this.tryParsePluralOrSelectOptions(e,s,t,g);if(S.err)return S;if((y=this.tryParseArgumentClose(r)).err)return y;var b=ff(r,this.clonePosition());return"select"===s?{val:{type:Rp.select,value:n,options:Cf(S.val),location:b},err:null}:{val:{type:Rp.plural,value:n,options:Cf(S.val),offset:m,pluralType:"plural"===s?"cardinal":"ordinal",location:b},err:null};default:return this.error(Dp.INVALID_ARGUMENT_TYPE,ff(o,a))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(Dp.EXPECT_ARGUMENT_CLOSING_BRACE,ff(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var n=this.clonePosition();if(!this.bumpUntil("'"))return this.error(Dp.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,ff(n,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var n=[];try{n=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],n=0,r=e.split(Yp).filter(function(e){return e.length>0});n<r.length;n++){var i=r[n].split("/");if(0===i.length)throw new Error("Invalid number skeleton");for(var o=i[0],s=i.slice(1),a=0,l=s;a<l.length;a++)if(0===l[a].length)throw new Error("Invalid number skeleton");t.push({stem:o,options:s})}return t}(e)}catch(e){return this.error(Dp.INVALID_NUMBER_SKELETON,t)}return{val:{type:Pp.number,tokens:n,location:t,parsedOptions:this.shouldParseSkeletons?af(n):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,n,r){for(var i,o=!1,s=[],a=new Set,l=r.value,u=r.location;;){if(0===l.length){var c=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var d=this.tryParseDecimalInteger(Dp.EXPECT_PLURAL_ARGUMENT_SELECTOR,Dp.INVALID_PLURAL_ARGUMENT_SELECTOR);if(d.err)return d;u=ff(c,this.clonePosition()),l=this.message.slice(c.offset,this.offset())}if(a.has(l))return this.error("select"===t?Dp.DUPLICATE_SELECT_ARGUMENT_SELECTOR:Dp.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,u);"other"===l&&(o=!0),this.bumpSpace();var p=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?Dp.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:Dp.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,ff(this.clonePosition(),this.clonePosition()));var f=this.parseMessage(e+1,t,n);if(f.err)return f;var h=this.tryParseArgumentClose(p);if(h.err)return h;s.push([l,{value:f.val,location:ff(p,this.clonePosition())}]),a.add(l),this.bumpSpace(),l=(i=this.parseIdentifierIfPossible()).value,u=i.location}return 0===s.length?this.error("select"===t?Dp.EXPECT_SELECT_ARGUMENT_SELECTOR:Dp.EXPECT_PLURAL_ARGUMENT_SELECTOR,ff(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(Dp.MISSING_OTHER_CLAUSE,ff(this.clonePosition(),this.clonePosition())):{val:s,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var n=1,r=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(n=-1);for(var i=!1,o=0;!this.isEOF();){var s=this.char();if(!(s>=48&&s<=57))break;i=!0,o=10*o+(s-48),this.bump()}var a=ff(r,this.clonePosition());return i?bf(o*=n)?{val:o,err:null}:this.error(t,a):this.error(e,a)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=Tf(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(Ef(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),n=this.message.indexOf(e,t);return n>=0?(this.bumpTo(n),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&_f(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),n=this.message.charCodeAt(t+(e>=65536?2:1));return null!=n?n:null},e}();function jf(e){return e>=97&&e<=122||e>=65&&e<=90}function Lf(e){return 45===e||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}function _f(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function Mf(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function Nf(e){e.forEach(function(e){if(delete e.location,$p(e)||Vp(e))for(var t in e.options)delete e.options[t].location,Nf(e.options[t].value);else Up(e)&&Hp(e.style)||(Fp(e)||Bp(e))&&zp(e.style)?delete e.style.location:Wp(e)&&Nf(e.children)})}function kf(e,t){void 0===t&&(t={}),t=nr({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var n=new Pf(e,t).parse();if(n.err){var r=SyntaxError(Dp[n.err.kind]);throw r.location=n.err.location,r.originalMessage=n.err.message,r}return(null==t?void 0:t.captureLocation)||Nf(n.val),n.val}var Uf;!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(Uf||(Uf={}));var Ff,Bf=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.code=n,i.originalMessage=r,i}return tr(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),$f=function(e){function t(t,n,r,i){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(n,'". Options are "').concat(Object.keys(r).join('", "'),'"'),Uf.INVALID_VALUE,i)||this}return tr(t,e),t}(Bf),Vf=function(e){function t(t,n,r){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(n),Uf.INVALID_VALUE,r)||this}return tr(t,e),t}(Bf),Gf=function(e){function t(t,n){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(n,'"'),Uf.MISSING_VALUE,n)||this}return tr(t,e),t}(Bf);function Wf(e){return"function"==typeof e}function Hf(e,t,n,r,i,o,s){if(1===e.length&&Np(e[0]))return[{type:Ff.literal,value:e[0].value}];for(var a=[],l=0,u=e;l<u.length;l++){var c=u[l];if(Np(c))a.push({type:Ff.literal,value:c.value});else if(Gp(c))"number"==typeof o&&a.push({type:Ff.literal,value:n.getNumberFormat(t).format(o)});else{var d=c.value;if(!i||!(d in i))throw new Gf(d,s);var p=i[d];if(kp(c))p&&"string"!=typeof p&&"number"!=typeof p||(p="string"==typeof p||"number"==typeof p?String(p):""),a.push({type:"string"==typeof p?Ff.literal:Ff.object,value:p});else if(Fp(c)){var f="string"==typeof c.style?r.date[c.style]:zp(c.style)?c.style.parsedOptions:void 0;a.push({type:Ff.literal,value:n.getDateTimeFormat(t,f).format(p)})}else if(Bp(c)){f="string"==typeof c.style?r.time[c.style]:zp(c.style)?c.style.parsedOptions:r.time.medium;a.push({type:Ff.literal,value:n.getDateTimeFormat(t,f).format(p)})}else if(Up(c)){(f="string"==typeof c.style?r.number[c.style]:Hp(c.style)?c.style.parsedOptions:void 0)&&f.scale&&(p*=f.scale||1),a.push({type:Ff.literal,value:n.getNumberFormat(t,f).format(p)})}else{if(Wp(c)){var h=c.children,g=c.value,m=i[g];if(!Wf(m))throw new Vf(g,"function",s);var v=m(Hf(h,t,n,r,i,o).map(function(e){return e.value}));Array.isArray(v)||(v=[v]),a.push.apply(a,v.map(function(e){return{type:"string"==typeof e?Ff.literal:Ff.object,value:e}}))}if($p(c)){if(!(y=c.options[p]||c.options.other))throw new $f(c.value,p,Object.keys(c.options),s);a.push.apply(a,Hf(y.value,t,n,r,i))}else if(Vp(c)){var y;if(!(y=c.options["=".concat(p)])){if(!Intl.PluralRules)throw new Bf('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',Uf.MISSING_INTL_API,s);var S=n.getPluralRules(t,{type:c.pluralType}).select(p-(c.offset||0));y=c.options[S]||c.options.other}if(!y)throw new $f(c.value,p,Object.keys(c.options),s);a.push.apply(a,Hf(y.value,t,n,r,i,p-(c.offset||0)))}else;}}}return function(e){return e.length<2?e:e.reduce(function(e,t){var n=e[e.length-1];return n&&n.type===Ff.literal&&t.type===Ff.literal?n.value+=t.value:e.push(t),e},[])}(a)}function zf(e,t){return t?Object.keys(e).reduce(function(n,r){var i,o;return n[r]=(i=e[r],(o=t[r])?nr(nr(nr({},i||{}),o||{}),Object.keys(i).reduce(function(e,t){return e[t]=nr(nr({},i[t]),o[t]||{}),e},{})):i),n},nr({},e)):e}function qf(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(Ff||(Ff={}));var Jf,Kf=function(){function e(t,n,r,i){void 0===n&&(n=e.defaultLocale);var o,s=this;if(this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=s.formatToParts(e);if(1===t.length)return t[0].value;var n=t.reduce(function(e,t){return e.length&&t.type===Ff.literal&&"string"==typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e},[]);return n.length<=1?n[0]||"":n},this.formatToParts=function(e){return Hf(s.ast,s.locales,s.formatters,s.formats,e,void 0,s.message)},this.resolvedOptions=function(){var e;return{locale:(null===(e=s.resolvedLocale)||void 0===e?void 0:e.toString())||Intl.NumberFormat.supportedLocalesOf(s.locales)[0]}},this.getAst=function(){return s.ast},this.locales=n,this.resolvedLocale=e.resolveLocale(n),"string"==typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var a=i||{},l=(a.formatters,rr(a,["formatters"]));this.ast=e.__parse(t,nr(nr({},l),{locale:this.resolvedLocale}))}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=zf(e.formats,r),this.formatters=i&&i.formatters||(void 0===(o=this.formatterCache)&&(o={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Op(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,ir([void 0],t,!1)))},{cache:qf(o.number),strategy:Mp.variadic}),getDateTimeFormat:Op(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,ir([void 0],t,!1)))},{cache:qf(o.dateTime),strategy:Mp.variadic}),getPluralRules:Op(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,ir([void 0],t,!1)))},{cache:qf(o.pluralRules),strategy:Mp.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(e){if(void 0!==Intl.Locale){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"==typeof e?e:e[0])}},e.__parse=kf,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}();!function(e){e.FORMAT_ERROR="FORMAT_ERROR",e.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",e.INVALID_CONFIG="INVALID_CONFIG",e.MISSING_DATA="MISSING_DATA",e.MISSING_TRANSLATION="MISSING_TRANSLATION"}(Jf||(Jf={}));var Yf=function(e){function t(n,r,i){var o=this,s=i?i instanceof Error?i:new Error(String(i)):void 0;return(o=e.call(this,"[@formatjs/intl Error ".concat(n,"] ").concat(r,"\n").concat(s?"\n".concat(s.message,"\n").concat(s.stack):""))||this).code=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return tr(t,e),t}(Error),Xf=function(e){function t(t,n){return e.call(this,Jf.UNSUPPORTED_FORMATTER,t,n)||this}return tr(t,e),t}(Yf),Qf=function(e){function t(t,n){return e.call(this,Jf.INVALID_CONFIG,t,n)||this}return tr(t,e),t}(Yf),Zf=function(e){function t(t,n){return e.call(this,Jf.MISSING_DATA,t,n)||this}return tr(t,e),t}(Yf),eh=function(e){function t(t,n,r){var i=e.call(this,Jf.FORMAT_ERROR,"".concat(t,"\nLocale: ").concat(n,"\n"),r)||this;return i.locale=n,i}return tr(t,e),t}(Yf),th=function(e){function t(t,n,r,i){var o=e.call(this,"".concat(t,"\nMessageID: ").concat(null==r?void 0:r.id,"\nDefault Message: ").concat(null==r?void 0:r.defaultMessage,"\nDescription: ").concat(null==r?void 0:r.description,"\n"),n,i)||this;return o.descriptor=r,o.locale=n,o}return tr(t,e),t}(eh),nh=function(e){function t(t,n){var r=e.call(this,Jf.MISSING_TRANSLATION,'Missing message: "'.concat(t.id,'" for locale "').concat(n,'", using ').concat(t.defaultMessage?"default message (".concat("string"==typeof t.defaultMessage?t.defaultMessage:t.defaultMessage.map(function(e){var t;return null!==(t=e.value)&&void 0!==t?t:JSON.stringify(e)}).join(),")"):"id"," as fallback."))||this;return r.descriptor=t,r}return tr(t,e),t}(Yf);function rh(e,t,n){return void 0===n&&(n={}),t.reduce(function(t,r){return r in e?t[r]=e[r]:r in n&&(t[r]=n[r]),t},{})}var ih={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:function(e){0},onWarn:function(e){0}};function oh(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function sh(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}function ah(e,t,n,r){var i,o=e&&e[t];if(o&&(i=o[n]),i)return i;r(new Xf("No ".concat(t," format named: ").concat(n)))}function lh(e,t){return Object.keys(e).reduce(function(n,r){return n[r]=nr({timeZone:t},e[r]),n},{})}function uh(e,t){return Object.keys(nr(nr({},e),t)).reduce(function(n,r){return n[r]=nr(nr({},e[r]||{}),t[r]||{}),n},{})}function ch(e,t){if(!t)return e;var n=Kf.formats;return nr(nr(nr({},n),e),{date:uh(lh(n.date,t),lh(e.date||{},t)),time:uh(lh(n.time,t),lh(e.time||{},t))})}var dh=function(e,t,n,r,i){var o=e.locale,s=e.formats,a=e.messages,l=e.defaultLocale,u=e.defaultFormats,c=e.fallbackOnEmptyString,d=e.onError,p=e.timeZone,f=e.defaultRichTextElements;void 0===n&&(n={id:""});var h=n.id,g=n.defaultMessage;!function(e,t,n){if(void 0===n&&(n=Error),!e)throw new n(t)}(!!h,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.github.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.github.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.github.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var m=String(h),v=a&&Object.prototype.hasOwnProperty.call(a,m)&&a[m];if(Array.isArray(v)&&1===v.length&&v[0].type===Rp.literal)return v[0].value;if(!r&&v&&"string"==typeof v&&!f)return v.replace(/'\{(.*?)\}'/gi,"{$1}");if(r=nr(nr({},f),r||{}),s=ch(s,p),u=ch(u,p),!v){if(!1===c&&""===v)return v;if((!g||o&&o.toLowerCase()!==l.toLowerCase())&&d(new nh(n,o)),g)try{return t.getMessageFormat(g,l,u,i).format(r)}catch(e){return d(new th('Error formatting default message for: "'.concat(m,'", rendering default message verbatim'),o,n,e)),"string"==typeof g?g:m}return m}try{return t.getMessageFormat(v,o,s,nr({formatters:t},i||{})).format(r)}catch(e){d(new th('Error formatting message: "'.concat(m,'", using ').concat(g?"default message":"id"," as fallback."),o,n,e))}if(g)try{return t.getMessageFormat(g,l,u,i).format(r)}catch(e){d(new th('Error formatting the default message for: "'.concat(m,'", rendering message verbatim'),o,n,e))}return"string"==typeof v?v:"string"==typeof g?g:m},ph=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function fh(e,t,n,r){var i=e.locale,o=e.formats,s=e.onError,a=e.timeZone;void 0===r&&(r={});var l=r.format,u=nr(nr({},a&&{timeZone:a}),l&&ah(o,t,l,s)),c=rh(r,ph,u);return"time"!==t||c.hour||c.minute||c.second||c.timeStyle||c.dateStyle||(c=nr(nr({},c),{hour:"numeric",minute:"numeric"})),n(i,c)}function hh(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],s=void 0===o?{}:o,a="string"==typeof i?new Date(i||0):i;try{return fh(e,"date",t,s).format(a)}catch(t){e.onError(new eh("Error formatting date.",e.locale,t))}return String(a)}function gh(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],s=void 0===o?{}:o,a="string"==typeof i?new Date(i||0):i;try{return fh(e,"time",t,s).format(a)}catch(t){e.onError(new eh("Error formatting time.",e.locale,t))}return String(a)}function mh(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],s=n[2],a=void 0===s?{}:s,l="string"==typeof i?new Date(i||0):i,u="string"==typeof o?new Date(o||0):o;try{return fh(e,"dateTimeRange",t,a).formatRange(l,u)}catch(t){e.onError(new eh("Error formatting date time range.",e.locale,t))}return String(l)}function vh(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],s=void 0===o?{}:o,a="string"==typeof i?new Date(i||0):i;try{return fh(e,"date",t,s).formatToParts(a)}catch(t){e.onError(new eh("Error formatting date.",e.locale,t))}return[]}function yh(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n[0],o=n[1],s=void 0===o?{}:o,a="string"==typeof i?new Date(i||0):i;try{return fh(e,"time",t,s).formatToParts(a)}catch(t){e.onError(new eh("Error formatting time.",e.locale,t))}return[]}var Sh=["style","type","fallback","languageDisplay"];function bh(e,t,n,r){var i=e.locale,o=e.onError;Intl.DisplayNames||o(new Bf('Intl.DisplayNames is not available in this environment.\nTry polyfilling it using "@formatjs/intl-displaynames"\n',Uf.MISSING_INTL_API));var s=rh(r,Sh);try{return t(i,s).of(n)}catch(e){o(new eh("Error formatting display name.",i,e))}}var wh=["type","style"],Ih=Date.now();function Eh(e,t,n,r){void 0===r&&(r={});var i=Oh(e,t,n,r).reduce(function(e,t){var n=t.value;return"string"!=typeof n?e.push(n):"string"==typeof e[e.length-1]?e[e.length-1]+=n:e.push(n),e},[]);return 1===i.length?i[0]:0===i.length?"":i}function Oh(e,t,n,r){var i=e.locale,o=e.onError;void 0===r&&(r={}),Intl.ListFormat||o(new Bf('Intl.ListFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-listformat"\n',Uf.MISSING_INTL_API));var s=rh(r,wh);try{var a={},l=n.map(function(e,t){if("object"==typeof e){var n=function(e){return"".concat(Ih,"_").concat(e,"_").concat(Ih)}(t);return a[n]=e,n}return String(e)});return t(i,s).formatToParts(l).map(function(e){return"literal"===e.type?e:nr(nr({},e),{value:a[e.value]||e.value})})}catch(e){o(new eh("Error formatting list.",i,e))}return n}var Ch=["style","currency","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem","trailingZeroDisplay","roundingPriority","roundingIncrement","roundingMode"];function Th(e,t,n){var r=e.locale,i=e.formats,o=e.onError;void 0===n&&(n={});var s=n.format,a=s&&ah(i,"number",s,o)||{};return t(r,rh(n,Ch,a))}function xh(e,t,n,r){void 0===r&&(r={});try{return Th(e,t,r).format(n)}catch(t){e.onError(new eh("Error formatting number.",e.locale,t))}return String(n)}function Ah(e,t,n,r){void 0===r&&(r={});try{return Th(e,t,r).formatToParts(n)}catch(t){e.onError(new eh("Error formatting number.",e.locale,t))}return[]}var Dh=["type"];function Rh(e,t,n,r){var i=e.locale,o=e.onError;void 0===r&&(r={}),Intl.PluralRules||o(new Bf('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',Uf.MISSING_INTL_API));var s=rh(r,Dh);try{return t(i,s).select(n)}catch(e){o(new eh("Error formatting plural.",i,e))}return"other"}var Ph=["numeric","style"];function jh(e,t,n,r,i){void 0===i&&(i={}),r||(r="second"),Intl.RelativeTimeFormat||e.onError(new Bf('Intl.RelativeTimeFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-relativetimeformat"\n',Uf.MISSING_INTL_API));try{return function(e,t,n){var r=e.locale,i=e.formats,o=e.onError;void 0===n&&(n={});var s=n.format,a=!!s&&ah(i,"relative",s,o)||{};return t(r,rh(n,Ph,a))}(e,t,i).format(n,r)}catch(t){e.onError(new eh("Error formatting relative time.",e.locale,t))}return String(n)}function Lh(e){var t;e.onWarn&&e.defaultRichTextElements&&"string"==typeof((t=e.messages||{})?t[Object.keys(t)[0]]:void 0)&&e.onWarn('[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. \nPlease consider using "@formatjs/cli" to pre-compile your messages for performance.\nFor more details see https://formatjs.github.io/docs/getting-started/message-distribution')}function _h(e,t){var n=function(e){void 0===e&&(e={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}});var t=Intl.RelativeTimeFormat,n=Intl.ListFormat,r=Intl.DisplayNames,i=Op(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,ir([void 0],t,!1)))},{cache:sh(e.dateTime),strategy:Mp.variadic}),o=Op(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,ir([void 0],t,!1)))},{cache:sh(e.number),strategy:Mp.variadic}),s=Op(function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,ir([void 0],t,!1)))},{cache:sh(e.pluralRules),strategy:Mp.variadic});return{getDateTimeFormat:i,getNumberFormat:o,getMessageFormat:Op(function(e,t,n,r){return new Kf(e,t,n,nr({formatters:{getNumberFormat:o,getDateTimeFormat:i,getPluralRules:s}},r||{}))},{cache:sh(e.message),strategy:Mp.variadic}),getRelativeTimeFormat:Op(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new(t.bind.apply(t,ir([void 0],e,!1)))},{cache:sh(e.relativeTime),strategy:Mp.variadic}),getPluralRules:s,getListFormat:Op(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(n.bind.apply(n,ir([void 0],e,!1)))},{cache:sh(e.list),strategy:Mp.variadic}),getDisplayNames:Op(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(r.bind.apply(r,ir([void 0],e,!1)))},{cache:sh(e.displayNames),strategy:Mp.variadic})}}(t),r=nr(nr({},ih),e),i=r.locale,o=r.defaultLocale,s=r.onError;return i?!Intl.NumberFormat.supportedLocalesOf(i).length&&s?s(new Zf('Missing locale data for locale: "'.concat(i,'" in Intl.NumberFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.github.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(i).length&&s&&s(new Zf('Missing locale data for locale: "'.concat(i,'" in Intl.DateTimeFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.github.io/docs/react-intl#runtime-requirements for more details'))):(s&&s(new Qf('"locale" was not configured, using "'.concat(o,'" as fallback. See https://formatjs.github.io/docs/react-intl/api#intlshape for more details'))),r.locale=r.defaultLocale||"en"),Lh(r),nr(nr({},r),{formatters:n,formatNumber:xh.bind(null,r,n.getNumberFormat),formatNumberToParts:Ah.bind(null,r,n.getNumberFormat),formatRelativeTime:jh.bind(null,r,n.getRelativeTimeFormat),formatDate:hh.bind(null,r,n.getDateTimeFormat),formatDateToParts:vh.bind(null,r,n.getDateTimeFormat),formatTime:gh.bind(null,r,n.getDateTimeFormat),formatDateTimeRange:mh.bind(null,r,n.getDateTimeFormat),formatTimeToParts:yh.bind(null,r,n.getDateTimeFormat),formatPlural:Rh.bind(null,r,n.getPluralRules),formatMessage:dh.bind(null,r,n),$t:dh.bind(null,r,n),formatList:Eh.bind(null,r,n.getListFormat),formatListToParts:Oh.bind(null,r,n.getListFormat),formatDisplayName:bh.bind(null,r,n.getDisplayNames)})}function Mh(e,t,n){if(void 0===n&&(n=Error),!e)throw new n(t)}function Nh(e){Mh(e,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var kh=nr(nr({},ih),{textComponent:F.Fragment}),Uh={key:42},Fh=function(e){return F.isValidElement(e)?F.createElement(F.Fragment,Uh,e):e};function Bh(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(var o=0;o<i;o++){var s=n[o];if(e[s]!==t[s]||!Object.prototype.hasOwnProperty.call(t,s))return!1}return!0}function $h(e){return e?Object.keys(e).reduce(function(t,n){var r,i=e[n];return t[n]=Wf(i)?(r=i,function(e){return r(F.Children.toArray(e))}):i,t},{}):e}var Vh,Gh,Wh,Hh,zh,qh,Jh,Kh,Yh,Xh,Qh,Zh,eg,tg,ng,rg,ig=function(e,t,n,r){for(var i=[],o=4;o<arguments.length;o++)i[o-4]=arguments[o];var s=$h(r),a=dh.apply(void 0,ir([e,t,n,s],i,!1));return Array.isArray(a)?function(e){var t;return null!==(t=F.Children.map(e,Fh))&&void 0!==t?t:[]}(a):a},og=function(e,t){var n=e.defaultRichTextElements,r=rr(e,["defaultRichTextElements"]),i=$h(n),o=_h(nr(nr(nr({},kh),r),{defaultRichTextElements:i}),t),s={locale:o.locale,timeZone:o.timeZone,fallbackOnEmptyString:o.fallbackOnEmptyString,formats:o.formats,defaultLocale:o.defaultLocale,defaultFormats:o.defaultFormats,messages:o.messages,onError:o.onError,defaultRichTextElements:i};return nr(nr({},o),{formatMessage:ig.bind(null,s,o.formatters),$t:ig.bind(null,s,o.formatters)})},sg=a(7386);function ag(e){let t="",n=e||"";return n=hg(n),n&&(t=n+"/sharing/rest/portals/self"),t}function lg(e){let t="";const n=hg(e);return n&&(t=n+"/sharing/rest/community/groups"),t}function ug(){const e=`${window.location.protocol}//${window.location.host}${function(){const e=window.location.href.split("?")[0];let t=e.indexOf("/home/");t<0&&(t=e.indexOf("/apps/"));let n=e.substring(e.indexOf(window.location.host)+window.location.host.length+1,t);"/"!==n&&(n="/"+n+"/");return n}()}`;return e.substr(0,e.length-1)}function cg(e){return/\/$/.test(e)?`${e}sharing/rest`:`${e}/sharing/rest`}function dg(e){const t=/\/$/.test(e)?"/sharing/rest/":"/sharing/rest";return e.substr(0,e.length-t.length)}function pg(e,t){const n=/^http(s?):\/\//gi,r=/^\/\//gi;return(e=hg(e).toLowerCase().replace(n,"").replace(r,""))===(t=hg(t).toLowerCase().replace(n,"").replace(r,""))}function fg(e){return rI(e).includes(".arcgis.com")}function hg(e){const t=rI(e);return""===t?"":fg(t)?tI(t,za.Https):tI(e=(e||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),za.Https)}function gg(e){let t="";const n=hg(e);return n&&(t=n+"/sharing/rest/content/items"),t}function mg(e,t){let n="";const r=gg(e);return r&&t&&(n=r+"/"+t),n}function vg(e){let t="";const n=hg(e);return n&&(t=n+"/sharing/rest/community/users"),t}function yg(e,t){let n="";const r=vg(e);return e&&t&&(n=r+"/"+t),n}function Sg(e){let t="";return e&&(t=(e=hg(e))+"/sharing/rest/content"),t}function bg(e,t,n){let r="",i="";return e&&t&&(r=Sg(e),i=n?r+"/users/"+t+"/"+n:r+"/users/"+t),i}function wg(e,t,n){let r="",i="";return e&&t&&(r=bg(e,t,n),i=r+"/items"),i}function Ig(e,t,n,r){let i="",o="";return e&&t&&(i=wg(e,t,r),o=i+"/"+n+"/share"),o}function Eg(e){let t="";const n=hg(e);return n&&(t=n+"/home/index.html"),t}function Og(e,t){let n="";const r=hg(e);return r&&(n=r+"/home/webmap/viewer.html",n+=t?"?webmap="+t:"?useExisting=1"),n}function Cg(e){const t=window.location.protocol,n=eI(e);return eI(e)?t!==n&&t===za.Https?tI(e,za.Https):e:tI(e,t)}function Tg(e){return`${e}/sharing/proxy`}function xg(e){if(!e)return e;if(fg(e)){const t=rI(e),n=eI(e),r=t.split("."),i=r[0];r.splice(0,1);const o=r.join(".");let s;return"devext"===i||"mapsdevext.arcgis.com"===o?s="devext.arcgis.com":"qaext"===i||"mapsqa.arcgis.com"===o?s="qaext.arcgis.com":"www"!==i&&"maps.arcgis.com"!==o||(s="www.arcgis.com"),s=s&&`${n?n+"//":""}${s}`,s}return e}function Ag(e){return e=rI(e),["devext.arcgis.com","qaext.arcgis.com","www.arcgis.com"].includes(e)}!function(e){e.Page="pages",e.Dialog="dialogs",e.Header="header",e.Footer="footer",e.View="views",e.ScreenPanel="screens_panel",e.ScreenMain="screens_main"}(Vh||(Vh={})),function(e){e.Page="pages",e.View="view",e.Widget="widget",e.Screen="screen",e.Dialog="dialog",e.Header="header",e.Footer="footer"}(Gh||(Gh={})),function(e){e[e.Row=0]="Row",e[e.Column=1]="Column",e[e.Tab=2]="Tab",e[e.Plain=3]="Plain"}(Wh||(Wh={})),function(e){e.Fade="FADE",e.Cover="COVER",e.Push="PUSH"}(Hh||(Hh={})),function(e){e.Top="TOP",e.Upper="UPPER",e.Lower="LOWER",e.Bottom="BOTTOM"}(zh||(zh={})),function(e){e.Normal="NORMAL",e.Folder="FOLDER",e.Link="LINK"}(qh||(qh={})),function(e){e.FitWindow="FIT_WINDOW",e.AutoScroll="AUTO_SCROLL"}(Jh||(Jh={})),function(e){e.Fixed="FIXED",e.Anchored="ANCHORED"}(Kh||(Kh={})),function(e){e.NoButton="NO_BUTTON",e.ButtonInline="BUTTON_INLINE",e.ButtonBlock="BUTTON_BLOCK"}(Yh||(Yh={})),function(e){e.TopLeft="TOP_LEFT",e.TopRight="TOP_RIGHT",e.BottomLeft="BOTTOM_LEFT",e.BottomRight="BOTTOM_RIGHT",e.TopCenter="TOP_CENTER",e.BottomCenter="BOTTOM_CENTER",e.MiddleLeft="MIDDLE_LEFT",e.MiddleRight="MIDDLE_RIGHT",e.MiddleCenter="MIDDLE_CENTER"}(Xh||(Xh={})),function(e){e.CSV="CSV",e.JSON="JSON",e.GeoJSON="GeoJSON",e.Item="Item",e.Shapefile="Shapefile",e.FileGDB="FGDB",e.KML="KML"}(Qh||(Qh={})),function(e){e.GeoEnrichment="GEOENRICH",e.Geometry="GEOMETRY",e.GeoCoding="GEOCODING",e.Printing="PRINTING",e.Routing="ROUTING",e.GPServer="GPSERVER",e.GPTask="GPTask"}(Zh||(Zh={})),function(e){e.Device="DEVICE",e.Specific="SPECIFIC",e.Data="DATA"}(eg||(eg={})),function(e){e.Required="REQUIRED",e.Optional="OPTIONAL"}(tg||(tg={})),function(e){e.Horizontal="HORIZONTAL",e.Vertical="VERTICAL"}(ng||(ng={})),function(e){e.AppConfigProcessor="APP_CONFIG_PROCESSOR",e.WidgetClassWrapper="WIDGET_CLASS_WRAPPER",e.AppConfigService="APP_CONFIG_SERVICE",e.ReduxStore="REDUX_STORE",e.ReduxActionInterceptor="REDUX_ACTION_INTERCEPTOR",e.DependencyDefine="DEPENDENCY_DEFINE",e.DataSourceFactoryUri="DATA_SOURCE_FACTORY_URI",e.ContextTool="CONTEXT_TOOL",e.AppConfigOperations="APP_CONFIG_OPERATIONS",e.BuilderOperations="BUILDER_OPERATIONS",e.LayoutTransformer="LAYOUT_TRANSFORMER"}(rg||(rg={}));const Dg=[rg.ReduxStore,rg.ReduxActionInterceptor,rg.DataSourceFactoryUri,rg.DependencyDefine,rg.ContextTool,rg.AppConfigOperations,rg.BuilderOperations,rg.LayoutTransformer],Rg=[rg.ContextTool,rg.AppConfigOperations,rg.BuilderOperations];class Pg{}var jg=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const Lg={},_g={};function Mg(e){return jg(this,void 0,void 0,function*(){if(_g[e])return _g[e];let t=[];const n=GI.getInstance().getExtensions(rg.DependencyDefine).filter(t=>t.getDependencyKey()===e)[0];if(n)t=t.concat(n.getResources());else{if(!/^http/.test(e))return console.error("Unknown dependency.",e),Promise.reject(Error(`Unknown dependency: ${e}.`));t.push({url:e})}const r=[];return t.forEach(e=>{Lg[e.url]?r.push(Lg[e.url]):r.push(kg(e))}),_g[e]=Promise.all(r).then(e=>{if(null==n?void 0:n.postInit)return n.postInit()})})}function Ng(e){return jg(this,void 0,void 0,function*(){return e.reduce((e,t)=>jg(this,void 0,void 0,function*(){return e.then(()=>jg(this,void 0,void 0,function*(){return Mg(t)}))}),Mg(e[0]))})}function kg(e){return jg(this,void 0,void 0,function*(){if(e.dependencies&&e.dependencies.length>0)return Promise.all(e.dependencies.map(e=>jg(this,void 0,void 0,function*(){return kg(e)}))).then(()=>jg(this,void 0,void 0,function*(){return delete e.dependencies,kg(e)}));const t=e.url;return Lg[e.url]=NI(t),Lg[e.url]})}var Ug=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function Fg(e){return Ug(this,void 0,void 0,function*(){return yield Mg("jimu-arcgis"),yield kI(e)})}function Bg(e){return Ug(this,void 0,void 0,function*(){return yield Fg([e]).then(e=>e[0])})}function $g(){return Ug(this,void 0,void 0,function*(){const e=kI(["calcite-components"]),t=Bg("esri/kernel");yield Promise.all([e,t]),yield kI(["arcgis-map-components"])})}const Vg={mapServer:"MapServer",imageServer:"ImageServer",featureServer:"FeatureServer",sceneServer:"SceneServer",streamServer:"StreamServer",vectortileServer:"VectorTileServer",GPServer:"GPServer",bigDataCatalogServer:"BigDataCatalogServer",dataReviewerServer:"DataReviewerServer",geoAnalytics:"GeoAnalytics",geocodeServer:"GeocodeServer",geoDataServer:"GeoDataServer",geometryServer:"GeometryServer",globeServer:"GlobeServer",knowledgeGraphServer:"KnowledgeGraphServer",LRServer:"LRServer",mobileServer:"MobileServer",networkDiagramServer:"NetworkDiagramServer",parcelFabricServer:"ParcelFabricServer",relationalCatalogServer:"RelationalCatalogServer",NAServer:"NAServer",schematicsServer:"SchematicsServer",symbolServer:"SymbolServer",topographicProductionServer:"TopographicProductionServer",traceNetworkServer:"TraceNetworkServer",utilityNetworkServer:"UtilityNetworkServer",validationServer:"ValidationServer",versionManagementServer:"VersionManagementServer"};function Gg(e=""){const t=Object.values(Vg),n=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/(admin\\/)?services\\/(.+?)\\/(${t.join("|")}))`,"i"),r=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${t.join("|")}))`,"i"),i=e.match(n)||e.match(r);return i?i[0]:null}function Wg(e=""){const t=/\/rest\/admin\/services(\/|$)/i,n=e.toLowerCase();let r=n.indexOf("/appservices");-1===r&&(r=n.indexOf("/rest/services")),-1===r&&t.test(e)&&(r=e.search(t));return r>-1?e.substring(0,r):null}function Hg(e=""){return!!Gg(e)}function zg(e=""){return!!Wg(e)}function qg(e=""){return Gg(e)||e}function Jg(e=""){return Wg(e)||e}function Kg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var Yg=function e(t,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=Kg({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+o}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},i=0;i<n.length;i++){var o=n[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(r[a]=t.read(s,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",Kg({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Kg({},this.attributes,t))},withConverter:function(t){return e(Kg({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const Xg={loading:"Loading",apply:"Apply",ok:"OK",publish:"Publish",cancel:"Cancel",yes:"Yes",no:"No",open:"Open",close:"Close",new:"New",classic:"Classic",widgetLoadError:"The widget could not be loaded due to an unexpected error.",notPublishError:"This item is not published. Please open this item in Experience Builder, then click <b>&nbsp;Publish&nbsp;</b> to publish it.",versionUpdateMsg:"New updates are available. Click Reload to get the latest updates.",userLocaleChangeMsg:"The user locale has changed. Click Reload to refresh the page.",doUpdate:"Reload",search:"Search",delete:"Delete",about:"About",failed:"Failed",continue:"Continue",neverUnsupportedBrowserTitle:"Unsupported browser",neverUnsupportedBrowserOnlineContent:"You are using a browser that is not supported by [ArcGIS Experience Builder]. Please use the latest version of <chrome-link>Google Chrome</chrome-link>, <firefox-link>Mozilla Firefox</firefox-link>, <safari-link>Apple Safari</safari-link>, or <edge-link>Microsoft Edge</edge-link>. Provide your feedback through <feedback-link>GeoNet, the Esri Community</feedback-link>.",neverUnsupportedBrowserEnterpriseContent:"You are using a browser that is not supported [ArcGIS Experience Builder]. Please use the latest version of <chrome-link>Google Chrome</chrome-link>, <firefox-link>Mozilla Firefox</firefox-link>, <safari-link>Apple Safari</safari-link>, or <edge-link>Microsoft Edge</edge-link>.",message_StringSelectionChange:"String selection changes",message_ExtentChange:"Extent changes",message_DataSourceFilterChange:"Data filtering changes",message_DataRecordsSelectionChange:"Record selection changes",message_DataRecordSetChange:"Records created",message_DataSourcesChange:"Data added",message_SelectDataRecord:"Select data record",message_LocationChange:"Location change",message_ButtonClick:"Button click",message_ViewChange:"Views change",actions:"Actions",noActions:"No available actions",selectedData:"Selected ({count})",allData:"All data ({count})",allDataWithoutCount:"All data",loadedData:"Loaded ({count})",currentData:"Current",export:"Export",exportAll:"Export all",exportSelected:"Export selected",exportingData:"Exporting: {name}",failedToExport:"Failed to export {name}",viewItem:"View item:",largeWarningTitle:"Are you sure you want to export all data records? ",largeWarningContent:"Exporting this large dataset will take time.",tooLargeWarningTitle:"You can only export the first {max} records.",tooLargeWarningContent:"Dataset export is limited to the first {max} records.",dataAction_ExportJson:"Export to JSON",dataAction_ExportCSV:"Export to CSV",dataAction_ExportGeoJson:"Export to GeoJSON",dataAction_ExportItem:"Export to Item",dataAction_ExportShp:"Export to Shapefile",dataAction_ExportGDB:"Export to FGDB",dataAction_ExportKML:"Export to KML",dataAction_SetFilter:"Set filter",dataAction_DataStatistics:"Calculate statistics",dataAction_RelatedData:"View related data",selectionMode:"Selection mode",selectionModeSingle:"Single",selectionModeMultiple:"Multiple",showMore:"Show More",pleaseSelectAField:"Please select a field",countLabel:"Number of values",countEmptyLabel:"Number of empty values",sumLabel:"Sum of values",minLabel:"Minimum",maxLabel:"Maximum",avgLabel:"Average",stddevLabel:"Standard deviation",error:"Error",messageAction_SelectDataRecord:"Select data records",messageAction_FilterDataRecord:"Filter data records",messageAction_TriggerData:"Trigger data",messageAction_ChangeView:"Open view",action_addedData:"Added: {label}",icon:"Icon",verySmall:"Very small",small:"Small",low:"Low",high:"High",large:"Large",varyLarge:"Very large",extraLarge:"Extra large",short:"Short",medium:"Medium",long:"Long",full:"Full",experience:"Experience",template:"Template",widget:"Widget",section:"Section",view:"View",page:"Page",dialog:"Window",makeHome:"Make homepage",makeSplash:"Set as splash",pageWindowSelect:"Switch page and window",layout:"Layout",theme:"Theme",dataSource:"Data source",block:"Block",screenGroup:"Screen group",screen:"Screen",grid:"Grid",locationReferencing:"Location Referencing",dialogConfirmationDefaultText:"I agree to the above terms and conditions",dialogPreventDisplayAgainDefaultText:"Don't show this again",page404Error:"404 \u2014 Page not found{br}The page you\u2019re looking for doesn\u2019t exist or has been moved.",goToHomePage:"Go to home page",publicUserError:"Public Account user cannot access this application.",noEditPrivilegesError:"Your account does not have permission to create or modify data.",noEditContentPrivilegesError:"Your account does not have permission to create or modify content.",essentialAppsLicenseErrorForApp:"Your account is not licensed to use an app that is not public. Please ask your organization administrator to assign you a user type that includes Essential Apps or an add-on Essential Apps license.",essentialAppsLicenseErrorForBuilder:"Your account is not licensed for Experience Builder. Please ask your organization administrator to assign you a user type that includes Essential Apps or an add-on Essential Apps license.",roleError:"Experience Builder Developer Edition requires a level 2 ArcGIS account to work. Please login with an account that has level 2 privileges.",roleError2:"Experience Builder Developer Edition requires an ArcGIS organization account with a user type that includes privileges to create content.",invalidResourceExperience:"This is not a supported item.",invalidResourceItem:"Item does not exist or is inaccessible.",invalidResourcePermission:"Sorry, you do not have permissions to access this application.",invalidResourcePermissionForReadOnly:"Sorry, you only have view permission to this application.",dataSourceCreateError:"Data is inaccessible.",blockedByAdminErrorForApp:"Your organization has blocked access to this application. Please contact your administrator for details.",blockedByAdminErrorForBuilder:"Your organization has blocked access to Experience Builder. Please contact your administrator for details.",readOnlyModeError:"ArcGIS Online is experiencing operational issues and has temporarily switched to read-only mode. Some capabilities may be limited. For the latest updates on when this will be resolved, visit the {link}.",readOnlyModeErrorLink:"ArcGIS Online Health Dashboard",goToAnotherExperienceBtn:"Go to another experience",switchAccountBtn:"Switch account",switch:"Switch",pageRestrictionError:"Sorry, you do not have permissions to access this page.",homepageRestrictionWarning:"There is a visibility restriction set to this page. Please review it carefully in Privacy and security settings.",administrator:"Administrator",publisher:"Publisher",user:"User",signInErrorDefault:"Sorry, you do not have permission to access this resource.",signInErrorsDefault:"Sorry, you do not have permission to access ({names}).",signInErrorEnterCredential:"Sorry, you do not have permission to access this resource. Click to enter credential.",signInErrorCannotEnterCredential:"Sorry, your current account does not have permission to access this resource.",signInErrorTryAgain:"Sorry, you do not have permission to access this resource. Please try again.",signInErrorInvalidToken:"Invalid credential. Please login again.",signInBannerListWarning:"Sorry, you don\u2019t have access to the resources from the following servers or organizations. Click Sign in to provide credentials. Click Ignore to avoid loading the resource until you refresh the app.",signInBannerIgnore:"Ignore",signInBannerIgnoreAll:"Ignore all",signInBannerTitle:"Credential banner",restoreState:"Restore experience state",restoreStateTips:"Restore the state of page, view, window, map viewpoint, and layer visibility where you left off.",restoreStateAccept:"Accept",upgradedFrom:"Upgraded from previous config",versionIsHigh:"Oops.. It seems this experience is built with a higher version of ArcGIS Experience Builder. Please upgrade to the latest version to view.",badVersion:"Oops.. It seems the version of this experience is incorrect. Please check its configuration file.",setClientIdMessage1:"This service is hosted on an ArcGIS Enterprise that the Experience Builder not registered with. Please provide Client ID to {register} first.",registerText:"register",arcgisEnterpriseText:"ArcGIS Enterprise",setClientIdMessage2:"Provide the Client ID for Experience Builder registered in the ArcGIS Enterprise you specify above",experienceVersionRemind:"This experience is in higher version. Incompatible contents may not work.",templateVersionRemind:"This template is in higher version. Incompatible contents may not work.",publishedExperienceVersionRemind:"The published version of this experience is in higher version. Incompatible contents may not work.",publishedTemplateVersionRemind:"The published version of this template is in higher version. Incompatible contents may not work.",draftTemplateVersionRemind:"The draft version of this template is in higher version. Incompatible contents may not work.",draftExperienceVersionRemind:"The draft version of this experience is in higher version. Incompatible contents may not work.",featureLayer:"Feature Layer",featureSet:"Feature Set",featureService:"Feature Service",mapService:"Map Service",groupLayer:"Group Layer",map:"Map",simpleLocal:"Simple Local",webMap:"Web Map",webScene:"Web Scene",csv:"CSV",sceneService:"Scene Service",sceneLayer:"Scene Layer",imageryLayer:"Imagery Layer",imageryTileLayer:"Tiled Imagery Layer",elevationLayer:"Elevation layer",rasterLayer:"Raster Layer",orientedImageryLayer:"Oriented Imagery Layer",SubtypeGroupLayer:"Subtype Group Layer",SubtypeSublayer:"Subtype Sublayer",vectorTileService:"Vector Tile Service",wfsLayer:"WFS Layer",wmsLayer:"WMS Layer",wmtsLayer:"WMTS Layer",kml:"KML",geojson:"GeoJSON",outputView:"{dataSourceLabel} output view",buildingScene:"Building Scene Layer",buildingGroup:"Building Group Sublayer",buildingComponent:"Building Component Sublayer",json:"JSON",exportItem:"Item",import:"Import",a11ySkipTo:"Skip to",a11ySkipToContent:"Skip to {content}"};class Qg{constructor(){this._status="pending",this._promise=new Promise((e,t)=>{this._resolver=e,this._rejecter=t})}resolve(e){return this._status="resolved",this._resolver(e)}reject(e){return this._status="rejected",this._rejecter(e)}get status(){return this._status}get promise(){return this._promise}}const Zg=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e};const em=function(){try{var e=Xl(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const tm=function(e,t,n){"__proto__"==t&&em?em(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var nm=Object.prototype.hasOwnProperty;const rm=function(e,t,n){var r=e[t];nm.call(e,t)&&uu(r,n)&&(void 0!==n||t in e)||tm(e,t,n)};const im=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=r?r(n[a],e[a],a,n,e):void 0;void 0===l&&(l=e[a]),i?tm(n,a,l):rm(n,a,l)}return n};const om=function(e,t){return e&&im(t,Kc(t),e)};const sm=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t};var am=Object.prototype.hasOwnProperty;const lm=function(e){if(!Ml(e))return sm(e);var t=Gc(e),n=[];for(var r in e)("constructor"!=r||!t&&am.call(e,r))&&n.push(r);return n};const um=function(e){return Jc(e)?$c(e,!0):lm(e)};const cm=function(e,t){return e&&im(t,um(t),e)};var dm="object"==typeof exports&&exports&&!exports.nodeType&&exports,pm=dm&&"object"==typeof module&&module&&!module.nodeType&&module,fm=pm&&pm.exports===dm?Sl.Buffer:void 0,hm=fm?fm.allocUnsafe:void 0;const gm=function(e,t){if(t)return e.slice();var n=e.length,r=hm?hm(n):new e.constructor(n);return e.copy(r),r};const mm=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};const vm=function(e,t){return im(e,gc(e),t)};const ym=Wc(Object.getPrototypeOf,Object);const Sm=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)uc(t,gc(e)),e=ym(e);return t}:pc;const bm=function(e,t){return im(e,Sm(e),t)};const wm=function(e){return cc(e,um,Sm)};var Im=Object.prototype.hasOwnProperty;const Em=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Im.call(e,"index")&&(n.index=e.index,n.input=e.input),n};const Om=function(e){var t=new e.constructor(e.byteLength);return new rc(t).set(new rc(e)),t};const Cm=function(e,t){var n=t?Om(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)};var Tm=/\w*$/;const xm=function(e){var t=new e.constructor(e.source,Tm.exec(e));return t.lastIndex=e.lastIndex,t};var Am=bl?bl.prototype:void 0,Dm=Am?Am.valueOf:void 0;const Rm=function(e){return Dm?Object(Dm.call(e)):{}};const Pm=function(e,t){var n=t?Om(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};const jm=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Om(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return Cm(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Pm(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return xm(e);case"[object Symbol]":return Rm(e)}};var Lm=Object.create,_m=function(){function e(){}return function(t){if(!Ml(t))return{};if(Lm)return Lm(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const Mm=_m;const Nm=function(e){return"function"!=typeof e.constructor||Gc(e)?{}:Mm(ym(e))};const km=function(e){return Rl(e)&&"[object Map]"==hd(e)};var Um=kc&&kc.isMap;const Fm=Um?Lc(Um):km;const Bm=function(e){return Rl(e)&&"[object Set]"==hd(e)};var $m=kc&&kc.isSet;const Vm=$m?Lc($m):Bm;var Gm="[object Arguments]",Wm="[object Function]",Hm="[object Object]",zm={};zm[Gm]=zm["[object Array]"]=zm["[object ArrayBuffer]"]=zm["[object DataView]"]=zm["[object Boolean]"]=zm["[object Date]"]=zm["[object Float32Array]"]=zm["[object Float64Array]"]=zm["[object Int8Array]"]=zm["[object Int16Array]"]=zm["[object Int32Array]"]=zm["[object Map]"]=zm["[object Number]"]=zm[Hm]=zm["[object RegExp]"]=zm["[object Set]"]=zm["[object String]"]=zm["[object Symbol]"]=zm["[object Uint8Array]"]=zm["[object Uint8ClampedArray]"]=zm["[object Uint16Array]"]=zm["[object Uint32Array]"]=!0,zm["[object Error]"]=zm[Wm]=zm["[object WeakMap]"]=!1;const qm=function e(t,n,r,i,o,s){var a,l=1&n,u=2&n,c=4&n;if(r&&(a=o?r(t,i,o,s):r(t)),void 0!==a)return a;if(!Ml(t))return t;var d=ml(t);if(d){if(a=Em(t),!l)return mm(t,a)}else{var p=hd(t),f=p==Wm||"[object GeneratorFunction]"==p;if(xc(t))return gm(t,l);if(p==Hm||p==Gm||f&&!o){if(a=u||f?{}:Nm(t),!l)return u?bm(t,cm(a,t)):vm(t,om(a,t))}else{if(!zm[p])return o?t:{};a=jm(t,p,l)}}s||(s=new Ku);var h=s.get(t);if(h)return h;s.set(t,a),Vm(t)?t.forEach(function(i){a.add(e(i,n,r,i,t,s))}):Fm(t)&&t.forEach(function(i,o){a.set(o,e(i,n,r,o,t,s))});var g=d?void 0:(c?u?wm:Yc:u?um:Kc)(t);return Zg(g||t,function(i,o){g&&(i=t[o=i]),rm(a,o,e(i,n,r,o,t,s))}),a};const Jm=function(e){return qm(e,5)};var Km,Ym=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};!function(e){e.AppList="AppList",e.Builder="Builder",e.Experience="Experience"}(Km||(Km={}));const Xm="OAUTH_0070";function Qm(e){return Ym(this,void 0,void 0,function*(){return yield ev(e).then(e=>e.valid)})}function Zm(e){return Ym(this,void 0,void 0,function*(){return yield gv(e).then(e=>Ym(this,void 0,void 0,function*(){return yield av(e)}))})}function ev(e,t,n){return Ym(this,void 0,void 0,function*(){return yield gv(e,n).then(r=>Ym(this,void 0,void 0,function*(){const i=function(e,t,n){return Ym(this,void 0,void 0,function*(){const r=rv(),i={valid:!0,isExperience:!0,isValidItem:!0,hasPermissionToAccess:!0,viewOnly:!1};return e===Km.AppList||window.jimuConfig.isDevEdition?yield Promise.resolve(i):r?/\.json$/.test(r)||/^https/.test(r)?yield Promise.resolve(i):yield pv(r,n).then(n=>Ym(this,void 0,void 0,function*(){if(!n||"Web Experience"!==n.type&&"Web Experience Template"!==n.type)return i.valid=!1,i.isExperience=!1,i;{const r=!!TE().getState().queryObject.template;if(e===Km.Builder&&!r){(yield tv(n))||t||(i.valid=!1,i.hasPermissionToAccess=!1)}return n.origin&&(i.viewOnly=!0),i}})).catch(e=>(e&&"CONT_0001"===e.code?(i.valid=!1,i.isValidItem=!1):(i.valid=!1,i.hasPermissionToAccess=!1),i)):yield Promise.resolve(i)})}(e,t,n),o=function(e){return Ym(this,void 0,void 0,function*(){return window.jimuConfig.isDevEdition||e!==Km.Builder&&e!==Km.AppList?Promise.resolve(!0):yield uv().then(e=>!(!e||!e.orgId)).catch(()=>!1)})}(e),s=function(e){return Ym(this,void 0,void 0,function*(){return yield ov().then(t=>Ym(this,void 0,void 0,function*(){return window.jimuConfig.isDevEdition&&t&&(e===Km.Builder||e===Km.AppList)?yield function(){return Ym(this,void 0,void 0,function*(){return yield uv().then(e=>!(!e||"2"!==e.level)).catch(()=>!1)})}():yield Promise.resolve(!0)}))})}(e),a=function(e,t){return Ym(this,void 0,void 0,function*(){return yield av(t).then(t=>{const n={valid:!1,capabilities:t,invalidInfo:cl.PrivilegeNullInfo,invalidMessage:""};if(window.jimuConfig.isDevEdition){if(e===Km.AppList)return n.valid=t.canCreateExperience,n;if(e===Km.Builder)return n.valid=t.canCreateExperience,n;if(e===Km.Experience)return n.valid=!0,n}else{if(e===Km.AppList)return n.valid=!0,n;if(e===Km.Builder)return n.valid=t.canCreateExperience,n;if(e===Km.Experience)return n.valid=!0,n}})})}(e,r),l=function(e,t){return Ym(this,void 0,void 0,function*(){const n=TE().getState();return window.jimuConfig.isDevEdition?yield Promise.resolve({valid:!0,viewOnly:!1}):e===Km.Builder||e===Km.AppList?yield Promise.resolve(t):n.appId?/^\/templates\/.*\.json$/.test(n.appId)?yield Promise.resolve({valid:!0,viewOnly:!1}):yield function(e){return Ym(this,void 0,void 0,function*(){return yield pv(e).then(e=>e&&"public"===e.access)})}(n.appId).then(e=>e&&(t.valid||t.messageCode!==Xm)?{valid:!0,viewOnly:!1}:t).catch(e=>({valid:!0,viewOnly:!1})):Promise.resolve({valid:!0,viewOnly:!1})})}(e,r);return yield Promise.all([i,o,s,a,l])})).then(t=>{const[n,r,i,o,s]=t,a={valid:n.valid&&r&&i&&o.valid&&s.valid&&(e!==Km.Builder||!n.viewOnly&&!s.viewOnly),capabilities:{canViewExperience:i&&o.capabilities.canViewExperience&&s.valid,canCreateExperience:!n.viewOnly&&i&&o.capabilities.canCreateExperience&&s.valid&&!s.viewOnly,canUpdateExperience:!n.viewOnly&&i&&o.capabilities.canUpdateExperience&&s.valid&&!s.viewOnly,canDeleteExperience:!n.viewOnly&&i&&o.capabilities.canDeleteExperience&&s.valid&&!s.viewOnly,canShareExperience:!n.viewOnly&&i&&o.capabilities.canShareExperience&&s.valid&&!s.viewOnly,canEditFeature:o.capabilities.canEditFeature},invalidInfo:cl.PrivilegeNullInfo,invalidMessage:""};return a.invalidInfo=function(e,t,n,r,i,o){let s=cl.PrivilegeNullInfo;s=r?o.valid?!i.valid||!n||e===Km.Builder&&o.viewOnly?cl.PrivilegeInvalidPrivilege:t.valid&&e===Km.Builder&&t.viewOnly?cl.PrivilegeInvalidResourcePermissionForReadOnly:t.valid?cl.PrivilegeNullInfo:t.isExperience?t.isValidItem?cl.PrivilegeInvalidResourcePermission:cl.PrivilegeInvalidResourceItem:cl.PrivilegeInvalidResourceExperience:o.messageCode===Xm?cl.PrivilegeInvalidAppBlockedByOrg:cl.PrivilegeInvalidLicense:cl.PrivilegeInvalidUserLevel;return s}(e,n,r,i,o,s),a.invalidMessage=nv(e,a.invalidInfo),a})})}const tv=e=>Ym(void 0,void 0,void 0,function*(){var t;if(!lv())return!1;const n=yield uv(),r=!!window.jimuConfig.isInPortal||"self"===e.contentOrigin,i=!!n&&("org_admin"===n.role&&(null===(t=n.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItems")))&&r,o=e.owner===(null==n?void 0:n.username),s=yield mv(e.id);return!!(i||o||s)});function nv(e,t){const n=Tb();let r="";return lv()?t===cl.PrivilegeInvalidLicense?e===Km.Builder||e===Km.AppList?r=n.formatMessage({id:"essentialAppsLicenseErrorForBuilder",defaultMessage:Xg.essentialAppsLicenseErrorForBuilder}):e===Km.Experience&&(r=n.formatMessage({id:"essentialAppsLicenseErrorForApp",defaultMessage:Xg.essentialAppsLicenseErrorForApp})):t===cl.PrivilegeInvalidAppBlockedByOrg?e===Km.Builder||e===Km.AppList?r=n.formatMessage({id:"blockedByAdminErrorForBuilder",defaultMessage:Xg.blockedByAdminErrorForBuilder}):e===Km.Experience&&(r=n.formatMessage({id:"blockedByAdminErrorForApp",defaultMessage:Xg.blockedByAdminErrorForApp})):t===cl.PrivilegeInvalidPrivilege?r=window.jimuConfig.isDevEdition?n.formatMessage({id:"roleError2",defaultMessage:Xg.roleError2}):n.formatMessage({id:"noEditContentPrivilegesError",defaultMessage:Xg.noEditContentPrivilegesError}):t===cl.PrivilegeInvalidUserLevel?r=n.formatMessage({id:"roleError",defaultMessage:Xg.roleError}):t===cl.PrivilegeInvalidResourceExperience?r=n.formatMessage({id:"invalidResourceExperience",defaultMessage:Xg.invalidResourceExperience}):t===cl.PrivilegeInvalidResourceItem?r=n.formatMessage({id:"invalidResourceItem",defaultMessage:Xg.invalidResourceItem}):t===cl.PrivilegeInvalidResourcePermission?r=n.formatMessage({id:"invalidResourcePermission",defaultMessage:Xg.invalidResourcePermission}):t===cl.PrivilegeInvalidResourcePermissionForReadOnly?r=n.formatMessage({id:"invalidResourcePermissionForReadOnly",defaultMessage:Xg.invalidResourcePermissionForReadOnly}):t===cl.PrivilegeInvalidMainSession&&(r=n.formatMessage({id:"signInErrorInvalidToken",defaultMessage:Xg.signInErrorInvalidToken})):r=t===cl.PrivilegeInvalidResourceExperience?n.formatMessage({id:"invalidResourceExperience",defaultMessage:Xg.invalidResourceExperience}):t===cl.PrivilegeInvalidResourceItem?n.formatMessage({id:"invalidResourceItem",defaultMessage:Xg.invalidResourceItem}):"",r}function rv(){const e=TE().getState();return e.appId||e.queryObject.id}function iv(){return Ym(this,void 0,void 0,function*(){return yield function(){return Ym(this,void 0,void 0,function*(){const e=TE().getState(),t=e.portalSelf,n=e.portalUrl;return t?yield Promise.resolve(t):n?yield Rv(n):yield Promise.resolve(null)})}().then(e=>e&&e.isPortal?e.currentVersion:null).catch(e=>null)})}function ov(){return Ym(this,void 0,void 0,function*(){const e=yield iv();return!!e&&Number(e)<=6.1})}function sv(){return Ym(this,void 0,void 0,function*(){const e=yield iv();return!!e&&Number(e)<=7.3})}function av(e){return Ym(this,void 0,void 0,function*(){const t={canViewExperience:!0,canCreateExperience:!1,canUpdateExperience:!1,canDeleteExperience:!1,canShareExperience:!1,canEditFeature:!1};return yield cv().then(n=>Ym(this,void 0,void 0,function*(){const r=n&&e.valid&&!e.viewOnly;return t.canCreateExperience=r,t.canUpdateExperience=r,t.canDeleteExperience=r,t.canShareExperience=r,yield function(){return Ym(this,void 0,void 0,function*(){return yield uv().then(e=>!!(e&&e.privileges&&e.privileges.indexOf&&e.privileges.includes("features:user:edit"))).catch(()=>!0)})}()})).then(e=>(t.canEditFeature=e,t))})}function lv(){return Tv.getInstance().getMainSession()}const uv=()=>Ym(void 0,void 0,void 0,function*(){const e=lv();return e?yield e.getUser().then(e=>e).catch(t=>Ym(void 0,void 0,void 0,function*(){return console.log(t&&t.message,`You are currently signed in as: '${e.username}'.`),yield Promise.reject(new Error(null))})):(console.log("The user has not signed in."),yield Promise.reject(new Error(null)))});function cv(){return Ym(this,void 0,void 0,function*(){return yield uv().then(e=>!!(e&&e.privileges&&e.privileges.indexOf&&e.privileges.includes("portal:user:createItem"))).catch(()=>!1)})}function dv(){return Ym(this,void 0,void 0,function*(){return yield uv().then(e=>!!(e&&e.privileges&&e.privileges.indexOf&&e.privileges.includes("portal:publisher:publishFeatures"))).catch(()=>!1)})}const pv=(e,t)=>Ym(void 0,void 0,void 0,function*(){const n=lv(),r=TE().getState().appInfo;return r&&r.name&&!t?yield Promise.resolve(r):yield Nv(e,t).then(e=>e).catch(e=>Ym(void 0,void 0,void 0,function*(){return console.log(e&&e.message,`You are currently signed in as: '${null==n?void 0:n.username}'.`),yield Promise.reject(e)}))});function fv(e){return Ym(this,void 0,void 0,function*(){return!window.jimuConfig.isDevEdition||(e===Km.Builder||e===Km.AppList)&&!(yield ov())})}let hv=null;function gv(e,t){return Ym(this,void 0,void 0,function*(){const n=TE().getState().portalUrl,r=(yield sv())?"arcgisWebApps":"experienceBuilder";return hv&&!t||(hv=(yield fv(e))?yield function(e,t){return Ym(this,void 0,void 0,function*(){const n={valid:!1,viewOnly:!1,messageCode:""},r=Tv.getInstance().getSessionByUrl(e);if(r){const e=`${r.portal}/oauth2/validateAppAccess?client_id=${t}`;return yield Pr(e,{authentication:r}).then(e=>(!1===e.valid?(n.messageCode=e.messageCode||"",console.log("not-authorized",`You are currently signed in as: '${r.username}'.`)):(n.valid=!0,n.viewOnly=!!e.viewOnlyUserTypeApp),n)).catch(e=>Ym(this,void 0,void 0,function*(){return console.log(e&&e.message,`You are currently signed in as: '${r.username}'.`),yield Promise.resolve(n)}))}return yield Promise.resolve(n)})}(n,r):yield Promise.resolve({valid:!0,viewOnly:!1})),hv})}function mv(e,t){return Ym(this,void 0,void 0,function*(){return uv().then(n=>{var r;const i=t||lv(),o=null===(r=null==n?void 0:n.groups)||void 0===r?void 0:r.filter(e=>e.capabilities.indexOf("updateitemcontrol")>-1);return(null==o?void 0:o.length)>0&&ki(e,{authentication:i}).then(e=>{const t=[].concat(e.admin).concat(e.member).concat(e.other);return o.some(e=>t.some(t=>t.id===e.id))})}).catch(e=>!1)})}const vv=e=>Ym(void 0,void 0,void 0,function*(){var t;const n=[];if(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder)return n;if(!e.permission||!e.permission.restrictions||!e.permission.restrictions.length)return n;const r=TE().getState(),i=lv()&&(yield uv());if(window.jimuConfig.isDevEdition){const e=r.appInfo.portalUrl===r.portalUrl,o=!!i&&("org_admin"===i.role&&(null===(t=i.privileges)||void 0===t?void 0:t.includes("portal:admin:updateItems"))),s=r.appInfo.owner===(null==i?void 0:i.username);if(e&&(o||s))return n}else{const e=rv(),t=yield pv(e,!0);if(yield tv(t))return n}const o=null==e?void 0:e.pages;return(o&&Object.keys(o)||[]).filter(t=>function(e,t,n){const r=lv(),i=(null==n?void 0:n.permission.restrictions)||[];let o=[],s=[];if(i.forEach(t=>{var n;t.pageIds.find(t=>t===e)&&(o=o.concat((null===(n=t.roleIds)||void 0===n?void 0:n.map(e=>({roleId:e,orgId:t.orgId})))||[]),s=s.concat(t.groupIds||[]))}),o.length||s.length){if(r){const e=o.some(e=>e.orgId===t.orgId&&e.roleId===(t.roleId||t.role)),n=s.some(e=>{var n;return null===(n=t.groups)||void 0===n?void 0:n.some(t=>t.id===e)});return!e&&!n}return!0}return!1}(t,i,e))});var yv,Sv,bv,wv=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};!function(e){e.TokenRequired="TOKEN_REQUIRED",e.InvalidToken="INVALID_TOKEN",e.NoPermission="NO_PERMISSION",e.SignInCanceled="SIGN_IN_CANCELED",e.Other="OTHER"}(yv||(yv={})),function(e){e.ArcGISJSAPISync="ARCGIS_JSAPI",e.PostMessageSync="POST_MESSAGE",e.OtherWindowSync="OTHER_WINDOW",e.AddOrUpdate="ADD_OR_UPDATE",e.Remove="REMOVE"}(Sv||(Sv={})),function(e){e.PortalSession="PORTAL_SESSION",e.ServerSessionFederated="SERVER_SESSION_FEDERATED",e.ServerSessionStandAlone="SERVER_SESSION_STAND_ALONE",e.ServerSessionStandAloneWebTier="SERVER_SESSION_STAND_ALONE_WEB_TIER"}(bv||(bv={}));const Iv=12e5,Ev=!0,Ov="exb_auth_states";class Cv{getMainSession(){var e;if(!this.sessions||!this.getMainPortal())return null;const t=this.sessions[this.getSessionKeyFromUrl(null===(e=this.getMainPortal())||void 0===e?void 0:e.portalUrl)];return this.isSessionExpired(t)?null:t}getSessions(){if(!this.sessions)return[];const e={};return Object.keys(this.sessions).forEach(t=>{const n=this.sessions[t];this.isSessionExpired(n)?n.canRefresh&&(e[t]=n):e[t]=n}),this.sessions=e,Object.keys(this.sessions).map(e=>this.sessions[e])}clearSessions(){delete this.sessions}onSessionChanged(e){if(this.onSessionChangedCallbacks){const t=this.getSessions();this.onSessionChangedCallbacks.forEach(n=>{n(t,e)})}}static getInstance(){return Cv.instance||(Cv.instance=new Cv,window._sessionManager=Cv.instance,this.instance.isSigning=!1,this.instance.signInUrlFromQueue="",this.instance.signInQueue=[],this.instance.onSessionChangedCallbacks=[],this.instance.requestCacheForValidatingToken={},this.instance.signInDialogPendingList={},this.instance.noPermissionResourceInfoList={}),Cv.instance}constructor(){this.readSessionFromParentPromise=null,this.isMainSession=e=>{if(!e)return!1;if(this.isSessionExpired(e))return!1;const t=this.getSessionKeyFromUrl(e.portal),n=this.getMainPortal();return!(!(null==n?void 0:n.portalUrl)||t!==this.getSessionKeyFromUrl(null==n?void 0:n.portalUrl)||e.clientId!==(null==n?void 0:n.clientId))},this.processInvalidSignInSession=()=>{this.removeAuthInfo(),this.clearSessions()},this.gotoSignInPage=()=>{var e,t;const n=!window.jimuConfig.isSite&&!window.jimuConfig.isBuilder,r=`${window.location.pathname}${window.location.search}${window.location.hash}`;window.jimuConfig.isDevEdition&&(null===(t=null===(e=TE().getState())||void 0===e?void 0:e.portalUrl)||void 0===t?void 0:t.includes("www.arcgis.com"))?this.gotoLandingPage():window.jimuConfig.isInPortal||window.jimuConfig.isBuilder||n?this.signIn({fromUrl:r,popup:!1}):this.gotoLandingPage()},this.gotoLandingPage=()=>{let e;if(window.jimuConfig.isDevEdition)e=`${location.protocol}//${location.host}${window.jimuConfig.mountPath}page/set-portalurl`;else{e=`${location.protocol}//${location.host}/page/landing`;const t=TE().getState().queryObject;t.locale&&(e=oI(e,"locale",t.locale)),t.__env__&&(e=oI(e,"__env__",t.__env__))}0!==window.location.href.indexOf(e)&&(window.location.href=e)},this.gotoPrivilegeErrorPage=e=>{TE().dispatch(HD({type:ul.PrivilegeError,code:e}))},this.handleAuthError=(e,...t)=>wv(this,[e,...t],void 0,function*(e,t=!0){const n=e.options,r=e instanceof Ar&&n&&(!n.authentication||498===e.code||"AUTHENTICATION_ERROR_CODE"===e.code),i=e instanceof fr&&!n.authentication;if(r||i){const n=this.getSessionKeyFromUrl(e.url);this.sessions&&this.sessions[n]&&delete this.sessions[n];const r=t?null:window.location&&window.location.href;return yield this.signIn({fromUrl:r,popup:t,desUrl:e.url})}throw new Error(e)}),this.onMessage=e=>{var t,n,r;if("arcgis:auth:requestCredential"===e.data.type){if(!this.canPostSessionTo(e.origin))return;try{const r={dev:/.*dev\.arcgis\.com$/,qa:/.*qa\.arcgis\.com$/,prod:/.*\.arcgis\.com$/};let i;const o=rI(e.origin);i=r.dev.test(o)?"https://devext.arcgis.com":r.qa.test(o)?"https://qaext.arcgis.com":r.prod.test(o)?"https://www.arcgis.com":null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl;const s=this.getSessionByUrl(i);if(!s)return void e.source.postMessage({type:"arcgis:auth:error",error:{name:"NoCredential",message:"Does not find credential."}},e.origin);let a=s.toCredential();a.server=a.server.replace("/sharing/rest",""),null===(n=e.source)||void 0===n||n.postMessage({type:"arcgis:auth:credential",credential:a},e.origin)}catch(t){null===(r=e.source)||void 0===r||r.postMessage({type:"arcgis:auth:error",error:{name:t.name,message:t.message}},e.origin),console.error("Response requestCredential error.",t)}}else if("arcgis:auth:credential"===e.data.type){const t=TE().getState().queryObject["arcgis-auth-origin"];if(!(e.origin===window.location.origin||e.origin===t)||!e.data.credential)return;this.addFromCredential(e.data.credential,Sv.PostMessageSync).then(e=>{this.readSessionFromParentPromise&&this.readSessionFromParentPromise.resolve(e)}).catch(e=>{console.error("Get session from parent error.",e),this.readSessionFromParentPromise&&this.readSessionFromParentPromise.resolve(null)})}},this.onMessage=this.onMessage.bind(this),window.addEventListener("message",this.onMessage,!1),this.clientIdDialogResultPromises={},window.jimuConfig.isInBuilder&&xE((e,t)=>{void 0===e?Sy():t.some(e=>{const t=this.getSessionKeyFromUrl(e.portalUrl);return!!this.clientIdDialogResultPromises[t]&&(this.onClientIdDialogFinished(e.portalUrl,e.clientId),!0)})},["appConfig","connections"]),window.jimuConfig.isInBuilder||(window.addEventListener("visibilitychange",e=>{"visible"===document.visibilityState&&(console.debug("^^^^ check session expiration when current page is visible"),this.refreshSessions())}),setInterval(()=>{this.refreshSessions()},Iv))}needToRefreshSession(e){const t=(new Date).getTime();return e.tokenExpires-t<=Iv}refreshFederatedSessionsBelongToThePortalSession(e,t){return wv(this,void 0,void 0,function*(){const n=[];return Object.values(this.sessions||{}).forEach(r=>{if(r.portal&&r.server&&r.portal===e.portal){console.debug("---- try refreshing session, ","current time: ",new Date,` expiration time: ${r.tokenExpires}`," - ",`portal: ${r.portal}`,`server: ${r.server||""}`);const i=tI(rI(window.location.href),za.Https),o=`serverUrl=${r.server}&referer=${i}&token=${e.token}`;n.push(this.generateToken(dg(r.portal),o,t).then(e=>(e?r.updateToken(e.token,new Date(e.expires)):console.warn("Refresh sessions failed: generate token info is null"),Promise.resolve())).catch(e=>(console.warn("Refresh sessions failed: generate token request failed",e),Promise.resolve())))}}),Promise.allSettled(n)})}refreshPortalSession(e){return wv(this,void 0,void 0,function*(){return e.canRefresh?e.refreshCredentials().then(()=>(this.isMainSession(e)&&this.writeAuthInfo(e),this.refreshFederatedSessionsBelongToThePortalSession(e))).catch(e=>(console.warn("Refresh sessions failed: refresh credentials request failed",e),Promise.reject(new Error(e)))):(console.warn("Refresh sessions failed: session cannot be refreshed"),Promise.reject(new Error(null)))})}refreshWebTierPortalSession(e){return wv(this,void 0,void 0,function*(){return this.getSessionFromWebTierPortal(dg(e.portal)).then(t=>t?(this.isMainSession(e)&&this.writeAuthInfo(t),e.updateToken(t.token,t.tokenExpires),this.refreshFederatedSessionsBelongToThePortalSession(t,"include")):(console.warn("Refresh webTier portal sessions failed: generate webTier portal token failed"),Promise.reject(new Error(null))))})}refreshSessions(){const e=[];console.debug("==== check session expiration, ","current time: ",new Date),Object.values(this.sessions||{}).forEach(t=>{if(t.portal&&!t.server)if(t.canRefresh&&this.needToRefreshSession(t)){console.debug("---- try refreshing session, ","current time: ",new Date,` expiration time: ${t.tokenExpires}`," - ",`portal: ${t.portal}`,`server: ${t.server||""}`);const n=this.refreshPortalSession(t).catch(()=>(console.warn("Refresh sessions failed: try a second request"),this.refreshPortalSession(t).catch(()=>(console.warn("Refresh sessions failed: try a second request and it fails"),Promise.resolve()))));e.push(n)}else{const{portalUrl:n,isWebTier:r}=TE().getState();if((r&&pg(t.portal,n)||this.isTrustedServer(t.portal))&&this.needToRefreshSession(t)){console.debug("---- try refreshing webTier portal session, ","current time: ",new Date,` expiration time: ${t.tokenExpires}`," - ",`portal: ${t.portal}`,`server: ${t.server||""}`);const n=this.refreshWebTierPortalSession(t).catch(()=>Promise.resolve());e.push(n)}else{const e=t.canRefresh?"session has not expired":"session cannot be refreshed";console.debug(`**** ${e}, `,"current time: ",new Date,` expiration time: ${t.tokenExpires}`," - ",`portal: ${t.portal}`,`server: ${t.server||""}`)}}}),Promise.allSettled(e).then(e=>{(null==e?void 0:e.length)>0&&(this.syncToOtherWindowSessionManager(),this.onSessionChanged(Sv.AddOrUpdate))})}initSession(){return wv(this,void 0,void 0,function*(){const e=window.location.pathname;if(new RegExp(`^${window.jimuConfig.mountPath}page/set-portalurl`).test(e)||/^\/page\/landing/.test(e))return Promise.resolve();const t=TE().getState().queryObject["arcgis-auth-origin"];return t?this.readSessionFromParent(t).then(e=>{this.readSessionFromParentPromise=null}):this.initSessionFromCookieOrStorage().then(()=>{this.refreshSessions()})})}initSessionFromCookieOrStorage(){return wv(this,void 0,void 0,function*(){var e;this.initResourceSessionsFromStorage();const t=this.getMainPortal();if(!t)return;let n=cg(t.portalUrl);eI(n)||(n=tI(n,za.Https));const r=this.isValidTokenFromStorage(t.portalUrl),i=li(null==t?void 0:t.clientId,n,n).then(e=>e).catch(()=>null),[o,s]=yield null===(e=Promise.allSettled([r,i]))||void 0===e?void 0:e.then(e=>e.map(e=>null==e?void 0:e.value)),a=yield this.getSessionFromStorage();if(a){const e=this.getSessionKeyFromUrl(a.portal);o&&s?a.username===s.username?this.setSession(e,a):this.setSessionByPlatformSelfResponse(s,t):!o&&s?this.setSessionByPlatformSelfResponse(s,t):o&&!s&&(!fg(window.location.host)||window.jimuConfig.isDevEdition||this.readCookie("esri_locale"))?this.setSession(e,a):this.failedToInitSession()}else s?this.setSessionByPlatformSelfResponse(s,t):this.failedToInitSession()})}initResourceSessionsFromStorage(){(this.readResourcesAuthInfo()||[]).forEach(e=>{e.tokenExpires=e.tokenExpires?new Date(e.tokenExpires):null,e.refreshTokenExpires=e.refreshTokenExpires?new Date(e.refreshTokenExpires):null;const t=new oi(e);t.server?(t.portal=void 0,this.isValidToken(`${t.server}/rest/services`,t.token).then(e=>{var n;return!(!e.valid||!(null===(n=e.response)||void 0===n?void 0:n.currentVersion))&&this.addOrReplaceSession(t)})):t.canRefresh?t.refreshCredentials().then(()=>this.addOrReplaceSession(t)):t.token&&this.isValidToken(`${t.portal}/sharing/rest`,t.token).then(e=>{var n;return!(!e.valid||!(null===(n=e.response)||void 0===n?void 0:n.currentVersion))&&this.addOrReplaceSession(t)})})}failedToInitSession(){if(this.processInvalidSignInSession(),window.jimuConfig.isSite||window.jimuConfig.isBuilder)throw this.gotoSignInPage(),new Error("Should signIn")}setSessionByPlatformSelfResponse(e,t){let n=cg(t.portalUrl);eI(n)||(n=tI(n,za.Https));const r={expires:(new Date).getTime()+1e3*e.expires_in,server:n,ssl:!0,token:e.token,userId:e.username};let i=oi.fromCredential(r,{hasPortal:!1,hasServer:!1,server:""}),o=i.toJSON();o.clientId=t.clientId,i=new oi(o);const s=this.getSessionKeyFromUrl(i.portal);this.setSession(s,i)}isValidTokenFromStorage(e){return wv(this,void 0,void 0,function*(){const t=yield this.getSessionFromStorage();if((null==t?void 0:t.token)&&e){const n=`${e}/sharing/rest`,r=TE().getState().isWebTier?{credentials:"include"}:{};return this.isValidToken(n,t.token,r).then(e=>{var t;return!(!e.valid||!(null===(t=e.response)||void 0===t?void 0:t.currentVersion))})}return Promise.resolve(!1)})}isValidToken(e,t){return wv(this,arguments,void 0,function*(e,t,n={}){if(t){const r=`${e=qg(e=iI(e))}?f=json&token=${t}`,i=`${e}_${t}`;if(this.requestCacheForValidatingToken[i])return this.requestCacheForValidatingToken[i];{const e=fetch(r,n).then(e=>e.json()).then(e=>(null==e?void 0:e.error)?{valid:!1,error:e.error}:{valid:!0,response:e,error:null}).catch(e=>(console.warn("failed to validate token."),{valid:!1,error:e}));return this.requestCacheForValidatingToken[i]=Promise.resolve(e),e}}return Promise.resolve({valid:!1,error:null})})}isSameSession(e,t){var n,r;return!(!e||!t)&&(e.portal===t.portal&&e.server===t.server&&e.username===t.username&&e.clientId===t.clientId&&e.ssl===t.ssl&&e.token===t.token&&(null===(n=e.tokenExpires)||void 0===n?void 0:n.valueOf())===(null===(r=t.tokenExpires)||void 0===r?void 0:r.valueOf())&&e.refreshToken===t.refreshToken)}getUserInfo(e){return wv(this,void 0,void 0,function*(){const t=e||this.getMainSession(),n=TE().getState().user;return n&&t&&n.username===t.username?yield Promise.resolve(TE().getState().user.asMutable({deep:!0})):t?yield t.getUser().then(e=>(this.afterGetUserInfo(e),e)):Promise.resolve(null)})}afterGetUserInfo(e){TE().dispatch(gD(e));const t=null===e.culture?"":e.culture;if(null!==Ow(_d)){if(Ow(_d)!==t){Cw(_d,t);const n=TE().getState().queryObject.locale||e.culture||bb(window.navigator);window.locale!==n&&Rb(n)}}else Cw(_d,t)}getMainPortal(){const e=TE().getState();if(!e.portalUrl)return null;return{portalUrl:e.portalUrl,clientId:e.clientId,isWebTier:e.isWebTier}}getTrustedServers(){var e;const t=TE().getState(),n=null===(e=null==t?void 0:t.portalSelf)||void 0===e?void 0:e.authorizedCrossOriginDomains;return!this.trustedServers&&n&&(this.trustedServers=n.map(e=>tI(rI(e),za.Https))),this.trustedServers||[]}isTrustedServer(e){return this.getTrustedServers().some(t=>e.includes(t))}removeSession(e){if(!e)return!1;const t=this.getSessionKeyFromSession(e);if(this.removeSessionByKey(t)){if(this.getSessionType(e)===bv.PortalSession&&e.signOut(),this.isMainSession(e)&&(TE().dispatch(mD()),this.removeAuthInfo()),!(window.jimuConfig.isBuilder||e.portal&&e.server)){const t=xg(hg(e.portal))||Jg(e.server);TE().dispatch(YD(t,null))}return this.removeServerSessionsByPortalSession(e),this.syncToOtherWindowSessionManager(),this.onSessionChanged(Sv.Remove),this.updateResourcesAuthInfo(),!0}return!1}removeSessionByKey(e){return!!e&&(this.sessions&&this.sessions[e]&&delete this.sessions[e],!0)}addOrReplaceSession(e){if(!e)return!1;if(this.doAddOrReplaceSession(e)){this.syncToOtherWindowSessionManager(),this.onSessionChanged(Sv.AddOrUpdate);const t=e.server?`${e.server}/rest/services`:e.portal;return this.releasePendingSignIn(t),!0}return!1}doAddOrReplaceSession(e){if(!e)return!1;const t=this.getSessionKeyFromSession(e);return!!t&&(this.setSession(t,e),!0)}setSession(e,t){var n;if(this.isSessionExpired(t))return;this.sessions||(this.sessions={});const r=this.sessions[e];this.removeServerSessionsByPortalSession(r),this.sessions[e]=t;const i=null===(n=this.getMainPortal())||void 0===n?void 0:n.portalUrl,o=e===this.getSessionKeyFromUrl(i);if(o&&this.updatingAfterMainSessionChanged(t,r),!(window.jimuConfig.isBuilder||t.portal&&t.server||o)){const e=xg(hg(t.portal))||Jg(t.server);TE().dispatch(YD(e,t.username))}this.updateResourcesAuthInfo()}updatingAfterMainSessionChanged(e,t){return wv(this,void 0,void 0,function*(){if(!TE().getState().user||e.username!==(null==t?void 0:t.username)){if(yield Rv(e.portal,!0),yield this.getUserInfo(e),!window.jimuConfig.isBuilder){const t=xg(hg(e.portal));TE().dispatch(YD(t,e.username))}window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder||!t||ev(Km.Experience,!1,!0).then(e=>{e.valid||TE().dispatch(HD({type:ul.PrivilegeError,code:e.invalidInfo,message:e.invalidMessage}))})}this.writeAuthInfo(e)})}removeServerSessionsByPortalSession(e){if(e&&e.portal&&!e.server){this.getSessions().forEach(t=>{if(t.server&&t.portal===e.portal&&t.username===e.username){const e=this.getSessionKeyFromSession(t);this.removeSessionByKey(e)}})}}getSessionByUrl(e){if(!this.sessions)return;let t=this.getSessionKeyFromUrl(e),n=this.sessions[t];if((null==n?void 0:n.server)&&(null==n?void 0:n.portal)){const e=this.getPortalKeyFromUrl(n.portal);n=this.sessions[e]}return n}getSessionKeyFromSession(e){return(null==e?void 0:e.server)?"server_"+nI(e.server).toLowerCase():this.getSessionKeyFromUrl(e.portal)}getSessionKeyFromUrl(e){return this.getServerKeyFromUrl(e)||this.getPortalKeyFromUrl(e)}getServerKeyFromUrl(e){const t=zg(e)?nI(Jg(e)):"";return(t?`server_${t}`:"").toLowerCase()}getPortalKeyFromUrl(e){var t,n;let r="";if(fg(e))r=this.getStandardAGOLSessionKey(e)||"";else{const{customBaseUrl:i,urlKey:o}=this.getPortalUrlInfo(e)||{};if(r=`${o}.${i}`,null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl){const e=this.getPortalUrlInfo(null===(n=this.getMainPortal())||void 0===n?void 0:n.portalUrl);o===e.urlKey&&0===i.indexOf(e.customBaseUrl)&&(r=`${e.urlKey}.${e.customBaseUrl}`)}}return r.toLowerCase()}getPortalUrlInfo(e){if(!e)return null;let t=e.toLowerCase(),n="",r=t.indexOf("https://");0===r?n="https://":(r=t.indexOf("http://"),0===r&&(n="http://")),r=n.length;let i,o,s=t.indexOf("/sharing/rest",r);s=s<0?t.length:s,t=t.substring(r,s);const a=t.split(".");return i=a[0],a.splice(0,1),o=a.join("."),{urlKey:i,customBaseUrl:o,schema:n}}getSessionFromAuthInfo(e){var t;if(!this.checkAuthInfo(e))return null;const n=this.getPortalFromAuthInfo(e);return new oi({clientId:null===(t=this.getMainPortal())||void 0===t?void 0:t.clientId,token:e.token,tokenExpires:new Date(e.expires),refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires?new Date(e.refreshTokenExpires):null,redirectUri:e.redirectUri,portal:n,username:e.email})}getSessionFromStorage(){return wv(this,void 0,void 0,function*(){var e;const t=null===(e=this.readAuthInfo("exb_auth"))||void 0===e?void 0:e.authInfo,n=this.getSessionFromAuthInfo(t);let r=null;if(n&&n.canRefresh&&this.isSessionExpired(n))try{yield n.refreshCredentials()}catch(e){return console.warn("failed to refresh the token in storage",e),Promise.resolve(null)}return n&&this.isMainSession(n)?r=n:n&&this.processInvalidSignInSession(),Promise.resolve(r)})}readCookie(e){try{return Yg.get(e)}catch(e){console.error("Read cookie error.",e)}}getPortalFromAuthInfo(e){var t;if(window.jimuConfig.isInPortal)return`${null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl}/sharing/rest/`;const n=e.urlKey?`${e.urlKey}.`:"";let r=e.schema;r=r||"https://";let i=`${r}${n}${e.customBaseUrl}/sharing/rest/`;return"maps.arcgis.com"===e.customBaseUrl?i=`${r}www.arcgis.com/sharing/rest/`:"mapsdevext.arcgis.com"===e.customBaseUrl?i=`${r}devext.arcgis.com/sharing/rest/`:"mapsqa.arcgis.com"===e.customBaseUrl&&(i=`${r}qaext.arcgis.com/sharing/rest/`),i}isSessionExpired(e){return!e||new Date(e.tokenExpires)<new Date&&(console.debug("???? session has expired, ","current time: ",new Date,` expiration time: ${e.tokenExpires}`," - ",`portal: ${e.portal}`,`server: ${e.server||""}`),!0)}getAuthInfoFromSession(e){const{urlKey:t,customBaseUrl:n,schema:r}=this.getPortalUrlInfo(e.portal);return{portalApp:!1,email:e.username,token:e.token,expires:e.tokenExpires,refreshToken:e.refreshToken,refreshTokenExpires:e.refreshTokenExpires,redirectUri:e.redirectUri,urlKey:t,customBaseUrl:n,clientId:e.clientId,schema:r}}checkAuthInfo(e){if(!e)return!1;if(e.refreshTokenExpires){if(new Date(e.refreshTokenExpires)<new Date)return!1}else if(new Date(e.expires)<new Date)return!1;return!0}readAuthInfo(e){let t,n;try{n=JSON.parse(Ow(e))}catch(e){console.error("Parse localStorage auth error")}if(n)t={authInfo:n,from:"LocalStorage"};else{try{n=JSON.parse(Aw(e))}catch(e){console.error("Parse sessionStorage auth error")}t={authInfo:n,from:"SessionStorage"}}return t}writeAuthInfo(e){const t=this.readAuthInfo("exb_auth");this.removeAuthInfo(),"LocalStorage"===t.from||window.jimuConfig.isDevEdition||window.jimuConfig.isOutOfExb?Cw("exb_auth",JSON.stringify(this.getAuthInfoFromSession(e))):Dw("exb_auth",JSON.stringify(this.getAuthInfoFromSession(e)))}removeAuthInfo(){Rw("exb_auth"),Pw("exb_auth")}updateResourcesAuthInfo(){const e=[];Object.entries(this.sessions||{}).forEach(t=>{const n=t[1];if(this.isMainSession(n))return;const r=this.getSessionType(n);if(r===bv.ServerSessionFederated||r===bv.ServerSessionStandAloneWebTier)return;const i=n.toJSON();n.canRefresh&&(i.token=void 0,i.tokenExpires=void 0,i.tokenDuration=void 0),e.push(i)}),Dw("exb_auth_resources",JSON.stringify(e))}readResourcesAuthInfo(){let e=[];try{e=JSON.parse(Aw("exb_auth_resources"))}catch(e){console.error("Parse localStorage auth error")}return e}writeAuthState(e){const t=JSON.parse(Ow(Ov))||[];e&&(t.push(e),Cw(Ov,JSON.stringify(t)))}getStandardAGOLSessionKey(e){if(!fg(e))return;let t,n;const r=rI(e).split(".");let i;return t=r[0],r.splice(0,1),n=r.join("."),"devext"===t||"mapsdevext.arcgis.com"===n?i="devext.arcgis.com":"qaext"===t||"mapsqa.arcgis.com"===n?i="qaext.arcgis.com":"www"===t||"maps.arcgis.com"===n?i="www.arcgis.com":(i="www.arcgis.com",t.indexOf("dev")>-1||n.indexOf("dev")>-1?i="devext.arcgis.com":(t.indexOf("qa")>-1||n.indexOf("qa")>-1)&&(i="qaext.arcgis.com")),i}getOrgUrl(e,t){let n;return"www.arcgis.com"===e?n=`${t}.maps.arcgis.com`:"devext.arcgis.com"===e?n=`${t}.mapsdevext.arcgis.com`:"qaext.arcgis.com"===e?n=`${t}.mapsqa.arcgis.com`:(n=e,console.error("Bad params.",e,t)),tI(n,za.Https)}getHostedService(e){return wv(this,void 0,void 0,function*(){const t=e.split(/\/rest(\/admin)?\/services\//)[0];return t?yield Pr(t+"/rest/info",{httpMethod:"GET"}).then(e=>wv(this,void 0,void 0,function*(){if(!e.owningSystemUrl)return yield Promise.resolve(null);let t;return/https?:\/\/(www|services)\.arcgis\.com/.test(e.owningSystemUrl)?t="www.arcgis.com":/https?:\/\/(devext|servicesdev)\.arcgis\.com/.test(e.owningSystemUrl)&&/mapsdevext\.arcgis\.com\/?$/.test(TE().getState().portalUrl)?t="devext.arcgis.com":/https?:\/\/(qaext|servicesqa)\.arcgis\.com/.test(e.owningSystemUrl)&&/mapsqa\.arcgis\.com\/?$/.test(TE().getState().portalUrl)&&(t="qaext.arcgis.com"),yield Promise.resolve(t)})):yield Promise.resolve(null)})}getHostedServiceArcgisKey(e){return wv(this,void 0,void 0,function*(){const t=rI(e).split("."),n=t[0];let r;return t.splice(0,1),n.includes("servicesdev")?r="devext.arcgis.com":n.includes("servicesqa")?r="qaext.arcgis.com":n.includes("services")&&(r="www.arcgis.com"),r?yield Promise.resolve(r):yield this.getHostedService(e)})}getSignInDomain(e,t){return wv(this,void 0,void 0,function*(){if(!e)return null;if(fg(e)){let n=this.getStandardAGOLSessionKey(e);return n||(n=yield this.getHostedServiceArcgisKey(e),n=n||rI(e)),t?this.getOrgUrl(n,t):`https://${n}`}{const{customBaseUrl:t,urlKey:n,schema:r}=this.getPortalUrlInfo(e);return`${r||"https://"}${n}.${t}`}})}signInByResourceUrl(e,t,n){let r;return r=zg(e)?t?this.signIn({desUrl:t,forceLogin:n,federatedServiceUrl:e}):this.nonOAuthSignIn(e,n):this.signIn({desUrl:e,forceLogin:n}),r}signIn(){return wv(this,arguments,void 0,function*(e={}){var t,n,r,i,o;let s=e.fromUrl||window.jimuConfig.mountPath;const a=e.desUrl||(null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl),l=e.clientId||this.getClientIdByUrl(a),u=null===(n=e.popup)||void 0===n||n,c=null!==(r=e.forceLogin)&&void 0!==r&&r,d=e.federatedServiceUrl,p=e.redirectUrlInNewWindow,f=e.redirectUrlInTopWindow;"/"===s.split("#")[0]&&window.jimuConfig.isInPortal&&(s=window.location.pathname);const h=this.getSessionByUrl(a);if(h&&!c){if(this._executeSignIn(),!u){const e=0===s.indexOf("/");window.location.href=`${location.protocol}//${location.host}${e?"":"/"}${s}`}return d&&(yield this.generateSeverSessionByPortalSession(h,d)),Promise.resolve(h)}let g=!1;if(u){const e=this.tryToPendingSignInDialog(a);g=!!e,d&&this.tryToPendingSignInDialog(d);const t=this.signInUrlFromQueue&&this.getSessionKeyFromUrl(this.signInUrlFromQueue)===this.getSessionKeyFromUrl(a);if(e&&!t)return e.promise.then(()=>wv(this,void 0,void 0,function*(){this.isSigning=!1,d&&this.releasePendingSignIn(d),this._executeSignIn();const e=this.getSessionByUrl(a);return d&&(yield this.generateSeverSessionByPortalSession(e,d)),e})).catch(e=>{const t=this.getSignInErrorCodeByAuthError(e);return d&&this.releasePendingSignIn(d,e),this._executeSignIn(),Promise.reject(this.getSignInErrorByCode(t))})}const m=TE().getState().queryObject;if(this.isSigning&&!g){const t=this.defer();return this.signInQueue.push(Object.assign(Object.assign({},e),{sessionDefer:t})),yield t.promise}let v=cg(yield this.getSignInDomain(a,null==m?void 0:m.org));const y=Yw(FI("jimu-core")),S=`${window.location.origin}${y}/oauth-callback.html`,b=at(),w={id:b,clientId:l,portal:v,popup:u,isInPortal:window.jimuConfig.isInPortal,isDevEdition:window.jimuConfig.isDevEdition,isOutOfExb:window.jimuConfig.isOutOfExb,mountPath:window.jimuConfig.mountPath,enablePkce:Ev,jimuCorePath:y,fromUrl:s,redirectUrlInNewWindow:p,redirectUrlInTopWindow:f};this.writeAuthState(w);const I={portal:v,clientId:l,redirectUri:S,state:{id:b},popup:u,pkce:Ev,locale:null===(i=TE().getState())||void 0===i?void 0:i.appContext.locale,params:{showSignupOption:!0,signupType:"esri",hideCancel:window.jimuConfig.isInPortal&&!u,force_login:c}};this.isSigning=!0;const E=new Qg,O=window.open.exbReplaced?null:window.open;if(O){const e=(e,t,n)=>{O&&(window.open=O);const r=O(e,t,n);if("oauth-window"===t){const e=r,t=setInterval(()=>{if(null==e?void 0:e.closed){const e=this.getSessionByUrl(v);this.releasePendingSignIn(a,e?null:{name:"identity-manager:user-aborted",details:"originally aborted from exb",message:"ABORTED"}),d&&this.releasePendingSignIn(d,e?null:{name:"identity-manager:user-aborted",details:"originally aborted from exb",message:"ABORTED"}),this.isSigning=!1,this._executeSignIn(),e?E.resolve(e):this.initSessionFromCookieOrStorage().then(()=>{const e=this.getSessionByUrl(v);e?E.resolve(e):E.reject(this.getSignInErrorByCode(yv.SignInCanceled))}),clearInterval(t)}},500)}return r};e.exbReplaced=!0,window.open=e}null===(o=oi.beginOAuth2(I))||void 0===o||o.then(t=>{if(this.addOrReplaceSession(t),this.isSigning=!1,this._executeSignIn(),E.resolve(t),u){const t=!(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder);e.fromUrl&&t&&(window.location.href=e.fromUrl),e.redirectUrlInNewWindow&&t&&window.open(e.redirectUrlInNewWindow),e.redirectUrlInTopWindow&&t&&(window.top.location.href=e.redirectUrlInTopWindow)}}).catch(e=>{"ArcGISAccessDeniedError"!==e.name&&E.reject(this.getSignInErrorByCode(yv.Other))});const C=h,T=c?this.removeFromNoPermissionResourceInfoList(xg(hg(v))):null;return E.promise.then(e=>wv(this,void 0,void 0,function*(){return d&&(yield this.generateSeverSessionByPortalSession(e,d)),c&&T&&(null==C?void 0:C.username)===e.username&&this.setNoPermissionResourceInfoList(Object.assign(Object.assign({},this.noPermissionResourceInfoList),T)),e})).catch(e=>{throw c&&T&&e.code===yv.SignInCanceled&&this.setNoPermissionResourceInfoList(Object.assign(Object.assign({},this.noPermissionResourceInfoList),T)),e})})}nonOAuthSignIn(e,t){return wv(this,void 0,void 0,function*(){return Fg(["esri/request"]).then(n=>{const[r]=n,i=this.getSessionByUrl(e);let o;if(t){i&&this.removeSession(i);const t=Jg(e);o=this.removeFromNoPermissionResourceInfoList(t)}const s=t?"immediate":"auto";return e=oI(e,"f","json"),r(e=t?oI(e,"_exbForceLogin","true"):e,{authMode:s,responseType:"json"}).then(t=>this.getSessionByUrl(e)).catch(n=>{const r=this.getSessionByUrl(e);if(r)return Promise.resolve(r);{const e=this.getSignInErrorCodeByAuthError(n),r=this.getSignInErrorByCode(e);return t&&(i&&this.addOrReplaceSession(i),r.code===yv.SignInCanceled&&this.setNoPermissionResourceInfoList(Object.assign(Object.assign({},this.noPermissionResourceInfoList),o))),Promise.reject(r)}})})})}getSignInErrorCodeByAuthError(e){var t,n,r,i;const o=(null===(n=null===(t=null==e?void 0:e.response)||void 0===t?void 0:t.error)||void 0===n?void 0:n.code)||e.code||(null===(i=null===(r=null==e?void 0:e.details)||void 0===r?void 0:r.raw)||void 0===i?void 0:i.code)||null;let s=null;return 499===o?s=yv.TokenRequired:498===o?s=yv.InvalidToken:403===o?s=yv.NoPermission:"identity-manager:user-aborted"===e.name&&(s=yv.SignInCanceled),s}getSignInErrorByCode(e=yv.Other){const t=Tb(),n={code:e,isSignInError:!0,message:t.formatMessage({id:"signInErrorDefault",defaultMessage:Xg.signInErrorDefault}),message1:t.formatMessage({id:"signInErrorEnterCredential",defaultMessage:Xg.signInErrorEnterCredential}),message2:t.formatMessage({id:"signInErrorTryAgain",defaultMessage:Xg.signInErrorTryAgain})};switch(e){case yv.TokenRequired:case yv.InvalidToken:case yv.NoPermission:case yv.SignInCanceled:break;default:n.code=yv.Other}return n}getClientIdByUrl(e){return this.getClientIdByPortalUrlAndHost(e,window.location.hostname)}getClientIdByPortalUrlAndHost(e,t){var n;let r;const i=TE().getState();r=pg(xg(e),xg(i.portalUrl))?i.clientId:null===(n=by(e))||void 0===n?void 0:n.clientId;const o=rI(e),s=t.endsWith(".arcgis.com"),a=t.endsWith(".esri.com"),l=o.endsWith(".arcgis.com");return!r&&(s||a)&&l&&(r="experienceBuilder"),r}onClientIdDialogFinished(e,t,n){const r=this.getSessionKeyFromUrl(e);this.clientIdDialogResultPromises[r]&&(n?this.clientIdDialogResultPromises[r].reject(null):this.clientIdDialogResultPromises[r].resolve(t))}getPortalVersionByUrl(e){return Pr(ag(e),{httpMethod:"GET"}).then(e=>Number(null==e?void 0:e.currentVersion)).catch(e=>(console.warn(e),null))}useDialogToSetClientIdToConnectionsOfAppConfig(e){return wv(this,void 0,void 0,function*(){var t,n;let r;const i=this.getSessionKeyFromUrl(e);let o;this.clientIdDialogResultPromises[i]?o=this.clientIdDialogResultPromises[i]:(o={promise:null,resolve:null,reject:null},o.promise=new Promise((e,t)=>{o.resolve=e,o.reject=t}));const s=window.location.host,a=/.*\.arcgis\.com(?::(\d+))?(?=[\/?#]|$)/.test(s),l=yield this.getPortalVersionByUrl(e),u=l>7.3;if(this.isTrustedServer(e))wy(e,"",l),r=Promise.resolve("");else if(a&&u)wy(e,"experienceBuilder",l),r=Promise.resolve("experienceBuilder");else if(window.jimuConfig.isBuilder)this.clientIdDialogResultPromises[i]=o,TE().dispatch(qD(e)),r=null===(t=this.clientIdDialogResultPromises[i])||void 0===t?void 0:t.promise;else if(window.jimuConfig.isInBuilder){const t=MI("jimu-for-builder").appBuilderSync;this.clientIdDialogResultPromises[i]=o,t.publishPortalUrlNeedToRegisterClientId(e),r=null===(n=this.clientIdDialogResultPromises[i])||void 0===n?void 0:n.promise}else r=Promise.resolve();return r})}addSessionChangeListener(e){if("function"!=typeof e)throw new Error("callback must be a function");this.onSessionChangedCallbacks.includes(e)||this.onSessionChangedCallbacks.push(e)}_executeSignIn(){if(!this.isSigning&&this.signInQueue){const e=this.signInQueue.pop();e&&(this.signInUrlFromQueue=e.desUrl,this.signIn(e).then(t=>{e.sessionDefer.resolve(t)}).catch(t=>{e.sessionDefer.reject(t)}),this.signInUrlFromQueue="")}}signOutByResourceUrl(e,t){const n=t||e,r=this.getSessionByUrl(n);this.removeSession(r)}signOut(e={}){var t,n;const r=e.desUrl||(null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl),i=e.clientId||this.getClientIdByUrl(r),o=null===(n=e.redirectToSignOutPage)||void 0===n||n,s=this.getSessionByUrl(r);if(i&&this.removeSession(s),o){let t;t=window.jimuConfig.isDevEdition?`${window.location.protocol}//${window.location.host}${window.jimuConfig.mountPath}page/set-portalurl`:window.jimuConfig.isInPortal?window.location.href:`${window.location.protocol}//${window.location.host}/page/landing`;const n=encodeURIComponent(e.redirectUrl||t);if(i){const e=`${cg(r)}/oauth2/signout?client_id=${i}&redirect_uri=${n}`;location.href=e}else location.href="/"}}switchAccountByResourceUrl(e,t){const n=this.getSessionByUrl(t||e);return this.signInByResourceUrl(e,t,!0).then(e=>(n&&n.clientId&&n.signOut(),e))}switchAccount(e={}){var t,n;const r=e.desUrl||(null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl),i=e.clientId||this.getClientIdByUrl(r),o=null===(n=e.popup)||void 0===n||n,s=e.federatedServiceUrl;if(o){const e=this.getSessionByUrl(r);return this.signIn({desUrl:r,clientId:i,popup:o,federatedServiceUrl:s,forceLogin:!0}).then(t=>(null==e||e.signOut(),t))}{const e=`${r}/home/pages/Account/manage_accounts.html#client_id=${i}&redirect_uri=${window.location.href}#`;this.removeAuthInfo(),window.location.href=e}}defer(){const e={promise:null,resolve:null,reject:null};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}generateToken(e){return wv(this,arguments,void 0,function*(e,t="",n="same-origin"){const r=tI(`${cg(e)}/generateToken?f=json`,za.Https),i=t||"",o={cache:"no-cache",credentials:n};return yield fetch(`${r}&${i}`,o).then(e=>wv(this,void 0,void 0,function*(){return yield e.json()})).then(e=>e.error?null:e,e=>null)})}generateSeverSessionByPortalSession(e,t){return wv(this,arguments,void 0,function*(e,t,n="same-origin"){const r=(t||"").trim().replace(/rest(.*)/gi,"").replace(/\/*$/g,""),i=tI(rI(window.location.href),za.Https),o=`serverUrl=${r}&referer=${i}&token=${e.token}`;return this.generateToken(dg(e.portal),o,n).then(t=>{if(t){const n=new oi({portal:e.portal,server:r,token:t.token,tokenExpires:new Date(t.expires),ssl:t.ssl,username:e.username});return this.addOrReplaceSession(n),n}return null})})}getPortalSelf(e){return wv(this,void 0,void 0,function*(){const t=tI(`${cg(e)}/portals/self?f=json`,za.Https);return yield fetch(t,{cache:"no-cache",credentials:"include"}).then(e=>wv(this,void 0,void 0,function*(){return yield e.json()}))})}getSessionFromWebTierPortal(e,t,n){let r,i;return i=n?Promise.resolve(n):this.getPortalSelf(e),i.then(n=>wv(this,void 0,void 0,function*(){return r=n,yield this.generateToken(e,t,"include")})).then(t=>{if(t&&t.token){const n={token:t.token,expires:t.expires,userId:r.user?r.user.username:"",ssl:t.ssl,server:cg(e)},i={hasPortal:!1,hasServer:!1,server:""};return oi.fromCredential(n,i)}return null}).catch(()=>null)}getSessionFromWebTierServer(e){return wv(this,void 0,void 0,function*(){if(!Hg(e))return Promise.resolve(null);const t=Jg(e),n=this.getSessionByUrl(e);if(n)return yield Promise.resolve(n);{const n=tI(rI(window.location.href),za.Https);return yield fetch(t+"/rest/info?f=json",{cache:"no-cache",credentials:"include"}).then(e=>wv(this,void 0,void 0,function*(){return yield e.json()})).then(t=>wv(this,void 0,void 0,function*(){const r=t.owningSystemUrl;if(r){const t=`referer=${n}`;return this.getSessionFromWebTierPortal(r,t).then(t=>wv(this,void 0,void 0,function*(){if(t){this.addOrReplaceSession(t);const n=yield this.generateSeverSessionByPortalSession(t,e,"include");return n&&this.addOrReplaceSession(n),t}return null}))}{const t=Jg(e),n=`${t}/rest/self?f=json`,r=yield fetch(n,{credentials:"include"}).then(e=>wv(this,void 0,void 0,function*(){return yield e.json()}));if(r){const e=(new Date).getTime()+31536e6,n=new oi({server:t,token:"",tokenExpires:new Date(e),username:null==r?void 0:r.user.username});return n.portal=void 0,this.addOrReplaceSession(n),n}return null}})).catch(e=>(console.warn("Failed to get session from trusted server."),null))}})}getSessionType(e){return e.portal&&e.server?bv.ServerSessionFederated:e.server?e.token?bv.ServerSessionStandAlone:bv.ServerSessionStandAloneWebTier:e.portal?bv.PortalSession:void 0}addFromCredential(e,t,n,r){return wv(this,void 0,void 0,function*(){var i;let o;if(!e.server)return null;if(e.token&&e.expires)if("server"===e.scope)o=new oi({server:e.server,token:e.token,tokenExpires:new Date(e.expires),ssl:e.ssl,username:e.userId}),(null==n?void 0:n.owningSystemUrl)?o.portal=`${null==n?void 0:n.owningSystemUrl}/sharing/rest`:o.portal=void 0;else{const t=cg(e.server);o=new oi({portal:t,token:e.token,tokenExpires:new Date(e.expires),ssl:e.ssl,username:e.userId,clientId:null==r?void 0:r.appId,redirectUri:null==r?void 0:r.popupCallbackUrl,refreshToken:null===(i=null==r?void 0:r._oAuthCred)||void 0===i?void 0:i.refreshToken})}else{const{portalUrl:t,isWebTier:n}=TE().getState(),r=n&&pg(e.server,t);(this.isTrustedServer(e.server)||r)&&(o="server"===e.scope?yield this.getSessionFromWebTierServer(e.server):yield this.getSessionFromWebTierPortal(e.server))}const s=this.sessions?this.sessions[this.getSessionKeyFromSession(o)]:null;return!this.isSameSession(o,s)&&this.doAddOrReplaceSession(o)&&(this.syncToOtherWindowSessionManager(),this.onSessionChanged(t)),o})}syncToOtherWindowSessionManager(){if(window.jimuConfig.isBuilder){MI("jimu-for-builder").builderAppSync.publishChangeSessionToApp()}else if(window.jimuConfig.isInBuilder){MI("jimu-for-builder").appBuilderSync.publishAppSessionChangeToBuilder()}}syncSessionsFromOtherWindow(e){this.clearSessions(),e.forEach(e=>{const t=e.toJSON(),n=new oi(t);n.portal=e.portal,n.server=e.server,this.doAddOrReplaceSession(n)}),this.onSessionChanged(Sv.OtherWindowSync)}syncNoPermissionResourceInfoListToOtherWindowSessionManager(){if(window.jimuConfig.isBuilder){MI("jimu-for-builder").builderAppSync.publishNoPermissionResourceInfoListChangeToApp()}else if(window.jimuConfig.isInBuilder){MI("jimu-for-builder").appBuilderSync.publishNoPermissionResourceInfoListChangeToBuilder()}}syncNoPermissionResourceInfoListFromOtherWindow(e){this.noPermissionResourceInfoList=Jm(e),TE().dispatch(KD())}readSessionFromParent(e){return wv(this,void 0,void 0,function*(){return this.readSessionFromParentPromise=new Qg,window.parent.postMessage({type:"arcgis:auth:requestCredential"},e),this.readSessionFromParentPromise.promise})}canPostSessionTo(e){var t;const n=null===(t=window.trustedOrigins)||void 0===t?void 0:t.includes(e);return window.location.origin===e||e.endsWith(".arcgis.com")||n}tryToPendingSignInDialog(e){const t=this.getSessionKeyFromUrl(e);if(t){if(this.signInDialogPendingList[t])return this.signInDialogPendingList[t];{const e=new Qg;return this.signInDialogPendingList[t]=e,null}}return null}releasePendingSignIn(e,t){const n=this.getSessionKeyFromUrl(e),r=this.signInDialogPendingList[n];r&&(t?r.reject(t):r.resolve(null),delete this.signInDialogPendingList[n])}getNoPermissionResourceKey(e){let t;const n="/sharing/rest/content/items";if(Hg(e))t=qg(e);else{const r=xg(hg(e));if(e.includes(n)){const i=e.indexOf(n)+27;t=mg(r,e.substr(i+1).split("/")[0])}else t=null}return t}addToNoPermissionResourceInfoList(e,t,n,r,i){var o;const s=this.getNoPermissionResourceKey(e);if(!s)return;const a=this.noPermissionResourceInfoList[s],l=pg(xg(null===(o=this.getMainPortal())||void 0===o?void 0:o.portalUrl),xg(hg(i||e)));a&&a.userName===t||(this.noPermissionResourceInfoList[s]={owningSystemUrl:i||"",userName:t||"",ignored:r||!1,signInErrorCode:n||yv.Other,allowSignIn:!(l&&(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder))},this.syncNoPermissionResourceInfoListToOtherWindowSessionManager(),TE().dispatch(KD()))}removeFromNoPermissionResourceInfoList(e){const t={},n=this.getNoPermissionResourceKey(e);let r=!1;this.noPermissionResourceInfoList[n]&&(t[n]=this.noPermissionResourceInfoList[n],delete this.noPermissionResourceInfoList[n],r=!0);const i=!this.getServerKeyFromUrl(e)&&hg(e)===e,o=zg(e)&&Jg(e)===e;return(i||o)&&Object.entries(this.noPermissionResourceInfoList).forEach(n=>{const i=n[0];n[1].owningSystemUrl!==e&&hg(i)!==xg(e)&&Jg(i)!==e||(t[i]=this.noPermissionResourceInfoList[i],delete this.noPermissionResourceInfoList[i],r=!0)}),r?(this.syncNoPermissionResourceInfoListToOtherWindowSessionManager(),TE().dispatch(KD()),t):null}ignoreFromNoPermissionResourceInfoList(e){let t=!1;if(!e)Object.entries(this.noPermissionResourceInfoList).forEach(e=>{const n=e[0];e[1].ignored||(this.noPermissionResourceInfoList[n].ignored=!0,t=!0)});else{const n=!this.getServerKeyFromUrl(e),r=this.getNoPermissionResourceKey(e),i=Jg(`${e}/rest/services`)===e;this.noPermissionResourceInfoList[r]&&(this.noPermissionResourceInfoList[r].ignored=!0,t=!0),(n||i)&&Object.entries(this.noPermissionResourceInfoList).forEach(n=>{const r=n[0],i=n[1],o=i.owningSystemUrl===xg(e),s=hg(r)===xg(e),a=Jg(r)===e;!i.ignored&&(o||s||a)&&(this.noPermissionResourceInfoList[r].ignored=!0,t=!0)})}t&&(this.syncNoPermissionResourceInfoListToOtherWindowSessionManager(),TE().dispatch(KD()))}getNoPermissionResourceInfoList(){return this.noPermissionResourceInfoList}setNoPermissionResourceInfoList(e){this.noPermissionResourceInfoList=e,this.syncNoPermissionResourceInfoListToOtherWindowSessionManager(),TE().dispatch(KD())}getNoPermissionResourceInfoByUrl(e){const t=this.getNoPermissionResourceKey(e);return this.noPermissionResourceInfoList[t]}checkSessionPermissionForUrl(e,t,n,r){e&&t&&this.isValidToken(e,t).then(t=>{var i,o;(null==t?void 0:t.valid)?this.removeFromNoPermissionResourceInfoList(e):403===(null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.code)?this.addToNoPermissionResourceInfoList(e,n,yv.NoPermission,!1,r):498===(null===(o=null==t?void 0:t.error)||void 0===o?void 0:o.code)&&this.addToNoPermissionResourceInfoList(e,n,yv.InvalidToken,!1,r)})}handleInvalidToken(e){var t,n;const r=pg(xg(null===(t=this.getMainPortal())||void 0===t?void 0:t.portalUrl),xg(hg(e))),i=TE().getState(),o=this.sessions&&this.sessions[this.getSessionKeyFromUrl(e)];if(this.removeSession(o),Object.keys(this.requestCacheForValidatingToken).forEach(t=>{t.includes(qg(iI(e)))&&delete this.requestCacheForValidatingToken[t]}),r&&(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder||(null===(n=i.appInfo)||void 0===n?void 0:n.access)&&"public"!==i.appInfo.access)&&(this.gotoPrivilegeErrorPage(cl.PrivilegeInvalidMainSession),window.jimuConfig.isInBuilder)){MI("jimu-for-builder").appBuilderSync.publishCheck498ErrorToBuilder(e)}}isSignInPromptBlocked(){var e,t;if(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder||window.jimuConfig.isSite)return!1;return null===(t=((null===(e=null===window||void 0===window?void 0:window.jimuConfig)||void 0===e?void 0:e.isBuilder)?TE().getState().appStateInBuilder:TE().getState()).appConfig.permission)||void 0===t?void 0:t.blockSignInPrompt}}const Tv=Cv;var xv=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};let Av={},Dv={};function Rv(e,t=!1){const n=Tv.getInstance(),r=n.handleAuthError.bind(n);return Pv(e,t).then(t=>{if(!t.isPortal){const n=`https://${t.urlKey}.${t.customBaseUrl}`;t.urlKey&&!pg(e,n)&&TE().dispatch(pD({portalUrl:n}))}return TE().dispatch(RD(t)),t}).catch(e=>{r(e,!1)})}function Pv(e,t=!1){e=hg(e);const n=Tv.getInstance().getSessionByUrl(e);return Av[e]&&!t||(Av[e]=Pr(`${cg(e)}/portals/self`,{authentication:n,httpMethod:"GET",params:{f:"json",culture:window.locale}}).then(e=>e)),Av[e]}function jv(e){e=hg(e);const t=Tv.getInstance().getSessionByUrl(e);return Dv[e]||(Dv[e]=Pr(`${cg(e)}/portals/self/signinSettings`,{authentication:t,httpMethod:"GET",params:{f:"json"}}).then(e=>e)),Dv[e]}function Lv(){Av={}}function _v(){Dv={}}const Mv={};function Nv(e=dI().appId,t){return Mv[e]&&!t||(window.jimuConfig.isDevEdition?Mv[e]=function(e){return xv(this,void 0,void 0,function*(){return yield window.fetch(`${window.jimuConfig.mountPath}apps/${e}/info.json`).then(e=>xv(this,void 0,void 0,function*(){return yield e.json()})).then(e=>Object.assign(Object.assign({},e),{name:e.title}))})}(e):Mv[e]=function(e){return xv(this,void 0,void 0,function*(){const t=Tv.getInstance(),n=t.getMainSession(),r=(null==n?void 0:n.portal)||TE().getState().portalUrl,i=yield Rv(r),o=i.isPortal?r:i.urlKey?`https://${i.urlKey}.${i.customBaseUrl}`:r;return yield Pi(e,{portal:cg(o),authentication:t.getSessionByUrl(r)}).then(e=>Object.assign(Object.assign({},e),{name:e.title})).catch(e=>"CONT_0001"===e.code?Promise.reject(e):Promise.reject({}))})}(e)),Mv[e]}function kv(e){delete Mv[e]}function Uv(e,t){return fetch(`${e}/sharing/rest/oauth2/token?client_id=${t}&client_secret=invalid_secret&grant_type=client_credentials`).then(e=>e.json()).then(e=>{var t;return"invalid_client_id"!==(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error)}).catch(e=>!1)}function Fv(e){var t;const n=window.jimuConfig.isInPortal,r=null===(t=null==e?void 0:e.portalSelf)||void 0===t?void 0:t.hasClassificationSchema;return!window.jimuConfig.isBuilder&&!window.jimuConfig.isSite&&n&&r}function Bv(e){var t;const n=window.jimuConfig.isInPortal,r=null===(t=null==e?void 0:e.portalSelf)||void 0===t?void 0:t.hasClassificationSchema;return(window.jimuConfig.isBuilder||window.jimuConfig.isSite)&&n&&r}var $v,Vv;!function(e){e.Unkown="UNKNOWN",e.Widget="WIDGET",e.Section="SECTION",e.ScreenGroup="SCREEN_GROUP"}($v||($v={})),function(e){e.FixedLayout="FIXED",e.FlowLayout="FLOW",e.GridLayout="GRID",e.ColumnLayout="COLUMN",e.RowLayout="ROW",e.AccordionLayout="ACCORDION",e.FlexRowLayout="FLEX_ROW"}(Vv||(Vv={}));const Gv=F.createContext({isInView:!1,isInCurrentView:!1}),Wv=F.createContext(!0);class Hv{constructor(){this.idCounter={}}static getInstance(){var e;return window.jimuConfig&&window.jimuConfig.isBuilder?null===(e=window._appWindow)||void 0===e?void 0:e._idManager:(Hv.instance||(Hv.instance=new Hv,window._idManager=Hv.instance),Hv.instance)}initIdCounter(e){this.idCounter={};["page","view","section","widget","screen","screenGroup","layout","dialog","dataSource","messageConfig","appProxy","utility"].forEach(t=>{var n;const r=this.getConfigKeyByType(t);null==this.idCounter[t]&&(this.idCounter[t]=0),Object.keys(null!==(n=e[r])&&void 0!==n?n:{}).forEach(e=>{const n=`${t}_`,r=n.length,i=e.indexOf(n);if(-1!==i){const n=e.substring(i+r);/^\d+$/.test(n)&&(this.idCounter[t]=Math.max(this.idCounter[t],parseInt(n)))}})})}getConfigKeyByType(e){return"y"===e.charAt(e.length-1)?`${e.slice(0,e.length-1)}ies`:`${e}s`}getUniqueId(e){return null==this.idCounter[e]&&(this.idCounter[e]=0),this.idCounter[e]+=1,`${e}_${this.idCounter[e]}`}}const zv=["widgets/common/text/"],qv=(e,t)=>{var n,r;if(!("widgets"===t[0]&&t.length>2))return!1;return zv.includes(null===(r=null===(n=null==e?void 0:e.widgets)||void 0===n?void 0:n[t[1]])||void 0===r?void 0:r.uri)},Jv=e=>/^blob:\http(s?):\/\/(.)/.test(e),Kv=(e="")=>/blob:\http(s?):\/\/(.)/.test(e),Yv="${appResourceUrl}",Xv=e=>/^\$\{appResourceUrl\}+(.)/.test(e),Qv=e=>!!e&&e.includes("${appResourceUrl}"),Zv=e=>(e||"").match(/\$\{appResourceUrl\}\/images\/(?:[^\/]+\/)?[^\/\\:\*"\?<>\|]+\.(png|jpeg|jpg|gif|bmp|webp|svg)/gi)||[];function ey(){if(window.jimuConfig.isOutOfExb)return"./resources";{let e=null;e=window.jimuConfig.isBuilder?TE().getState().appStateInBuilder:TE().getState();const t=e&&e.appId;return window.jimuConfig.isDevEdition?window.location.origin+window.jimuConfig.mountPath+"apps/"+t+"/resources":xg(TE().getState().portalUrl)+"/sharing/rest/content/items/"+t+"/resources"}}function ty(e){var t;if("string"!=typeof e)return e;const n=ey(),r=null===(t=Tv.getInstance().getMainSession())||void 0===t?void 0:t.token;let i=e;const o=Zv(i);for(const e of o){let t=e.replace("${appResourceUrl}",n);r&&(t=`${t}?token=${r}`),i=i.replace(e,t)}return i}function ny(e){const t=ey(),n=new RegExp(t,"g");return e.replace(n,"${appResourceUrl}").replace(/\?token=[\w-_\.]*/g,"")}function ry(e){const t={};return/^http(s)?:\/\//.test(e)||/^\/\//.test(e)?(t.isRemote=!0,t.folderUrl=e):(t.isRemote=!1,t.folderUrl=`${window.location.protocol}//${window.location.host}${EI()}${e}`),t}function iy(e){void 0===e.properties&&(e.properties={});["hasVersionManager","supportInlineEditing","supportRepeat","hasBuilderSupportModule","hasEmbeddedLayout","lockChildren","flipIcon","coverLayoutBackground","canCrossLayoutBoundary","needActiveState","canConsumeDataAction","watchViewportVisibility","isWidgetController"].forEach(function(t){void 0===e.properties[t]&&(e.properties[t]=!1)});return["hasMainClass","hasConfig","hasSettingPage","hasConfigInSettingPage","passDataSourceToChildren","deactivateOtherWidgets","supportAutoSize"].forEach(function(t){void 0===e.properties[t]&&(e.properties[t]=!0)}),e}function oy(e,t){t.icon=t.icon?t.icon:t.context.folderUrl+"icon.svg",t.label=t.label?t.label:ly(e,"widget",t.manifest?t.manifest.i18nMessages._widgetLabel||t.manifest.label||t.manifest.name:"")}function sy(e){e.widgets&&Object.keys(e.widgets).forEach(t=>{const n=e.widgets[t];n.layouts&&Object.keys(n.layouts).forEach(t=>{Object.keys(n.layouts[t]).forEach(r=>{var i;const o=n.layouts[t][r];if(e.layouts[o]&&!e.layouts[o].label){const r=null===(i=n.manifest.layouts)||void 0===i?void 0:i.find(e=>e.name===t);e.layouts[o].label=n.manifest.i18nMessages[`_layout_${t}_label`]||(null==r?void 0:r.label)||(null==r?void 0:r.name)}})})})}function ay(e){return Hv.getInstance().getUniqueId(e)}function ly(e,t,n){const r=function(e){return"y"===e.charAt(e.length-1)?`${e.slice(0,e.length-1)}ies`:`${e}s`}(t);let[i,o]=uy(n);if(!e[r])return null===o?n:`${n} ${o+1}`;Object.keys(e[r]).filter(t=>{const i=uy(e[r][t].label)[0];return n===i}).forEach(t=>{let n=uy(e[r][t].label)[1];n=null===n?1:n,o=Math.max(o,n)});return null===o?i:`${i} ${o+1}`}function uy(e){if(!e)return[e,null];const t=e.lastIndexOf(" "),n=e.substring(t+1);let r,i;return/^\d+$/.test(n)?(r=e.substring(0,t),i=parseInt(n)):(r=e,i=null),[r,i]}function cy(e){if(!(null==e?void 0:e.widgets))return[];const t=[];return Object.keys(e.widgets).forEach(n=>{t.push(e.widgets[n])}),t}function dy(e,t,n){let r=[];return e.messageConfigs&&Object.entries(e.messageConfigs).forEach(([e,i])=>{r=r.concat(i.actions&&i.actions.filter(e=>e.widgetId===t&&e.actionName===n))}),r}function py(e,t,n){return e.sections&&Object.keys(e.sections).some(r=>{const i=e.sections[r].views;return(null==i?void 0:i.includes(t))&&(null==i?void 0:i.includes(n))})}function fy(e){(null==e?void 0:e.layouts)&&Object.keys(e.layouts).forEach(t=>{const n=e.layouts[t];return n.content&&Object.keys(n.content).forEach(e=>{if(isNaN(parseInt(e)))return void console.error("Layout item MUST be integer string");n.content[e].id=e}),n.id=t,n})}function hy(e,t){var n,r,i,o,s;const a=e.appConfig,l=t,u=Object.keys(a.widgets||{}).filter(e=>!l.widgets[e]);e=e.set("widgetsRuntimeInfo",e.widgetsRuntimeInfo.without.apply(e.widgetsRuntimeInfo,u)).set("widgetsState",e.widgetsState.without.apply(e.widgetsState,u)).set("widgetsMutableStateVersion",e.widgetsMutableStateVersion.without.apply(e.widgetsMutableStateVersion,u)),Object.keys(e.dataSourcesInfo||{}).forEach(t=>{var n;(null===(n=e.dataSourcesInfo[t])||void 0===n?void 0:n.widgetQueries)&&(e=e.setIn(["dataSourcesInfo",t,"widgetQueries"],e.dataSourcesInfo[t].widgetQueries.without.apply(e.dataSourcesInfo[t].widgetQueries,u)))});Object.keys(l.widgets||{}).filter(e=>!a.widgets[e]).forEach(t=>{const n=l.widgets[t];e.widgetsClassStatus[n.uri]&&(e=e.setIn(["widgetsRuntimeInfo",t,"isClassLoaded"],!0))});Object.keys(l.widgets||{}).filter(e=>a.widgets[e]&&l.widgets[e].uri!==a.widgets[e].uri).forEach(t=>{const n=l.widgets[t];e=e.widgetsClassStatus[n.uri]?e.setIn(["widgetsRuntimeInfo",t,"isClassLoaded"],!0):e.setIn(["widgetsRuntimeInfo",t,"isClassLoaded"],!1)});Object.keys(a.views||{}).filter(e=>!l.views[e]).forEach(t=>{var n,r,i,o,s,l;const u=Object.keys(a.sections||{}).find(e=>a.sections[e].views.includes(t));(null===(n=e.appRuntimeInfo.sectionNavInfos)||void 0===n?void 0:n[u])&&((null===(r=e.appRuntimeInfo.sectionNavInfos)||void 0===r?void 0:r[u].currentViewId)===t&&(e=e.setIn(["appRuntimeInfo","sectionNavInfos",u,"currentViewId"],null)),(null===(i=e.appRuntimeInfo.sectionNavInfos)||void 0===i?void 0:i[u].previousViewId)===t&&(e=e.setIn(["appRuntimeInfo","sectionNavInfos",u,"previousViewId"],null)),(null===(s=null===(o=e.appRuntimeInfo.sectionNavInfos)||void 0===o?void 0:o[u].visibleViews)||void 0===s?void 0:s.find(e=>e===t))&&(e=e.setIn(["appRuntimeInfo","sectionNavInfos",u,"visibleViews"],null===(l=e.appRuntimeInfo.sectionNavInfos)||void 0===l?void 0:l[u].visibleViews.filter(e=>e!==t))))});if(Object.keys(a.sections||{}).filter(e=>!l.sections[e]).forEach(t=>{var n;(null===(n=e.appRuntimeInfo.sectionNavInfos)||void 0===n?void 0:n[t])&&(e=e.setIn(["appRuntimeInfo","sectionNavInfos"],e.appRuntimeInfo.sectionNavInfos.without(t)))}),e.appRuntimeInfo.currentPageId&&!l.pages[e.appRuntimeInfo.currentPageId]){const t=Object.keys(l.pages).find(e=>l.pages[e].isDefault);e=e.setIn(["appRuntimeInfo","currentPageId"],t)}if(e.appRuntimeInfo.currentDialogId&&!l.dialogs[e.appRuntimeInfo.currentDialogId]&&(e=e.setIn(["appRuntimeInfo","currentDialogId"],null)),null===(n=e.appRuntimeInfo.openedDialogIds)||void 0===n?void 0:n.length){const t=Object.keys(a.dialogs).find(e=>!l.dialogs[e]);t&&(e=e.setIn(["appRuntimeInfo","openedDialogIds"],e.appRuntimeInfo.openedDialogIds.filter(e=>e!==t)));const n=Object.keys(a.dialogs).find(e=>a.dialogs[e].isSplash),r=Object.keys(l.dialogs).find(e=>l.dialogs[e].isSplash);r&&n!==r&&(e=e.setIn(["appRuntimeInfo","openedDialogIds"],e.appRuntimeInfo.openedDialogIds.filter(e=>e!==r)))}if(e.appRuntimeInfo.clipboard){const{layoutId:t,layoutItemId:n}=e.appRuntimeInfo.clipboard;(null===(i=null===(r=l.layouts[t])||void 0===r?void 0:r.content)||void 0===i?void 0:i[n])||(e=e.set("appRuntimeInfo",e.appRuntimeInfo.without("clipboard")))}if(e.appRuntimeInfo.selection){const{layoutId:t,layoutItemId:n}=e.appRuntimeInfo.selection;(null===(s=null===(o=l.layouts[t])||void 0===o?void 0:o.content)||void 0===s?void 0:s[n])||(e=e.set("appRuntimeInfo",e.appRuntimeInfo.without("selection")))}return e=e.set("appConfig",l)}const gy=e=>{var t,n;const{widgetsRuntimeInfo:r,appConfig:i,browserSizeMode:o}=e;if(!r||!i||!o)return e;try{let s=e;const{widgets:a,layouts:l,mainSizeMode:u}=i,c=MI("jimu-layouts/layout-runtime"),d=Object.keys(r).filter(e=>r[e].controllerWidgetId);for(const e of d){let n=c.searchUtils.getParentWidgetIdOfContent(i,e,$v.Widget,o);n||(n=c.searchUtils.getParentWidgetIdOfContent(i,e,$v.Widget,u));const l=a[n];if(!l||!(null===(t=l.manifest.properties)||void 0===t?void 0:t.isWidgetController)){const t=r[e];s=s.setIn(["widgetsRuntimeInfo",e],t.without("controllerWidgetId"))}}const p=Object.values(a).filter(e=>{var t;return null===(t=e.manifest.properties)||void 0===t?void 0:t.isWidgetController});for(const e of p){if(!(null===(n=e.layouts)||void 0===n?void 0:n.controller))continue;const t=l[e.layouts.controller[o]||e.layouts.controller[u]],i=c.searchUtils.getContentsInLayout(t,$v.Widget,!1);for(const t of i){const n=r[t];(null==n?void 0:n.controllerWidgetId)||(s=s.setIn(["widgetsRuntimeInfo",t],(n||Ye({})).set("controllerWidgetId",e.id)))}}return s}catch(t){return console.log(t),e}};function my(e,t,n){var r;return null!==(r=e[t])&&void 0!==r?r:e[n]}function vy(e,t){var n,r;const i=e.layouts[t],o=e=>Object.keys(null!=e?e:{}).find(n=>e[n]===t);if(null==i?void 0:i.parent){const{id:t,type:s}=i.parent;switch(s){case Gh.Dialog:return o(e.dialogs[t].layout);case Gh.Footer:return o(e.footer.layout);case Gh.Header:return o(e.header.layout);case Gh.Page:return o(e.pages[t].layout);case Gh.Screen:return null!==(n=o(e.screens[t].main.layout))&&void 0!==n?n:o(null===(r=e.screens[t].panel)||void 0===r?void 0:r.layout);case Gh.View:return o(e.views[t].layout);case Gh.Widget:{const n=e.widgets[t].layouts;let r=null;return Object.keys(n).some(e=>(r=o(n[e]),!!r)),r}}}return null}function yy(e){var t;return(null===(t=function(e){var t,n;if(!e)return null;const r=(null===(t=null===window||void 0===window?void 0:window.jimuConfig)||void 0===t?void 0:t.isBuilder)?TE().getState().appStateInBuilder:TE().getState(),i=null===(n=null==r?void 0:r.appConfig)||void 0===n?void 0:n.widgets;return i&&Object.values(i).find(t=>{var n;return null===(n=null==t?void 0:t.outputDataSources)||void 0===n?void 0:n.some(t=>t===e.mainDataSourceId)})||null}(e))||void 0===t?void 0:t.id)||null}function Sy(){var e,t;const n=(null===(e=null===window||void 0===window?void 0:window.jimuConfig)||void 0===e?void 0:e.isBuilder)?TE().getState().appStateInBuilder:TE().getState(),r=(null===(t=null==n?void 0:n.appConfig)||void 0===t?void 0:t.connections)||[],i=r.length,o=r.map(e=>{const t=Object.assign({},e);return Uv(e.portalUrl,e.clientId).then(e=>(e||(t.clientId=null),t))});Promise.allSettled(o).then(e=>{let t=null==n?void 0:n.appConfig;const r=[];e.forEach(e=>{var t;(null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.clientId)&&r.push(e.value)}),i!==r.length&&(t=t.set("connections",r),Ww(t))})}function by(e){var t;const n=window.jimuConfig.isBuilder?TE().getState().appStateInBuilder:TE().getState();return((null===(t=null==n?void 0:n.appConfig)||void 0===t?void 0:t.connections)||[]).find(t=>"portal"===t.type&&pg(e,null==t?void 0:t.portalUrl))}function wy(e,t,n){var r,i;const o=e&&t&&n&&{type:"portal",portalUrl:e,clientId:t,portalVersion:n};if(!o)return;const s=window.jimuConfig.isBuilder?TE().getState().appStateInBuilder:TE().getState();let a=(null===(r=null==s?void 0:s.appConfig)||void 0===r?void 0:r.connections)||[];const l=by(e);if(!(l&&(u=l,c=o,u&&c&&u.type===c.type&&u.clientId===c.clientId&&u.portalVersion===c.portalVersion&&pg(u.portalUrl,c.portalUrl)))){a=l?a.filter(t=>t.portalUrl!==e):a;const t=null===(i=null==s?void 0:s.appConfig)||void 0===i?void 0:i.set("connections",a.concat([o]));if(window.jimuConfig.isBuilder){MI("jimu-for-builder").builderAppSync.publishAppConfigChangeToApp(t)}else TE().dispatch(SA(t))}var u,c}function Iy(e,t,n,r=!0){const i=t||n;(t||n)&&(function(e,t,n,r){var i;const o=n||r,s=n?"WEB_MAP":"WEB_SCENE";(null==e?void 0:e.dataSources)||(e.dataSources={});Object.values(e.dataSources).find(e=>e.itemId===o)||(e.dataSources[t]={type:s,itemId:o,id:t,portalUrl:null===(i=e.attributes)||void 0===i?void 0:i.portalUrl})}(e,i,t,n),r&&function(e,t){"blankfullscreen"===e.template&&function(e,t){e.widgets.widget_1={uri:"widgets/arcgis/arcgis-map/",version:window.jimuConfig.exbVersion,config:{toolConfig:{canZoom:!0,canHome:!0,canSearch:!0,canNavigation:!0},isUseCustomMapState:!1},id:"widget_1",layouts:{MapFixedLayout:{LARGE:"layout_1"}},useDataSources:[{dataSourceId:t,mainDataSourceId:t}]},e.layouts.layout_0={type:"FIXED",content:{0:{type:"WIDGET",bbox:{left:"50%",right:"58.6%",top:"50%",bottom:"38.9%",width:"31.3%",height:"50.0%"},widgetId:"widget_1",setting:{autoProps:{left:!1,right:!0,top:!1,bottom:!0},hCenter:!0,vCenter:!0,heightMode:"fixed",aspectRatio:1}}},order:["0"]},e.layouts.layout_1={type:"FIXED"}}(e,t);"blankscrollable"===e.template&&function(e,t){e.widgets.widget_1={uri:"widgets/layout/row/",version:window.jimuConfig.exbVersion,config:{space:10,style:{padding:{number:[10],unit:"px"}}},id:"widget_1",layouts:{DEFAULT:{LARGE:"layout_1"}}},e.widgets.widget_2={uri:"widgets/arcgis/arcgis-map/",version:window.jimuConfig.exbVersion,config:{toolConfig:{canZoom:!0,canHome:!0,canSearch:!0,canNavigation:!0},isUseCustomMapState:!1},id:"widget_2",layouts:{MapFixedLayout:{LARGE:"layout_2"}},useDataSources:[{dataSourceId:t,mainDataSourceId:t}]},e.layouts.layout_0={type:"FLOW",content:{0:{type:"WIDGET",bbox:{left:"80px",right:"480px",top:"4px",bottom:"404px",width:"400px",height:420},widgetId:"widget_1",setting:{heightMode:"fixed"}}},order:["0"]},e.layouts.layout_1={type:"ROW",order:["0"],content:{0:{type:"WIDGET",bbox:{left:"0px",width:"4px",height:"400px"},widgetId:"widget_2",setting:{heightMode:"fit"}}}},e.layouts.layout_2={type:"FIXED"}}(e,t);"blankfullscreengrid"===e.template&&function(e){e.widgets.widget_1={uri:"widgets/arcgis/arcgis-map/",version:window.jimuConfig.exbVersion,config:{toolConfig:{canZoom:!0,canHome:!0,canSearch:!0,canNavigation:!0},isUseCustomMapState:!1},id:"widget_1",layouts:{MapFixedLayout:{LARGE:"layout_1"}}},e.layouts.layout_0={type:"GRID",content:{0:{type:"WIDGET",widgetId:"widget_1",bbox:{width:100},gridType:Wh.Plain}},order:["0"],setting:{rootItem:"0"}},e.layouts.layout_1={type:"FIXED"}}(e)}(e,i),function(e,t){const n=Object.values(e.widgets).find(e=>"widgets/arcgis/arcgis-map/"===e.uri);n&&(n.useDataSources=[{dataSourceId:t,mainDataSourceId:t}],n.config&&(n.config.initialMapState=null,n.config.isUseCustomMapState=!1))}(e,i))}function Ey(e,t){return Oy(e.dataSources,t)}function Oy(e,t){var n,r;if(!t)return null;let i;const o=Object.values(e||{});for(let e=0;e<o.length&&(i=(null===(n=o[e])||void 0===n?void 0:n.id)===t?o[e]:Oy(null===(r=o[e])||void 0===r?void 0:r.childDataSourceJsons,t),!i);e++);return i}function Cy(e){var t,n,r,i;const o=window.jimuConfig.isBuilder?null===(n=null===(t=TE().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===n?void 0:n.appConfig:null===(r=TE().getState())||void 0===r?void 0:r.appConfig,s=null==o?void 0:o.widgets;if(!s)return null;const a=Object.values(s);for(const t of a)if(t&&"widgets/arcgis/arcgis-map/"===t.uri){const n=null===(i=t.config)||void 0===i?void 0:i.clientQueryDataSourceIds;if(n&&n.includes(e))return t.id}return null}function Ty(e){var t,n;const r=TE().getState(),i=(null===(t=window.jimuConfig)||void 0===t?void 0:t.isBuilder)?r.appStateInBuilder:r,o=i.appConfig,s=null===(n=i.appRuntimeInfo)||void 0===n?void 0:n.currentPageId,a=i.browserSizeMode,l=MI("jimu-layouts/layout-runtime"),u=l.searchUtils.getContentRootContainerInfo(o,e,$v.Widget,a,!1);return l.searchUtils.getContentsInContainerRecursiveAdv(o,u,$v.Widget,a,{includePending:!1,includeOtherSizeMode:!1,currentPageId:s})}var xy=a(4146),Ay=a.n(xy);var Dy="undefined"==typeof window||window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?F.createContext(null):window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=F.createContext(null)),Ry=Dy.Consumer,Py=Dy.Provider,jy=Dy;function Ly(e,t){var n,r=t||{},i=r.intlPropName,o=void 0===i?"intl":i,s=r.forwardRef,a=void 0!==s&&s,l=r.enforceContext,u=void 0===l||l,c=function(t){return F.createElement(Ry,null,function(n){var r;u&&Nh(n);var i=((r={})[o]=n,r);return F.createElement(e,nr({},t,i,{ref:a?t.forwardedRef:null}))})};return c.displayName="injectIntl(".concat((n=e).displayName||n.name||"Component",")"),c.WrappedComponent=e,a?Ay()(F.forwardRef(function(e,t){return F.createElement(c,nr({},e,{forwardedRef:t}))}),e):Ay()(c,e)}function _y(e){return{locale:e.locale,timeZone:e.timeZone,fallbackOnEmptyString:e.fallbackOnEmptyString,formats:e.formats,textComponent:e.textComponent,messages:e.messages,defaultLocale:e.defaultLocale,defaultFormats:e.defaultFormats,onError:e.onError,onWarn:e.onWarn,wrapRichTextChunksInFragment:e.wrapRichTextChunksInFragment,defaultRichTextElements:e.defaultRichTextElements}}var My=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cache={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}},t.state={cache:t.cache,intl:og(_y(t.props),t.cache),prevConfig:_y(t.props)},t}return tr(t,e),t.getDerivedStateFromProps=function(e,t){var n=t.prevConfig,r=t.cache,i=_y(e);return Bh(n,i)?null:{intl:og(i,r),prevConfig:i}},t.prototype.render=function(){return Nh(this.state.intl),F.createElement(Py,{value:this.state.intl},this.props.children)},t.displayName="IntlProvider",t.defaultProps=kh,t}(F.PureComponent);const Ny=My;const ky=function(e,t,n,r){if(!Ml(e))return e;for(var i=-1,o=(t=Fu(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var l=Bu(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=s){var c=a[l];void 0===(u=r?r(c,l,a):void 0)&&(u=Ml(c)?c:Dc(t[i+1])?[]:{})}rm(a,l,u),a=a[l]}return e};const Uy=function(e,t,n){return null==e?e:ky(e,t,n)};class Fy{constructor(){this.state={}}static getInstance(){return Fy.instance||(Fy.instance=new Fy,window._mutableStoreManager=Fy.instance),Fy.instance}updateStateValue(e,t,n){var r;const i=null!==(r=null==t?void 0:t.split("."))&&void 0!==r?r:[],o=[e].concat(i);Uy(this.state,o,n),TE().dispatch(dD(e,t))}readStateValue(e,t){var n;const r=null!==(n=null==t?void 0:t.split("."))&&void 0!==n?n:[],i=[e].concat(r);return Vu(this.state,i)}getStateValue(e){return Vu(this.state,e)}getState(){return this.state}clearState(){Object.keys(this.state).forEach(e=>{delete this.state[e]})}}const By=F.createContext(null);function $y({data:e,children:t}){return(0,sg.jsx)(By.Consumer,{children:n=>{let r=e;return n&&(r=Array.isArray(n)?n.concat(e):[n].concat(e)),(0,sg.jsx)(By.Provider,{value:r,children:t})}})}By.Consumer;function Vy(e){function t(t){return(0,sg.jsx)(By.Consumer,{children:n=>(0,sg.jsx)(e,Object.assign({},t,{repeatedDataSource:n}))})}return t.displayName="RepeatedDataSourceContextConsumerWrapper",t}var Gy,Wy,Hy,zy,qy;function Jy(e,t){return{STRING_SELECTION_CHANGE:t.formatMessage({id:"message_StringSelectionChange",defaultMessage:Xg.message_StringSelectionChange}),EXTENT_CHANGE:t.formatMessage({id:"message_ExtentChange",defaultMessage:Xg.message_ExtentChange}),DATA_RECORDS_SELECTION_CHANGE:t.formatMessage({id:"message_DataRecordsSelectionChange",defaultMessage:Xg.message_DataRecordsSelectionChange}),DATA_SOURCE_FILTER_CHANGE:t.formatMessage({id:"message_DataSourceFilterChange",defaultMessage:Xg.message_DataSourceFilterChange}),DATA_RECORD_SET_CHANGE:t.formatMessage({id:"message_DataRecordSetChange",defaultMessage:Xg.message_DataRecordSetChange}),DATA_SOURCES_CHANGE:t.formatMessage({id:"message_DataSourcesChange",defaultMessage:Xg.message_DataSourcesChange}),LOCATION_CHANGE:t.formatMessage({id:"message_LocationChange",defaultMessage:Xg.message_LocationChange}),SELECT_DATA_RECORD:t.formatMessage({id:"message_SelectDataRecord",defaultMessage:Xg.message_SelectDataRecord}),BUTTON_CLICK:t.formatMessage({id:"message_ButtonClick",defaultMessage:Xg.message_ButtonClick}),VIEW_CHANGE:t.formatMessage({id:"message_ViewChange",defaultMessage:Xg.message_ViewChange})}[e]}!function(e){e.StringSelectionChange="STRING_SELECTION_CHANGE",e.ExtentChange="EXTENT_CHANGE",e.DataRecordsSelectionChange="DATA_RECORDS_SELECTION_CHANGE",e.DataSourceFilterChange="DATA_SOURCE_FILTER_CHANGE",e.DataRecordSetChange="DATA_RECORD_SET_CHANGE",e.DataSourcesChange="DATA_SOURCES_CHANGE",e.LocationChange="LOCATION_CHANGE",e.SelectDataRecord="SELECT_DATA_RECORD",e.ButtonClick="BUTTON_CLICK",e.ViewChange="VIEW_CHANGE"}(Gy||(Gy={})),function(e){e.UseDataSource="USE_DATA_SOURCE",e.OutputDataSource="OUTPUT_DATA_SOURCE",e.BothDataSource="BOTH_DATA_SOURCE"}(Wy||(Wy={}));class Ky{constructor(e,t){this.type=Gy.StringSelectionChange,this.widgetId=e,this.str=t}}class Yy{constructor(e,t,n){this.type=Gy.DataRecordsSelectionChange,this.widgetId=e,this.records=t,this.dataSourceIds=n}}class Xy{constructor(e,t,n,r){this.type=Gy.ExtentChange,this.widgetId=e,this.extent=t,this.viewpoint=n,this.stationary=r,this.relatedWidgetIds=[]}setRelatedWidgetIds(e){this.relatedWidgetIds=e.slice()}getRelatedWidgetIds(){return this.relatedWidgetIds?this.relatedWidgetIds.slice():[]}addRelatedWidgetId(e){this.relatedWidgetIds.includes(e)||this.relatedWidgetIds.push(e)}clone(){const e=this.extent?this.extent.clone():null,t=this.viewpoint?this.viewpoint.clone():null,n=new Xy(this.widgetId,e,t,this.stationary);n.publishTime=this.publishTime;const r=this.getRelatedWidgetIds();return n.setRelatedWidgetIds(r),n}}class Qy{constructor(e,t){this.type=Gy.DataSourceFilterChange,this.widgetId=e,this.dataSourceIds=t}}!function(e){e.CreateUpdate="CREATE_UPDATE",e.Remove="REMOVE"}(Hy||(Hy={}));class Zy{constructor(e,t,n){this.type=Gy.DataRecordSetChange,this.widgetId=e,this.changeType=t,t===Hy.CreateUpdate?this.dataRecordSets=n:this.dataRecordSetNames=n}}!function(e){e.Create="CREATE",e.Remove="REMOVE"}(zy||(zy={}));class eS{constructor(e,t,n){this.type=Gy.DataSourcesChange,this.widgetId=e,this.changeType=t,this.dataSources=n}}class tS{constructor(e,t){this.type=Gy.LocationChange,this.widgetId=e,this.point=t}}class nS{constructor(e,t,n){this.type=Gy.SelectDataRecord,this.widgetId=e,this.dataSourceId=t,this.recordId=n}}class rS{constructor(e){this.type=Gy.ButtonClick,this.widgetId=e}}class iS{constructor(e,t,n){this.type=Gy.ViewChange,this.widgetId=e,this.viewId=t,this.preViewId=n}}class oS{constructor(e){this.id=e.id,e.name&&(this.name=e.name),e.widgetId&&(this.widgetId=e.widgetId),e.sectionId&&(this.sectionId=e.sectionId),this.label=e.label,this.intl=e.intl}destroy(){return null}onRemoveListen(e,t){return null}}class sS extends oS{filterMessageDescription(e){return!0}filterMessage(e){return!0}onExecute(e,t){return!0}}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(qy||(qy={}));var aS=function(e){return e};var lS="beforeunload",uS="popstate";function cS(e){e.preventDefault(),e.returnValue=""}function dS(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter(function(e){return e!==t})}},call:function(t){e.forEach(function(e){return e&&e(t)})}}}function pS(){return Math.random().toString(36).substr(2,8)}function fS(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,o=e.hash,s=void 0===o?"":o;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),s&&"#"!==s&&(n+="#"===s.charAt(0)?s:"#"+s),n}function hS(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function gS(){var e,t,n;return window.jimuConfig.isBuilder?null===(t=null===(e=TE().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig:null===(n=TE().getState())||void 0===n?void 0:n.appConfig}function mS(e,t){const n=window._jimuHistory;try{t?n.browserHistory.replace(e):n.browserHistory.push(e)}catch(e){console.error("Failed to change browser history",e)}}function vS(e){var t,n;const r=gS();let i=!1;if(null==r?void 0:r.widgets){const n=r.widgets.getIn([e]);(null===(t=null==n?void 0:n.manifest.urlParameters)||void 0===t?void 0:t.length)>0&&(i=!0)}if(!i)return!1;const o=null===(n=r.urlParams)||void 0===n?void 0:n.getIn(["widgets",e]);if(o){return!!o.isEnable}return!1}function yS(e,t){var n;let r=!0;const i=null===(n=gS().urlParams)||void 0===n?void 0:n.getIn(["widgets",e]);return r=null==i?void 0:i.getIn(["params",t]),void 0===r&&(r=!0),r}function SS(e){return/^widget_/.test(e)}function bS(e){let t=Object.keys(e);return t=t.filter(e=>!vS(e)),e=e.without(t)}function wS(e){for(const t of Object.keys(e)){let n=e[t],r=n&&Object.keys(n);r=null==r?void 0:r.filter(e=>!yS(t,e)),n=null==n?void 0:n.without(r),n&&(e=e.setIn([t],n))}return e}function IS(e){let t={};t=_t.parse(e,{decode:!1});for(const e of Object.keys(t)){let n;e===fl.Data_s?(n=xS(t[e],fl.Data_s),t=Object.assign(t,n)):SS(e)&&(n=xS(t[e],fl.Widgets),t[e]=n)}return t}function ES(e){let t=e;for(const e of Object.keys(t))if(e===fl.Data_s){const n=t[e];t=t.setIn([e],n)}else if(SS(e)){const n=AS(t[e]);t=t.setIn([e],n)}let n=_t.stringify(t,{skipNull:!0,skipEmptyString:!0,encode:!1});return n&&(n="#"+n),n}function OS(e){let t=null;(null==e?void 0:e.data_filter)&&(t={data_filter:e.data_filter});let n=e;(null==n?void 0:n.data_filter)&&(n.without?n=n.without("data_filter"):delete n.data_filter);let r=_t.stringify(n);return t&&(r=r+"&"+_t.stringify(t,{encode:!1})),r}function CS(e,t){let n=e;if(t){/^dataSource_[^%]*%3A/.test(e)&&(n=decodeURIComponent(e))}return xS(n,fl.Widgets)}function TS(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function xS(e,t,n){"object"==typeof e&&(null==e?void 0:e.length)&&(null==e?void 0:e.length)>0&&(e=e[0]);let r=Ye({});if(t===fl.Data_s)return r.set(fl.Data_s,decodeURIComponent(e));const{compatibleMode:i=!0}=null!=n?n:{};i&&e&&(e=jS(e));try{const t=null==e?void 0:e.split(",");null==t||t.forEach(e=>{const t=e.split(":"),n=t[0];let i=null;try{i=decodeURIComponent(t[1])}catch(e){console.warn(e)}r=r.set(n,i)})}catch(e){console.warn(e)}return r}function AS(e){let t="";try{let n=!0;for(const r of Object.keys(e))n||(t+=","),t+=r+":"+e[r],n=!1}catch(e){console.warn(e)}return t}function DS(e){if(e)for(const t of Object.keys(e)){const n=e[t];if(t===fl.Data_s){const r=encodeURIComponent(n);e=e.setIn([t],r)}else if(SS(t))for(const r of Object.keys(n)){const i=encodeURIComponent(n[r]);e=e.setIn([t,r],i)}}return e}function RS(e){if(e)for(const t of Object.keys(e)){const n=e[t];e=e.setIn([t],encodeURIComponent(n))}return e}function PS(){var e;const t=null===(e=gS().urlParams)||void 0===e?void 0:e.getIn(["general","dataSelection","isEnable"]);return!(void 0!==t&&!t)}function jS(e){let t=e;return t=function(e){let t=e;/^dataSource_[^%]*%3A/.test(e)&&(t=e.replace(/%3A/g,":"));return t}(t),t}function LS(e){const t=["data_filter"],n={};for(const r in e){const i=e[r];if(t.includes(r))n[decodeURIComponent(r)]=i;else{const e=_S(r,i);n[e.key]=e.value}}return n}function _S(e,t){let n=null,r=null;try{n=decodeURIComponent(e);try{r=decodeURIComponent(t)}catch(e){console.warn(e)}}catch(e){console.warn(e)}return{key:n,value:r}}const MS=[/\.arcgis\.com$/];var NS,kS;function US(e){const t=Vw();if(!window||!t||t===window)return;const n=t;try{if(n.jimuConfig&&n.jimuConfig.isBuilder)return}catch(e){}n.postMessage(e,window.location.origin)}function FS(e,t){return function(n){if(!function(e){var t;return(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.origin)===e||MS.some(t=>t.test(e))}(n.origin))return;if(!n.data)return;if(!Object.keys(kS).map(e=>kS[e]).includes(n.data.type))return;const r=n.data;r.type===e&&t(r)}}function BS(e,t){if(!window||!window.addEventListener)return;const n=FS(e,t);return window.addEventListener("message",n,!1),n}!function(e){e.JimuPageChanged="JIMU_PAGE_CHANGED",e.JimuQueryChanged="JIMU_QUERY_CHANGED",e.JimuHashChanged="JIMU_HASH_CHANGED"}(NS||(NS={})),function(e){e.ChangePage="CHANGE_PAGE",e.ChangeQuery="CHANGE_QUERY"}(kS||(kS={}));class $S{constructor(e,t,n,r,i,o){this.db=null,this.closed=!1,this.dbName=WS(e,t),this.storeName=n,this.version=r,this.indexName=i,this.indexKey=o}init(){return indexedDB?Promise.resolve().then(()=>{const e=indexedDB.open(this.dbName,this.version);return e.onupgradeneeded=()=>{const t=e.result;if(!t.objectStoreNames.contains(this.storeName)){const e=t.createObjectStore(this.storeName,{autoIncrement:!0});this.indexName&&e.createIndex(this.indexName,this.indexKey)}},VS(e)}).then(e=>{this.closed?e.close():this.db=e}):Promise.reject(new Error(null))}initialized(){return null!=this.db}close(){this.db&&(this.db.close(),this.db=null),this.closed=!0}put(e,t){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(t,e)).then()}putObject(e){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(e))}putAllObject(e){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));const t=this.db.transaction([this.storeName],"readwrite");return e.forEach(e=>{t.objectStore(this.storeName).put(e)}),GS(t)}putAll(e){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));const t=this.db.transaction([this.storeName],"readwrite");return e.forEach(e=>{t.objectStore(this.storeName).put(e.value,e.key)}),GS(t)}get(e){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e))}getAllKeys(){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAllKeys())}getAll(){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll())}delete(e){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e))}deleteAll(e){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));const t=this.db.transaction([this.storeName],"readwrite");return e.forEach(e=>{t.objectStore(this.storeName).delete(e)}),GS(t)}clear(){if(null==this.db)return Promise.reject(new Error("IndexedDB:not-initialized"));return VS(this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear())}destroy(){this.db&&this.db.deleteObjectStore(this.storeName),this.close()}}function VS(e){return new Promise((t,n)=>{"done"===e.readyState?null!=e.error?n(e.error):t(e.result):(e.onsuccess=()=>{t(e.result)},e.onerror=()=>{n(e.error)})})}function GS(e){return new Promise((t,n)=>{e.oncomplete=()=>{t()},e.onerror=()=>{n(e.error)},e.onabort=()=>{n(e.error)}})}function WS(e,t){var n,r;return`exb-${(null===(n=window.jimuConfig)||void 0===n?void 0:n.isBuilder)?null===(r=TE().getState().appStateInBuilder)||void 0===r?void 0:r.appId:TE().getState().appId}-${t}-${e}-cache`}var HS=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class zS{constructor(){this.lastLocalState={},this.initialized=!1,this.restoreFunctions=[],this.shouldRestoreLocalState=!1}static getInstance(){return window.jimuConfig.isBuilder?window._appWindow&&window._appWindow._appStateManager:(zS.instance||(zS.instance=new zS,window._appStateManager=zS.instance),zS.instance)}static isSupportLocalState(){const e=!!window.indexedDB,t=!window.jimuConfig.isBuilder&&!window.jimuConfig.isSite&&!window.jimuConfig.isInBuilder;return e&&t}init(){return HS(this,void 0,void 0,function*(){if(this.initialized)return this;this.localStateCache=new $S("init","app_state_mananger","local_state"),yield this.localStateCache.init();const e=yield this.localStateCache.getAllKeys(),t=yield this.localStateCache.getAll();return e.forEach((e,n)=>{const r=t[n];null!=r&&(this.lastLocalState[e]=r)}),Object.freeze(this.lastLocalState),this.initialized=!0,this})}isLocalStateRestored(){return this.shouldRestoreLocalState}putLocalState(e,t){return HS(this,void 0,void 0,function*(){this.initialized&&(yield this.localStateCache.put(e,t))})}getLocalState(e){return HS(this,void 0,void 0,function*(){if(this.initialized)return yield this.localStateCache.get(e)})}getLastLocalState(e){if(this.initialized)return this.lastLocalState[e]}existLocalState(){return!!this.initialized&&Object.keys(this.lastLocalState).length>0}registerRestoreFunction(e){this.initialized&&(this.shouldRestoreLocalState?e(this.lastLocalState):this.restoreFunctions.includes(e)||this.restoreFunctions.push(e))}restoreLocalState(){if(this.initialized){this.shouldRestoreLocalState=!0;for(const e of this.restoreFunctions)e(this.lastLocalState)}}}const qS=zS,JS=document&&function(e){void 0===e&&(e={});var t=e.window,n=void 0===t?document.defaultView:t,r=n.history;function i(){var e=n.location,t=e.pathname,i=e.search,o=e.hash,s=r.state||{};return[s.idx,aS({pathname:t,search:i,hash:o,state:s.usr||null,key:s.key||"default"})]}var o=null;n.addEventListener(uS,function(){if(o)d.call(o),o=null;else{var e=qy.Pop,t=i(),n=t[0],r=t[1];if(d.length){if(null!=n){var s=l-n;s&&(o={action:e,location:r,retry:function(){v(-1*s)}},v(s))}}else m(e)}});var s=qy.Pop,a=i(),l=a[0],u=a[1],c=dS(),d=dS();function p(e){return"string"==typeof e?e:fS(e)}function f(e,t){return void 0===t&&(t=null),aS(Mt({pathname:u.pathname,hash:"",search:""},"string"==typeof e?hS(e):e,{state:t,key:pS()}))}function h(e,t){return[{usr:e.state,key:e.key,idx:t},p(e)]}function g(e,t,n){return!d.length||(d.call({action:e,location:t,retry:n}),!1)}function m(e){s=e;var t=i();l=t[0],u=t[1],c.call({action:s,location:u})}function v(e){r.go(e)}null==l&&(l=0,r.replaceState(Mt({},r.state,{idx:l}),""));var y={get action(){return s},get location(){return u},createHref:p,push:function e(t,i){var o=qy.Push,s=f(t,i);if(g(o,s,function(){e(t,i)})){var a=h(s,l+1),u=a[0],c=a[1];try{r.pushState(u,"",c)}catch(e){n.location.assign(c)}m(o)}},replace:function e(t,n){var i=qy.Replace,o=f(t,n);if(g(i,o,function(){e(t,n)})){var s=h(o,l),a=s[0],u=s[1];r.replaceState(a,"",u),m(i)}},go:v,back:function(){v(-1)},forward:function(){v(1)},listen:function(e){return c.push(e)},block:function(e){var t=d.push(e);return 1===d.length&&n.addEventListener(lS,cS),function(){t(),d.length||n.removeEventListener(lS,cS)}}};return y}();function KS(){const e=qS.getInstance(),t=TE().getState(),n=t.appConfig,r=t.appRuntimeInfo;if(!e||!n||!r)return;const i=null==r?void 0:r.currentPageId;e.putLocalState("app_current_page",i);const o=null==r?void 0:r.currentDialogId;e.putLocalState("app_current_dlg",o);const s=null==r?void 0:r.sectionNavInfos,a=Object.entries(s||{}).reduce((e,[t,r])=>{var i,o;const s=r.currentViewId||(null===(o=null===(i=n.sections[t])||void 0===i?void 0:i.views)||void 0===o?void 0:o[0]);return s&&e.push(s),e},[]);e.putLocalState("app_current_views",a)}function YS(){var e;const t=qS.getInstance(),n=t.getLastLocalState("app_current_page");n&&nb(n);const r=TE().getState(),i=Object.values(r.appConfig.dialogs).find(e=>e.isSplash);if(i){const t=(null===(e=r.appRuntimeInfo)||void 0===e?void 0:e.dialogInfos)||Ye({}),n=Object.entries(t).find(([e,t])=>t.isClosed&&e===i.id);if(!n){const e=t.setIn([i.id,"isClosed"],!0);TE().dispatch(OD(e))}}const o=t.getLastLocalState("app_current_dlg");o&&ob(o);const s=t.getLastLocalState("app_current_views")||[],a=r.appConfig.views;for(const e of s){const t=Object.values(a).find(t=>t.id===e);t&&rb(t.parent,t.id)}}BS(kS.ChangePage,e=>{nb(e.pageId)}),BS(kS.ChangeQuery,e=>{eb(e.queryObject)}),JS&&JS.listen(({action:e,location:t})=>{if(t.pathname!==TE().getState().appPath){TE().dispatch(bA(t.pathname));const e=pI(t.pathname,TE().getState().appConfig).pageId;n=e,US({type:NS.JimuPageChanged,pageId:n})}var n;const r=TE().getState().queryObject.asMutable(),i=_t.parse(t.search);if(i.data_filter){const e=_t.parse(t.search,{decode:!1});i.data_filter=e.data_filter}var o;wd(r,i)||(TE().dispatch(kA(i)),o=i,US({type:NS.JimuQueryChanged,queryObject:o}));const s=IS(t.hash);var a;wd(s,TE().getState().urlHashObject.asMutable())||(TE().dispatch(UA(s)),a=s,US({type:NS.JimuHashChanged,urlHashObject:a})),window.jimuConfig.isBuilder||window.jimuConfig.isSite||window.jimuConfig.isInBuilder||KS()});const XS=F.createContext(JS),QS=e=>(0,sg.jsx)(XS.Provider,{value:JS,children:e.children});function ZS(e){class t extends F.PureComponent{render(){return(0,sg.jsx)(XS.Consumer,{children:t=>(0,sg.jsx)(e,Object.assign({},this.props,{history:t}))})}}return t.displayName=`HistoryComponent(${e.displayName})`,t}function eb(e,t=!1,n=!1){if(wd(e,TE().getState().queryObject))return;let r=n?Ye(e):TE().getState().queryObject.merge(e);r=r.without.apply(r,Object.keys(r).filter(e=>null===r[e]));const i=OS(r),o=Xw(JS.location,"?"+i);try{t?JS.replace(o):JS.push(o)}catch(e){console.error("Failed to change browser history",e)}}function tb(e,t){const{replaceHistory:n=!0,isReplaceHashObject:r=!1}=null!=t?t:{};if(wd(e,TE().getState().urlHashObject))return;const i=JS.location.search;let o=TE().getState().urlHashObject;o=DS(o);const s=!r;let a=o.merge(e,{deep:s});for(const e of Object.keys(a)){const t=a[e];if(null===e||null===t)a=a.without(e);else for(const n of Object.keys(t)){const r=t[n];null!==n&&null!==r||(a=a.update(e,e=>e.without(n)))}}const l=ES(a),u=Object.assign({},JS.location);u.hash=l;const c=Xw(u,i);try{n?JS.replace(c):JS.push(c)}catch(e){console.error("Failed to change browser history",e)}}function nb(e){pI(window.location.pathname,TE().getState().appConfig).pageId!==e&&JS.push(II(e,TE().getState().queryObject))}function rb(e,t){const n=TE().getState();let r=n.queryObject.views?n.queryObject.views.split(","):[];r=r.map(e=>hI(e,n.appConfig));const i=r.length,o=Object.keys(n.appConfig.views);r=r.filter(e=>o.includes(e));const s=r.length;if(r.includes(t)){if(i===s)return;eb({views:r.map(e=>n.appConfig.views[e].label).sort().join(",")})}else r=r.filter(t=>!n.appConfig.sections[e].views.includes(t)),r.push(t),eb({views:r.map(e=>SI(n.appConfig.views[e].label)).sort().join(",")})}function ib(e,t){var n;const r=TE().getState();let i=(null===(n=r.queryObject.views)||void 0===n?void 0:n.split(",").map(e=>hI(e,r.appConfig)))||[];i.includes(t.currentViewId)||(i=i.filter(t=>!r.appConfig.sections[e].views.includes(t)),i.push(t.currentViewId)),eb({views:i.map(e=>{var t;return SI(null===(t=r.appConfig.views[e])||void 0===t?void 0:t.label)}).sort().join(",")})}function ob(e){eb({dlg:e})}function sb(e,t){var n;const r=function(e){var t;const n={};if(null==e?void 0:e.queryParams)Object.keys(e.queryParams).forEach(t=>{switch(t){case hl.Id:break;case hl.Where:case hl.SpatialRel:n[t]=e.queryParams[t];break;case hl.Geometry:n[t]=JSON.stringify(e.queryParams[t]);break;default:const r=t;console.warn(`Unhandled case: ${r}`)}});else if((null==e?void 0:e.records)||(null==e?void 0:e.ids)){const r=(null===(t=null==e?void 0:e.records)||void 0===t?void 0:t.map(e=>e.getId()))||(null==e?void 0:e.ids);n[hl.Id]=r.sort((e,t)=>e.localeCompare(t,"en",{numeric:!0,sensitivity:"base"})).join("+")}return n}(t),i=function(e,t,n){const r="~",i=":",o=n.map(e=>`${e.type}${i}${e.dsIds.join(r)}${i}${e.value}`),s=(e,t,n,o)=>n.includes(e)?[t,n.filter(t=>t!==e).join(r),o].join(i):[t,n.join(r),o].join(i),a=(e,t,n,o)=>n.includes(e)?[t,n.join(r),o].join(i):[t,n.concat(e).join(r),o].join(i),l=[];return n.forEach((n,r)=>{const{type:i,dsIds:u,value:c}=n,d=t[i],p=d&&d===c;!d||d!==c||l.includes(i)?o[r]=s(e,i,u,c):p&&(o[r]=a(e,i,u,c),l.push(i)),0===uI(o[r]).length&&(o[r]="")}),Object.keys(t).forEach(n=>{const r=t[n];r&&!l.includes(n)&&o.push([n,e,r].join(i))}),o.filter(e=>!!e)}(e,r,uI(null===(n=TE().getState().urlHashObject)||void 0===n?void 0:n.data_s));let o=Ye.from({data_s:i.length>0?encodeURIComponent(i.join(",")):null});PI()&&(o=o.merge(Ye.from({zoom_to_selection:!0}))),tb(o),TE().getState().queryObject.data_id&&i.length>0&&eb({data_id:null},!0)}function ab(e,t){var n;const r=`${e}:${t}`,i=function(e,t,n){const r=[];let i=!1;t.forEach(t=>{t.split(":")[0]===e?n&&(r.push(n),i=!0):r.push(t)}),!i&&n&&r.push(n);return r}(e,(null===(n=TE().getState().queryObject.data_version)||void 0===n?void 0:n.split(","))||[],r);eb({data_version:i.length>0?i.join(","):null},!0)}class lb extends oS{constructor(){super(...arguments),this.name="change view action"}getDefaultMessageActionConfig(){return{}}filterMessageDescription(e){return e.messageType===Gy.DataRecordsSelectionChange}filterMessage(e){return!0}getSettingComponentUri(){return"change-section-view-action"}onExecute(e,t){const n=e;if(!n.records||0===n.records.length)return!0;let r;if(r=Array.isArray(t)&&t.length>0?t[t.length-1]:t,r){const{sectionId:e,viewId:t,useDataSources:i}=r;if((null==i?void 0:i.length)>0){const e=n.records[0].dataSource.id;if(!i.some(t=>t.dataSourceId===e||t.mainDataSourceId===e))return!0}rb(e,t)}return!0}}var ub=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class cb{constructor(){this.actions=[],this.actionClassPromises={}}static getInstance(){return cb.instance||(cb.instance=new cb,window._messageManager=cb.instance),cb.instance}getActions(){return this.actions}getWidgetActions(e){return this.actions.filter(t=>t.widgetId===e)}getAction(e,t){return this.actions.find(n=>n.widgetId===e&&n.name===t)}destroyWidgetActions(e){this.actions=this.actions.filter(t=>(t.widgetId===e&&t.destroy(),t.widgetId!==e))}destroySectionActions(e){this.actions=this.actions.filter(t=>t.sectionId!==e||(t.destroy(),!1))}registerWidgetActions(e,t){return ub(this,void 0,void 0,function*(){const n=[];return e.manifest.messageActions&&e.manifest.messageActions.forEach(r=>{const i=e.uri+"dist/"+r.uri;n.push(this.registerAction({id:`${e.id}-${r.name}`,name:r.name,uri:i,widgetId:e.id,appConfig:t,label:e.manifest.i18nMessages[`_action_${r.name}_label`]||r.label||r.name}))}),Promise.all(n)})}registerSectionActions(e,t){return ub(this,void 0,void 0,function*(){const n=Tb();return this.registerAction({id:`${e}-change-view-action`,name:"change-view",sectionId:e,appConfig:t,label:n.formatMessage({id:"messageAction_ChangeView",defaultMessage:Xg.messageAction_ChangeView}),ActionClass:lb})})}registerAction(e){return ub(this,void 0,void 0,function*(){let t=this.actions.find(t=>t.id===e.id);if(t)return Promise.resolve(t);return(()=>ub(this,void 0,void 0,function*(){return e.ActionClass?Promise.resolve(e.ActionClass):this.loadActionClass(e)}))().then(n=>ub(this,void 0,void 0,function*(){t=new n({id:e.id,name:e.name,widgetId:e.widgetId,sectionId:e.sectionId,label:e.label,intl:Tb(e.widgetId,"runtime")});let r=[];if(n.versionManager&&e.appConfig){r=dy(e.appConfig,e.widgetId,e.name).map(t=>ub(this,void 0,void 0,function*(){return this.upgradeActionConfig(t,n.versionManager,e.appConfig.widgets[e.widgetId].manifest.version)}))}return Promise.all(r).then(()=>(this.actions.push(t),t))}))})}upgradeActionConfig(e,t,n){return ub(this,void 0,void 0,function*(){const r=e.version,i=e.widgetId,o=e.config;return r||(e.version="1.0.0-beta2"),n===r?o:t?lt.valid(r)&&lt.valid(n)?t.upgrade(o,r,n,e.actionId).then(t=>{e.config=t,e.version=n}):(console.error("Bad widget action config version number, "+i+","+r+","+n),o):o})}loadActionClass(e){return ub(this,void 0,void 0,function*(){const t=e.uri;return this.actionClassPromises[t]||(e.widgetId&&(yield this.loadDependency(e)),this.actionClassPromises[t]=NI(t).then(e=>e.default)),this.actionClassPromises[t]})}loadDependency(e){return ub(this,void 0,void 0,function*(){var t;const{widgetId:n,appConfig:r}=e,i=null===(t=(r||TE().getState().appConfig).widgets[n])||void 0===t?void 0:t.manifest;if(!i||!i.dependency)return Promise.resolve();return Ng("string"==typeof i.dependency?[i.dependency]:i.dependency)})}publishMessage(e){return ub(this,void 0,void 0,function*(){const t=TE().getState().appConfig.messageConfigs,n=Object.keys(t||{});let r=null;for(let i=0;i<n.length;i++)if(t[n[i]].messageType===e.type&&t[n[i]].widgetId===e.widgetId){r=t[n[i]];break}if(r)for(let t=0;t<r.actions.length;t++){const n=r.actions[t],i=this.actions.find(e=>e.name===n.actionName&&(!(!n.widgetId||n.widgetId!==e.widgetId)||(!(!n.sectionId||n.sectionId!==e.sectionId)||!(n.widgetId||e.widgetId||n.sectionId))));if(!i){console.error(`Not find action: ${n.actionName}`);break}if(!i.filterMessage(e))break;i.widgetId&&this.openWidget(i.widgetId);if(!(yield this.exeAction(i,e,n)))return void console.warn(`Action execute failed. id: ${i.id}`)}})}openWidget(e){}exeAction(e,t,n){return ub(this,void 0,void 0,function*(){var r;if((null===(r=n.useDataSources)||void 0===r?void 0:r.length)>0)try{yield Promise.all(n.useDataSources.asMutable({deep:!1}).map(e=>mA.getInstance().createDataSourceByUseDataSource(e)))}catch(e){return Promise.resolve(!0)}const i=e.onExecute(t,n.config);return i&&i instanceof Promise?i.then(e=>e,function(e){return ub(this,void 0,void 0,function*(){return console.error(e),Promise.resolve(!1)})}):Promise.resolve(i)})}}const db=cb;var pb=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function fb(e,t){var n,r,i,o,s,a;const l=t.widgetId;if(!t.supportProviderWidget&&e===l)return!1;const u=null===(n=TE().getState().appConfig)||void 0===n?void 0:n.widgets[e];if(!u)return!1;const c=u.dataActions;if(null===(i=null===(r=null==c?void 0:c[t.name])||void 0===r?void 0:r.enabled)||void 0===i||i){const e=null===(s=null===(o=null==c?void 0:c[t.name])||void 0===o?void 0:o.actions)||void 0===s?void 0:s[l];return null===(a=null==e?void 0:e.enabled)||void 0===a||a}return!1}class hb{constructor(){this.actions=[],this.actionClassPromises={}}static getInstance(){return hb.instance||(hb.instance=new hb,window._dataActionManager=hb.instance),hb.instance}getActions(){return this.actions}getSupportedActions(e,t,n){return pb(this,void 0,void 0,function*(){var r,i;const o={},s=TE().getState().appConfig,a=null===(r=(null==s?void 0:s.widgets[e]).manifest)||void 0===r?void 0:r.excludeDataActions,l=Ty(e),u=[];for(const t of this.actions){let n=!1;if(t.widgetId){const r=null===(i=TE().getState().appConfig)||void 0===i?void 0:i.widgets[t.widgetId];n=this.isActionExcluded(`${r.manifest.name}.${t.name}`,a)||!fb(e,t)}else n=(null==a?void 0:a.includes(t.name))||!fb(e,t);n||u.push(t)}return yield Promise.all(u.map(r=>pb(this,void 0,void 0,function*(){let i=!1;try{i=yield this.testActionSupportData(r,t,n,e)}catch(t){console.error("testActionSupportData error",r,n,e),i=!1}i&&(r.widgetId&&!l.includes(r.widgetId)||(o[r.name]||(o[r.name]=[]),o[r.name].push(r)))}))),o})}isActionExcluded(e,t=[]){const n=e.split(".");if(2!==n.length)return!0;const r=`${n[0]}.*`;return t.some(t=>t===e||t===r)}registerWidgetActions(e,t){return pb(this,void 0,void 0,function*(){const n=[];if(!e.uri)return n;const r=r=>pb(this,void 0,void 0,function*(){var i;const o=e.uri+"dist/"+r.uri,s=`${e.id}-${r.name}`,a=yield this.registerAction({id:s,name:r.name,uri:o,widgetId:e.id,label:null!==(i=e.manifest.i18nMessages[`_action_${r.name}_label`])&&void 0!==i?i:r.label,icon:`${ry(e.uri).folderUrl}dist/${r.icon}`,appConfig:t});a&&n.push(a)});if(e.manifest.dataActions)for(let t=0;t<e.manifest.dataActions.length;t++){const n=e.manifest.dataActions[t];yield r(n)}return n})}registerAction(e){return pb(this,void 0,void 0,function*(){const t=this.actions.find(t=>t.id===e.id);if(t)return t;const n=()=>pb(this,void 0,void 0,function*(){return e.ActionClass?e.ActionClass:this.loadActionClass(e)});try{const t=new(yield n())({id:e.id,name:e.name,label:e.label,icon:e.icon,widgetId:e.widgetId,intl:Tb(e.widgetId,"runtime")});return this.actions.push(t),t}catch(t){console.error(`Action class ${e.uri} load failed.`,t)}return null})}executeDataAction(e,t,n,r,i){return pb(this,void 0,void 0,function*(){return e.widgetId&&this.openWidget(e.widgetId),e.onExecute(t,n,r,i)})}openWidget(e){const t=MI("jimu-layouts/layout-runtime"),n=TE().getState(),r=n.appConfig,i=n.browserSizeMode,o=t.searchUtils.getParentWidgetIdOfContent(r,e,$v.Widget,i);o&&(r.widgets[o].manifest.properties.isWidgetController?TE().dispatch(DA(e)):this.openWidget(o))}destroyWidgetActions(e){this.actions=this.actions.filter(t=>(t.widgetId===e&&t.destroy(),t.widgetId!==e))}loadActionClass(e){return pb(this,void 0,void 0,function*(){const t=e.uri;return this.actionClassPromises[t]||(e.widgetId&&(yield this.loadDependency(e)),this.actionClassPromises[t]=NI(t).then(e=>e.default)),this.actionClassPromises[t]})}loadDependency(e){return pb(this,void 0,void 0,function*(){var t;const{widgetId:n,appConfig:r}=e,i=null===(t=(r||TE().getState().appConfig).widgets[n])||void 0===t?void 0:t.manifest;if(!i||!i.dependency)return Promise.resolve();return Ng("string"==typeof i.dependency?[i.dependency]:i.dependency)})}testActionSupportData(e,t,n,r){return pb(this,void 0,void 0,function*(){return e.isSupported(t,n,r)})}}var gb=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class mb{static getInstance(){return mb.instance||(mb.instance=new mb,window._widgetManager=mb.instance),mb.instance}constructor(){this.widgets={},xE(this.onStoreChange.bind(this),["appConfig","widgets"]),xE(this.onStoreSectionChange.bind(this),["appConfig","sections"]),xE(this.onAppI18nMessagesChange.bind(this),["appI18nMessages"]),this.dsManager=mA.getInstance()}updateWidgetCache(e,t){if("__proto__"!==e&&"constructor"!==e&&"prototype"!==e){this.widgets[e]||(this.widgets[e]={});for(const n in t){if("__proto__"===n||"constructor"===n||"prototype"===n)return;this.widgets[e][n]=t[n]}}}getWidgetClass(e){var t,n,r;const i=null===(n=null===(t=TE().getState().appConfig)||void 0===t?void 0:t.widgets)||void 0===n?void 0:n[e];if(i)return null===(r=this.widgets[i.uri])||void 0===r?void 0:r.clazz}getWidgetClassByUri(e){var t;return null===(t=this.widgets[e])||void 0===t?void 0:t.clazz}getWidgetI18nMessagesByUri(e){var t;return(null===(t=this.widgets[e])||void 0===t?void 0:t.i18nMessages)||{}}destroyWidget(e){var t,n;const r=null===(n=null===(t=TE().getState().appConfig)||void 0===t?void 0:t.widgets)||void 0===n?void 0:n[e];r&&delete this.widgets[r.uri]}destroyWidgetByUri(e){this.checkWidgetUriInConfig(e)||delete this.widgets[e]}destroyAllWidgets(){this.widgets={}}checkWidgetUriInConfig(e){const t=TE().getState().appConfig.widgets||{};return!!Object.keys(t).find(n=>t[n].uri===e)}loadWidgetClass(e){return gb(this,void 0,void 0,function*(){var t,n;const r=null===(n=null===(t=TE().getState().appConfig)||void 0===t?void 0:t.widgets)||void 0===n?void 0:n[e];return r?this.loadWidgetClassByUri(r.uri):Promise.resolve(null)})}upgradeWidgetByUri(e,t){return gb(this,void 0,void 0,function*(){const n=TE().getState().appConfig.widgets,r=Object.keys(n).map(e=>n[e]).filter(t=>t.uri===e);if(0===r.length)return;if(!t)return void TE().dispatch(OA(e));const i=r.map(e=>this.upgradeWidget(e,t)),o=(yield Promise.all(i)).filter(e=>!!e);TE().dispatch(OA(e,o))})}upgradeWidget(e,t){return gb(this,void 0,void 0,function*(){var n;const r=e.manifest.version,i=e.version,o=e.config,s=e.manifest.name;if(r===i)return null;if(!i)return null;if(!lt.valid(i)||!lt.valid(r))return console.error("Bad widget version number, "+e.manifest.name+","+i+","+r),null;let a=null;e.outputDataSources&&(a=Ye({}),e.outputDataSources.forEach(e=>{a=a.set(e,TE().getState().appConfig.dataSources[e])}));const l={widgetJson:TE().getState().appConfig.widgets[e.id],outputDataSourceJsons:a};if(!lt.lt(i,r))return console.error("It seems this widget is configured with a higher version. Please upgrade to the latest version to view. "+s+","+i+","+r),null;try{let s;if(t.widgetUpgrade)s=yield t.widgetUpgrade(l,i,r,e.id);else{const a=yield t.upgrade(o,i,r,e.id);s={widgetJson:TE().getState().appConfig.widgets[e.id].set("config",a),outputDataSourceJsons:null===(n=e.outputDataSources)||void 0===n?void 0:n.reduce((e,t)=>e.set(t,TE().getState().appConfig.dataSources[t]),Ye({}))}}return s}catch(e){return console.error("Upgrade widget ["+s+"] error,"+e),null}})}loadWidgetClassByUri(e){return gb(this,void 0,void 0,function*(){var t,n;if(!this.checkWidgetUriInConfig(e))return Promise.resolve(null);if(null===(t=this.widgets[e])||void 0===t?void 0:t.clazzPromise)return this.widgets[e].clazzPromise;if(!(null===(n=this.widgets[e])||void 0===n?void 0:n.manifest))return console.error(e,"Should load manifest first."),Promise.reject(null);const r=this.widgets[e].manifest;return r.properties.hasMainClass?(this.widgets[e].clazzPromise=this.loadRawClass(e).then(t=>this.upgradeWidgetByUri(e,t.versionManager)).then(()=>gb(this,void 0,void 0,function*(){return this.injectWidgetProps(e)})).then(e=>e?this.appWidgetClassWrapperExtension(e,r):e).then(t=>t?(this.widgets[e].clazz=t,TE().dispatch(EA(e)),t):(delete this.widgets[e],t)),this.widgets[e].clazzPromise):Promise.resolve(null)})}loadRawClass(e){return gb(this,void 0,void 0,function*(){return this.loadWidgetDependency(e).then(()=>gb(this,void 0,void 0,function*(){return NI(`${e}dist/runtime/widget`)})).then(t=>{if(Jw(e)&&t.__set_webpack_public_path__){const n=e.indexOf("/widgets/");if(n<0)console.warn(`The widget, located at ${e}, is not present within the "widgets" folder. If the widget utilizes the "import()" function to dynamically load modules, it is necessary to deploy both the widget itself and the "chunks" folder within the "widgets" directory.`);else{const r=e.substring(0,n+1);t.__set_webpack_public_path__(r)}}const n=t.default?t.default:t;return this.widgets[e].rawClazz=n,n})})}loadWidgetTranslation(e,t){return gb(this,void 0,void 0,function*(){var n,r,i;const o=null===(n=this.widgets[e])||void 0===n?void 0:n.manifest;t||(t=TE().getState().appContext.locale);const s=Sb(t,o.translatedLocales);let a={};if(s)try{(null===(i=null===(r=this.widgets[e])||void 0===r?void 0:r.i18nMessagesPromiseByLocale)||void 0===i?void 0:i[s])?a=yield this.widgets[e].i18nMessagesPromiseByLocale[s]:(this.widgets[e].i18nMessagesPromiseByLocale||(this.widgets[e].i18nMessagesPromiseByLocale={}),this.widgets[e].i18nMessagesPromiseByLocale[s]=Eb(`${e}dist/runtime/translations`,s),a=yield Eb(`${e}dist/runtime/translations`,s))}catch(e){return console.error("Load widget translation error",e),Promise.resolve({})}o.i18nMessages=a;const l=TE().getState().appI18nMessages;return this.widgets[e].i18nMessages=Object.assign({},o.i18nMessages,l),this.widgets[e].i18nMessages})}resetWidgetI18nMessages(e){this.widgets[e].manifest.i18nMessages={},this.widgets[e].i18nMessages={}}openWidget(e){TE().dispatch(DA(e))}closeWidget(e){TE().dispatch(PA(e))}appWidgetClassWrapperExtension(e,t){const n=GI.getInstance().getExtensions(rg.WidgetClassWrapper)[0];return n?n.wrap(e,t):e}handleNewWidgetJson(e){return gb(this,void 0,void 0,function*(){return e.context=ry(e.uri),e.itemId&&(e.uri=yield this.getWidgetUriByItemId(e.itemId)),this.loadWidgetManifest(e.uri,!e.itemId).then(t=>gb(this,void 0,void 0,function*(){return e.manifest=t,this.processWidgetManifest(e)})).then(t=>gb(this,void 0,void 0,function*(){var n;e.manifest=t,e.version=t.version,(null===(n=t.properties)||void 0===n?void 0:n.defaultOffPanel)&&(e.offPanel=!0);return oy(TE().getState().appStateInBuilder?TE().getState().appStateInBuilder.appConfig:TE().getState().appConfig,e),this.loadWidgetDefaultConfig(e.uri)})).then(t=>(e.config=t,e))})}getWidgetUriByItemId(e){return gb(this,void 0,void 0,function*(){if(fg(TE().getState().portalUrl))return Promise.reject("Not support yet.");const t=yield Pi(e,{portal:cg(TE().getState().portalUrl),authentication:Tv.getInstance().getSessionByUrl(TE().getState().portalUrl)}).catch(e=>Tv.getInstance().handleAuthError(e,!1));if("Experience Builder Widget"!==t.type)return Promise.reject("Item type is not correct.");if(!t.url)return Promise.reject("Item does not have url.");let n;return n=/manifest\.json$/.test(t.url)?t.url.substring(0,t.url.length-13):/\/$/.test(t.url)?t.url:t.url+"/",n=n.replace(/^http:\/\//,"https://"),n})}loadWidgetManifest(e,t){return gb(this,void 0,void 0,function*(){var n;if(!e)return Promise.reject("Widget uri or itemId is required.");if(t&&Jw(e))return Promise.reject("Remote URL is not allowed.");if(this.widgets[e]||(this.widgets[e]={}),this.widgets[e].manifestPromise)return this.widgets[e].manifestPromise;let r;if(null===(n=window.widgetsManifest)||void 0===n?void 0:n[e])r=Promise.resolve(window.widgetsManifest[e]);else{const t=`${ry(e).folderUrl}manifest.json`;r=window.fetch(t).then(e=>gb(this,void 0,void 0,function*(){return 404===e.status?Promise.reject("404, widget not found."):e.json()}))}return this.widgets[e].manifestPromise=r.then(e=>gb(this,void 0,void 0,function*(){if(e.error&&e.error.code)return Promise.reject(e.error);const t=e;return!t.widgetType&&t.properties&&t.properties.type&&(t.widgetType=t.properties.type,delete t.properties.type),!t.layouts&&t.properties&&t.properties.layouts&&(t.layouts=t.properties.layouts,delete t.properties.layouts),!t.translatedLocales&&t.supportedLocales&&(t.translatedLocales=t.supportedLocales),Promise.resolve(t)})),this.widgets[e].manifestPromise})}processWidgetManifest(e){return gb(this,void 0,void 0,function*(){const t=iy(e.manifest);e.manifest=t,this.widgets[e.uri]?this.widgets[e.uri].manifest=t:this.widgets[e.uri]={manifest:t,manifestPromise:Promise.resolve(t)};const n=TE().getState().appContext.locale;return this.loadWidgetTranslation(e.uri,n).then(t=>this.widgets[e.uri].manifest)})}registerManifestProps(e,t){return gb(this,void 0,void 0,function*(){const n=e.manifest,r=[];return n.extensions&&n.extensions.length>0&&r.push(GI.getInstance().registerWidgetExtensions(e,!t)),n.messageActions&&n.messageActions.length>0&&db.getInstance().registerWidgetActions(e,t),n.dataActions&&n.dataActions.length>0&&hb.getInstance().registerWidgetActions(e,t),Promise.all(r).then(()=>null)})}unRegisterManifestProps(e){GI.getInstance().destroyWidgetExtensions(e),db.getInstance().destroyWidgetActions(e),hb.getInstance().destroyWidgetActions(e)}loadWidgetDefaultConfig(e){return gb(this,void 0,void 0,function*(){var t;if(!this.widgets[e].manifest.properties.hasConfig)return Promise.resolve(null);if(null===(t=this.widgets[e])||void 0===t?void 0:t.defaultConfigPromise)return this.widgets[e].defaultConfigPromise;const n=ry(e).folderUrl;return this.widgets[e].defaultConfigPromise=window.fetch(`${n}config.json`).then(e=>gb(this,void 0,void 0,function*(){return 404===e.status?Promise.reject("404, widget not found."):e.json()})).then(e=>e),this.widgets[e].defaultConfigPromise})}loadWidgetDependency(e){return gb(this,void 0,void 0,function*(){const t=this.widgets[e].manifest;if(!t.dependency)return Promise.resolve();return Ng("string"==typeof t.dependency?[t.dependency]:t.dependency)})}injectWidgetProps(e){return gb(this,void 0,void 0,function*(){const t=this.widgets[e].manifest,n=t.name,r=Mw().withTheme,i=this.widgets[e].rawClazz,o=Vy(r(Ly(i),window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder));if(!this.checkWidgetUriInConfig(e))return Promise.resolve(null);const s=(t,n)=>{var r,o;const s=n.widgetId;if(!t.appConfig.widgets[s])return{};const a=t.widgetsRuntimeInfo[s],l=Object.assign({portalUrl:t.portalUrl,portalSelf:t.portalSelf,user:t.user,locale:t.appContext.locale,appI18nMessages:t.appI18nMessages,i18nMessages:null===(r=this.widgets[e])||void 0===r?void 0:r.i18nMessages},n);t.widgetsState[s]&&(l.stateProps=t.widgetsState[s]),t.widgetsMutableStateVersion[s]&&(l.mutableStatePropsVersion=t.widgetsMutableStateVersion[s],l.mutableStateProps=Fy.getInstance().getStateValue([s])),(null===(o=this.widgets[e])||void 0===o?void 0:o.widgetBuilderSupportModules)&&(l.builderSupportModules=this.widgets[e].widgetBuilderSupportModules),t.widgetsPreloadProps&&t.widgetsPreloadProps[s]&&Object.assign(l,t.widgetsPreloadProps[s]);const u=Object.assign(l,t.appConfig.widgets[s],a);return Object.assign(u,i.mapExtraStateProps?i.mapExtraStateProps(t,u):{})},a=e=>gb(this,void 0,void 0,function*(){const t=TE().getState().appConfig.widgets[e];if(!t)return Promise.resolve(null);if(t.version===t.manifest.version)return Promise.resolve(null);if(!i.versionManager)return void TE().dispatch(CA(e));const n=yield this.upgradeWidget(t,i.versionManager);TE().dispatch(CA(e,n))});class l extends F.PureComponent{constructor(e){super(e),this.state={fullConfig:null}}componentDidMount(){a(this.props.widgetId),i.getFullConfig&&this.setState({fullConfig:i.getFullConfig(this.props.config)})}componentDidUpdate(e){a(this.props.widgetId),i.getFullConfig&&e.config!==this.props.config&&this.setState({fullConfig:i.getFullConfig(this.props.config)})}getFullConfig(e){return i.getFullConfig?i.getFullConfig(e):e}render(){const{id:e,manifest:t,version:n,i18nMessages:r}=this.props;if(!e)return null;if(i.versionManager&&n&&t.version!==n)return null;const s=Object.assign({},this.props);return s.savedConfig=this.props.config,this.state.fullConfig?s.config=this.state.fullConfig:s.config=this.getFullConfig(this.props.config),(0,sg.jsx)(Ny,{locale:this.props.locale,defaultLocale:this.props.locale,messages:r,children:(0,sg.jsx)(o,Object.assign({},s))})}}return l.displayName=`WidgetWrapper(${n})`,this.loadWidgetBuilderSupportModules(e,t).then(()=>gb(this,void 0,void 0,function*(){return this.checkWidgetUriInConfig(e)?Promise.resolve(Ue(s)(l)):Promise.resolve(null)}))})}loadWidgetBuilderSupportModules(e,t){return gb(this,void 0,void 0,function*(){var n;const r=[];if(window.jimuConfig.isInBuilder){if(null===(n=this.widgets[e])||void 0===n?void 0:n.widgetBuilderSupportModulesPromise)return this.widgets[e].widgetBuilderSupportModulesPromise;if(t.properties.hasEmbeddedLayout?r.push(NI("jimu-layouts/layout-builder").then(e=>e.LayoutEntry)):r.push(Promise.resolve(null)),t.properties.hasBuilderSupportModule){const t=`${e}dist/runtime/builder-support`;r.push(NI(t).then(e=>e.default))}else r.push(Promise.resolve(null));return this.widgets[e].widgetBuilderSupportModulesPromise=Promise.all(r).then(t=>(this.widgets[e].widgetBuilderSupportModules={jimuForBuilderLib:BI(),LayoutEntry:t[0],widgetModules:t[1]},this.widgets[e].widgetBuilderSupportModules)),this.widgets[e].widgetBuilderSupportModulesPromise}return Promise.resolve({jimuForBuilderLib:null})})}onStoreChange(e,t){e&&t&&Object.keys(e).forEach(e=>{t[e]||this.unRegisterManifestProps(e)}),e&&t&&Object.keys(t).forEach(n=>{e[n]?e[n].uri!==t[n].uri&&(this.unRegisterManifestProps(n),this.registerManifestProps(t[n])):this.registerManifestProps(t[n])})}onStoreSectionChange(e,t){e&&t&&Object.keys(e).forEach(e=>{t[e]||db.getInstance().destroySectionActions(e)}),e&&t&&Object.keys(t).forEach(t=>{e[t]||db.getInstance().registerSectionActions(t)})}onAppI18nMessagesChange(e,t){e!==t&&Object.keys(this.widgets).forEach(e=>{const n=this.widgets[e];n&&n.i18nMessages&&(n.i18nMessages=Object.assign({},n.i18nMessages,t))})}}const vb=mb;var yb=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function Sb(e,t){const n=wb(e=e.toLowerCase(),t);if(n){if(n!==(t&&t[0]))return n}}function bb(e){if(!e)return;const t=["language","browserLanguage","systemLanguage","userLanguage"];let n,r;if(Array.isArray(e.languages)&&e.languages.length>0&&(r=e.languages[0],r&&r.length))return r;for(n=0;n<t.length;n++)if(r=e[t[n]],r&&r.length)return r}function wb(e,t=[]){if(e){if(window.jimuConfig.downloadLocales){const e=new Set(window.jimuConfig.downloadLocales);t=t.filter(t=>e.has(t))}return Db(e,t)}}function Ib(e,t){return e.split("-")[0]===t.split("-")[0]}function Eb(e,t){return yb(this,void 0,void 0,function*(){return yield NI(`${e}/${t}`)})}function Ob(e){let t=!1;const n=["ar","he"];for(let r=0;r<n.length;r++)Ib(n[r],e)&&(t=!0);return t}let Cb={};function Tb(e="_jimu",t="runtime"){var n,r,i,o,s,a,l,u;const c=`${e}-${t}`;if(Cb[c])return Cb[c];const d={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}},p=TE().getState();if(!p)return null;let f;if("_jimu"===e)f=og({locale:p.appContext.locale,defaultLocale:p.appContext.locale,messages:p.appI18nMessages},d);else if("runtime"===t){const t=window.jimuConfig.isBuilder?null===(n=p.appStateInBuilder)||void 0===n?void 0:n.appConfig:p.appConfig,o=vb.getInstance().getWidgetI18nMessagesByUri(null===(i=null===(r=null==t?void 0:t.widgets)||void 0===r?void 0:r[e])||void 0===i?void 0:i.uri);f=og({locale:p.appContext.locale,defaultLocale:p.appContext.locale,messages:o},d)}else{let t;if(window.jimuConfig.isBuilder){const n=null===(l=null===(a=null===(s=null===(o=p.appStateInBuilder)||void 0===o?void 0:o.appConfig)||void 0===s?void 0:s.widgets)||void 0===a?void 0:a[e])||void 0===l?void 0:l.manifest.name;t=null===(u=p.builder.widgetSettingI18nMessages)||void 0===u?void 0:u[n]}else t={};const n=Object.assign({},t,p.appI18nMessages);f=og({locale:p.appContext.locale,defaultLocale:p.appContext.locale,messages:n},d)}return Cb[c]=f,f}function xb(){Cb={}}function Ab(e){return Db(e,["ar","en","he","ja","ko","es-mx","th","zh","it-ch","de-ch"])?".":","}function Db(e,t=[]){let n;if(e=e.toLowerCase(),t.includes(e))n=e;else{const r=e.split("-")[0];t.includes(r)?n=r:"nb"!==e&&"nn"!==e&&"nb"!==r&&"nn"!==r||!t.includes("no")||(n="no")}return n}function Rb(e){return yb(this,void 0,void 0,function*(){const t=TE().getState();if(t.appContext.locale===e)return;const n=wb(e,Gd)||"en";if(n===t.appContext.translatedLocale)return void Lb(e,n);const r=Sb(e,Gd);if(!r)return function(){const e=Object.assign({},Xg),t=MI("jimu-ui"),n=MI("jimu-layouts/runtime"),r=MI("jimu-for-builder");t&&Object.assign(e,t.defaultMessages),n&&Object.assign(e,n.defaultMessages),r&&Object.assign(e,r.defaultMessages),TE().dispatch(NA("all-jimu-packages",e))}(),jb().forEach(e=>{vb.getInstance().resetWidgetI18nMessages(e)}),void Lb(e,n);yield function(e){return yb(this,void 0,void 0,function*(){const t=["jimu-core/lib/translations","jimu-ui/lib/translations","jimu-layouts/lib/translations","jimu-for-builder/lib/translations"].map(t=>{const n=`${t}-${e}`;return Pb[n]||(Pb[n]=Eb(t,e)),Pb[n]});yield Promise.all(t).then(e=>{const t=e.reduce((e,t)=>Object.assign(e,t),{});TE().dispatch(NA("all-jimu-packages",t))})})}(r),yield function(e){return yb(this,void 0,void 0,function*(){const t=jb().map(t=>vb.getInstance().loadWidgetTranslation(t,e));yield Promise.all(t)})}(r),Lb(e,n)})}const Pb={};function jb(){const e=TE().getState().appConfig.widgets;return Object.keys(e).reduce((t,n)=>{const r=e[n];return t.includes(r.uri)||t.push(r.uri),t},[])}function Lb(e,t){window.locale=e,_b(e),TE().dispatch(WD(e,t,Ob(e)))}function _b(e){if("undefined"==typeof document)return;const t=document.getElementsByTagName("html")[0];t.setAttribute("lang",e),Ob(e)?(t.setAttribute("dir","rtl"),t.className+=" esriRtl jimu-rtl",t.className+=" "+e+" "+(-1!==e.indexOf("-")?e.split("-")[0]:"")):(t.setAttribute("dir","ltr"),t.className+=" esriLtr jimu-ltr",t.className+=" "+e+" "+(-1!==e.indexOf("-")?e.split("-")[0]:""))}function Mb(e,t=!1){var n;const r={};e.color&&(r.color=e.color),e.bg&&(r.backgroundColor=e.bg);const i=e.border;var o;return(null==i?void 0:i.width)&&(r.borderWidth=i.width,r.borderStyle=null!==(n=i.type)&&void 0!==n?n:t?"dashed":"solid"),(null==i?void 0:i.color)&&(r.borderColor=i.color),e.borderRadius&&(r.borderRadius=e.borderRadius),e.shadow&&(r.boxShadow=e.shadow),e.bold?r.fontWeight="bold":e.fontWeight&&(r.fontWeight=e.fontWeight),(e.decoration||e.underline||e.strike)&&(r.textDecoration=e.decoration||((o=e)?o.underline&&o.strike?"underline line-through":o.underline?"underline":o.strike?"line-through":"none":"none")),r.fontStyle=e.italic?"italic":"normal",r}const Nb=(e,t)=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},void 0!==e.paddingY&&{paddingTop:e.paddingY,paddingBottom:e.paddingY}),void 0!==e.paddingX&&{paddingLeft:e.paddingX,paddingRight:e.paddingX}),e.fontSize&&{fontSize:e.fontSize}),e.lineHeight&&{lineHeight:e.lineHeight}),e.borderRadius&&{borderRadius:e.borderRadius}),e.fontSize&&{fontSize:e.fontSize}),{"> .icon-btn-sizer":Object.assign({},"string"==typeof e.lineHeight&&{minWidth:e.lineHeight,minHeight:e.lineHeight})}),void 0!==e.paddingY&&{paddingTop:e.paddingY,paddingBottom:e.paddingY}),void 0!==e.paddingX&&{paddingLeft:e.paddingX,paddingRight:e.paddingX}),t&&{"&.icon-btn":{lineHeight:1,padding:"4px"}});function kb(e,t=!1){if(!e)return{};const{default:n,hover:r,active:i,disabled:o}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n&&Mb(n,t)),r&&{'&:hover:not(.active), &[aria-expanded="true"]':Object.assign({},Mb(r,t))}),i&&{"&:not(:disabled):not(.disabled).active":Object.assign({},Mb(i,t)),"&:not(:disabled):not(.disabled)":{cursor:"pointer"}}),o&&{"&.disabled, &:disabled":Object.assign(Object.assign({},Mb(o,t)),{"&:hover":Object.assign({},Mb(o,t))})})}const Ub=(e,t)=>{var n;const{type:r,variant:i,color:o,asLink:s,dashed:a}=e,l=((e,t,n,r)=>{if(r||"link"===e)return"link";if(!e&&!t)return"default";if(t){if("contained"===t){if(!n||"default"===n)return"default";if("primary"===n)return"primary";if("danger"===n||"error"===n)return"danger"}else if("outlined"===t){if("primary"===n)return"secondary"}else if("text"===t&&(!n||"default"===n))return"tertiary"}else if(e)return e})(r,i,o,s),u=l?null===(n=t.variants)||void 0===n?void 0:n[l]:null;return u?kb(u,a):null};function Fb(e,t){const n=e?t?"left":"right":"bottom";return Object.assign({},["top","bottom","left","right"].reduce((e,t)=>(n!==t&&(e[`border${Bb(t)}Width`]="0 !important"),e),{}))}function Bb(e){return e.charAt(0).toUpperCase()+e.slice(1)}const $b=(e,t)=>{var n;const r=e.tabs,i=e.underline,o=e.pills,s=e.vertical,a=e.right,l=e.iconOnly,u=e.type||(i?"underline":r?"tabs":o?"pills":"default"),c=null===(n=null==t?void 0:t.variants)||void 0===n?void 0:n[u],d=[];return c&&((null==c?void 0:c.root)&&d.push(function(e,t){var n,r,i,o,s,a,l;const u=e.vertical,c=null===(n=e.showText)||void 0===n||n,d=e.textAlign,p=e.iconPosition,f=null!==(i=null!==(r=e.gap)&&void 0!==r?r:t.gutter)&&void 0!==i?i:0,h=null!==(o=null==t?void 0:t.size)&&void 0!==o?o:{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({".jimu-button.nav-link-caret-btn":{border:"none"}},Mb(t.root)),f&&(u?{".nav-item + .nav-item":{marginTop:f},".nav-item ul.dropdown-menu-inline":{marginTop:f}}:{".nav-item + .nav-item":{marginLeft:f}})),t.icon&&{".jimu-icon, .left-icon":{marginRight:c?null!==(s=null==t?void 0:t.icon.spacing)&&void 0!==s?s:".5rem":"unset"},".right-icon, .right-icon.jimu-icon":{marginLeft:c?null!==(a=null==t?void 0:t.icon.spacing)&&void 0!==a?a:".5rem":"unset",marginRight:c?"auto":"unset"}}),"above"===p&&t.icon&&{".jimu-icon":{marginLeft:"auto",marginRight:"auto",marginBottom:c?null!==(l=t.icon.spacing)&&void 0!==l?l:".5rem":"unset"}}),t.icon&&{".nav-link-caret-btn":{margin:`-.3125rem ${t.icon.spacing}`}}),u&&h&&{".nav-link.with-caret":{position:"relative",paddingRight:null==h?void 0:h.paddingX,".nav-link-caret-btn":Object.assign(Object.assign({position:"absolute"},"right"===d?{left:h.paddingX}:{right:h.paddingX}),{height:"20px",width:"20px",borderRadius:"0",top:"calc(50% - 10px)",bottom:"calc(50% - 10px)",padding:"0",margin:"0",display:"inline-flex",alignItems:"center",justifyContent:"center"})},".nav-link.padding-plus-20":Object.assign({},"right"===d?{paddingLeft:`calc(${h.paddingX} + 20px)`}:{paddingRight:`calc(${h.paddingX} + 20px)`})})}(e,c)),d.push(function(e,t,n,r,i){var o,s,a,l,u,c;const{root:d,item:p,size:f}=t;return Object.assign(Object.assign(Object.assign({".nav-item > .nav-link":Object.assign(Object.assign({},p&&kb(p)),f&&Nb(f,i)),".nav-item > .nav-link.with-caret":{paddingRight:"0px"}},"pills"===e&&{"&.nav-pills":Object.assign({},Fb(n,r))}),"tabs"===e&&{"&.nav-tabs":Object.assign(Object.assign({},Fb(n,r)),{".nav-item":Object.assign(Object.assign(Object.assign({userSelect:"none"},!n&&{marginBottom:`-${null===(o=null==d?void 0:d.border)||void 0===o?void 0:o.width}`}),n&&{["margin"+(r?"Left":"Right")]:`-${null===(s=null==d?void 0:d.border)||void 0===s?void 0:s.width}`}),{".nav-link":Object.assign(Object.assign(Object.assign({},!n&&Object.assign(Object.assign({},(null==d?void 0:d.borderRadius)&&Hn("top",null==d?void 0:d.borderRadius)),{"&.active":{borderBottomColor:"transparent !important"}})),n&&Object.assign({},(null==d?void 0:d.borderRadius)&&Hn(r?"right":"left",null==d?void 0:d.borderRadius))),{"&.active, &.disabled":{cursor:"default"}})}),".dropdown-menu":Object.assign({marginTop:`-${null===(a=null==d?void 0:d.border)||void 0===a?void 0:a.width}`},Hn("top",0))})}),"underline"===e&&{"&.nav-underline":Object.assign(Object.assign(Object.assign({},Fb(n,r)),{".nav-item":Object.assign({},!n&&{marginBottom:`-${null===(l=null==d?void 0:d.border)||void 0===l?void 0:l.width}`}),".nav-link":Object.assign(Object.assign({},Fb(n,r)),{'&:not(:disabled):not(.disabled):active, &[aria-expanded="true"]':{borderBottomColor:"transparent"}})}),n&&{".nav-item":{["margin"+(r?"Left":"Right")]:"-1px"},".nav-link":{[`border${Bb(r?"left":"right")}Width`]:`${null===(c=null===(u=null==p?void 0:p.active)||void 0===u?void 0:u.border)||void 0===c?void 0:c.width} !important`}})})}(u,c,s,a,l))),d.length?d:null};const Vb=(e,t)=>{var n;const{type:r,variant:i}=e,o=i?"text"===i?"tertiary":"default":null!=r?r:"default",s=null===(n=null==t?void 0:t.variants)||void 0===n?void 0:n[o],a=[];return s&&((null==s?void 0:s.root)&&a.push(Mb(s.root)),(null==s?void 0:s.item)&&a.push(function(e){return{".jimu-btn.previous, .jimu-btn.next":kb(e)}}(s.item))),a.length?a:null};const Gb=(e,t)=>{var n,r,i;const o=null!==(n=null==e?void 0:e.type)&&void 0!==n?n:"default",s=null===(i=null===(r=null==t?void 0:t.variants)||void 0===r?void 0:r[o])||void 0===i?void 0:i.button,a=[];return s&&a.push(function(e){return{".jimu-btn.page-link":kb(e)}}(s)),a.length?a:null};function Wb(e,t){const{default:n,hover:r}=e;return Object.assign(Object.assign(Object.assign({visibility:t?"hidden":"visible"},Mb(n)),{boxSizing:"border-box",transition:"color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out"}),r&&{"&:hover":Object.assign({},Mb(r))})}const Hb=(e,t,n)=>{var r,i,o,s;const a=null!==(r=e.size)&&void 0!==r?r:"default",l=null!==(i=e.hideThumb)&&void 0!==i&&i,u=null===(o=null==t?void 0:t.sizes)||void 0===o?void 0:o[a],c=null===(s=null==t?void 0:t.variants)||void 0===s?void 0:s.default,d=[];return c&&((null==c?void 0:c.root)&&d.push(Mb(c.root)),d.push(function(e,t,n){const{track:r,thumb:i,progress:o}=e;return{'&[type="range"]':Object.assign(Object.assign(Object.assign(Object.assign({},i&&{"&::-webkit-slider-thumb":Object.assign({WebkitAppearance:"none"},Wb(i,t)),"&::-moz-range-thumb":Object.assign({MozAppearance:"none"},Wb(i,t))}),r&&{"&::-webkit-slider-runnable-track":Object.assign(Object.assign({},Mb(r)),(null==o?void 0:o.default)&&{background:`linear-gradient(to ${n?"left":"right"}, ${o.default.bg}, ${o.default.bg}) ${r.bg} no-repeat left`,backgroundSize:"50% 100%, 100% 100%"}),"&::-moz-range-track":Object.assign({},Mb(r))}),(null==o?void 0:o.default)&&{"&::-moz-range-progress":Object.assign({},Mb(o.default))}),(null==i?void 0:i.focus)&&{"&:focus":{"&::-webkit-slider-thumb":{boxShadow:i.focus.shadow},"&::-moz-range-thumb":{boxShadow:i.focus.shadow}}})}}(c,l,n))),u&&d.push(function(e){const{root:t,thumb:n}=e;return Object.assign(Object.assign({},t&&{"&::-webkit-slider-runnable-track":{height:t},"&::-moz-range-track":{height:t},"&::-moz-range-progress":{height:t}}),n&&{height:n,"&::-webkit-slider-thumb":{width:n,height:n,marginTop:`-${Jt(`(${n} - ${t}) * 0.5`)}`},"&::-moz-range-thumb":{width:n,height:n,marginTop:`-${Jt(`(${n} - ${t}) * 0.5`)}`}})}(u)),d.length?d:null},zb=(e,t={})=>{const n=e.theme;return Object.assign(Object.assign(Object.assign(Object.assign({color:t.color||n.sys.color.surface.backgroundText,background:t.bg||n.sys.color.surface.background},t.border&&{border:`${t.border.color} solid ${t.border.width}`}),void 0!==t.paddingY&&{paddingTop:t.paddingY,paddingBottom:t.paddingY}),void 0!==t.paddingX&&{paddingLeft:t.paddingX,paddingRight:t.paddingX}),t.boxShadow&&{boxShadow:t.boxShadow})};var qb=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const Jb=a(2528).exbVersion;var Kb;function Yb(e){return"x"in e&&"y"in e?"esriGeometryPoint":"points"in e?"esriGeometryMultipoint":"paths"in e||"curvePaths"in e?"esriGeometryPolyline":"rings"in e||"curveRings"in e?"esriGeometryPolygon":"esriGeometryEnvelope"}function Xb(){var e,t,n,r,i,o,s,a,l,u,c;let d,p,f;window.jimuConfig.isBuilder?(d=null===(t=null===(e=TE().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig,f=null===(o=null===(i=null===(r=null===(n=TE().getState())||void 0===n?void 0:n.appStateInBuilder)||void 0===r?void 0:r.portalSelf)||void 0===i?void 0:i.helperServices)||void 0===o?void 0:o.geometry):(d=null===(s=TE().getState())||void 0===s?void 0:s.appConfig,f=null===(u=null===(l=null===(a=TE().getState())||void 0===a?void 0:a.portalSelf)||void 0===l?void 0:l.helperServices)||void 0===u?void 0:u.geometry),(null==d?void 0:d.utilities)&&Object.keys(d.utilities).some(e=>{const t=d.utilities[e];return!!/\/rest\/services\/.*\/GeometryServer\/?/.test(t.url)&&(p=t.url,!0)});const h="prod"===window.jimuConfig.hostEnv?"":window.jimuConfig.hostEnv;return null!==(c=null!=p?p:null==f?void 0:f.url)&&void 0!==c?c:`https://utility${h}.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer`}function Qb(e,t){return ow(e,t)}function Zb(e,t){return ow(e,t)}function ew(){var e;return"undefined"!=typeof window&&Boolean("ontouchstart"in window||(null===(e=window.navigator)||void 0===e?void 0:e.maxTouchPoints)>0||window.DocumentTouch&&document instanceof window.DocumentTouch)}function tw(){return window.self!==window.top&&!window.jimuConfig.isInBuilder}function nw(e){return e.width<=Id[0]?La.Small:e.width<=Id[1]?La.Medium:La.Large}function rw(e,t){const n=Vu(e,`forBuilderAttributes.viewPortSize.${t}`);return n||(t===(null==e?void 0:e.mainSizeMode)?{width:0,height:0}:Td[t][1])}function iw(e){return e===La.Small?Id[0]:e===La.Medium?Id[1]:1e5}function ow(e,t){switch(e){case"opened":switch(t){case"opened":return null;case"closed":return"onOpen";case"active":return"onDeActive"}case"closed":switch(t){case"opened":return"onClose";case"closed":return null;case"active":return["onDeActive","onClose"]}case"active":switch(t){case"opened":return"onDeActive";case"closed":return["onOpen","onActive"];case"active":return null}}}function sw(e,t){return qb(this,void 0,void 0,function*(){return yield new Promise(n=>{let r;r=t?document.getElementById(t):document.getElementsByTagName("head")[0];const i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",e),i.onload=()=>{n(null)},r.appendChild(i)})})}function aw(e,t){t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{e.prototype[n]=t.prototype[n]})})}function lw(e,t){return e.length===t.length&&(e=e.sort((e,t)=>e>t?-1:1),t=t.sort((e,t)=>e>t?-1:1),wd(e,t))}!function(e){e.None="None Version Heigher",e.Draft="Draft Version Heigher",e.Published="Published Version Heigher",e.Both="Both Version Heigher"}(Kb||(Kb={}));const uw=/([A-Z])/g,cw=/^ms-/;function dw(e){return e.replace(uw,"-$1").toLowerCase().replace(cw,"-ms-")}function pw(e){let t="";for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n];null!=r&&(t?t+=";"+dw(n)+":"+r:t=dw(n)+":"+r)}return t||""}function fw(e){return qb(this,arguments,void 0,function*(e,t=1e3,n=100){const r=(new Date).getTime();function i(o){const s=(new Date).getTime(),a=e();if(a)o(null,a);else{if(r+t<s)return void o("Timeout",null);setTimeout(()=>{i(o)},n)}}return new Promise((e,t)=>{i((n,r)=>{n?t(new Error(n)):e(r)})})})}function hw(){return window.jimuConfig.isBuilder?`exb-${TE().getState().appStateInBuilder.appId||TE().getState().appStateInBuilder.appPath}`:`exb-${TE().getState().appId||TE().getState().appPath}`}const gw=()=>(65536*(1+Math.random())|0).toString(16).substring(1),mw=()=>gw()+gw()+"_"+gw()+"_"+gw()+"_"+gw()+"_"+gw()+gw()+gw(),vw=e=>e.toString().includes(".")?e.toString().split(".")[1].length:0,yw=(e,t=Ye([]))=>{const n=new RegExp(`^${e}\\_(\\d+)$`);let r=-1;return t.forEach(e=>{const t=e.match(n);t&&(r=Math.max(r,parseInt(t[1],10)))}),`${e}_${r+1}`};function Sw(e,t,n){const r=/\$\{\w*\}/g;for(const i in e)if("string"==typeof e[i]){const o=e[i].match(r);if(o&&o.length>0){let r=e[i];o.forEach(e=>{const i=e.substring(2,e.length-1);if("appResourceUrl"!==i){const o=t.formatMessage({id:i,defaultMessage:n&&n[i]});r=r.replace(e,o)}}),e[i]=r}}else"object"==typeof e[i]&&Sw(e[i],t,n);return e}function bw(){document.getElementById("loading").style.display="none",document.getElementById("app").style.display="block"}const ww=e=>{if(null==e?void 0:e.format){if(e.type===_a.Date)return fp(e.format.dateFormat);if(e.type===_a.Number){const t=e.format.places,n=e.format.digitSeparator,r={style:"decimal",notation:"standard"};return"number"==typeof t&&(r.minimumFractionDigits=t,r.maximumFractionDigits=t),"boolean"==typeof n&&(r.useGrouping=n),r}}};function Iw(e){const t={props:null,result:null};return function(n){if("object"!=typeof n)return console.error("Memorize object param only."),n;if(Object.keys(n).find(e=>{var r;return n[e]!==(null===(r=t.props)||void 0===r?void 0:r[e])})){const r=e.call(this,n);return t.props=n,t.result=r,r}return t.result}}function Ew(){try{return Object.keys(localStorage)}catch(e){return console.error("Read Local storage keys error.",e),[]}}function Ow(e){try{return localStorage.getItem(e)}catch(e){return console.error("Read Local storage error.",e),null}}function Cw(e,t){try{localStorage.setItem(e,t)}catch(e){console.error("Set Local storage error.",e)}}function Tw(e){if(!e)return Kb.None;const t=(null==e?void 0:e.typeKeywords)||[];let n,r,i=!1,o=!1;return null==t||t.forEach(e=>{var t,i;(null==e?void 0:e.includes("version:"))&&(n=null===(t=null==e?void 0:e.split("version:"))||void 0===t?void 0:t[1]),(null==e?void 0:e.includes("publishVersion:"))&&(r=null===(i=null==e?void 0:e.split("publishVersion:"))||void 0===i?void 0:i[1])}),n&&(i=lt.lt(Jb,n)),r&&(o=lt.lt(Jb,r)),i||o?!i&&o?Kb.Published:i&&!o?Kb.Draft:i&&o?Kb.Both:void 0:Kb.None}function xw(){try{return Object.keys(sessionStorage)}catch(e){return console.error("Read Session storage keys error.",e),[]}}function Aw(e){try{return sessionStorage.getItem(e)}catch(e){return console.error("Read session storage error.",e),null}}function Dw(e,t){try{sessionStorage.setItem(e,t)}catch(e){console.error("Set session storage error.",e)}}function Rw(e){try{localStorage.removeItem(e)}catch(e){console.error("Remove from Local storage error.",e)}}function Pw(e){try{sessionStorage.removeItem(e)}catch(e){console.error("Remove from session storage error.",e)}}function jw(e,t=!0){return[e<0?"-":"",Tb().formatNumber(Math.abs(e),{useGrouping:t})]}function Lw(e){var t,n;const r=TE().getState().appContext.locale,i=null!==(n=null===(t=TE().getState().appContext)||void 0===t?void 0:t.isRTL)&&void 0!==n&&n,o=parseFloat(e),[s,a]=jw(o),l=window.jimuUA.browser.name.toLowerCase();return i&&"firefox"!==l&&"safari"!==l?"he"===(null==r?void 0:r.toLowerCase())?`${s}${a}%`:`${s}%${a}`:"tr"===(null==r?void 0:r.toLowerCase().split("-")[0])?`${s}%${a}`:`${s}${a}%`}function _w(e){var t,n;const r=parseFloat(e),i=null!==(n=null===(t=TE().getState().appContext)||void 0===t?void 0:t.isRTL)&&void 0!==n&&n,[o,s]=jw(r);return i?`${o}px${s}`:`${o}${s}px`}const Mw=()=>MI("jimu-theme")?MI("jimu-theme"):(console.error("Please init jimu-theme."),null),Nw=()=>MI("jimu-ui")?MI("jimu-ui"):(console.error("Please init jimu-ui."),null);function kw(e,t,n={}){if("object"!=typeof e||null===e)return;const r=[{value:e,keyPath:[],key:void 0,parent:void 0}],{isAsync:i=!1,skipCircular:o=!0}=n,s=[],a=new WeakSet;for(;r.length>0;){const{value:e,keyPath:n,key:l,parent:u}=r.pop();if(o&&("object"==typeof e&&null!==e)){if(a.has(e))continue;a.add(e)}const c=t(e,n,l,u);if(i&&c instanceof Promise&&s.push(c),"object"==typeof e&&null!==e)if(Array.isArray(e))for(let t=e.length-1;t>=0;t--)r.push({value:e[t],keyPath:n.concat(t),key:t,parent:e});else{const t=Object.keys(e);for(let i=t.length-1;i>=0;i--){const o=t[i];Object.prototype.hasOwnProperty.call(e,o)&&r.push({value:e[o],keyPath:n.concat(o),key:o,parent:e})}}}return i?Promise.all(s).then(()=>e):e}function Uw(e,t){return kw(e,(e,n,r,i)=>{if("string"==typeof e&&t.matcher(e)){const n=t.handler(e);i[r]=n}}),e}const Fw=(e,t)=>{var n,r,i,o;const s=null===(n=(t=null!=t?t:TE().getState()).appRuntimeInfo)||void 0===n?void 0:n.selection;if(!(null===(r=t.appConfig)||void 0===r?void 0:r.layouts)||!s)return!1;const a=t.appConfig.layouts[s.layoutId];return(null===(o=null===(i=null==a?void 0:a.content)||void 0===i?void 0:i[s.layoutItemId])||void 0===o?void 0:o.widgetId)===e},Bw=(e,t)=>{"function"==typeof e?e(t):null!=e&&(e.current=t)};function $w(e,t,n){e&&(t=Array.from(new Set(t)),n=Array.from(new Set(n)));const r={};t.forEach(e=>{r[e]>0?r[e]++:r[e]=1});const i={};n.forEach(e=>{i[e]>0?i[e]++:i[e]=1});const o=Array.from(new Set(t.concat(n))),s=[],a=[],l=[];o.forEach(e=>{const t=r[e]>0?r[e]:0,n=i[e]>0?i[e]:0;if(t<n){const r=n-t;for(let t=0;t<r;t++)s.push(e)}else if(t>n){const r=t-n;for(let t=0;t<r;t++)a.push(e)}const o=Math.min(t,n);if(o>0)for(let t=0;t<o;t++)l.push(e)});return{isEqual:0===s.length&&0===a.length,added:s,deleted:a,saved:l}}function Vw(){try{return window.parent}catch(e){return null}}function Gw(){return window.jimuConfig.isBuilder?window.isExpressBuilder:!!window.jimuConfig.isInBuilder&&window.parent.isExpressBuilder}function Ww(e){if(window.jimuConfig.isInBuilder){MI("jimu-for-builder").getAppConfigAction().setAppConfig(e).exec()}else TE().dispatch(SA(e))}function Hw(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}var zw=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function qw(e){let t=e||"/",n="",r="";const i=t.indexOf("#");-1!==i&&(r=t.substr(i),t=t.substr(0,i));const o=t.indexOf("?");return-1!==o&&(n=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}function Jw(e){return/(^http:)|(^https:)|(^\/\/)|(^mailto:)|(^tel:)|(^data:)|(^sms:)|(^ftp:)/.test(e)}function Kw(e,t=["https","mailto","tel","sms","ftp","data"]){if(!e)return"valid";const n=null==t?void 0:t.find(t=>"sms"===t||"tel"===t||"mailto"===t||"data"===t?new RegExp(`^${t}:`,"i").test(e):new RegExp(`^(${t}:)?//`,"i").test(e));if(!n)return"schemeError";if("sms"===n||"tel"===n){if(!/\d+/.test(e))return"invalidUrlError"}else if("mailto"===n){if(!e.includes("@"))return"invalidUrlError"}else if("data"===n){if(!e.includes(","))return"invalidUrlError"}else if("https"===n){if(!(e.includes(".")||e.toLowerCase().includes("localhost")))return"invalidUrlError"}return"valid"}function Yw(e){if(/\/$/.test(e))return e;if(!([".js",".css",".scss",".html"].filter(t=>new RegExp(`${t}$`).test(e)).length>0))return e;const t=e.split("/");return t.pop(),t.join("/")}function Xw(e,t){let n=t;const r=qw(t);e.hash&&!r.hash&&(n+=e.hash);const i=qw(n);return"/"===i.pathname||""===i.pathname?(i.pathname=e.pathname,i):"/"===i.pathname.charAt(0)?i:"."===i.pathname.charAt(0)?(i.pathname=e.pathname+"/"+i.pathname.substr(2),i):(i.pathname=e.pathname+"/"+i.pathname,i)}function Qw(e){const t=e.pathname,n=e.search,r=e.hash;let i=t||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(i+="#"===r.charAt(0)?r:"#"+r),i}function Zw(e,t,n){if(!n&&""!==n)return e;const r=new URL(e),i=new URLSearchParams(r.search);return i.set(t,n),r.search=i.toString(),r.href}function eI(e){let t;return 0===(e=e.toLowerCase()).indexOf("https://")?t="https:":0===e.indexOf("http://")&&(t="http:"),t}function tI(e,t){return eI(e)?e.replace(/^https?:\/\//,`${t}//`):`${t}//${e}`}function nI(e){return e.replace(/^https?:\/\//,"")}function rI(e){return 0===(e=(e=(e||"").trim()).replace(/^(http(s?):?)\/\//gi,"")).indexOf("//")&&(e=e.slice(2)),e.split("/")[0].toLowerCase()}function iI(e){return(e=(e||"").trim()).split("?")[0]}function oI(e,t,n){const r=(e=(e||"").trim()).indexOf("#");let i="";return r>-1&&(i=e.substring(r),e=e.substring(0,r)),e.includes("?")?e+=`&${t}=${n}${i}`:e+=`?${t}=${n}${i}`,e}function sI(e){return e?new URL(e).href:""}function aI(e,t){const n={},r=e.data_id&&lI(e.data_id,e=>e.split("+"),!1)||[],i=(null==t?void 0:t.data_s)&&function(e){const t=uI(e),n={};return t.forEach(e=>{const{type:t,dsIds:r,value:i}=e;r.forEach(e=>{switch(n[e]||(n[e]={widgetId:"_selectOptionsInUrl"}),t){case hl.Id:n[e].ids=i.split("+");break;case hl.Where:case hl.Geometry:case hl.SpatialRel:let r;try{r=t===hl.Geometry?JSON.parse(i):i}catch(e){console.error("Failed to parse data_s.",e)}r&&(n[e].queryParams||(n[e].queryParams={}),n[e].queryParams[t]=r);break;default:const o=t;console.warn(`Unhandled case: ${o}`)}})}),Object.keys(n).map(e=>({dsId:e,data:n[e]}))}(t.data_s)||[],o=e.data_filter&&lI(e.data_filter,e=>({where:e}),!0)||[],s=e.data_version&&lI(e.data_version,e=>e,!1)||[];return r.concat(i,o,s).forEach(e=>{n[e.dsId]={}}),r.forEach(e=>{n[e.dsId].selection=e.data}),i.forEach(e=>{n[e.dsId].selection=e.data}),o.forEach(e=>{n[e.dsId].filter=e.data}),s.forEach(e=>{n[e.dsId].gdbVersion=e.data}),n}function lI(e,t,n=!1){const r=CS(e,n),i=[],o=r.asMutable({deep:!0});return Object.keys(o).forEach(e=>{const n={dsId:e,data:t(o[e])};i.push(n)}),i}function uI(e){if(!e)return[];const t=[];return e.split(new RegExp(`,(?=${Object.values(hl).join("|")})`)).forEach(e=>{var n;const{type:r,dsIds:i,value:o}=(null===(n=new RegExp(`(?<type>${Object.values(hl).join("|")}):(?<dsIds>[^:]*):(?<value>.*)`).exec(e))||void 0===n?void 0:n.groups)||{};if(!r||!i||!o)return;const s=i.split("~");t.push({type:r,dsIds:s,value:o})}),t}function cI(e,t){if(!e.views)return{};const n=e.views.split(",").map(e=>hI(e,t)),r={};return Object.keys(t.sections||{}).forEach(e=>{var i;const o=null===(i=t.sections[e].views)||void 0===i?void 0:i.find(e=>n.includes(e));o&&(r[e]={currentViewId:o})}),r}function dI(e){var t;e||(e=window.location);const n=null===(t=TE().getState().appRuntimeInfo)||void 0===t?void 0:t.noPermissionPages;if(window.jimuConfig.useStructuralUrl)return pI(e.pathname,TE().getState().appConfig,n);{const t=_t.parse(e.search);return{appId:t.id,pageId:fI(t.page,TE().getState().appConfig,n)}}}function pI(e,t,n){const r=e.substr(window.jimuConfig.rootPath.length),i={pageId:null,appId:null},o=r.split("/").filter(e=>e).map(e=>decodeURIComponent(e));return""===r||(1===o.length?r.includes(".")||"page"===o[0]||(i.appId=o[0]):2===o.length?/^page\/page\//.test(r)?i.pageId="page":/^page/.test(r)?i.pageId=o[1]:i.appId=o[0]:o.length>=3?(i.appId=o[0],i.pageId=o[2]):console.log("URL pattern is not correct.",e),i.pageId&&(i.pageId=fI(i.pageId,t,n))),i}function fI(e,t,n){if(!t||!e)return e;const r={};null==n||n.forEach(e=>{r[e.id]=e});const i=Object.assign(Object.assign({},t.pages),r);if(!i||i[e])return e;{const n=Object.keys(i).find(t=>vI(i[t].label)===e);if(n)return n;{const n=mI(e,"pages",t);return null!=n?n:e}}}function hI(e,t){if(!t||!e)return e;const n=t.views;if(!n||n[e])return e;{const r=Object.keys(n).find(t=>SI(n[t].label)===e);if(r)return r;{const n=mI(e,"views",t);return null!=n?n:e}}}function gI(e,t){if(!t||!e)return e;const n=t.dialogs;if(!n||n[e])return e;{const r=Object.keys(n).find(t=>yI(n[t].label)===e);if(r)return r;{const n=mI(e,"dialogs",t);return null!=n?n:e}}}function mI(e,t,n){if(!n.historyLabels)return null;const r=n.historyLabels[t];return r?Object.keys(r).find(n=>!!r[n].find(n=>"views"===t?SI(n)===e:"dialogs"===t?yI(n)===e:vI(n)===e)):null}function vI(e){return null==e?void 0:e.replace(/\s/g,"-").replace(/\./g,"_")}function yI(e){return null==e?void 0:e.replace(/\s/g,"-")}function SI(e){return null==e?void 0:e.replace(/\s/g,"-").replace(/,/g,"-")}function bI(e){var t,n,r;let i=window.jimuConfig.isInBuilder?e:vI(null!==(r=null===(n=null===(t=TE().getState().appConfig)||void 0===t?void 0:t.pages[e])||void 0===n?void 0:n.label)&&void 0!==r?r:e);if(window.jimuConfig.useStructuralUrl){i=encodeURIComponent(i);const e=pI(window.location.pathname,TE().getState().appConfig);let t;return t=e.appId?`${window.jimuConfig.rootPath}${e.appId}/page/${i}`:`${window.jimuConfig.rootPath}page/${i}`,{path:t,qo:null}}return{path:window.jimuConfig.rootPath,qo:{page:i}}}function wI(e,t,n){var r;const i=TE().getState().appConfig;if((null===(r=i.dialogs[e])||void 0===r?void 0:r.mode)===Kh.Fixed){const n=window.jimuConfig.isInBuilder?e:yI(i.dialogs[e].label);t=t?t.set("dlg",n):{dlg:n}}return Qw(Xw(n,"?"+OS(t)))}function II(e,t,n=window.location,r){e===jd&&(e=TE().getState().appRuntimeInfo.currentPageId);const i=bI(e);let o,s;if(o=t&&i.qo?Object.assign({},t,i.qo):t||i.qo,o&&!wd(o,{})){const e=OS(o);s=`${i.path}?${e}`}else s=i.path;return n&&n.hash&&(s=`${s}${n.hash}`),r&&(s=`${s}#${r}`),s}function EI(){let e;return e=window.jimuConfig.isOutOfExb||window.jimuConfig.rootPath===window.jimuConfig.mountPath?window.jimuConfig.rootPath:window.jimuConfig.rootPath+"../",window.jimuConfig.buildNumber?e+"cdn/"+window.jimuConfig.buildNumber+"/":e}function OI(){return`${window.location.protocol}//${window.location.host}${EI()}`}function CI(e,t,n=window.location,r=!1){var i;if("string"==typeof e)return Jw(e)?e:/^www./.test(e)?`//${e}`:Qw(Xw(n,e));if(!e.linkType)return Qw(e);{const o=e.linkType,s=e;let a,l=t;const u=TE().getState().appConfig;switch(o){case Fa.Page:case Fa.Screen:t=r?t:null==t?void 0:t.without("dlg");const e=o===Fa.Screen&&s.value;return a=o===Fa.Page?s.value:jd,II(a,t,n,e);case Fa.Block:return function(e,t,n){return Qw(Xw(n,"?"+OS(t=t?t.set("block_id",e):{block_id:e})))}(s.value,l,n);case Fa.Dialog:return wI(s.value,l,n);case Fa.View:const c=s.value.split(",")[0],d=s.value.split(",").slice(1).filter(e=>{var t;return null===(t=u.views)||void 0===t?void 0:t[e]});if(null==l?void 0:l.views){let e=l.views.split(",").map(e=>hI(e,u));d.forEach(t=>{e=e.filter(e=>!py(u,t,e)),e.push(t)});const t=window.jimuConfig.isInBuilder?e:e.map(e=>{var t,n;return SI((null===(n=null===(t=u.views)||void 0===t?void 0:t[e])||void 0===n?void 0:n.label)||e)});l=l.set("views",t.sort().join(","))}else{const e=window.jimuConfig.isInBuilder?d:d.map(e=>{var t,n;return SI((null===(n=null===(t=u.views)||void 0===t?void 0:t[e])||void 0===n?void 0:n.label)||e)});e.length>0&&(l=l?l.set("views",e.sort().join(",")):Ye({views:e.sort().join(",")}))}return(null===(i=TE().getState().appConfig.dialogs)||void 0===i?void 0:i[c])?wI(c,l,n):II(c,l);case Fa.WebAddress:const p=s.value;return Jw(p)?p:/^www./.test(p)?`//${p}`:null;case Fa.CookieBanner:return function(e,t,n){var r;const i=TE().getState().appConfig;return(null===(r=null==i?void 0:i.cookieBanner)||void 0===r?void 0:r.enable)&&(t=t?t.set("cookie_banner","true"):{cookie_banner:"true"}),Qw(Xw(n,"?"+OS(t)))}(s.value,l,n);case Fa.None:case Fa.PageTop:return null;case Fa.PrintPreview:return l=l?l.set("print_preview",!0):{print_preview:String(!0)},Qw(Xw(n,"?"+OS(l)));default:console.error("Unknown type:",o)}}}function TI(e){const{id:t,name:n,type:r="app",target:i="relative_path",isDraft:o,isFullUrl:s}=e;if(n){if("template"!==r)return console.error('The name is only valid when the type is "template".'),null;let e;return e=window.jimuConfig.buildNumber?window.jimuConfig.mountPath+"cdn/"+window.jimuConfig.buildNumber+"/":window.jimuConfig.mountPath,`${s?window.location.origin:""}${window.jimuConfig.mountPath}template/?config=${e}templates/app/${n}/config.json`}const a=TE().getState().portalUrl,l=fg(a)?"online":"enterprise",u="template"===r?"template":"experience",c=()=>`${AI()}/${u}/${t}`,d=()=>`${a}/apps/experiencebuilder/${u}?id=${t}`,p=()=>window.jimuConfig.useStructuralUrl?`${window.jimuConfig.mountPath}${u}/${t}`:`${window.jimuConfig.mountPath}${u}?id=${t}`;let f;return f=window.jimuConfig.isDevEdition?"online"===i?c():"current_portal"===i?"online"===l?c():d():s?`${window.location.origin}${p()}`:p():"enterprise"===l?"online"===i?c():s?d():p():s?c():p(),o&&(f=window.jimuConfig.useStructuralUrl?`${f}?draft=true`:`${f}&draft=true`),f}function xI(e,t){var n,r,i;const o=null===(n=TE().getState().appConfig)||void 0===n?void 0:n.pages;if(t===Object.keys(o).find(e=>o[e].isDefault))return e;{let n=vI(null!==(i=null===(r=o[t])||void 0===r?void 0:r.label)&&void 0!==i?i:t);return window.jimuConfig.useStructuralUrl?(n=encodeURIComponent(n),`${e}/page/${n}`):oI(e,"page",n)}}function AI(){let e;const t=TE().getState().portalUrl;return e=(null==t?void 0:t.endsWith("mapsdevext.arcgis.com"))||(null==t?void 0:t.endsWith("mapsdevext.arcgis.com/"))?"https://experiencedev.arcgis.com":(null==t?void 0:t.endsWith("mapsqa.arcgis.com"))||(null==t?void 0:t.endsWith("mapsqa.arcgis.com/"))?"https://experienceqa.arcgis.com":"https://experience.arcgis.com",e}function DI(){let e;const t=TE().getState().portalUrl;return e=(null==t?void 0:t.endsWith("mapsdevext.arcgis.com"))||(null==t?void 0:t.endsWith("mapsdevext.arcgis.com/"))?"https://devext.arcgis.com":(null==t?void 0:t.endsWith("mapsqa.arcgis.com"))||(null==t?void 0:t.endsWith("mapsqa.arcgis.com/"))?"https://qaext.arcgis.com":"https://www.arcgis.com",e}function RI(){let e;const t=TE().getState().portalUrl;return e=(null==t?void 0:t.endsWith("mapsdevext.arcgis.com"))||(null==t?void 0:t.endsWith("mapsdevext.arcgis.com/"))?"VxZfyyZuOsDEPxG8":(null==t?void 0:t.endsWith("mapsqa.arcgis.com"))||(null==t?void 0:t.endsWith("mapsqa.arcgis.com/"))?"iWreOEDHiYP7Bqst":"oC086ufSSQ6Avnw2",e}function PI(){var e,t,n,r,i;const o=null===(e=TE().getState().urlHashObject)||void 0===e?void 0:e.zoom_to_selection,s=null===(i=null===(r=null===(n=null===(t=TE().getState().appConfig)||void 0===t?void 0:t.urlParams)||void 0===n?void 0:n.general)||void 0===r?void 0:r.dataSelection)||void 0===i?void 0:i.zoomToSelection;return"true"===o||s}function jI(e){return zw(this,void 0,void 0,function*(){var t;let n=e;n=Zw("https://arcg.is/prod/shorten","longUrl",n),n=Zw(n,"f","json");const r=yield fetch(n),i=yield r.json();return(null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.url)||""})}function LI(e){window.location.assign(e)}var _I=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function MI(e){const t=window.SystemJS.get(UI(e));return t?t.__useDefault?t.default:t:null}function NI(e,t){return _I(this,void 0,void 0,function*(){return!Jw(e)||/\.(js|css)$/.test(e)||/\/$/.test(e)||(e=`${e}.js`),window.SystemJS.import(e,t).then(e=>e=e.__useDefault?e.default:e).catch(e=>(console.error("Load module error.",e),null))})}function kI(e,t){return _I(this,void 0,void 0,function*(){return yield Promise.all(e.map(e=>_I(this,void 0,void 0,function*(){return yield NI(e,t)})))})}function UI(e){return window.SystemJS.resolve(e)}function FI(e){const t=UI(e);return/^file:/.test(t)?t:t.substring(`${window.location.protocol}//${window.location.host}`.length,t.length)}function BI(){return MI("jimu-for-builder")}function $I(e){window.SystemJS.delete(UI(e))}var VI=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class GI{constructor(){this.extensions={},this.extensionClasses={}}static getInstance(){return GI.instance||(GI.instance=new GI,window._extensionManager=GI.instance),GI.instance}getExtensions(e){return this.extensions[e]||[]}getAllExtensions(){const e=[];return Object.keys(this.extensions).forEach(t=>{this.extensions[t].forEach(t=>{e.push(t)})}),e}registerExtension(e){if(!this.getExtensionById(e.extension.id)){if(this.extensions[e.epName]){if(!Dg.includes(e.epName))return;this.extensions[e.epName].push(e.extension),this.extensions[e.epName]=this.extensions[e.epName].sort((e,t)=>e.index-t.index)}else this.extensions[e.epName]=[e.extension];e.epName===rg.ReduxStore&&TE().dispatch(uD(e.extension.id))}}destroyAllExtensions(){Object.keys(this.extensions).forEach(e=>{this.extensions[e].forEach(e=>{delete this.extensionClasses[e.name],e.destroy&&e.destroy()})}),this.extensions={}}destroyWidgetExtensions(e){Object.keys(this.extensions).forEach(t=>{this.extensions[t].forEach(t=>{t.widgetId===e&&(delete this.extensionClasses[t.name],t.destroy&&t.destroy())}),this.extensions[t]=this.extensions[t].filter(t=>t.widgetId!==e)})}registerWidgetExtensions(e,t){return VI(this,void 0,void 0,function*(){var n;const r=[];e.manifest.extensions&&e.manifest.extensions.forEach(t=>{(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder||!Rg.includes(t.point))&&r.push(this.registerWidgetExtension(e,t))});const i=yield Promise.all(r);if(t&&e.manifest.extensions){const t=TE().getState().widgetsRuntimeInfo;(null===(n=null==t?void 0:t[e.id])||void 0===n?void 0:n.shouldExpandContextTool)||TE().dispatch(AA(e.id,"shouldExpandContextTool",!0))}return i})}registerWidgetExtension(e,t){return VI(this,void 0,void 0,function*(){if(this.extensions[t.point]){if(!Dg.includes(t.point))return Promise.resolve();if(this.extensions[t.point].filter(n=>n.name===`${e.manifest.name}-${t.name}`&&n.widgetId===e.id).length>0)return Promise.resolve()}return window.jimuConfig.isInBuilder&&Rg.includes(t.point)&&(yield window.parent._extensionManager.registerWidgetExtension(e,t)),this.loadWidgetExtensionClass(e,t).then(n=>{const r=new n;r.name=`${e.manifest.name}-${t.name}`,r.widgetId=e.id,r.id=`${r.widgetId}-${t.name}`,r.label=e.manifest.i18nMessages[`_ext_${t.name}_label`]||t.label,this.registerExtension({epName:t.point,extension:r})}).catch(t=>(console.error("Register widget extension error.",e.label),Promise.resolve()))})}loadWidgetExtensionClass(e,t){return VI(this,void 0,void 0,function*(){const n=`${e.manifest.name}-${t.name}`;if(this.extensionClasses[n])return yield this.extensionClasses[n];const r=e.uri+"dist/"+t.uri;return this.extensionClasses[n]=NI(r).then(e=>e.default),this.extensionClasses[n]})}getExtensionById(e){const t=this.getAllExtensions();for(const n of t)if(n.id===e)return n}}function WI(e,t=!0){return"string"==typeof e&&"no-color"!==e&&(!!t||"transparent"!==e)}function HI(e){if(null!=e)return Object.assign(Object.assign(Object.assign({},WI(e.background)&&{bg:e.background}),WI(e.text)&&{color:e.text}),WI(e.link)&&{link:e.link})}const zI=e=>{let t=null;if(!e)return t;const n=e.header,r=e.body,i=e.button,o=e.logo,s=e.fonts,a=HI(n),l=HI(r),u=HI(i);return t={},a&&(t.header=a),l&&(t.body=l),u&&(t.button=u),o&&(t.logo=o),s&&(t.fonts=s),t};function qI(e,t){var n,r,i,o,s,a,l,u,c,d;if(!e)return function(){const e={appConfig:null,portalUrl:null,portalSelf:null,widgetsRuntimeInfo:{},widgetsPreloadProps:{},widgetsClassStatus:{},dataSourcesPreloadData:{},appContext:{},appRuntimeInfo:{},isNetworkOffLine:null,browserSizeMode:null,appPath:window.location.pathname,appId:null,appInfo:{},appI18nMessages:{},queryObject:{},urlHashObject:{},dataSourcesInfo:{},jimuMapViewsInfo:{},mapWidgetsInfo:{},widgetsState:{},widgetsMutableStateVersion:{},user:null,overlays:[],systemError:null,portalsNeedToRegisterClientId:[],noPermissionResourceChangedFlag:"",resourceSessions:{},guideId:null,shouldCheckGuideDisplay:!1,dynamicStyleState:{}};return Ye(e)}();if(t.type.includes("@@"))return e;switch(t.type){case vA.InitStoreExtensionState:return function(e,t){const n=GI.getInstance().getExtensionById(t.extensionId),r=n.getStoreKey().split(".");if(e.getIn(r))return e;return e=e.setIn(r,n.getInitLocalState()),e}(e,t);case vA.AppConfigLoaded:return function(e,t){var n,r,i,o,s,a,l;const u=null===(r=null===(n=e.portalSelf)||void 0===n?void 0:n.portalProperties)||void 0===r?void 0:r.sharedTheme,c=JI(Ye(t.appConfig),u,e.portalUrl),d=c||t.appConfig;let p=e.set("appConfig",d);if(!p.appRuntimeInfo.currentPageId){const e=Object.keys(d.pages).find(e=>d.pages[e].isDefault);p=p.setIn(["appRuntimeInfo","currentPageId"],e)}if(!p.appRuntimeInfo.currentDialogId&&p.queryObject.dlg){const e=gI(p.queryObject.dlg,d);p=p.setIn(["appRuntimeInfo","currentDialogId"],e),p=YI(p,e)}(null===(o=null===(i=p.appConfig)||void 0===i?void 0:i.cookieBanner)||void 0===o?void 0:o.enable)&&p.queryObject.cookie_banner&&(p=p.setIn(["appRuntimeInfo","cookieBanner","isCookieBannerOpenByUrl"],!0));p.appConfig.dataSources&&Object.keys(p.appConfig.dataSources).forEach(e=>{p=p.setIn(["dataSourcesInfo",e,"instanceStatus"],Ya.NotCreated)});(null===(s=p.systemError)||void 0===s?void 0:s.code)!==cl.AppNotPublished&&(null===(a=p.systemError)||void 0===a?void 0:a.code)!==cl.AppNotExisted||(p=p.set("systemError",null));p=gy(p),(null===(l=window.jimuConfig)||void 0===l?void 0:l.isInBuilder)&&Hv.getInstance().initIdCounter(p.appConfig);return p}(e,t);case vA.SetPortalInfo:return t.portalInfo.portalUrl&&(e=e.set("portalUrl",t.portalInfo.portalUrl)),t.portalInfo.clientId&&(e=e.set("clientId",t.portalInfo.clientId)),void 0!==t.portalInfo.isWebTier&&(e=e.set("isWebTier",t.portalInfo.isWebTier)),e;case vA.SetPortalSelf:return function(e,t){var n;const r=null===(n=null==t?void 0:t.portalProperties)||void 0===n?void 0:n.sharedTheme,i=JI(e.appConfig,r,e.portalUrl);let o=e.set("portalSelf",t);i&&(o=o.set("appConfig",i));return o}(e,t.portalSelf);case vA.AppConfigChanged:return function(e,t){return e=hy(e,t.appConfig),e=gy(e),e}(e,t);case vA.AppPathChanged:return function(e,t){var n;e=e.set("appPath",t.path);let r=pI(t.path,e.appConfig).pageId;!r&&(null===(n=null==e?void 0:e.appConfig)||void 0===n?void 0:n.pages)&&(r=e.appConfig&&Object.keys(e.appConfig.pages).find(t=>e.appConfig.pages[t].isDefault));if(r){if(e.appRuntimeInfo.currentPageId===r)return e;e=KI(e=e.setIn(["appRuntimeInfo","currentPageId"],r),r)}return e}(e,t);case vA.AppInfoChanged:return e.set("appInfo",t.appInfo);case vA.AppContextInit:return e.set("appContext",t.appContext);case vA.AppIdChanged:return e.set("appId",t.appId);case vA.I18nMessagesLoaded:return function(e,t){return e.set("appI18nMessages",e.appI18nMessages.merge(t.messages))}(e,t);case vA.QueryObjectChanged:return function(e,t){var n,r,i,o,s,a;e=e.set("queryObject",Ye(t.query));const l=function(e){var t,n,r,i,o,s,a;return(null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.currentDialogId)&&((null===(r=null===(n=e.appConfig.dialogs)||void 0===n?void 0:n[e.appRuntimeInfo.currentDialogId])||void 0===r?void 0:r.isSplash)||(null===(o=null===(i=e.appConfig.dialogs)||void 0===i?void 0:i[e.appRuntimeInfo.currentDialogId])||void 0===o?void 0:o.mode)===Kh.Anchored||(null===(a=null===(s=e.appConfig.pages)||void 0===s?void 0:s[e.appRuntimeInfo.currentPageId])||void 0===a?void 0:a.autoOpenDialogId)===e.appRuntimeInfo.currentDialogId)}(e);if(t.query.dlg){const a=gI(t.query.dlg,e.appConfig);if(!l&&a!==(null===(n=e.appRuntimeInfo)||void 0===n?void 0:n.currentDialogId)&&(e=e.setIn(["appRuntimeInfo","currentDialogId"],a)).appConfig){(null===(r=e.appConfig.dialogs)||void 0===r?void 0:r[a])&&!function(e,t){var n,r;return(null===(r=null===(n=e.appConfig.dialogs)||void 0===n?void 0:n[t])||void 0===r?void 0:r.isSplash)||e.appConfig.pages&&Object.keys(e.appConfig.pages).find(n=>e.appConfig.pages[n].autoOpenDialogId===t)}(e,a)&&(e=YI(e,a));const t=null===(i=e.appConfig.dialogs)||void 0===i?void 0:i[a];let n=(e.appRuntimeInfo.dialogInfos||Ye({})).setIn([a,"canClose"],!(null==t?void 0:t.interactionType)||!(null==t?void 0:t.confirmBeforeClose)).setIn([a,"checked"],!1).setIn([a,"isClosed"],!1);if(window.jimuConfig.isInBuilder&&(null===(s=null===(o=e.appConfig.pages)||void 0===o?void 0:o[e.appRuntimeInfo.currentPageId])||void 0===s?void 0:s.autoOpenDialogId)===a){const r=e.appRuntimeInfo.currentPageId+"-"+a;n=n.setIn([r,"canClose"],!(null==t?void 0:t.interactionType)||!(null==t?void 0:t.confirmBeforeClose)).setIn([r,"checked"],!1).setIn([r,"isClosed"],!1)}e=e.setIn(["appRuntimeInfo","dialogInfos"],n)}}else l||(e=e.setIn(["appRuntimeInfo","currentDialogId"],null));if(t.query.views&&e.appConfig){const n=cI(t.query,e.appConfig);Object.keys(n).forEach(t=>{var r,i,o;if((null===(o=null===(i=null===(r=e.appRuntimeInfo)||void 0===r?void 0:r.sectionNavInfos)||void 0===i?void 0:i[t])||void 0===o?void 0:o.currentViewId)!==n[t].currentViewId){const r=tE(e,t,n[t]);e=e.setIn(["appRuntimeInfo","sectionNavInfos",t],r)}})}if(!window.jimuConfig.useStructuralUrl){let n=fI(t.query.page,e.appConfig);!n&&(null===(a=null==e?void 0:e.appConfig)||void 0===a?void 0:a.pages)&&(n=e.appConfig&&Object.keys(e.appConfig.pages).find(t=>e.appConfig.pages[t].isDefault)),n&&n!==e.appRuntimeInfo.currentPageId&&(e=KI(e=e.setIn(["appRuntimeInfo","currentPageId"],n),n))}return e}(e,t);case vA.UrlHashObjectChanged:return function(e,t){return e=e.set("urlHashObject",Ye(t.hash)),e}(e,t);case vA.SetAppInBuilder:return e.set("appContext",e.appContext.merge({isInBuilder:!0}));case vA.WidgetClassLoaded:return function(e,t){const n=e.appConfig.widgets||{},r=Object.keys(n).filter(e=>n[e].uri===t);e=e.setIn(["widgetsClassStatus",t],!0);const i={};return r.forEach(e=>{i[e]={isClassLoaded:!0}}),e=e.set("widgetsRuntimeInfo",e.widgetsRuntimeInfo.merge(i,{deep:!0})),e}(e,t.widgetUri);case vA.WidgetConfigLoaded:return e.setIn(["appConfig","widgets",t.widgetId,"config"],t.config);case vA.WidgetsUpgraded:return function(e,t,n){const r=Object.keys(e.appConfig.widgets).filter(n=>e.appConfig.widgets[n].uri===t);if(0===r.length)return e;const i=e.appConfig.widgets[r[0]].manifest.version;if(!n){const t={};return r.forEach(e=>{t[e]={version:i}}),e=e.setIn(["appConfig","widgets"],e.appConfig.widgets.merge(t,{deep:!0}))}const o={},s={},a={};return r.forEach(e=>{const t=n.find(t=>t.widgetJson.id===e);o[e]={version:i},t&&(s[e]=t.widgetJson,t.outputDataSourceJsons&&(Object.keys(t.outputDataSourceJsons).forEach(e=>{const n=t.outputDataSourceJsons[e];a[e]=n}),o[e].outputDataSources=Object.keys(t.outputDataSourceJsons)))}),e=e.setIn(["appConfig","widgets"],e.appConfig.widgets.merge(s,{deep:!0}).merge(o,{deep:!0})),e=e.setIn(["appConfig","dataSources"],(e.appConfig.dataSources||Ye({})).merge(a,{deep:!0})),e}(e,t.widgetUri,t.upgradeInfos);case vA.WidgetUpgraded:return function(e,t,n){const r=e.appConfig.widgets[t];if(!r)return e;if(!n)return e.setIn(["appConfig","widgets",t,"version"],r.manifest.version);const i=n.widgetJson.set("version",n.widgetJson.manifest.version);if(e=e.setIn(["appConfig","widgets",t],i),!n.outputDataSourceJsons)return e;return Object.keys(n.outputDataSourceJsons).forEach(t=>{const r=n.outputDataSourceJsons[t];e=e.setIn(["appConfig","dataSources",t],r)}),e=e.setIn(["appConfig","widgets",t,"outputDataSources"],Object.keys(n.outputDataSourceJsons)),e}(e,t.widgetId,t.upgradeInfo);case vA.WidgetToolbarStateChange:return function(e,t,n){return n.forEach(n=>{var r,i,o,s;let a=null===(s=null===(o=null===(i=null===(r=e.widgetsRuntimeInfo)||void 0===r?void 0:r[t])||void 0===i?void 0:i.layoutItemTools)||void 0===o?void 0:o[n])||void 0===s?void 0:s.version;a>0?a+=1:a=1,e=e.setIn(["widgetsRuntimeInfo",t,"layoutItemTools",n,"version"],a)}),e}(e,t.widgetId,t.toolNames);case vA.WidgetRuntimeInfoChange:return e.setIn(["widgetsRuntimeInfo",t.widgetId,t.prop],t.value);case vA.OpenWidget:return QI(e,t.widgetId);case vA.OpenWidgets:return function(e,t){return t.forEach(t=>{e=QI(e,t)}),e}(e,t.widgetIds);case vA.CloseWidget:return ZI(e,t.widgetId);case vA.CloseWidgets:return function(e,t){return t.forEach(t=>{e=ZI(e,t)}),e}(e,t.widgetIds);case vA.ResetWidgetsState:return function(e,t){return t.forEach(t=>{e=function(e,t){var n;let r=null===(n=e.widgetsRuntimeInfo)||void 0===n?void 0:n[t];return r?(r=r.without("state"),e.setIn(["widgetsRuntimeInfo",t],r)):e}(e,t)}),e}(e,t.widgetIds);case vA.ActivateWidget:return function(e,t){var n,r;const i=Object.keys(e.widgetsRuntimeInfo).filter(t=>e.widgetsRuntimeInfo[t].state===Ua.Active);e.appConfig.widgets[t].manifest.properties.deactivateOtherWidgets&&i.forEach(t=>{e=e.setIn(["widgetsRuntimeInfo",t,"state"],Ua.Opened)});(null===(r=null===(n=e.appConfig.widgets[t])||void 0===n?void 0:n.manifest)||void 0===r?void 0:r.properties.needActiveState)&&(e=e.setIn(["widgetsRuntimeInfo",t,"state"],Ua.Active));return e}(e,t.widgetId);case vA.SetWidgetIsInlineEditingState:return t.isInlineEditing?(Object.keys(e.widgetsRuntimeInfo).forEach(t=>{e.widgetsRuntimeInfo[t].isInlineEditing&&(e=e.setIn(["widgetsRuntimeInfo",t,"isInlineEditing"],!1))}),e.setIn(["widgetsRuntimeInfo",t.widgetId,"isInlineEditing"],!0)):e.setIn(["widgetsRuntimeInfo",t.widgetId,"isInlineEditing"],!1);case vA.SetWidgetPreloadProps:return e.setIn(["widgetsPreloadProps",t.widgetId],t.props);case vA.SetDataSourcePreloadData:return e.setIn(["dataSourcesPreloadData",t.dataSourceId],t.data);case vA.LayoutClassLoaded:return e.setIn(["isLayoutClassLoaded",t.layoutName],!0);case vA.DataSourceInstanceStatusChanged:return e.setIn(["dataSourcesInfo",t.dataSourceId,"instanceStatus"],t.status);case vA.DataSourceStatusChanged:return XI(e,t.dataSourceId,"status",t.status);case vA.DataSourceCountStatusChanged:return XI(e,t.dataSourceId,"countStatus",t.countStatus);case vA.DataSourceSaveStatusChanged:return e.setIn(["dataSourcesInfo",t.dataSourceId,"saveStatus"],t.saveStatus);case vA.DataSourceVersionAdded:const p=e.dataSourcesInfo[t.dataSourceId]&&e.dataSourcesInfo[t.dataSourceId].version?e.dataSourcesInfo[t.dataSourceId].version:0;return e.setIn(["dataSourcesInfo",t.dataSourceId,"version"],p+1);case vA.DataSourceSourceVersionAdded:const f=null!==(i=null===(r=null===(n=e.dataSourcesInfo)||void 0===n?void 0:n[t.dataSourceId])||void 0===r?void 0:r.sourceVersion)&&void 0!==i?i:0;return e.setIn(["dataSourcesInfo",t.dataSourceId,"sourceVersion"],f+1);case vA.ChangeDataSourceGDBVersion:return e.setIn(["dataSourcesInfo",t.dataSourceId,"gdbVersion"],t.gdbVersion);case vA.ClearDataSourceInfo:return e.setIn(["dataSourcesInfo"],e.dataSourcesInfo.without(t.dataSourceId));case vA.UpdateDataSourceInfo:return e.setIn(["dataSourcesInfo"],e.dataSourcesInfo.set(t.dataSourceId,t.dataSourceInfo));case vA.BatchUpdateDataSourceInfo:return e.setIn(["dataSourcesInfo"],e.dataSourcesInfo.merge(t.dataSourcesInfo));case vA.JimuMapViewAdded:case vA.JimuMapViewUpdated:return e.setIn(["jimuMapViewsInfo",t.jimuMapViewId],t.jimuMapViewInfo);case vA.JimuMapViewRemoved:let h=null;return h=e.jimuMapViewsInfo.without(t.jimuMapViewId),e.setIn(["jimuMapViewsInfo"],h);case vA.RequestAutoControlMapWidget:return e.setIn(["mapWidgetsInfo",t.mapWidgetId,"autoControlWidgetId"],t.autoControlWidgetId);case vA.ReleaseAutoControlMapWidget:return e.setIn(["mapWidgetsInfo",t.mapWidgetId,"autoControlWidgetId"],null);case vA.MapWidgetInfoAdded:case vA.MapWidgetInfoUpdated:return e.setIn(["mapWidgetsInfo",t.mapWidgetId],t.mapWidgetInfo);case vA.MapWidgetInfoRemoved:let g=null;return g=e.mapWidgetsInfo.without(t.mapWidgetId),e.setIn(["mapWidgetsInfo"],g);case vA.DataSourceSelectedIndexesChanged:return e.setIn(["dataSourcesInfo",t.dataSourceId,"selectedIndexes"],t.selectedIndexes).setIn(["dataSourcesInfo",t.dataSourceId,"selectedIds"],null).setIn(["dataSourcesInfo",t.dataSourceId,"selectOptions"],null);case vA.DataSourceSelectionChanged:const m=null===(o=t.selectOptions)||void 0===o?void 0:o.records;return t.selectOptions=t.selectOptions?Object.assign({},t.selectOptions):t.selectOptions,null===(s=t.selectOptions)||void 0===s||delete s.records,e.setIn(["dataSourcesInfo",t.dataSourceId,"selectedIds"],(null==m?void 0:m.map(e=>e.getId()))||(null===(a=t.selectOptions)||void 0===a?void 0:a.ids)).setIn(["dataSourcesInfo",t.dataSourceId,"selectedIndexes"],null).setIn(["dataSourcesInfo",t.dataSourceId,"selectOptions"],(null===(l=t.selectOptions)||void 0===l?void 0:l.widgetId)?t.selectOptions:null);case vA.SetDataNeedRefresh:return e.setIn(["dataSourcesInfo",t.dataSourceId,"needRefresh"],t.refresh);case vA.SetDataLastRefreshTime:return e.setIn(["dataSourcesInfo",t.dataSourceId,"lastAutoRefreshCheckTime"],t.lastAutoRefreshCheckTime);case vA.UpdateWidgetQuery:return e.setIn(["dataSourcesInfo",t.dataSourceId,"widgetQueries",t.widgetId],t.query);case vA.WidgetStatePropChange:return function(e,t){const n=t.propKey.split(".");return e.setIn(["widgetsState",t.widgetId].concat(n),t.value)}(e,t);case vA.WidgetMutableStatePropChange:return function(e,t){var n,r;let i=null!==(r=null===(n=e.widgetsMutableStateVersion[t.widgetId])||void 0===n?void 0:n[t.propKey])&&void 0!==r?r:0;return e.setIn(["widgetsMutableStateVersion",t.widgetId,t.propKey],++i)}(e,t);case vA.UserSignIn:return e.set("user",Ye(t.user));case vA.UserSignOut:return e.merge({user:null});case vA.BrowserSizeModeChanged:return e=e.set("browserSizeMode",t.browserSizeMode),e=gy(e);case vA.NetworkStatusChanged:return e.set("isNetworkOffLine",t.isOffLine);case vA.CurrentPageChanged:return e.appRuntimeInfo.currentPageId===t.pageId?e:KI(e=e.setIn(["appRuntimeInfo","currentPageId"],t.pageId),t.pageId);case vA.CurrentDialogChanged:return e.appRuntimeInfo.currentDialogId===t.dialogId?e:(t.dialogId&&(null===(u=e.appConfig.dialogs[t.dialogId])||void 0===u?void 0:u.mode)===Kh.Anchored&&(e=YI(e,t.dialogId)),e.setIn(["appRuntimeInfo","currentDialogId"],t.dialogId));case vA.SelectionChanged:return function(e,t){var n,r,i;Object.keys(e.widgetsRuntimeInfo).forEach(t=>{e.widgetsRuntimeInfo[t].isInlineEditing&&(e=e.setIn(["widgetsRuntimeInfo",t,"isInlineEditing"],!1))}),(null===(n=e.appRuntimeInfo)||void 0===n?void 0:n.animationPreview)&&(e=e.set("appRuntimeInfo",e.appRuntimeInfo.without("animationPreview")));if(t){const{layoutId:n,layoutItemId:o}=t;if(!(null===(i=null===(r=e.appConfig.layouts[n])||void 0===r?void 0:r.content)||void 0===i?void 0:i[o]))return e=e.setIn(["appRuntimeInfo","selection"],null)}return e=e.setIn(["appRuntimeInfo","selection"],t),e}(e,t.selection);case vA.AppModeChanged:return e.setIn(["appRuntimeInfo","appMode"],t.mode).setIn(["appRuntimeInfo","animationPreview"],null).setIn(["appRuntimeInfo","hoverPreview"],null).setIn(["appRuntimeInfo","openedControllerInfo"],null);case vA.AppRuntimeInfoInit:return e.set("appRuntimeInfo",t.info);case vA.UpdateStoreState:return t.state;case vA.ThemeVariablesChanged:return e.set("theme",Ye(t.theme));case vA.ActivePagePartChanged:return e.setIn(["appRuntimeInfo","activePagePart"],t.part);case vA.ChangeThemeMode:if(e.appRuntimeInfo.themeMode===t.value)return e;if(t.value){if("light"!==t.value&&"dark"!==t.value)return e;e=e.setIn(["appRuntimeInfo","themeMode"],t.value)}else e=e.set("appRuntimeInfo",e.appRuntimeInfo.without("themeMode"));return e;case vA.OpenOverlay:return function(e,t,n){if(!eE(t))return e;if(n&&!eE(n))return e;if(e.overlays.includes(t))return e;const r=function(e,t,n){if(t.startsWith("modal_"))return e.push(t),e;let r=n?e.indexOf(n):0;const i=n?r+1:0;if(i===e.length)r=e.length+1;else for(let t=i;t<e.length;t++){if(!e[t].startsWith("popper_")){r=t;break}r=t+1}return e.splice(r,0,t),e}(e.overlays.asMutable(),t,n);return e.set("overlays",r)}(e,t.id,t.modalId);case vA.CloseOverlay:return(null==e?void 0:e.overlays.includes(t.id))?e.set("overlays",e.overlays.filter(e=>e!==t.id)):e;case vA.ActiveOverlay:let v=null==e?void 0:e.overlays;if(!(null==v?void 0:v.includes(t.id)))return e;return(null==v?void 0:v.indexOf(t.id))===(null==v?void 0:v.length)-1?e:(v=v.filter(e=>e!==t.id),v=v.concat([t.id]),e.set("overlays",v));case vA.SetIsBusy:return e.setIn(["appRuntimeInfo","isBusy"],t.isBusy).setIn(["appRuntimeInfo","loadingType"],t.loadingType).setIn(["appRuntimeInfo","loadingText"],t.loadingText);case vA.ZoomScaleChanged:return e.setIn(["appRuntimeInfo","zoomScale"],t.zoomScale);case vA.ClipboardChanged:return e.setIn(["appRuntimeInfo","clipboard"],t.item);case vA.SectionNavInfoChanged:{const n=tE(e,t.sectionId,t.navInfo);return e.setIn(["appRuntimeInfo","sectionNavInfos",t.sectionId],n)}case vA.ScreenGroupNavInfoChanged:return e.setIn(["appRuntimeInfo","screenGroupNavInfos",t.screenGroupId],{activeIndex:t.activeIndex,scrollIntoView:t.scrollIntoView});case vA.DialogInfosChanged:return e.setIn(["appRuntimeInfo","dialogInfos"],t.dialogInfos);case vA.SetupAnimationPreview:return e.set("appRuntimeInfo",e.appRuntimeInfo.without("hoverPreview")).setIn(["appRuntimeInfo","animationPreview"],t.data);case vA.ClearAnimationPreview:return e.set("appRuntimeInfo",e.appRuntimeInfo.without("animationPreview"));case vA.SetupHoverPreview:return e.set("appRuntimeInfo",e.appRuntimeInfo.without("animationPreview")).setIn(["appRuntimeInfo","hoverPreview"],t.data);case vA.UserLocaleChanged:return e.setIn(["appContext","locale"],t.locale).setIn(["appContext","translatedLocale"],t.translatedLocale).setIn(["appContext","isRTL"],t.isRTL);case vA.SetSystemError:return e.set("systemError",t.systemError);case vA.ClearSystemError:return(null===(c=e.systemError)||void 0===c?void 0:c.type)===t.systemErrorType?e.set("systemError",null):e;case vA.AddToRegisterClientIdList:{let n=null==e?void 0:e.portalsNeedToRegisterClientId;return(null==n?void 0:n.find(e=>e.portalUrl===t.portalUrl))?e:(n=n.concat([{portalUrl:t.portalUrl,needToSignIn:t.needToSignIn,forceLogin:t.forceLogin,serviceUrl:t.serviceUrl}]),e.set("portalsNeedToRegisterClientId",n))}case vA.RemoveFromRegisterClientIdList:{let n=null==e?void 0:e.portalsNeedToRegisterClientId;return(null==n?void 0:n.find(e=>e.portalUrl===t.portalUrl))?(n=n.filter(e=>e.portalUrl!==t.portalUrl),e.set("portalsNeedToRegisterClientId",n)):e}case vA.UpdateNoPermissionResourceChangedFlag:return e.set("noPermissionResourceChangedFlag",at());case vA.UpdateResourceSessions:{const n=Object.assign({},e.resourceSessions);return Object.entries(window._cachedRequests||{}).filter(e=>{const n=e[0],r=e[1];return n.includes(t.resourceRootUrl)&&"pending"!==(null==r?void 0:r.status)}).map(e=>e[0]).forEach(e=>delete window._cachedRequests[e]),n[t.resourceRootUrl]=t.userName,e.set("resourceSessions",n)}case vA.ScreenPanelVisibleChange:return e.setIn(["appRuntimeInfo","screenPanelStates",t.screenId],t.visible);case vA.ActivePrintPreview:return e.setIn(["appRuntimeInfo","isPrintPreview"],!0);case vA.QuitPrintPreview:return e.setIn(["appRuntimeInfo","isPrintPreview"],!1);case vA.UtilityStateChange:{const n={success:t.success};return t.success||(n.isSignInError=null!==(d=t.isSignInError)&&void 0!==d&&d),e.setIn(["appRuntimeInfo","utilityStates",t.id],n)}case vA.SaveThumbnailUrl:return e.setIn(["appRuntimeInfo","saveThumbnailUrl"],t.saveThumbnailUrl);case vA.OpenCookieBannerSetting:return e.setIn(["appRuntimeInfo","cookieBanner","isCookieBannerSettingOpen"],t.isSettingOpen);case vA.OpenCookieSettingsWindow:return e.setIn(["appRuntimeInfo","cookieBanner","isCookieSettingsWindowOpen"],t.isCookieSettingsWindowOpen);case vA.OpenCookieBannerByPrivacyPanel:return e.setIn(["appRuntimeInfo","cookieBanner","isCookieBannerOpenByPrivacyPanel"],t.isCookieBannerOpenByPrivacyPanel);case vA.OpenCookieBannerByUrl:return e.setIn(["appRuntimeInfo","cookieBanner","isCookieBannerOpenByUrl"],t.isCookieBannerOpenByUrl);case vA.CurrentGuideChange:return e.set("guideId",t.guideId).set("shouldCheckGuideDisplay",t.shouldCheckGuideDisplay);case vA.ChangeDynamicStylePreviewConditionInfo:return function(e,t){return e.setIn(["dynamicStyleState","previewConditionInfo",t.widgetId],t.value)}(e,t);case vA.ChangeDynamicStylePreviewRepeatedRecordInfo:return function(e,t){return e.setIn(["dynamicStyleState","previewRepeatedRecordInfo",t.widgetId],t.value)}(e,t);case vA.SetNoPermissionPages:return e.setIn(["appRuntimeInfo","noPermissionPages"],Ye(t.pages));default:return function(e,t){const n=GI.getInstance().getExtensions(rg.ReduxStore);for(let r=0;r<n.length;r++){const i=n[r];if(i.getActions().includes(t.type)){const n=i.getStoreKey().split("."),r=e.getIn(n);return e.setIn(n,i.getReducer()(r,t,e))}}return e}(e,t)}}function JI(e,t,n){var r,i,o;if(!(e&&(null===(r=e.attributes)||void 0===r?void 0:r.portalUrl)&&t&&n))return;if(e.attributes.portalUrl!==n)return;const s=zI(t);return wd(s,null===(o=null===(i=e.sharedThemeVariables)||void 0===i?void 0:i.asMutable)||void 0===o?void 0:o.call(i,{deep:!0}))?void 0:e=e.set("sharedThemeVariables",s)}function KI(e,t){var n;let r;return r=e.appConfig&&e.appConfig.pages?e.appConfig.pages[t]:{},e.setIn(["appRuntimeInfo","activeLayout"],null!==(n=null==r?void 0:r.layout)&&void 0!==n?n:null).setIn(["appRuntimeInfo","selection"],null)}function YI(e,t){const n=e.appRuntimeInfo.openedDialogIds||[];return e.setIn(["appRuntimeInfo","openedDialogIds"],n.includes(t)?n:[...n,t])}function XI(e,t,n,r){var i;let o=e.setIn(["dataSourcesInfo",t,n],r);const s=mA.getInstance(),a=null==s?void 0:s.getDataSource(t);return(null===(i=null==a?void 0:a.getDataSourceJson())||void 0===i?void 0:i.isOutputFromWidget)&&(r!==Ya.Unloaded&&r!==Ya.NotReady||a.getAllDerivedDataSources().forEach(e=>{o=o.setIn(["dataSourcesInfo",e.id,n],r)})),o}function QI(e,t){return e.setIn(["widgetsRuntimeInfo",t,"state"],Ua.Opened)}function ZI(e,t){return e.setIn(["widgetsRuntimeInfo",t,"state"],Ua.Closed)}function eE(e){return e.startsWith("popper_")||e.startsWith("modal_")}function tE(e,t,n){var r,i,o,s,a,l;let u,c;if("asMutable"in n&&(n=n.asMutable({deep:!0})),(null===(r=n.visibleViews)||void 0===r?void 0:r.length)>0?(c=n.visibleViews,u=n.visibleViews.length):(c=null!==(o=null===(i=e.appConfig.sections[t])||void 0===i?void 0:i.views)&&void 0!==o?o:[],u=null!==(s=null==c?void 0:c.length)&&void 0!==s?s:0),n.useProgress&&(!n.currentViewId||!n.previousViewId)){const{currentIndex:e,previousIndex:t}=function(e,t){let n,r;const i=nE(e,0,1),o=i*(t-1),s=Math.floor(o);r=s,r=function(e){return Math.abs(e-Math.round(e))<1e-7}(o)?Math.round(o)-1:s;return n=r+1,n=nE(n,0,t-1),r=nE(r,0,t-1),{previousIndex:r,progress:o,currentIndex:n}}(n.progress,u);n.currentViewId=c[e],n.previousViewId=c[t]}if(null==n.progress){const e=c.indexOf(n.currentViewId);n.progress=c.length>1?e/(c.length-1):1}if(null==n.previousViewId){const r=null===(l=null===(a=e.appRuntimeInfo)||void 0===a?void 0:a.sectionNavInfos)||void 0===l?void 0:l[t];if(null==r?void 0:r.currentViewId)n.previousViewId=r.currentViewId;else{const e=c.indexOf(n.currentViewId);n.previousViewId=e>0?c[e-1]:c[u-1]}}return n}function nE(e,t,n){return Math.max(t,Math.min(e,n))}function rE(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var iE=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),oE=()=>Math.random().toString(36).substring(7).split("").join("."),sE={INIT:`@@redux/INIT${oE()}`,REPLACE:`@@redux/REPLACE${oE()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${oE()}`};function aE(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function lE(e,t,n){if("function"!=typeof e)throw new Error(rE(2));if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(rE(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(rE(1));return n(lE)(e,t)}let r=e,i=t,o=new Map,s=o,a=0,l=!1;function u(){s===o&&(s=new Map,o.forEach((e,t)=>{s.set(t,e)}))}function c(){if(l)throw new Error(rE(3));return i}function d(e){if("function"!=typeof e)throw new Error(rE(4));if(l)throw new Error(rE(5));let t=!0;u();const n=a++;return s.set(n,e),function(){if(t){if(l)throw new Error(rE(6));t=!1,u(),s.delete(n),o=null}}}function p(e){if(!aE(e))throw new Error(rE(7));if(void 0===e.type)throw new Error(rE(8));if("string"!=typeof e.type)throw new Error(rE(17));if(l)throw new Error(rE(9));try{l=!0,i=r(i,e)}finally{l=!1}return(o=s).forEach(e=>{e()}),e}p({type:sE.INIT});return{dispatch:p,subscribe:d,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error(rE(10));r=e,p({type:sE.REPLACE})},[iE]:function(){const e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(rE(11));function n(){const e=t;e.next&&e.next(c())}n();return{unsubscribe:e(n)}},[iE](){return this}}}}}function uE(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++){const i=t[r];0,"function"==typeof e[i]&&(n[i]=e[i])}const r=Object.keys(n);let i;try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if(void 0===n(void 0,{type:sE.INIT}))throw new Error(rE(12));if(void 0===n(void 0,{type:sE.PROBE_UNKNOWN_ACTION()}))throw new Error(rE(13))})}(n)}catch(e){i=e}return function(e={},t){if(i)throw i;let o=!1;const s={};for(let i=0;i<r.length;i++){const a=r[i],l=n[a],u=e[a],c=l(u,t);if(void 0===c){t&&t.type;throw new Error(rE(14))}s[a]=c,o=o||c!==u}return o=o||r.length!==Object.keys(e).length,o?s:e}}function cE(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce((e,t)=>(...n)=>e(t(...n)))}function dE(e){return({dispatch:t,getState:n})=>r=>i=>"function"==typeof i?i(t,n,e):r(i)}var pE=dE(),fE=dE,hE="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?cE:cE.apply(null,arguments)};"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var gE=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};var mE=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=e??{};let o=new gE;return t&&("boolean"==typeof t?o.push(pE):o.push(fE(t.extraArgument))),o},vE="RTK_autoBatch",yE=e=>t=>{setTimeout(t,e)},SE=e=>function(t){const{autoBatch:n=!0}=t??{};let r=new gE(e);return n&&r.push(((e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let i=!0,o=!1,s=!1;const a=new Set,l="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:yE(10):"callback"===e.type?e.queueNotification:yE(e.timeout),u=()=>{s=!1,o&&(o=!1,a.forEach(e=>e()))};return Object.assign({},r,{subscribe(e){const t=r.subscribe(()=>i&&e());return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){try{return i=!e?.meta?.[vE],o=!i,o&&(s||(s=!0,l(u))),r.dispatch(e)}finally{i=!0}}})})("object"==typeof n?n:void 0)),r};function bE(e){const t=mE(),{reducer:n,middleware:r,devTools:i=!0,duplicateMiddlewareCheck:o=!0,preloadedState:s,enhancers:a}=e||{};let l,u;if("function"==typeof n)l=n;else{if(!aE(n))throw new Error(IE(1));l=uE(n)}u="function"==typeof r?r(t):t();let c=cE;i&&(c=hE({trace:!1,..."object"==typeof i&&i}));const d=function(...e){return t=>(n,r)=>{const i=t(n,r);let o=()=>{throw new Error(rE(15))};const s={getState:i.getState,dispatch:(e,...t)=>o(e,...t)},a=e.map(e=>e(s));return o=cE(...a)(i.dispatch),{...i,dispatch:o}}}(...u),p=SE(d);return lE(l,s,c(..."function"==typeof a?a(p):p()))}var{assign:wE}=Object;Symbol.for("rtk-state-proxy-original");function IE(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}let EE;const OE=e=>e=>t=>{const n=GI.getInstance().getExtensions(rg.ReduxActionInterceptor);if(0===n.length)return e(t);n.sort((e,t)=>e.index-t.index);for(let e=0;e<n.length;e++){if(!(t=n[e].intercept(t)))return}return e(t)};function CE(e){return EE||(EE=bE({reducer:qI,preloadedState:e,middleware:e=>e().concat(OE),devTools:{stateSanitizer:(e,t)=>e.appConfig?"1"===e.queryObject.__log_app_config_in_redux__||"true"===e.queryObject.__log_app_config_in_redux__?e:e.set("appConfig","<<appConfig>>"):e}}),window._appStore=EE,EE)}function TE(){return EE}function xE(e,t){let n;function r(){let r=EE.getState();t?(r=r.getIn(t),r!==n&&(e(n,r),n=r)):r!==n&&(e(n,r),n=r)}const i=EE.subscribe(r);return r(),i}const AE=function(){return Sl.Date.now()};var DE=/\s/;const RE=function(e){for(var t=e.length;t--&&DE.test(e.charAt(t)););return t};var PE=/^\s+/;const jE=function(e){return e?e.slice(0,RE(e)+1).replace(PE,""):e};var LE=/^[-+]0x[0-9a-f]+$/i,_E=/^0b[01]+$/i,ME=/^0o[0-7]+$/i,NE=parseInt;const kE=function(e){if("number"==typeof e)return e;if(Pl(e))return NaN;if(Ml(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ml(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=jE(e);var n=_E.test(e);return n||ME.test(e)?NE(e.slice(2),n?2:8):LE.test(e)?NaN:+e};var UE=Math.max,FE=Math.min;const BE=function(e,t,n){var r,i,o,s,a,l,u=0,c=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,u=t,s=e.apply(o,n)}function h(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=o}function g(){var e=AE();if(h(e))return m(e);a=setTimeout(g,function(e){var n=t-(e-l);return d?FE(n,o-(e-u)):n}(e))}function m(e){return a=void 0,p&&r?f(e):(r=i=void 0,s)}function v(){var e=AE(),n=h(e);if(r=arguments,i=this,l=e,n){if(void 0===a)return function(e){return u=e,a=setTimeout(g,t),c?f(e):s}(l);if(d)return clearTimeout(a),a=setTimeout(g,t),f(l)}return void 0===a&&(a=setTimeout(g,t)),s}return t=kE(t)||0,Ml(n)&&(c=!!n.leading,o=(d="maxWait"in n)?UE(kE(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),v.cancel=function(){void 0!==a&&clearTimeout(a),u=0,r=l=i=a=void 0},v.flush=function(){return void 0===a?s:m(AE())},v};const $E=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Ml(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),BE(e,t,{leading:r,maxWait:t,trailing:i})};const VE=function(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout(function(){e.apply(void 0,n)},t)};const GE=function(e){return e};const WE=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var HE=Math.max;const zE=function(e,t,n){return t=HE(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=HE(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),WE(e,this,a)}};const qE=function(e){return function(){return e}};const JE=em?function(e,t){return em(e,"toString",{configurable:!0,enumerable:!1,value:qE(t),writable:!0})}:GE;var KE=Date.now;const YE=function(e){var t=0,n=0;return function(){var r=KE(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}};const XE=YE(JE);const QE=function(e,t){return XE(zE(e,t,GE),e+"")};const ZE=QE(function(e,t){return VE(e,1,t)});var eO,tO,nO,rO,iO;!function(e){e.All="ALL",e.Simple="SIMPLE"}(eO||(eO={})),function(e){e.And="AND",e.Or="OR"}(tO||(tO={})),function(e){e.None="NONE",e.Previous="PREVIOUS",e.All="ALL"}(nO||(nO={})),function(e){e.StringOperatorIs="STRING_OPERATOR_IS",e.StringOperatorIsNot="STRING_OPERATOR_IS_NOT",e.StringOperatorContains="STRING_OPERATOR_CONTAINS",e.StringOperatorDoesNotContain="STRING_OPERATOR_DOES_NOT_CONTAIN",e.StringOperatorStartsWith="STRING_OPERATOR_STARTS_WITH",e.StringOperatorDoesNotStartWith="STRING_OPERATOR_DOES_NOT_START_WITH",e.StringOperatorEndsWith="STRING_OPERATOR_ENDS_WITH",e.StringOperatorDoesNotEndWith="STRING_OPERATOR_DOES_NOT_END_WITH",e.StringOperatorIsAnyOf="STRING_OPERATOR_IS_ANY_OF",e.StringOperatorIsNoneOf="STRING_OPERATOR_IS_NONE_OF",e.StringOperatorIsBlank="STRING_OPERATOR_IS_BLANK",e.StringOperatorIsNotBlank="STRING_OPERATOR_IS_NOT_BLANK",e.NumberOperatorIs="NUMBER_OPERATOR_IS",e.NumberOperatorIsNot="NUMBER_OPERATOR_IS_NOT",e.NumberOperatorIsAtLeast="NUMBER_OPERATOR_IS_AT_LEAST",e.NumberOperatorIsAtMost="NUMBER_OPERATOR_IS_AT_MOST",e.NumberOperatorIsLessThan="NUMBER_OPERATOR_IS_LESS_THAN",e.NumberOperatorIsGreaterThan="NUMBER_OPERATOR_IS_GREATER_THAN",e.NumberOperatorIsBetween="NUMBER_OPERATOR_IS_BETWEEN",e.NumberOperatorIsNotBetween="NUMBER_OPERATOR_IS_NOT_BETWEEN",e.NumberOperatorIsAnyOf="NUMBER_OPERATOR_IS_ANY_OF",e.NumberOperatorIsNoneOf="NUMBER_OPERATOR_IS_NONE_OF",e.NumberOperatorIsBlank="NUMBER_OPERATOR_IS_BLANK",e.NumberOperatorIsNotBlank="NUMBER_OPERATOR_IS_NOT_BLANK",e.DateOperatorIsOn="DATE_OPERATOR_IS_ON",e.DateOperatorIsNotOn="DATE_OPERATOR_IS_NOT_ON",e.DateOperatorIsIn="DATE_OPERATOR_IS_IN",e.DateOperatorIsNotIn="DATE_OPERATOR_IS_NOT_IN",e.DateOperatorIsBefore="DATE_OPERATOR_IS_BEFORE",e.DateOperatorIsAfter="DATE_OPERATOR_IS_AFTER",e.DateOperatorIsOnOrBefore="DATE_OPERATOR_IS_ON_OR_BEFORE",e.DateOperatorIsOnOrAfter="DATE_OPERATOR_IS_ON_OR_AFTER",e.DateOperatorIsInTheLast="DATE_OPERATOR_IS_IN_THE_LAST",e.DateOperatorIsNotInTheLast="DATE_OPERATOR_IS_NOT_IN_THE_LAST",e.DateOperatorIsInTheNext="DATE_OPERATOR_IS_IN_THE_NEXT",e.DateOperatorIsNotInTheNext="DATE_OPERATOR_IS_NOT_IN_THE_NEXT",e.DateOperatorIsBetween="DATE_OPERATOR_IS_BETWEEN",e.DateOperatorIsNotBetween="DATE_OPERATOR_IS_NOT_BETWEEN",e.DateOperatorIsBlank="DATE_OPERATOR_IS_BLANK",e.DateOperatorIsNotBlank="DATE_OPERATOR_IS_NOT_BLANK",e.DateOnlyOperatorIsOn="DATE_ONLY_OPERATOR_IS_ON",e.DateOnlyOperatorIsNotOn="DATE_ONLY_OPERATOR_IS_NOT_ON",e.DateOnlyOperatorIsBefore="DATE_ONLY_OPERATOR_IS_BEFORE",e.DateOnlyOperatorIsAfter="DATE_ONLY_OPERATOR_IS_AFTER",e.DateOnlyOperatorIsOnOrBefore="DATE_ONLY_OPERATOR_IS_ON_OR_BEFORE",e.DateOnlyOperatorIsOnOrAfter="DATE_ONLY_OPERATOR_IS_ON_OR_AFTER",e.DateOnlyOperatorIsBetween="DATE_ONLY_OPERATOR_IS_BETWEEN",e.DateOnlyOperatorIsNotBetween="DATE_ONLY_OPERATOR_IS_NOT_BETWEEN",e.DateOnlyOperatorIsBlank="DATE_ONLY_OPERATOR_IS_BLANK",e.DateOnlyOperatorIsNotBlank="DATE_ONLY_OPERATOR_IS_NOT_BLANK",e.TimeOnlyOperatorIsOn="TIME_ONLY_OPERATOR_IS_ON",e.TimeOnlyOperatorIsNotOn="TIME_ONLY_OPERATOR_IS_NOT_ON",e.TimeOnlyOperatorIsBefore="TIME_ONLY_OPERATOR_IS_BEFORE",e.TimeOnlyOperatorIsAfter="TIME_ONLY_OPERATOR_IS_AFTER",e.TimeOnlyOperatorIsOnOrBefore="TIME_ONLY_OPERATOR_IS_ON_OR_BEFORE",e.TimeOnlyOperatorIsOnOrAfter="TIME_ONLY_OPERATOR_IS_ON_OR_AFTER",e.TimeOnlyOperatorIsBetween="TIME_ONLY_OPERATOR_IS_BETWEEN",e.TimeOnlyOperatorIsNotBetween="TIME_ONLY_OPERATOR_IS_NOT_BETWEEN",e.TimeOnlyOperatorIsBlank="TIME_ONLY_OPERATOR_IS_BLANK",e.TimeOnlyOperatorIsNotBlank="TIME_ONLY_OPERATOR_IS_NOT_BLANK"}(rO||(rO={})),function(e){e.UserInput="USER_INPUT",e.Field="FIELD",e.SingleSelectFromUnique="UNIQUE",e.MultipleSelectFromUnique="MULTIPLE",e.SingleSelectFromPredefined="UNIQUE_PREDEFINED",e.MultipleSelectFromPredefined="MULTIPLE_PREDEFINED"}(iO||(iO={}));const oO="-empty-";var sO,aO,lO,uO;!function(e){e.Single="SINGLE",e.Set="SET"}(sO||(sO={})),function(e){e.Inline="INLINE",e.Block="BLOCK"}(aO||(aO={})),function(e){e.None="NONE",e.UseAskForValue="USE_ASK_FOR_VALUE",e.UseLabel="USE_LABEL"}(lO||(lO={})),function(e){e.Asc="ASC",e.Desc="DESC"}(uO||(uO={}));var cO=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function dO(e,t,n,r,i){return cO(this,void 0,void 0,function*(){try{const o=yield function(e,t){return cO(this,void 0,void 0,function*(){var n,r,i,o;try{const s=yield gO(t);if(!s)return null;const a=e.getSchema(),l=null===(n=null==a?void 0:a.fields)||void 0===n?void 0:n[e.getIdField()];if(!l)return null;const u=e.getLayerDefinition(),c=function(e,t,n){if(!e||!t)return null;return Object.keys(e).map(r=>{const i=function(e,t){var n,r;return{name:e.name,alias:e.alias,type:SO(e.type,e.esriType),domain:yO(null===(r=null===(n=null==t?void 0:t.fields)||void 0===n?void 0:n.find(t=>t.name===e.name))||void 0===r?void 0:r.domain)}}(e[r],n);return i.name===t.name&&(i.type="oid"),i})}(null==a?void 0:a.fields,l,u);if(!c)return null;const d=fO(e.getGeometryType())||null,p={fields:c,objectIdField:l.name,source:s,geometryType:d,spatialReference:null===(r=e.getMainDataSource().layer)||void 0===r?void 0:r.spatialReference,fullExtent:null===(i=e.getMainDataSource().layer)||void 0===i?void 0:i.fullExtent,typeIdField:null==u?void 0:u.typeIdField,sourceJSON:u};let f;try{f=t.length>0?null===(o=t[0].feature.layer)||void 0===o?void 0:o.renderer:void 0}catch(e){}return f&&(p.renderer=f),p}catch(e){return console.error("Failed to get constructor options of JS API client-side feature layer.",e),null}})}(e,t),s=yield Bg("esri/layers/FeatureLayer");let a=Object.assign(Object.assign({},o),r);"function"==typeof i&&(a=yield i(a));const l=new s(a),u=!(null==r?void 0:r.popupTemplate)&&e.getPopupInfo();if(u){const e=yield Bg("esri/PopupTemplate");l.popupEnabled=!0,l.popupTemplate=e.fromJSON(u)}else l.popupEnabled=!!(null==r?void 0:r.popupTemplate);return l.title=e.getLabel()||e.getDataSourceJson().sourceLabel,{layer:l,sourceVersion:n}}catch(e){return console.error("Feature layer data source error: failed to create feature layer with source records. ",e),{layer:null,sourceVersion:n}}})}function pO(e,t,n){if(!e)return null;return{layer:{id:e.id,layerType:"ArcGISFeatureLayer",title:e.getLabel(),featureCollection:{layers:[{layerDefinition:e.getLayerDefinition(),popupInfo:e.getPopupInfo(),featureSet:{geometryType:e.getGeometryType(),features:mO(t)}}]}},sourceVersion:n}}function fO(e){return{esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent"}[e]}function hO(e){return{point:"esriGeometryPoint",multipoint:"esriGeometryMultipoint",polyline:"esriGeometryPolyline",polygon:"esriGeometryPolygon",extent:"esriGeometryEnvelope"}[e]}function gO(e){return e?Promise.allSettled(e.filter(e=>null==e?void 0:e.feature).map(e=>{if("esri.Graphic"===e.feature.declaredClass){const t=e.feature.clone();return t.attributes=Object.assign({},e.feature.attributes),t}return IO(e.feature)})).then(e=>e.filter(e=>"fulfilled"===e.status).map(e=>e.value)):Promise.resolve(null)}function mO(e){return e?e.filter(e=>null==e?void 0:e.feature).map(e=>"esri.Graphic"===e.feature.declaredClass?e.feature.toJSON():e.feature):null}function vO(e){const t=Array.isArray(e);let n;return(t||"number"==typeof e)&&(n={start:OO(t?e[0]:e),end:OO(t?e[1]:e)}),n}function yO(e){var t,n;return e?"inherited"===e.type?{type:"inherited"}:"range"===e.type?{type:"range",minValue:null===(t=e.range)||void 0===t?void 0:t[0],maxValue:null===(n=e.range)||void 0===n?void 0:n[1]}:"codedValue"===e.type?{type:"coded-value",codedValues:e.codedValues}:null:null}function SO(e,t){if(t)switch(t){case Ma.Date:return"date";case Ma.Double:return"double";case Ma.GlobalID:return"global-id";case Ma.GUID:return"guid";case Ma.Integer:return"integer";case Ma.OID:return"oid";case Ma.Single:return"single";case Ma.SmallInteger:return"small-integer";case Ma.XML:return"xml";case Ma.BigInteger:return"big-integer"}switch(e){case _a.Number:return"double";case _a.Date:return"date";default:return"string"}}function bO(e){return"esri.Graphic"===e.declaredClass?e.toJSON():e}function wO(e){return cO(this,void 0,void 0,function*(){return"esri.Graphic"===e.declaredClass?yield Promise.resolve(e):yield IO(e)})}function IO(e){return cO(this,void 0,void 0,function*(){return yield Fg(["esri/Graphic"]).then(t=>{const n=t[0],r=Object.assign({},e);return r.attributes=Object.assign({},e.attributes),n.fromJSON(r)})})}function EO(e,t){const n=(null==e?void 0:e.type)===Xa.SceneLayer?null==e?void 0:e.getAssociatedDataSource():e;if(!n||!t)return null;const r=t.asMutable({deep:!0});return Fg(["esri/geometry/support/jsonUtils"]).then(i=>{var o,s,a,l,u;const c=i[0];if("number"==typeof t.pageSize){const e=null!==(o=t.page)&&void 0!==o?o:1;r.start=(e-1)*t.pageSize,r.num=t.pageSize,null!==n.getMaxRecordCount()&&(1===e?r.num=Math.min(n.getMaxRecordCount(),t.pageSize):e*t.pageSize>n.getMaxRecordCount()&&(r.num=n.getMaxRecordCount()-(e-1)*t.pageSize)),delete r.page,delete r.pageSize}return t.geometry&&(r.geometry=c.fromJSON(r.geometry)),t.geometryType&&delete r.geometryType,t.spatialRel&&(r.spatialRelationship={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within"}[r.spatialRel],delete r.spatialRel),t.units&&(r.units={esriSRUnit_StatuteMile:"miles",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_Meter:"meters",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}[r.units]),t.outSR&&("number"==typeof t.outSR?r.outSpatialReference={wkid:t.outSR}:r.outSpatialReference=t.outSR,delete r.outSR),n.getGDBVersion()&&(r.gdbVersion=n.getGDBVersion()),(null===(s=r.outStatistics)||void 0===s?void 0:s.length)||(null===(a=r.outFields)||void 0===a?void 0:a.length)||(r.outFields=[e.getIdField()]),(null===(l=r.objectIds)||void 0===l?void 0:l.length)&&(r.objectIds=r.objectIds.map(e=>+e).filter(e=>!isNaN(e))),null!=t.time&&(r.timeExtent=vO(t.time)),delete r.time,(null===(u=r.outStatistics)||void 0===u?void 0:u.length)>0&&(r.outStatistics=r.outStatistics.map(e=>{var t;return"percentile_cont"===e.statisticType?e.statisticType="percentile-continuous":"percentile_disc"===e.statisticType&&(e.statisticType="percentile-discrete"),(null===(t=e.statisticParameters)||void 0===t?void 0:t.orderBy)&&(e.statisticParameters.orderBy=e.statisticParameters.orderBy.toUpperCase()),e})),r})}function OO(e){return"number"==typeof e?new Date(e):null}function CO(e){return(null==e?void 0:e.type)===Xa.FeatureLayer||(null==e?void 0:e.type)===Xa.SceneLayer||(null==e?void 0:e.type)===Xa.ImageryLayer||(null==e?void 0:e.type)===Xa.OrientedImageryLayer||(null==e?void 0:e.type)===Xa.ImageryTileLayer}function TO(e){const t=e;return!!((null==t?void 0:t.id)&&(null==t?void 0:t.getItemData)&&(null==t?void 0:t.getItemInfo)&&(null==t?void 0:t.fetchItemData)&&(null==t?void 0:t.fetchItemInfo))}const xO=a(430),AO=864e5,DO=6e4,RO=1e3,PO={equals:{op:"= ?"},doesNotEqual:{op:"<> ?"},isAtLeast:{op:">= ?"},isAtMost:{op:"<= ?"},isLessThan:{op:"< ?"},isGreaterThan:{op:"> ?"},isBetween:{op:"BETWEEN ?",sep:" AND "},isNotBetween:{op:"NOT BETWEEN ?",sep:" AND "},contains:{op:"LIKE ?",mod:"%{0}%"},doesNotContain:{op:"NOT LIKE ?",mod:"%{0}%"},startsWith:{op:"LIKE ?",mod:"{0}%"},doesNotStartWith:{op:"NOT LIKE ?",mod:"{0}%"},endsWith:{op:"LIKE ?",mod:"%{0}"},doesNotEndWith:{op:"NOT LIKE ?",mod:"%{0}"},isAnyOf:{op:"IN ?",mod:"[{0}]",type:"IN"},isNoneOf:{op:"NOT IN ?",mod:"[{0}]",type:"IN"}};function jO(e){let t="";switch(e){case rO.NumberOperatorIs:case rO.StringOperatorIs:case rO.DateOperatorIsOn:case rO.DateOnlyOperatorIsOn:case rO.TimeOnlyOperatorIsOn:case rO.NumberOperatorIsBlank:case rO.StringOperatorIsBlank:case rO.DateOperatorIsBlank:t="equals";break;case rO.NumberOperatorIsNot:case rO.StringOperatorIsNot:case rO.DateOperatorIsNotOn:case rO.DateOnlyOperatorIsNotOn:case rO.TimeOnlyOperatorIsNotOn:case rO.NumberOperatorIsNotBlank:case rO.StringOperatorIsNotBlank:case rO.DateOperatorIsNotBlank:t="doesNotEqual";break;case rO.NumberOperatorIsAtLeast:case rO.DateOperatorIsOnOrAfter:case rO.TimeOnlyOperatorIsOnOrAfter:t="isAtLeast";break;case rO.NumberOperatorIsAtMost:case rO.DateOperatorIsOnOrBefore:case rO.TimeOnlyOperatorIsOnOrBefore:t="isAtMost";break;case rO.NumberOperatorIsLessThan:case rO.DateOperatorIsBefore:case rO.DateOnlyOperatorIsBefore:case rO.TimeOnlyOperatorIsBefore:t="isLessThan";break;case rO.NumberOperatorIsGreaterThan:case rO.DateOperatorIsAfter:case rO.DateOnlyOperatorIsAfter:case rO.TimeOnlyOperatorIsAfter:t="isGreaterThan";break;case rO.NumberOperatorIsBetween:case rO.DateOperatorIsBetween:case rO.DateOnlyOperatorIsBetween:case rO.TimeOnlyOperatorIsBetween:t="isBetween";break;case rO.NumberOperatorIsNotBetween:case rO.DateOperatorIsNotBetween:case rO.DateOnlyOperatorIsNotBetween:case rO.TimeOnlyOperatorIsNotBetween:t="isNotBetween";break;case rO.NumberOperatorIsAnyOf:case rO.StringOperatorIsAnyOf:case rO.DateOperatorIsIn:t="isAnyOf";break;case rO.NumberOperatorIsNoneOf:case rO.StringOperatorIsNoneOf:case rO.DateOperatorIsNotIn:t="isNoneOf";break;case rO.StringOperatorContains:t="contains";break;case rO.StringOperatorDoesNotContain:t="doesNotContain";break;case rO.StringOperatorStartsWith:t="startsWith";break;case rO.StringOperatorEndsWith:t="endsWith";break;case rO.StringOperatorDoesNotStartWith:t="doesNotStartWith";break;case rO.StringOperatorDoesNotEndWith:t="doesNotEndWith"}return t}function LO(e,t,n,r=!1,i=!1){if(e.includes("BLANK"))return n.fieldAlias+(e.includes("NOT")?" IS NOT NULL":" IS NULL");let o=jO(e);if(e.includes("DATE")||e.includes("TIME"))switch(e){case rO.DateOperatorIsOn:case rO.DateOnlyOperatorIsOn:o=r?"is":i?"isAt":"isOn";break;case rO.DateOperatorIsNotOn:case rO.DateOnlyOperatorIsNotOn:o=r?"isNot":i?"isNotAt":"isNotOn";break;case rO.TimeOnlyOperatorIsOn:o="isAt";break;case rO.TimeOnlyOperatorIsNotOn:o="isNotAt";break;case rO.DateOperatorIsIn:o="isIn";break;case rO.DateOperatorIsNotIn:o="isNotIn";break;case rO.DateOperatorIsBefore:case rO.DateOnlyOperatorIsBefore:case rO.TimeOnlyOperatorIsBefore:o="isBefore";break;case rO.DateOperatorIsAfter:case rO.DateOnlyOperatorIsAfter:case rO.TimeOnlyOperatorIsAfter:o="isAfter";break;case rO.DateOperatorIsOnOrBefore:case rO.DateOnlyOperatorIsOnOrBefore:case rO.TimeOnlyOperatorIsOnOrBefore:o=i?"isAtOrBefore":"isOnOrBefore";break;case rO.DateOperatorIsOnOrAfter:case rO.DateOnlyOperatorIsOnOrAfter:case rO.TimeOnlyOperatorIsOnOrAfter:o=i?"isAtOrAfter":"isOnOrAfter";break;case rO.DateOperatorIsInTheLast:o="isInTheLast";break;case rO.DateOperatorIsNotInTheLast:o="isNotInTheLast";break;case rO.DateOperatorIsInTheNext:o="isInTheNext";break;case rO.DateOperatorIsNotInTheNext:o="isNotInTheNext"}return t.formatMessage({id:o+"ForDisplaySQL"},n)}var _O;function MO(e,t){const n=e.asMutable({deep:!0});let r=!1;return n.parts&&function e(n){n.parts.forEach(function(i,o){if(i.type===sO.Set)e(i);else{const e=i;if(e.customSQL)return;const s=t[e.jimuFieldName],a=e.valueOptions.value;if(s&&s.type===_a.String&&(s.esriType===Ma.GlobalID||s.esriType===Ma.GUID)&&(null==a?void 0:a.length)>0&&[rO.StringOperatorIs,rO.StringOperatorIsNot,rO.StringOperatorIsAnyOf,rO.StringOperatorIsNoneOf,rO.StringOperatorStartsWith].includes(e.operator)){let t=[];a.forEach(e=>{const n=e.value;if(36!==n.length&&38!==n.length)t.push(null);else{t.push(e);const r=n.includes("{")?n.replace(/{(.*?)}/g,"$1"):`{${n}}`;t.push(Object.assign(Object.assign({},e),{value:r,label:r}))}}),t=t.filter(e=>null!==e),0===t.length&&(t=null);const i=e.operator===rO.StringOperatorIs?rO.StringOperatorIsAnyOf:e.operator===rO.StringOperatorIsNot?rO.StringOperatorIsNoneOf:e.operator;let s=e.valueOptions;e.operator===rO.StringOperatorStartsWith&&(s=Object.assign(Object.assign({},s),{sourceType:iO.MultipleSelectFromPredefined,inputEditor:"MULTIPLE_PREDEFINED_SELECTOR"}));const l=Object.assign(Object.assign({},e),{operator:i,valueOptions:Object.assign(Object.assign({},s),{value:t})});n.parts[o]=l,r=!0}}})}(n),r?Ye(n):e}function NO(e,t,n){var r,i;n=n||Tb();const o={sqlExpression:e,sql:"",displaySQL:""};if(!e||!t)return o;const s=t.getSchema().fields,a=wT(t.url),l=null===(i=(r=t).getLayerDefinition)||void 0===i?void 0:i.call(r),u=((null==(c=l)?void 0:c.version)||(null==c?void 0:c.currentVersion))>=10.2&&(null==c?void 0:c.useStandardizedQueries);var c;const d=function(e){let t=0;(null==e?void 0:e.dateFieldsTimeReference)&&"UTC"!==e.dateFieldsTimeReference.timeZone&&(t=60*(xO[e.dateFieldsTimeReference.timeZone]||0)*60*1e3);return t}(l),p=yx(t),f=t.isSqlCaseSensitive,h=function e(r){if(!r.parts)return o;const i=r.logicalOperator?r.logicalOperator:tO.And,l=[],c=[];r.parts.forEach(function(r){if(r.type===sO.Set){const t=e(r);t.sql&&l.push(kO(t.sql)?t.sql:`(${t.sql})`),c.push(kO(t.displaySQL)?t.displaySQL:`(${t.displaySQL})`)}else{const e=r;if(e.customSQL)return l.push(`(${e.customSQL})`),void c.push(`(${e.customSQL||e.customDisplaySQL})`);const i=s[e.jimuFieldName],o=i?i.type:null;if(!o)return;const h=e.valueOptions.value?e.valueOptions.value.asMutable({deep:!0}):null,g={fieldAlias:i.alias||i.name,value:"?",endValue:"?"};e.valueOptions.sourceType===iO.Field?function(e){const{fields:t,fieldObj:n,clause:r,sqlList:i,displaySqlList:o,vals:s,labelValues:a,intl:l}=e;let u="",c="";const d=PO[jO(r.operator)];if(null!==s){u=s[0].value;const e=t[u],r=e.alias||e.name;a.value=r,a.endValue=r;const o=VO(d.op,u);i.push("("+n.name+" "+o+")")}c=LO(r.operator,l,a),o.push("("+c+")")}({fields:s,fieldObj:i,clause:e,sqlList:l,displaySqlList:c,vals:h,labelValues:g,intl:n}):o===_a.Date?function(e){var t,n,r,i,o,s,a,l,u,c,d,p;const{fieldObj:f,clause:h,sqlList:g,displaySqlList:m,vals:v,labelValues:y,isDateInForUnknownTZ:S,timeZoneOffset:b,isHosted:w,useStandardizedQuery:I,dataSource:E,intl:O}=e;let C="",T="",x=!1,A=!1,D=h.valueOptions.inputEditor;if(null===v){if(h.operator.indexOf("BLANK")>0){const e=h.operator.indexOf("NOT")>0?"NOT ":"";g.push("("+f.name+" IS "+e+"NULL)")}"SIMPLE_SELECT"===D||"UNIQUE_PILL_WRAP_SELECTOR"===D?(null===(t=f.format)||void 0===t?void 0:t.dateFormat)&&f.format.dateFormat.includes("Time")&&(x=!0):x=D.includes("TIME")}else if("NUMBER_LIST_SELECTOR"===D&&null===v[0].value)y.endValue=O.formatMessage({id:v[0].label.toLowerCase()});else{v&&"NUMBER_LIST_SELECTOR"!==D&&"SIMPLE_SELECT"!==D&&"UNIQUE_PILL_WRAP_SELECTOR"!==D&&v.forEach(e=>{e&&"number"==typeof e.value&&(!S&&e.isUTC||(e.value=e.value+qO()))});const e=I?"timestamp ":"";let t,m=null===(n=v[0])||void 0===n?void 0:n.value,T=!1;if("SIMPLE_SELECT"===D||"UNIQUE_PILL_WRAP_SELECTOR"===D){let e=_O.DateTimeShort;D="DATE_TIME_PICKER",x=!0,(null===(r=f.format)||void 0===r?void 0:r.dateFormat)&&(f.format.dateFormat.includes("LongTime")?e=_O.DateTimeLong:f.format.dateFormat.includes("Time")||(x=!1,D="DATE_PICKER",e=_O.Date)),y.value=JO(new Date(Ix(m,E)),D,null===(i=f.format)||void 0===i?void 0:i.dateFormat,O),m=KO(m,e,S),t=m,T=!0}else if("NUMBER_LIST_SELECTOR"===D)m=null,y.value=v[0].value,y.endValue=O.formatMessage({id:v[0].label.toLowerCase()});else{const e=null===(o=v[1])||void 0===o?void 0:o.value;if(null===v[0])m=null;else if("string"==typeof m){A=!0,y.value=O.formatMessage({id:$O(v[0].value)});const n=Ep(m,O);m=KO(n[0]||n,_O.Date),void 0!==n.length?t=KO(n[1],_O.Date):e||(t=m,D="DATE_PICKER")}else x=D.includes("TIME"),y.value=JO(new Date(Ix(m,E)),D,null===(s=f.format)||void 0===s?void 0:s.dateFormat,O),t=m;if(null===v[1])A=!1,t=null;else if(e){let n;if(A=!1,"string"==typeof e){n=O.formatMessage({id:$O(v[1].value)});const r=Ep(e,O);t=KO(r[0]||r,_O.Date),D="DATE_PICKER"}else n=JO(new Date(Ix(e,E)),D,null===(a=f.format)||void 0===a?void 0:a.dateFormat,O),t=e;y.endValue=n}}const R=m?e+"'"+zO(m,b,T&&S)+"'":null,P=t?e+"'"+function(e,t,n,r,i=!1){let o;"DATE_PICKER"===n||"DOUBLE_DATE_PICKER"===n||"DATE_RANGE_SELECTOR"===n?o=e+AO:"DATE_TIME_PICKER"!==n&&"DOUBLE_DATE_TIME_PICKER"!==n||(o=r&&r.includes("LongTime")?e+RO:e+DO);return zO(o,t,i)}(t,b,D,null===(l=f.format)||void 0===l?void 0:l.dateFormat,T&&S)+"'":null;switch(h.operator){case rO.DateOperatorIsOn:C="("+f.name+" BETWEEN "+R+" AND "+P+") AND "+f.name+" <> "+P;break;case rO.DateOperatorIsNotOn:C=f.name+" < "+R+" OR "+f.name+" >= "+P;break;case rO.DateOperatorIsBefore:C=f.name+" < "+R;break;case rO.DateOperatorIsAfter:C=f.name+" > "+P;break;case rO.DateOperatorIsOnOrBefore:C=f.name+" <= "+P;break;case rO.DateOperatorIsOnOrAfter:C=f.name+" >= "+R;break;case rO.DateOperatorIsInTheLast:C=f.name+" BETWEEN CURRENT_TIMESTAMP - "+FO(v[0].value,null===(u=v[0])||void 0===u?void 0:u.label,w)+" AND CURRENT_TIMESTAMP";break;case rO.DateOperatorIsNotInTheLast:C=f.name+" NOT BETWEEN CURRENT_TIMESTAMP - "+FO(v[0].value,null===(c=v[0])||void 0===c?void 0:c.label,w)+" AND CURRENT_TIMESTAMP";break;case rO.DateOperatorIsInTheNext:C=f.name+" BETWEEN CURRENT_TIMESTAMP AND CURRENT_TIMESTAMP + "+FO(v[0].value,null===(d=v[0])||void 0===d?void 0:d.label,w);break;case rO.DateOperatorIsNotInTheNext:C=f.name+" NOT BETWEEN CURRENT_TIMESTAMP AND CURRENT_TIMESTAMP + "+FO(v[0].value,null===(p=v[0])||void 0===p?void 0:p.label,w);break;case rO.DateOperatorIsBetween:case rO.DateOperatorIsIn:C=R&&P?"("+f.name+" BETWEEN "+R+" AND "+P+") AND "+f.name+" <> "+P:"";break;case rO.DateOperatorIsNotBetween:case rO.DateOperatorIsNotIn:C=R&&P?f.name+" < "+R+" OR "+f.name+" >= "+P:""}""!==C&&g.push(`(${C})`)}T=LO(h.operator,O,y,A,x),m.push(`(${T})`)}({fieldObj:i,clause:e,sqlList:l,displaySqlList:c,vals:h,labelValues:g,isDateInForUnknownTZ:p,timeZoneOffset:d,isHosted:a,useStandardizedQuery:u,dataSource:t,intl:n}):o===_a.DateOnly?function(e){var t,n,r,i,o;const{fieldObj:s,clause:a,sqlList:l,displaySqlList:u,vals:c,labelValues:d,intl:p}=e;let f="",h="",g=!1;const m=a.valueOptions.inputEditor;if(null===c){if(a.operator.indexOf("BLANK")>0){const e=a.operator.indexOf("NOT")>0?"NOT ":"";l.push("("+s.name+" IS "+e+"NULL)")}}else{let e,u=null===(t=c[0])||void 0===t?void 0:t.value;if("SIMPLE_SELECT"===m||"UNIQUE_PILL_WRAP_SELECTOR"===m)d.value=JO(new Date(u),"DATE_PICKER",null===(n=s.format)||void 0===n?void 0:n.dateFormat,p);else{const t=null===(r=c[1])||void 0===r?void 0:r.value;if(null===c[0])u=null;else if(bp(u))d.value=JO(new Date(u),"DATE_PICKER",null===(i=s.format)||void 0===i?void 0:i.dateFormat,p),e=u;else{g=!0,d.value=p.formatMessage({id:$O(c[0].value)});u=wp(Ep(u,p)),t||(e=u)}if(null===c[1])g=!1,e=null;else if(t){let n;if(g=!1,bp(t))n=JO(new Date(t),"DATE_PICKER",null===(o=s.format)||void 0===o?void 0:o.dateFormat,p),e=t;else{n=p.formatMessage({id:$O(c[1].value)});e=wp(Ep(t,p))}d.endValue=n}}const h=u?"'"+u+"'":null,v=e?"'"+e+"'":null;switch(a.operator){case rO.DateOnlyOperatorIsOn:f=s.name+" = DATE "+h;break;case rO.DateOnlyOperatorIsNotOn:f=s.name+" <> DATE "+h;break;case rO.DateOnlyOperatorIsBefore:f=s.name+" < DATE "+h;break;case rO.DateOnlyOperatorIsAfter:f=s.name+" > DATE "+h;break;case rO.DateOnlyOperatorIsOnOrBefore:f=s.name+" <= DATE "+h;break;case rO.DateOnlyOperatorIsOnOrAfter:f=s.name+" >= DATE "+h;break;case rO.DateOnlyOperatorIsBetween:f=h&&v?s.name+" BETWEEN DATE "+h+" AND DATE "+v:"";break;case rO.DateOnlyOperatorIsNotBetween:f=h&&v?s.name+" NOT BETWEEN DATE "+h+" AND DATE "+v:""}""!==f&&l.push(`(${f})`)}h=LO(a.operator,p,d,g),u.push(`(${h})`)}({fieldObj:i,clause:e,sqlList:l,displaySqlList:c,vals:h,labelValues:g,intl:n}):o===_a.TimeOnly?function(e){var t,n;const{fieldObj:r,clause:i,sqlList:o,displaySqlList:s,vals:a,labelValues:l,intl:u}=e;let c="",d="";const p=i.valueOptions.inputEditor;if(null===a){if(i.operator.indexOf("BLANK")>0){const e=i.operator.indexOf("NOT")>0?"NOT ":"";o.push("("+r.name+" IS "+e+"NULL)")}}else{let e,s=null===(t=a[0])||void 0===t?void 0:t.value;if("SIMPLE_SELECT"===p||"UNIQUE_PILL_WRAP_SELECTOR"===p)l.value=s;else{const t=null===(n=a[1])||void 0===n?void 0:n.value;null===a[0]?s=null:(l.value=s,e=s),null===a[1]?e=null:t&&(l.endValue=t,e=t)}const u=s?"'"+s+"'":null,d=e?"'"+e+"'":null;switch(i.operator){case rO.TimeOnlyOperatorIsOn:c=r.name+" = TIME "+u;break;case rO.TimeOnlyOperatorIsNotOn:c=r.name+" <> TIME "+u;break;case rO.TimeOnlyOperatorIsBefore:c=r.name+" < TIME "+u;break;case rO.TimeOnlyOperatorIsAfter:c=r.name+" > TIME "+u;break;case rO.TimeOnlyOperatorIsOnOrBefore:c=r.name+" <= TIME "+u;break;case rO.TimeOnlyOperatorIsOnOrAfter:c=r.name+" >= TIME "+u;break;case rO.TimeOnlyOperatorIsBetween:c=u&&d?r.name+" BETWEEN TIME "+u+" AND TIME "+d:"";break;case rO.TimeOnlyOperatorIsNotBetween:c=u&&d?r.name+" NOT BETWEEN TIME "+u+" AND TIME "+d:""}""!==c&&o.push(`(${c})`)}d=LO(i.operator,u,l),s.push(`(${d})`)}({fieldObj:i,clause:e,sqlList:l,displaySqlList:c,vals:h,labelValues:g,intl:n}):function(e){const{fieldObj:t,clause:n,sqlList:r,displaySqlList:i,vals:o,labelValues:s,isHosted:a,useCaseSensitiveQuery:l,intl:u}=e;let c="",d="",p=!1;const f=PO[jO(n.operator)];let h=[];const g=[];let m=o;const v=[iO.SingleSelectFromPredefined,iO.MultipleSelectFromPredefined].includes(n.valueOptions.sourceType);v&&m&&(m=o.filter(e=>e.selected),m=m.length>0?m:null);let y=iO.MultipleSelectFromPredefined===n.valueOptions.sourceType&&[rO.StringOperatorStartsWith,rO.StringOperatorDoesNotStartWith,rO.StringOperatorEndsWith,rO.StringOperatorDoesNotEndWith,rO.StringOperatorContains,rO.StringOperatorDoesNotContain].includes(n.operator);if(null===m)"IN"===f.type&&(s.value="(?)");else{let e=!1;for(let r=0;r<m.length;r++){null!==m[r]&&m[r].value!==oO||(e=!0,m[r]={value:null,label:"?",alias:"?"});let i=m[r].value,o=v?m[r].alias:m[r].label;t.type===_a.String&&(i=null!==i?GO(i):null,p=l&&!n.caseSensitive),o=GO(o),f.mod&&"IN"!==f.type&&(i=null!==i?WO(f.mod,[i]):null);let s="";t.type===_a.String&&null!==i&&(s=a&&HO(i)?"N":"",i="'"+i+"'",o="'"+o+"'",p&&(i=null!==i?i.toLowerCase():null,o=o.toLowerCase()),s&&(i=s+i)),null!==i&&h.push(i),g.push(o)}if(e&&(h=[]),y=y&&h.length>1,y||!f.sep&&f.mod&&"IN"===f.type){const e=function(e){const t=[];return new Array(e).fill(1).forEach((e,n)=>{t.push("{"+n+"}")}),"("+t.join(",")+")"}(h.length);c=y?"predefined":WO(e,h),s.value=WO(e,g)}else h.forEach((e,t)=>{t>0&&(c+=f.sep),c+=e}),s.value=g[0],s.endValue=g[1]||s.endValue}const S=t.name;if(""!==c){const e=p?"LOWER("+S+")":S;if(y){const t=n.operator.includes("_NOT_")?" AND ":" OR ",i=h.map(t=>"("+e+" "+VO(f.op,t)+")").join(t);r.push(i)}else{const t=VO(f.op,c);r.push("("+e+" "+t+")")}}else if(n.operator.indexOf("BLANK")>0){const e=n.operator.indexOf("NOT")>0?"NOT ":"";r.push("("+S+" IS "+e+"NULL)"),d="Null"}d=LO(n.operator,u,s),i.push("("+d+")")}({fieldObj:i,clause:e,sqlList:l,displaySqlList:c,vals:h,labelValues:g,isHosted:a,useCaseSensitiveQuery:f,intl:n})}});const h=n.formatMessage({id:i.toLowerCase()+"LowerCase"});return{sql:l.join(` ${i} `),displaySQL:c.join(` ${h} `)}}(MO(e,s)),g=""===(m=h.sql)||"()"===m?"":kO(h.sql)?h.sql.slice(1,-1):h.sql;var m;return{sqlExpression:e.set("sql",g).set("displaySQL",h.displaySQL),sql:g,displaySQL:h.displaySQL}}function kO(e){let t=!0;if(e.startsWith("(")&&e.endsWith(")")){const n=e.slice(1,-1);let r=0;for(let e=0;e<n.length&&("("===n[e]&&r++,")"===n[e]&&r--,!(r<0));e++);r<0&&(t=!1)}return t}function UO(e){return null}function FO(e,t,n){return n?BO(e,t):function(e,t){let n="";t===op.Year||t===op.Month||t===op.Week||t===op.Day?n=`'${BO(e,t)}' DAY`:t===op.Hour?n=`'${e}' HOUR`:t===op.Minute&&(n=`'${e}' MINUTE`);return"INTERVAL "+n}(e,t)}function BO(e,t){let n=e;return t===op.Year?n=365*e:t===op.Month?n=30*e:t===op.Week?n=7*e:t===op.Hour?n=e/24:t===op.Minute&&(n=e/1440),n=Math.round(1e6*n)/1e6,n}function $O(e){return(e=e.toLowerCase()).replace(/\_(\w)/g,function(e,t){return t.toUpperCase()})}function VO(e,t){return e.replace("?",function(){return t})}function GO(e){return e.replace(/\'/g,"''")}function WO(e,t){return e.replace(/{([0-9]+)}/g,function(e,n){return t[parseInt(n)]})}function HO(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!0;return!1}function zO(e,t=0,n=!1){const r=new Date(e+t);return n?r.getFullYear()+"-"+("0"+(r.getMonth()+1)).slice(-2)+"-"+("0"+r.getDate()).slice(-2)+" "+("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2):r.getUTCFullYear()+"-"+("0"+(r.getUTCMonth()+1)).slice(-2)+"-"+("0"+r.getUTCDate()).slice(-2)+" "+("0"+r.getUTCHours()).slice(-2)+":"+("0"+r.getUTCMinutes()).slice(-2)+":"+("0"+r.getUTCSeconds()).slice(-2)}function qO(){const e=(new Date).getTimezoneOffset();return(e<0?1:-1)*(e<0?Math.abs(e)/60:e/60)*60*60*1e3}function JO(e,t,n,r){let i="";if(r){let o=lp.date,s=lp.time;if(n){const e=up(n);o=e.datePattern,s=t.includes("DATE_TIME_PICKER")?e.timePattern||s:""}else"DATE_PICKER"!==t&&"DOUBLE_DATE_PICKER"!==t||(s="");i=pp(e,r,o,s)}else"DATE_PICKER"===t||"DOUBLE_DATE_PICKER"===t?i=e.toLocaleDateString():"DATE_TIME_PICKER"!==t&&"DOUBLE_DATE_TIME_PICKER"!==t||(i=e.toLocaleDateString()+" "+("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2));return i}function KO(e,t,n=!1){return"number"!=typeof e&&"string"!=typeof e||("number"==typeof e&&n&&(e-=qO()),e=new Date(e)),e.setMilliseconds(0),t===_O.Date?(e.setHours(0),e.setMinutes(0),e.setSeconds(0)):t===_O.DateTimeShort&&e.setSeconds(0),e.getTime()}function YO(e,t,n){if(!e)return null;let r="";const i=Object.keys(n).map(t=>n[t]?(r+=r.length?`,${t}`:t,XO(n[t],e,Number(t))):null);r=r.length?`${e} not in (${r})`:null;const o=QO(...i);return function(...e){const t=(null==e?void 0:e.filter(e=>!ZO(e)))||[];return t.length>1?t.map(e=>`(${e})`).join(" and "):t[0]}(t,QO(o,r))}function XO(e,t,n){const r=`${t}=${n}`;return ZO(e)?r:`(${r}) and (${e})`}function QO(...e){const t=(null==e?void 0:e.filter(e=>!ZO(e)))||[];return t.length>1?t.map(e=>`(${e})`).join(" or "):t[0]}function ZO(e){return!e||/^[()]*$/.test(e.replace(/\s+/g,"").replace("1=1",""))}function eC(e,t,n,r=!1){const i=t===rO.DateOperatorIsOn?"DATE_TIME_PICKER":"TEXT_BOX",o={type:sO.Single,jimuFieldName:e,operator:t,valueOptions:{isValid:!0,sourceType:iO.UserInput,inputEditor:i,value:n},displayType:lO.None};return r&&(o.caseSensitive=r),o}function tC(e,t){return{type:sO.Set,logicalOperator:e,parts:t}}function nC(e,t,n){const r={sql:"1=1",displaySQL:"",logicalOperator:e,parts:t},i=NO(Ye(r),n);return r.sql=i.sql,r.displaySQL=i.displaySQL,r}function rC(e,t,n=tO.And){return nC(n,e.filter(e=>e).map(e=>({type:sO.Set,logicalOperator:e.logicalOperator,parts:e.parts})),t)}function iC(e,t,n){if(!e||!t)return null;const r=e[0];let i=r.clause;const o=n(i.operator.toLowerCase().replace(/\_(\w)/g,(e,t)=>t.toUpperCase()));i.displayType===lO.UseLabel&&null===i.displayLabel?i=i.set("displayLabel",o+" "+i.valueOptions.value.map(e=>e.label).join(",")):i.displayType===lO.UseAskForValue&&null===i.askForValueOptions.label&&(i=i.setIn(["askForValueOptions","label"],o));return Ye(nC(r.logicalOperator,[i],t))}function oC(e,t){var n;if(!e||!t)return null;let r=null;const i=null===(n=null==e?void 0:e.filter(e=>e.dataSourceId===t.id))||void 0===n?void 0:n[0];if(i){const n=e[0].clause,o=[];i.fieldList.forEach(e=>{o.push(n.set("jimuFieldName",e))}),r=Ye(nC(i.logicalOperator,o,t))}return r}!function(e){e.Date="DATE",e.DateTimeShort="DATE_TIME_SHORT",e.DateTimeLong="DATE_TIME_LONG"}(_O||(_O={}));const sC=["id","url","itemId","portalUrl","type","geometryType","layerId"];function aC(e,t,n,r,i,o){if(t)return lC(e,t,i,o);{let t,s;return n.data?t=dC(e,n.data,n.portalUrl,i,o):n.item&&(t=uC(e,n.item,n.portalUrl,i,o)),r&&(s=pC(e,r.layerDefinition,r.url,i,o)),t&&s?s.merge(t):t||s}}function lC(e,t,n,r){var i,o,s,a,l,u;if(!e||!t)return null;let c,d,p,f=LT(t);const h=t.type;switch(h){case nl.GroupLayer:c=Xa.GroupLayer;break;case nl.FeatureLayer:c=Xa.FeatureLayer,d=`${t.layerId}`,p=null===(i=t.sourceJSON)||void 0===i?void 0:i.geometryType;break;case nl.SceneLayer:c=Xa.SceneLayer,d=`${t.layerId}`;break;case nl.MapImageLayer:case nl.TileLayer:c=Xa.MapService;break;case nl.BuildingSceneLayer:c=Xa.BuildingSceneLayer;break;case nl.BuildingGroupSubLayer:c=Xa.BuildingGroupSubLayer;break;case nl.BuildingComponentSubLayer:c=Xa.BuildingComponentSubLayer,d=`${t.id}`;break;case nl.ImageryLayer:c=Xa.ImageryLayer;break;case nl.ImageryTileLayer:c=Xa.ImageryTileLayer;break;case nl.ElevationLayer:c=Xa.ElevationLayer;break;case nl.OrientedImageryLayer:c=Xa.OrientedImageryLayer;break;case nl.SubtypeGroupLayer:c=Xa.SubtypeGroupLayer,d=`${t.layerId}`,p=null===(o=t.sourceJSON)||void 0===o?void 0:o.geometryType;break;case nl.SubtypeSublayer:c=Xa.SubtypeSublayer,d=`${t.parent.layerId}`,p=null===(s=t.parent.sourceJSON)||void 0===s?void 0:s.geometryType,f=LT(t.parent);break;case nl.VectorTileLayer:case nl.KMLLayer:case nl.CSVLayer:case nl.GeoJSONLayer:case nl.WFSLayer:case nl.WMSLayer:case nl.WMTSLayer:break;default:const e=h;console.warn(`Unhandled case: ${e}`),c=null}let g;return c&&(g=Ye({id:e,type:c,sourceLabel:t.title||(null===(a=t.sourceJSON)||void 0===a?void 0:a.name)}),g=(null===(l=t.portalItem)||void 0===l?void 0:l.id)?g.set("portalUrl",null===(u=t.portalItem.portal)||void 0===u?void 0:u.url).set("itemId",t.portalItem.id):g,g=/^\d+$/.test(d)?g.set("layerId",d):g,g=f?g.set("url",f):g,g=p?g.set("geometryType",p):g,g=n?g.merge(n.without(...sC),{deep:!0}):g,g=r?g.set("schema",r):g),g}function uC(e,t,n,r,i){var o,s,a,l,u;if(!e||!t)return null;let c,d,p;const f=t.type;switch(f){case tl.WebMap:case tl.WebScene:case tl.CSV:case tl.GeoJSON:case tl.KML:case tl.WFS:case tl.WMS:case tl.WMTS:case tl.GroupLayer:c=Xa[hC(tl,f)],p=null===(o=t.url)||void 0===o?void 0:o.replace(/^http:/,"https:").replace(/\/$/,"");break;case tl.FeatureCollection:(null===(s=t.typeKeywords)||void 0===s?void 0:s.includes("Singlelayer"))?(c=Xa.FeatureLayer,d="0"):c=Xa.GroupLayer;break;case tl.FeatureService:case tl.MapService:case tl.SceneService:case tl.ImageService:case tl.VectorTileService:if(EC(t.url))c=fC(t.url,{isTiledImagery:(h=t.typeKeywords,null==h?void 0:h.includes("Tiled Imagery")),isElevation3DLayer:cC(t.typeKeywords)});else if(CC(t.url)){const e=fC(TC(t.url,!1));e===Xa.FeatureService||e===Xa.MapService?c=Xa.FeatureLayer:e===Xa.SceneService&&(c=Xa.SceneLayer),d=c&&(null===(a=t.url)||void 0===a?void 0:a.replace(/\/$/,"").split("/").reverse()[0])}p=c===Xa.VectorTileService?null===(l=t.url)||void 0===l?void 0:l.replace(/^http:/,"https:").replace(/\/$/,""):null===(u=t.url)||void 0===u?void 0:u.split("?")[0].replace(/^http:/,"https:").replace(/\/$/,"");break;case tl.GeocodingService:case tl.GeoenrichmentService:case tl.GeometryService:case tl.GeoprocessingService:case tl.NetworkAnalysisService:break;default:const e=f;console.warn(`Unhandled case: ${e}`),c=null}var h;let g;return c&&(g=Ye({id:e,type:c,sourceLabel:t.title}),g=g.set("itemId",t.id),g=g.set("portalUrl",n),g=/^\d+$/.test(d)?g.set("layerId",d):g,g=p?g.set("url",p):g,g=r?g.merge(r.without(...sC),{deep:!0}):g,g=i?g.set("schema",i):g),g}function cC(e){return null==e?void 0:e.includes("Elevation 3D Layer")}function dC(e,t,n,r,i){var o;if(!e||!t)return null;let s,a;const l=t,u=l.layerType;switch(u){case rl.FeatureLayer:case rl.SceneLayer:case rl.SubtypeGroupLayer:s=Xa[hC(rl,u)],a=null===(o=l.url)||void 0===o?void 0:o.replace(/\/$/,"").split("/").reverse()[0];break;case rl.GroupLayer:case rl.MapService:s=Xa[hC(rl,u)];break;case rl.TiledMapService:s=Xa.MapService;break;case rl.ImageService:s=Xa.ImageryLayer;break;case rl.TiledImageService:s=Xa.ImageryTileLayer;break;case rl.VectorTileService:case rl.CSV:case rl.GeoJSON:case rl.KML:case rl.WFS:case rl.WMS:break;default:const e=u;console.warn(`Unhandled case: ${e}`),s=null}let c;return s&&(c=Ye({id:e,type:s,sourceLabel:l.title}),c=c.set("itemId",l.itemId),c=c.set("portalUrl",n),c=/^\d+$/.test(a)?c.set("layerId",a):c,c=l.url?c.set("url",l.url.replace(/^http:/,"https:").replace(/\/$/,"")):c,c=r?c.merge(r.without(...sC),{deep:!0}):c,c=i?c.set("schema",i):c),c}function pC(e,t,n,r,i){if(!e||!t)return null;let o;if(EC(n)){o=function(e,t,n){if(!e||!t||!n)return null;const r="Elevation"===n.cacheType?{isElevation3DLayer:!0}:(o=n.capabilities,(null==o?void 0:o.includes("TilesOnly"))?{isTiledImagery:!0}:null),i=fC(t,r);var o;if(!i)return null;const s=Ye({id:e,type:i,url:TC(t,!1),sourceLabel:IC(t)});return s}(e,TC(n,!1,t),t)}else if(!n||CC(n)){o=function(e,t,n){if(!e||!n)return null;let r;const i=n.type||n.layerType;switch(i){case Za.GroupLayer:r=Xa.GroupLayer;break;case Za.FeatureLayer:r=n.subtypeField&&new RegExp(`${el.FeatureService}(\\/\\d+)?\\/?$`).test(t)?Xa.SubtypeGroupLayer:Xa.FeatureLayer;break;case Za.Table:r=Xa.FeatureLayer;break;case Za.OrientedImageryLayer:r=Xa.OrientedImageryLayer;break;case Za.SceneLayer3DObject:case Za.SceneLayerPoint:r=Xa.SceneLayer;break;case Za.BuildingSceneLayer:r=Xa.BuildingSceneLayer;break;case Za.BuildingGroupSubLayer:r=Xa.BuildingGroupSubLayer;break;case Za.BuildingComponentSubLayer:r=Xa.BuildingComponentSubLayer;break;default:const e=i;console.warn(`Unhandled case: ${e}`),r=null}let o;r&&(o=Ye({id:e,type:r,sourceLabel:n.name}),o=t?o.set("url",TC(t,!0,n)):o,o=/^\d+$/.test(`${n.id}`)?o.set("layerId",`${n.id}`):o,o=n.geometryType?o.set("geometryType",n.geometryType):o);return o}(e,TC(n,!0,t),t)}return o=r&&o?o.merge(r.without(...sC),{deep:!0}):o,o=i&&o?o.set("schema",i):o,o}function fC(e,t){if(!EC(e))return null;const n=e.split("?")[0].split("/"),r=Object.values(el).find(e=>n.some(t=>e.toLowerCase()===t.toLowerCase()));let i;switch(r){case el.FeatureService:case el.MapService:case el.SceneService:case el.VectorTileService:i=Xa[hC(el,r)];break;case el.ImageService:i=(null==t?void 0:t.isElevation3DLayer)?Xa.ElevationLayer:(null==t?void 0:t.isTiledImagery)?Xa.ImageryTileLayer:Xa.ImageryLayer;break;default:const e=r;console.warn(`Unhandled case: ${e}`),i=null}return i}function hC(e,t){var n;return null===(n=Object.entries(e).find(([e,n])=>n===t))||void 0===n?void 0:n[0]}var gC,mC=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function vC(e,t,n,r){return mC(this,void 0,void 0,function*(){return yield yC(e,t,n,r).then(e=>mC(this,void 0,void 0,function*(){return e?yield fA.getInstance().fetchServiceInfo(e).then(e=>e.definition).then(t=>t?{def:t,url:e}:null):yield Promise.resolve(null)}))})}function yC(e,t,n,r){return mC(this,void 0,void 0,function*(){return e||n?n?yield bC(n,r).then(n=>mC(this,void 0,void 0,function*(){if(!n)return yield wC(SC(e),e,t);const r=n.url;return yield wC(r,e,t)})):yield wC(SC(e),e,t):yield Promise.resolve(null)})}function SC(e){return TC(e,!1).replace(`/${el.SceneService}`,`/${el.FeatureService}`)}function bC(e,t){return mC(this,void 0,void 0,function*(){if(!e)return yield Promise.resolve(null);const n={id:e,relationshipType:"Service2Service",direction:"reverse",authentication:Tv.getInstance().getSessionByUrl(t)};return yield _i(n).then(e=>{var t;return(null===(t=null==e?void 0:e.relatedItems)||void 0===t?void 0:t.find(e=>e.type===tl.FeatureService))||null})})}function wC(e,t,n){return mC(this,void 0,void 0,function*(){const r=TC(t,!1),i=TC(e,!1);return yield Promise.all([fA.getInstance().fetchServiceInfo(r),fA.getInstance().fetchServiceInfo(i)]).then(e=>{var t,r;const o=null===(t=e[0].definition)||void 0===t?void 0:t.layers,s=null===(r=e[1].definition)||void 0===r?void 0:r.layers;if(!Array.isArray(s))return null;const a=parseInt(n);if(Array.isArray(o))for(let e=0;e<Math.min(o.length,s.length);e++){if(o[e].id===a)return`${i}/${s[e].id}`}else if(a<s.length)return`${i}/${s[a].id}`;return null}).catch(e=>(console.debug("Can not find associated feature layer, ",t),null))})}function IC(e){if(!OC(e))return"";const t=decodeURI(e).split("/"),n=t.findIndex(e=>Object.values(el).some(t=>t.toLowerCase()===e.toLowerCase()))-1;return t[n]}function EC(e){return!(!OC(e)||CC(e))}function OC(e,t){if(!e||!/^(http(s)?:)?\/\//.test(e))return!1;const n=TC(e,!1),r=null==n?void 0:n.split("/");return!(!r||!Object.values(el).some(e=>r[r.length-1].toLowerCase()===e.toLowerCase())||t&&!t.some(e=>r[r.length-1].toLowerCase()===e.toLowerCase()))}function CC(e){if(!OC(e))return!1;return!!(e=e.split("?")[0]).split("/").find(e=>e.toLowerCase()===el.SceneService.toLowerCase())?/\/layers\/\d+\/?$/.test(e)||/\/sublayers\/\d+\/?$/.test(e):/\/\d+\/?$/.test(e)}function TC(e,t,n){if(!e||t&&!n)return null;const r=e.split("?")[0].replace(/^http:/,"https:").replace(/\/$/,"").split("/"),i=r.findIndex(e=>Object.values(el).some(t=>t.toLowerCase()===e.toLowerCase()));if(-1===i)return null;const o=r.slice(0,i+1).join("/");if(t){if(null==n.id)return null;return!!o.split("/").find(e=>e.toLowerCase()===el.SceneService.toLowerCase())?`${o}/layers/${n.id}`:`${o}/${n.id}`}return o}function xC(e){return Nx(e)}function AC(e,t){if(!e||!t)return"";const n=e;switch(n){case Qa.Error:return t.formatMessage({id:"widgetLoadError",defaultMessage:Xg.widgetLoadError});case Qa.FeatureLayer:return t.formatMessage({id:"featureLayer",defaultMessage:Xg.featureLayer});case Qa.FeatureService:return t.formatMessage({id:"featureService",defaultMessage:Xg.featureService});case Qa.MapService:return t.formatMessage({id:"mapService",defaultMessage:Xg.mapService});case Qa.GroupLayer:return t.formatMessage({id:"groupLayer",defaultMessage:Xg.groupLayer});case Qa.Map:return t.formatMessage({id:"map",defaultMessage:Xg.map});case Qa.SimpleLocal:return t.formatMessage({id:"simpleLocal",defaultMessage:Xg.simpleLocal});case Qa.WebMap:return t.formatMessage({id:"webMap",defaultMessage:Xg.webMap});case Qa.WebScene:return t.formatMessage({id:"webScene",defaultMessage:Xg.webScene});case Qa.CSV:return t.formatMessage({id:"csv",defaultMessage:Xg.csv});case Qa.SceneService:return t.formatMessage({id:"sceneService",defaultMessage:Xg.sceneService});case Qa.SceneLayer:return t.formatMessage({id:"sceneLayer",defaultMessage:Xg.sceneLayer});case Qa.ImageryLayer:return t.formatMessage({id:"imageryLayer",defaultMessage:Xg.imageryLayer});case Qa.ImageryTileLayer:return t.formatMessage({id:"imageryTileLayer",defaultMessage:Xg.imageryTileLayer});case Qa.ElevationLayer:return t.formatMessage({id:"elevationLayer",defaultMessage:Xg.elevationLayer});case Qa.OrientedImageryLayer:return t.formatMessage({id:"orientedImageryLayer",defaultMessage:Xg.orientedImageryLayer});case Qa.SubtypeGroupLayer:return t.formatMessage({id:"SubtypeGroupLayer",defaultMessage:Xg.SubtypeGroupLayer});case Qa.SubtypeSublayer:return t.formatMessage({id:"SubtypeSublayer",defaultMessage:Xg.SubtypeSublayer});case Qa.VectorTileService:return t.formatMessage({id:"vectorTileService",defaultMessage:Xg.vectorTileService});case Qa.WFS:return t.formatMessage({id:"wfsLayer",defaultMessage:Xg.wfsLayer});case Qa.WMS:return t.formatMessage({id:"wmsLayer",defaultMessage:Xg.wmsLayer});case Qa.WMTS:return t.formatMessage({id:"wmtsLayer",defaultMessage:Xg.wmtsLayer});case Qa.KML:return t.formatMessage({id:"kml",defaultMessage:Xg.kml});case Qa.GeoJSON:return t.formatMessage({id:"geojson",defaultMessage:Xg.geojson});case Qa.BuildingSceneLayer:return t.formatMessage({id:"buildingScene",defaultMessage:Xg.buildingScene});case Qa.BuildingGroupSubLayer:return t.formatMessage({id:"buildingGroup",defaultMessage:Xg.buildingGroup});case Qa.BuildingComponentSubLayer:return t.formatMessage({id:"buildingComponent",defaultMessage:Xg.buildingComponent});default:throw new Error(`Unhandled case: ${n}`)}}function DC(e){const t=e&&e.type,n=mA.getInstance().getDataSource(null==e?void 0:e.id),r=function(e){if(e){if(e.toLowerCase().includes(gC.Point.toLowerCase()))return gC.Point;if(e.toLowerCase().includes(gC.Polyline.toLowerCase()))return gC.Polyline;if(e.toLowerCase().includes(gC.Polygon.toLowerCase()))return gC.Polygon}return null}(n?n.getGeometryType():null==e?void 0:e.geometryType),i=function(e){if(!e)return!1;const t=mA.getInstance().getDataSource(e.id),n=t&&t.supportSpatialInfo&&!t.supportSpatialInfo();return n}(e),o=function(e,t,n){if(e===Qa.FeatureLayer)return n?`${e}_${Za.Table}`:t?`${e}_${t}`:e;return e}(t,r,i);switch(o){case Qa.WebMap:return a(3195);case Qa.WebScene:return a(2529);case`${Qa.FeatureLayer}_${gC.Point}`:return a(4203);case`${Qa.FeatureLayer}_${gC.Polyline}`:return a(2773);case`${Qa.FeatureLayer}_${gC.Polygon}`:return a(819);case`${Qa.FeatureLayer}_${Za.Table}`:return a(8249);case Qa.FeatureLayer:return a(914);case Qa.FeatureService:return a(1330);case Qa.MapService:return a(2618);case Qa.GroupLayer:return a(2443);case Qa.SceneService:return a(8964);case Qa.SceneLayer:return a(7442);case Qa.CSV:return a(6374);case Qa.GeoJSON:return a(1219);case Qa.ImageryLayer:return a(4882);case Qa.ImageryTileLayer:return a(1539);case Qa.ElevationLayer:return a(4931);case Qa.OrientedImageryLayer:return a(4041);case Qa.KML:return a(8030);case Qa.VectorTileService:return a(5033);case Qa.WFS:return a(8816);case Qa.WMS:return a(8629);case Qa.WMTS:return a(133);case Qa.BuildingSceneLayer:return a(3509);case Qa.BuildingGroupSubLayer:return a(880);case Qa.BuildingComponentSubLayer:return a(4644);case Qa.SubtypeGroupLayer:return a(4558);case Qa.SubtypeSublayer:return a(4308);default:return a(8427)}}!function(e){e.Point="POINT",e.Polyline="POLYLINE",e.Polygon="POLYGON"}(gC||(gC={}));var RC=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const PC=10;function jC(e){return RC(this,void 0,void 0,function*(){var t,n;const{searchFields:r,dataSource:i,maxSuggestions:o,searchText:s}=e;if(e.searchText=null==s?void 0:s.trim(),!r||0===(null==r?void 0:r.length)||!i)return[];return(null===(n=null===(t=i.getLayerDefinition())||void 0===t?void 0:t.advancedQueryCapabilities)||void 0===n?void 0:n.supportsFullTextSearch)?function(e,t){return RC(this,void 0,void 0,function*(){var n;if(!t)return Promise.resolve({fields:[],fullTextField:[]});if(!e)return Promise.resolve({fields:t,fullTextField:[]});let r=(null===(n=e.getLayerDefinition())||void 0===n?void 0:n.indexes)||[];r=r.filter(e=>"FullText"===(null==e?void 0:e.indexType));const i=[],o=[];return GC(e,t).forEach(e=>{if(e.esriType!==Ma.GlobalID&&e.type===_a.String){let t=!1;null==r||r.forEach(n=>{var r;(null===(r=n.fields)||void 0===r?void 0:r.split(", ").includes(e.name))&&(t=!0)}),t?o.push(e):i.push(e)}else i.push(e)}),Promise.resolve({fields:FC(i),fullTextField:FC(o)})})}(i,r).then(t=>{const n=t.fields||[],r=t.fullTextField||[],i=[LC(Object.assign(Object.assign({},e),{searchFields:n})),_C(Object.assign(Object.assign({},e),{searchFields:r}))];return Promise.all(i).then(e=>{let t=e[0].concat(e[1]);return t=t.splice(0,o||PC),Promise.resolve(t)})}):LC(e,o)})}function LC(e){return RC(this,arguments,void 0,function*(e,t=PC){var n,r;const{searchText:i,searchFields:o,dataSource:s,extent:a}=e;if(!o||0===o.length)return Promise.resolve([]);const l=null===(r=null===(n=s.getLayerDefinition())||void 0===n?void 0:n.advancedQueryCapabilities)||void 0===r?void 0:r.supportsDistinct,u=$C(i,o,s,!1,tO.Or,rO.StringOperatorStartsWith),c={outFields:o,returnDistinctValues:!!l,returnGeometry:!1,orderByFields:null,where:u.sql||"1=0",sqlExpression:u};if(a){const e=a?a.toJSON():{};c.geometry=e}return MC(c,e,t)})}function _C(e){return RC(this,void 0,void 0,function*(){var t,n;const{searchText:r,searchFields:i,dataSource:o,extent:s}=e;if(!i||0===i.length)return Promise.resolve([]);const a=null===(n=null===(t=o.getLayerDefinition())||void 0===t?void 0:t.advancedQueryCapabilities)||void 0===n?void 0:n.supportsDistinct,l=o.getCurrentQueryParams(),u=function(e,t){var n;const r=[];return null===(n=null==t?void 0:t.split(" "))||void 0===n||n.forEach(t=>{if(t&&t.length>1){const n={onFields:e,searchTerm:t,searchType:"prefix"};r.push(n)}}),r}(i,r),c={fullText:u,where:l.where||"1=1",geometry:l.geometry,returnDistinctValues:!!a,orderByFields:null,returnGeometry:!1,outFields:i};if(s){const e=s?s.toJSON():{};c.geometry=e}return MC(c,e,null,!0)})}function MC(e,t){return RC(this,arguments,void 0,function*(e,t,n=PC,r=!1){const{searchText:i,dataSource:o,searchFields:s}=t;return(r?kC(e,o):function(e,t){return RC(this,void 0,void 0,function*(){return t?yield t.query(e,{scope:il.InRuntimeView}).then(e=>RC(this,void 0,void 0,function*(){return yield function(e,t){return RC(this,void 0,void 0,function*(){return yield Promise.resolve((null==t?void 0:t.records)||[])})}(0,e)})):yield Promise.resolve([])})}(e,o)).then(e=>RC(this,void 0,void 0,function*(){let t=[];return s.forEach(n=>{e.forEach(e=>{const s=Tb();let a,l;r?a=function(e,t,n){const r=Tb(),i=e.buildRecord(t),o=i.getFormattedFieldValue(n,r),s=e.dataViewId===Ad;if(s){const t=e.getSelectedRecords().map(e=>e.getFormattedFieldValue(n,r));return(null==t?void 0:t.includes(o))?o:null}return o}(o,e,n):(a=e.getFormattedFieldValue(n,s),l=e.getFieldValue(n));const u=function(e,t,n){const r=NC(e),i=VC(e);let o=(null==t?void 0:t.match(r))||`${n}`.match(r);if(i){const e=NC(`${i}`);o=o||(null==t?void 0:t.match(e))||`${n}`.match(e)}return o}(i,a,l);if(a&&!UC(t,a)&&u){const e={suggestionHtml:BC(a,i),suggestion:a,fieldName:n};t.push(e)}})}),t=function(e,t){const n=e[0]?[e[0]]:[];for(let r=1;r<e.length;r++){const i=e[r];let o=!1;for(let e=0;e<n.length;e++)if(i[t]===n[e][t]){o=!0;break}o||n.push(i)}return n}(t,"suggestion"),n&&(t=t.splice(0,n)),Promise.resolve(t)})).catch(e=>(console.error(e),Promise.resolve([])))})}function NC(e){const t=function(e){const t=e.trim().split(/\s+/);return t.filter(e=>e.length>0)}(e);return new RegExp(`(${t.join("|")})`,"gi")}function kC(e,t){return RC(this,void 0,void 0,function*(){const n=t.getDataSourceJson().url;return eA(n,t=>RC(this,void 0,void 0,function*(){return yield Pr(`${n}/query`,{params:e,authentication:t,httpMethod:"GET"}).then(e=>Promise.resolve((null==e?void 0:e.features)||[])).catch(e=>Promise.resolve([]))}))})}function UC(e,t){return e.filter(e=>t===(null==e?void 0:e.suggestion)).length>0}function FC(e){return e?e.map(e=>e.name):[]}function BC(e,t){if(!t)return e;const n=NC(t);return e.match(n)?e.replace(n,"<strong >$&</strong>"):e}function $C(e,t,n,r=!1,i=tO.Or,o=rO.StringOperatorContains){if(e=null==e?void 0:e.trim(),t){const s=[];return GC(n,t).forEach(t=>{let i=e;const a=null==n?void 0:n.getFieldCodedValueList(null==t?void 0:t.name);if(a&&(null==a||a.forEach(e=>{i===(null==e?void 0:e.label)&&(i=null==e?void 0:e.value)})),t.type===_a.Number){const e=VC(i);e&&(i=e)}const l=(null==e?void 0:e.length)>0&&!isNaN(Number(i))&&isFinite(Number(i));if(t.type===_a.Number&&!l)return!1;t.type===_a.String&&t.esriType===Ma.GlobalID&&(r=!0);const u=function(e,t,n=rO.StringOperatorContains){let r;e===_a.Number?r=rO.NumberOperatorIs:e===_a.String&&(r=t?rO.StringOperatorIs:n);return r}(t.type,r,o),c=t.type===_a.Number?Number(i):i,d=eC(null==t?void 0:t.name,u,[{value:c,label:c+""}],r);s.push(d)}),nC(i,s,n)}}function VC(e){var t;if("string"!=typeof e)return e;return e=(e="."===(Ab(null!==(t=TE().getState().appContext.locale)&&void 0!==t?t:"en")||".")?e.replace(/,/g,""):e.replace(/\./g,"")).replace(/\s/g,""),Number(e)}function GC(e,t){var n;if(!e||!t)return[];const r=(null===(n=null==e?void 0:e.getSchema())||void 0===n?void 0:n.fields)||{},i=[];for(const e in r)t.includes(r[e].name)&&i.push(r[e]);return i}var WC=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function HC(e,t){return WC(this,void 0,void 0,function*(){const n=yield Bg("esri/geometry/support/jsonUtils"),r=e&&e[0]&&e[0].getGeometry();if(!r||t.equals(r.spatialReference))return Promise.resolve(e);return zC(e.map(e=>n.fromJSON(e.getGeometry())),t).then(t=>t.map((t,n)=>{const r=e[n]&&e[n].clone();return r.setGeometry(t),r}))})}function zC(e,t){return WC(this,void 0,void 0,function*(){return e&&0!==e.length&&e[0]&&t.wkid!==e[0].spatialReference.wkid&&!t.equals(e[0].spatialReference)?yield Fg(["esri/rest/geometryService","esri/rest/support/ProjectParameters","esri/geometry/operators/projectOperator"]).then(n=>WC(this,void 0,void 0,function*(){var r,i;let o,s,a;if([o,s,a]=n,a.isLoaded()&&(null===(i=null===(r=e[0])||void 0===r?void 0:r.spatialReference)||void 0===i?void 0:i.wkid)){const n=function(e,t,n){return n.executeMany(e,t)}(e,t,a);return n&&n[0]?yield Promise.resolve(n):yield JC(e,t,o,s).then(e=>WC(this,void 0,void 0,function*(){return yield Promise.resolve(e)}),e=>WC(this,void 0,void 0,function*(){return console.error(e),yield Promise.reject(new Error(e))}))}return a.load(),yield JC(e,t,o,s).then(e=>WC(this,void 0,void 0,function*(){return yield Promise.resolve(e)}),e=>WC(this,void 0,void 0,function*(){return console.error(e),yield Promise.reject(new Error(e))}))})):yield Promise.resolve(e)})}function qC(e,t,n){return WC(this,void 0,void 0,function*(){const r=Array.isArray(e)?e[0]:e,i=new(yield Bg("esri/geometry/SpatialReference"))("function"==typeof r.spatialReference.toJSON?r.spatialReference.toJSON():r.spatialReference);if(i.isGeographic&&!i.isWGS84){const i=Xb(),[o,s]=yield Fg(["esri/rest/geometryService","esri/rest/support/BufferParameters"]);return yield o.buffer(i,new s({distances:t,unit:n,geodesic:!0,bufferSpatialReference:r.spatialReference,outSpatialReference:r.spatialReference,geometries:Array.isArray(e)?e:[e]}))}{if(i.isWGS84||i.isWebMercator){const r=yield Bg("esri/geometry/operators/geodesicBufferOperator");return r.isLoaded()||(yield r.load()),Array.isArray(e)?r.executeMany(e,t,{unit:n}):r.execute(e,t[0],{unit:n})}const r=yield Bg("esri/geometry/operators/bufferOperator");return Array.isArray(e)?r.executeMany(e,t,{unit:n}):r.execute(e,t[0],{unit:n})}})}function JC(e,t,n,r){return WC(this,void 0,void 0,function*(){const i=Xb(),o=new r({geometries:e,outSpatialReference:t});return yield n.project(i,o)})}function KC(e,t){return WC(this,void 0,void 0,function*(){const n=yield Bg("esri/geometry/support/jsonUtils");let r=null;if(e)if(e.declaredClass)r=t?e.clone():e;else try{r=n.fromJSON(e)}catch(e){r=null,console.error("can not get geometry instance by geometry json",e)}return r})}var YC=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const XC={};function QC(e){return YC(this,void 0,void 0,function*(){var t,n;(e=Object.assign({},e)).query=Object.assign({},e.query);let{widgetId:r,ds:i,query:o,selectionMode:s,signal:a,jimuLayerView:l,updateSelectionIfAborted:u}=e;if(!e.query.outSR){const t=function(e,t){var n,r,i,o;let s=null===(r=null===(n=e.layer)||void 0===n?void 0:n.spatialReference)||void 0===r?void 0:r.toJSON();!s&&t&&(s=null===(o=null===(i=t.layer)||void 0===i?void 0:i.spatialReference)||void 0===o?void 0:o.toJSON());return s}(i,l);t&&(e.query.outSR=t)}const c=o.outFields||[],d=i.getAllUsedFields()||[];let p=[];const f=l&&l.view;f&&(null===(t=f.availableFields)||void 0===t?void 0:t.length)>0&&(p=null===(n=f.availableFields)||void 0===n?void 0:n.slice()),p||(p=[]);let h=c.concat(d).concat(p);if(h=Array.from(new Set(h)),h.includes("*")&&(h=["*"]),o.outFields=h,!a){a=(new AbortController).signal}const g=i.id,m=XC[g];if(m){const e=new Event("abort");m.dispatchEvent(e)}XC[g]=a;const v=yield function(e){return YC(this,void 0,void 0,function*(){let t=[],{ds:n,query:r,selectionMode:i,signal:o,jimuLayerView:s,checkLayerVisibility:a,progressCallback:l}=e;return new Promise(e=>YC(this,void 0,void 0,function*(){if(r=Object.assign({},r),r.geometry&&(r.geometry.toJSON&&(r.geometry=r.geometry.toJSON()),!r.geometryType)){const e=!1,t=yield KC(r.geometry,e);if(t){const e=hO(t.type);e&&(r.geometryType=e)}}const u=Jm(r),c=Ye(u);let d=!1,p=!1;function f(){return{queryParams:c,records:t,isAborted:p}}function h(){if(!d){o&&o.removeEventListener("abort",g,!1),d=!0;const t=f();e(t)}}function g(){p=!0}function m(e){if(l){const t=.95*e,n=f();l(t,n)}}if(o&&o.addEventListener("abort",g,!1),a&&s&&!s.isLayerVisible())h();else{try{if(i===sl.New){const e=yield n.queryAll(r,o,m);t=(null==e?void 0:e.records)||[]}else{const e=n.getSelectedRecords(),s=e.map(e=>e.getId()),a=yield n.queryIds(r),l=(null==a?void 0:a.ids)||[];if(p)return void h();if(i===sl.AddToCurrent){const i=.1,a=1-i;m(i);const u={};s.forEach(e=>{u[e]=!0});const c=l.filter(e=>!u[e]);if(c.length>0){const s=Jm(r);delete s.geometry,delete s.where,s.objectIds=c;const l=yield n.queryAll(s,o,e=>{m(i+a*e)}),u=(null==l?void 0:l.records)||[];t=[...e,...u]}else t=e}else{m(.5);const n={};l.forEach(e=>{n[e]=!0}),i===sl.RemoveFromCurrent?t=e.filter(e=>{const t=e.getId();return!n[t]}):i===sl.SelectFromCurrent&&(t=e.filter(e=>{const t=e.getId();return n[t]}))}}}catch(e){console.error("query features from server error by selection mode",e)}h()}}))})}(e),y=(null==v?void 0:v.records)||[],S={widgetId:r,records:y};if(y.length>0){let e=null;s===sl.New&&(o.where||o.geometry)&&(e={},o.where&&(e.where=o.where),o.geometry&&(e.geometry=o.geometry),o.spatialRel&&(e.spatialRel=o.spatialRel)),e?S.queryParams=e:S.ids=y.map(e=>e.getId())}let b=!0;return b=a===XC[g]&&(!a.aborted||u()),b?i.selectRecords(S):null})}var ZC=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const eT=a(430),tT=["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger","esriFieldTypeSingle","esriFieldTypeDouble"],nT=["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"];function rT(e){return ZC(this,void 0,void 0,function*(){return yield eA(e.url,t=>ZC(this,void 0,void 0,function*(){const n=(null==t?void 0:t.token)?{httpMethod:"GET",params:{token:null==t?void 0:t.token}}:{httpMethod:"GET"};return e.url?yield Pr(`${e.url}/${e.featureId}/attachments`,n).then(e=>ZC(this,void 0,void 0,function*(){return yield Promise.resolve(e.attachmentInfos)})):yield Promise.reject(new Error(null))}),1)})}function iT(e,t){return ZC(this,void 0,void 0,function*(){return yield eA(t.url,n=>ZC(this,void 0,void 0,function*(){if(t&&t.attachmentTypes&&t.attachmentTypes.length>0){const r=[];for(let i=0;i<e.length;i++)t.attachmentTypes.includes(e[i].contentType)&&(e[i].url=`${t.url}/${t.featureId}/attachments/${e[i].id}`+((null==n?void 0:n.token)?`?token=${null==n?void 0:n.token}`:""),r.push(e[i]));return yield Promise.resolve(r)}for(let r=0;r<e.length;r++)e[r].url=`${t.url}/${t.featureId}/attachments/${e[r].id}`+((null==n?void 0:n.token)?`?token=${null==n?void 0:n.token}`:"");return yield Promise.resolve(e)}),1)})}function oT(e,t){let n;return tT.includes(e.type)?n=_a.Number:nT.includes(e.type)?n=_a.String:"esriFieldTypeDate"===e.type?n=_a.Date:"esriFieldTypeDateOnly"===e.type?n=_a.DateOnly:"esriFieldTypeTimeOnly"===e.type&&(n=_a.TimeOnly),n?{jimuName:e.name,name:e.name,type:n,esriType:e.type,alias:(null==t?void 0:t.label)||e.alias,format:(null==t?void 0:t.format)||("esriFieldTypeOID"===e.type?{digitSeparator:!1,places:0}:null)}:null}function sT(e){return!e||"esriFieldTypeDate"===e.type||"esriFieldTypeDateOnly"===e.type||"esriFieldTypeTimeOnly"===e.type}function aT(e){return tT.includes(e)}function lT(e,t){let n=null;return e&&e.length>0&&e.some(e=>e.name===t&&(n=e,!0)),n}function uT(e,t,n){const r=n[t],i=e.subtypeField||e.typeIdField;let o,s;n.hasOwnProperty(i)&&(o=n[i]);const a=lT(e.fields,t);if(sT(a))return{isCodedValueOrSubtype:!1};s=null!=o?mT(e,t,o,a):yT(e,a);const l=gT(r,s),u=[{value:n[t],label:l.displayValue}];return l.displayValue=ST(e,u,t)[0].label,l}function cT(e,t,n){if(1===n.length){return[uT(e,t,n[0])]}const r=e.subtypeField||e.typeIdField;let i=null,o=null,s=[],a=[];const l=lT(e.fields,t);if(sT(l))return a;for(const u of n){const n=u,c=n[t];if(r===t)s=i||fT(e);else if(n.hasOwnProperty(r)){if(!o){o={},i=fT(e);for(const n of i){const r=n.value;o[r]=mT(e,t,r,l)}}s=o[n[r]],s||(s=hT(l))}else s=yT(e,l);const d=gT(c,s);a.push(d)}return a=ST(e,a,t,"displayValue"),a}function dT(e,t,n){let r=null;if(!e)return r;const i=lT(e.fields,t);if(sT(i))return r;const o=e.subtypeField||e.typeIdField,s=n?n[o]:null,a=n&&null!=s;if((null==o?void 0:o.toUpperCase())===t.toUpperCase()){if(r=fT(e),a){const e=gT(s,r);r=[{value:e.value,label:e.displayValue}]}}else r=a?mT(e,t,s,i):yT(e,i);return r=ST(e,r,t),r}function pT(e,t){let n=!1;return e&&e.fields&&0!==e.fields.length?(t.some(t=>{var r,i;const o=e.fields.filter(e=>e.name===t)[0];if(!o)return!1;const s=(null===(i=null===(r=o.domain)||void 0===r?void 0:r.codedValues)||void 0===i?void 0:i.map(e=>e&&{value:e.code,label:e.name}))||[],a=dT(e,t);if(null===a)return!1;if(s.length!==a.length)return n=!0,!0;{let e,t;return o.type===Ma.String?(e=s.sort((e,t)=>{var n;return null===(n=e.value)||void 0===n?void 0:n.localeCompare(t.value,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})}),t=a.sort((e,t)=>{var n;return null===(n=e.value)||void 0===n?void 0:n.localeCompare(t.value,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})})):(e=s.sort((e,t)=>e.value-t.value),t=a.sort((e,t)=>e.value-t.value)),e.some((e,r)=>(e.value!==t[r].value||e.label!==t[r].label)&&(n=!0,!0)),n}}),n):n}function fT(e){let t=null;const n=e.subtypeField||e.typeIdField,r=e.subtypes||e.types;return n&&(null==r?void 0:r.length)>0&&(t=[],Object.keys(r).forEach(e=>{var n;t.push({value:null!==(n=r[e].code)&&void 0!==n?n:r[e].id,label:r[e].name})})),t}function hT(e){let t=null;if(!e)return t;const n=e.domain;return n&&"codedValue"===n.type&&n.codedValues&&n.codedValues.length>0&&(t=[],n.codedValues.forEach(e=>{t.push({value:e.code,label:e.name})})),t}function gT(e,t){let n={isCodedValueOrSubtype:!1,displayValue:e+""};t&&t.length>0&&t.some(t=>t.value===e&&(n={isCodedValueOrSubtype:!0,displayValue:t.label},!0));return Object.assign(n,{value:e})}function mT(e,t,n,r){let i=null;if(!(r=r||lT(e.fields,t)))return i;const o=e.subtypeField||e.typeIdField,s=e.subtypes||e.types;return o&&(null==s?void 0:s.length)>0?(s.some(e=>{var s;const a=null!==(s=e.code)&&void 0!==s?s:e.id;if(a===n){if(t===o)i=[{value:a,label:e.name}];else if(e.domains&&e.domains[t]){const n=e.domains[t];"inherited"===n.type?i=hT(r):n.codedValues&&n.codedValues.length>0&&(i=[],n.codedValues.forEach(e=>{i.push({value:e.code,label:e.name})}))}else e.domains&&(i=hT(r));return!0}return!1}),i||(i=hT(r))):i=hT(r),i}function vT(e,t,n){return e[t]?n===e[t]||(e[t]=e[t]+", "+n):e[t]=n,e}function yT(e,t){let n=null;if(!t)return n;const r=t.name;let i={},o=!0;const s=e.subtypeField||e.typeIdField,a=e.subtypes||e.types;s&&(null==a?void 0:a.length)>0?Object.keys(a).forEach(e=>{const n=a[e];if(n.domains&&n.domains[r]){const e=n.domains[r];if("inherited"===e.type){if(o){o=!1;const e=hT(t);null==e||e.forEach(e=>{i=vT(i,e.value,e.label)})}}else e.codedValues&&e.codedValues.length>0&&e.codedValues.forEach(e=>{i=vT(i,e.code,e.name)})}}):n=hT(t);const l=[];for(const e in i){const n=aT(t.type)?parseFloat(e):e;l.push({value:n,label:i[e]})}return l.length>0&&(n=l),n}function ST(e,t,n,r="label"){const i=function(e,t){let n=null,r=null;const i=bT(e);let o;if(i)n={},r=i.uniqueValueInfos,o=i;else{const t=e;if(t.renderer){const e=bT(t.sourceJSON),i=t.renderer.toJson();"uniqueValue"===i.type&&e&&e.field1===i.field1&&e.field2===i.field2?(n={},r=i.uniqueValueInfos,o=i):e&&(n={},r=e.uniqueValueInfos,o=e)}}if(r){let e=null;if(t===i.field1?e=0:t===i.field2?e=1:t===i.field3&&(e=2),null===e)return null;for(let t=0;t<r.length;t++){const i=r[t];if(o.field2){const t=i.value.split(","),r=i.label.split(",");n[t[e]]=r[e]}else n[i.value]=i.label}}return n}(e,n);if(i&&t)for(let e=0;e<t.length;e++)i[t[e].value]&&(t[e][r]=i[t[e].value]);return t}function bT(e){var t,n;let r=null;return"uniqueValue"===(null===(n=null===(t=e.drawingInfo)||void 0===t?void 0:t.renderer)||void 0===n?void 0:n.type)&&(r=e.drawingInfo.renderer),r}function wT(e){const t=rI(e);if(!t)return!1;const n=t.endsWith(".arcgis.com"),r=t.startsWith("services")||t.startsWith("tiles")||t.startsWith("features")||/^[a-z\d-]+\.svcs(?:qa|dev)?\./.test(t);return n&&r}function IT(e){return null==e?void 0:e.replace(/\s/g,"_")}function ET(e){var t,n;if(!e)return null;const r=null!==(n=null!==(t=e.id)&&void 0!==t?t:e.title)&&void 0!==n?n:e.name;return void 0===r?null:IT(`${r}`)}function OT(e){var t,n,r,i,o,s;if(!e)return null;const a=null!==(s=null!==(o=null!==(i=null!==(n=null===(t=e.source)||void 0===t?void 0:t.mapLayerId)&&void 0!==n?n:null===(r=e.sourceJSON)||void 0===r?void 0:r.id)&&void 0!==i?i:e.id)&&void 0!==o?o:e.title)&&void 0!==s?s:e.name;return void 0===a?null:IT(`${a}`)}function CT(e){var t,n;if(!e)return null;const r=null!==(n=null!==(t=e.id)&&void 0!==t?t:e.name)&&void 0!==n?n:e.title;return void 0===r?null:IT(`${r}`)}function TT(e){var t;if(!e)return null;const n=null!==(t=e.name)&&void 0!==t?t:e.id;return void 0===n?null:IT(`${n}`)}function xT(e){return(null==e?void 0:e.type)&&Object.values(nl).some(t=>t===e.type)}function AT(e){return e.sort((e,t)=>{var n;return null===(n=(null==e?void 0:e.getLabel)?e.getLabel():(null==e?void 0:e.label)||(null==e?void 0:e.sourceLabel))||void 0===n?void 0:n.localeCompare((null==t?void 0:t.getLabel)?t.getLabel():(null==t?void 0:t.label)||(null==t?void 0:t.sourceLabel),null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})})}function DT(e,t){return`${e}-${t}`}function RT(e){const{field:t,dataSource:n,dataSourceId:r,sqlExpression:i,queryScope:o=il.InConfigView,widgetId:s,sortOrder:a=ol.Asc}=e,l=[{customSQL:`${t.name} IS NOT NULL`,customDisplaySQL:`${t.name} IS NOT NULL`}];t.type===_a.String&&l.push({customSQL:`CHAR_LENGTH(${t.name}) > 0`,customDisplaySQL:`CHAR_LENGTH(${t.name}) > 0`});const u=nC(tO.And,l,n),c=i?rC([i,u],n,tO.And):u,d=[`${t.name} ${a}`],p={queryParams:{where:c.sql,sqlExpression:c,returnGeometry:!1,outFields:[t.name],orderByFields:d,returnDistinctValues:!0},queryOptions:{scope:o,widgetId:s||"advanced_select_query"}};return s&&(p.queryOptions.excludeQuery={dataSourceId:r,widgetId:s}),p}function PT(e){return ZC(this,void 0,void 0,function*(){const{field:t,dataSource:n}=e;if(!t)return 0;const r=n,i=RT(Object.assign(Object.assign({},e),{dataSourceId:n.belongToDataSource.id}));return yield r.loadCount(i.queryParams,i.queryOptions).then(e=>e)})}function jT(e){return ZC(this,void 0,void 0,function*(){const{field:t,dataSource:n,pageSize:r,sortType:i,sortOrder:o}=e,s=[];if(!t)return{list:s};const a=Tb(),l=["undefined"];t.type===_a.Number&&l.push("nan");const u=n,c=RT(Object.assign(Object.assign({},e),{dataSourceId:n.belongToDataSource.id,sortOrder:o}));return c.queryParams.page=1,c.queryParams.pageSize=r,yield u.load(c.queryParams,c.queryOptions).then(e=>{const n={},r={};return e?(e.forEach(e=>{const i=e,o=i.feature.attributes[t.jimuName];if(!(o in n)&&(n[o]=!0,0===l.filter(e=>(o+"").trim().toLowerCase()===e).length)){const e=i.getFormattedFieldValue(t.jimuName,a);t.type===_a.Date?(e in r||s.push({value:o,label:e}),r[e]=!0):s.push({value:o,label:e})}}),"LABEL"===i&&s.sort((e,t)=>e.label.localeCompare(t.label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})),{list:s,recordLength:t.type===_a.Date?e.length:s.length}):null})})}function LT(e){let t=null==e?void 0:e.url;return t?(t=null!==e.layerId&&void 0!==e.layerId?e.type===nl.SceneLayer?e.url+"/layers/"+e.layerId:e.url+"/"+e.layerId:e.url,t=t.replace(/^http:/,"https:"),t):null}function _T(e,t){const n=mA.getInstance();let r;return r=t?e.dataViewId?n.getLocalDataSourceId(n.getDataViewDataSourceId(e.mainDataSourceId,e.dataViewId),t):n.getLocalDataSourceId(e.mainDataSourceId,t):e.dataSourceId,r}function MT(e){var t;return e?{dataSourceId:e.id,mainDataSourceId:e.getMainDataSource().id,dataViewId:e.dataViewId,rootDataSourceId:null===(t=e.getRootDataSource())||void 0===t?void 0:t.id}:null}function NT(e){return ZC(this,void 0,void 0,function*(){var t;const n=null==e?void 0:e.getDataSourceJson();if(null==n?void 0:n.sourceLabel)return n.sourceLabel;const r=(null==e?void 0:e.getServiceDefinition)?e.getServiceDefinition():null===(t=null==e?void 0:e.getLayerDefinition)||void 0===t?void 0:t.call(e),i=null==e?void 0:e.layer;let o=null==r?void 0:r.name;return i?o=i.title||o:(null==n?void 0:n.itemId)&&!e.parentDataSource&&e.fetchItemInfo&&(o=yield e.fetchItemInfo().then(e=>(null==e?void 0:e.title)||o).catch(e=>(console.warn("Can not get item info. ",e,n.itemId,n.portalUrl),o))),o})}function kT(e){var t;let n,r=e;for(;null===(t=null==r?void 0:r.declaredClass)||void 0===t?void 0:t.includes("layer");)n=n?`${IT(r.id+"")}-${n}`:IT(r.id+""),r=r.parent;return n}function UT(e,t){if(!e)return null;const n=e.getMainDataSource(),r=e=>{var t,r;return!e||(n.map?!(null===(r=null===(t=null==e?void 0:e.declaredClass)||void 0===t?void 0:t.toLowerCase())||void 0===r?void 0:r.includes("layer")):n.layer&&`${e.id}`==`${n.layer.id}`||FT(n,e))};let i,o=t;for(;!r(o);)i="esri.layers.support.Sublayer"===o.declaredClass?i?`${OT(o)}-${i}`:OT(o):i?`${ET(o)}-${i}`:ET(o),o=o.parent;return i?`${n.id}-${i}`:n.id}function FT(e,t){var n,r,i;if(!e||!t)return!1;const o=e.getMainDataSource();if(t[Ka.EXB_DATA_SOURCE_ID_SET_TO_CREATED_JS_API_LAYER])return t[Ka.EXB_DATA_SOURCE_ID_SET_TO_CREATED_JS_API_LAYER]===o.id;if(null===(n=t.portalItem)||void 0===n?void 0:n.id){if(t.portalItem.id===o.itemId){if(t.url)return BT(o,t);return!t.parent||!(null===(i=null===(r=t.parent.declaredClass)||void 0===r?void 0:r.toLowerCase())||void 0===i?void 0:i.includes("layer"))||`${t.layerId}`===o.jimuChildId}return!1}return t.url?BT(o,t):o.layer?`${t.id}`===o.layer.id:`${t.id}`===o.jimuChildId}function BT(e,t){if(!(null==e?void 0:e.url)||!(null==t?void 0:t.url))return!1;if(e.type===Xa.SubtypeSublayer){return LT(t.parent)===e.url&&t.subtypeCode===e.getSubtypeCode()}return LT(t)===e.url}function $T(e,t){const n=(null==e?void 0:e.split("-"))||[],r=(null==t?void 0:t.split("-"))||[];return GT(t)&&r.length-1===n.length&&n.every((e,t)=>r[t]===e)}function VT(e,t){if(!e||!t)return!1;const n=GT(e),r=GT(t);if(n&&r)return e.replace(/-[^-]+$/,"")===t.replace(/-[^-]+$/,"");if(n||r){return $T(n?t:e,n?e:t)}return e===t}function GT(e){return e&&[/-dataView_\d+$/,new RegExp(`-${Ad}$`),new RegExp(`-${Dd}$`),new RegExp(`-${Rd}$`)].some(t=>t.test(e))}function WT(e){return GT(e)?e.replace(/-[^-]+$/,""):e}function HT(e){const t=null==e?void 0:e.split("-");return(null==t?void 0:t.length)>1?t[0]:null}function zT(e){return GT(e)?e.split("-").pop():null}function qT(e){return{dataSourceId:e,mainDataSourceId:WT(e),dataViewId:zT(e),rootDataSourceId:HT(e)}}function JT(e,t){if(!(null==t?void 0:t.length)||!e)return{isChanged:!1,useDataSources:t};const n=t.asMutable().map(t=>KT(e,t));return{isChanged:n.some(e=>e.isChanged),useDataSources:n.map(e=>e.useDataSource)}}function KT(e,t){var n,r;if(!t||!e)return{isChanged:!1,useDataSource:t};let i=!1,o=(null===(r=(n=t).asMutable)||void 0===r?void 0:r.call(n,{deep:!0}))||t;const s=t.mainDataSourceId,a=e[s];return a&&a!==s&&(i=!0,o=function(e,t,n){const r=Object.assign(Object.assign({},e),{dataSourceId:e.dataSourceId.replace(t,n),mainDataSourceId:n}),i=n.split("-");i.length>1&&(r.rootDataSourceId=i[0]);return r}(o,s,a)),{isChanged:i,useDataSource:o}}function YT(e){return(null==e?void 0:e.split("-").reverse()[0])===Ad}function XT(e){return ZC(this,void 0,void 0,function*(){var t,n,r,i,o,s,a;if(!e)return!1;try{const l=TE().getState().user;if(!l)return!1;const u=(null===(n=null===(t=e.getLayerDefinition)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.serviceItemId)||(null===(a=null===(s=null===(o=null===(i=(r=e).getAssociatedDataSource)||void 0===i?void 0:i.call(r))||void 0===o?void 0:o.getLayerDefinition)||void 0===s?void 0:s.call(o))||void 0===a?void 0:a.serviceItemId),c=TE().getState().portalUrl;let d=u===e.itemId&&c===e.portalUrl?e.getItemInfo():null,p=!1;if(window.jimuConfig.isInPortal||window.jimuConfig.isDevEdition&&!fg(c)?p=e.portalUrl===c:u&&(d=(null==d?void 0:d.contentOrigin)?d:yield eA(c,e=>Pi(u,{portal:cg(c),authentication:e})).catch(e=>(console.log("Failed to get item info via app portal url. ",e),null)),p="self"===(null==d?void 0:d.contentOrigin)),p){const e="org_admin"===l.role,t=l.username===(null==d?void 0:d.owner);return!(!e&&!t)}return!1}catch(e){return console.log("Failed to get whether user is the owner of the item, or the admin of the org the item belongs to, ",e),!1}})}function QT(e){return ZC(this,void 0,void 0,function*(){var t,n;if(!e)return!1;if(e.isDataView||e.isLocal)return e.getMainDataSource().supportReplica();if(e.url){const r=e.getLayerDefinition();return!(!(null===(t=r.capabilities)||void 0===t?void 0:t.includes("Sync"))&&!(null===(n=r.capabilities)||void 0===n?void 0:n.includes("Extract")))||XT(e)}return!1})}function ZT(e){return!!e&&(e.isDataView||e.isLocal?e.getMainDataSource().supportSymbol():!(e.getDataSourceJson().isDataInDataSourceInstance||!e.layer))}function ex(e){var t;return!!e&&(e.isDataView||e.isLocal?e.getMainDataSource().supportAttachment():null===(t=e.getLayerDefinition())||void 0===t?void 0:t.hasAttachments)}function tx(e){var t,n,r,i,o,s,a,l,u,c,d;if((null==e?void 0:e.type)!==Xa.MapService&&(null==e?void 0:e.type)!==Xa.FeatureLayer&&(null==e?void 0:e.type)!==Xa.ImageryLayer&&(null==e?void 0:e.type)!==Xa.ImageryTileLayer&&(null==e?void 0:e.type)!==Xa.SubtypeGroupLayer&&(null==e?void 0:e.type)!==Xa.SceneLayer)return!1;if(e.isDataView||e.isLocal)return e.getMainDataSource().supportTime();{let p;if(p=e.type===Xa.FeatureLayer||e.type===Xa.ImageryLayer||e.type===Xa.ImageryTileLayer||e.type===Xa.SubtypeGroupLayer?null===(n=null===(t=e.getLayerDefinition())||void 0===t?void 0:t.timeInfo)||void 0===n?void 0:n.timeExtent:e.type===Xa.SceneLayer?null===(o=null===(i=null===(r=e.getAssociatedDataSource())||void 0===r?void 0:r.getLayerDefinition())||void 0===i?void 0:i.timeInfo)||void 0===o?void 0:o.timeExtent:null===(a=null===(s=e.getServiceDefinition())||void 0===s?void 0:s.timeInfo)||void 0===a?void 0:a.timeExtent,p){let t=e;(null===(l=e.getDataSourceJson().url)||void 0===l?void 0:l.split("/").some(e=>e.toLowerCase()===el.MapService.toLowerCase()))&&(t=ax(e)||t);const n=ox(null===(d=null===(c=null===(u=e.getRootDataSource())||void 0===u?void 0:u.map)||void 0===c?void 0:c.resourceInfo)||void 0===d?void 0:d.operationalLayers,t);return!n||!1!==n.timeAnimation}return!1}}function nx(e){var t;if("sublayer"!==(null==e?void 0:e.type)&&(null==e?void 0:e.type)!==nl.FeatureLayer&&(null==e?void 0:e.type)!==nl.SceneLayer&&(null==e?void 0:e.type)!==nl.MapImageLayer&&(null==e?void 0:e.type)!==nl.SubtypeGroupLayer&&(null==e?void 0:e.type)!==nl.ImageryLayer&&(null==e?void 0:e.type)!==nl.ImageryTileLayer)return!1;let n=e,r=e;for(;r.parent;)r=r.parent,"sublayer"===n.type&&(n=n.parent);const i=null==r?void 0:r.resourceInfo,o=((null==i?void 0:i.operationalLayers)||[]).concat((null==i?void 0:i.tables)||[]);if(!(null===(t=n.timeInfo)||void 0===t?void 0:t.toJSON().timeExtent))return!1;const s=sx(o,n);return s&&!1!==s.timeAnimation}function rx(e,t){if(-1===e||-1===t)return-1;if(null==e||null==t)return e||t;const n="number"==typeof e,r="number"==typeof t,i=Array.isArray(e),o=Array.isArray(t);if(n&&r)return e===t?e:-1;if(n&&o||i&&r){const r=n?e:t,o=i?e:t,s=ix(o),a=ix(o,!1);return r>=s&&r<=a?r:-1}if(i&&o){const n=Math.max(ix(e),ix(t)),r=Math.min(ix(e,!1),ix(t,!1));return n>r?-1:[n===-1/0?null:n,r===1/0?null:r]}return-1}function ix(e,t=!0){return t?"number"==typeof(null==e?void 0:e[0])?e[0]:-1/0:"number"==typeof(null==e?void 0:e[1])?e[1]:1/0}function ox(e,t){let n=null;return t?(null==e||e.some(e=>{var r;return(null==e?void 0:e.id)!==(null===(r=t.getSchema())||void 0===r?void 0:r.childId)&&(null==e?void 0:e.id)!==t.jimuChildId||(n=e),n||"GroupLayer"!==(null==e?void 0:e.layerType)||(n=ox(null==e?void 0:e.layers,t)),!!n}),n):n}function sx(e,t){let n=null;return t?(null==e||e.some(e=>((null==e?void 0:e.id)===t.id&&(n=e),n||"GroupLayer"!==(null==e?void 0:e.layerType)||(n=sx(null==e?void 0:e.layers,t)),!!n)),n):n}function ax(e){let t=e,n=null;for(;t;){if(t.type===Xa.MapService){n=t;break}t=t.parentDataSource}return n}function lx(e){var t,n,r;const i=gx(e);return i?i.type!==e.type?null===(r=null===(n=(t=i).getAssociatedDataSource)||void 0===n?void 0:n.call(t))||void 0===r?void 0:r._layer:i._layer:null}function ux(e){var t,n,r,i;const o=gx(e);if(!o)return null;if(!o._restLayer){const e={id:o.id,layerType:"ArcGISFeatureLayer",url:o.url,itemId:o.itemId,layerDefinition:o.getLayerDefinition(),popupInfo:o.getPopupInfo(),title:o.getLabel()};if(!o.url&&!o.itemId&&!o.getDataSourceJson().isDataInDataSourceInstance){const s=o.getRootDataSource();if(null===(n=null===(t=null==s?void 0:s.map)||void 0===t?void 0:t.resourceInfo)||void 0===n?void 0:n.operationalLayers){const t=ox(null===(i=null===(r=null==s?void 0:s.map)||void 0===r?void 0:r.resourceInfo)||void 0===i?void 0:i.operationalLayers,o);(null==t?void 0:t.featureCollection)&&(e.featureCollection=t.featureCollection)}}o._restLayer=e}return o._restLayer}function cx(e){const t=gx(e);return Object.assign(Object.assign({},null==e?void 0:e.layerDefinition),null==t?void 0:t.layerDefinition)}function dx(e){const t=gx(e);return(null==t?void 0:t.popupInfo)||function(e){var t,n,r,i;if(!e)return null;let o;if(e.layer)o=null===(t=e.layer.popupTemplate)||void 0===t?void 0:t.toJSON();else if(TO(e)){const t=e.getItemData(),r=null===(n=null==t?void 0:t.layers)||void 0===n?void 0:n.find(t=>`${t.id}`===e.getDataSourceJson().layerId);o=null==r?void 0:r.popupInfo}if(null===(r=null==o?void 0:o.fieldInfos)||void 0===r?void 0:r.length){const t=(null===(i=e.getSchema())||void 0===i?void 0:i.fields)||{};o.fieldInfos=o.fieldInfos.filter(e=>e.fieldName.startsWith("expression/")||Object.keys(t).some(n=>t[n].name===e.fieldName))}return o}(t)}function px(e){const t=gx(e);return null==t?void 0:t.getDataSourceJson().exportOptions}function fx(e,t){var n,r;if(!e||!t)return null;const i=Object.values((null===(n=t.getDataSourceJson().schema)||void 0===n?void 0:n.fields)||{}),o=null===(r=e.fieldInfos)||void 0===r?void 0:r.filter(e=>i.some(t=>(null==t?void 0:t.name)===(null==e?void 0:e.fieldName)));return Object.assign(Object.assign({},e),{fieldInfos:o})}function hx(e,t){var n,r;if(!e||!t)return null;const i=Object.values((null===(n=t.getDataSourceJson().schema)||void 0===n?void 0:n.fields)||{}),o=null===(r=e.fields)||void 0===r?void 0:r.filter(e=>i.some(t=>(null==t?void 0:t.name)===(null==e?void 0:e.name)));return Object.assign(Object.assign({},e),{fields:o,geometryType:null,typeIdField:null})}function gx(e){var t;if(!e)return null;if(e.getDataSourceJson().isOutputFromWidget&&!e.getDataSourceJson().schema&&1===(null===(t=e.getDataSourceJson().originDataSources)||void 0===t?void 0:t.length)){const t=e.getOriginDataSources()[0];if(CO(t))return gx(t)}return e.getMainDataSource()}function mx(e){var t;return(null==e?void 0:e.type)!==Xa.FeatureLayer?null:e.getDataSourceJson().isDataInDataSourceInstance?null===(t=pO(e,e.getSourceRecords()))||void 0===t?void 0:t.layer:Object.assign({},e.restLayer)}function vx(e){return ZC(this,void 0,void 0,function*(){return(null==e?void 0:e.itemId)&&(null==e?void 0:e.portalUrl)?yield Fg(["esri/layers/Layer","esri/portal/PortalItem"]).then(t=>ZC(this,void 0,void 0,function*(){const n=t[0],r=t[1];return yield n.fromPortalItem({portalItem:new r({id:e.itemId,portal:{url:e.portalUrl}})}).then(t=>ZC(this,void 0,void 0,function*(){return(null==t?void 0:t.type)===nl.FeatureLayer?yield Promise.resolve(t):(null==t?void 0:t.type)===nl.GroupLayer?yield t.loadAll().then(t=>ZC(this,void 0,void 0,function*(){const n=t.layers.toArray().find(t=>`${t.layerId}`===e.layerId||IT(t.title)===IT(e.getMainDataSource().getDataSourceJson().sourceLabel));return(null==n?void 0:n.type)===nl.FeatureLayer?Promise.resolve(n):Promise.reject(new Error("Feature layer data source error: failed to create feature layer with specific layer id."))})):void 0}))})):yield Promise.resolve(null)})}function yx(e){var t,n,r;const i=e;return(null===(t=i.layer)||void 0===t?void 0:t.datesInUnknownTimezone)||(null===(r=null===(n=i.getLayerDefinition)||void 0===n?void 0:n.call(i))||void 0===r?void 0:r.datesInUnknownTimezone)}function Sx(e){let t=0;if(null===e)return t;if(t=eT[e],void 0===t){const n=/([-+]?\d+(\.\d+)?)/,r=new Intl.DateTimeFormat("en-us",{timeZone:e,timeZoneName:"shortOffset"}).formatToParts(new Date).find(({type:e})=>"timeZoneName"===e).value.match(n);t=r?parseFloat(r[0]):0}return 60*t*60*1e3}function bx(e){let t="";return t="unknown"===e||eT[e]||null===e?"unknown":"device"===e?"system":e,t}function wx(e,t){const n=[t];let r=e;for(;r;)r.jimuChildId&&n.push(r.jimuChildId),r=r.parentDataSource;const i=n.reverse();let o=(e.getRootDataSource()||e).getDataSourceJson();for(const e of i){if(!o.childDataSourceJsons)return{};o=o.childDataSourceJsons[e]}return o}function Ix(e,t){const n=t.getTimezone();if("unknown"===n)e-=qO();else if("device"!==n){const t=Sx(n);e=e-qO()+t}return e}function Ex(e,t){const n=t.getTimezone();if("unknown"===n)e+=qO();else if("device"!==n){const t=Sx(n);e=e+qO()-t}return e}function Ox(e,t,n){var r;if(!t||!e)return[];if("feature"===n&&(null===(r=e.outFields)||void 0===r?void 0:r.includes("*")))return["*"];const i=Object.values(t.getSchema().fields||{}).map(e=>e.jimuName),o=i.filter(t=>{var n,r;return null===(r=null===(n=e.where)||void 0===n?void 0:n.split(" "))||void 0===r?void 0:r.some(e=>null==e?void 0:e.includes(t))}),s=i.filter(t=>{var n;return null===(n=e.orderByFields)||void 0===n?void 0:n.some(e=>{var n;return null===(n=null==e?void 0:e.split(" "))||void 0===n?void 0:n.includes(t)})}),a=i.filter(t=>{var n;return null===(n=e.groupByFieldsForStatistics)||void 0===n?void 0:n.some(e=>e===t)}),l=i.filter(t=>{var n;return null===(n=e.outStatistics)||void 0===n?void 0:n.some(e=>e.onStatisticField===t)});let u=[];if("count"===n||"id"===n||"extent"===n)u=Array.from(new Set([...o,...s,...a,...l]));else if("feature"===n){const t=e.outFields||[];u=Array.from(new Set([...t,...o,...s,...a,...l]))}return u.length===i.length&&(u=["*"]),u}function Cx(e){let t=e;const n=t.getDataSourceJson();n.isOutputFromWidget&&!n.schema&&(t=t.getOriginDataSources()[0]||t);return!t.isDataView&&!t.isLocal||(t=t.getMainDataSource()||t),t}function Tx(e,t){var n;const r=Cx(e).getRootDataSource(),i=Cx(t).getRootDataSource();if(r.id!==i.id)return null;const{relationships:o=[],id:s}=(null===(n=null==e?void 0:e.getLayerDefinition)||void 0===n?void 0:n.call(e))||{},{relationships:a=[],id:l}=t.getLayerDefinition()||{},u=o.find(e=>e.relatedTableId===l),c=a.find(e=>e.relatedTableId===s);if(!u||!c)return null;const d="number"==typeof(null==u?void 0:u.relationshipTableId)&&"number"==typeof(null==c?void 0:c.relationshipTableId);return{keyField:null==u?void 0:u.keyField,relatedKeyField:null==c?void 0:c.keyField,hasRelationshipTable:d}}const xx=["page","pageSize","returnGeometry","outFields","returnZ","returnM","sqlExpression","notAddFieldsToClient","disableClientQuery"];function Ax(e){if(!e)return!0;const t=e.without(...xx);if(0===Object.keys(t).length)return!0;const n="string"==typeof t.where?t.where.replace(/\s+/g,"").replace(/\(/g,"").replace(/\)/g,""):null;return 1===Object.keys(t).length&&["","1=1"].some(e=>e===n)}function Dx(e){var t;return!!(null==e?void 0:e.query)&&Object.keys((null===(t=null==e?void 0:e.getSchema())||void 0===t?void 0:t.fields)||{}).length>0}function Rx(e){var t,n;if(!e)return[];const r=mA.getInstance(),i=null===(t=r.getDataSource(e))||void 0===t?void 0:t.getMainDataSource();if(!i)return[];const o=i.getDataSourceJson(),s=Object.values(null!==(n=null==o?void 0:o.dataViews)&&void 0!==n?n:{}).map(e=>r.getDataViewDataSourceId(i.id,e.id));return s.push(i.id),s.push(r.getDataViewDataSourceId(i.id,Ad)),s}var Px=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class jx{static getInstance(){return window.jimuConfig.isBuilder?window._appWindow&&window._appWindow._utilityManager:(jx.instance||(jx.instance=new jx,window._utilityManager=jx.instance),jx.instance)}static isPrintingTask(e){var t;let n=!1,r=!1;return null===(t=e.parameters)||void 0===t||t.forEach(e=>{"web_map_as_json"===e.name.toLowerCase()&&"esriGPParameterDirectionInput"===e.direction&&(n=!0),"output_file"===e.name.toLowerCase()&&"GPDataFile"===e.dataType&&"esriGPParameterDirectionOutput"===e.direction&&(r=!0)}),n&&r}static getServiceInfo(e,t){return Px(this,void 0,void 0,function*(){let n=jx.getInstance().getUrlUsedForRequest(e);const r={};if(n.includes("?")){const e=new URLSearchParams(n.split("?")[1]);n=n.split("?")[0];for(const[t,n]of e.entries())"f"!==t&&(r[t]=n)}return yield eA(e,e=>Px(this,void 0,void 0,function*(){return yield Pr(n,{params:Object.assign(Object.assign({},r),{f:"json"}),authentication:e,httpMethod:"GET"})}),1,t)})}static getGPServerInfo(e,t){return Px(this,void 0,void 0,function*(){const n=yield jx.getServiceInfo(e,t);if(!n)return null;const r=[];for(let t=0;t<n.tasks.length;t++){const i=n.tasks[t];try{const t=yield jx.getServiceInfo(`${e}/${i}`),n={name:i};jx.isPrintingTask(t)&&(n.isPrintingTask=!0),r.push(n)}catch(e){console.error(e),r.push({name:i})}}return{type:Zh.GPServer,info:Object.assign(Object.assign({},n),{tasks:r})}})}constructor(){this.portalUtilitiesPromise={},window.jimuConfig.isBuilder&&console.error("UtilityManager should not be created in builder"),xE(this.onUtilitiesChange.bind(this),["appConfig","utilities"]),xE(this.onResourceSessionsChange.bind(this),["resourceSessions"])}onUtilitiesChange(e,t){e&&t&&Object.keys(e).forEach(n=>{var r;const i=e[n];t[n]||i.portalUrl&&(null===(r=this.portalUtilitiesPromise[i.portalUrl])||void 0===r?void 0:r[i.itemId])&&delete this.portalUtilitiesPromise[i.portalUrl][i.itemId]})}onResourceSessionsChange(e,t){for(const n of Object.keys(this.portalUtilitiesPromise||{})){const r=hg(Cv.getInstance().getSessionKeyFromUrl(n));e[r]!==t[r]&&delete this.portalUtilitiesPromise[n]}}urlExist(e){var t,n,r;const i=null!==(r=null===(n=null===(t=TE().getState())||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.utilities)&&void 0!==r?r:{};return Object.keys(i).some(t=>{const n=i[t];return"org"!==n.source&&!n.itemId&&n.url===e})}itemExist(e,t){var n,r,i;const o=null!==(i=null===(r=null===(n=TE().getState())||void 0===n?void 0:n.appConfig)||void 0===r?void 0:r.utilities)&&void 0!==i?i:{};return Object.keys(o).some(n=>{const r=o[n];return r.itemId===t&&r.portalUrl===e})}getLabelOfUseUtility(e){var t,n;if(e.task)return e.task;const r=this.getUtilityJson(e.utilityId);return"org"===r.source&&r.index>=0?r.taskName:null!==(n=null!==(t=r.label)&&void 0!==t?t:r.name)&&void 0!==n?n:r.sourceLabel}getUrlUsedForRequest(e){return e}getUrlOfUseUtility(e){return Px(this,void 0,void 0,function*(){const{utilityId:t,task:n}=e,r=yield this.getUtility(t);let i;return i=n?`${r.url}/${n}`:r.url,this.getUrlUsedForRequest(i)})}getIdOfOrgUtility(e,t,n,r){var i,o,s;const a=null!==(s=null===(o=null===(i=TE().getState())||void 0===i?void 0:i.appConfig)||void 0===o?void 0:o.utilities)&&void 0!==s?s:{};let l=null;return Object.keys(a).some(i=>{const o=a[i];if("org"===o.source)if(n>=0){if(o.taskName===r&&o.url===t&&o.index>=0)return l=i,!0}else if(o.name===e&&o.url===t)return l=i,!0;return!1}),l}isUtilityUsed(e){var t,n;const r=null===(n=null===(t=TE().getState())||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets;return Object.keys(null!=r?r:{}).some(t=>{var n;return(null!==(n=r[t].useUtilities)&&void 0!==n?n:[]).some(t=>t.utilityId===e)})}getUtilityJson(e){var t,n,r;return null===(r=null===(n=null===(t=TE().getState())||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.utilities)||void 0===r?void 0:r[e]}getUtilityFromJson(e){return Px(this,void 0,void 0,function*(){var t;if(!e)return null;const{id:n}=e;if(null==e.itemId){const r={utilityId:n,url:e.url};if(/\/rest\/services\/.*\/GPServer\/?$/.test(e.url))if((null===(t=e.tasks)||void 0===t?void 0:t.length)>0)r.tasks=[...e.tasks];else{const{info:t}=yield jx.getGPServerInfo(e.url);r.tasks=t.tasks}return r}const{portalUrl:r,itemId:i}=e;if(this.portalUtilitiesPromise[r]||(this.portalUtilitiesPromise[r]={}),this.portalUtilitiesPromise[r][i]){const t=yield this.portalUtilitiesPromise[r][i];return(null==t?void 0:t.tasks)&&t.tasks.forEach(t=>{const n=e.tasks.find(e=>e.name===t.name);n&&"visible"in n&&(t.visible=n.visible)}),t}return yield this.createUtilityOfItem(e)})}getUtility(e){return Px(this,void 0,void 0,function*(){const t=this.getUtilityJson(e),n=yield this.getUtilityFromJson(t);if(null==n)throw new Error(`Utility ${e} is not found`);return n})}getUrlOfItem(e,t){return Px(this,void 0,void 0,function*(){const n=Cv.getInstance().getSessionByUrl(e);return yield Pi(t,{portal:cg(e),authentication:n}).then(e=>e.url).catch(n=>(console.error("Get url failed",e,t,n),null))})}utilityHasSignInError(e){var t;const n=null===(t=TE().getState().appConfig.utilities)||void 0===t?void 0:t[e];if(n){const e=n.url,t=Cv.getInstance().getNoPermissionResourceInfoList()||{};if(Object.keys(t).find(t=>e.includes(t)))return!0}return!1}reportUtilityState(e,t,n=!1){if(window.jimuConfig.isBuilder){MI("jimu-for-builder").builderAppSync.publishUtilityStateChangeToApp(e,t,n)}else TE().dispatch(ZD(e,t,n))}createUtilityOfItem(e){return Px(this,void 0,void 0,function*(){const{portalUrl:t,itemId:n,url:r,id:i,sourceLabel:o}=e,s={utilityId:i,url:r};return this.portalUtilitiesPromise[t][n]=this.fetchPortalItemUtility(e).then(t=>{var n;if(s.itemInfo=t,o!==t.title&&this.updateSourceLabelOfItem(e,t.title),/\/rest\/services\/.*\/GPServer\/?$/.test(r)){if((null===(n=e.tasks)||void 0===n?void 0:n.length)>0){const t=e.tasks.asMutable({deep:!0});return{type:Zh.GPServer,info:{tasks:t}}}return jx.getGPServerInfo(r)}}).then(e=>((null==e?void 0:e.info)&&(s.tasks=e.info.tasks),s)).catch(e=>(console.error("Create utility failed",t,n,e),null)),this.portalUtilitiesPromise[t][n]})}updateSourceLabelOfItem(e,t){var n;const{id:r}=e;let i=null===(n=TE().getState())||void 0===n?void 0:n.appConfig;i&&(i=i.setIn(["utilities",r,"sourceLabel"],t),Ww(i))}fetchPortalItemUtility(e){const{portalUrl:t,itemId:n}=e;if(!t||!n)return null;const r=Cv.getInstance().getSessionByUrl(t);return Pi(n,{portal:cg(t),authentication:r})}checkUtilityStatus(e){return Px(this,void 0,void 0,function*(){try{const{portalUrl:t,itemId:n}=e;t&&n&&(yield this.fetchPortalItemUtility(e));const r=this.getUrlUsedForRequest(e.url);return yield jx.getServiceInfo(r),this.reportUtilityState(e.id,!0),{success:!0}}catch(t){console.error(t);let n=!1;return("GWM_0003"===t.code||t.isSignInError)&&(n=!0),this.reportUtilityState(e.id,!1,n),{success:!1,isSignInError:n}}})}}const Lx=jx;var _x=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function Mx(){var e,t;return!(null===(t=null===(e=TE().getState())||void 0===e?void 0:e.appContext)||void 0===t?void 0:t.isInBuilder)}function Nx(e){var t,n;const r=null===(n=null===(t=TE().getState())||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.appProxies;if(!e||!r)return null;const i=Object.values(r);for(let t=0;t<i.length;t++){const n=i[t],r=n.sourceUrl.replace(/\/*$/g,""),o=n.proxyUrl;if(r&&o&&0===e.indexOf(r)){return o+e.replace(r,"")}}return null}const kx=[];function Ux(e){"string"!=typeof e||kx.includes(e)||kx.push(e)}function Fx(e){const t=kx.findIndex(t=>t===e);t>-1&&kx.splice(t,1)}function Bx(){return kx}function $x(e,t){return function(e){var t;return null===(t=null==e?void 0:e.typeKeywords)||void 0===t?void 0:t.includes("Requires Subscription")}(e)||function(e){return e&&Jx.some(t=>t.test(e))}(t)}function Vx(e,t){return function(e){var t;return null===(t=null==e?void 0:e.typeKeywords)||void 0===t?void 0:t.includes("Requires Credits")}(e)||function(e){return e&&Kx.some(t=>t.test(e))}(t)}function Gx(e){if(!e||!e.itemId&&!e.url)return Promise.resolve(!1);if(e.itemId){const t=mA.getInstance().getDataSource(e.id);let n;return n=TO(t)?t.fetchItemInfo():Qx(e.portalUrl,e.itemId),n.then(t=>$x(t,e.url)).catch(e=>(console.error("Failed to check whether data source is subscriber.",e),Promise.resolve(!1)))}return Promise.resolve($x(null,e.url))}function Wx(e){if(!e||!e.itemId&&!e.url)return Promise.resolve(!1);if(e.itemId){const t=mA.getInstance().getDataSource(e.id);let n;return n=TO(t)?t.fetchItemInfo():Qx(e.portalUrl,e.itemId),n.then(t=>Vx(t,e.url)).catch(e=>(console.error("Failed to check whether data source is premium.",e),Promise.resolve(!1)))}return Promise.resolve(Vx(null,e.url))}function Hx(e){if(!e||!e.itemId&&!e.url)return Promise.resolve(!1);if(e.itemId){const t=mA.getInstance().getDataSource(e.id);let n;if(TO(t))n=t.fetchItemInfo();else{const t=Xx(e.portalUrl,e.itemId);Yx[t]||(Yx[t]=Qx(e.portalUrl,e.itemId)),n=Yx[t]}return n.then(t=>$x(t,e.url)||Vx(t,e.url)).catch(e=>(console.error("Failed to check whether data source is subscriber or premium.",e),Promise.resolve(!1)))}return Promise.resolve($x(null,e.url)||Vx(null,e.url))}function zx(e){return _x(this,void 0,void 0,function*(){if(!e||!e.itemId&&!e.url)return Promise.resolve(!1);try{if(e.itemId){return $x((yield Lx.getInstance().getUtility(e.id)).itemInfo,e.url)}return Promise.resolve($x(null,e.url))}catch(e){return console.error("Failed to check whether utility is subscriber.",e),Promise.resolve(!1)}})}function qx(e){return _x(this,void 0,void 0,function*(){if(!e||!e.itemId&&!e.url)return Promise.resolve(!1);try{if(e.itemId){return Vx((yield Lx.getInstance().getUtility(e.id)).itemInfo,e.url)}return Promise.resolve(Vx(null,e.url))}catch(e){return console.error("Failed to check whether utility is premium.",e),Promise.resolve(!1)}})}const Jx=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route(\w|-)*\.arcgis\.com/i,/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com(?!.*\/ElevationSync\/)/i,/sentinel\w*\.arcgis\.com/i,/oceans\w*\.arcgis\.com/i,/tiledbasemaps\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i],Kx=[/traffic\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,/route(\w|-)*\.arcgis\.com/i],Yx={};function Xx(e,t){return`${e}-${t}`}function Qx(e,t){const n=Xx(e,t);return Yx[n]||(Yx[n]=eA(e,n=>Pi(t,{portal:cg(e),authentication:n}))),Yx[n]}var Zx=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function eA(e,t){return Zx(this,arguments,void 0,function*(e,t,n=1,r=!1){if(Mx()){const t=Nx(e);t&&t!==e&&(e=t)}const i=(o,s=0)=>t(o).catch(t=>{if(s>=n)return Promise.reject(nA(t));const a=t.options,l=Cv.getInstance(),u="ArcGISAuthError"===t.name&&a&&(!a.authentication||498===t.code||403===t.code||"AUTHENTICATION_ERROR_CODE"===t.code||"GWM_0003"===t.code),c="ArcGISRequestError"===t.name&&(403===t.code||"GWM_0003"===t.code);return u||c?(498===t.code&&l.handleInvalidToken(e),tA(e,r).then(e=>i(e,s+1)).catch(e=>Promise.reject(nA(e)))):i(o,s+1)}),o=Cv.getInstance(),s=o.getSessionByUrl(e);return s?i(s):o.getServerKeyFromUrl(e)?fA.getInstance().fetchArcGISServerInfo(e).then(t=>Zx(this,void 0,void 0,function*(){if(null==t?void 0:t.owningSystemUrl){const n=o.getSessionByUrl(t.owningSystemUrl);return n&&(yield tA(e)),i(n)}return i(void 0)})):i(void 0)})}function tA(e,t=!1){const n=Cv.getInstance(),r=n.getServerKeyFromUrl(e);let i,o="";const s=n.getNoPermissionResourceInfoByUrl(e),a=n.isSignInPromptBlocked();if(t=t&&(null==s?void 0:s.allowSignIn),s&&!t){const t=n.getSessionByUrl(e);return i=t?Promise.resolve(t):Promise.reject(n.getSignInErrorByCode(s.signInErrorCode)),i}if(a&&!t){let t;t=r?fA.getInstance().fetchArcGISServerInfo(e).then(e=>e):Promise.resolve(null),i=t.then(t=>Zx(this,void 0,void 0,function*(){const r=t?t.owningSystemUrl:e,i=n.getSessionByUrl(r);return o=null==t?void 0:t.owningSystemUrl,i?Promise.resolve(i):Promise.reject(n.getSignInErrorByCode(yv.SignInCanceled))}))}else i=r?fA.getInstance().fetchArcGISServerInfo(e).then(r=>Zx(this,void 0,void 0,function*(){if(null==r?void 0:r.owningSystemUrl){const i=n.getClientIdByUrl(null==r?void 0:r.owningSystemUrl);let s;if(o=null==r?void 0:r.owningSystemUrl,i)s=n.signIn({popup:!0,desUrl:null==r?void 0:r.owningSystemUrl,clientId:i,forceLogin:t,federatedServiceUrl:e}).then(e=>e);else{if(!window.jimuConfig.isBuilder&&!window.jimuConfig.isInBuilder)return n.nonOAuthSignIn(e,t);s=n.useDialogToSetClientIdToConnectionsOfAppConfig(r.owningSystemUrl).then(i=>{const o=i||n.getClientIdByUrl(r.owningSystemUrl);return n.signIn({popup:!0,desUrl:r.owningSystemUrl,clientId:o,forceLogin:t,federatedServiceUrl:e})})}return s}return n.nonOAuthSignIn(e,t)})):n.signIn({popup:!0,desUrl:e});return i.then(t=>(n.checkSessionPermissionForUrl(e,t.token,t.username,o),t)).catch(t=>(t.code===yv.SignInCanceled&&n.addToNoPermissionResourceInfoList(e,"",yv.SignInCanceled,!1,o),Promise.reject(t)))}function nA(e){const t=Cv.getInstance(),n=t.getSignInErrorCodeByAuthError(e);return n?t.getSignInErrorByCode(n):e}const rA=[],iA={};function oA(e){rA.push(e)}function sA(e,t){return iA[cA(e,t)]}function aA(e,t,n){iA[cA(e,t)]=n}function lA(e,t){delete iA[cA(e,t)]}function uA(e){Object.keys(iA).forEach(t=>{var n;"pending"!==(null===(n=iA[t])||void 0===n?void 0:n.status)&&e.every(e=>t.includes(e))&&delete iA[t]})}function cA(e,t){let n="";return t&&Object.keys(t).filter(e=>void 0!==t[e]&&null!==t[e]).sort((e,t)=>e.localeCompare(t,"en")).forEach((e,r)=>{n=`${n}${0===r?"?":"&"}${e}=${t[e]}`}),n?`${e}${n}`:e}function dA(e,t){return rA.some(n=>(n=>{const r=Object.prototype.toString.call(n);return"[object String]"===r?n===e:"[object RegExp]"===r?n.test(e):"[object Function]"===r&&n(e,t)})(n))}window._cachedRequests=iA;var pA=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class fA{constructor(){this.servicesInfo={},this.servicesInfoPromise={},this.arcGISServersInfo={},this.arcGISServersInfoPromise={}}static getInstance(){return window.jimuConfig&&window.jimuConfig.isBuilder?window._appWindow&&window._appWindow._serviceManager?window._appWindow._serviceManager:(console.error("Please wait for app loaded."),null):(fA.instance||(fA.instance=new fA,window._serviceManager=fA.instance),fA.instance)}getServiceInfo(e){return this.servicesInfo[e]}setServiceInfo(e,t){this.servicesInfo[e]=t}getServerInfo(e){return this.arcGISServersInfo[e]}getServerInfoByServiceUrl(e){return this.arcGISServersInfo[this.getArcGISServerUrlFromServiceUrl(e)]}clearServiceInfo(e){e&&Object.keys(this.servicesInfoPromise).forEach(t=>{t.startsWith(e)&&(delete this.servicesInfoPromise[t],delete this.servicesInfo[t])})}fetchServiceInfo(e){return pA(this,void 0,void 0,function*(){return this.getServiceInfo(e)?Promise.resolve(this.getServiceInfo(e)):(this.servicesInfoPromise[e]||(this.servicesInfoPromise[e]=this.isHostedServiceInSamePortal(e).then(t=>pA(this,void 0,void 0,function*(){return eA(e,n=>pA(this,void 0,void 0,function*(){return Pr(e,{authentication:n,httpMethod:"GET"}).then(e=>({definition:e,isHostedInSamePortal:t}))}),1)})).then(t=>(this.servicesInfo[e]=t,t))),this.servicesInfoPromise[e])})}isHostedServiceInSamePortal(e){return pA(this,void 0,void 0,function*(){return this.fetchArcGISServerInfo(e).then(t=>(null==t?void 0:t.owningSystemUrl)?!(!/https?:\/\/(www|services)\.arcgis\.com/.test(t.owningSystemUrl)||!/maps\.arcgis\.com\/?$/.test(TE().getState().portalUrl))||(!(!/https?:\/\/(devext|servicesdev)\.arcgis\.com/.test(t.owningSystemUrl)||!/mapsdevext\.arcgis\.com\/?$/.test(TE().getState().portalUrl))||(!(!/https?:\/\/(qaext|servicesqa)\.arcgis\.com/.test(t.owningSystemUrl)||!/mapsqa\.arcgis\.com\/?$/.test(TE().getState().portalUrl))||pg(TE().getState().portalUrl,t.owningSystemUrl))):!!Tv.getInstance().getSessionByUrl(e))})}fetchArcGISServerInfo(e){return pA(this,void 0,void 0,function*(){const t=this.getArcGISServerUrlFromServiceUrl(e);return t?(this.arcGISServersInfoPromise[t]||(this.arcGISServersInfoPromise[t]=Pr(t,{httpMethod:"GET"}).then(e=>(this.arcGISServersInfo[t]=e,e)).catch(e=>pA(this,void 0,void 0,function*(){return console.warn("Failed to fetch ArcGIS server info."),Promise.resolve(null)}))),this.arcGISServersInfoPromise[t]):Promise.resolve(null)})}getArcGISServerUrlFromServiceUrl(e){const t=Jg(e);return t?t+"/rest/info":null}isHostedService(e){return pA(this,void 0,void 0,function*(){const t=e.split(/\/rest(\/admin)?\/services\//)[0];return t?Pr(t+"/rest/info",{httpMethod:"GET"}).then(e=>!!e.owningSystemUrl):Promise.resolve(!1)})}fetchChildLayerDefinitionsFromUrls(e){return pA(this,void 0,void 0,function*(){return Promise.allSettled(e.map(e=>pA(this,void 0,void 0,function*(){return this.fetchServiceInfo(e).then(e=>e.definition)}))).then(t=>{const n={};let r;return t.forEach((t,i)=>{const o="fulfilled"===t.status?t.value:null;o&&(r=e[i],n[r]=o)}),n}).then(e=>{const t=Object.keys(e).map(t=>e[t]),n=this._getAllChildLayerIdsOfGroupLayer(t),r={};return Object.keys(e).forEach(t=>{n.some(n=>{var r;return n===`${null===(r=e[t])||void 0===r?void 0:r.id}`})||(r[t]=e[t])}),r})})}_getAllChildLayerIdsOfGroupLayer(e){if(!e||0===e.length)return[];const t=e.filter(e=>e.type===Za.GroupLayer);return this._getChildLayerIdsFromGroupLayerDefinitions(t)}_getChildLayerIdsFromGroupLayerDefinitions(e){return 0===e.length?[]:Array.prototype.concat.apply([],e.map(e=>(null==e?void 0:e.subLayers.map(e=>`${e.id}`))||[]))}}var hA=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class gA{static getInstance(){return window.jimuConfig.isBuilder?window._appWindow&&window._appWindow._dataSourceManager:(gA.instance||(gA.instance=new gA,window._dataSourceManager=gA.instance),gA.instance)}constructor(){this.dataSources={},this.dataSourcesCreatePromise={},this.dataSourceFactories={},this.childDataSourcesPendedByTime=[],this.throttleDispatchPendedNotCreatedStatus=$E(this.dispatchPendedNotCreatedStatus.bind(this),200,{leading:!1,trailing:!0}),this.throttleDispatchPendedCreatedStatus=$E(this.dispatchPendedCreatedStatus.bind(this),200,{leading:!1,trailing:!0}),this.traversedDataSourceIdsByTime=new Set([]),this.notCreatedDataSourceIds=new Set([]),this.createdDataSourceIds=new Set([]),this.doNotBatchStatusDataSourceIds=new Set([]),window.jimuConfig.isBuilder?console.error("DataSourceManager should not be created in builder"):(xE(this.onStoreDataSourcesChange.bind(this),["appConfig","dataSources"]),xE(this.onStoreResourceSessionsChange.bind(this),["resourceSessions"]))}getDataSource(e){return this.dataSources[e]}getDataViewDataSource(e,t){return this.dataSources[this.getDataViewDataSourceId(e,t)]}getDataSources(){return this.dataSources}getDataSourcesAsArray(){return Object.keys(this.dataSources).map(e=>this.dataSources[e])}setDataSource(e,t){this.dataSources[e]=t}destroyAllDataSources(){Object.keys(this.dataSources).forEach(e=>{this.destroyDataSource(e)}),this.dataSourcesCreatePromise={}}destroyDataSource(e){var t;(null===(t=this.dataSources[e])||void 0===t?void 0:t.type)===Xa.Error&&this.destroyDataSource(this.restoreErrorDataSourceId(e)),this.dataSources[e]?(TE().dispatch(KA(e)),this.dataSources[e].getDataViews().forEach(e=>{this.destroyDataSource(e.id)}),this.dataSources[e].getLocalDataSources().forEach(e=>{this.destroyDataSource(e.id)}),this.getDataSourcesAsArray().forEach(t=>{t.getOriginDataSources().find(t=>t===this.dataSources[e])&&this.destroyDataSource(t.id)}),this.dataSources[e].destroy(),delete this.dataSources[e],delete this.dataSourcesCreatePromise[e]):this.dataSourcesCreatePromise[e]&&(TE().dispatch(KA(e)),delete this.dataSourcesCreatePromise[e]),this.doNotBatchStatusDataSourceIds.delete(e),this.traversedDataSourceIdsByTime.delete(e),this.notCreatedDataSourceIds.delete(e),this.createdDataSourceIds.delete(e)}getConfiguredDataSources(){return Object.keys(this.dataSources).filter(e=>!this.dataSources[e].getDataSourceJson().isOutputFromWidget).map(e=>this.getDataSource(e)).filter(e=>{var t,n;return null===(t=this.getAppConfig().dataSources)||void 0===t?void 0:t[(null===(n=e.getRootDataSource())||void 0===n?void 0:n.id)||e.id]})}getWidgetGeneratedDataSources(){const e={},t=this.getAppConfig();return Object.keys(t.widgets).filter(e=>t.widgets[e].outputDataSources).forEach(n=>{e[n]=t.widgets[n].outputDataSources.asMutable().map(e=>this.getDataSource(e))}),e}createAllDataSources(){const e=this.getAppConfig()&&this.getAppConfig().dataSources,t=[];return e&&Object.keys(e).forEach(e=>{this.dataSources[e]||t.push(this.createDataSource(e).then(e=>e.isDataSourceSet()&&!e.getRootDataSource()?e.childDataSourcesReady().then(()=>e):e).catch(t=>(console.error("Create data source failed",e,t),Promise.resolve(null))))}),Promise.all(t).then(e=>Promise.all(this.getDataSourcesAsArray().filter(e=>e.getMainDataSource().id===e.id).map(e=>this.createDataViews(e))).then(()=>e))}createAllDataSourcesByTime(){return hA(this,arguments,void 0,function*(e=30,t=1e3){for(;!this.areAllDataSourcesCreated();){const n=this.getDataSourcesAsArray().filter(e=>e.type!==Xa.Error&&e.getMainDataSource().id===e.id&&!this.traversedDataSourceIdsByTime.has(e.id)).reverse();n.length?this.createDataSourcesAndTheirDataViewsByUseDataSources(this.getChildUseDataSourcesFromParentDss(e,n)):this.createDataSourcesAndTheirDataViewsByUseDataSources(this.getRootUseDataSourcesFromConfig(e)),yield this.delay(t)}this.getDataSourcesAsArray().forEach(e=>{e.query&&Object.keys(e.getDataSourceJson().dataViews||{}).some(t=>!this.getDataViewDataSource(e.id,t))&&this.createDataViews(e)})})}delay(e){return new Promise(t=>{const n=setTimeout(()=>{clearTimeout(n),t()},e)})}areAllDataSourcesCreated(){var e,t;return!Object.keys(null!==(t=null===(e=this.getAppConfig())||void 0===e?void 0:e.dataSources)&&void 0!==t?t:{}).some(e=>{var t,n;const r=this.getDataSource(e);return(null==r?void 0:r.isDataSourceSet())?!r.areChildDataSourcesCreated():![Ya.Created,Ya.CreateError].includes(null===(n=null===(t=TE().getState().dataSourcesInfo)||void 0===t?void 0:t[e])||void 0===n?void 0:n.instanceStatus)})}getChildUseDataSourcesFromParentDss(e,t){const n=t.reduce((e,t)=>t.isDataSourceSet()?e.concat(t.getChildDataSourceIds().map(e=>({dataSourceId:e,mainDataSourceId:e,rootDataSourceId:(t.getRootDataSource()||t).id}))):e,[]).filter(e=>!this.dataSourcesCreatePromise[e.dataSourceId]&&!this.childDataSourcesPendedByTime.some(t=>t.dataSourceId===e.dataSourceId));return n.unshift(...this.childDataSourcesPendedByTime.splice(0)),n.length>e?this.childDataSourcesPendedByTime.push(...n.splice(e,n.length-e)):n.length<e&&n.push(...this.getRootUseDataSourcesFromConfig(e-n.length)),n}getRootUseDataSourcesFromConfig(e){const t=this.getAppConfig()&&this.getAppConfig().dataSources,n=[];return Object.keys(t).some(r=>(this.dataSourcesCreatePromise[r]||n.push({dataSourceId:t[r].id,mainDataSourceId:t[r].id}),n.length===e)),n}createDataSourcesAndTheirDataViewsByUseDataSources(e){return(null==e?void 0:e.length)?Promise.all(e.map(e=>this.createDataSourceAndItsDataViewsByUseDataSource(e,!0))).then(e=>e.filter(e=>!!e)):Promise.resolve([])}createDataViews(e){return e.id!==e.getMainDataSource().id?[]:Object.keys(e.getDataSourceJson().dataViews||{}).map(t=>this.createDataView(e,t))}createDataSource(e,t,n,r){let i,o;if("string"==typeof e){let t=this.getAppConfig().dataSources[e];if(!t&&!r)throw Error("Can not create data source."+e);o=e,t=t||Ye({id:o}),i={dataSourceJson:t,dataSourceManager:this,id:o}}else if(e.dataSourceJson||e.belongToDataSource)i=e,o=i.dataSourceJson?i.dataSourceJson.id:i.belongToDataSource.getMainDataSource().id,i.dataViewId&&(t=i.dataViewId,delete i.dataViewId),i.localId&&(n=i.localId,delete i.localId),i.dataSourceManager=this,i.id=o;else{const t=e;o=t.id,i={dataSourceJson:t,dataSourceManager:this,id:o}}const s=e=>this.dataSourcesCreatePromise[e]?this.dataSourcesCreatePromise[e]:this.createDataSource(e),a=(e,t)=>{const n=this.getDataViewDataSourceId(e,t);return this.getDataSource(n)?Promise.resolve(this.getDataSource(n)):s(o).then(e=>this.createDataView(e,t))};return t&&n?a(o,t).then(e=>this.createLocalDataSource(e,n)):t?a(o,t):n?s(o).then(e=>this.createLocalDataSource(e,n)):this.createOriginDataSources(i.dataSourceJson).catch(t=>(console.error("Create origin data source error.",e,t),TE().dispatch(WA(o,Ya.CreateError)),Promise.reject(new gl(o,t)))).then(()=>this.dataSourcesCreatePromise[o]?this.dataSourcesCreatePromise[o]:(this.dispatchNotCreatedStatus(o),this.dataSourcesCreatePromise[o]=new Promise((e,t)=>{r?t(new gl(o,"Create error outside createDataSource method.")):e(this.createDataSourceObj(i))}).then(e=>e.ready().then(()=>e.fetchSchema()).then(t=>{var n,r,i;e.setFetchedSchema(t),0===Object.keys(e.getSchema()).length&&this.initSchema(e,t);const o=[];if(Object.keys((null===(n=e.getSchema())||void 0===n?void 0:n.fields)||{}).length){const t=this.createDataViewObj(e,Ad);o.push(t);if(!!(null===(i=null===(r=e.getDataSourceJson())||void 0===r?void 0:r.dataViews)||void 0===i?void 0:i[Dd])){const t=this.createDataViewObj(e,Dd);o.push(t)}}return o.reduce((e,t)=>e.then(()=>t.ready().then(()=>{this.afterCreate(t)})),Promise.resolve()).then(()=>{if(this.afterCreate(e),e.getDataSourceJson().isOutputFromWidget){const t=this.createDataViewObj(e,Rd);this.afterCreate(t)}return e})})).catch(t=>{const n=o&&(null==i?void 0:i.dataSourceJson),r=["not-authenticated","abort"],s=(null==t?void 0:t.isSignInError)||r.some(e=>{var n,r,i;return null===(i=null===(r=null===(n=null==t?void 0:t.name)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n))||void 0===i?void 0:i.includes(e)})||r.some(e=>{var n,r,i;return null===(i=null===(r=null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n))||void 0===i?void 0:i.includes(e)})||Object.keys(Tv.getInstance().getNoPermissionResourceInfoList()||{}).some(e=>{var t,n;return(null===(t=i.dataSourceJson.url)||void 0===t?void 0:t.includes(e))||(null===(n=i.dataSourceJson.portalUrl)||void 0===n?void 0:n.includes(e))||e.includes(i.dataSourceJson.itemId)});if(n&&s){const e=this.getErrorDataSourceId(o),t=Object.assign(Object.assign({},i),{id:e,dataSourceJson:i.dataSourceJson.set("id",e).set("type",Xa.Error)});this.dataSourcesCreatePromise[e]=this.createDataSourceObj(t).then(t=>(this.dataSources[e]=t,t))}return console.warn("Create data source error.",e,t),TE().dispatch(WA(o,Ya.CreateError)),Promise.reject(new gl(o,t))}),this.dataSourcesCreatePromise[i.dataSourceJson.id]))}createDataSourceAndWaitForChildrenReady(e){return hA(this,void 0,void 0,function*(){const t=yield this.createDataSource(e);return(null==t?void 0:t.isDataSourceSet())&&(yield t.childDataSourcesReady()),t})}createDataView(e,t){const n=this.getDataViewDataSourceId(e.id,t);if(this.getDataSource(n))return this.getDataSource(n);try{const n=this.createDataViewObj(e,t);return this.afterCreate(n),n}catch(n){return TE().dispatch(WA(this.getDataViewDataSourceId(e.id,t),Ya.CreateError)),null}}createLocalDataSource(e,t){const n=this.getLocalDataSourceId(e.id,t);return this.getDataSource(n)?this.getDataSource(n):this.createLocalDataSourceObj(e,t)}afterCreate(e){var t,n,r,i;this.dataSources[e.id]=e,this.dispatchCreatedStatus(e.id),e.isDataSourceSet()&&0===(null===(t=e.getChildIds())||void 0===t?void 0:t.length)&&e.setChildDataSourcesCreated(!0);const o=e.getMainDataSource().id;if(e.id!==o&&e.dataViewId!==Ad&&e.dataViewId!==Dd&&(null===(n=e.getMainDataSource().getSelectedRecordIds())||void 0===n?void 0:n.length)>0){const t=null===(i=null===(r=e.getMainDataSource().getSelectOptionsFromInfo())||void 0===r?void 0:r.asMutable)||void 0===i?void 0:i.call(r,{deep:!0});e.updateSelectionInfo(Object.assign(Object.assign({},t),{ids:e.getMainDataSource().getSelectedRecordIds()}),e.getMainDataSource())}}dispatchNotCreatedStatus(e){this.doNotBatchStatusDataSourceIds.has(e)?TE().dispatch(WA(e,Ya.NotCreated)):(this.notCreatedDataSourceIds.add(e),this.throttleDispatchPendedNotCreatedStatus())}dispatchCreatedStatus(e){const t=this.getDefaultDataSourceStatus(e);if(this.doNotBatchStatusDataSourceIds.has(e)||t===Ya.NotReady){const n=TE().getState().dataSourcesInfo[e];TE().dispatch(YA(e,Ye(Object.assign(Object.assign({},null!=n?n:{}),{instanceStatus:Ya.Created,status:t,countStatus:t}))))}else this.createdDataSourceIds.add(e),this.throttleDispatchPendedCreatedStatus()}dispatchPendedNotCreatedStatus(){if(this.notCreatedDataSourceIds.size){let e={};this.notCreatedDataSourceIds.forEach(t=>{var n;const r=null===(n=TE().getState().dataSourcesInfo[t])||void 0===n?void 0:n.asMutable({deep:!0});(null==r?void 0:r.instanceStatus)||(e=Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},null!=r?r:{}),{instanceStatus:Ya.NotCreated})}))}),Object.keys(e).length>0&&TE().dispatch(XA(Ye(e))),this.notCreatedDataSourceIds.clear()}}dispatchPendedCreatedStatus(){if(this.createdDataSourceIds.size){let e={};this.createdDataSourceIds.forEach(t=>{var n;const r=null===(n=TE().getState().dataSourcesInfo[t])||void 0===n?void 0:n.asMutable({deep:!0}),i=Ya.Unloaded;e=Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},null!=r?r:{}),{instanceStatus:Ya.Created,status:(null==r?void 0:r.status)||i,countStatus:(null==r?void 0:r.countStatus)||i})})}),TE().dispatch(XA(Ye(e))),this.createdDataSourceIds.forEach(e=>{var t,n;return null===(n=null===(t=this.getDataSource(e).parentDataSource)||void 0===t?void 0:t.updateAreChildDataSourcesCreated)||void 0===n?void 0:n.call(t)}),this.createdDataSourceIds.clear()}}getDefaultDataSourceStatus(e){const t=this.getDataSource(e);if(!t)return;const n=t.belongToDataSource&&t.belongToDataSource.getStatus(),r=n&&n!==Ya.NotReady;return t.getDataSourceJson().isOutputFromWidget&&!r?Ya.NotReady:Ya.Unloaded}getDataViewDataSourceId(e,t){return`${e}-${t}`}getLocalDataSourceId(e,t){return`${e}-${t}`}createDataSourceByUseDataSource(e,t,n){n||this.doNotBatchStatusDataSourceIds.add(e.dataSourceId);const r=this.getAppConfig().dataSources;return r[e.mainDataSourceId]?e.dataViewId?e.dataViewId===Ad||e.dataViewId===Rd||r[e.mainDataSourceId].dataViews[e.dataViewId]?this.createDataSource(e.mainDataSourceId,e.dataViewId,t):(console.error(`Can not find data view: ${e.mainDataSourceId}, ${e.dataViewId}`),Promise.reject(new gl(e.dataSourceId,"Can not find data source."))):this.createDataSource(e.mainDataSourceId,null,t):r[e.rootDataSourceId]?this.createDataSource(e.rootDataSourceId).then(t=>t.isDataSourceSet()&&t.createDataSourceById(e.mainDataSourceId)).then(()=>{const n=this.getDataSource(e.mainDataSourceId);return n?e.dataViewId?e.dataViewId===Ad||n.getDataSourceJson().dataViews[e.dataViewId]?this.createDataSource(n.getDataSourceJson(),e.dataViewId,t):(console.error(`Can not find data view: ${e.mainDataSourceId}, ${e.dataViewId}`),Promise.reject(new gl(e.dataSourceId,"Can not find data source."))):t?this.createDataSource(n.getDataSourceJson(),null,t):n:Promise.reject(new gl(e.dataSourceId,"Can not find data source."))}):(console.error("Can not find data source:",e.dataSourceId),Promise.reject(new gl(e.dataSourceId,"Can not find data source.")))}createDataSourceAndItsDataViewsByUseDataSource(e,t){return this.createDataSourceByUseDataSource(e,null,t).then(e=>(this.createDataViews(e),e)).catch(e=>null)}createOriginDataSources(e){return e.isOutputFromWidget&&e.originDataSources&&e.originDataSources.length>0?Promise.all(e.originDataSources.asMutable().map(e=>this.createDataSourceByUseDataSource(e))).then(()=>Promise.resolve()):Promise.resolve()}initSchema(e,t){e.setFetchedSchema(t);const n=e.getDataSourceJson().schema;if(e.getDataSourceJson().isOutputFromWidget)if(e.getDataSourceJson().schema)e.setSchema(e.getDataSourceJson().schema);else if(e.getDataSourceJson().originDataSources&&e.getDataSourceJson().originDataSources.length>0)if(1===e.getDataSourceJson().originDataSources.length){const t=this.getDataSource(e.getDataSourceJson().originDataSources[0].dataSourceId);e.setSchema(t&&t.getSchema())}else console.error("Data source created from more than one data source must save the schema in app config.");else console.error("Data source without origin data source must save the schema in app config.");else{if(TE().getState().appConfig.dataSources[e.id]&&(null==t?void 0:t.label)&&t.label!==e.getDataSourceJson().sourceLabel){Ww(TE().getState().appConfig.setIn(["dataSources",e.id,"sourceLabel"],t.label))}const r=this.mergeSchema(e,n,t);e.setSchema(r)}}mergeSchema(e,t,n){if(e.isDataSourceSet()){if(!t)return n;let r=t;const i=e.getReversedConfigSchema();return Object.keys(n.childSchemas).forEach(o=>{if(i.childSchemas[o])i.childSchemas[o].forEach(t=>{r=r.setIn(["childSchemas",t.jimuChildId],e.getChildDataSource(t.jimuChildId).getSchema())});else{if(t.childSchemas[o])return void console.warn("Layer existed, please re-map the data source.",e.id,o);r=r.setIn(["childSchemas",o],n.childSchemas[o])}}),Object.keys(t.childSchemas).forEach(e=>{const r=t.childSchemas[e].childId;n.childSchemas[r]||console.error("Used data is not found.",r)}),r}return this.mergeOneSchema(e,t,n)}mergeOneSchema(e,t,n){if(!t)return n;let r=t;const i=e.getReversedConfigSchema();return(null==n?void 0:n.fields)&&Object.keys(n.fields).forEach(o=>{if(i.fields[o])i.fields[o].forEach(e=>{r.fields[e.jimuName].alias||(r=r.setIn(["fields",e.jimuName,"alias"],n.fields[o].alias))});else{if(t.fields[o])return void console.warn("Field name existed, please re-map the data source.",e.id,o);const i=n.fields[o];r=r.setIn(["fields",o],i)}}),(null==t?void 0:t.fields)&&Object.keys(t.fields).forEach(e=>{const r=t.fields[e].name;(null==n?void 0:n.fields)&&!n.fields[r]&&console.error("Used field is not found.",r)}),r}getDataSourceFactory(e){try{let t=this.getDataSourceFactorySync(e);if(t)return Promise.resolve(t);const n=this.getDataSourceFactoryUri(e);return NI(n).then(e=>(t=new e.default,this.dataSourceFactories[n]=t,t))}catch(e){return Promise.reject(e)}}getDataSourceFactoryUri(e){const t=GI.getInstance().getExtensions(rg.DataSourceFactoryUri).filter(t=>t.getFactoryUri(e))[0];if(!t)throw Error("Unknown data source type:"+e);return t.getFactoryUri(e)}getDataSourceFactorySync(e){const t=this.getDataSourceFactoryUri(e),n=this.dataSourceFactories[t];if(n)return n}createDataSourceObj(e){return this.getDataSourceFactory(e.dataSourceJson.type).then(t=>{let n;try{n=t.createDataSource(e)}catch(t){return console.error("Create data source error.",e.dataSourceJson,t),Promise.reject(new Error(t))}return Promise.resolve(n)})}createDataViewObj(e,t){const n=this.getDataSourceFactoryUri(e.type),r=this.dataSourceFactories[n];if(!r)throw Error("Data source is not created");return r.createDataSource({id:this.getDataViewDataSourceId(e.id,t),dataViewId:t,belongToDataSource:e,dataSourceManager:this})}createLocalDataSourceObj(e,t){const n=this.getDataSourceFactoryUri(e.type),r=this.dataSourceFactories[n];if(!r)throw Error("Data source is not created");let i=null;try{i=r.createDataSource({id:this.getLocalDataSourceId(e.id,t),dataViewId:e.isDataView?e.dataViewId:null,localId:t,belongToDataSource:e,dataSourceManager:this}),this.afterCreate(i)}catch(n){console.error("Create local data source error.",e.id,t,n),TE().dispatch(WA(this.getLocalDataSourceId(e.id,t),Ya.CreateError))}return i}getAppConfig(){return TE().getState().appConfig}onStoreDataSourcesChange(e,t){e&&t&&Object.keys(e).forEach(n=>{if(t[n]){if(t[n]&&e[n]){const e=t[n],r=this.getDataSource(n);r&&(r.type!==e.type?ZE(()=>{this.destroyDataSource(n),this.createDataSource(n).then(e=>{this.createDataViews(e),window.jimuConfig.isInBuilder&&e.isDataSourceSet()&&e.childDataSourcesReady()})}):this.updateDataSourceByDataSourceJson(r,e))}}else ZE(()=>{this.destroyDataSource(n)})}),window.jimuConfig.isInBuilder&&e&&t&&Object.keys(t).forEach(t=>{var n;const r=TE().getState();e[t]||(null===(n=r.dataSourcesInfo[t])||void 0===n?void 0:n.instanceStatus)||this.createDataSource(t).then(e=>{this.createDataViews(e),e.isDataSourceSet()&&e.childDataSourcesReady()})})}onStoreResourceSessionsChange(e,t){ZE(()=>hA(this,void 0,void 0,function*(){const n=[],r=[];this.getDataSourcesAsArray().forEach(i=>{var o;if(i.getMainDataSource().id!==i.id)return;const s=i.getDataSourceJson().url&&(null===(o=fA.getInstance().getServerInfoByServiceUrl(i.getDataSourceJson().url))||void 0===o?void 0:o.owningSystemUrl),a=i.getDataSourceJson().url&&Jg(i.getDataSourceJson().url),l=hg(s||a),u=hg(i.getDataSourceJson().portalUrl&&xg(i.getDataSourceJson().portalUrl));if(!l&&!u)return;const c=l&&(null==e?void 0:e[l])!==(null==t?void 0:t[l]),d=u&&(null==e?void 0:e[u])!==(null==t?void 0:t[u]);if(c||d){c&&fA.getInstance().clearServiceInfo(i.getDataSourceJson().url);const e=i.getRootDataSource()||i;let t;if((null==e?void 0:e.type)===Xa.WebMap||(null==e?void 0:e.type)===Xa.WebScene)n.some(t=>t.id===e.id)||n.push(e),t=Ye({dataSourceId:e.id,mainDataSourceId:e.id});else{n.some(e=>e.id===i.id)||n.push(i);const r=i.type===Xa.Error?this.restoreErrorDataSourceId(i.id):i.id;t=Ye({dataSourceId:r,mainDataSourceId:r,rootDataSourceId:null==e?void 0:e.id})}r.some(e=>e.dataSourceId===t.dataSourceId)||r.push(t)}}),yield Promise.all(n.map(e=>e.isDataSourceSet()?e.areSomeChildDataSourcesPending().then(t=>t&&n.splice(n.indexOf(e),1)):Promise.resolve())),n.forEach(e=>{this.destroyDataSource(e.id)}),r.forEach(e=>{this.createDataSourceByUseDataSource(e).then(e=>e.isDataSourceSet()?e.childDataSourcesReady().then(()=>e):e)})}))}getErrorDataSourceId(e){return`error${e.charAt(0).toUpperCase()}${e.slice(1)}`}restoreErrorDataSourceId(e){const t=e.replace(/^error/,"");return`${t.charAt(0).toLowerCase()}${t.slice(1)}`}updateDataSourceByDataSourceJson(e,t){var n,r;if(t&&!wd(e.getDataSourceJson(),t)){if(wd(e.getDataSourceJson().query,null==t?void 0:t.query)||ZE(()=>{e.clearRecords(),e.clearSelection()}),e.getDataSourceJson().dataViews!==(null==t?void 0:t.dataViews)){const n=e.getDataSourceJson().dataViews,r=null==t?void 0:t.dataViews;n&&r&&Object.keys(n).forEach(i=>{if(r[i]){if(r[i]&&n[i]){const n=this.getDataViewDataSourceId(e.id,i),r=this.getDataSource(n);r&&(wd(r.getDataSourceJson().dataViews[i],t.dataViews[i])||ZE(()=>{r.clearRecords(),r.clearSelection()}))}}else ZE(()=>{this.destroyDataSource(this.getDataViewDataSourceId(e.id,i))})})}let i;if(e.isDataSourceSet()&&e.getDataSourceJson().childDataSourceJsons!==(null==t?void 0:t.childDataSourceJsons)&&e.getChildDataSources().forEach(e=>{var n;this.updateDataSourceByDataSourceJson(e,null===(n=null==t?void 0:t.childDataSourceJsons)||void 0===n?void 0:n[e.jimuChildId])}),(null===(n=e.getDataSourceJson().originDataSources)||void 0===n?void 0:n.length)===(null===(r=null==t?void 0:t.originDataSources)||void 0===r?void 0:r.length)){i=!e.getDataSourceJson().originDataSources||e.getDataSourceJson().originDataSources.every(e=>(null==t?void 0:t.originDataSources)&&(null==t?void 0:t.originDataSources.some(t=>t.dataSourceId===e.dataSourceId)))}else i=!1;const o=t&&(e.getDataSourceJson().schema!==t.schema||!i||e.getDataSourceJson().itemId!==t.itemId||e.getDataSourceJson().portalUrl!==t.portalUrl||e.getDataSourceJson().url!==t.url);e.setDataSourceJson(t),o&&(e.getDataSourceJson().isDataInDataSourceInstance?(e.clearSourceRecordsNotAddVersion(),this.initSchema(e,null)):(e.clearRecordsNotAddVersion(),e.fetchSchema().then(t=>{this.initSchema(e,t),e.addVersion()}))),ZE(()=>{e.addVersion()})}}}const mA=gA;var vA;function yA(e){return{type:vA.AppConfigLoaded,appConfig:e}}function SA(e){return{type:vA.AppConfigChanged,appConfig:e}}function bA(e){return{type:vA.AppPathChanged,path:e}}function wA(e){return{type:vA.AppInfoChanged,appInfo:e}}function IA(e){return{type:vA.AppIdChanged,appId:e}}function EA(e){return{type:vA.WidgetClassLoaded,widgetUri:e}}function OA(e,t){return{type:vA.WidgetsUpgraded,widgetUri:e,upgradeInfos:t}}function CA(e,t){return{type:vA.WidgetUpgraded,widgetId:e,upgradeInfo:t}}function TA(e,t){return{type:vA.WidgetConfigLoaded,widgetId:e,config:t}}function xA(e,t){return{type:vA.WidgetToolbarStateChange,widgetId:e,toolNames:t}}function AA(e,t,n){return{type:vA.WidgetRuntimeInfoChange,widgetId:e,prop:t,value:n}}function DA(e){return{type:vA.OpenWidget,widgetId:e}}function RA(e){return{type:vA.OpenWidgets,widgetIds:e}}function PA(e){return{type:vA.CloseWidget,widgetId:e}}function jA(e){return{type:vA.CloseWidgets,widgetIds:e}}function LA(e){return{type:vA.ResetWidgetsState,widgetIds:e}}function _A(e){return{type:vA.ActivateWidget,widgetId:e}}function MA(e){return{type:vA.AppContextInit,appContext:e}}function NA(e,t){return{type:vA.I18nMessagesLoaded,key:e,messages:t}}function kA(e){return{type:vA.QueryObjectChanged,query:e}}function UA(e){return{type:vA.UrlHashObjectChanged,hash:e}}function FA(){return{type:vA.SetAppInBuilder}}function BA(e){return{type:vA.AppModeChanged,mode:e}}function $A(e){return{type:vA.LayoutClassLoaded,layoutName:e}}function VA(e,t){var n;const r=null===(n=mA.getInstance())||void 0===n?void 0:n.getDataSource(e);return r&&t===Ya.NotReady&&(r.clearSourceRecordsNotAddVersion(),r.getAllDerivedDataSources().forEach(e=>{e.clearSourceRecordsNotAddVersion()})),r&&t===Ya.Unloaded&&(r.clearRecordsNotAddVersion(),r.getAllDerivedDataSources().forEach(e=>{e.clearRecordsNotAddVersion()})),{type:vA.DataSourceStatusChanged,dataSourceId:e,status:t}}function GA(e,t){return{type:vA.DataSourceCountStatusChanged,dataSourceId:e,countStatus:t}}function WA(e,t){return{type:vA.DataSourceInstanceStatusChanged,dataSourceId:e,status:t}}function HA(e,t){return{type:vA.DataSourceSaveStatusChanged,dataSourceId:e,saveStatus:t}}function zA(e){return{type:vA.DataSourceVersionAdded,dataSourceId:e}}function qA(e){return{type:vA.DataSourceSourceVersionAdded,dataSourceId:e}}function JA(e,t){return{type:vA.ChangeDataSourceGDBVersion,dataSourceId:e,gdbVersion:t}}function KA(e){return{type:vA.ClearDataSourceInfo,dataSourceId:e}}function YA(e,t){return{type:vA.UpdateDataSourceInfo,dataSourceId:e,dataSourceInfo:t}}function XA(e){return{type:vA.BatchUpdateDataSourceInfo,dataSourcesInfo:e}}function QA(e,t){return{type:vA.SetDataNeedRefresh,dataSourceId:e,refresh:t}}function ZA(e,t){return{type:vA.SetDataLastRefreshTime,dataSourceId:e,lastAutoRefreshCheckTime:t}}function eD(e,t,n){return{type:vA.UpdateWidgetQuery,dataSourceId:e,widgetId:t,query:n}}function tD(e,t){return{type:vA.JimuMapViewAdded,jimuMapViewId:e,jimuMapViewInfo:t}}function nD(e,t){return{type:vA.JimuMapViewUpdated,jimuMapViewId:e,jimuMapViewInfo:t}}function rD(e){return{type:vA.JimuMapViewRemoved,jimuMapViewId:e}}function iD(e,t){return{type:vA.RequestAutoControlMapWidget,mapWidgetId:e,autoControlWidgetId:t}}function oD(e){return{type:vA.ReleaseAutoControlMapWidget,mapWidgetId:e}}function sD(e,t){return{type:vA.MapWidgetInfoAdded,mapWidgetId:e,mapWidgetInfo:t}}function aD(e,t){return{type:vA.MapWidgetInfoUpdated,mapWidgetId:e,mapWidgetInfo:t}}function lD(e){return{type:vA.MapWidgetInfoRemoved,mapWidgetId:e}}function uD(e){return{type:vA.InitStoreExtensionState,extensionId:e}}function cD(e,t,n){return{type:vA.WidgetStatePropChange,widgetId:e,propKey:t,value:n}}function dD(e,t){return{type:vA.WidgetMutableStatePropChange,widgetId:e,propKey:t}}function pD(e){return{type:vA.SetPortalInfo,portalInfo:e}}function fD(e,t){return{type:vA.DataSourceSelectedIndexesChanged,dataSourceId:e,selectedIndexes:t}}function hD(e,t){return{type:vA.DataSourceSelectionChanged,dataSourceId:e,selectOptions:t}}function gD(e){return{type:vA.UserSignIn,user:e}}function mD(){return{type:vA.UserSignOut}}function vD(e){const t=window.document&&window.document.documentElement;return t&&(t.classList.remove(`size-mode-${La.Large}`),t.classList.remove(`size-mode-${La.Medium}`),t.classList.remove(`size-mode-${La.Small}`),t.classList.add(`size-mode-${e}`)),{type:vA.BrowserSizeModeChanged,browserSizeMode:e}}function yD(e,t){return{type:vA.SetWidgetIsInlineEditingState,widgetId:e,isInlineEditing:t}}function SD(e,t){return{type:vA.SetWidgetPreloadProps,widgetId:e,props:t}}function bD(e,t){return{type:vA.SetDataSourcePreloadData,dataSourceId:e,data:t}}function wD(e){return{type:vA.NetworkStatusChanged,isOffLine:e}}function ID(e){return{type:vA.CurrentPageChanged,pageId:e}}function ED(e){return{type:vA.CurrentDialogChanged,dialogId:e}}function OD(e){return{type:vA.DialogInfosChanged,dialogInfos:e}}function CD(e){return{type:vA.SelectionChanged,selection:e}}function TD(e){return{type:vA.ClipboardChanged,item:e}}function xD(e){return{type:vA.UpdateStoreState,state:e}}function AD(e){return{type:vA.AppRuntimeInfoInit,info:e}}function DD(e){return{type:vA.ThemeVariablesChanged,theme:e}}function RD(e){return{type:vA.SetPortalSelf,portalSelf:e}}function PD(e){return{part:e,type:vA.ActivePagePartChanged}}function jD(e){return{type:vA.ChangeThemeMode,value:e}}function LD(e,t){return{type:vA.OpenOverlay,id:e,modalId:t}}function _D(e){return{type:vA.CloseOverlay,id:e}}function MD(e){return{type:vA.ActiveOverlay,id:e}}function ND(e){return{type:vA.ZoomScaleChanged,zoomScale:e}}function kD(e,t,n){return{type:vA.SetIsBusy,isBusy:e,loadingType:t,loadingText:n}}function UD(e,t){return{type:vA.SectionNavInfoChanged,sectionId:e,navInfo:t}}function FD(e,t,n=!0){return{type:vA.ScreenGroupNavInfoChanged,screenGroupId:e,activeIndex:t,scrollIntoView:n}}function BD(e,t){return{type:vA.ScreenPanelVisibleChange,screenId:e,visible:t}}function $D(e){return{type:vA.SetupAnimationPreview,data:e}}function VD(){return{type:vA.ClearAnimationPreview}}function GD(e){return{type:vA.SetupHoverPreview,data:e}}function WD(e,t,n){return{type:vA.UserLocaleChanged,locale:e,translatedLocale:t,isRTL:n}}function HD(e){return{type:vA.SetSystemError,systemError:e}}function zD(e){return{type:vA.ClearSystemError,systemErrorType:e}}function qD(e,t,n,r){return{type:vA.AddToRegisterClientIdList,portalUrl:e,needToSignIn:t,forceLogin:r,serviceUrl:n}}function JD(e){return{type:vA.RemoveFromRegisterClientIdList,portalUrl:e}}function KD(){return{type:vA.UpdateNoPermissionResourceChangedFlag}}function YD(e,t){return{type:vA.UpdateResourceSessions,resourceRootUrl:e,userName:t}}function XD(){return{type:vA.ActivePrintPreview}}function QD(){return{type:vA.QuitPrintPreview}}function ZD(e,t,n){return{type:vA.UtilityStateChange,id:e,success:t,isSignInError:n}}function eR(e){return{type:vA.SaveThumbnailUrl,saveThumbnailUrl:e}}function tR(e){return{type:vA.OpenCookieBannerSetting,isSettingOpen:e}}function nR(e){return{type:vA.OpenCookieSettingsWindow,isCookieSettingsWindowOpen:e}}function rR(e){return{type:vA.OpenCookieBannerByPrivacyPanel,isCookieBannerOpenByPrivacyPanel:e}}function iR(e){return{type:vA.OpenCookieBannerByUrl,isCookieBannerOpenByUrl:e}}function oR(e,t){return{type:vA.CurrentGuideChange,guideId:e,shouldCheckGuideDisplay:t}}function sR(e,t){return{type:vA.ChangeDynamicStylePreviewConditionInfo,widgetId:e,value:t}}function aR(e,t){return{type:vA.ChangeDynamicStylePreviewRepeatedRecordInfo,widgetId:e,value:t}}function lR(e){return{type:vA.SetNoPermissionPages,pages:e}}!function(e){e.InitStoreExtensionState="INIT_STORE_EXTENSION_STATE",e.AppConfigLoaded="APP_CONFIG_LOADED",e.AppConfigChanged="APP_CONFIG_CHANGED",e.ThemeVariablesChanged="THEME_VARIABLES_CHANGED",e.SetPortalInfo="SET_PORTAL_INFO",e.SetPortalSelf="SET_PORTAL_SELF",e.WidgetClassLoaded="WIDGET_CLASS_LOADED",e.WidgetConfigLoaded="WIDGET_CONFIG_LOADED",e.WidgetsUpgraded="WIDGETS_UPGRADED",e.WidgetUpgraded="WIDGET_UPGRADED",e.OpenWidget="OPEN_WIDGET",e.OpenWidgets="OPEN_WIDGETS",e.CloseWidget="CLOSE_WIDGET",e.CloseWidgets="CLOSE_WIDGETS",e.ResetWidgetsState="RESET_WIDGETS_STATE",e.SetWidgetIsInlineEditingState="SET_WIDGET_IS_INLINE_EDITING_STATE",e.SetWidgetPreloadProps="SET_WIDGET_PRELOAD_PROPS",e.ActivateWidget="ACTIVATE_WIDGET",e.SetAppInBuilder="SET_APP_IN_BUILDER",e.LayoutClassLoaded="LAYOUT_CLASS_LOADED",e.AppContextInit="APP_CONTEXT_INIT",e.I18nMessagesLoaded="I18N_MESSAGES_LOADED",e.QueryObjectChanged="QUERY_OBJECT_CHANGED",e.UrlHashObjectChanged="URL_HASH_OBJECT_CHANGED",e.AppModeChanged="APP_MODE_CHANGED",e.SelectionChanged="SELECTION_CHANGED",e.AppRuntimeInfoInit="APP_RUNTIME_INFO_INIT",e.CurrentPageChanged="CURRENT_PAGE_CHANGED",e.CurrentDialogChanged="CURRENT_DIALOG_CHANGED",e.DialogInfosChanged="DIALOG_INFOS_CHANGED",e.ClipboardChanged="CLIPBOARD_CHANGED",e.AppPathChanged="APP_PATH_CHANGED",e.AppIdChanged="APP_ID_CHANGED",e.AppInfoChanged="APP_INFO_CHANGED",e.NetworkStatusChanged="NETWORK_STATUS_CHANGED",e.DataSourceStatusChanged="DATA_SOURCE_STATUS_CHANGED",e.DataSourceCountStatusChanged="DATA_SOURCE_COUNT_STATUS_CHANGED",e.DataSourceInstanceStatusChanged="DATA_SOURCE_INSTANCE_STATUS_CHANGED",e.DataSourceSaveStatusChanged="DATA_SOURCE_SAVE_STATUS_CHANGED",e.DataSourceVersionAdded="DATA_SOURCE_VERSION_ADDED",e.DataSourceSourceVersionAdded="DATA_SOURCE_SOURCE_VERSION_ADDED",e.DataSourceSelectedIndexesChanged="DATA_SOURCE_SELECTED_INDEXES_CHANGED",e.DataSourceSelectionChanged="DATA_SOURCE_SELECTION_CHANGED",e.SetDataSourcePreloadData="SET_DATA_SOURCE_PRELOAD_DATA",e.SetDataNeedRefresh="SET_DATA_NEED_REFRESH",e.SetDataLastRefreshTime="SET_DATA_LAST_REFRESH_TIME",e.UpdateWidgetQuery="UPDATE_WIDGET_QUERY",e.ChangeDataSourceGDBVersion="CHANGE_DATA_SOURCE_GDB_VERSION",e.ClearDataSourceInfo="CLEAR_DATA_SOURCE_INFO",e.UpdateDataSourceInfo="UPDATE_DATA_SOURCE_INFO",e.BatchUpdateDataSourceInfo="BATCH_UPDATE_DATA_SOURCE_INFO",e.JimuMapViewAdded="JIMU_MAP_VIEW_ADDED",e.JimuMapViewRemoved="JIMU_MAP_VIEW_REMOVED",e.JimuMapViewUpdated="JIMU_MAP_VIEW_UPDATED",e.MapWidgetInfoAdded="MAP_WIDGET_INFO_ADDED",e.MapWidgetInfoRemoved="MAP_WIDGET_INFO_REMOVED",e.MapWidgetInfoUpdated="MAP_WIDGET_INFO_UPDATED",e.RequestAutoControlMapWidget="REQUEST_AUTO_CONTROL_MAP_WIDGET",e.ReleaseAutoControlMapWidget="RELEASE_AUTO_CONTROL_MAP_WIDGET",e.WidgetStatePropChange="WIDGET_STATE_PROP_CHANGE",e.WidgetMutableStatePropChange="WIDGET_MUTABLE_STATE_PROP_CHANGE",e.UserSignIn="USER_SIGN_IN",e.UserSignOut="USER_SIGN_OUT",e.BrowserSizeModeChanged="BROWSER_SIZE_MODE_CHANGED",e.UpdateStoreState="UPDATE_STORE_STATE",e.ActivePagePartChanged="ACTIVE_PAGE_PART_CHANGED",e.ChangeThemeMode="CHANGE_THEME_MODE",e.OpenOverlay="OPEN_OVERLAY",e.CloseOverlay="CLOSE_OVERLAY",e.ActiveOverlay="ACTIVE_OVERLAY",e.SetIsBusy="SET_IS_BUSY",e.ZoomScaleChanged="ZOOM_SCALE_CHANGED",e.SectionNavInfoChanged="SECTION_NAV_INFO_CHANGED",e.SetupAnimationPreview="SETUP_ANIMATION_PREVIEW",e.ClearAnimationPreview="CLEAR_ANIMATION_PREVIEW",e.SetupHoverPreview="SETUP_HOVER_PREVIEW",e.ScreenGroupNavInfoChanged="SCREEN_GROUP_NAV_INFO_CHANGE",e.UserLocaleChanged="USER_LOCALE_CHANGED",e.SetSystemError="SET_SYSTEM_ERROR",e.ClearSystemError="CLEAR_SYSTEM_ERROR",e.AddToRegisterClientIdList="ADD_TO_REGISTER_CLIENT_ID_LIST",e.RemoveFromRegisterClientIdList="REMOVE_FROM_REGISTER_CLIENT_ID_LIST",e.UpdateNoPermissionResourceChangedFlag="UPDATE_NO_PERMISSION_RESOURCE_CHANGED_FLAG",e.UpdateResourceSessions="UPDATE_RESOURCE_SESSIONS",e.ScreenPanelVisibleChange="SCREEN_PANEL_VISIBLE_CHANGE",e.ActivePrintPreview="ACTIVE_PRINT_PREVIEW",e.QuitPrintPreview="QUIT_PRINT_PREVIEW",e.UtilityStateChange="UTILITY_STATE_CHANGE",e.SaveThumbnailUrl="SAVE_THUMBNAIL_URL",e.OpenCookieBannerSetting="OPEN_COOKIE_BANNER_SETTING",e.OpenCookieSettingsWindow="OPEN_COOKIE_SETTINGS_WINDOW",e.OpenCookieBannerByPrivacyPanel="OPEN_COOKIE_BANNER_BY_PRIVACY_PANEL",e.OpenCookieBannerByUrl="OPEN_COOKIE_BANNER_BY_URL",e.WidgetToolbarStateChange="WIDGET_TOOLBAR_STATE_CHANGE",e.WidgetRuntimeInfoChange="WIDGET_RUNTIME_INFO_CHANGE",e.CurrentGuideChange="CURRENT_GUIDE_CHANGE",e.ChangeDynamicStylePreviewConditionInfo="CHANGE_DYNAMIC_STYLE_PREVIEW_CONDITION_INFO",e.ChangeDynamicStylePreviewRepeatedRecordInfo="CHANGE_DYNAMIC_STYLE_PREVIEW_REPEATED_RECORD_INFO",e.SetNoPermissionPages="SET_NO_PERMISSION_PAGES"}(vA||(vA={}));const uR={ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",ControlLeft:"control",ControlRight:"control"},cR=e=>"code"in e?!!uR[e.code]:["Shift","Control","Alt","Meta"].includes(e.key),dR={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right"};function pR(e){if("undefined"==typeof window)return;let t=e.key;navigator.userAgent.includes("Edge")&&(cR(e)||dR[e.keyCode]||(t="key"+t));const n=new KeyboardEvent(e.type,{key:t+"-manual",code:e.code,location:e.location,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,repeat:e.repeat,charCode:e.charCode,keyCode:e.keyCode,which:e.which});document.dispatchEvent(n)}function fR(e,t,n,r){let i=Ye(e);const o=null==e?void 0:e.utilities;if(hR(o,t))return{id:gR(o,t),appConfig:e};{const e={id:mR(),type:n,source:"custom",url:t,label:r||vR(t)};return i=i.setIn(["utilities",e.id],e),{id:e.id,appConfig:null==i?void 0:i.asMutable({deep:!0})}}}const hR=(e,t)=>{var n;const r=null===(n=Object.keys(e||{}))||void 0===n?void 0:n.map(t=>{var n;return null===(n=e[t])||void 0===n?void 0:n.url});return null==r?void 0:r.includes(t)},gR=(e,t)=>{var n;let r;return null===(n=Object.keys(e||{}))||void 0===n||n.forEach(n=>{var i,o;(null===(i=e[n])||void 0===i?void 0:i.url)===t&&(r=null===(o=e[n])||void 0===o?void 0:o.id)}),r},mR=()=>ay("utility"),vR=e=>{var t;const n=e.match(/\/(\w*)\/(?:GP|NA|Geoenrichment|Geometry|Geocode)Server\/?(\w*)?\/?/);return 3===(null==n?void 0:n.length)?null!==(t=n[2])&&void 0!==t?t:n[1]:""};var yR,SR;!function(e){e.String="STRING",e.Number="NUMBER",e.Field="FIELD",e.Function="FUNCTION",e.Operator="OPERATOR",e.Order="ORDER",e.Unknown="UNKNOWN"}(yR||(yR={})),function(e){e.Average="AVERAGE",e.Count="COUNT",e.Sum="SUM",e.Max="MAX",e.Min="MIN",e.StandardDeviation="STANDARD_DEVIATION",e.PercentileDiscrete="PERCENTILE_DISCRETE",e.PercentileContinuous="PERCENTILE_CONTINUOUS"}(SR||(SR={}));const bR=Object.assign(Object.assign({},yR),{Arcade:"ARCADE"});var wR;!function(e){e.Count="count",e.Sum="sum",e.Min="min",e.Max="max",e.Avg="avg",e.Stddev="stddev",e.percentile_disc="percentile_disc",e.percentile_cont="percentile_cont"}(wR||(wR={}));const IR="esriFieldTypeOID",ER="EXPRESSION_RESOLVER";var OR;!function(e){e.ParamType="INVALID_PARAM_TYPE",e.ParamNumber="INVALID_NUMBER_OF_PARAMS",e.FuncType="INVALID_FUNCTION_TYPE",e.NeedRecord="NEED_RECORD",e.NeedDataSource="NEED_DATA_SOURCE"}(OR||(OR={}));var CR=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function TR(e,t,n,r,i){const o=[],s=(e,t)=>""===e&&FR(t)?0:e;return e.forEach(e=>{if(e.type===yR.Number||e.type===yR.String||e.type===yR.Field)o.push(e);else if(e.type===yR.Operator){const a=o.pop(),l=o.pop(),u=e.exp;let c=!1;(HR(l,i)||HR(a,i))&&(c=!0);let d=xR(l,t,n,c,r),p=xR(a,t,n,c,r);c||(d=s(d,l),p=s(p,a));const f=function(e,t,n){switch(n){case"*":return jR(e)&&jR(t)?parseFloat(e)*parseFloat(t):"";case"/":return jR(e)&&jR(t)?parseFloat(e)/parseFloat(t):"";case"-":return jR(e)&&jR(t)?parseFloat(e)-parseFloat(t):"";default:return jR(e)&&jR(t)?parseFloat(e)+parseFloat(t):`${e}${t}`}}(d,p,u);o.push(WR(f))}}),xR(o.pop(),t,n,i,r)}function xR(e,t,n,r,i){if(e.type===yR.Field)return AR(e,t,n,r,i);if(e.type===yR.Number){return r?Tb().formatNumber(parseFloat(e.exp),i):parseFloat(e.exp)}return e.type===yR.String?e.exp.replace(/^"/,"").replace(/"$/,""):void 0}function AR(e,t,n,r,i){let o="";const s=function(e,t,n){var r,i,o,s;if(t)return null===(r=t[e.dataSourceId])||void 0===r?void 0:r[0];let a;const l=YT(null==e?void 0:e.dataSourceId),u=mA.getInstance().getDataSource(null==e?void 0:e.dataSourceId);a=e.isFromRepeatedDataSourceContext?Array.isArray(n)?null===(i=n[0])||void 0===i?void 0:i.record:null===(o=n)||void 0===o?void 0:o.record:l?(null==u?void 0:u.useNoSelectionView())?u.getSourceRecords()[0]:null==u?void 0:u.getMainDataSource().getSelectedRecords()[0]:null==u?void 0:u.getRecords()[0];if((null==u?void 0:u.type)===Xa.BuildingComponentSubLayer){const e=u.getAssociatedDataSource();a=(null===(s=null==e?void 0:e.getRecords())||void 0===s?void 0:s.find(e=>e.getId()===a.getId()))||a}return a}(e,t,n);if(!s||!0===s.fake)throw new Error(OR.NeedRecord);if(!function(e){return!(!e||!e.getData||"function"!=typeof e.getData)}(s))return o;const a=e.jimuFieldName;return o=r?i&&MR(e)?Tb().formatNumber(s.getFieldValue(a),i):s.getFormattedFieldValue(a,Tb()):s.getFieldValue(a),null!=o?o:""}function DR(e,t,n,r){if(Object.values(SR).some(t=>t===e.exp)){const i=e.exp;return function(e,t,n,r,i){return CR(this,void 0,void 0,function*(){var o,s,a;if(null==e?void 0:e.length){let l;if(!((null===(o=e[0])||void 0===o?void 0:o.type)===yR.Field))return Promise.reject(new Error(OR.ParamType));if(l=n?yield function(e,t,n){const r=_R(e,t);if(!r)return Promise.reject(new Error(OR.ParamType));const i=n[e[0].dataSourceId];if(!i||0===i.length)return Promise.reject(new Error(OR.NeedRecord));const o=RR(i,e[0],t);if(!Array.isArray(o))return Promise.reject(o);return Promise.resolve($R(o,t,MP(e,t)))}(e,t,n):function(e){return YT(null==e?void 0:e.dataSourceId)}(e[0])?t!==SR.Min&&t!==SR.Max||!kR(e[0])&&!UR(e[0])?yield function(e,t){const n=_R(e,t);if(!n)return Promise.reject(new Error(OR.ParamType));const r=mA.getInstance().getDataSource(e[0].dataSourceId),i=r.useNoSelectionView()?r.getSourceRecords():r.getMainDataSource().getSelectedRecords();if(!i||0===i.length)return Promise.reject(new Error(OR.NeedRecord));const o=RR(i,e[0],t);if(!Array.isArray(o))return Promise.reject(o);return Promise.resolve($R(o,t,MP(e,t)))}(e,t):yield PR(e,t):function(e){return!!(null==e?void 0:e.isFromRepeatedDataSourceContext)}(e[0])?yield function(e,t,n){const r=_R([e],t);if(!r)return Promise.reject(new Error(OR.ParamType));if(t===SR.Count)return Promise.resolve(1);{const t=AR(e,null,n,!1,null);return Promise.resolve(t)}}(e[0],t,r):yield PR(e,t),i&&"number"==typeof l&&t!==SR.Count&&NR(e[0])){const t=BR(e[0]),n=mA.getInstance().getDataSource(null===(s=e[0])||void 0===s?void 0:s.dataSourceId);l=cp(n?Ix(l,n):l,null===(a=null==t?void 0:t.format)||void 0===a?void 0:a.dateFormat,Tb())}return l}return Promise.reject(new Error(OR.ParamNumber))})}(i===SR.Count?function(e,t){let n=null;const r=mA.getInstance().getDataSource(t);if(e&&0!==e.length)n=e;else if(r){const e=r&&r.getSchema(),i=e&&e.fields&&Object.keys(e.fields).find(t=>e.fields[t].esriType===IR),o=e&&e.fields&&e.fields[i];if(o)n=[{type:yR.Field,jimuFieldName:o.jimuName,dataSourceId:t,exp:`{${o.alias||o.name}}`}];else if(e&&e.fields&&Object.keys(e.fields).length>0){const r=Object.keys(e.fields)[0],i=e.fields[r];i&&(n=[{type:yR.Field,jimuFieldName:i.jimuName,dataSourceId:t,exp:`{${i.alias||i.name}}`}])}}return n}(e.parts,e.dataSourceId):e.parts,i,t,n,r)}return Promise.reject(new Error(OR.FuncType))}function RR(e,t,n){let r=e.map(e=>e.getFieldValue(t.jimuFieldName));return r=r.filter(e=>null!==e),0===r.length&&[SR.Max,SR.Min].some(e=>e===n)&&NR(t)?OR.NeedRecord:r}function PR(e,t){return CR(this,void 0,void 0,function*(){if(!_R(e,t))return Promise.reject(new Error(OR.ParamType));const n=yield function(e,t){if(!(null==e?void 0:e.length)||!t)return Promise.resolve(null);const n=e[0],r=mA.getInstance().getDataSource(n.dataSourceId),i=function(e,t){const n=`${ER}-${t}-${e.jimuFieldName}`;return n}(n,t),o=mA.getInstance().createLocalDataSource(r,i);if(r&&r.load){const s=function(e,t){if(!(null==e?void 0:e.length))return null;const n=mA.getInstance().getDataSource(e[0].dataSourceId),r=n&&n.getSchema(),i=r&&r.fields&&r.fields[e[0].jimuFieldName];if(t===SR.Count&&(null==i?void 0:i.name)!==n.getIdField())return{returnGeometry:!1,returnDistinctValues:!0,returnCountOnly:!0,outFields:[null==i?void 0:i.name],where:"1=1",orderByFields:void 0,returnIdsOnly:!1};{const n=function(e,t){return`${t||"objectId"}_${e}`}(t,i&&i.jimuName),r=MP(e,t);r&&(r.value=r.value/100);return{returnGeometry:!1,where:"1=1",outStatistics:[{onStatisticField:i&&i.name,outStatisticFieldName:n,statisticType:LR(t),statisticParameters:r}]}}}(e,t);return(s.returnCountOnly?o.loadCount(s,{widgetId:i}):o.load(s,{widgetId:i})).then(e=>{var i,s,a,l,u;let c;if("number"==typeof e)c=[e];else{const t=e,n=t&&t[0]&&t[0].getData()||{};c=Object.keys(n).filter(e=>e!==o.getIdField()).map((e,t)=>n[e])}if(t===SR.Count){const e=r.isDataView?(null===(s=null===(i=r.getMainDataSource())||void 0===i?void 0:i.getDataSourceJson())||void 0===s?void 0:s.dataViews)&&(null===(a=r.getMainDataSource().getDataSourceJson().dataViews[r.dataViewId])||void 0===a?void 0:a.maximum):null===(u=null===(l=r.getDataSourceJson())||void 0===l?void 0:l.query)||void 0===u?void 0:u.maximum;"number"==typeof e&&(c[0]=Math.min(c[0],e))}return[SR.Max,SR.Min].some(e=>e===t)&&NR(n)&&c.some(e=>!jR(e))?Promise.reject(new Error(OR.NeedDataSource)):"number"!=typeof c[0]&&[SR.Average,SR.Sum,SR.Count].includes(t)?0:c[0]})}return Promise.reject(new Error(OR.NeedDataSource))}(e,t);return Promise.resolve(n)})}function jR(e){return!isNaN(parseFloat(e))&&isFinite(e)&&"[object Number]"===Object.prototype.toString.call(e)}function LR(e){switch(e){case SR.Average:return wR.Avg;case SR.Count:return wR.Count;case SR.Sum:return wR.Sum;case SR.Max:return wR.Max;case SR.Min:return wR.Min;case SR.StandardDeviation:return wR.Stddev;case SR.PercentileDiscrete:return wR.percentile_disc;case SR.PercentileContinuous:return wR.percentile_cont;default:throw new Error(`Unhandled case: ${e}`)}}function _R(e,t){var n;if(!(null==e?void 0:e.length))return!1;const r=e[0],i=mA.getInstance().getDataSource(r.dataSourceId),o=null==i?void 0:i.getSchema(),s=r.jimuFieldName,a=null===(n=null==o?void 0:o.fields)||void 0===n?void 0:n[s];return t===SR.Count?!!a:t===SR.Min||t===SR.Max?(null==a?void 0:a.type)===_a.Number||(null==a?void 0:a.type)===_a.Date||(null==a?void 0:a.type)===_a.DateOnly||(null==a?void 0:a.type)===_a.TimeOnly:t===SR.PercentileContinuous||t===SR.PercentileDiscrete?(null==a?void 0:a.type)===_a.Number&&e.some(e=>e.type===yR.Number):(null==a?void 0:a.type)===_a.Number}function MR(e){var t;if(!e||e.type!==yR.Field)return!1;const n=mA.getInstance().getDataSource(e.dataSourceId),r=null==n?void 0:n.getSchema(),i=e.jimuFieldName,o=null===(t=null==r?void 0:r.fields)||void 0===t?void 0:t[i],s=!(!n||!dT(n.getLayerDefinition(),e.jimuFieldName));return(null==o?void 0:o.type)===_a.Number&&!s}function NR(e){if(!e||e.type!==yR.Field)return!1;const t=BR(e);return(null==t?void 0:t.type)===_a.Date}function kR(e){if(!e||e.type!==yR.Field)return!1;const t=BR(e);return(null==t?void 0:t.type)===_a.DateOnly}function UR(e){if(!e||e.type!==yR.Field)return!1;const t=BR(e);return(null==t?void 0:t.type)===_a.TimeOnly}function FR(e){if(!e||e.type!==yR.Field)return!1;const t=BR(e);return(null==t?void 0:t.type)===_a.Number}function BR(e){var t;if(!e||e.type!==yR.Field)return null;const n=mA.getInstance().getDataSource(e.dataSourceId),r=null==n?void 0:n.getSchema(),i=e.jimuFieldName;return null===(t=null==r?void 0:r.fields)||void 0===t?void 0:t[i]}function $R(e,t,n){if(!e||0===e.length||t!==SR.Count&&e.some(e=>!jR(e)))return 0;switch(t){case SR.Average:return e.length?e.reduce((e,t)=>e+t,0)/e.length:0;case SR.Sum:return e.reduce((e,t)=>e+t,0);case SR.Count:return Array.from(new Set(e)).length;case SR.Max:return Math.max.apply(null,e);case SR.Min:return Math.min.apply(null,e);case SR.StandardDeviation:return function(e){if(!(null==e?void 0:e.length)||e.length<2)return 0;const t=e.reduce((e,t)=>e+t,0)/e.length;return Math.sqrt(e.map(e=>Math.pow(e-t,2)).reduce((e,t)=>e+t,0)/(e.length-1))}(e);case SR.PercentileDiscrete:return VR(e,n);case SR.PercentileContinuous:return VR(e,n,!0);default:throw new Error(`Unhandled case: ${t}`)}}function VR(e,t,n=!1){if(!(null==e?void 0:e.length)||!(null==t?void 0:t.value))return 0;const r=e.sort((e,n)=>"DESC"===t.orderBy?n-e:e-n);if(n){const e=t.value/100*(r.length-1),n=Math.floor(e),i=Math.ceil(e);if(n===i)return r[n];{const t=r[n];return t+(r[i]-t)*(e-n)/(i-n)}}return r[Math.ceil(t.value/100*r.length)-1]}function GR(e){let t=[];const n=[];return e&&e.forEach((r,i)=>{if(r&&!n.some(e=>e===i))if(r.type!==yR.Function)t=t.concat(r);else if(n.push(i),e[i+1]&&e[i+1].type===yR.Operator&&"("===e[i+1].exp){const o=e.slice(i+2);let s=0,a=0;for(let e=0;e<o.length;e++){if(0===a&&o[e].type===yR.Operator&&")"===o[e].exp){s=e;break}a>0&&o[e].type===yR.Operator&&")"===o[e].exp?a--:o[e].type===yR.Operator&&"("===o[e].exp&&a++}const l=s+i+2;if(l>=i+2){const o=e.slice(i+2,l);for(let e=i+1;e<=l;e++)n.push(e);t=t.concat(Object.assign(Object.assign({},r),{parts:GR(o)}))}else console.warn("Can not match parentheses")}else t=t.concat(r)}),t}function WR(e){return jR(e)?{exp:`${e}`,type:yR.Number}:{exp:`"${e.replace(/^"/,"").replace(/"$/,"")}"`,type:yR.String}}function HR(e,t){var n;const r=t?MR:FR;return e.type===yR.String||e.type===yR.Field&&mA.getInstance().getDataSource(e.dataSourceId)&&!r(e)||e.type===yR.Function&&e.exp!==SR.Count&&NR(null===(n=e.parts)||void 0===n?void 0:n[0])}function zR(e){var t;return e.type===yR.Field&&NR(e)||e.type===yR.Function&&e.exp!==SR.Count&&NR(null===(t=e.parts)||void 0===t?void 0:t[0])}function qR(e){if(DP(e))return e.parts[0].valueType;const t=GR(null==e?void 0:e.parts);return 1===t.length&&t.every(e=>zR(e))?_a.Date:1===t.length&&t.every(e=>function(e){var t;return e.type===yR.Field&&kR(e)||e.type===yR.Function&&e.exp!==SR.Count&&kR(null===(t=e.parts)||void 0===t?void 0:t[0])}(e))?_a.DateOnly:1===t.length&&t.every(e=>function(e){var t;return e.type===yR.Field&&UR(e)||e.type===yR.Function&&e.exp!==SR.Count&&UR(null===(t=e.parts)||void 0===t?void 0:t[0])}(e))?_a.TimeOnly:t.every(e=>function(e){var t;return e.type===yR.Number||e.type===yR.Field&&FR(e)||e.type===yR.Function&&(e.exp===SR.Count||FR(null===(t=e.parts)||void 0===t?void 0:t[0]))}(e))?_a.Number:_a.String}var JR,KR=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function YR(e,t,n,r){return KR(this,void 0,void 0,function*(){const i=e&&e.parts&&e.parts.slice();if(!i)return yield Promise.resolve("");const o=GR(i);if(!r&&1===o.length&&zR(o[0])){if(o[0].type===yR.Function)return DR(o[0],t,n,!1).then(e=>e?new Date(e):"");if(o[0].type===yR.Field){const e=AR(o[0],t,n,!1,null);return Promise.resolve(e?new Date(e):"")}}const s=function(e){const t=[],n=[];for(e.forEach((e,r)=>{if(e.type===yR.Number||e.type===yR.String||e.type===yR.Field||e.type===yR.Function)t.push(e);else if(e.type===yR.Operator)if("("===e.exp)n.push(e);else if(")"===e.exp){let e=n.pop();for(;"("!==e.exp;)t.push(e),e=n.pop()}else if("+"===e.exp||"-"===e.exp){for(;n.length>0&&("+"===n[n.length-1].exp||"-"===n[n.length-1].exp||"*"===n[n.length-1].exp||"/"===n[n.length-1].exp);)t.push(n.pop());n.push(e)}else if("*"===e.exp||"/"===e.exp){for(;n.length>0&&("*"===n[n.length-1].exp||"/"===n[n.length-1].exp);)t.push(n.pop());n.push(e)}});n.length>0;)t.push(n.pop());return t}(o);return Promise.all(s.map(e=>e.type===yR.Function?DR(e,t,n,!0).then(e=>WR(e)):Promise.resolve(e))).then(i=>{const o=TR(i,t,n,e.numberFormat,r);return r?`${null!=o?o:""}`:null!=o?o:""})})}!function(e){e.Value="VALUE",e.Style="STYLE"}(JR||(JR={}));const XR=["value"],QR=["background","text","border","borderRadius","icon"],ZR=XR.concat(QR);var eP;function tP(){const e=TE().getState();return window.jimuConfig.isBuilder?null==e?void 0:e.appStateInBuilder:e}function nP(e){return!!iP(e)}function rP(e){var t,n;let r=null;try{const i=iP(e);if(i){const o=tP(),s=null==o?void 0:o.appConfig;if(s){const o=null===(t=null==s?void 0:s.widgets)||void 0===t?void 0:t[i],a=null==o?void 0:o.useDataSources;if(1===(null==a?void 0:a.length)){const t=a[0],i=null===(n=null==s?void 0:s.widgets)||void 0===n?void 0:n[e],o=null==i?void 0:i.useDataSources;if(t&&(null==o?void 0:o.length)>0){const e=[];o.forEach(t=>{const n=null==t?void 0:t.dataSourceId;n&&e.push(n)}),t.dataSourceId&&e.includes(t.dataSourceId)&&(r=t)}}}}}catch(e){r=null,console.error("tryGetRepeatedUseDataSource error",e)}return r}function iP(e){var t,n,r,i,o,s;let a="";try{if(!e)return a;let l=null;const u=MI("jimu-layouts/layout-runtime").searchUtils,c=tP(),d=null==c?void 0:c.appConfig,p=null==c?void 0:c.browserSizeMode;if(d&&(p&&(l=u.getParentWidgetIdOfContent(d,e,$v.Widget,p)),l||(l=u.getParentWidgetIdOfContent(d,e,$v.Widget,d.mainSizeMode))),l){const e=null===(t=null==d?void 0:d.widgets)||void 0===t?void 0:t[l];(null===(r=null===(n=null==e?void 0:e.manifest)||void 0===n?void 0:n.properties)||void 0===r?void 0:r.canProvideRepeatDataSource)&&(a=l)}if(!a){const t=null===(i=null==d?void 0:d.widgets)||void 0===i?void 0:i[e];(null===(s=null===(o=null==t?void 0:t.manifest)||void 0===o?void 0:o.properties)||void 0===s?void 0:s.canProvideRepeatDataSource)&&(a=e)}}catch(e){a="",console.error("tryGetRepeatDataSourceProviderWidgetId error",e)}return a}function oP(e){var t;try{const n=tP(),r=null==n?void 0:n.appConfig;if(!r)return!1;if(nP(e))return!0;let i=0;const o=Ty(e);for(let e=0;e<o.length;e++){const n=o[e],s=null===(t=r.widgets)||void 0===t?void 0:t[n];if(i+=aP(s),i>=$d)return!1}return!0}catch(e){return console.error("canAddNewDataSourcesProfileArcadeContent error",e),!1}}function sP(e){var t;try{const n=tP(),r=null==n?void 0:n.appConfig;if(!r)return 0;if(nP(e))return 1/0;let i=0;const o=Ty(e);for(let e=0;e<o.length;e++){const n=o[e],s=null===(t=r.widgets)||void 0===t?void 0:t[n];i+=aP(s)}return $d-i}catch(e){return console.error("getWidgetRestAvailableArcadeContentCount error",e),0}}function aP(e){var t;let n=0;const r=null==e?void 0:e.config,i=null===(t=null==r?void 0:r.asMutable)||void 0===t?void 0:t.call(r,{deep:!0});if(i){let e=JSON.stringify(i);e=e.replace(/%22/g,'"');const t=function(e){const t=new RegExp(`(['"])(${Bd}[\\w-]+)\\1`,"gi"),n=[...e.matchAll(t)],r=new Set(n.map(e=>e[2]));return Array.from(r)}(e);n=t.length}return n}function lP(e,t,n){if(!e||!n)return n;const r=n.asMutable({deep:!0});r.scriptContent=uP(e,t,n.scriptContent);const i=null==r?void 0:r.useDataSources;return(null==i?void 0:i.length)>0&&i.forEach((t,n)=>{const r=KT(e,t);if(r.isChanged){const e=r.useDataSource||t;i[n]=e}}),Ye(r)}function uP(e,t,n){n||(n="");const r=null==t?void 0:t.useDataSources;return e&&(null==r?void 0:r.length)>0?(null==r||r.forEach(t=>{var r;const i=null==t?void 0:t.dataSourceId;if(i){const o=KT(e,t),s=null===(r=null==o?void 0:o.useDataSource)||void 0===r?void 0:r.dataSourceId;s&&i!==s&&(n=n.replace(new RegExp(`"${i}"`,"g"),`"${s}"`).replace(new RegExp(`'${i}'`,"g"),`'${s}'`))}}),n):n}function cP(e,t,n,r,i){let o=function(e,t,n,r){if(!r||!n||0===n.length)return null;const i=dP(t),o=dP(n),{added:s,deleted:a}=$w(!0,i,o);if(0===a.length)return r;if(nP(e)){const e=[],i=[];return(null==n?void 0:n.length)>0&&s.length>0&&n.forEach(t=>{s.includes(t.dataSourceId)&&e.push(t)}),(null==t?void 0:t.length)>0&&a.length>0&&t.forEach(e=>{a.includes(e.dataSourceId)&&i.push(e)}),function(e,t,n,r){var i,o,s;if(!r||!e||0===e.length)return null;const a=r.useDataSources;if(!a||0===a.length)return r;const l=dP(a),u=dP(e),{deleted:c}=$w(!0,l,u);if(0===c.length)return r;let d=!1;if(1===(null==t?void 0:t.length)&&1===(null==n?void 0:n.length)&&1===(null==a?void 0:a.length)){const e=null===(i=t[0])||void 0===i?void 0:i.mainDataSourceId,r=null===(o=n[0])||void 0===o?void 0:o.mainDataSourceId,l=null===(s=a[0])||void 0===s?void 0:s.mainDataSourceId;d=l&&e===l&&r===l}if(d){const e=t[0].dataSourceId,n=a.map(t=>t.set("dataSourceId",e));return r.set("useDataSources",n)}return null}(n,e,i,r)}return null}(e,t,n,r);return r&&!o&&i&&(o=function(e,t){if(!t)return t;const n=dP(e),r=t.useDataSources;if((null==r?void 0:r.length)>0){const e=r.filter(e=>{const t=e.dataSourceId;return n.includes(t)});t=t.set("useDataSources",e)}return t}(n,r)),o}function dP(e){const t=[];return(null==e?void 0:e.length)>0&&e.forEach(e=>{const n=null==e?void 0:e.dataSourceId;n&&t.push(n)}),t}function pP(e,t){const n=[];let r={valid:!0,invalidKeys:n,validValue:e};try{if(vP(e)){const t=[];mP(e,ZR);const i=function(){let e=["fit","fill","center","tile","stretch"],t=["solid","dashed","dotted","double"],n=["px","rem","em","vw","%"];try{const r=MI("jimu-ui"),i=null==r?void 0:r.FillType,o=null==r?void 0:r.NormalLineType,s=null==r?void 0:r.DistanceUnits;i&&(e=[i.FIT,i.FILL,i.CENTER,i.TILE,i.STRETCH]),o&&(t=[o.SOLID,o.DASHED,o.DOTTED,o.DOUBLE]),s&&(n=[s.PIXEL,s.REM,s.EM,s.VW,s.PERCENTAGE])}catch(e){console.error("get jimu-ui module error",e)}e||(e=["fit","fill","center","tile","stretch"]);t||(t=["solid","dashed","dotted","double"]);n||(n=["px","rem","em","vw","%"]);const r={background:{name:"background",type:"dictionary",properties:[{name:"color",type:"text"},{name:"fillType",type:"text",enums:e},{name:"image",type:"text"}]},text:{name:"text",type:"dictionary",properties:[{name:"size",type:"number"},{name:"color",type:"text"},{name:"bold",type:"boolean"},{name:"italic",type:"boolean"},{name:"underline",type:"boolean"},{name:"strike",type:"boolean"}]},border:{name:"border",type:"dictionary",properties:[{name:"border",type:"dictionary",properties:[{name:"type",type:"text",enums:t},{name:"color",type:"text"},{name:"width",type:"number"}]},{name:"borderLeft",type:"dictionary",properties:[{name:"type",type:"text",enums:t},{name:"color",type:"text"},{name:"width",type:"number"}]},{name:"borderRight",type:"dictionary",properties:[{name:"type",type:"text",enums:t},{name:"color",type:"text"},{name:"width",type:"number"}]},{name:"borderTop",type:"dictionary",properties:[{name:"type",type:"text",enums:t},{name:"color",type:"text"},{name:"width",type:"number"}]},{name:"borderBottom",type:"dictionary",properties:[{name:"type",type:"text",enums:t},{name:"color",type:"text"},{name:"width",type:"number"}]}]},borderRadius:{name:"borderRadius",type:"dictionary",properties:[{name:"unit",type:"text",enums:n},{name:"number",type:"array",elementType:{type:"number"},minCount:0,maxCount:1/0}]},icon:{name:"icon",type:"dictionary",properties:[{name:"name",type:"text"},{name:"position",type:"text",enums:["LEFT","RIGHT"]},{name:"size",type:"number"},{name:"color",type:"text"}]}};return r}();ZR.forEach(o=>{if(o in e)if("value"===o)"number"==typeof(s=e[o])||"string"==typeof s||s instanceof Date||(e[o]=null,r.valid=!1);else{const s=fP(i[o],e[o],t,n);e[o]=null==s?void 0:s.validValue;(null==s?void 0:s.valid)||(r.valid=!1)}var s})}else r={valid:!1,invalidKeys:n,validValue:null};const i=r.validValue;i&&(null==t?void 0:t.length)>0&&mP(i,t)}catch(e){r={valid:!1,invalidKeys:n,validValue:null},console.error("validateArcadeScriptResult error",e)}const i=null==r?void 0:r.validValue,o=null==i?void 0:i.borderRadius;return o&&!o.unit&&(i.borderRadius=null),r||(r={valid:!1,invalidKeys:n,validValue:null}),r.invalidKeys||(r.invalidKeys=n),n.length>0&&(r.valid=!1),r.validValue&&gP(r.validValue),r}function fP(e,t,n,r){var i;n=n?n.slice():[],r||(r=[]);let o=null;if(!e)return o={valid:!1,validValue:null},null;const s=e.type;if("dictionary"===s)if(vP(t)){const i=e.properties,s=i.map(e=>e.name);mP(t,s);let a=!0;i.forEach(i=>{const o=i.name;if(o in t){const s=fP(i,t[o],n.concat(e.name),r);t[o]=s.validValue,s.valid||(a=!1)}}),o={valid:a,validValue:t}}else o={valid:!1,validValue:null},hP(n,e.name,r);else if("text"===s){const i=e.enums,s=(null==i?void 0:i.length)>0?function(e,t){return bP(e)&&t.includes(e)}(t,i):SP(t);s?o={valid:!0,validValue:t}:(o={valid:!1,validValue:null},hP(n,e.name,r))}else if("number"===s)yP(t)?o={valid:!0,validValue:t}:(o={valid:!1,validValue:null},hP(n,e.name,r));else if("boolean"===s)wP(t)?o={valid:!0,validValue:t}:(o={valid:!1,validValue:null},hP(n,e.name,r));else if("array"===s){const s=e.minCount,a=e.maxCount,l=null===(i=e.elementType)||void 0===i?void 0:i.type;let u=!1;if(Array.isArray(t)){const e=t.length;(!(s>=0)||e>=s)&&(!(a>=0)||e<=a)&&(u=!(e>0)||("text"===l?t.every(e=>bP(e)):"number"===l?t.every(e=>yP(e)):"boolean"===l&&t.every(e=>wP(e))))}u?o={valid:!0,validValue:t}:(o={valid:!1,validValue:null},hP(n,e.name,r))}return o||(o={valid:!1,validValue:null}),o}function hP(e,t,n){const r=e.concat(t).join(".");n.push(r)}function gP(e){if(e&&"object"==typeof e)if(Array.isArray(e))e.forEach&&e.forEach(e=>{gP(e)});else{Object.keys(e).forEach(t=>{const n=e[t];""===n||null==n?delete e[t]:gP(n)})}}function mP(e,t){Object.keys(e).forEach(n=>{t.includes(n)||delete e[n]})}function vP(e){if(!e)return!1;if("object"!=typeof e||null===e)return!1;if(e.declaredClass)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}function yP(e){return"number"==typeof e&&!Number.isNaN(e)}function SP(e){return"string"==typeof e}function bP(e){return SP(e)&&!!e}function wP(e){return"boolean"==typeof e}!function(e){e.FeatureProfile="FEATURE_PROFILE",e.DataSourcesProfile="DATASOURCES_PROFILE"}(eP||(eP={}));var IP=a(9244);function EP(e,t){if(!t||0===t.length)return t;if(!e||0===e.length)return jP(t);const n=jP(t).asMutable({deep:!0});return e.forEach(e=>{var r,i;if(null===(r=null==e?void 0:e.useDataSources)||void 0===r?void 0:r.length){e.useDataSources.forEach(e=>{var r;if(null===(r=null==e?void 0:e.fields)||void 0===r?void 0:r.length){const r=e.dataSourceId&&t.asMutable({deep:!0}).findIndex(t=>t.dataSourceId===e.dataSourceId);n[r]&&(n[r]=Object.assign(Object.assign({},n[r]),{fields:Array.from(new Set((n[r].fields||[]).concat(e.fields)))}))}})}else if((null==e?void 0:e.dataSourceId)&&(null==e?void 0:e.jimuFieldName)){let r;const o=e;r=YT(o.dataSourceId)?o.dataSourceId&&t.asMutable({deep:!0}).findIndex(e=>e.mainDataSourceId===o.dataSourceId.replace(new RegExp(`-${Ad}$`),"")):o.dataSourceId&&t.asMutable({deep:!0}).findIndex(e=>e.dataSourceId===o.dataSourceId),n[r]&&!(null===(i=n[r].fields)||void 0===i?void 0:i.some(e=>e===o.jimuFieldName))&&(n[r]=Object.assign(Object.assign({},n[r]),{fields:(n[r].fields||[]).concat(o.jimuFieldName)}))}}),Ye(n)}function OP(e){if(!e||0===e.length)return null;const t=[];return e.forEach(e=>{if(null==e?void 0:e.dataSourceId){const n=t.findIndex(t=>t.dataSourceId===e.dataSourceId);-1===n?t.push(Object.assign(Object.assign({},qT(e.dataSourceId)),{fields:e.jimuFieldName?[e.jimuFieldName]:[]})):e.jimuFieldName&&!t[n].fields.some(t=>t===e.jimuFieldName)&&t[n].fields.push(e.jimuFieldName)}}),Ye(t)}function CP(e=Ye([]),t=Ye([])){let n=Ye([]),r=Ye({});const i=Ye(e.concat(t)),o={};return i.forEach(e=>{o[e.dataSourceId]||(o[e.dataSourceId]=i.filter(t=>e.dataSourceId===t.dataSourceId))}),Object.keys(o).forEach(e=>{r=Ye({}),o[e].forEach(e=>{r=function(e,t){if(!e||!t)return e||t;if(e.dataSourceId&&t.dataSourceId&&e.dataSourceId!==t.dataSourceId)return console.warn("can not merge data sources with different id"),null;if(!e.dataSourceId&&!t.dataSourceId)return e;if(e.fields&&t.fields){const n=Array.from(new Set(e.fields.asMutable().concat(t.fields.asMutable())));return e.merge(t.asMutable({deep:!0})).set("fields",n)}return e.merge(t.asMutable({deep:!0}))}(r,e)}),n=Ye(n.concat(r))}),n}function TP(e){if(!e||!e.parts)return!0;const t=e.parts.filter(e=>!!e),n=t.some(e=>e.type===yR.Unknown);if(n)return!1;const r=t.filter(e=>e.type===yR.Operator&&"("===e.exp).length===t.filter(e=>e.type===yR.Operator&&")"===e.exp).length;if(!r)return!1;const i=t.filter(e=>!(e.type===yR.Operator&&("("===e.exp||")"===e.exp||/^\s*$/.test(e.exp))||e.type===yR.Function));let o=!0;for(let e=0;e<i.length;e++)if((e%2==0||e===i.length-1)&&i[e].type===yR.Operator||e%2==1&&i[e].type!==yR.Operator){o=!1;break}if(!o)return!1;let s=!0;for(let e=0;e<t.length;e++)if(t[e].type===yR.Function&&!xP(t[e])||t[e].type===yR.Field&&!AP(t[e].dataSourceId,t[e].jimuFieldName,t[e].exp.replace(/^\{/,"").replace(/\}$/,""))){s=!1;break}if(!s)return!1;const a=GR(t),l=!a.some(e=>e.type===yR.Operator&&","===e.exp);if(!l)return!1;const u=a.every(e=>{var t;if(e.type===yR.Function){if(e.exp===SR.Count){if(e.parts&&1===e.parts.length&&e.parts[0].type===yR.Field){const t=mA.getInstance().getDataSource(e.parts[0].dataSourceId),n=t&&t.getSchema(),r=e.parts[0].jimuFieldName;return!!(n&&n.fields&&n.fields[r])}return(!e.parts||0===e.parts.length)&&!!e.dataSourceId}if(e.exp===SR.PercentileContinuous||e.exp===SR.PercentileDiscrete){if((null===(t=e.parts)||void 0===t?void 0:t.length)>2){const t=mA.getInstance().getDataSource(e.parts[0].dataSourceId),n=t&&t.getSchema(),r=e.parts[0].jimuFieldName,i=n&&n.fields&&n.fields[r];if(i&&i.type===_a.Number){const t=e.parts.find(e=>e.type===yR.Number);if(!t)return!1;const n=parseInt(t.exp);return!(n<0||n>100)&&e.parts.filter(e=>!/^\s*$/.test(null==e?void 0:e.exp)).every((e,t)=>{if(t%2==1)return","===e.exp;{const n=[yR.Field,yR.Number,yR.Order];return e.type===n[t/2]}})}return!1}return!1}if(Object.keys(SR).some(t=>e.exp===SR[t])){if(e.parts&&1===e.parts.length&&e.parts[0].type===yR.Field){const t=e.exp===SR.Min||e.exp===SR.Max,n=mA.getInstance().getDataSource(e.parts[0].dataSourceId),r=n&&n.getSchema(),i=e.parts[0].jimuFieldName,o=r&&r.fields&&r.fields[i],s=o&&o.type===_a.Number,a=o&&o.type===_a.Date;return s||t&&a}return!1}return!1}return!0});return!n&&r&&o&&s&&l&&u}function xP(e){return!(!e||e.type!==yR.Function)&&Object.keys(SR).some(t=>SR[t]===e.exp)}function AP(e,t,n){if(!e||!t)return!1;const r=mA.getInstance().getDataSource(e),i=r&&r.getSchema&&r.getSchema(),o=i&&i.fields;return!!o&&!(!o[t]||n!==(o[t].alias||o[t].name))}function DP(e){var t,n;return 1===(null===(t=null==e?void 0:e.parts)||void 0===t?void 0:t.length)&&(null===(n=e.parts[0])||void 0===n?void 0:n.type)===bR.Arcade}const RP=e=>{var t,n;return 1===(null===(t=null==e?void 0:e.parts)||void 0===t?void 0:t.length)&&(null===(n=e.parts[0])||void 0===n?void 0:n.type)===yR.String},PP=e=>{var t,n,r;return RP(e)?null===(r=null===(n=null===(t=e.parts)||void 0===t?void 0:t[0])||void 0===n?void 0:n.exp)||void 0===r?void 0:r.replace(/(^\"|\"$)/g,""):""},jP=e=>null==e?void 0:e.map(e=>null==e?void 0:e.set("fields",[]).asMutable({deep:!0})),LP=e=>null==e?void 0:e.some(e=>{var t;return!!(null===(t=e.fields)||void 0===t?void 0:t.length)});function _P(e){return(null==e?void 0:e.parts)?Array.from(new Set(e.parts.map(e=>null==e?void 0:e.dataSourceId).filter(e=>!!e))):[]}function MP(e,t){if(t!==SR.PercentileContinuous&&t!==SR.PercentileDiscrete)return null;const n=e.find(e=>e.type===yR.Number),r=e.find(e=>e.type===yR.Order);return n?{value:parseFloat(n.exp),orderBy:null==r?void 0:r.exp}:{value:0}}function NP(e,t,n,r,i){var o,s;const a=(null===(o=null==e?void 0:e.asMutable)||void 0===o?void 0:o.call(e,{deep:!0}))||e;if(!a||!a.parts)return a;if(DP(a)){const e=i.widgets[r],o=e.useDataSources,l=null===(s=e.useDataSources)||void 0===s?void 0:s.filter(e=>e.dataSourceId!==t).concat(qT(n)),u=UP(a);return FP(IP.arcadeContentUtils.updateArcadeContentConfigWhenUseDataSourcesChange(r,o,l,u))}const l=a.parts.map(e=>{if(e.dataSourceId===t){const t=Object.assign(Object.assign({},e),{dataSourceId:n});return e.isFromRepeatedDataSourceContext&&!(e=>{var t,r,o,s;if(e&&i){const a=MI("jimu-layouts/layout-runtime"),l=null===(t=null==a?void 0:a.searchUtils)||void 0===t?void 0:t.getParentWidgetIdOfContent(i,e,$v.Widget,null===(r=null==a?void 0:a.utils)||void 0===r?void 0:r.getCurrentSizeMode());if(l){const e=null===(o=i.widgets)||void 0===o?void 0:o[l];if(null===(s=null==e?void 0:e.useDataSources)||void 0===s?void 0:s.some(e=>e.dataSourceId===n))return!0}}return!1})(r)&&delete t.isFromRepeatedDataSourceContext,t}return e});return Object.assign(Object.assign({},a),{parts:l})}function kP(e,t,n){var r,i;return(null===(r=null==t?void 0:t.parts)||void 0===r?void 0:r.length)&&e?DP(t)?function(e,t,n){var r,i,o,s;if(!(null===(r=null==t?void 0:t.parts)||void 0===r?void 0:r.length)||!e)return{isChanged:!1,expression:null===(i=null==t?void 0:t.asMutable)||void 0===i?void 0:i.call(t,{deep:!0})};let a=!1;const l=null===(o=null==t?void 0:t.asMutable)||void 0===o?void 0:o.call(t,{deep:!0});return null===(s=null==l?void 0:l.parts)||void 0===s||s.forEach(t=>{var r;if(t){const i=t.exp;t.exp=uP(e,n,i),t.exp!==i&&(a=!0),(null===(r=t.useDataSources)||void 0===r?void 0:r.length)>0&&t.useDataSources.forEach((n,r)=>{const i=KT(e,n);if(i.isChanged){a=!0;const e=i.useDataSource||n;t.useDataSources[r]=e}})}}),{isChanged:a,expression:l}}(e,t,n):function(e,t){var n,r;if(!(null===(n=null==t?void 0:t.parts)||void 0===n?void 0:n.length)||!e)return{isChanged:!1,expression:null===(r=null==t?void 0:t.asMutable)||void 0===r?void 0:r.call(t,{deep:!0})};let i=!1;const o=t.parts.asMutable({deep:!0});return t.parts.forEach((t,n)=>{if(!t.dataSourceId)return;const r=Object.keys(e).find(e=>VT(t.dataSourceId,e)),s=e[r];s&&s!==r&&(i=!0,o[n]=Object.assign(Object.assign({},o[n]),{dataSourceId:t.dataSourceId.replace(r,s)}))}),{isChanged:i,expression:Object.assign(Object.assign({},t),{parts:o})}}(e,t):{isChanged:!1,expression:null===(i=null==t?void 0:t.asMutable)||void 0===i?void 0:i.call(t,{deep:!0})}}function UP(e){return DP(e)?Ye({id:e.id,title:e.name||"",scriptContent:e.parts[0].exp,valueType:e.parts[0].valueType,icons:[]}):null}function FP(e){var t;return e?{id:e.id,name:e.title,parts:[{type:bR.Arcade,exp:e.scriptContent,valueType:e.valueType,useDataSources:null===(t=e.useDataSources)||void 0===t?void 0:t.asMutable({deep:!0})}]}:{name:"",parts:[]}}function BP(e,t){return t===_a.Number?Number.isNaN(Number(e))?null:`${e}`:t===_a.Date?Number.isNaN(Number(e))?`${e}`:Number(e):t===_a.DateOnly||t===_a.TimeOnly||t===_a.String?null===e?null:`${e}`:void 0}function $P(e,t,n,r){if(t.type===_a.Date){const r=e.map(e=>eC(t.jimuName,rO.DateOperatorIsOn,[{value:e,label:e+"",isUTC:!0}])),i=tC(tO.Or,r);return nC(tO.Or,[i],n)}if(t.type===_a.DateOnly||t.type===_a.TimeOnly){const r=e.map(e=>{const n=t.type===_a.DateOnly?rO.DateOnlyOperatorIsOn:rO.TimeOnlyOperatorIsOn;return eC(t.jimuName,n,[{value:e,label:e+""}])}),i=tC(tO.Or,r);return nC(tO.Or,[i],n)}{let i;switch(t.type){case _a.Number:i=rO.NumberOperatorIsAnyOf;break;case _a.String:i=rO.StringOperatorIsAnyOf}const o=[],s=[];if(e.forEach(e=>{if(null!==e)s.push({value:e,label:e+""});else{const e=`(${t.jimuName} IN (null))`;o.push({customSQL:e,customDisplaySQL:e})}}),s.length>0){const e=eC(t.jimuName,i,s,r);o.push(e)}return nC(tO.Or,o,n)}}var VP,GP,WP,HP,zP,qP,JP,KP,YP;function XP(e){const t=null==e?void 0:e.parts;if(1===(null==t?void 0:t.length)){const e=t[0];if((null==e?void 0:e.type)===yR.Field)return!0}return!1}function QP(e){var t,n,r,i,o,s;const a=null==e?void 0:e.parts;return 4===(null==a?void 0:a.length)&&(null===(t=a[0])||void 0===t?void 0:t.type)===yR.Function&&(null===(n=a[1])||void 0===n?void 0:n.type)===yR.Operator&&"("===(null===(r=a[1])||void 0===r?void 0:r.exp)&&(null===(i=a[2])||void 0===i?void 0:i.type)===yR.Field&&(null===(o=a[3])||void 0===o?void 0:o.type)===yR.Operator&&")"===(null===(s=a[3])||void 0===s?void 0:s.exp)}function ZP(e){const t=null==e?void 0:e.parts;if(1===(null==t?void 0:t.length)){const e=t[0];if((null==e?void 0:e.type)===bR.Arcade)return!0}return!1}function ej(e){var t;return(null===(t=null==e?void 0:e.parts)||void 0===t?void 0:t.length)>0&&!XP(e)&&!QP(e)&&!ZP(e)}function tj(e){if(e)try{return qR(e)}catch(t){return console.error("getExpressionReturnType error",e,t),null}return null}!function(e){e[e.Average=SR.Average]="Average",e[e.Count=SR.Count]="Count",e[e.Sum=SR.Sum]="Sum",e[e.Max=SR.Max]="Max",e[e.Min=SR.Min]="Min"}(VP||(VP={})),function(e){e.ImportFromDynamicContent="IMPORT_FROM_DYNAMIC_CONTENT",e.CustomAttribute="CUSTOM_ATTRIBUTE",e.CustomStatistics="CUSTOM_STATISTICS"}(GP||(GP={})),function(e){e.CustomAttribute="CUSTOM_ATTRIBUTE",e.CustomStatistics="CUSTOM_STATISTICS"}(WP||(WP={})),function(e){e[e.StringOperatorIs=rO.StringOperatorIs]="StringOperatorIs",e[e.StringOperatorIsNot=rO.StringOperatorIsNot]="StringOperatorIsNot",e[e.StringOperatorContains=rO.StringOperatorContains]="StringOperatorContains",e[e.StringOperatorIsBlank=rO.StringOperatorIsBlank]="StringOperatorIsBlank",e[e.StringOperatorIsNotBlank=rO.StringOperatorIsNotBlank]="StringOperatorIsNotBlank",e[e.NumberOperatorIs=rO.NumberOperatorIs]="NumberOperatorIs",e[e.NumberOperatorIsNot=rO.NumberOperatorIsNot]="NumberOperatorIsNot",e[e.NumberOperatorIsGreaterThan=rO.NumberOperatorIsGreaterThan]="NumberOperatorIsGreaterThan",e[e.NumberOperatorIsLessThan=rO.NumberOperatorIsLessThan]="NumberOperatorIsLessThan",e[e.NumberOperatorIsBetween=rO.NumberOperatorIsBetween]="NumberOperatorIsBetween"}(HP||(HP={})),function(e){e.UserInput="USER_INPUT",e.Field="FIELD",e.Unique="UNIQUE",e.Statistics="STATISTICS"}(zP||(zP={})),function(e){e.Left="LEFT",e.Right="RIGHT"}(qP||(qP={})),function(e){e.Background="BACKGROUND",e.Text="TEXT",e.Border="BORDER",e.BorderRadius="BorderRadius",e.Icon="ICON"}(JP||(JP={})),function(e){e.Condition="CONDITION",e.Arcade="ARCADE"}(KP||(KP={})),function(e){e.Attribute="Attribute",e.Statistics="Statistics",e.Arcade="Arcade",e.Common="Common"}(YP||(YP={}));const nj={[HP.StringOperatorIs]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Unique]},[HP.StringOperatorIsNot]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Unique]},[HP.StringOperatorContains]:{supportedConditionSourceTypes:[zP.UserInput]},[HP.StringOperatorIsBlank]:{supportedConditionSourceTypes:[]},[HP.StringOperatorIsNotBlank]:{supportedConditionSourceTypes:[]},[HP.NumberOperatorIs]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Unique,zP.Statistics]},[HP.NumberOperatorIsNot]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Unique,zP.Statistics]},[HP.NumberOperatorIsGreaterThan]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Unique,zP.Statistics]},[HP.NumberOperatorIsLessThan]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Unique,zP.Statistics]},[HP.NumberOperatorIsBetween]:{supportedConditionSourceTypes:[zP.UserInput]}},rj={[HP.NumberOperatorIs]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsNot]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsGreaterThan]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsLessThan]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsBetween]:{supportedConditionSourceTypes:[zP.UserInput]}},ij={[HP.StringOperatorIs]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field]},[HP.StringOperatorIsNot]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field]},[HP.StringOperatorContains]:{supportedConditionSourceTypes:[zP.UserInput]},[HP.StringOperatorIsBlank]:{supportedConditionSourceTypes:[]},[HP.StringOperatorIsNotBlank]:{supportedConditionSourceTypes:[]},[HP.NumberOperatorIs]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsNot]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsGreaterThan]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsLessThan]:{supportedConditionSourceTypes:[zP.UserInput,zP.Field,zP.Statistics]},[HP.NumberOperatorIsBetween]:{supportedConditionSourceTypes:[zP.UserInput]}};function oj(e,t){let n=null;const r=function(e,t){if(!e||!t)return null;let n=null;return e===YP.Attribute?n=nj[t]:e===YP.Statistics?n=rj[t]:(e===YP.Arcade||e===YP.Common)&&(n=ij[t]),n}(e,t);return r&&r.supportedConditionSourceTypes&&(n=r.supportedConditionSourceTypes.slice()),n||(n=[]),n}function sj(e,t){let n=null;if(e&&t){const r=function(e){if(e){if(XP(e))return YP.Attribute;if(QP(e))return YP.Statistics;if(ZP(e))return YP.Arcade;if(ej(e))return YP.Common}return null}(e);r&&t&&(n=oj(r,t))}return n||(n=[]),n}function aj(e,t){if(t){const{operator:n,sourceType:r,valueOptions:i}=t;if(n){const t=function(e,t,n){if(t){if(t===HP.StringOperatorIsBlank||t===HP.StringOperatorIsNotBlank)return!0;const r=sj(e,t);return r.length>=0?r.includes(n):!n}return!1}(e,n,r);if(t){return lj(n,r,i)}}}return!1}function lj(e,t,n){const r=e===HP.NumberOperatorIs||e===HP.NumberOperatorIsNot||e===HP.NumberOperatorIsGreaterThan||e===HP.NumberOperatorIsLessThan;if(!t)return!0;if(t===zP.UserInput){if(e===HP.StringOperatorIs||e===HP.StringOperatorIsNot||e===HP.StringOperatorContains)return uj(n);if(r)return cj(n);if(e===HP.NumberOperatorIsBetween)return function(e){if(e){const t=e.value;if(t&&2===t.length){return t.every(e=>!(!e||"number"!=typeof e.value))}}return!1}(n)}else if(t===zP.Unique){if(e===HP.StringOperatorIs||e===HP.StringOperatorIsNot)return uj(n);if(r)return cj(n)}else if(t===zP.Field){if(e===HP.StringOperatorIs||e===HP.StringOperatorIsNot||r)return function(e){if(e&&e.expression&&XP(e.expression))return!0;return!1}(n)}else if(t===zP.Statistics&&r)return function(e){if(e&&e.expression&&QP(e.expression))return!0;return!1}(n);return!1}function uj(e){if(e){const t=e.value;if(t&&1===t.length){const e=t[0];if(e&&e.value)return!0}}return!1}function cj(e){if(e){const t=e.value;if(t&&1===t.length){const e=t[0];if(e&&"number"==typeof e.value)return!0}}return!1}function dj(e,t){if(!e||!t||0===t.length)return t;let n=t;return n=e.sourceType===KP.Arcade?function(e,t){const n=null==e?void 0:e.useDataSources;if((null==n?void 0:n.length)>0)return t||(t=Ye([])),CP(t,n);return t}(e.arcadeConfig,t):function(e,t){if(!e||!t||0===t.length)return t;const n=[],{refValueInfo:r,items:i}=e,o=null==r?void 0:r.expression;o&&n.push(o);(null==i?void 0:i.length)>0&&i.forEach(e=>{var t,r;const i=null===(r=null===(t=null==e?void 0:e.condition)||void 0===t?void 0:t.valueOptions)||void 0===r?void 0:r.expression;i&&n.push(i)});const s=[];n.length>0&&n.forEach(e=>{const t=null==e?void 0:e.parts;(null==t?void 0:t.length)>0&&t.forEach(e=>{e&&s.push(e)})});const a=EP(s,t);return a}(e.conditionConfig,t),n||(n=t),n}function pj(e,t,n,r){if(!r||!n||0===n.length)return null;const i=[],o=[];(null==t?void 0:t.length)>0&&t.forEach(e=>{const t=null==e?void 0:e.dataSourceId;t&&i.push(t)}),(null==n?void 0:n.length)>0&&n.forEach(e=>{const t=null==e?void 0:e.dataSourceId;t&&o.push(t)});const{deleted:s}=$w(!0,i,o);if(0===s.length)return r;return 1===(null==t?void 0:t.length)&&1===(null==n?void 0:n.length)?function(e,t,n,r){if(!t||!n||!r)return null;const i=t.mainDataSourceId,o=t.dataSourceId,s=n.mainDataSourceId,a=n.dataSourceId;if(!(i&&o&&s&&a))return null;if(a===o)return r;if(s!==i)return null;const l=r.sourceType;if(l!==KP.Arcade&&l!==KP.Condition)return null;const u=r.asMutable({deep:!0}),c=function(e,t){const n=nP(e);return n?t:null}(e,u.arcadeConfig),d=function(e,t,n){if(n){const{expressionParts:r,hasArcadeExpression:i}=fj(n);if(i)return null;r.forEach(n=>{n&&n.dataSourceId&&n.dataSourceId===e&&(n.dataSourceId=t)})}return n}(o,a,u.conditionConfig);let p=null;l===KP.Arcade?c&&(p={sourceType:l,arcadeConfig:c,conditionConfig:d}):l===KP.Condition&&d&&(p={sourceType:l,arcadeConfig:c,conditionConfig:d});return p?Ye(p):null}(e,t[0],n[0],r):function(e,t){if(!t||!e||0===e.length)return null;const n=t.sourceType;if(n!==KP.Arcade&&n!==KP.Condition)return null;const r=t.asMutable({deep:!0}),i=null,o=function(e,t){if(t){const{expressionParts:n,hasArcadeExpression:r}=fj(t);if(r)return null;let i=[];n.length>0&&n.forEach(e=>{const t=null==e?void 0:e.dataSourceId;t&&i.push(t)}),i=Array.from(new Set(i));let o=[];e.forEach(e=>{if(e){const t=e.dataSourceId;if(t&&(o.push(t),t===e.mainDataSourceId&&!e.dataViewId)){const t=`${e.mainDataSourceId}-${Ad}`;o.push(t)}}}),o=Array.from(new Set(o));return i.every(e=>o.includes(e))?t:null}return null}(e,r.conditionConfig);let s=null;n===KP.Arcade?i&&(s={sourceType:n,arcadeConfig:i,conditionConfig:o}):n===KP.Condition&&o&&(s={sourceType:n,arcadeConfig:i,conditionConfig:o});return s?Ye(s):null}(n,r)}function fj(e){const t=[],n=[];let r=!1;if(e){const{refValueInfo:n,items:r}=e;(null==n?void 0:n.expression)&&t.push(n.expression),(null==r?void 0:r.length)>0&&r.forEach(e=>{var n,r;const i=null===(r=null===(n=null==e?void 0:e.condition)||void 0===n?void 0:n.valueOptions)||void 0===r?void 0:r.expression;i&&t.push(i)})}t.length>0&&(r=t.some(e=>ZP(e)),t.forEach(e=>{const t=null==e?void 0:e.parts;(null==t?void 0:t.length)>0&&n.push(...t)}));return{expressions:t,expressionParts:n,hasArcadeExpression:r}}function hj(e,t,n){if(e&&n){if(n.arcadeConfig){const r=lP(e,t,n.arcadeConfig);n=n.set("arcadeConfig",r)}if(n.conditionConfig){const r=function(e,t,n){if(!e||!n)return n;const r=n.asMutable({deep:!0}),{refValueInfo:i,items:o}=r;(null==i?void 0:i.expression)&&(i.expression=gj(e,t,i.expression));(null==o?void 0:o.length)>0&&o.forEach(n=>{var r;const i=null===(r=null==n?void 0:n.condition)||void 0===r?void 0:r.valueOptions;(null==i?void 0:i.expression)&&(i.expression=gj(e,t,i.expression))});return Ye(r)}(e,t,n.conditionConfig);n=n.set("conditionConfig",r)}}return n}function gj(e,t,n){if(!e||!n)return n;const r=kP(e,Ye(n),t);let i=r.isChanged?r.expression:n;return i||(i=n),i}const mj=e=>e?"draft/translations":"translations",vj=e=>`${e}.json`,yj=(e,t)=>`${mj(t)}/${vj(e)}`,Sj=(e,t)=>{const n=mj(t).replace("/","\\/");return new RegExp(`^${n}\\/[^\\/]+\\.json$`).test(e)},bj=(e,t)=>{const n=mj(t).replace("/","\\/"),r=new RegExp(`^${n}\\/([^\\/]+)\\.json$`),i=e.match(r);return i?i[1]:""},wj=(e,t)=>{Object.keys(t).forEach(n=>{Vu(e,n)&&Uy(e,n,t[n])})};function Ij(){var e=F.useContext(jy);return Nh(e),e}var Ej,Oj;!function(e){e.formatDate="FormattedDate",e.formatTime="FormattedTime",e.formatNumber="FormattedNumber",e.formatList="FormattedList",e.formatDisplayName="FormattedDisplayName"}(Ej||(Ej={})),function(e){e.formatDate="FormattedDateParts",e.formatTime="FormattedTimeParts",e.formatNumber="FormattedNumberParts",e.formatList="FormattedListParts"}(Oj||(Oj={}));var Cj=function(e){var t=Ij(),n=e.value,r=e.children,i=rr(e,["value","children"]);return r(t.formatNumberToParts(n,i))};Cj.displayName="FormattedNumberParts";function Tj(e){var t=function(t){var n=Ij(),r=t.value,i=t.children,o=rr(t,["value","children"]),s="string"==typeof r?new Date(r||0):r;return i("formatDate"===e?n.formatDateToParts(s,o):n.formatTimeToParts(s,o))};return t.displayName=Oj[e],t}function xj(e){var t=function(t){var n=Ij(),r=t.value,i=t.children,o=rr(t,["value","children"]),s=n[e](r,o);if("function"==typeof i)return i(s);var a=n.textComponent||F.Fragment;return F.createElement(a,null,s)};return t.displayName=Ej[e],t}Cj.displayName="FormattedNumberParts";var Aj=xj("formatDate"),Dj=xj("formatTime"),Rj=xj("formatNumber");xj("formatList"),xj("formatDisplayName"),Tj("formatDate"),Tj("formatTime");function Pj(e){var t=Ij(),n=t.formatMessage,r=t.textComponent,i=void 0===r?F.Fragment:r,o=e.id,s=e.description,a=e.defaultMessage,l=e.values,u=e.children,c=e.tagName,d=void 0===c?i:c,p=n({id:o,description:s,defaultMessage:a},l,{ignoreTag:e.ignoreTag});return"function"==typeof u?u(Array.isArray(p)?p:[p]):d?F.createElement(d,null,p):F.createElement(F.Fragment,null,p)}Pj.displayName="FormattedMessage";var jj=F.memo(Pj,function(e,t){var n=e.values,r=rr(e,["values"]),i=t.values,o=rr(t,["values"]);return Bh(i,n)&&Bh(r,o)});jj.displayName="MemoizedFormattedMessage";const Lj=jj;var _j=function(e){var t=Ij(),n=t.formatPlural,r=t.textComponent,i=e.value,o=e.other,s=e.children,a=e[n(i,e)]||o;return"function"==typeof s?s(a):r?F.createElement(r,null,a):a};_j.displayName="FormattedPlural";const Mj=_j;var Nj=3600;function kj(e){var t=Math.abs(e);return t<60?"second":t<Nj?"minute":t<86400?"hour":"day"}function Uj(e){switch(e){case"second":return 1;case"minute":return 60;case"hour":return Nj;default:return 86400}}var Fj=["second","minute","hour"];function Bj(e){return void 0===e&&(e="second"),Fj.indexOf(e)>-1}var $j=function(e){var t=Ij(),n=t.formatRelativeTime,r=t.textComponent,i=e.children,o=n(e.value||0,e.unit,rr(e,["children","value","unit"]));return"function"==typeof i?i(o):r?F.createElement(r,null,o):F.createElement(F.Fragment,null,o)},Vj=function(e){var t=e.value,n=void 0===t?0:t,r=e.unit,i=void 0===r?"second":r,o=e.updateIntervalInSeconds,s=rr(e,["value","unit","updateIntervalInSeconds"]);Mh(!o||!(!o||!Bj(i)),"Cannot schedule update with unit longer than hour");var a,l=F.useState(),u=l[0],c=l[1],d=F.useState(0),p=d[0],f=d[1],h=F.useState(0),g=h[0],m=h[1];i===u&&n===p||(f(n||0),c(i),m(Bj(i)?function(e,t){if(!e)return 0;switch(t){case"second":return e;case"minute":return 60*e;default:return e*Nj}}(n,i):0)),F.useEffect(function(){function e(){clearTimeout(a)}if(e(),!o||!Bj(i))return e;var t=g-o,n=kj(t);if("day"===n)return e;var r=Uj(n),s=t-t%r,l=s>=g?s-r:s,u=Math.abs(l-g);return g!==l&&(a=setTimeout(function(){return m(l)},1e3*u)),e},[g,o,i]);var v=n||0,y=i;if(Bj(i)&&"number"==typeof g&&o){var S=Uj(y=kj(g));v=Math.round(g/S)}return F.createElement($j,nr({value:v,unit:y},s))};Vj.displayName="FormattedRelativeTime";const Gj=Vj;var Wj;!function(e){e.UseLayersRelationship="USE_LAYERS_RELATIONSHIP",e.SetCustomFields="SET_CUSTOM_FIELDS"}(Wj||(Wj={}));var Hj=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class zj{upgrade(e,t,n,r){return Hj(this,void 0,void 0,function*(){const i=this.checkVersions(t,n);if(!i)return e;const[o,s]=i;if(o===s)return this.versions[s].upgrader(e,r);const a=e,l=this.versions.slice(o+1,s+1).filter(e=>null==e?void 0:e.upgrader);return l.reduce((e,t)=>Hj(this,void 0,void 0,function*(){const n=yield e;return t.upgrader(n,r)}),Promise.resolve(a))})}checkVersions(e,t){if(!lt.valid(e)||!lt.valid(t))return!1;if(!this.checkVersion())return!1;const n=this.getVersionIndex(e),r=this.getVersionIndex(t);return n>r?(console.error("New version should higher than old version."),!1):n===r?!!this.versions[r]&&[n,r]:[n,r]}getVersionIndex(e){const t=this.versions.findIndex(t=>lt.eq(e,t.version));if(t>-1)return t;for(let t=0;t<this.versions.length-1;t++)if(lt.gt(e,this.versions[t].version)&&lt.lt(e,this.versions[t+1].version))return t;return lt.lt(e,this.versions[0].version)?-1:lt.gt(e,this.versions[this.versions.length-1].version)?this.versions.length:void 0}checkVersion(){for(let e=0;e<this.versions.length-1;e++){if(!lt.valid(this.versions[e].version))return console.error("Invalid version.",this.versions[e].version),!1;if(lt.gt(this.versions[e].version,this.versions[e+1].version))return console.error("Version order error.",this.versions[e].version,this.versions[e+1]),!1}return!0}}class qj extends zj{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"First release.",upgrader:e=>{let t=e;var n;return delete t.widgetsManifest,(n=t).widgets&&Object.keys(n.widgets).forEach(e=>{var t;const r=n.widgets[e];"widgets/common/controller/"===r.uri&&(null===(t=r.layouts)||void 0===t?void 0:t.openwidget)&&(r.layouts._openwidget=r.layouts.openwidget,delete r.layouts.openwidget)}),t=n,t=(e=>{var t;return Object.keys(null!==(t=e.layouts)&&void 0!==t?t:{}).forEach(t=>{var n,r;Object.keys(null!==(r=null===(n=e.layouts[t])||void 0===n?void 0:n.content)&&void 0!==r?r:{}).forEach(n=>{var r,i,o,s;const a=e.layouts[t].content[n];if(null===(r=null==a?void 0:a.setting)||void 0===r?void 0:r.fitContainer){a.setting.heightMode="fit";const e=null!==(i=a.setting.autoProps)&&void 0!==i?i:{};e.height="STRETCH",a.setting.autoProps=e,delete a.setting.fitContainer}if(null===(o=null==a?void 0:a.setting)||void 0===o?void 0:o.autoHeight){const e=null!==(s=a.setting.autoProps)&&void 0!==s?s:{},t=a.bbox;null!=t.top&&null!=t.bottom?e.height="STRETCH":e.height="AUTO",a.setting.autoProps=e,delete a.setting.autoHeight}})}),e})(t),t}},{version:"1.1.0",description:"1.1.0",upgrader:e=>Hj(this,void 0,void 0,function*(){const t=e=>{var t;return Object.keys(null!==(t=e.messageConfigs)&&void 0!==t?t:{}).forEach(t=>{var n;const r=null===(n=e.messageConfigs[t])||void 0===n?void 0:n.actions,i=e.widgets||{};r&&r.forEach(e=>{var t,n,r,o,s,a;if("widgets/common/list/"===(null===(t=i[null==e?void 0:e.widgetId])||void 0===t?void 0:t.uri)){if(e.config=e.config||{},e.config.actionUseDataSource&&e.config.actionUseDataSource.dataSourceId){const t=null===(n=e.config.actionUseDataSource)||void 0===n?void 0:n.fields;e.config.actionUseDataSource=null===(r=i[e.widgetId])||void 0===r?void 0:r.useDataSources[0],e.config.actionUseDataSource.fields=t}if(e.config.messageUseDataSource&&e.config.messageUseDataSource.dataSourceId)if("widgets/common/list/"===(null===(o=i[null==e?void 0:e.messageWidgetId])||void 0===o?void 0:o.uri)){const t=null===(s=e.config.messageUseDataSource)||void 0===s?void 0:s.fields;e.config.messageUseDataSource=null===(a=i[e.messageWidgetId])||void 0===a?void 0:a.useDataSources[0],e.config.messageUseDataSource.fields=t}else e.config.messageUseDataSource.mainDataSourceId=e.config.messageUseDataSource.dataSourceId;e.actionId=e.actionId.replace(`${e.widgetId}-filter`,"filter-data-record-action"),e.actionName=e.actionName.replace("filter","filter data record action"),e.version="1.1.0",delete e.widgetId}})}),e},n=(e,t,n,r)=>{var i;return Object.keys(null!==(i=e.widgets)&&void 0!==i?i:{}).forEach(i=>{const o=(e,t,n)=>{const i=(null==t?void 0:t.parts)&&(null==t?void 0:t.parts[e]);if(!i)return null;if(i.type===yR.Field){const o=e>0?t.parts[e-1]:null,s=e>1?t.parts[e-2]:null,a=t.parts[e+1];if((null==s?void 0:s.type)===yR.Function&&"("===(null==o?void 0:o.exp)&&")"===(null==a?void 0:a.exp))return i;if(n&&i.dataSourceId===n)i.isFromRepeatedDataSourceContext=!0;else if(i.dataSourceId&&!i.isFromRepeatedDataSourceContext){const e=0===i.dataSourceId.split("-").reverse()[0].indexOf(r)?i.dataSourceId.split("-").reverse().slice(1).reverse().join("-"):i.dataSourceId;i.dataSourceId=`${e}-${Ad}`}}return i},s=(e,t)=>{var r,i,s,a;if("widgets/common/image/"===e.uri||"widgets/common/button/"===e.uri){let n=[];n="widgets/common/image/"===e.uri?["altTextExpression","srcExpression","toolTipExpression","linkParam.expression"]:["textExpression","toolTipExpression","linkParam.expression"],n.forEach(n=>{var r,i,s;const a=n.split("."),l=1===a.length?(null===(r=null==e?void 0:e.config)||void 0===r?void 0:r.functionConfig)&&e.config.functionConfig[a[0]]:(null===(i=null==e?void 0:e.config)||void 0===i?void 0:i.functionConfig)&&e.config.functionConfig[a[0]]&&e.config.functionConfig[a[0]][a[1]];null===(s=null==l?void 0:l.parts)||void 0===s||s.forEach((e,n)=>{o(n,l,t)})})}else"widgets/common/embed/"===e.uri?null===(s=null===(i=null===(r=null==e?void 0:e.config)||void 0===r?void 0:r.expression)||void 0===i?void 0:i.parts)||void 0===s||s.forEach((n,r)=>{o(r,e.config.expression,t)}):"widgets/common/text/"===e.uri&&(null===(a=e.config)||void 0===a?void 0:a.text)&&(e.config.text=n.editExpressionPart(e.config.text,(e,n)=>o(e,n,t)));return e};let a=e.widgets[i];if("widgets/common/list/"===a.uri){t.getChildrenContents(e,i,$v.Widget,!0).forEach(t=>{const n=(null==a?void 0:a.useDataSources)&&a.useDataSources[0]&&a.useDataSources[0].dataSourceId;e.widgets[t]=s(e.widgets[t],n)})}else a=s(a)}),e};return Promise.all([NI("jimu-layouts/layout-runtime"),NI("jimu-ui")]).then(r=>{const[i,o]=r;let s=e;return s=(e=>{var t;return Object.keys(null!==(t=e.dataSources)&&void 0!==t?t:{}).forEach(t=>{var n;const r=e.dataSources[t];"FEATURE_QUERY"===r.type?r.type=Xa.FeatureLayer:r.isOutputFromWidget&&(null===(n=null==r?void 0:r.originDataSources)||void 0===n||n.forEach(e=>{e.mainDataSourceId=e.dataSourceId}))}),e})(s),s=((e,r,i)=>{var o;const s=Tb().formatMessage({id:"upgradedFrom"}),a="_from_10_";return Object.keys(null!==(o=e.widgets)&&void 0!==o?o:{}).forEach(t=>{var n;const i=e.widgets[t];(null!==(n=i.useDataSources)&&void 0!==n?n:[]).forEach((n,o)=>{var l,u,c,d,p,f;if(n.query||"widgets/arcgis/feature-info/"===i.uri&&(null===(l=i.config)||void 0===l?void 0:l.limitGraphics)||"widgets/common/list/"===i.uri){const l=`${a}${t}_${o}`,h=e.dataSources||{},g={id:l,label:s,where:null===(u=n.query)||void 0===u?void 0:u.where,orderBy:null===(d=null===(c=n.query)||void 0===c?void 0:c.orderBy)||void 0===d?void 0:d.filter(e=>!!(null==e?void 0:e.jimuFieldName)),maximum:"widgets/arcgis/feature-info/"===i.uri?null===(p=i.config)||void 0===p?void 0:p.maxGraphics:"widgets/common/list/"===i.uri&&(null===(f=i.config)||void 0===f?void 0:f.maxItems)},m=n.dataSourceId,v=n.rootDataSourceId,y=`${m}-${l}`;if(n.dataSourceId=y,n.mainDataSourceId=m,n.dataViewId=l,r.getChildrenContents(e,t,$v.Widget,!0).forEach(t=>{var n;const r=e.widgets[t];if((null!==(n=r.useDataSources)&&void 0!==n?n:[]).forEach((e,t)=>{e.dataSourceId===m&&(e.dataSourceId=y,e.mainDataSourceId=m,e.dataViewId=l)}),"widgets/common/image/"===r.uri||"widgets/common/button/"===r.uri){let e=[];e="widgets/common/image/"===r.uri?["altTextExpression","srcExpression","toolTipExpression","linkParam.expression"]:["textExpression","toolTipExpression","linkParam.expression"],e.forEach(e=>{var t,n,i;const o=e.split("."),s=1===o.length?(null===(t=null==r?void 0:r.config)||void 0===t?void 0:t.functionConfig)&&r.config.functionConfig[o[0]]:(null===(n=null==r?void 0:r.config)||void 0===n?void 0:n.functionConfig)&&r.config.functionConfig[o[0]]&&r.config.functionConfig[o[0]][o[1]];null===(i=null==s?void 0:s.parts)||void 0===i||i.forEach(e=>{e.dataSourceId===m&&(e.dataSourceId=y)})})}else"widgets/common/text/"===r.uri&&(r.config.text=r.config.text.replace(new RegExp(m,"g"),y))}),h[m])h[m].dataViews?h[m].dataViews[l]=g:h[m].dataViews={[l]:g};else if(h[v]){const e=m.substr(v.length+1);h[v].childDataSourceJsons?h[v].childDataSourceJsons[e]?h[v].childDataSourceJsons[e].dataViews?h[v].childDataSourceJsons[e].dataViews[l]=g:h[v].childDataSourceJsons[e].dataViews={[l]:g}:h[v].childDataSourceJsons[e]={id:m,dataViews:{[l]:g}}:h[v].childDataSourceJsons={[e]:{id:m,dataViews:{[l]:g}}}}else console.error("bad config ds.",n);Object.keys(h).forEach(e=>{h[e].originDataSources&&h[e].originDataSources.forEach(e=>{e.dataSourceId===m&&(e.dataSourceId=y,e.mainDataSourceId=m,e.dataViewId=l)})}),delete n.query}else n.mainDataSourceId||(n.mainDataSourceId=n.dataSourceId)})}),t(n(e,r,i,a))})(s,i.searchUtils,o.richTextUtils),s=(e=>{var t;return Object.keys(null!==(t=e.layouts)&&void 0!==t?t:{}).forEach(t=>{var n;const r=e.layouts[t],i=null==r?void 0:r.type;Object.keys(null!==(n=null==r?void 0:r.content)&&void 0!==n?n:{}).forEach(e=>{var t,n,o,s,a,l;const u=r.content[e],c=null!==(n=null===(t=u.setting)||void 0===t?void 0:t.autoProps)&&void 0!==n?n:{};!0===c.width?(i===Vv.FixedLayout?c.left||c.right?c.width="AUTO":c.width="STRETCH":c.width="AUTO",u.setting.autoProps=c):!1===c.width&&(c.width="CUSTOM",u.setting.autoProps=c),!0===(null===(o=u.setting)||void 0===o?void 0:o.fitContainer)?c.height="STRETCH":!1===(null===(s=u.setting)||void 0===s?void 0:s.fitContainer)&&(null===(a=u.bbox)||void 0===a?void 0:a.height)?c.height="CUSTOM":!0===c.height?(i===Vv.FixedLayout?c.top||c.bottom?c.height="AUTO":c.height="STRETCH":c.height="AUTO",u.setting.autoProps=c):!1===c.height&&(c.height="CUSTOM",u.setting.autoProps=c),(null===(l=u.setting)||void 0===l?void 0:l.heightMode)&&null==c.height&&("auto"===u.setting.heightMode?(c.height="AUTO",u.setting.autoProps=c):"fit"===u.setting.heightMode?(c.height="STRETCH",u.setting.autoProps=c):"fixed"===u.setting.heightMode&&(c.height="CUSTOM",u.setting.autoProps=c))})}),e})(s),s})})},{version:"1.2.0",description:"1.2.0",upgrader:e=>{let t=e;var n;return n=t,Object.keys(n.pages).forEach(e=>{n.pages[e].icon&&(n.pages[e].icon.properties.color=null)}),t=n,t=(e=>{if(!e.dialogs)return e;let t=0,n=0;Object.keys(e.dialogs).forEach(r=>{const i=e.dialogs[r];i.mode===Kh.Fixed?i.index=t++:i.index=n++,i.dialogBackground?""===i.dialogBackground.color&&(i.dialogBackground.color="rgba(0,0,0,0)"):i.dialogBackground={color:"rgba(0,0,0,0)",fillType:"fit",image:{url:""}},i.mode===Kh.Fixed&&i.confirmBeforeClose?(i.interactionType=Yh.ButtonInline,i.interactionStyles=i.confirmationStyle,i.alwaysShowConfirmation=!1):(i.interactionType=null,i.interactionStyles=null),delete i.confirmationStyle});const r={};return Object.keys(e.dialogs).sort().forEach(t=>{r[t]=e.dialogs[t]}),e.dialogs=r,e})(t),t=(e=>(Object.keys(e.layouts).forEach(t=>{const n=e.layouts[t];(null==n?void 0:n.type)===Vv.FixedLayout&&Object.keys(n.content||{}).forEach(e=>{var t,r;const i=n.content[e];!0===(null===(t=i.setting)||void 0===t?void 0:t.hCenter)&&(i.bbox||(i.bbox={}),i.bbox.left="50%",i.setting?i.setting.autoProps?(i.setting.autoProps.left=!1,i.setting.autoProps.right=!0):i.setting.autoProps={left:!1,right:!0}:i.setting={autoProps:{left:!1,right:!0}}),!0===(null===(r=i.setting)||void 0===r?void 0:r.vCenter)&&(i.bbox||(i.bbox={}),i.bbox.top="50%",i.setting?i.setting.autoProps?(i.setting.autoProps.top=!1,i.setting.autoProps.bottom=!0):i.setting.autoProps={top:!1,bottom:!0}:i.setting={autoProps:{top:!1,bottom:!0}})})}),e))(t),t=(e=>(Object.keys(e.layouts).forEach(t=>{const n=e.layouts[t];(null==n?void 0:n.type)===Vv.FlowLayout&&Object.keys(n.content||{}).forEach(e=>{var t,r,i;const o=n.content[e];!0===(null===(t=o.setting)||void 0===t?void 0:t.isFloating)&&(+(null===(r=o.bbox)||void 0===r?void 0:r.width)>0&&(o.bbox.width=`${o.bbox.width}px`),+(null===(i=o.bbox)||void 0===i?void 0:i.height)>0&&(o.bbox.height=`${o.bbox.height}px`))})}),e))(t),t=(e=>(Object.keys(e.layouts).forEach(t=>{const n=e.layouts[t];Object.keys(n.content||{}).forEach(t=>{var r,i,o,s,a;const l=n.content[t];if(l.type===$v.Widget){const t=e.widgets[l.widgetId];0===(null===(r=null==t?void 0:t.uri)||void 0===r?void 0:r.indexOf("widgets/common/card"))&&("AUTO"===(null===(o=null===(i=l.setting)||void 0===i?void 0:i.autoProps)||void 0===o?void 0:o.width)&&(l.setting.autoProps.width="CUSTOM",l.bbox||(l.bbox={}),l.bbox.width=`${t.config.widgetWidth}px`),"AUTO"===(null===(a=null===(s=l.setting)||void 0===s?void 0:s.autoProps)||void 0===a?void 0:a.height)&&(l.setting.autoProps.height="CUSTOM",l.bbox||(l.bbox={}),l.bbox.height=`${t.config.widgetHeight}px`))}})}),e))(t),t=(e=>(Object.keys(e.layouts).forEach(t=>{const n=e.layouts[t];Object.keys(n.content||{}).forEach(t=>{var r,i;const o=n.content[t];if(o.type===$v.Widget){const t=e.widgets[o.widgetId];if(0===(null===(r=null==t?void 0:t.uri)||void 0===r?void 0:r.indexOf("widgets/layout/column"))){const n=null===(i=t.layouts)||void 0===i?void 0:i.DEFAULT;n&&Object.keys(n).forEach(r=>{var i,o,s,a,l,u,c,d;const p=n[r],f=e.layouts[p];f.setting||(f.setting={}),f.setting.space=(null===(o=null===(i=t.config)||void 0===i?void 0:i.space)||void 0===o?void 0:o.distance)||(null===(s=t.config)||void 0===s?void 0:s.space),f.setting.padding=null===(l=null===(a=t.config)||void 0===a?void 0:a.style)||void 0===l?void 0:l.padding,f.setting.justifyContent=null===(c=null===(u=t.config)||void 0===u?void 0:u.style)||void 0===c?void 0:c.justifyContent,f.setting.overflowY=null===(d=t.config)||void 0===d?void 0:d.style.overflowY})}}})}),e))(t),t}},{version:"1.3.0",description:"1.3.0",upgrader:e=>e},{version:"1.4.0",description:"1.4.0",upgrader:e=>{let t=e;var n;return(n=t).widgets&&Object.keys(n.widgets).forEach(e=>{const t=n.widgets[e];if("widgets/common/filter/"===t.uri&&t.useDataSources){const r={};t.useDataSources.forEach(e=>{if(e.dataSourceId in r){const t=r[e.dataSourceId].fields||[],n=e.fields||[];r[e.dataSourceId].fields=Array.from(new Set(t.concat(n))).sort()}else r[e.dataSourceId]=e}),n.widgets[e].useDataSources=Object.keys(r).map(e=>r[e])}}),t=n,t=(e=>e.dialogs?(Object.keys(e.dialogs).forEach(t=>{const n=e.dialogs[t],r={width:n.width,height:n.height,aspectRatio:!!n.aspectRatio};delete n.width,delete n.height,delete n.aspectRatio,n.mode===Kh.Fixed&&(r.position=n.position,delete n.position),n.sizeMode={},n.sizeMode[La.Large]=r}),e):e)(t),t=(e=>{var t;const n=["widgets/arcgis/feature-info/","widgets/arcgis/query/","widgets/common/chart/","widgets/common/list/","widgets/common/table/"];return Object.keys(null!==(t=e.widgets)&&void 0!==t?t:{}).forEach(t=>{const r=e.widgets[t];n.includes(r.uri)&&(r.enableDataAction=!1)}),e})(t),t}},{version:"1.5.0",description:"1.5.0",upgrader:e=>{let t=e;return t=(e=>{var t;return Object.keys(null!==(t=e.widgets)&&void 0!==t?t:{}).forEach(t=>{var n,r;const i=e.widgets[t];if(0===(null===(n=null==i?void 0:i.uri)||void 0===n?void 0:n.indexOf("widgets/layout/row"))){const t=null===(r=i.layouts)||void 0===r?void 0:r.DEFAULT;t&&Object.keys(t).forEach(n=>{var r,o,s,a,l,u;const c=t[n],d=e.layouts[c];d&&(d.setting||(d.setting={}),d.setting.style||(d.setting.style={}),d.setting.space=null!==(s=null===(o=null===(r=i.config)||void 0===r?void 0:r.space)||void 0===o?void 0:o.distance)&&void 0!==s?s:null===(a=i.config)||void 0===a?void 0:a.space,d.setting.style.padding=null===(u=null===(l=i.config)||void 0===l?void 0:l.style)||void 0===u?void 0:u.padding,i.config={})})}}),e})(t),t=(e=>{var t,n;const r=t=>{Object.keys(null!=t?t:{}).forEach(n=>{var r;const i=t[n],o=e.layouts[i];if(o){const e=null!==(r=o.setting)&&void 0!==r?r:{};e.lockDescendants=!0,o.setting=e}})};return r(null===(t=e.header)||void 0===t?void 0:t.layout),r(null===(n=e.footer)||void 0===n?void 0:n.layout),e})(t),t=(e=>{var t;return Object.keys(null!==(t=e.widgets)&&void 0!==t?t:{}).forEach(t=>{var n,r;const i=e.widgets[t];if(0===(null===(n=null==i?void 0:i.uri)||void 0===n?void 0:n.indexOf("widgets/layout/column"))){const t=null===(r=i.layouts)||void 0===r?void 0:r.DEFAULT;t&&Object.keys(t).forEach(n=>{const r=t[n],i=e.layouts[r];i&&!i.type&&(i.type=Vv.ColumnLayout)})}}),e})(t),t}},{version:"1.6.0",description:"1.6.0",upgrader:e=>{const t=e.customTheme;if(!t)return e;const n=t.sharedThemeVariables;delete t.sharedThemeVariables;let r=e;r.customTheme=t,r.sharedThemeVariables=n;return r=(e=>{var t;return Object.values(null!==(t=e.messageConfigs)&&void 0!==t?t:{}).forEach(t=>{var n;"DATA_RECORDS_SELECTION_CHANGE"===(null==t?void 0:t.messageType)&&(null!==(n=t.actions)&&void 0!==n?n:[]).forEach(n=>{var r,i,o,s,a;if(!("zoomToFeature"!==(null==n?void 0:n.actionName)&&"panTo"!==n.actionName||(null===(r=null==n?void 0:n.config)||void 0===r?void 0:r.useDataSources)&&0!==(null===(o=null===(i=null==n?void 0:n.config)||void 0===i?void 0:i.useDataSources)||void 0===o?void 0:o.length))){const r=e.widgets[t.widgetId];if(n.config||(n.config={}),"widgets/arcgis/query/"===r.uri){const e=null!==(s=r.outputDataSources)&&void 0!==s?s:[];n.config.useDataSources=e.map(e=>({dataSourceId:e,mainDataSourceId:e,rootDataSourceId:null})),n.config.useDataSource=n.config.useDataSources[0]}else{const e=null!==(a=r.useDataSources)&&void 0!==a?a:[];n.config.useDataSources=e.map(e=>({dataSourceId:e.dataSourceId,mainDataSourceId:e.mainDataSourceId,rootDataSourceId:e.rootDataSourceId}))}}})}),e})(r),r}},{version:"1.7.0",description:"1.7.0",upgrader:e=>{const t=function(e,t){let n;return"page"===t?n=e.pages:"view"===t?n=e.views:"dialog"===t&&(n=e.dialogs),n?(Object.keys(n).forEach(e=>{Object.keys(n).some(t=>t===e||(n[t].label===n[e].label&&(n[e].label+=" "),!1))}),n):null};let n=e;var r;return n=(e=>{var t,n;return Object.keys(null!==(t=e.dataSources)&&void 0!==t?t:{}).forEach(t=>{var n;const r=e.dataSources[t];r.isOutputFromWidget&&Object.values(null!==(n=e.widgets)&&void 0!==n?n:{}).find(e=>{var t;return"widgets/common/list/"===e.uri&&(null===(t=e.outputDataSources)||void 0===t?void 0:t.includes(r.id))})&&delete e.dataSources[t]}),Object.keys(null!==(n=e.widgets)&&void 0!==n?n:{}).forEach(t=>{const n=e.widgets[t];"widgets/common/list/"===n.uri&&Array.isArray(n.outputDataSources)&&delete n.outputDataSources}),e})(n),(r=n).pages=t(r,"page"),r.dialogs&&(r.dialogs=t(r,"dialog")),r.views&&(r.views=t(r,"view")),n=r,n=(e=>{var t;return Object.values(null!==(t=e.messageConfigs)&&void 0!==t?t:{}).forEach(t=>{var n;"DATA_SOURCE_FILTER_CHANGE"===(null==t?void 0:t.messageType)&&(null!==(n=t.actions)&&void 0!==n?n:[]).forEach(n=>{var r;if("zoomToFeature"===(null==n?void 0:n.actionName)||"panTo"===n.actionName){const i=e.widgets[t.widgetId];n.config||(n.config={});const o=(null!==(r=i.useDataSources)&&void 0!==r?r:[]).filter(e=>{var t;return null===(t=n.config.useDataSources)||void 0===t?void 0:t.find(t=>t.mainDataSourceId===e.mainDataSourceId)});n.config.useDataSources=o||[]}})}),e})(n),n}},{version:"1.8.0",description:"1.8.0",upgrader:e=>{let t=e;var n;return t=(n=t).dialogs?(Object.keys(n.dialogs).forEach(e=>{const t=n.dialogs[e];t.mode===Kh.Anchored&&(t.closeWhenClickOverlay=!0)}),n):n,t}},{version:"1.9.0",description:"1.9.0",upgrader:e=>(e=>{function t(t,n,r){var i;let o;if(hR(null==e?void 0:e.utilities,t))o=gR(null==e?void 0:e.utilities,t);else{const s=fR(e,t,n,r);o=s.id,e.utilities=null===(i=s.appConfig)||void 0===i?void 0:i.utilities}return{utilityId:o}}const n=e.widgets||{};return Object.keys(n).forEach(r=>{var i,o,s,a,l,u,c,d,p,f,h,g,m,v,y,S,b;const w="widgets/arcgis/directions/"===(null===(i=null==n?void 0:n[r])||void 0===i?void 0:i.uri),I="widgets/common/search/"===(null===(o=null==n?void 0:n[r])||void 0===o?void 0:o.uri);if(w||I){const i=I?null===(a=null===(s=null==n?void 0:n[r])||void 0===s?void 0:s.config)||void 0===a?void 0:a.datasourceConfig:null===(c=null===(u=null===(l=null==n?void 0:n[r])||void 0===l?void 0:l.config)||void 0===u?void 0:u.searchConfig)||void 0===c?void 0:c.dataConfig,o=null==i?void 0:i.map(e=>((null==e?void 0:e.geocodeURL)&&(e.useUtility=t(e.geocodeURL,Zh.GeoCoding,e.label),null==e||delete e.geocodeURL),e));if(w){let n;i&&(e.widgets[r].config.searchConfig.dataConfig=o.map(e=>(null==e||delete e.outputDataSourceId,null==e||delete e.useDataSource,e))),n=(null===(d=e.widgets[r].config.routeConfig)||void 0===d?void 0:d.routeServiceUrl)?null===(m=e.widgets[r].config.routeConfig)||void 0===m?void 0:m.routeServiceUrl:(null===(g=null===(h=null===(f=null===(p=TE().getState())||void 0===p?void 0:p.portalSelf)||void 0===f?void 0:f.helperServices)||void 0===h?void 0:h.route)||void 0===g?void 0:g.url)||"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",e.widgets[r].config.routeConfig={useUtility:t(n,Zh.Routing)},e.widgets[r].useUtilities=[null===(v=e.widgets[r].config.routeConfig)||void 0===v?void 0:v.useUtility].concat(null===(S=null===(y=e.widgets[r].config.searchConfig)||void 0===y?void 0:y.dataConfig)||void 0===S?void 0:S.map(e=>null==e?void 0:e.useUtility)).filter(e=>!!e)}else i&&(e.widgets[r].config.datasourceConfig=o),e.widgets[r].useUtilities=null===(b=e.widgets[r].config.datasourceConfig)||void 0===b?void 0:b.map(e=>null==e?void 0:e.useUtility).filter(e=>!!e)}}),e})(e)},{version:"1.10.0",description:"1.10.0",upgrader:e=>{const t=(e,t)=>t.map(t=>{if((null==e?void 0:e.dataSourceId)===(null==t?void 0:t.dataSourceId)){const n=(null==e?void 0:e.fields)||[],r=(null==t?void 0:t.fields)||[],i=Array.from(new Set(r.concat(n)));t.fields=i}return t}),n=(e,t)=>{var n;return(null===(n=null==t?void 0:t.filter(t=>(null==e?void 0:e.dataSourceId)===(null==t?void 0:t.dataSourceId)))||void 0===n?void 0:n.length)>0};let r=(e=>{const t=(e,t)=>{if(!(e.isOutputFromWidget&&e.isDataInDataSourceInstance))return!1;const n=Object.values(t).find(t=>{var n;return(null===(n=t.outputDataSources)||void 0===n?void 0:n[0])===e.id&&"widgets/common/chart/"===t.uri});return(e=>{var t,n,r,i,o,s,a,l;if(!e)return!1;const u=null===(r=null===(n=null===(t=e.config.webChart)||void 0===t?void 0:t.series)||void 0===n?void 0:n[0])||void 0===r?void 0:r.type;if(!["barSeries","lineSeries","pieSeries"].includes(u))return!1;let c=null===(o=null===(i=e.config.webChart)||void 0===i?void 0:i.dataSource)||void 0===o?void 0:o.query;return null==c&&(c=null===(l=null===(a=null===(s=e.config.webChart)||void 0===s?void 0:s.series)||void 0===a?void 0:a[0])||void 0===l?void 0:l.query),null==(null==c?void 0:c.groupByFieldsForStatistics)&&null!=(null==c?void 0:c.outStatistics)})(n)},n={jimuName:"name",type:_a.String,esriType:Ma.String,name:"name",alias:"Name",format:null},r={jimuName:"value",type:_a.Number,esriType:Ma.Double,name:"value",alias:"Value",format:{digitSeparator:!0,places:3}},i=e.dataSources;return((e,n)=>!!e&&Object.values(e).some(e=>t(e,n)))(i,e.widgets)?(Object.values(i).forEach(i=>{if(t(i,e.widgets)){const e=i.schema,t=e.fields[e.idField],o={[t.jimuName]:t,name:n,value:r};e.fields=o}}),e):e})(e);return r=(e=>{const t=e.widgets||{};return Object.keys(t).forEach(n=>{var r,i,o,s,a,l,u,c,d;"widgets/common/print/"===(null===(r=null==t?void 0:t[n])||void 0===r?void 0:r.uri)&&((null===(o=null===(i=null==e?void 0:e.widgets)||void 0===i?void 0:i[n])||void 0===o?void 0:o.style)||(e.widgets[n].style={}),(null===(l=null===(a=null===(s=null==e?void 0:e.widgets)||void 0===s?void 0:s[n])||void 0===a?void 0:a.style)||void 0===l?void 0:l.background)||(e.widgets[n].style.background={color:"var(--ref-palette-white)",fillType:"fill"}),(null===(d=null===(c=null===(u=null==e?void 0:e.widgets)||void 0===u?void 0:u[n])||void 0===c?void 0:c.style)||void 0===d?void 0:d.border)||(e.widgets[n].style.border={color:"var(--ref-palette-neutral-500)",type:"solid",width:"1px"}))}),e})(r),r=(e=>{const r=e.widgets||{};return Object.keys(r).forEach(e=>{var i,o,s;if("widgets/common/search/"===(null===(i=null==r?void 0:r[e])||void 0===i?void 0:i.uri)){const i=(null===(s=null===(o=r[e])||void 0===o?void 0:o.config)||void 0===s?void 0:s.datasourceConfig)||[];let a=[];null==i||i.forEach(e=>{const r=null==e?void 0:e.useDataSource;if(r){n(r,a)?a=t(r,a):a.push(r)}}),r[e].useDataSources=a}}),e})(r),r}},{version:"1.12.0",description:"1.12.0",upgrader:e=>{let t=(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.layouts)&&void 0!==t?t:{}).forEach(t=>{var n;const r=e.layouts[t];r.type===Vv.GridLayout&&Object.keys(null!==(n=r.content)&&void 0!==n?n:{}).forEach(e=>{const t=r.content[e],n=t.setting;null!=(null==n?void 0:n.type)?(t.gridType=n.type,delete n.type):t.gridType=Wh.Plain,null!=(null==n?void 0:n.parent)&&(t.parent=n.parent,delete n.parent),(null==n?void 0:n.children)&&(t.children=n.children,delete n.children),(null==n?void 0:n.active)>=0&&(t.activeTab=n.active,delete n.active),(null==n?void 0:n.size)>=0&&(t.bbox={width:n.size},delete n.size)})}),e})(e);return t=(e=>{const t=e.widgets||{};return Object.keys(t).forEach(e=>{var n;if("widgets/arcgis/map-layers/"===(null===(n=null==t?void 0:t[e])||void 0===n?void 0:n.uri)){t[e].enableDataAction=!1}}),e})(t),t}},{version:"1.13.0",description:"1.13.0",upgrader:e=>{let t=(e=>{const t=e.widgets||{};return Object.keys(t).forEach(n=>{var r,i,o,s,a;const l="widgets/common/list/"===(null===(r=null==t?void 0:t[n])||void 0===r?void 0:r.uri),u="widgets/common/card/"===(null===(i=null==t?void 0:t[n])||void 0===i?void 0:i.uri),c="widgets/arcgis/bookmark/"===(null===(o=null==t?void 0:t[n])||void 0===o?void 0:o.uri);(u||l||c)&&(null===(a=null===(s=null==t?void 0:t[n])||void 0===s?void 0:s.layouts)||void 0===a?void 0:a.REGULAR)&&(e.widgets[n].layouts.DEFAULT=t[n].layouts.REGULAR,delete t[n].layouts.REGULAR,t[n].layouts=(e=>{const t={};(null==e?void 0:e.DEFAULT)&&(t.DEFAULT=e.DEFAULT);for(const n in e)"DEFAULT"!==n&&(t[n]=e[n]);return t})(t[n].layouts),u?(e.widgets[n].config.DEFAULT=t[n].config.REGULAR,delete t[n].config.REGULAR):l&&(e.widgets[n].config.cardConfigs.DEFAULT=t[n].config.cardConfigs.REGULAR,delete t[n].config.cardConfigs.REGULAR))}),e})(e);var n;(n=t).widgets&&Object.keys(n.widgets).forEach(e=>{const t=n.widgets[e];"widgets/common/controller/"===t.uri&&t.layouts._openwidget&&(Object.values(t.layouts._openwidget).forEach(e=>{n.layouts[e]&&delete n.layouts[e]}),delete t.layouts._openwidget)}),t=n;return t=(e=>{const t=e.widgets||{};return Object.keys(t).forEach(e=>{const n=t[e];n&&"widgets/arcgis/arcgis-map/"===n.uri&&(n.enableDataAction=!1)}),e})(t),t}},{version:"1.14.0",description:"1.14.0",upgrader:e=>Hj(this,void 0,void 0,function*(){const{getJimuFieldNamesBySqlExpression:t}=yield NI("jimu-ui/basic/sql-expression-runtime"),n=e=>{const n=[],r=null==e?void 0:e.actionUseDataSource,i=null==e?void 0:e.messageUseDataSource;if(i&&n.push(i),r){const i=(null==e?void 0:e.sqlExprObj)||null,o=t(Ye(i))||[],s=(null==r?void 0:r.fields)||[],a=Ye(r).set("fields",Array.from(new Set(s.concat(o))));n.push(a)}return n};let r=(e=>{var t;return Object.keys(null!==(t=e.layouts)&&void 0!==t?t:{}).forEach(t=>{var n,r,i;const o=e.layouts[t];if(o.type===Vv.GridLayout){const e=null===(r=null===(n=o.setting)||void 0===n?void 0:n.expandable)||void 0===r||r;Object.keys(null!==(i=o.content)&&void 0!==i?i:{}).forEach(t=>{const n=o.content[t];n.gridType===Wh.Plain&&(n.expandable=e)})}}),e})(e);return r=(e=>{if(!e.dialogs)return e;const t={};return Object.keys(e.dialogs).forEach(n=>{e.dialogs[n].mode===Kh.Fixed&&(e.dialogs[n].blockPage=!0),t[n]=e.dialogs[n]}),e})(r),(e=>{var t;let r=!1;const i=(null==e?void 0:e.messageConfigs)||{};return null===(t=Object.keys(i))||void 0===t||t.forEach(e=>{var t;((null===(t=i[e])||void 0===t?void 0:t.actions)||[]).forEach(e=>{if((null==e?void 0:e.config)&&!(null==e?void 0:e.useDataSources)){n(null==e?void 0:e.config).length>0&&(r=!0)}})}),r})(r)&&(r=(e=>{var t;const r=(null==e?void 0:e.messageConfigs)||{};return null===(t=Object.keys(r))||void 0===t||t.forEach(e=>{var t;const i=((null===(t=r[e])||void 0===t?void 0:t.actions)||[]).map(e=>{if((null==e?void 0:e.config)&&!(null==e?void 0:e.useDataSources)){const t=n(null==e?void 0:e.config);return t.length>0&&(e.useDataSources=t),e}return e});r[e].actions=i}),e.messageConfigs=r,e})(r)),r})},{version:"1.15.0",description:"1.15.0",upgrader:e=>{const t=(e,t)=>null==t?void 0:t.some(t=>t.dataSourceId===e.dataSourceId);let n=((r=e).widgets&&Object.keys(r.widgets).forEach(e=>{var n;let i=!1;const o=r.widgets[e];if("widgets/common/print/"===o.uri){const s=(null==o?void 0:o.useDataSources)||[];((null===(n=o.config)||void 0===n?void 0:n.printCustomTemplate)||[]).forEach(e=>{const n=(null==e?void 0:e.reportOptions)||{},r=(null==n?void 0:n.reportSectionOverrides)||{};Object.keys(r).forEach(e=>{var n,o;const a=null===(o=null===(n=r[e])||void 0===n?void 0:n.exbDatasource)||void 0===o?void 0:o[0];a&&!t(a,s)&&(s.push(a),i=!0)})}),i&&(r.widgets[e].useDataSources=s)}}),r);var r;return n=(e=>(e.dialogs&&Object.keys(e.dialogs).forEach(t=>{const n=e.dialogs[t];Object.keys(n.sizeMode).forEach(e=>{const t=n.sizeMode[e];if(t)if(n.mode===Kh.Fixed){const r={widthMode:"CUSTOM",heightMode:"CUSTOM",width:t.width,height:t.height};switch(t.position){case"CENTER":r.position="MIDDLE_CENTER";break;case"LEFT":r.position="MIDDLE_LEFT",r.height="100%";break;case"RIGHT":r.position="MIDDLE_RIGHT",r.height="100%";break;case"TOP":r.position="TOP_CENTER",r.width="100%";break;case"BOTTOM":r.position="BOTTOM_CENTER",r.width="100%"}n.sizeMode[e]=r}else delete n.sizeMode[e].aspectRatio})}),e))(n),n=(e=>{const t=null==e?void 0:e.messageConfigs;if(!t)return e;let n=!1;return Object.keys(t).forEach(e=>{const r=t[e];if(r.messageType===Gy.ExtentChange){let i=r.actions;i&&(i=i.map(e=>("filter data record action"===e.actionName&&(null==e?void 0:e.config)&&!Array.isArray(e.config)&&(e.config=[e.config],n=!0),e))),n&&(t[e].actions=i)}(r.actions||[]).forEach(e=>{var t,n;(null===(t=e.config)||void 0===t?void 0:t.enabledDataRelationShip)&&!(null===(n=e.config)||void 0===n?void 0:n.connectionType)&&(e.config.connectionType=Wj.SetCustomFields)})}),n&&(e.messageConfigs=t),e})(n),n=(e=>{const t={};return Object.values(e.widgets).forEach(e=>{var n,r;"widgets/common/chart/"===e.uri&&(null===(n=e.outputDataSources)||void 0===n?void 0:n.length)&&(null===(r=e.useDataSources)||void 0===r?void 0:r.length)&&(t[e.outputDataSources[0]]=e.useDataSources)}),Object.entries(t).forEach(([t,n])=>{if(e.dataSources[t]){n[0].dataSourceId!==e.dataSources[t].originDataSources[0].dataSourceId&&(e.dataSources[t].originDataSources=n)}}),e})(n),n=(e=>(e.widgets&&Object.keys(e.widgets).forEach(t=>{const n=e.widgets[t];if("widgets/common/list/"===n.uri||"widgets/common/card/"===n.uri){const r=(null==n?void 0:n.layouts)||{};Object.keys(r).forEach(n=>{var i,o;const s=(null==r?void 0:r[n])||{};(null===(i=Object.keys(s))||void 0===i?void 0:i.length)>0&&Object.keys(s).forEach(r=>{s[r]||delete e.widgets[t].layouts[n][r]}),0===(null===(o=Object.keys(s))||void 0===o?void 0:o.length)&&delete e.widgets[t].layouts[n]})}}),e))(n),n}},{version:"1.17.0",description:"1.17.0",upgrader:e=>(e=>{const t=e.widgets||{};return Object.keys(t).forEach(e=>{const n=t[e];"widgets/arcgis/oriented-imagery/"===n.uri&&(n.uri="widgets/arcgis/classic-oriented-imagery/")}),e})(e)},{version:"1.18.0",description:"1.18.0",upgrader:e=>{let t=(e=>{if(!e.dataSources)return e;for(const t of Object.keys(e.dataSources)){const n=e.dataSources[t];"building-scene"===n.type&&(n.type=Xa.BuildingSceneLayer),"building-component"===n.type&&(n.type=Xa.BuildingComponentSubLayer),"building-group"===n.type&&(n.type=Xa.BuildingGroupSubLayer)}return e})(e);return t=(e=>{var t,n,r;if(!e.dataSources)return e;for(const i of Object.keys(e.dataSources)){const o=e.dataSources[i],s=null===(t=null==o?void 0:o.schema)||void 0===t?void 0:t.fields;i.includes("output_config_default_geocode_utility")&&(null==s?void 0:s.objectid)&&(null==s?void 0:s.default_address)&&((null===(n=s.objectid)||void 0===n?void 0:n.esriType)||(o.schema.fields.objectid=Object.assign(Object.assign({},s.objectid),{esriType:Ma.OID})),(null===(r=s.default_address)||void 0===r?void 0:r.esriType)||(o.schema.fields.default_address=Object.assign(Object.assign({},s.default_address),{esriType:Ma.String})))}return e})(t),t}}]}}var Jj=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class Kj extends zj{widgetUpgrade(e,t,n,r){return Jj(this,void 0,void 0,function*(){const i=this.checkVersions(t,n);if(!i)return e;const[o,s]=i;if(o===s)return this.runWidgetUpgrader(this.versions[s],e,r);const a=e,l=this.versions.slice(o+1,s+1).filter(e=>null==e?void 0:e.upgrader);return l.reduce((e,t)=>Jj(this,void 0,void 0,function*(){const n=yield e;return this.runWidgetUpgrader(t,n,r)}),Promise.resolve(a))})}runWidgetUpgrader(e,t,n){return Jj(this,void 0,void 0,function*(){if(e.upgradeFullInfo)return e.upgrader(t,n);{const r=yield e.upgrader(t.widgetJson.config,n);return{widgetJson:t.widgetJson.set("config",r),outputDataSourceJsons:t.outputDataSourceJsons}}})}}class Yj extends F.PureComponent{}const Xj=Yj;var Qj=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const Zj=a(2528);window.jimuConfig.exbVersion=Zj.exbVersion;class eL{static getInstance(e){return eL.instance||(eL.instance=new eL(e),window._configManager=eL.instance),eL.instance}constructor(e){this.removedOrChangedContent=null,this.intl=e.intl,xE(this.onUserChange.bind(this),["user"])}loadAppConfig(){return Qj(this,void 0,void 0,function*(){this.resetRemovedOrChangedContent();let e=yield this.loadAndProcessAppConfig();return this.updateAppInfoForDeployedApp(e.attributes),e=yield this.applyTranslation(e,window.locale),Ye(e)})}setAppConfig(e){return Qj(this,void 0,void 0,function*(){const t=yield this.processRawConfig(e),n=TE(),r=n.getState();if(r.appRuntimeInfo.currentPageId&&!t.pages[r.appRuntimeInfo.currentPageId]){nb(Object.keys(t.pages).find(e=>t.pages[e].isDefault))}n.dispatch(SA(Ye(t)))})}loadAndProcessAppConfig(){return Qj(this,void 0,void 0,function*(){return TE().getState().appConfig?Promise.resolve(TE().getState().appConfig.asMutable({deep:!0})):this.loadRawAppConfig().then(e=>Qj(this,void 0,void 0,function*(){return e.__not_publish?Promise.reject(new Error(cl.AppNotPublished)):(this.addWebmapOrWebsceneToAppConfig(e),window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder||window.jimuConfig.isSite||(yield this.removeNoPermissionPages(e)),this.upgradeAppConfig(e))})).then(e=>Qj(this,void 0,void 0,function*(){return this.initPortalAndWebTier(e)})).then(e=>Qj(this,void 0,void 0,function*(){return this.processRawConfig(e)})).then(e=>Qj(this,void 0,void 0,function*(){return this.applyAppConfigProcessorExtension(e)})).then(e=>(window.jimuConfig.isInBuilder||TE().getState().portalUrl&&Rv(TE().getState().portalUrl),e))})}initPortalAndWebTier(e){return Qj(this,void 0,void 0,function*(){var t;const n=TE().getState();if(window.jimuConfig.isInBuilder||Tv.getInstance().getMainSession())return Promise.resolve(e);if(null===(t=e.attributes)||void 0===t?void 0:t.portalUrl)if(n.portalUrl){if(Ag(n.portalUrl))TE().dispatch(pD({portalUrl:e.attributes.portalUrl,clientId:e.attributes.clientId}));else if(!n.portalUrl)return console.error("portalUrl is required."),Promise.reject(e)}else TE().dispatch(pD({portalUrl:e.attributes.portalUrl,clientId:e.attributes.clientId}));if(window.jimuConfig.isDevEdition||window.jimuConfig.isInPortal){const t=TE().getState();return this.handleWebTierAndUpdatePortalAndInitSession(t.portalUrl,t.clientId,t.isWebTier).then(()=>e)}if(window.jimuConfig.isOutOfExb){const t=Cg(e.attributes.portalUrl);return this.handleWebTierAndUpdatePortalAndInitSession(t,e.attributes.clientId,!!e.attributes.isWebTier).then(()=>e)}return Promise.resolve(e)})}upgradeAppConfig(e){return Qj(this,void 0,void 0,function*(){return lt.valid(e.exbVersion)&&lt.valid(Zj.exbVersion)?(e.originExbVersion=e.exbVersion,lt.lt(e.exbVersion,Zj.exbVersion)?(new qj).upgrade(e,e.exbVersion,Zj.exbVersion,"app").then(e=>(e.exbVersion=Zj.exbVersion,e)):(e.exbVersion,Zj.exbVersion,Promise.resolve(e))):Promise.reject(new Error(this.intl.formatMessage({id:"badVersion",defaultMessage:Xg.badVersion})))})}handleWebTierAndUpdatePortalAndInitSession(e,t,n){return Qj(this,void 0,void 0,function*(){if(n)return this.checkWebTierAndUpdatePortalAndInitSession(e,t);if(null==n)return this.checkWebTierAndUpdatePortalAndInitSession(e,t);{TE().dispatch(pD({isWebTier:!1}));const e=Tv.getInstance();return e.getMainSession()?Promise.resolve():e.initSession()}})}checkWebTierAndUpdatePortalAndInitSession(e,t){return Qj(this,void 0,void 0,function*(){const t=Tv.getInstance();return t.getSessionFromWebTierPortal(e).then(e=>{let n=!1;return e?(n=!0,TE().dispatch(pD({isWebTier:n})),t.initSession(),t.getMainSession()?n:(t.writeAuthInfo(e),t.initSession().then(()=>n))):(n=!1,TE().dispatch(pD({isWebTier:n})),t.initSession().then(()=>n))})})}processRawConfig(e){return Qj(this,void 0,void 0,function*(){if(this.processAppConfigAfterLoad(e),e.sections){const t=Object.keys(e.sections);for(const n of t)db.getInstance().registerSectionActions(n,e)}return this.loadAllWidgetsManifest(e).then(e=>(this.addDefaultLabelAndIcon(e),e))})}updateAppInfoForDeployedApp(e){if(window.jimuConfig.isOutOfExb){const t={name:e.title,description:e.description,snippet:e.description,thumbnail:e.thumbnail};TE().dispatch(wA(t))}}loadRawAppConfig(){return Qj(this,void 0,void 0,function*(){const e=GI.getInstance().getExtensions(rg.AppConfigService)[0];return e?e.loadAppConfig():this.loadAppConfigWithDefault()})}loadAppConfigWithDefault(){return Qj(this,void 0,void 0,function*(){const e=TE().getState();if(!e.appContext.isBuilder){const e=dI().appId;if(e)return window.jimuConfig.isDevEdition?this.loadAppConfigFromLocalServer(e):this.loadAppConfigFromPortal(e)}let t=e.queryObject.config;t||(t=e.queryObject.mode?`${e.queryObject.mode}.json`:"config.json");const n=t.split(":");if(2===n.length&&"item"===n[0])return this.loadAppConfigFromPortal(n[1]);if(Jw(t)&&!fg(t.trim())){const e="Only *.arcgis.com is allowed.";return console.error(e),Promise.reject({message:e})}return window.fetch(t).then(e=>Qj(this,void 0,void 0,function*(){return e.json()}))})}addWebmapOrWebsceneToAppConfig(e){if(window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder)return;const t="template"===window.jimuConfig.appFolderName,n=TE().getState().queryObject;Iy(e,null==n?void 0:n.webmap,null==n?void 0:n.webscene,t)}loadAppConfigFromLocalServer(e){return Qj(this,void 0,void 0,function*(){const t=TE().getState().queryObject.draft,n="true"===t||"1"===t?`${window.jimuConfig.mountPath}apps/${e}/resources/config/config.json`:`${window.jimuConfig.mountPath}apps/${e}/config.json`;return window.fetch(n).then(e=>404===e.status?Promise.reject(Error(cl.AppNotExisted)):e.json())})}loadAppConfigFromPortal(e){return Qj(this,void 0,void 0,function*(){const t=Tv.getInstance(),n=(new Date).getTime(),r=TE().getState().queryObject.draft;return"true"===r||"1"===r?Pr(`${cg(TE().getState().portalUrl)}/content/items/${e}/resources/config/config.json`,{authentication:t.getSessionByUrl(TE().getState().portalUrl),httpMethod:"GET",params:{timestamp:n}}).catch(t=>"CONT_0001"===t.code||"CONT_009431"===t.code?Promise.reject(Error(cl.AppNotExisted)):this._handleAuthError(t,e)):Li(e,{portal:cg(TE().getState().portalUrl),authentication:t.getSessionByUrl(TE().getState().portalUrl)}).catch(t=>Qj(this,void 0,void 0,function*(){return"CONT_0001"===t.code||"CONT_009431"===t.code?Promise.reject(Error(cl.AppNotExisted)):this._handleAuthError(t,e)}))})}_handleAuthError(e,t){return Qj(this,void 0,void 0,function*(){const n=!!tw();return Tv.getInstance().handleAuthError(e,n).then(()=>Qj(this,void 0,void 0,function*(){return n?(kv(t),Lv(),ev(Km.Experience).then(e=>{if(e.valid){const e=document.getElementById("app").style;null==e||e.removeProperty("z-index"),TE().dispatch(zD(ul.PrivilegeError))}else TE().dispatch(HD({type:ul.PrivilegeError,code:e.invalidInfo,message:e.invalidMessage}))}).catch(e=>{console.error(e),TE().dispatch(HD({type:ul.PrivilegeError,code:cl.PrivilegeNullInfo}))}),Rv(TE().getState().portalUrl),Nv(t).then(e=>(TE().dispatch(wA(e)),e)),this.loadAppConfigFromPortal(t)):Promise.reject({})}))})}applyAppConfigProcessorExtension(e){return Qj(this,void 0,void 0,function*(){const t=GI.getInstance().getExtensions(rg.AppConfigProcessor)[0];return t?t.process(e):Promise.resolve(e)})}loadAllWidgetsManifest(e){return Qj(this,void 0,void 0,function*(){const t=vb.getInstance(),n=cy(e).map((n,r)=>Qj(this,void 0,void 0,function*(){const r=n;if(r.uri||r.itemId){if(r.itemId)try{r.uri=yield t.getWidgetUriByItemId(r.itemId)}catch(e){console.error(e);const t={i18nMessages:{},properties:{}};return r.manifest=t,Promise.resolve()}return e.useCachedManifest&&e.widgetsManifest[r.uri]?(r.manifest=e.widgetsManifest[r.uri],yield t.processWidgetManifest(r),void(yield t.registerManifestProps(n,e))):t.loadWidgetManifest(r.uri,!r.itemId).then(n=>Qj(this,void 0,void 0,function*(){return r.manifest=n,t.processWidgetManifest(r).then(()=>Qj(this,void 0,void 0,function*(){return t.registerManifestProps(r,e)}))}),e=>Qj(this,void 0,void 0,function*(){console.error(e);return r.manifest={i18nMessages:{},properties:{}},Promise.resolve()}))}}));return Promise.all(n).then(t=>e)})}processAppConfigAfterLoad(e){this.cleanConfig(e),this.handleEmbedMode(e),this.addDefaultValues(e),this.fixAllIds(e),this.processWidgets(e),this.fixThemeUri(e),this.addDefaultPageStructure(e),this.buildAppStructure(e)}cleanConfig(e){const t=e.widgets||{};Object.keys(t).forEach(n=>{var r,i;const o=t[n];if("widgets/common/controller/"===(null==o?void 0:o.uri)){const o=t[n];Object.keys(null!==(i=null===(r=o.layouts)||void 0===r?void 0:r._openwidget)&&void 0!==i?i:{}).forEach(t=>{const n=o.layouts._openwidget[t],r=e.layouts[n];r&&(r.content={},r.order=[])})}(null==o?void 0:o.parent)&&delete o.parent,(null==o?void 0:o.layouts)&&(Object.keys(o.layouts).forEach(t=>{const n=o.layouts[t];Object.keys(null!=n?n:{}).forEach(t=>{const r=n[t];e.layouts[r]||delete n[t]}),o.layouts[t]&&0===Object.keys(o.layouts[t]).length&&delete o.layouts[t]}),0===Object.keys(o.layouts).length&&delete o.layouts)}),e.layouts.undefined&&delete e.layouts.undefined}handleEmbedMode(e){const t=TE().getState().queryObject.embedded;"true"!==t&&"1"!==t||Object.keys(e.pages).forEach(t=>{e.pages[t].header=!1,e.pages[t].footer=!1})}buildAppStructure(e){var t,n,r,i;const o=(t,n,r)=>{var i,o;if((null===(o=null===(i=t.parent)||void 0===i?void 0:i[n])||void 0===o?void 0:o.length)>0){t.parent[n]=t.parent[n].filter(t=>{var n,r;return null!=(null===(r=null===(n=e.layouts[t.layoutId])||void 0===n?void 0:n.content)||void 0===r?void 0:r[t.layoutItemId])});if(!t.parent[n].some(e=>e.layoutId===r.layoutId&&e.layoutItemId===r.layoutItemId)){t.parent[n].push(r)}}else t.parent?t.parent[n]=[r]:t.parent={[n]:[r]}},s=(t,n,r)=>{Object.keys(null!=t?t:{}).forEach(i=>{const a=t[i],l=e.layouts[a];l&&(l.parent={id:n,type:r},((t,n,r)=>{var i;Object.keys(null!==(i=n.content)&&void 0!==i?i:{}).forEach(i=>{const a=n.content[i];switch(a.type){case $v.Widget:{const n=e.widgets[a.widgetId];n?(o(n,r,{layoutId:t,layoutItemId:i}),n.layouts&&Object.values(n.layouts).forEach(e=>{s(e,a.widgetId,Gh.Widget)})):a.widgetId&&delete a.widgetId;break}case $v.Section:{const n=e.sections[a.sectionId];o(n,r,{layoutId:t,layoutItemId:i}),n.views.forEach(t=>{const r=e.views[t];r.parent=n.id,s(r.layout,t,Gh.View)});break}case $v.ScreenGroup:{const n=e.screenGroups[a.screenGroupId];n.parent?n.parent[r]={layoutId:t,layoutItemId:i}:n.parent={[r]:{layoutId:t,layoutItemId:i}},n.screens.forEach(t=>{var r;const i=e.screens[t];i.parent=n.id,s(i.main.layout,t,Gh.Screen),(null===(r=i.panel)||void 0===r?void 0:r.layout)&&s(i.panel.layout,t,Gh.Screen)});break}}})})(a,l,i))})};Object.values(null!==(t=e.pages)&&void 0!==t?t:{}).forEach(e=>{s(e.layout,e.id,Gh.Page)}),Object.values(null!==(n=e.dialogs)&&void 0!==n?n:{}).forEach(e=>{s(e.layout,e.id,Gh.Dialog)}),(null===(r=e.header)||void 0===r?void 0:r.layout)&&s(e.header.layout,"",Gh.Header),(null===(i=e.footer)||void 0===i?void 0:i.layout)&&s(e.footer.layout,"",Gh.Footer)}addDefaultPageStructure(e){e.pageStructure||(e.pageStructure=[],Object.keys(e.pages).forEach(t=>{e.pageStructure.push({[t]:[]})}))}fixAllIds(e){this.fixId(e.pages),this.fixId(e.widgets),this.fixId(e.sections),this.fixId(e.views),this.fixId(e.dialogs),this.fixId(e.messageConfigs),this.fixId(e.dataSources),fy(e)}fixId(e){e&&Object.keys(e).forEach(t=>{"string"!=typeof e[t]&&(e[t].id=t)})}processWidgets(e){Object.keys(e.widgets).forEach(t=>{const n=e.widgets[t];n.uri&&!/\/$/.test(n.uri)&&(n.uri=n.uri+"/");const r=ry(n.uri);n.context=r,n.originVersion=n.version})}fixThemeUri(e){/\/$/.test(e.theme)||(e.theme=e.theme+"/")}addDefaultValues(e){return e.attributes||(e.attributes={}),e.widgets||(e.widgets={}),e.widgetsManifest||(e.widgetsManifest={}),e.views||(e.views={}),e.sections||(e.sections={}),e.dialogs||(e.dialogs={}),e.pages||(e.pages={}),e.layouts||(e.layouts={}),e.dataSources||(e.dataSources={}),e.messageConfigs||(e.messageConfigs={}),this.addDefaultPageVisible(e),e}addDefaultPageVisible(e){Object.keys(e.pages).forEach(t=>{void 0===e.pages[t].isVisible&&(e.pages[t].isVisible=!0)})}addDefaultLabelAndIcon(e){this.addPageLabel(e),Object.keys(e.dialogs||{}).forEach(t=>{e.dialogs[t].label||(e.dialogs[t].label=ly(e,"dialog",this.intl.formatMessage({id:"dialog",defaultMessage:Xg.dialog})))}),e.layouts&&Object.keys(e.layouts).filter(t=>e.layouts[t].type===Vv.FlowLayout).forEach(t=>{const n=e.layouts[t];Object.keys(n.content||{}).filter(e=>n.content[e].type===$v.Widget).map(e=>n.content[e].widgetId).forEach(t=>{const n=e.widgets[t];if(n&&!n.label&&"widgets/layout/row/"===n.uri){const t=this.intl.formatMessage({id:"block",defaultMessage:Xg.block});n.label=ly(e,"widget",t)}})}),cy(e).forEach(t=>{oy(e,t)}),Object.keys(e.sections||{}).forEach(t=>{const n=e.sections[t];n.label||(n.label=ly(e,"section",this.intl.formatMessage({id:"section",defaultMessage:Xg.section})))}),Object.keys(e.views||{}).forEach(t=>{var n,r,i,o,s;const a=e.views[t];if(!a.label){if("tab"===e.template){const t=Object.values(a.layout||{})[0];if(t){const l=null===(o=null===(i=Object.values((null===(r=null===(n=e.layouts)||void 0===n?void 0:n[t])||void 0===r?void 0:r.content)||{}))||void 0===i?void 0:i[0])||void 0===o?void 0:o.widgetId;if(l){const t=null===(s=e.widgets)||void 0===s?void 0:s[l];if(null==t?void 0:t.label)return void(a.label=t.label)}}}a.label=ly(e,"view",this.intl.formatMessage({id:"view",defaultMessage:Xg.view}))}}),Object.keys(e.screenGroups||{}).forEach(t=>{const n=e.screenGroups[t];n.label||(n.label=ly(e,"screenGroup",this.intl.formatMessage({id:"screenGroup",defaultMessage:Xg.screenGroup})))}),Object.keys(e.screens||{}).forEach(t=>{const n=e.screens[t];n.label||(n.label=ly(e,"screen",this.intl.formatMessage({id:"screen",defaultMessage:Xg.screen})))}),sy(e)}addPageLabel(e){e.pageStructure&&e.pageStructure.forEach(t=>{const n=Object.keys(t)[0];e.pages[n]&&!e.pages[n].label&&(e.pages[n].label=ly(e,"page",this.intl.formatMessage({id:"page",defaultMessage:Xg.page}))),t[n].forEach(t=>{e.pages[t]&&!e.pages[t].label&&(e.pages[t].label=ly(e,"page",this.intl.formatMessage({id:"page",defaultMessage:Xg.page})))})})}applyTranslation(e,t){return Qj(this,void 0,void 0,function*(){if(window.jimuConfig.isInBuilder||!e.translations||0===e.translations.length||!e.translations.find(e=>e.value===t))return e;const n="true"===TE().getState().queryObject.draft||"1"===TE().getState().queryObject.draft;let r;const i=yj(t,n),o=dI().appId;r=o?window.jimuConfig.isDevEdition?`${window.jimuConfig.mountPath}apps/${o}/resources`:`${cg(TE().getState().portalUrl)}/content/items/${o}/resources`:`${EI()}resources`;const s=`${r}/${i}`;try{const t=yield window.fetch(s);if(404===t.status)return e;{const n=yield t.json();return wj(e,n),e}}catch(t){return console.error("Fetch translation file error.",t),Promise.resolve(e)}})}removeNoPermissionPages(e){return Qj(this,void 0,void 0,function*(){const t=yield vv(e);if(0===t.length)return e;this.resetRemovedOrChangedContent();const n=t.map(t=>{const n=e.pages[t];return{id:n.id,label:n.label,isDefault:n.isDefault}});TE().dispatch(lR(n));const r=t=>{const n=e.widgets[t];n&&(this.removedOrChangedContent.widgets[t]=n,Object.keys(e.messageConfigs||{}).forEach(n=>{const r=e.messageConfigs[n];r.widgetId===t?(this.removedOrChangedContent.messageConfigs[n]=r,delete e.messageConfigs[n]):(r.actions||[]).forEach(e=>{e.widgetId===t&&(this.removedOrChangedContent.messageConfigs[n]||(this.removedOrChangedContent.messageConfigs[n]=Jm(r)),r.actions=r.actions.filter(t=>t!==e))})}),n.layouts&&Object.keys(n.layouts).forEach(e=>{const t=n.layouts[e];Object.keys(t||{}).forEach(e=>{const n=t[e];s(n)})}),delete e.widgets[t])},i=t=>{const n=e.sections[t];n&&(this.removedOrChangedContent.sections[t]=n,n.views.forEach(t=>{const n=e.views[t];this.removedOrChangedContent.views[t]=n,Object.keys(n.layout||{}).forEach(e=>{const t=n.layout[e];s(t)}),delete e.views[t]}),Object.keys(e.messageConfigs||{}).forEach(n=>{const r=e.messageConfigs[n];r.widgetId===t?(this.removedOrChangedContent.messageConfigs[n]=r,delete e.messageConfigs[n]):(r.actions||[]).forEach(e=>{e.widgetId===t&&(this.removedOrChangedContent.messageConfigs[n]||(this.removedOrChangedContent.messageConfigs[n]=Jm(r)),r.actions=r.actions.filter(t=>t!==e))})}),delete e.sections[t])},o=t=>{const n=e.screenGroups[t];n&&(this.removedOrChangedContent.screenGroups[t]=n,n.screens.forEach(t=>{var n;const r=e.screens[t];this.removedOrChangedContent.screens[t]=r,Object.keys(r.main.layout||{}).forEach(e=>{const t=r.main.layout[e];s(t)}),(null===(n=r.panel)||void 0===n?void 0:n.layout)&&Object.keys(r.panel.layout||{}).forEach(e=>{const t=r.panel.layout[e];s(t)}),delete e.screens[t]}),delete e.screenGroups[t])},s=t=>{if(!t||!e.layouts[t])return;const n=e.layouts[t];this.removedOrChangedContent.layouts[t]=n,Object.keys(n.content||{}).forEach(e=>{const t=n.content[e];switch(t.type){case $v.Widget:r(t.widgetId);break;case $v.Section:i(t.sectionId);break;case $v.ScreenGroup:o(t.screenGroupId)}}),delete e.layouts[t]};return this.removedOrChangedContent.pageStructure=Jm(e.pageStructure),t.forEach(t=>{const n=e.pages[t];this.removedOrChangedContent.pages[t]=n,Object.keys(n.layout||{}).forEach(e=>{const t=n.layout[e];s(t)}),e.pageStructure=(e.pageStructure||[]).filter(e=>Object.keys(e)[0]!==t).map(e=>{const n=Object.keys(e)[0];return e[n]=e[n].filter(e=>e!==t),e}),delete e.pages[t]}),e})}onUserChange(e,t){if(e==t)return;if(window.jimuConfig.isBuilder||window.jimuConfig.isSite||window.jimuConfig.isInBuilder)return;const n=TE().getState().appConfig;n&&ZE(()=>Qj(this,void 0,void 0,function*(){const r=this.mergeRemovedOrChangedContent(n);TE().dispatch(lR([]));let i=yield this.removeNoPermissionPages(r);i=yield this.upgradeAppConfig(i),i=yield this.processRawConfig(i);const o=TE().getState().queryObject.locale||(null==e?void 0:e.culture)||bb(window.navigator),s=TE().getState().queryObject.locale||t.culture||bb(window.navigator);o!==s&&(i=yield this.applyTranslation(i,s));const a=Ye(i);TE().dispatch(SA(a))}))}mergeRemovedOrChangedContent(e){return e=e.set("pages",e.pages.merge(this.removedOrChangedContent.pages)),this.removedOrChangedContent.pageStructure.length>0&&(e=e.set("pageStructure",this.removedOrChangedContent.pageStructure)),(e=(e=(e=(e=(e=(e=(e=e.set("widgets",(e.widgets||Ye({})).merge(this.removedOrChangedContent.widgets))).set("sections",(e.sections||Ye({})).merge(this.removedOrChangedContent.sections))).set("views",(e.views||Ye({})).merge(this.removedOrChangedContent.views))).set("screenGroups",(e.screenGroups||Ye({})).merge(this.removedOrChangedContent.screenGroups))).set("screens",(e.screens||Ye({})).merge(this.removedOrChangedContent.screens))).set("layouts",e.layouts.merge(this.removedOrChangedContent.layouts))).set("messageConfigs",(e.messageConfigs||Ye({})).merge(this.removedOrChangedContent.messageConfigs))).asMutable({deep:!0})}resetRemovedOrChangedContent(){this.removedOrChangedContent={pages:{},pageStructure:[],widgets:{},sections:{},views:{},screenGroups:{},screens:{},layouts:{},messageConfigs:{}}}}class tL{static getInstance(){return tL.instance||(tL.instance=new tL,window._urlManager=tL.instance),tL.instance}init(e){let t=_t.parse(window.location.search,{decode:!1});t=LS(t),e.dispatch(kA(t));const n=IS(window.location.hash);return e.dispatch(UA(n)),t.__env__&&("prod"===window.jimuConfig.hostEnv?console.warn("The __env__ query parameter is only valid in dev and qa environments."):window.jimuConfig.hostEnv=t.__env__),{queryObject:t,urlHashObject:n}}changePage(e){nb(e)}changeView(e,t){rb(e,t)}changeDialog(e){ob(e)}getQueryObject(){return TE().getState().queryObject}changeQueryObject(e,t){const{replaceHistory:n=!1,isReplaceQueryObject:r=!1}=null!=t?t:{};eb(e,n,r)}getHashObject(){var e,t;return window.jimuConfig.isBuilder?null===(e=TE().getState())||void 0===e?void 0:e.appStateInBuilder.urlHashObject:null===(t=TE().getState())||void 0===t?void 0:t.urlHashObject}changeUrlHashObject(e,t){tb(e,t)}setWidgetUrlParams(e,t,n){var r,i;const{isReplaceHashObject:o=!1}=null!=n?n:{};if(vS(e)){let n=Ye.from({});o||(n=null!==(i=null===(r=TE().getState().urlHashObject)||void 0===r?void 0:r.getIn([e]))&&void 0!==i?i:Ye.from({}),n=RS(n)),n=Ye.from(null!=n?n:{});const s={};if(t)for(const e of Object.keys(t)){const n=t[e],r=null==n;s[e]=r?null:encodeURIComponent(n)}n=n.merge(s),null==t&&(n=null),this.setHashObject(Ye.from({[e]:n}),o)}}setHashObject(e,t=!1){let n=bS(e);n=wS(n),tb(n,{isReplaceHashObject:t})}changeHashObjectByDataSourceSelection(e,t){return!!PS()&&(sb(e,t),!0)}}const nL=tL;var rL;!function(e){e.DataSource="DATA_SOURCE",e.Records="RECORDS"}(rL||(rL={}));class iL{constructor(e){e.id&&(this.id=e.id),e.name&&(this.name=e.name),e.label&&(this.label=e.label),e.icon&&(this.icon=e.icon),e.index&&(this.index=e.index),e.widgetId&&(this.widgetId=e.widgetId),e.intl&&(this.intl=e.intl)}destroy(){return null}getLabel(e){return this.label}}class oL extends iL{isSupported(e,t,n){return Promise.resolve(!0)}onExecute(e,t,n){return Promise.resolve(!0)}}var sL=a(6420),aL=a.n(sL),lL=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class uL extends iL{constructor(e){super(e),this.icon=aL()}isFeatureCollectionDataSource(e){const t=e.getDataSourceJson();return t.type===Xa.FeatureLayer&&!t.url}isSupported(e,t){return lL(this,void 0,void 0,function*(){if(e.length>1&&t!==rL.Records)return!1;for(let n=0;n<e.length;n++){if(yield this.dataSourceAllowExport(e[n],t))return!0}return!1})}dataSourceAllowExport(e,t){return lL(this,void 0,void 0,function*(){const{dataSource:n}=e;if(null==n||"function"!=typeof n.query||n.getStatus()===Ya.NotReady)return!1;if(!Object.keys(n.getSchema()||{}).length)return!1;if(n.useNoSelectionView())return!1;const r=n;return!!(yield r.allowToExportData())&&(t!==rL.Records||this.getLocalRecrods(e).length>0)})}checkPrivilegeAsync(){return Promise.resolve(!0)}confirm(e,t){return lL(this,void 0,void 0,function*(){if(e.getDataSourceJson().isDataInDataSourceInstance||t===rL.Records)return{needed:!1};let n=e.count;if(null==n){const t=e;if("function"==typeof t.queryCount){n=(yield t.queryCount({})).count}}if(n>1e4){const e=Tb();return{needed:!0,content:{title:e.formatMessage({id:"largeWarningTitle"}),content:e.formatMessage({id:"largeWarningContent"}),okLabel:e.formatMessage({id:"export"}),cancelLabel:e.formatMessage({id:"cancel"})}}}return{needed:!1}})}getExportFileName(e){return e.getLabel()||e.getDataSourceJson().sourceLabel}getLocalRecrods(e){return e.records}getSpatialReferenceFromRecord(e){const t=e.getGeometry();if(t)return t.spatialReference}getRecords(e,t){return lL(this,arguments,void 0,function*(e,t,n=!0){const r=e;try{const e={returnGeometry:n};null!=t?e.outFields=t:(e.outFields=["*"],e.notAddFieldsToClient=!0);return(yield r.queryAll(e)).records}catch(e){return console.error("query failed",e),[]}})}processGeometryAndBuffer(e,t,n){return lL(this,void 0,void 0,function*(){if(e&&(t>0||t<0)){let r;switch(n){case"esriSRUnit_Meter":r="meters";break;case"esriSRUnit_Foot":r="feet";break;case"esriSRUnit_Kilometer":r="kilometers";break;case"esriSRUnit_StatuteMile":r="miles";break;case"esriSRUnit_NauticalMile":case"esriSRUnit_USNauticalMile":r="nautical-miles"}if(null!=r){const n=(yield Bg("esri/geometry/support/jsonUtils")).fromJSON(e);return[(yield qC(n,[t],r)).toJSON(),"esriGeometryPolygon"]}}return[e,e?Yb(e):void 0]})}createReplicaRequest(e,t,n,r,i,o){return lL(this,void 0,void 0,function*(){const s=e.url,a="/FeatureServer",l=s.lastIndexOf(a),u=s.substring(0,l+14),c=Tv.getInstance().getSessionByUrl(s);let d=`${u}/createReplica`;(null==c?void 0:c.token)&&(d=`${d}?token=${c.token}`);const p={layers:+n,layerQueries:{[n]:r},replicaName:this.getExportFileName(e),transportType:"esriTransportTypeUrl",returnAttachments:!1,returnAttachmentsDataByUrl:!0,async:!0,syncModel:"none",targetType:"client",syncDirection:"download",attachmentsSyncDirection:"none",dataFormat:t,exportFieldDomainDescription:!0,f:"json"};i&&o&&(p.geometry=i,p.geometryType=o);const f=yield Pr(d,{authentication:c,httpMethod:"POST",params:p}),h=null==f?void 0:f.statusUrl;return h?new Promise((e,t)=>{const n=setInterval(()=>{Pr(h,{authentication:c,httpMethod:"GET"}).then(r=>{if("Completed"===r.status){const i=null==r?void 0:r.resultUrl;i?(null==c?void 0:c.token)?e(`${i}?token=${c.token}`):e(i):t(new Error("no result url found")),clearInterval(n)}else"Failed"!==r.status&&"CompletedWithErrors"!==r.status||(clearInterval(n),t(new Error("createReplica job failed")))}).catch(e=>{clearInterval(n),t(new Error(e))})},5e3)}):Promise.reject(new Error("failed"))})}tryCreateReplica(e,t,n,r){return lL(this,void 0,void 0,function*(){const i=e.url;if(e.type===Xa.FeatureLayer&&i){const o=/\/FeatureServer\/([0-9]+)/,s=i.match(o);if(2===(null==s?void 0:s.length)){const i=s[1],o=e.getCurrentQueryParams(),a={where:null==o?void 0:o.where,useGeometry:null!=r&&r||null!=(null==o?void 0:o.geometry),queryOption:"useFilter"};(null==n?void 0:n.length)>0&&(a.fields=n.join(","));try{const[n,r]=yield this.processGeometryAndBuffer(null==o?void 0:o.geometry,null==o?void 0:o.distance,null==o?void 0:o.units);return this.createReplicaRequest(e,t,i,a,n,r)}catch(e){console.warn("createReplica not supported",e)}}}return Promise.reject(new Error("failed"))})}tryCreateReplicaUsingRecords(e,t,n){return lL(this,void 0,void 0,function*(){const r=this.getLocalRecrods(e),{dataSource:i,fields:o}=e,s=i.url;if(i.type===Xa.FeatureLayer&&s){const e=/\/FeatureServer\/([0-9]+)/,a=s.match(e);if(2===(null==a?void 0:a.length)){const e=a[1],s={where:`${i.getIdField()} in (${r.map(e=>e.getId()).join(",")})`,useGeometry:null!=n&&n||null!=r[0].getGeometry(),queryOption:"useFilter"};(null==o?void 0:o.length)>0&&(s.fields=o.join(","));try{return this.createReplicaRequest(i,t,e,s)}catch(e){console.warn("createReplica not supported",e)}}}return Promise.reject(new Error("failed"))})}saveAsLocalFile(e,t){if(tw()){const n=Yw(FI("jimu-core")),r=`${window.location.origin}${n}/download.html`,i=window.open(r,"_blank","popup,width=320,height=320");i.onload=()=>{i.postMessage({fileName:t,blob:e},window.location.origin)}}else(0,Zn.saveAs)(e,t)}}var cL=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class dL extends uL{constructor(e){super(e),this.icon=aL()}isSupported(e,t){const n=Object.create(null,{isSupported:{get:()=>super.isSupported}});return cL(this,void 0,void 0,function*(){return!!(yield n.isSupported.call(this,e,t))&&e.every(e=>{var t,n;const{dataSource:r}=e,i=null===(n=(t=r).getExportOptions)||void 0===n?void 0:n.call(t);return!i||(null==i.formats||i.formats.includes(Qh.JSON))})})}onExecute(e,t){return cL(this,void 0,void 0,function*(){if(e.length>1)return this.batchExport(e);const n=e[0],{dataSource:r}=n,i=yield this.confirm(r,t);if(i.needed){const{ConfirmDialog:e}=yield NI("jimu-ui");return(0,sg.jsx)(e,{level:"info",title:i.content.title,hasNotShowAgainOption:!1,content:i.content.content,confirmLabel:i.content.okLabel,cancelLabel:i.content.cancelLabel,onConfirm:()=>{this.doExport(n,t)}})}return this.doExport(n,t)})}processDataRecord(e,t){const n=e.toJson();if((null==n?void 0:n.attributes)&&(null==t?void 0:t.length)>0&&"*"!==t[0]){const e=n.attributes;n.attributes={},Object.keys(null!=e?e:{}).forEach(r=>{t.includes(r)&&(n.attributes[r]=e[r])})}return n}exportRecords(e,t,n){const r=t.map(e=>this.processDataRecord(e,n)),i=new Blob([JSON.stringify(r)],{type:"text/plain;charset=utf-8"});this.saveAsLocalFile(i,`${this.getExportFileName(e)}.json`)}batchExport(e){return cL(this,void 0,void 0,function*(){const{JSZip:t}=yield NI("jimu-core/jszip"),n=new t;for(const t of e){const{dataSource:e,fields:r}=t;if(yield this.dataSourceAllowExport(t,rL.Records)){const i=this.getLocalRecrods(t).map(e=>this.processDataRecord(e,r)),o=new Blob([JSON.stringify(i)],{type:"text/plain;charset=utf-8"});n.file(`${this.getExportFileName(e)}.json`,o)}}return n.generateAsync({type:"blob"}).then(e=>{this.saveAsLocalFile(e,"json_datasets.zip")}),!0})}doExport(e,t){return cL(this,void 0,void 0,function*(){const{dataSource:n,fields:r}=e,{enqueueNotification:i,closeNotification:o,ExportLoadingIndicator:s}=yield NI("jimu-ui");if(t===rL.Records)return this.exportRecords(n,this.getLocalRecrods(e),r),!0;const a=Tb(),l=i({message:a.formatMessage({id:"export"}),severity:"info",description:(0,sg.jsx)(s,{message:a.formatMessage({id:"exportingData"},{name:this.getExportFileName(n)})}),autoHideDuration:0});try{const e=yield this.tryCreateReplica(n,"json",r);return window.open(e,"_blank"),o(l),!0}catch(e){}const u=yield this.getRecords(n,r);return this.exportRecords(n,u),o(l),!0})}}function pL(){var e;const t=null!==(e=TE().getState().appContext.locale)&&void 0!==e?e:"en",[,n]=jw(123456789.12345678,!1);return","===Ab(t)||n.includes(",")?";":","}function fL(e){return e.replace(/\r\n?/g,"\n").replace(/\n/g," ")}function hL(e,t,n){const r=t.find((t,r)=>{var i;return(null!==(i=null==n?void 0:n[r])&&void 0!==i?i:t)===e});return r?hL(`_${e}`,t,n):e}function gL(e,t,n){let r,i;const o=e.getSchema();if(null!=(null==o?void 0:o.fields))r=null!=n?n:Object.keys(o.fields),r=r.filter(e=>null!=o.fields[e]),i=r.map(e=>o.fields[e].alias);else{const e=t[0];r=null!=n?n:Object.keys(e.getData())}const s=e.getIdField();if(s&&r.includes(s)){const e=r.indexOf(s);if(r.splice(e,1),r.unshift(s),i){const t=i.splice(e,1)[0];i.unshift(t)}}const a=function(e){return"esriGeometryPoint"===e.getGeometryType()}(e);let l=function(e,t,n){const r=pL();let i="",o=!1,s=!1;if(e.forEach((n,a)=>{var l;let u=null!==(l=null==t?void 0:t[a])&&void 0!==l?l:n;u.includes(r)&&(u=`"${u}"`),o=o||"x"===u,s=s||"y"===u,a!==e.length-1?i+=`${u}${r}`:i+=u}),n){const n=hL("x",e,t),o=hL("y",e,t);i+=`${r}${n}${r}${o}`}return`${i}\r\n`}(r,i,a);return t.forEach(e=>{l+=function(e,t,n){const r=Tb(),i=pL();let o="";if(t.forEach((n,s)=>{var a;let l=null!==(a=e.getFormattedFieldValue(n,r))&&void 0!==a?a:"";l.includes('"')&&(l=l.replace(/"/g,'""')),l.includes(i)&&(l=`"${l}"`),s!==t.length-1?o+=fL(`${l}${i}`):o+=fL(l)}),n){const t=e.getGeometry();if(t){const[e,n]=jw(t.x,!1),[r,s]=jw(t.y,!1);o+=`${i}${e}${n}${i}${r}${s}`}}return`${o}\r\n`}(e,r,a)}),new Blob(["\ufeff",l],{type:"text/plain;charset=utf-8"})}var mL=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class vL extends uL{isSupported(e,t){const n=Object.create(null,{isSupported:{get:()=>super.isSupported}});return mL(this,void 0,void 0,function*(){return!!(yield n.isSupported.call(this,e,t))&&e.every(e=>{var t,n;const{dataSource:r}=e,i=null===(n=(t=r).getExportOptions)||void 0===n?void 0:n.call(t);return!i||(null==i.formats||i.formats.includes(Qh.CSV))})})}onExecute(e,t){return mL(this,void 0,void 0,function*(){if(e.length>1)return this.batchExport(e);const n=e[0],{dataSource:r}=n,i=yield this.confirm(r,t);if(i.needed){const{ConfirmDialog:e}=yield NI("jimu-ui");return(0,sg.jsx)(e,{level:"info",title:i.content.title,hasNotShowAgainOption:!1,content:i.content.content,confirmLabel:i.content.okLabel,cancelLabel:i.content.cancelLabel,onConfirm:()=>{this.doExport(n,t)}})}return this.doExport(n,t)})}exportRecords(e,t,n){const r=gL(e,t,n);this.saveAsLocalFile(r,`${this.getExportFileName(e)}.csv`)}batchExport(e){return mL(this,void 0,void 0,function*(){const{JSZip:t}=yield NI("jimu-core/jszip"),n=new t;for(const t of e){const{dataSource:e,fields:r}=t;if(yield this.dataSourceAllowExport(t,rL.Records)){const i=gL(e,this.getLocalRecrods(t),r);n.file(`${this.getExportFileName(e)}.csv`,i)}}return n.generateAsync({type:"blob"}).then(e=>{this.saveAsLocalFile(e,"csv_datasets.zip")}),!0})}doExport(e,t){return mL(this,void 0,void 0,function*(){const{dataSource:n,fields:r}=e,{enqueueNotification:i,closeNotification:o,ExportLoadingIndicator:s}=yield NI("jimu-ui");if(t===rL.Records)return this.exportRecords(n,this.getLocalRecrods(e),r),!0;const a=Tb(),l=i({message:a.formatMessage({id:"export"}),severity:"info",description:(0,sg.jsx)(s,{message:a.formatMessage({id:"exportingData"},{name:this.getExportFileName(n)})}),autoHideDuration:0});try{const e=yield this.tryCreateReplica(n,"csv",r);return window.open(e,"_blank"),o(l),!0}catch(e){}const u=yield this.getRecords(n,r);return this.exportRecords(n,u,r),o(l),!0})}}var yL=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function SL(e){return function(e,t){for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(e[0],e[e.length-1])||e.push(e[0]),e}function bL(e){let t=0,n=0;const r=e.length;let i,o=e[n];for(;n<r-1;n++)i=e[n+1],t+=(i[0]-o[0])*(i[1]+o[1]),o=i;return t>=0}function wL(e,t,n,r){const i=(r[0]-n[0])*(e[1]-n[1])-(r[1]-n[1])*(e[0]-n[0]),o=(t[0]-e[0])*(e[1]-n[1])-(t[1]-e[1])*(e[0]-n[0]),s=(r[1]-n[1])*(t[0]-e[0])-(r[0]-n[0])*(t[1]-e[1]);if(0!==s){const e=i/s,t=o/s;if(e>=0&&e<=1&&t>=0&&t<=1)return!0}return!1}function IL(e,t){for(let n=0;n<e.length-1;n++)for(let r=0;r<t.length-1;r++)if(wL(e[n],e[n+1],t[r],t[r+1]))return!0;return!1}function EL(e,t){const n=IL(e,t),r=function(e,t){let n=!1;for(let r=-1,i=e.length,o=i-1;++r<i;o=r)(e[r][1]<=t[1]&&t[1]<e[o][1]||e[o][1]<=t[1]&&t[1]<e[r][1])&&t[0]<(e[o][0]-e[r][0])*(t[1]-e[r][1])/(e[o][1]-e[r][1])+e[r][0]&&(n=!n);return n}(e,t[0]);return!(n||!r)}function OL(e){var t;let n={};const r=e;"number"==typeof(null==r?void 0:r.x)&&"number"==typeof(null==r?void 0:r.y)&&(n.type="Point",n.coordinates=[r.x,r.y],"number"==typeof r.z&&n.coordinates.push(r.z));const i=e;(null==i?void 0:i.points)&&(n.type="MultiPoint",n.coordinates=i.points.slice(0));const o=e;(null==o?void 0:o.paths)&&(1===o.paths.length?(n.type="LineString",n.coordinates=o.paths[0].slice(0)):(n.type="MultiLineString",n.coordinates=o.paths.slice(0)));const s=e;(null==s?void 0:s.rings)&&(n=function(e){const t=[],n=[];let r,i,o;for(let r=0;r<e.length;r++){const i=SL(e[r].slice(0));if(!(i.length<4))if(bL(i)){const e=[i.slice().reverse()];t.push(e)}else n.push(i.slice().reverse())}const s=[];for(;n.length;){o=n.pop();let e=!1;for(r=t.length-1;r>=0;r--)if(i=t[r][0],EL(i,o)){t[r].push(o),e=!0;break}e||s.push(o)}for(;s.length;){o=s.pop();let e=!1;for(r=t.length-1;r>=0;r--)if(i=t[r][0],IL(i,o)){t[r].push(o),e=!0;break}e||t.push([o.reverse()])}return 1===t.length?{type:"Polygon",coordinates:t[0]}:{type:"MultiPolygon",coordinates:t}}(s.rings.slice(0)));const a=e;return"number"==typeof(null==a?void 0:a.xmin)&&"number"==typeof(null==a?void 0:a.ymin)&&"number"==typeof(null==a?void 0:a.xmax)&&"number"==typeof(null==a?void 0:a.ymax)&&(n.type="Polygon",n.coordinates=[[[a.xmax,a.ymax],[a.xmin,a.ymax],[a.xmin,a.ymin],[a.xmax,a.ymin],[a.xmax,a.ymax]]]),(null===(t=null==e?void 0:e.spatialReference)||void 0===t?void 0:t.wkid)&&4326!==e.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(e.spatialReference)),n}function CL(e,t,n,r){const i={},o=e.getGeometry(),s=e.getData();if((o||s)&&(i.type="Feature",i.geometry=o?OL(o):null,s&&(null==r?void 0:r.length)>0&&"*"!==r[0]?(i.properties={},Object.keys(s).forEach(t=>{var o;r.includes(t)&&(i.properties[t]=null!==(o=e.getFormattedFieldValue(t,n))&&void 0!==o?o:"")})):i.properties=s?function(e,t,n){var r;const i={};for(const o in t)t.hasOwnProperty(o)&&(i[o]=null!==(r=e.getFormattedFieldValue(o,n))&&void 0!==r?r:"");return i}(e,s,n):null,s))try{i.id=function(e,t){const n=t?[t,"OBJECTID","FID"]:["OBJECTID","FID"];for(let t=0;t<n.length;t++){const r=n[t];if(r in e&&("string"==typeof e[r]||"number"==typeof e[r]))return e[r]}throw Error("No valid id attribute found")}(s,t)}catch(e){}return JSON.stringify(i.geometry)===JSON.stringify({})&&(i.geometry=null),i}function TL(e,t,n){const r={},i=Tb();r.type="FeatureCollection",r.features=[];for(let o=0;o<e.length;o++)r.features.push(CL(e[o],t,i,n));return r}function xL(e){return yL(this,void 0,void 0,function*(){if(!e||0===e.length)return e;try{const t=yield Bg("esri/geometry/SpatialReference");return yield HC(e,t.WGS84)}catch(e){console.error(e)}return e})}var AL=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class DL extends uL{isSupported(e,t){const n=Object.create(null,{isSupported:{get:()=>super.isSupported}});return AL(this,void 0,void 0,function*(){const r=e[0],{dataSource:i}=r;return!(!(yield n.isSupported.call(this,e,t))||null==i.getGeometryType())&&e.every(e=>{var t,n;const{dataSource:r}=e,i=null===(n=(t=r).getExportOptions)||void 0===n?void 0:n.call(t);return!i||(null==i.formats||i.formats.includes(Qh.GeoJSON))})})}onExecute(e,t){return AL(this,void 0,void 0,function*(){if(e.length>1)return this.batchExport(e);const n=e[0],{dataSource:r}=n,i=yield this.confirm(r,t);if(i.needed){const{ConfirmDialog:e}=yield NI("jimu-ui");return(0,sg.jsx)(e,{level:"info",title:i.content.title,hasNotShowAgainOption:!1,content:i.content.content,confirmLabel:i.content.okLabel,cancelLabel:i.content.cancelLabel,onConfirm:()=>{this.doExport(n,t)}})}return this.doExport(n,t)})}exportRecords(e,t,n){return AL(this,void 0,void 0,function*(){var r;const i=TL(yield xL(t),null===(r=e.getSchema())||void 0===r?void 0:r.idField,n),o=new Blob([JSON.stringify(i)],{type:"text/plain;charset=utf-8"});this.saveAsLocalFile(o,`${this.getExportFileName(e)}.geojson`)})}batchExport(e){return AL(this,void 0,void 0,function*(){var t;const{JSZip:n}=yield NI("jimu-core/jszip"),r=new n;for(const n of e){const{dataSource:e,fields:i}=n;if(yield this.dataSourceAllowExport(n,rL.Records)){const o=TL(yield xL(this.getLocalRecrods(n)),null===(t=e.getSchema())||void 0===t?void 0:t.idField,i),s=new Blob([JSON.stringify(o)],{type:"text/plain;charset=utf-8"});r.file(`${this.getExportFileName(e)}.geojson`,s)}}return r.generateAsync({type:"blob"}).then(e=>{this.saveAsLocalFile(e,"geojson_datasets.zip")}),!0})}doExport(e,t){return AL(this,void 0,void 0,function*(){const{dataSource:n,fields:r}=e,{enqueueNotification:i,closeNotification:o,ExportLoadingIndicator:s}=yield NI("jimu-ui");if(t===rL.Records)return this.exportRecords(n,this.getLocalRecrods(e),r),!0;const a=Tb(),l=i({message:a.formatMessage({id:"export"}),severity:"info",description:(0,sg.jsx)(s,{message:a.formatMessage({id:"exportingData"},{name:this.getExportFileName(n)})}),autoHideDuration:0});try{const e=yield this.tryCreateReplica(n,"geojson",r);return window.open(e,"_blank"),o(l),!0}catch(e){}const u=yield this.getRecords(n,r);return this.exportRecords(n,u),o(l),!0})}}function RL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PL(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function jL(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,_L(e,t,"get"))}function LL(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,_L(e,t,"set"),n),n}function _L(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var ML="undefined"!=typeof Symbol?Symbol.toStringTag:"@@toStringTag",NL=new WeakMap,kL=new WeakMap;class UL{constructor(e){var{executor:t=()=>{},internals:n=zL(),promise:r=new Promise((e,r)=>t(e,r,e=>{n.onCancelList.push(e)}))}=e;PL(this,NL,{writable:!0,value:void 0}),PL(this,kL,{writable:!0,value:void 0}),RL(this,ML,"CancelablePromise"),this.cancel=this.cancel.bind(this),LL(this,NL,n),LL(this,kL,r||new Promise((e,r)=>t(e,r,e=>{n.onCancelList.push(e)})))}then(e,t){return WL(jL(this,kL).then(GL(e,jL(this,NL)),GL(t,jL(this,NL))),jL(this,NL))}catch(e){return WL(jL(this,kL).catch(GL(e,jL(this,NL))),jL(this,NL))}finally(e,t){return t&&jL(this,NL).onCancelList.push(e),WL(jL(this,kL).finally(GL(()=>{if(e)return t&&(jL(this,NL).onCancelList=jL(this,NL).onCancelList.filter(t=>t!==e)),e()},jL(this,NL))),jL(this,NL))}cancel(){jL(this,NL).isCanceled=!0;var e=jL(this,NL).onCancelList;for(var t of(jL(this,NL).onCancelList=[],e))if("function"==typeof t)try{t()}catch(e){console.error(e)}}isCanceled(){return!0===jL(this,NL).isCanceled}}class FL extends UL{constructor(e){super({executor:e})}}RL(FL,"all",function(e){return HL(e,Promise.all(e))}),RL(FL,"allSettled",function(e){return HL(e,Promise.allSettled(e))}),RL(FL,"any",function(e){return HL(e,Promise.any(e))}),RL(FL,"race",function(e){return HL(e,Promise.race(e))}),RL(FL,"resolve",function(e){return $L(Promise.resolve(e))}),RL(FL,"reject",function(e){return $L(Promise.reject(e))}),RL(FL,"isCancelable",VL);const BL=FL;function $L(e){return WL(e,zL())}function VL(e){return e instanceof FL||e instanceof UL}function GL(e,t){if(e)return n=>{if(!t.isCanceled){var r=e(n);return VL(r)&&t.onCancelList.push(r.cancel),r}return n}}function WL(e,t){return new UL({internals:t,promise:e})}function HL(e,t){var n=zL();return n.onCancelList.push(()=>{for(var t of e)VL(t)&&t.cancel()}),new UL({internals:n,promise:t})}function zL(){return{isCanceled:!1,onCancelList:[]}}const qL=function(e,t,n){if(!Ml(n))return!1;var r=typeof t;return!!("number"==r?Jc(n)&&Dc(t,n.length):"string"==r&&t in n)&&uu(n[t],e)};const JL=function(e){return QE(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&qL(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t})};var KL=Object.prototype.hasOwnProperty;const YL=JL(function(e,t){if(Gc(t)||Jc(t))im(t,Kc(t),e);else for(var n in t)KL.call(t,n)&&rm(e,n,t[n])});var XL=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const{useRef:QL,useEffect:ZL,useMemo:e_,useCallback:t_,useState:n_}=F,r_=(e,t,n)=>{const r=Ij(),i=F.useMemo(()=>{const r=null==e&&null==t&&null==n?[Xg]:[e,t,n].filter(e=>null!=e);return YL({},...r)},[e,t,n]);return t_((e,t)=>r.formatMessage({id:e,defaultMessage:i[e]},t),[r,i])},i_=e=>{const t=QL(e);return t.current=e,t},o_=(e,t,n)=>e_(()=>null==e&&null==t?null:r=>{Bw(e,r),Bw(t,r),Bw(n,r)},[e,t,n]),s_=e=>{const t=QL(null),n=o_(t,e);return[t,t_(e=>{Bw(n,e)},[n])]},a_=()=>{const e=QL(!0);return e.current?(e.current=!1,!0):e.current},l_=(e,t)=>{const n=a_();ZL(()=>{if(!n)return e()},t)},u_=e=>{ZL(e,[])},c_=e=>{const t=QL(e);t.current=e,u_(()=>()=>t.current())},d_=e=>{const t=F.useRef(e);return ZL(()=>{t.current=e}),F.useCallback((...e)=>{var n;return null===(n=t.current)||void 0===n?void 0:n(...e)},[])},p_=({controlled:e,default:t})=>{const{current:n}=QL(void 0!==e),[r,i]=n_(t);return[n?e:r,F.useCallback(e=>{n||i(e)},[]),n]},f_=e=>Je(t=>Fw(e,t)),h_=e=>Je(t=>{var n,r;return(null===(r=null===(n=t.widgetsRuntimeInfo)||void 0===n?void 0:n[e])||void 0===r?void 0:r.state)===Ua.Active}),g_=()=>Je(e=>e.browserSizeMode)===La.Small,m_=()=>{const e=QL([]);ZL(()=>function(){e.current.forEach(e=>{e.cancel()}),e.current=[]},[]);return t_(t=>{const n=$L(t);return e.current.push(n),n},[])},v_=e=>{const t=QL(void 0);return ZL(()=>{t.current=e}),t.current},y_=(e,t)=>{const n=i_(e),r=i_(t),i=F.useRef(t);F.useEffect(()=>{const e=i.current;n.current(e),i.current=r.current},t)},S_={leading:!0,trailing:!1},b_=(e,t=200,n=S_)=>{const r=i_(t),i=i_(n),o=d_(e),s=F.useMemo(()=>BE(o,r.current,i.current),[o,r,i]);return F.useEffect(()=>()=>{s.cancel()},[s]),s},w_={},I_=e=>{const[t,n]=F.useState(!1),r=F.useRef(null);return F.useEffect(()=>{w_[e]?(r.current=w_[e],n(!0)):NI(e).then(t=>{w_[e]=t,r.current=t,n(!0)}).catch(e=>{console.error(e)})},[]),[t,r.current]},E_=(e,t)=>{const[n,r]=I_(e),i=null==r?void 0:r[t];return r&&!i&&console.error(`The component ${t} is not found in the module ${e}`),[n,i]},O_=e=>{const[t,n]=F.useState(!1),r=F.useRef(null);return F.useEffect(()=>{Bg(e).then(e=>{e&&(r.current=e,n(!0))}).catch(e=>{console.error("loadArcGISJSAPIModule error",e)})},[e]),[t,r.current]},C_=()=>{const[e]=O_("esri/kernel");return e},T_=()=>{const[e,t]=F.useState(!1);return F.useEffect(()=>{!function(){XL(this,void 0,void 0,function*(){try{yield Bg("esri/kernel"),yield function(){return XL(this,void 0,void 0,function*(){var e;try{if(!(null===(e=window.jimuConfig)||void 0===e?void 0:e.isBuilder))return;if(x_)return;x_=!0;const[t,n,r,i,o,s,a,l]=yield Fg(["esri/geometry/Geometry","esri/geometry/Extent","esri/geometry/Mesh","esri/geometry/Multipoint","esri/geometry/Point","esri/geometry/Polygon","esri/geometry/Polyline","esri/geometry/Circle"]),u="esri.geometry.Extent",c="esri.geometry.Mesh",d="esri.geometry.Multipoint",p="esri.geometry.Point",f="esri.geometry.Polygon",h="esri.geometry.Polyline",g="esri.geometry.Circle";function m(e,t){Object.defineProperty(e,Symbol.hasInstance,{value(e){try{const n=null==e?void 0:e.declaredClass;return!(!n||!t.includes(n))||Function.prototype[Symbol.hasInstance].call(this,e)}catch(e){return!1}}})}m(t,["esri.geometry.Geometry",u,c,d,p,f,h,g]),m(n,[u]),m(r,[c]),m(i,[d]),m(o,[p]),m(s,[f,g]),m(a,[h]),m(l,[g])}catch(v){console.warn("overrideGeometryInstanceof error",v)}})}(),yield NI("arcgis-coding-components"),t(!0)}catch(e){console.error("load ArcgisArcadeEditor error",e)}})}()},[]),e};let x_=!1;var A_=a(7896),D_=a.n(A_);const{useEffect:R_}=F,P_="jimu-keyboard-nav",j_="jimu-interactive-node",L_="jimu-widget-a11y-";function __(e){if(M_(document.body,e),window.jimuConfig.isBuilder){const t=document.querySelector(`iframe[name="${qa}"]`);M_((null==t?void 0:t.contentDocument.body)||(null==t?void 0:t.contentWindow.document.body),e)}else if(window.jimuConfig.isInBuilder){M_(window.parent.document.body,e)}}function M_(e,t){e&&(t?e.classList.add(P_):e.classList.remove(P_))}function N_(){return document.body.classList.contains(P_)}function k_(e,t=!1){e&&(t||N_())&&("focus"in e&&"function"==typeof e.focus?e.focus():console.warn("The element does not have a focus method."))}function U_(e){return R_(()=>{function e(e){e.target!==document.activeElement&&N_()&&__(!1)}function t(t){t.target.nodeName&&"html"===t.target.nodeName.toLowerCase()||(e(t),n())}function n(){document.removeEventListener("mousedown",t),document.removeEventListener("mouseup",t),document.removeEventListener("pointerdown",t),document.removeEventListener("pointerup",t),document.removeEventListener("touchmove",t),document.removeEventListener("touchstart",t),document.removeEventListener("touchend",t)}function r(e){"Tab"===e.key&&(N_()||__(!0))}return document.addEventListener("keydown",r,!0),document.addEventListener("mousedown",e,!0),document.addEventListener("pointerdown",e,!0),document.addEventListener("touchstart",e,!0),document.addEventListener("mousedown",t),document.addEventListener("mouseup",t),document.addEventListener("pointerdown",t),document.addEventListener("pointerup",t),document.addEventListener("touchmove",t),document.addEventListener("touchstart",t),document.addEventListener("touchend",t),()=>{document.removeEventListener("keydown",r,!0),document.removeEventListener("mousedown",e,!0),document.removeEventListener("pointerdown",e,!0),document.removeEventListener("touchstart",e,!0),n()}},[]),(0,sg.jsx)(sg.Fragment,{children:e.children})}function F_(e,t,n,r){let i={};return n&&(i={role:"group","aria-label":n}),r&&(i={role:"group","aria-label":n||t,tabIndex:-1,id:L_+e}),i}function B_(e,t,n,r){const i=e.layouts,o=t,s=e.pages[n].layout[o]||e.pages[n].layout[La.Large],a=r(i[s],$v.Widget);if(a.push(...r(i[s],$v.Section)),a.push(...r(i[s],$v.ScreenGroup)),!window.jimuConfig.isBuilder&&!window.jimuConfig.isInBuilder){const t=[];e.header&&e.pages[n].header&&t.push(e.header.layout[o]||e.header.layout[La.Large]);const r=a.filter(t=>{var n,r,i,o,s,a;return(null===(r=null===(n=e.widgets)||void 0===n?void 0:n[t])||void 0===r?void 0:r.addToA11ySkip)||(null===(o=null===(i=e.sections)||void 0===i?void 0:i[t])||void 0===o?void 0:o.addToA11ySkip)||(null===(a=null===(s=e.screenGroups)||void 0===s?void 0:s[t])||void 0===a?void 0:a.addToA11ySkip)});return t.push(...r),e.footer&&e.pages[n].footer&&t.push(e.footer.layout[o]||e.footer.layout[La.Large]),t}return a}const $_={boundary:document.body,fallbackPlacements:["right","left","top"]};class V_ extends iL{constructor(e){super(e),this.icon=D_();xE(this.onDsInfoChange.bind(this),["dataSourcesInfo"])}isSupported(e,t,n){const r=e[0].dataSource;if(e.length>1||!Object.keys(r.getSchema()||{}).length)return Promise.resolve(!1);const i=t===rL.DataSource&&[Qa.FeatureLayer,Qa.SceneLayer,Qa.BuildingComponentSubLayer,Qa.OrientedImageryLayer,Qa.ImageryLayer,Qa.SubtypeGroupLayer,Qa.SubtypeSublayer].includes(r.type)&&r.getStatus()!==Ya.NotReady;return Promise.resolve(i)}onExecute(e,t,n){const r=e[0];this._version||(this._version=0);const i={name:this.name,version:this._version++,activeRef:document.querySelector(".active-data-action-item"),dataSet:r,widgetId:n};return Promise.resolve((0,sg.jsx)(H_,Object.assign({},i)))}onDsInfoChange(e,t){const n=Fy.getInstance(),r=n.getStateValue(["dataActions",this.name])||{},i=Object.keys(r).filter(e=>r[e]).map(e=>r[e]&&e),o=Object.keys(t).map(e=>e);i.filter(e=>!o.includes(e)).forEach(e=>{n.updateStateValue("dataActions",`${this.name}.${e}`,null)})}}const G_={width:335,height:300},W_={width:350,height:444},H_=e=>{const{version:t,dataSet:n,name:r,widgetId:i,activeRef:o}=e,{dataSource:s}=n,[a,l]=I_("jimu-ui"),[u,c]=I_("jimu-ui/advanced/sql-expression-builder"),{FloatingPanel:d,Switch:p,Label:f,Badge:h,Icon:g,Loading:m}=l||{},{SqlExpressionBuilder:v}=c||{},y=r+"-"+s.id,S=z_(),[b,w]=F.useState(W_),[I,E]=F.useState(!0),O=(e=s.id)=>{var t;return(null===(t=Fy.getInstance().getStateValue(["dataActions",r]))||void 0===t?void 0:t[e])||Ye({})},C=O(s.id),[T,x]=F.useState(C.applied||!1),A=v_(T),[D,R]=F.useState(C.expression||null);F.useEffect(()=>{const e=O(s.id);R((null==e?void 0:e.expression)||null),x((null==e?void 0:e.applied)||!1),E(!0)},[t,s.id]),F.useEffect(()=>{var e,t;const n=!A!=!T;if(T){const e=NO(D,s);P(e,n)}else{const r=null===(t=null===(e=s.getInfo().widgetQueries)||void 0===e?void 0:e[y])||void 0===t?void 0:t.where;r&&""!==r&&P({sql:"",sqlExpression:null},n)}L()},[T]);const P=(e,t=!1)=>{const n={where:e.sql||"1=1",sqlExpression:e.sql?e.sqlExpression:null};null==s||s.updateQueryParams(n,y),t&&db.getInstance().publishMessage(new Qy(i,[s.id]))},j=()=>{E(!1),L(),setTimeout(()=>{k_(o)},10)},L=()=>{if(!a)return;const e=O(),t=T&&D,n=(0,sg.jsx)(h,{color:"primary",dot:!0,className:"mr-2",hideBadge:!t,children:(0,sg.jsx)(g,{icon:D_()})}),i=e.set("applied",T).set("expression",D).set("icon",n);Fy.getInstance().updateStateValue("dataActions",`${r}.${s.id}`,i)},_=s.getLabel();return(0,sg.jsx)(F.Fragment,{children:a&&(0,sg.jsx)(d,{version:t,open:I,headerTitle:S("dataAction_SetFilter"),onHeaderClose:j,minSize:G_,onResize:e=>{w(e)},dragBounds:"body",defaultSize:b,reference:o,flipOptions:$_,toggle:(e,t)=>{"clickOutside"!==t&&j()},children:(0,sg.jsx)("div",{className:"set-filter-container h-100 p-4",children:u?(0,sg.jsxs)(F.Fragment,{children:[(0,sg.jsxs)(f,{className:"d-flex justify-content-between",children:[(0,sg.jsx)("span",{title:_,css:sg.css`
                    overflow: hidden;
                    text-overflow: ellipsis;
                    display: -webkit-box;
                    -webkit-box-orient: vertical;
                    word-break: break-word;
                    -webkit-line-clamp: 1;
                    font-size: ${nn(14)};
                  `,children:_}),(0,sg.jsx)(p,{checked:T,onChange:()=>{x(!T)}})]}),(0,sg.jsx)("div",{className:"mt-4",css:sg.css`
      height: calc(100% - 40px);
      .sql-expression-list{
        height: calc(100% - 48px) !important;
      }
    `,children:(0,sg.jsx)(v,{dataSource:s,mode:eO.Simple,widgetId:y,expression:D,noScrollForList:!0,queryScope:il.InRuntimeView,onChange:e=>{if(R(e),T){const t=NO(e,s);P(t,!0)}}})})]}):(0,sg.jsx)(m,{type:l.LoadingType.Secondary})})})})},z_=()=>{const e=Ij();return F.useCallback((t,n)=>e.formatMessage({id:t,defaultMessage:Xg[t]},n),[e])};var q_;!function(e){e.Config="CONFIG",e.Program="PROGRAM"}(q_||(q_={}));var J_,K_=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};!function(e){e.Common="COMMON",e.Widget="WIDGET",e.Template="TEMPLATE",e.App="APP",e.Builder="BUILDER"}(J_||(J_={}));const Y_={"insert-widget":"InsertWidgetGuide","ds-selection":"DataSourceSelectionGuide","guide-component":"GuideComponent","opening-tour":"OnboardingGuide","general-express-mode":"GeneralExpressModeGuide","express-welcome-introduction":"ExpressWelcomeIntroductionGuide","express-add-data":"ExpressAddDataGuide","express-app-setting":"ExpressAppSettingGuide","express-general-setting":"ExpressGeneralSettingGuide","express-map-widget":"ExpressMapWidgetGuide","express-message-action":"ExpressMessageActionGuide","express-placeholder":"ExpressPlaceHolderGuide","express-section":"ExpressSectionGuide","express-theme":"ExpressThemeGuide","express-title":"ExpressTitleGuide","express-widget-controller":"ExpressWidgetControllerGuide","express-window":"ExpressWindowGuide","express-sidebar":"ExpressSidebarGuide","express-grid":"ExpressGridGuide"};class X_{constructor(){this.guides={},this.guideTriggerRef=null}static getInstance(){return X_.instance||(X_.instance=new X_,window._guideManager=X_.instance),X_.instance}getAppConfig(){return TE().getState().appConfig}getModuleUri(e){let t,n=e.id;n.lastIndexOf("/")===n.length-1&&(n=n.substring(0,n.lastIndexOf("/")));const{type:r,level:i}=e;return r===q_.Program?i===J_.Builder||i===J_.Common?t="jimu-for-builder/guides":i===J_.Widget?t=`${n}/dist/guide/guide`:J_.App:r===q_.Config&&(t=`${n}/dist/guide/steps.json`),t}loadGuideModule(e){return K_(this,void 0,void 0,function*(){let{uri:t,type:n,level:r}=e;if(!t&&(t=this.getModuleUri(e),!t))throw new Error("Guide URI is missing");return yield NI(t).then(i=>K_(this,void 0,void 0,function*(){var o;let s,a={};if(r===J_.Widget&&(a=yield this.loadWidgetTranslationByUri(e.id)),n===q_.Program){if(s=Y_[e.id]?null==i?void 0:i[Y_[e.id]]:null==i?void 0:i.default,!s)throw new Error("Guide module could not be loaded");return{guide:s,messages:a}}if(n===q_.Config){const n=`${e.id}/dist/guide/translations`,r=yield this.loadGuideTranslation(n,["en"]),s=Sw(null==i?void 0:i.default,Tb(),r).steps;if(!s)throw new Error("Steps data is missing or invalid");t.startsWith("/")&&(t=t.substring(1));const l=t.replace("steps.json","assets");return this.replaceStepsAssetsPath(s,l),this.guides["guide-component"]||(yield this.registerGuide({id:"guide-component",type:q_.Program,level:J_.Common})),{steps:s,guide:null===(o=this.guides["guide-component"])||void 0===o?void 0:o.module,messages:a}}})).catch(e=>{throw console.error("Error loading guide module:",e),new Error(e)})})}replaceStepsAssetsPath(e,t){return e.map(e=>{var n,r;if("steps"in e){const n=e,r=n.steps,i=this.replaceStepsAssetsPath(r,t);return n.steps=i,n}return(null===(r=null===(n=e.content)||void 0===n?void 0:n.image)||void 0===r?void 0:r.src)&&(e.content.image.src=`${t}/${e.content.image.src}`),e})}loadGuideTranslation(e,t){return K_(this,void 0,void 0,function*(){let n=TE().getState().appContext.locale;return n=Sb(n,t),n?Eb(`${e}`,n).catch(e=>K_(this,void 0,void 0,function*(){return console.error("Load widget translation error",e),Promise.resolve({})})):Promise.resolve({})})}loadWidgetTranslationByUri(e){return K_(this,void 0,void 0,function*(){let t={};if(window.jimuConfig.isBuilder){const n=(yield NI("jimu-for-builder")).AppWidgetManager.getInstance(),r=yield n.loadWidgetManifest(e,!0);t=yield this.loadWidgetTranslation(e,r)}else{const n=yield vb.getInstance().loadWidgetManifest(e,!0);t=yield this.loadWidgetTranslation(e,n)}return Promise.resolve(t)})}loadWidgetTranslation(e,t,n){return K_(this,void 0,void 0,function*(){let r={};n||(n=TE().getState().appContext.locale);const i=Sb(n,t.translatedLocales);let o={};if(i)try{o=yield Eb(`${e}dist/runtime/translations`,i)}catch(e){return console.error("Load widget translation error",e),Promise.resolve({})}const s=TE().getState().appI18nMessages;return r=Object.assign({},o,s),Promise.resolve(r)})}registerGuide(e){return K_(this,void 0,void 0,function*(){if(!e)return null;if(this.guides[null==e?void 0:e.id])return this.guides[e.id];if(e.module)return this.guides[e.id]=e,this.guides[e.id];const t=yield this.loadGuideModule(e);return t?(this.guides[e.id]=Object.assign(Object.assign({},e),{module:t.guide,steps:t.steps,messages:t.messages}),this.guides[e.id]):null})}getGuideById(e){return this.guides[e]||null}destroyGuide(e){delete this.guides[e]}startGuide(e){return K_(this,arguments,void 0,function*(e,t=!1,n){this.guideTriggerRef=n||null;if(!this.getGuideById(e.id)){if(!(yield this.registerGuide(e)))return void console.error("Guide not found")}if(t){if(!(yield this.shouldShowGuide(e)))return}TE().dispatch(oR(e.id,t))})}shouldShowGuide(e){return K_(this,void 0,void 0,function*(){var t,n;if(e.level===J_.App){const t=Ow("guide");if(t){if(t.split(",").includes(e.id))return Promise.resolve(!1)}}else{const r=yield NI("jimu-for-builder/service");if(!(null===(t=null==r?void 0:r.userServices)||void 0===t?void 0:t.initUserResource))return Promise.resolve(!1);const i=yield r.userServices.initUserResource();if(!(null==i?void 0:i.success))return Promise.resolve(!1);const o=yield r.userServices.getUserResource();if(void 0!==(null===(n=null==o?void 0:o.showGuides)||void 0===n?void 0:n[e.id])&&!o.showGuides[e.id])return Promise.resolve(!1)}return Promise.resolve(!0)})}stopGuide(){TE().dispatch(oR(null,!1)),this.guideTriggerRef&&this.guideTriggerRef.current&&k_(this.guideTriggerRef.current),this.guideTriggerRef=null}showTemplateGuide(){return K_(this,void 0,void 0,function*(){var e;const t=null===(e=this.getAppConfig())||void 0===e?void 0:e.template;if(t){const e=yield this.loadTemplateGuide(t,"app");e&&this.startGuide(e,!0)}})}loadTemplateGuide(e,t){return K_(this,void 0,void 0,function*(){const n=FI("templates/"),r=yield fetch(`${n}templates-info.json`).then(e=>e.json());if(r[t]){const i=r[t].filter(t=>t.name===e);if(i.length>0){const e=i[0],t=`${n}${e.type}/${e.name}`;if(null==e?void 0:e.hasGuide){const n={id:t,type:e.guideType,level:J_.Template};return Promise.resolve(n)}}}return Promise.resolve(null)})}updateGuideViewedStatus(e){return K_(this,arguments,void 0,function*(e,t=!1){if(e.level===J_.App){const n=Ow("guide");if(n){const r=n.split(","),i=r.indexOf(e.id);t?-1===i&&r.push(e.id):-1!==i&&r.splice(i,1),Cw("guide",r.join(","))}else t&&Cw("guide",e.id)}else{(yield NI("jimu-for-builder/service")).userServices.updateUserResource({showGuides:{[e.id]:t}})}})}}var Q_=a(4848);const Z_=(0,F.createContext)({strict:!1}),eM={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tM={};for(const e in eM)tM[e]={isEnabled:t=>eM[e].some(e=>!!t[e])};function nM(e){for(const t in e)tM[t]={...tM[t],...e[t]}}function rM({children:e,features:t,strict:n=!1}){const[,r]=(0,F.useState)(!iM(t)),i=(0,F.useRef)(void 0);if(!iM(t)){const{renderer:e,...n}=t;i.current=e,nM(n)}return(0,F.useEffect)(()=>{iM(t)&&t().then(({renderer:e,...t})=>{nM(t),i.current=e,r(!0)})},[]),(0,Q_.jsx)(Z_.Provider,{value:{renderer:i.current,strict:n},children:e})}function iM(e){return"function"==typeof e}function oM(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function sM(e){const t=[{},{}];return e?.values.forEach((e,n)=>{t[0][n]=e.get(),t[1][n]=e.getVelocity()}),t}function aM(e,t,n,r){if("function"==typeof t){const[i,o]=sM(r);t=t(void 0!==n?n:e.custom,i,o)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){const[i,o]=sM(r);t=t(void 0!==n?n:e.custom,i,o)}return t}function lM(e,t,n){const r=e.getProps();return aM(r,t,void 0!==n?n:r.custom,e)}function uM(e,t){return e?.[t]??e?.default??e}const cM=e=>e,dM={},pM=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],fM={value:null,addProjectionMetrics:null};function hM(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,s=pM.reduce((e,n)=>(e[n]=function(e,t){let n=new Set,r=new Set,i=!1,o=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function u(t){s.has(t)&&(c.schedule(t),e()),l++,t(a)}const c={schedule:(e,t=!1,o=!1)=>{const a=o&&i?n:r;return t&&s.add(e),a.has(e)||a.add(e),e},cancel:e=>{r.delete(e),s.delete(e)},process:e=>{a=e,i?o=!0:(i=!0,[n,r]=[r,n],n.forEach(u),t&&fM.value&&fM.value.frameloop[t].push(l),l=0,n.clear(),i=!1,o&&(o=!1,c.process(e)))}};return c}(o,t?n:void 0),e),{}),{setup:a,read:l,resolveKeyframes:u,preUpdate:c,update:d,preRender:p,render:f,postRender:h}=s,g=()=>{const o=dM.useManualTiming?i.timestamp:performance.now();n=!1,dM.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(o-i.timestamp,40),1)),i.timestamp=o,i.isProcessing=!0,a.process(i),l.process(i),u.process(i),c.process(i),d.process(i),p.process(i),f.process(i),h.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(g))};return{schedule:pM.reduce((t,o)=>{const a=s[o];return t[o]=(t,o=!1,s=!1)=>(n||(n=!0,r=!0,i.isProcessing||e(g)),a.schedule(t,o,s)),t},{}),cancel:e=>{for(let t=0;t<pM.length;t++)s[pM[t]].cancel(e)},state:i,steps:s}}const{schedule:gM,cancel:mM,state:vM,steps:yM}=hM("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:cM,!0),SM=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bM=(()=>new Set(SM))(),wM=new Set(["width","height","top","left","right","bottom",...SM]);class IM{constructor(){this.subscriptions=[]}add(e){var t,n;return t=this.subscriptions,n=e,-1===t.indexOf(n)&&t.push(n),()=>function(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let i=0;i<r;i++){const r=this.subscriptions[i];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function EM(e,t){return t?e*(1e3/t):0}let OM;function CM(){OM=void 0}const TM={now:()=>(void 0===OM&&TM.set(vM.isProcessing||dM.useManualTiming?vM.timestamp:performance.now()),OM),set:e=>{OM=e,queueMicrotask(CM)}},xM={current:void 0};class AM{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=TM.now();if(this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const e of this.dependents)e.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=TM.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new IM);const n=this.events[e].add(t);return"change"===e?()=>{n(),gM.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return xM.current&&xM.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=TM.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return EM(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function DM(e,t){return new AM(e,t)}const RM=e=>Array.isArray(e);function PM(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,DM(n))}function jM(e){return RM(e)?e[e.length-1]||0:e}const LM=e=>Boolean(e&&e.getVelocity);function _M(e,t){const n=e.getValue("willChange");if(r=n,Boolean(LM(r)&&r.add))return n.add(t);if(!n&&dM.WillChange){const n=new dM.WillChange("auto");e.addValue("willChange",n),n.add(t)}var r}const MM=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),NM="data-"+MM("framerAppearId");function kM(e){return e.props[NM]}function UM(e){e.duration=0,e.type}const FM=(e,t)=>n=>t(e(n)),BM=(...e)=>e.reduce(FM),$M=(e,t,n)=>n>t?t:n<e?e:n,VM=e=>1e3*e,GM=e=>e/1e3,WM={layout:0,mainThread:0,waapi:0};const HM=e=>t=>"string"==typeof t&&t.startsWith(e),zM=HM("--"),qM=HM("var(--"),JM=e=>!!qM(e)&&KM.test(e.split("/*")[0].trim()),KM=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,YM={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},XM={...YM,transform:e=>$M(0,1,e)},QM={...YM,default:1},ZM=e=>Math.round(1e5*e)/1e5,eN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const tN=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,nN=(e,t)=>n=>Boolean("string"==typeof n&&tN.test(n)&&n.startsWith(e)||t&&!function(e){return null==e}(n)&&Object.prototype.hasOwnProperty.call(n,t)),rN=(e,t,n)=>r=>{if("string"!=typeof r)return r;const[i,o,s,a]=r.match(eN);return{[e]:parseFloat(i),[t]:parseFloat(o),[n]:parseFloat(s),alpha:void 0!==a?parseFloat(a):1}},iN={...YM,transform:e=>Math.round((e=>$M(0,255,e))(e))},oN={test:nN("rgb","red"),parse:rN("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+iN.transform(e)+", "+iN.transform(t)+", "+iN.transform(n)+", "+ZM(XM.transform(r))+")"};const sN={test:nN("#"),parse:function(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}},transform:oN.transform},aN=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),lN=aN("deg"),uN=aN("%"),cN=aN("px"),dN=aN("vh"),pN=aN("vw"),fN=(()=>({...uN,parse:e=>uN.parse(e)/100,transform:e=>uN.transform(100*e)}))(),hN={test:nN("hsl","hue"),parse:rN("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+uN.transform(ZM(t))+", "+uN.transform(ZM(n))+", "+ZM(XM.transform(r))+")"},gN={test:e=>oN.test(e)||sN.test(e)||hN.test(e),parse:e=>oN.test(e)?oN.parse(e):hN.test(e)?hN.parse(e):sN.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?oN.transform(e):hN.transform(e),getAnimatableNone:e=>{const t=gN.parse(e);return t.alpha=0,gN.transform(t)}},mN=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const vN="number",yN="color",SN=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function bN(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[];let o=0;const s=t.replace(SN,e=>(gN.test(e)?(r.color.push(o),i.push(yN),n.push(gN.parse(e))):e.startsWith("var(")?(r.var.push(o),i.push("var"),n.push(e)):(r.number.push(o),i.push(vN),n.push(parseFloat(e))),++o,"${}")).split("${}");return{values:n,split:s,indexes:r,types:i}}function wN(e){return bN(e).values}function IN(e){const{split:t,types:n}=bN(e),r=t.length;return e=>{let i="";for(let o=0;o<r;o++)if(i+=t[o],void 0!==e[o]){const t=n[o];i+=t===vN?ZM(e[o]):t===yN?gN.transform(e[o]):e[o]}return i}}const EN=e=>"number"==typeof e?0:gN.test(e)?gN.getAnimatableNone(e):e;const ON={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(eN)?.length||0)+(e.match(mN)?.length||0)>0},parse:wN,createTransformer:IN,getAnimatableNone:function(e){const t=wN(e);return IN(e)(t.map(EN))}};function CN(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function TN(e,t){return n=>n>0?t:e}const xN=(e,t,n)=>e+(t-e)*n,AN=(e,t,n)=>{const r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},DN=[sN,oN,hN];function RN(e){const t=(n=e,DN.find(e=>e.test(n)));var n;if(Boolean(t),!Boolean(t))return!1;let r=t.parse(e);return t===hN&&(r=function({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,n/=100;let i=0,o=0,s=0;if(t/=100){const r=n<.5?n*(1+t):n+t-n*t,a=2*n-r;i=CN(a,r,e+1/3),o=CN(a,r,e),s=CN(a,r,e-1/3)}else i=o=s=n;return{red:Math.round(255*i),green:Math.round(255*o),blue:Math.round(255*s),alpha:r}}(r)),r}const PN=(e,t)=>{const n=RN(e),r=RN(t);if(!n||!r)return TN(e,t);const i={...n};return e=>(i.red=AN(n.red,r.red,e),i.green=AN(n.green,r.green,e),i.blue=AN(n.blue,r.blue,e),i.alpha=xN(n.alpha,r.alpha,e),oN.transform(i))},jN=new Set(["none","hidden"]);function LN(e,t){return n=>xN(e,t,n)}function _N(e){return"number"==typeof e?LN:"string"==typeof e?JM(e)?TN:gN.test(e)?PN:kN:Array.isArray(e)?MN:"object"==typeof e?gN.test(e)?PN:NN:TN}function MN(e,t){const n=[...e],r=n.length,i=e.map((e,n)=>_N(e)(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=i[t](e);return n}}function NN(e,t){const n={...e,...t},r={};for(const i in n)void 0!==e[i]&&void 0!==t[i]&&(r[i]=_N(e[i])(e[i],t[i]));return e=>{for(const t in r)n[t]=r[t](e);return n}}const kN=(e,t)=>{const n=ON.createTransformer(t),r=bN(e),i=bN(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?jN.has(e)&&!i.values.length||jN.has(t)&&!r.values.length?function(e,t){return jN.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}(e,t):BM(MN(function(e,t){const n=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const o=t.types[i],s=e.indexes[o][r[o]],a=e.values[s]??0;n[i]=a,r[o]++}return n}(r,i),i.values),n):TN(e,t)};function UN(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return xN(e,t,n);return _N(e)(e,t)}const FN=e=>{const t=({timestamp:t})=>e(t);return{start:(e=!0)=>gM.update(t,e),stop:()=>mM(t),now:()=>vM.isProcessing?vM.timestamp:TM.now()}},BN=(e,t,n=10)=>{let r="";const i=Math.max(Math.round(t/n),2);for(let t=0;t<i;t++)r+=Math.round(1e4*e(t/(i-1)))/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},$N=2e4;function VN(e){let t=0;let n=e.next(t);for(;!n.done&&t<$N;)t+=50,n=e.next(t);return t>=$N?1/0:t}function GN(e,t,n){const r=Math.max(t-5,0);return EM(n-e(r),t-r)}const WN=100,HN=10,zN=1,qN=0,JN=800,KN=.3,YN=.3,XN={granular:.01,default:2},QN={granular:.005,default:.5},ZN=.01,ek=10,tk=.05,nk=1,rk=.001;function ik({duration:e=JN,bounce:t=KN,velocity:n=qN,mass:r=zN}){let i,o;VM(ek);let s=1-t;s=$M(tk,nk,s),e=$M(ZN,ek,GM(e)),s<1?(i=t=>{const r=t*s,i=r*e,o=r-n,a=sk(t,s),l=Math.exp(-i);return rk-o/a*l},o=t=>{const r=t*s*e,o=r*n+n,a=Math.pow(s,2)*Math.pow(t,2)*e,l=Math.exp(-r),u=sk(Math.pow(t,2),s);return(-i(t)+rk>0?-1:1)*((o-a)*l)/u}):(i=t=>Math.exp(-t*e)*((t-n)*e+1)-.001,o=t=>Math.exp(-t*e)*(e*e*(n-t)));const a=function(e,t,n){let r=n;for(let n=1;n<ok;n++)r-=e(r)/t(r);return r}(i,o,5/e);if(e=VM(e),isNaN(a))return{stiffness:WN,damping:HN,duration:e};{const t=Math.pow(a,2)*r;return{stiffness:t,damping:2*s*Math.sqrt(r*t),duration:e}}}const ok=12;function sk(e,t){return e*Math.sqrt(1-t*t)}const ak=["duration","bounce"],lk=["stiffness","damping","mass"];function uk(e,t){return t.some(t=>void 0!==e[t])}function ck(e=YN,t=KN){const n="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:i}=n;const o=n.keyframes[0],s=n.keyframes[n.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:u,mass:c,duration:d,velocity:p,isResolvedFromDuration:f}=function(e){let t={velocity:qN,stiffness:WN,damping:HN,mass:zN,isResolvedFromDuration:!1,...e};if(!uk(e,lk)&&uk(e,ak))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(1.2*n),i=r*r,o=2*$M(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:zN,stiffness:i,damping:o}}else{const n=ik(e);t={...t,...n,mass:zN},t.isResolvedFromDuration=!0}return t}({...n,velocity:-GM(n.velocity||0)}),h=p||0,g=u/(2*Math.sqrt(l*c)),m=s-o,v=GM(Math.sqrt(l/c)),y=Math.abs(m)<5;let S;if(r||(r=y?XN.granular:XN.default),i||(i=y?QN.granular:QN.default),g<1){const e=sk(v,g);S=t=>{const n=Math.exp(-g*v*t);return s-n*((h+g*v*m)/e*Math.sin(e*t)+m*Math.cos(e*t))}}else if(1===g)S=e=>s-Math.exp(-v*e)*(m+(h+v*m)*e);else{const e=v*Math.sqrt(g*g-1);S=t=>{const n=Math.exp(-g*v*t),r=Math.min(e*t,300);return s-n*((h+g*v*m)*Math.sinh(r)+e*m*Math.cosh(r))/e}}const b={calculatedDuration:f&&d||null,next:e=>{const t=S(e);if(f)a.done=e>=d;else{let n=0===e?h:0;g<1&&(n=0===e?VM(h):GN(S,e,t));const o=Math.abs(n)<=r,l=Math.abs(s-t)<=i;a.done=o&&l}return a.value=a.done?s:t,a},toString:()=>{const e=Math.min(VN(b),$N),t=BN(t=>b.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return b}function dk({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:l,restDelta:u=.5,restSpeed:c}){const d=e[0],p={done:!1,value:d},f=e=>void 0===a?l:void 0===l||Math.abs(a-e)<Math.abs(l-e)?a:l;let h=n*t;const g=d+h,m=void 0===s?g:s(g);m!==g&&(h=m-d);const v=e=>-h*Math.exp(-e/r),y=e=>m+v(e),S=e=>{const t=v(e),n=y(e);p.done=Math.abs(t)<=u,p.value=p.done?m:n};let b,w;const I=e=>{var t;(t=p.value,void 0!==a&&t<a||void 0!==l&&t>l)&&(b=e,w=ck({keyframes:[p.value,f(p.value)],velocity:GN(y,e,p.value),damping:i,stiffness:o,restDelta:u,restSpeed:c}))};return I(0),{calculatedDuration:null,next:e=>{let t=!1;return w||void 0!==b||(t=!0,S(e),I(e)),void 0!==b&&e>=b?w.next(e-b):(!t&&S(e),p)}}}ck.applyToOptions=e=>{const t=function(e,t=100,n){const r=n({...e,keyframes:[0,t]}),i=Math.min(VN(r),$N);return{type:"keyframes",ease:e=>r.next(i*e).value/t,duration:GM(i)}}(e,100,ck);return e.ease=t.ease,e.duration=VM(t.duration),e.type="keyframes",e};const pk=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function fk(e,t,n,r){if(e===t&&n===r)return cM;const i=t=>function(e,t,n,r,i){let o,s,a=0;do{s=t+(n-t)/2,o=pk(s,r,i)-e,o>0?n=s:t=s}while(Math.abs(o)>1e-7&&++a<12);return s}(t,0,1,e,n);return e=>0===e||1===e?e:pk(i(e),t,r)}const hk=fk(.42,0,1,1),gk=fk(0,0,.58,1),mk=fk(.42,0,.58,1),vk=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,yk=e=>t=>1-e(1-t),Sk=fk(.33,1.53,.69,.99),bk=yk(Sk),wk=vk(bk),Ik=e=>(e*=2)<1?.5*bk(e):.5*(2-Math.pow(2,-10*(e-1))),Ek=e=>1-Math.sin(Math.acos(e)),Ok=yk(Ek),Ck=vk(Ek),Tk=e=>Array.isArray(e)&&"number"==typeof e[0],xk={linear:cM,easeIn:hk,easeInOut:mk,easeOut:gk,circIn:Ek,circInOut:Ck,circOut:Ok,backIn:bk,backInOut:wk,backOut:Sk,anticipate:Ik},Ak=e=>{if(Tk(e)){e.length;const[t,n,r,i]=e;return fk(t,n,r,i)}return"string"==typeof e?xk[e]:e},Dk=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r};function Rk(e,t,{clamp:n=!0,ease:r,mixer:i}={}){const o=e.length;if(t.length,1===o)return()=>t[0];if(2===o&&t[0]===t[1])return()=>t[1];const s=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=function(e,t,n){const r=[],i=n||dM.mix||UN,o=e.length-1;for(let n=0;n<o;n++){let o=i(e[n],e[n+1]);if(t){const e=Array.isArray(t)?t[n]||cM:t;o=BM(e,o)}r.push(o)}return r}(t,r,i),l=a.length,u=n=>{if(s&&n<e[0])return t[0];let r=0;if(l>1)for(;r<e.length-2&&!(n<e[r+1]);r++);const i=Dk(e[r],e[r+1],n);return a[r](i)};return n?t=>u($M(e[0],e[o-1],t)):u}function Pk(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=Dk(0,t,r);e.push(xN(n,1,i))}}(t,e.length-1),t}function jk({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const i=(e=>Array.isArray(e)&&"number"!=typeof e[0])(r)?r.map(Ak):Ak(r),o={done:!1,value:t[0]},s=function(e,t){return e.map(e=>e*t)}(n&&n.length===t.length?n:Pk(t),e),a=Rk(s,t,{ease:Array.isArray(i)?i:(l=t,u=i,l.map(()=>u||mk).splice(0,l.length-1))});var l,u;return{calculatedDuration:e,next:t=>(o.value=a(t),o.done=t>=e,o)}}const Lk=e=>null!==e;function _k(e,{repeat:t,repeatType:n="loop"},r,i=1){const o=e.filter(Lk),s=i<0||t&&"loop"!==n&&t%2==1?0:o.length-1;return s&&void 0!==r?r:o[s]}const Mk={decay:dk,inertia:dk,tween:jk,keyframes:jk,spring:ck};function Nk(e){"string"==typeof e.type&&(e.type=Mk[e.type])}class kk{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const Uk=e=>e/100;class Fk extends kk{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:e}=this.options;e&&e.updatedAt!==TM.now()&&this.tick(TM.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},WM.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;Nk(e);const{type:t=jk,repeat:n=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=e;let{keyframes:s}=e;const a=t||jk;a!==jk&&"number"!=typeof s[0]&&(this.mixKeyframes=BM(Uk,UN(s[0],s[1])),s=[0,100]);const l=a({...e,keyframes:s});"mirror"===i&&(this.mirroredGenerator=a({...e,keyframes:[...s].reverse(),velocity:-o})),null===l.calculatedDuration&&(l.calculatedDuration=VN(l));const{calculatedDuration:u}=l;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=l}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:n,totalDuration:r,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:s,calculatedDuration:a}=this;if(null===this.startTime)return n.next(0);const{delay:l=0,keyframes:u,repeat:c,repeatType:d,repeatDelay:p,type:f,onUpdate:h,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const m=this.currentTime-l*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?m<0:m>r;this.currentTime=Math.max(m,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=r);let y=this.currentTime,S=n;if(c){const e=Math.min(this.currentTime,r)/s;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,c+1);Boolean(t%2)&&("reverse"===d?(n=1-n,p&&(n-=p/s)):"mirror"===d&&(S=o)),y=$M(0,1,n)*s}const b=v?{done:!1,value:u[0]}:S.next(y);i&&(b.value=i(b.value));let{done:w}=b;v||null===a||(w=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const I=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return I&&f!==dk&&(b.value=_k(u,this.options,g,this.speed)),h&&h(b.value),I&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return GM(this.calculatedDuration)}get time(){return GM(this.currentTime)}set time(e){e=VM(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(TM.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=GM(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=FN,startTime:t}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();const n=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=n):null!==this.holdTime?this.startTime=n-this.holdTime:this.startTime||(this.startTime=t??n),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(TM.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,WM.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}const Bk=e=>180*e/Math.PI,$k=e=>{const t=Bk(Math.atan2(e[1],e[0]));return Gk(t)},Vk={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:$k,rotateZ:$k,skewX:e=>Bk(Math.atan(e[1])),skewY:e=>Bk(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Gk=e=>((e%=360)<0&&(e+=360),e),Wk=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Hk=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),zk={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Wk,scaleY:Hk,scale:e=>(Wk(e)+Hk(e))/2,rotateX:e=>Gk(Bk(Math.atan2(e[6],e[5]))),rotateY:e=>Gk(Bk(Math.atan2(-e[2],e[0]))),rotateZ:$k,rotate:$k,skewX:e=>Bk(Math.atan(e[4])),skewY:e=>Bk(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function qk(e){return e.includes("scale")?1:0}function Jk(e,t){if(!e||"none"===e)return qk(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=zk,i=n;else{const t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=Vk,i=t}if(!i)return qk(t);const o=r[t],s=i[1].split(",").map(Kk);return"function"==typeof o?o(s):s[o]}function Kk(e){return parseFloat(e.trim())}const Yk=e=>e===YM||e===cN,Xk=new Set(["x","y","z"]),Qk=SM.filter(e=>!Xk.has(e));const Zk={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Jk(t,"x"),y:(e,{transform:t})=>Jk(t,"y")};Zk.translateX=Zk.x,Zk.translateY=Zk.y;const eU=new Set;let tU=!1,nU=!1,rU=!1;function iU(){if(nU){const e=Array.from(eU).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),n=new Map;t.forEach(e=>{const t=function(e){const t=[];return Qk.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}(e);t.length&&(n.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=n.get(e);t&&t.forEach(([t,n])=>{e.getValue(t)?.set(n)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}nU=!1,tU=!1,eU.forEach(e=>e.complete(rU)),eU.clear()}function oU(){eU.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(nU=!0)})}class sU{constructor(e,t,n,r,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(eU.add(this),tU||(tU=!0,gM.read(oU),gM.resolveKeyframes(iU))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:r}=this;if(null===e[0]){const i=r?.get(),o=e[e.length-1];if(void 0!==i)e[0]=i;else if(n&&t){const r=n.readValue(t,o);null!=r&&(e[0]=r)}void 0===e[0]&&(e[0]=o),r&&void 0===i&&r.set(e[0])}!function(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),eU.delete(this)}cancel(){"scheduled"===this.state&&(eU.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}function aU(e){let t;return()=>(void 0===t&&(t=e()),t)}const lU=aU(()=>void 0!==window.ScrollTimeline),uU={};function cU(e,t){const n=aU(e);return()=>uU[t]??n()}const dU=cU(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),pU=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,fU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:pU([0,.65,.55,1]),circOut:pU([.55,0,1,.45]),backIn:pU([.31,.01,.66,-.59]),backOut:pU([.33,1.53,.69,.99])};function hU(e,t){return e?"function"==typeof e?dU()?BN(e,t):"ease-out":Tk(e)?pU(e):Array.isArray(e)?e.map(e=>hU(e,t)||fU.easeOut):fU[e]:void 0}function gU(e,t,n,{delay:r=0,duration:i=300,repeat:o=0,repeatType:s="loop",ease:a="easeOut",times:l}={},u=void 0){const c={[t]:n};l&&(c.offset=l);const d=hU(a,i);Array.isArray(d)&&(c.easing=d),fM.value&&WM.waapi++;const p={delay:r,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:o+1,direction:"reverse"===s?"alternate":"normal"};u&&(p.pseudoElement=u);const f=e.animate(c,p);return fM.value&&f.finished.finally(()=>{WM.waapi--}),f}function mU(e){return"function"==typeof e&&"applyToOptions"in e}class vU extends kk{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:n,keyframes:r,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:s,onComplete:a}=e;this.isPseudoElement=Boolean(i),this.allowFlatten=o,this.options=e,e.type;const l=function({type:e,...t}){return mU(e)&&dU()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=gU(t,n,r,l,i),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const e=_k(r,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,n){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,n):e.style[t]=n}(t,n,e),this.animation.cancel()}a?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return GM(Number(e))}get time(){return GM(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=VM(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&lU()?(this.animation.timeline=e,cM):t(this)}}const yU={anticipate:Ik,backInOut:wk,circInOut:Ck};function SU(e){"string"==typeof e.ease&&e.ease in yU&&(e.ease=yU[e.ease])}class bU extends vU{constructor(e){SU(e),Nk(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:n,onComplete:r,element:i,...o}=this.options;if(!t)return;if(void 0!==e)return void t.set(e);const s=new Fk({...o,autoplay:!1}),a=VM(this.finishedTime??this.time);t.setWithVelocity(s.sample(a-10).value,s.sample(a).value,10),s.stop()}}const wU=(e,t)=>"zIndex"!==t&&(!("number"!=typeof e&&!Array.isArray(e))||!("string"!=typeof e||!ON.test(e)&&"0"!==e||e.startsWith("url(")));const IU=new Set(["opacity","clipPath","filter","transform"]),EU=aU(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class OU extends kk{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",keyframes:s,name:a,motionValue:l,element:u,...c}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=TM.now();const d={autoplay:e,delay:t,type:n,repeat:r,repeatDelay:i,repeatType:o,name:a,motionValue:l,element:u,...c},p=u?.KeyframeResolver||sU;this.keyframeResolver=new p(s,(e,t,n)=>this.onKeyframesResolved(e,t,d,!n),a,l,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,n,r){this.keyframeResolver=void 0;const{name:i,type:o,velocity:s,delay:a,isHandoff:l,onUpdate:u}=n;this.resolvedAt=TM.now(),function(e,t,n,r){const i=e[0];if(null===i)return!1;if("display"===t||"visibility"===t)return!0;const o=e[e.length-1],s=wU(i,t),a=wU(o,t);return!(!s||!a)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}(e)||("spring"===n||mU(n))&&r)}(e,i,o,s)||(!dM.instantAnimations&&a||u?.(_k(e,n,t)),e[0]=e[e.length-1],UM(n),n.repeat=0);const c={startTime:r?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...n,keyframes:e},d=!l&&function(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:i,damping:o,type:s}=e,a=t?.owner?.current;if(!(a instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return EU()&&n&&IU.has(n)&&("transform"!==n||!u)&&!l&&!r&&"mirror"!==i&&0!==o&&"inertia"!==s}(c)?new bU({...c,element:c.motionValue.owner.current}):new Fk(c);d.finished.then(()=>this.notifyFinished()).catch(cM),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),rU=!0,oU(),iU(),rU=!1),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const CU=e=>null!==e;const TU={type:"spring",stiffness:500,damping:25,restSpeed:10},xU={type:"keyframes",duration:.8},AU={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},DU=(e,{keyframes:t})=>t.length>2?xU:bM.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:TU:AU;const RU=(e,t,n,r={},i,o)=>s=>{const a=uM(r,e)||{},l=a.delay||r.delay||0;let{elapsed:u=0}=r;u-=VM(l);const c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-u,onUpdate:e=>{t.set(e),a.onUpdate&&a.onUpdate(e)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:o?void 0:i};(function({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:o,repeatType:s,repeatDelay:a,from:l,elapsed:u,...c}){return!!Object.keys(c).length})(a)||Object.assign(c,DU(e,c)),c.duration&&(c.duration=VM(c.duration)),c.repeatDelay&&(c.repeatDelay=VM(c.repeatDelay)),void 0!==c.from&&(c.keyframes[0]=c.from);let d=!1;if((!1===c.type||0===c.duration&&!c.repeatDelay)&&(UM(c),0===c.delay&&(d=!0)),(dM.instantAnimations||dM.skipAnimations)&&(d=!0,UM(c),c.delay=0),c.allowFlatten=!a.type&&!a.ease,d&&!o&&void 0!==t.get()){const e=function(e,{repeat:t,repeatType:n="loop"},r){const i=e.filter(CU),o=t&&"loop"!==n&&t%2==1?0:i.length-1;return o&&void 0!==r?r:i[o]}(c.keyframes,a);if(void 0!==e)return void gM.update(()=>{c.onUpdate(e),c.onComplete()})}return a.isSync?new Fk(c):new OU(c)};function PU({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&!0!==t[n];return t[n]=!1,r}function jU(e,t,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:s,...a}=t;r&&(o=r);const l=[],u=i&&e.animationState&&e.animationState.getState()[i];for(const t in a){const r=e.getValue(t,e.latestValues[t]??null),i=a[t];if(void 0===i||u&&PU(u,t))continue;const s={delay:n,...uM(o||{},t)},c=r.get();if(void 0!==c&&!r.isAnimating&&!Array.isArray(i)&&i===c&&!s.velocity)continue;let d=!1;if(window.MotionHandoffAnimation){const n=kM(e);if(n){const e=window.MotionHandoffAnimation(n,t,gM);null!==e&&(s.startTime=e,d=!0)}}_M(e,t),r.start(RU(t,r,i,e.shouldReduceMotion&&wM.has(t)?{type:!1}:s,e,d));const p=r.animation;p&&l.push(p)}return s&&Promise.all(l).then(()=>{gM.update(()=>{s&&function(e,t){const n=lM(e,t);let{transitionEnd:r={},transition:i={},...o}=n||{};o={...o,...r};for(const t in o)PM(e,t,jM(o[t]))}(e,s)})}),l}function LU(e,t,n,r=0,i=1){const o=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),s=e.size,a=(s-1)*r;return"function"==typeof n?n(o,s):1===i?o*r:a-o*r}function _U(e,t,n={}){const r=lM(e,t,"exit"===n.type?e.presenceContext?.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const o=r?()=>Promise.all(jU(e,r,n)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(r=0)=>{const{delayChildren:o=0,staggerChildren:s,staggerDirection:a}=i;return function(e,t,n=0,r=0,i=0,o=1,s){const a=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),a.push(_U(l,t,{...s,delay:n+("function"==typeof r?0:r)+LU(e.variantChildren,l,r,i,o)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(a)}(e,t,r,o,s,a,n)}:()=>Promise.resolve(),{when:a}=i;if(a){const[e,t]="beforeChildren"===a?[o,s]:[s,o];return e().then(()=>t())}return Promise.all([o(),s(n.delay)])}function MU(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function NU(e){return"string"==typeof e||Array.isArray(e)}const kU=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],UU=["initial",...kU],FU=UU.length;function BU(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&BU(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let n=0;n<FU;n++){const r=UU[n],i=e.props[r];(NU(i)||!1===i)&&(t[r]=i)}return t}const $U=[...kU].reverse(),VU=kU.length;function GU(e){return t=>Promise.all(t.map(({animation:t,options:n})=>function(e,t,n={}){let r;if(e.notify("AnimationStart",t),Array.isArray(t)){const i=t.map(t=>_U(e,t,n));r=Promise.all(i)}else if("string"==typeof t)r=_U(e,t,n);else{const i="function"==typeof t?lM(e,t,n.custom):t;r=Promise.all(jU(e,i,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}(e,t,n)))}function WU(e){let t=GU(e),n=qU(),r=!0;const i=t=>(n,r)=>{const i=lM(e,r,"exit"===t?e.presenceContext?.custom:void 0);if(i){const{transition:e,transitionEnd:t,...r}=i;n={...n,...r,...t}}return n};function o(o){const{props:s}=e,a=BU(e.parent)||{},l=[],u=new Set;let c={},d=1/0;for(let t=0;t<VU;t++){const p=$U[t],f=n[p],h=void 0!==s[p]?s[p]:a[p],g=NU(h),m=p===o?f.isActive:null;!1===m&&(d=t);let v=h===a[p]&&h!==s[p]&&g;if(v&&r&&e.manuallyAnimateOnMount&&(v=!1),f.protectedKeys={...c},!f.isActive&&null===m||!h&&!f.prevProp||oM(h)||"boolean"==typeof h)continue;const y=HU(f.prevProp,h);let S=y||p===o&&f.isActive&&!v&&g||t>d&&g,b=!1;const w=Array.isArray(h)?h:[h];let I=w.reduce(i(p),{});!1===m&&(I={});const{prevResolvedValues:E={}}=f,O={...E,...I},C=t=>{S=!0,u.has(t)&&(b=!0,u.delete(t)),f.needsAnimating[t]=!0;const n=e.getValue(t);n&&(n.liveStyle=!1)};for(const e in O){const t=I[e],n=E[e];if(c.hasOwnProperty(e))continue;let r=!1;r=RM(t)&&RM(n)?!MU(t,n):t!==n,r?null!=t?C(e):u.add(e):void 0!==t&&u.has(e)?C(e):f.protectedKeys[e]=!0}f.prevProp=h,f.prevResolvedValues=I,f.isActive&&(c={...c,...I}),r&&e.blockInitialAnimation&&(S=!1);const T=v&&y;S&&(!T||b)&&l.push(...w.map(t=>{const n={type:p};if("string"==typeof t&&r&&!T&&e.manuallyAnimateOnMount&&e.parent){const{parent:r}=e,i=lM(r,t);if(r.enteringChildren&&i){const{delayChildren:t}=i.transition||{};n.delay=LU(r.enteringChildren,e,t)}}return{animation:t,options:n}}))}if(u.size){const t={};if("boolean"!=typeof s.initial){const n=lM(e,Array.isArray(s.initial)?s.initial[0]:s.initial);n&&n.transition&&(t.transition=n.transition)}u.forEach(n=>{const r=e.getBaseTarget(n),i=e.getValue(n);i&&(i.liveStyle=!0),t[n]=r??null}),l.push({animation:t})}let p=Boolean(l.length);return!r||!1!==s.initial&&s.initial!==s.animate||e.manuallyAnimateOnMount||(p=!1),r=!1,p?t(l):Promise.resolve()}return{animateChanges:o,setActive:function(t,r){if(n[t].isActive===r)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(t,r)),n[t].isActive=r;const i=o(t);for(const e in n)n[e].protectedKeys={};return i},setAnimateFunction:function(n){t=n(e)},getState:()=>n,reset:()=>{n=qU(),r=!0}}}function HU(e,t){return"string"==typeof t?t!==e:!!Array.isArray(t)&&!MU(t,e)}function zU(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function qU(){return{animate:zU(!0),whileInView:zU(),whileHover:zU(),whileTap:zU(),whileDrag:zU(),whileFocus:zU(),exit:zU()}}class JU{constructor(e){this.isMounted=!1,this.node=e}update(){}}let KU=0;const YU={animation:{Feature:class extends JU{constructor(e){super(e),e.animationState||(e.animationState=WU(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();oM(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}},exit:{Feature:class extends JU{constructor(){super(...arguments),this.id=KU++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}},XU=!1,QU=!1;function ZU(){return XU||QU}function eF(e,t){const n=function(e,t,n){if(e instanceof EventTarget)return[e];if("string"==typeof e){let r=document;t&&(r=t.current);const i=n?.[e]??r.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}(e),r=new AbortController;return[n,{passive:!0,...t,signal:r.signal},()=>r.abort()]}function tF(e){return!("touch"===e.pointerType||ZU())}function nF(e){return{point:{x:e.pageX,y:e.pageY}}}function rF(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover","Start"===n);const i=r["onHover"+n];i&&gM.postRender(()=>i(t,nF(t)))}function iF(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const oF=(e,t)=>!!t&&(e===t||oF(e,t.parentElement)),sF=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const aF=new WeakSet;function lF(e){return t=>{"Enter"===t.key&&e(t)}}function uF(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function cF(e){return(e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary)(e)&&!ZU()}function dF(e,t,n={}){const[r,i,o]=eF(e,n),s=e=>{const r=e.currentTarget;if(!cF(e))return;aF.add(r);const o=t(r,e),s=(e,t)=>{window.removeEventListener("pointerup",a),window.removeEventListener("pointercancel",l),aF.has(r)&&aF.delete(r),cF(e)&&"function"==typeof o&&o(e,{success:t})},a=e=>{s(e,r===window||r===document||n.useGlobalTarget||oF(r,e.target))},l=e=>{s(e,!1)};window.addEventListener("pointerup",a,i),window.addEventListener("pointercancel",l,i)};return r.forEach(e=>{var t,r;(n.useGlobalTarget?window:e).addEventListener("pointerdown",s,i),"object"==typeof(r=t=e)&&null!==r&&"offsetHeight"in t&&(e.addEventListener("focus",e=>((e,t)=>{const n=e.currentTarget;if(!n)return;const r=lF(()=>{if(aF.has(n))return;uF(n,"down");const e=lF(()=>{uF(n,"up")});n.addEventListener("keyup",e,t),n.addEventListener("blur",()=>uF(n,"cancel"),t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)})(e,i)),function(e){return sF.has(e.tagName)||-1!==e.tabIndex}(e)||e.hasAttribute("tabindex")||(e.tabIndex=0))}),o}function pF(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap","Start"===n);const i=r["onTap"+("End"===n?"":n)];i&&gM.postRender(()=>i(t,nF(t)))}const fF=new WeakMap,hF=new WeakMap,gF=e=>{const t=fF.get(e.target);t&&t(e)},mF=e=>{e.forEach(gF)};function vF(e,t,n){const r=function({root:e,...t}){const n=e||document;hF.has(n)||hF.set(n,{});const r=hF.get(n),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(mF,{root:e,...t})),r[i]}(t);return fF.set(e,n),r.observe(e),()=>{fF.delete(e),r.unobserve(e)}}const yF={some:0,all:1};const SF={inView:{Feature:class extends JU{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:i}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:"number"==typeof r?r:yF[r]};return vF(this.node.current,o,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,i&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),o=t?n:r;o&&o(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends JU{mount(){const{current:e}=this.node;e&&(this.unmount=dF(e,(e,t)=>(pF(this.node,t,"Start"),(e,{success:t})=>pF(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends JU{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=BM(iF(this.node.current,"focus",()=>this.onFocus()),iF(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends JU{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t,n={}){const[r,i,o]=eF(e,n),s=e=>{if(!tF(e))return;const{target:n}=e,r=t(n,e);if("function"!=typeof r||!n)return;const o=e=>{tF(e)&&(r(e),n.removeEventListener("pointerleave",o))};n.addEventListener("pointerleave",o,i)};return r.forEach(e=>{e.addEventListener("pointerenter",s,i)}),o}(e,(e,t)=>(rF(this.node,t,"Start"),e=>rF(this.node,e,"End"))))}unmount(){}}}};function bF(e,t){return function({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const wF=e=>t=>t.test(e),IF=[YM,cN,uN,lN,pN,dN,{test:e=>"auto"===e,parse:e=>e}],EF=e=>IF.find(wF(e)),OF=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),CF=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function TF(e,t,n=1){const[r,i]=function(e){const t=CF.exec(e);if(!t)return[,];const[,n,r,i]=t;return[`--${n??r}`,i]}(e);if(!r)return;const o=window.getComputedStyle(t).getPropertyValue(r);if(o){const e=o.trim();return OF(e)?parseFloat(e):e}return JM(i)?TF(i,t,n+1):i}const xF=e=>/^0[^.\s]+$/u.test(e);function AF(e){return"number"==typeof e?0===e:null===e||("none"===e||"0"===e||xF(e))}const DF=new Set(["brightness","contrast","saturate","opacity"]);function RF(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(eN)||[];if(!r)return e;const i=n.replace(r,"");let o=DF.has(t)?1:0;return r!==n&&(o*=100),t+"("+o+i+")"}const PF=/\b([a-z-]*)\(.*?\)/gu,jF={...ON,getAnimatableNone:e=>{const t=e.match(PF);return t?t.map(RF).join(" "):e}},LF={...YM,transform:Math.round},_F={borderWidth:cN,borderTopWidth:cN,borderRightWidth:cN,borderBottomWidth:cN,borderLeftWidth:cN,borderRadius:cN,radius:cN,borderTopLeftRadius:cN,borderTopRightRadius:cN,borderBottomRightRadius:cN,borderBottomLeftRadius:cN,width:cN,maxWidth:cN,height:cN,maxHeight:cN,top:cN,right:cN,bottom:cN,left:cN,padding:cN,paddingTop:cN,paddingRight:cN,paddingBottom:cN,paddingLeft:cN,margin:cN,marginTop:cN,marginRight:cN,marginBottom:cN,marginLeft:cN,backgroundPositionX:cN,backgroundPositionY:cN,...{rotate:lN,rotateX:lN,rotateY:lN,rotateZ:lN,scale:QM,scaleX:QM,scaleY:QM,scaleZ:QM,skew:lN,skewX:lN,skewY:lN,distance:cN,translateX:cN,translateY:cN,translateZ:cN,x:cN,y:cN,z:cN,perspective:cN,transformPerspective:cN,opacity:XM,originX:fN,originY:fN,originZ:cN},zIndex:LF,fillOpacity:XM,strokeOpacity:XM,numOctaves:LF},MF={..._F,color:gN,backgroundColor:gN,outlineColor:gN,fill:gN,stroke:gN,borderColor:gN,borderTopColor:gN,borderRightColor:gN,borderBottomColor:gN,borderLeftColor:gN,filter:jF,WebkitFilter:jF},NF=e=>MF[e];function kF(e,t){let n=NF(e);return n!==jF&&(n=ON),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const UF=new Set(["auto","none","0"]);class FF extends sU{constructor(e,t,n,r,i){super(e,t,n,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let n=0;n<e.length;n++){let r=e[n];if("string"==typeof r&&(r=r.trim(),JM(r))){const i=TF(r,t.current);void 0!==i&&(e[n]=i),n===e.length-1&&(this.finalKeyframe=r)}}if(this.resolveNoneKeyframes(),!wM.has(n)||2!==e.length)return;const[r,i]=e,o=EF(r),s=EF(i);if(o!==s)if(Yk(o)&&Yk(s))for(let t=0;t<e.length;t++){const n=e[t];"string"==typeof n&&(e[t]=parseFloat(n))}else Zk[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let t=0;t<e.length;t++)(null===e[t]||AF(e[t]))&&n.push(t);n.length&&function(e,t,n){let r,i=0;for(;i<e.length&&!r;){const t=e[i];"string"==typeof t&&!UF.has(t)&&bN(t).values.length&&(r=e[i]),i++}if(r&&n)for(const i of t)e[i]=kF(n,r)}(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;"height"===n&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Zk[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];void 0!==r&&e.getValue(n,r).jump(r,!1)}measureEndState(){const{element:e,name:t,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);const i=n.length-1,o=n[i];n[i]=Zk[t](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==o&&void 0===this.finalKeyframe&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([t,n])=>{e.getValue(t).set(n)}),this.resolveNoneKeyframes()}}const BF=[...IF,gN,ON],{schedule:$F,cancel:VF}=hM(queueMicrotask,!1),GF=()=>({x:{min:0,max:0},y:{min:0,max:0}}),WF="undefined"!=typeof window,HF={current:null},zF={current:!1};const qF=new WeakMap;function JF(e){return oM(e.animate)||UU.some(t=>NU(e[t]))}function KF(e){return Boolean(JF(e)||e.variants)}const YF=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class XF{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=sU,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=TM.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,gM.render(this.render,!1,!0))};const{latestValues:a,renderState:l}=o;this.latestValues=a,this.baseTarget={...a},this.initialValues=t.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=s,this.blockInitialAnimation=Boolean(i),this.isControllingVariants=JF(t),this.isVariantNode=KF(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(e&&e.current);const{willChange:u,...c}=this.scrapeMotionValuesFromProps(t,{},this);for(const e in c){const t=c[e];void 0!==a[e]&&LM(t)&&t.set(a[e])}}mount(e){this.current=e,qF.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),zF.current||function(){if(zF.current=!0,WF)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>HF.current=e.matches;e.addEventListener("change",t),t()}else HF.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||HF.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),mM(this.notifyUpdate),mM(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=bM.has(e);n&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&gM.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),i&&i(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in tM){const t=tM[e];if(!t)continue;const{isEnabled:n,Feature:r}=t;if(!this.features[e]&&r&&n(this.props)&&(this.features[e]=new r(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<YF.length;t++){const n=YF[t];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const r=e["on"+n];r&&(this.propEventSubscriptions[n]=this.on(n,r))}this.prevMotionValues=function(e,t,n){for(const r in t){const i=t[r],o=n[r];if(LM(i))e.addValue(r,i);else if(LM(o))e.addValue(r,DM(i,{owner:e}));else if(o!==i)if(e.hasValue(r)){const t=e.getValue(r);!0===t.liveStyle?t.jump(i):t.hasAnimated||t.set(i)}else{const t=e.getStaticValue(r);e.addValue(r,DM(void 0!==t?t:i,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=DM(null===t?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){let n=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var r;return null!=n&&("string"==typeof n&&(OF(n)||xF(n))?n=parseFloat(n):(r=n,!BF.find(wF(r))&&ON.test(t)&&(n=kF(e,t))),this.setBaseTarget(e,LM(n)?n.get():n)),LM(n)?n.get():n}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let n;if("string"==typeof t||"object"==typeof t){const r=aM(this.props,t,this.presenceContext?.custom);r&&(n=r[e])}if(t&&void 0!==n)return n;const r=this.getBaseTargetFromProps(this.props,e);return void 0===r||LM(r)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new IM),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){$F.render(this.render)}}class QF extends XF{constructor(){super(...arguments),this.KeyframeResolver=FF}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;LM(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}const ZF=(e,t)=>t&&"number"==typeof e?t.transform(e):e,eB={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tB=SM.length;function nB(e,t,n){const{style:r,vars:i,transformOrigin:o}=e;let s=!1,a=!1;for(const e in t){const n=t[e];if(bM.has(e))s=!0;else if(zM(e))i[e]=n;else{const t=ZF(n,_F[e]);e.startsWith("origin")?(a=!0,o[e]=t):r[e]=t}}if(t.transform||(s||n?r.transform=function(e,t,n){let r="",i=!0;for(let o=0;o<tB;o++){const s=SM[o],a=e[s];if(void 0===a)continue;let l=!0;if(l="number"==typeof a?a===(s.startsWith("scale")?1:0):0===parseFloat(a),!l||n){const e=ZF(a,_F[s]);l||(i=!1,r+=`${eB[s]||s}(${e}) `),n&&(t[s]=e)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}(t,e.transform,n):r.transform&&(r.transform="none")),a){const{originX:e="50%",originY:t="50%",originZ:n=0}=o;r.transformOrigin=`${e} ${t} ${n}`}}function rB(e,{style:t,vars:n},r,i){const o=e.style;let s;for(s in t)o[s]=t[s];for(s in i?.applyProjectionStyles(o,r),n)o.setProperty(s,n[s])}const iB={};function oB(e,{layout:t,layoutId:n}){return bM.has(e)||e.startsWith("origin")||(t||void 0!==n)&&(!!iB[e]||"opacity"===e)}function sB(e,t,n){const{style:r}=e,i={};for(const o in r)(LM(r[o])||t.style&&LM(t.style[o])||oB(o,e)||void 0!==n?.getValue(o)?.liveStyle)&&(i[o]=r[o]);return i}class aB extends QF{constructor(){super(...arguments),this.type="html",this.renderInstance=rB}readValueFromInstance(e,t){if(bM.has(t))return this.projection?.isProjecting?qk(t):((e,t)=>{const{transform:n="none"}=getComputedStyle(e);return Jk(n,t)})(e,t);{const r=(n=e,window.getComputedStyle(n)),i=(zM(t)?r.getPropertyValue(t):r[t])||0;return"string"==typeof i?i.trim():i}var n}measureInstanceViewportBox(e,{transformPagePoint:t}){return bF(e,t)}build(e,t,n){nB(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return sB(e,t,n)}}const lB={offset:"stroke-dashoffset",array:"stroke-dasharray"},uB={offset:"strokeDashoffset",array:"strokeDasharray"};function cB(e,{attrX:t,attrY:n,attrScale:r,pathLength:i,pathSpacing:o=1,pathOffset:s=0,...a},l,u,c){if(nB(e,a,u),l)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:d,style:p}=e;d.transform&&(p.transform=d.transform,delete d.transform),(p.transform||d.transformOrigin)&&(p.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),p.transform&&(p.transformBox=c?.transformBox??"fill-box",delete d.transformBox),void 0!==t&&(d.x=t),void 0!==n&&(d.y=n),void 0!==r&&(d.scale=r),void 0!==i&&function(e,t,n=1,r=0,i=!0){e.pathLength=1;const o=i?lB:uB;e[o.offset]=cN.transform(-r);const s=cN.transform(t),a=cN.transform(n);e[o.array]=`${s} ${a}`}(d,i,o,s,!1)}const dB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),pB=e=>"string"==typeof e&&"svg"===e.toLowerCase();function fB(e,t,n){const r=sB(e,t,n);for(const n in e)if(LM(e[n])||LM(t[n])){r[-1!==SM.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n]=e[n]}return r}class hB extends QF{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=GF}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(bM.has(t)){const e=NF(t);return e&&e.default||0}return t=dB.has(t)?t:MM(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return fB(e,t,n)}build(e,t,n){cB(e,t,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,t,n,r){!function(e,t,n,r){rB(e,t,void 0,r);for(const n in t.attrs)e.setAttribute(dB.has(n)?n:MM(n),t.attrs[n])}(e,t,0,r)}mount(e){this.isSVGTag=pB(e.tagName),super.mount(e)}}const gB=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function mB(e){return"string"==typeof e&&!e.includes("-")&&!!(gB.indexOf(e)>-1||/[A-Z]/u.test(e))}const vB={renderer:(e,t)=>mB(e)?new hB(t):new aB(t,{allowProjection:e!==F.Fragment}),...YU,...SF},yB=e=>!(!e||e instanceof Document||!e.tagName)&&("BUTTON"===e.tagName||"INPUT"===e.tagName||"SELECT"===e.tagName||"TEXTAREA"===e.tagName||"DIV"===e.tagName&&"true"===e.contentEditable||"SPAN"===e.tagName&&"true"===e.contentEditable||["ANALYSIS-LAYER-INPUT-POPOVER","ARCGIS-ITEM-BROWSER-SEARCH","CALCITE-INPUT-TEXT","CALCITE-LIST","ARCGIS-BA-SEARCH","CALCITE-INPUT-NUMBER","CALCITE-AUTOCOMPLETE","ARCGIS-EDITOR-VARIABLES","ARCGIS-LANGUAGE-API-PANEL","ARCGIS-ARCADE-SUGGESTIONS","ARCGIS-ARCADE-CODING-ASSISTANT","ARCGIS-SEARCH"].includes(e.tagName)),SB=e=>yB(e.target||e.nativeEvent.target),bB=e=>{let t="";const n=[];if(navigator.userAgent.includes("Edge")&&e.key.includes("-manual"))t=e.key.replace("-manual","");else if("code"in e)t=dR[e.code]?dR[e.code]:e.code;else{const n=e.which;t=String.fromCharCode(n).toLowerCase(),dR[n]&&(t=dR[n])}return e.metaKey&&n.push("command"),e.ctrlKey&&n.push("Ctrl"),e.shiftKey&&n.push("Shift"),e.altKey&&n.push("Alt"),n.push(t),n.join("+")},wB=e=>{console.log(":keyboard event:",e)};const IB=function(e="keydown",t=null){if("undefined"==typeof window)return null;const n={};let r=null,i=null;null===t&&(t=window.document);const o=!yB(t);function s(e){if(cR(e))return;if(o&&SB(e))return;i&&i(e);const t=bB(e),s=n[t.toLowerCase()]||[];if("function"==typeof r){const n=s.length>0;r(t,n,e)}s.length&&e.preventDefault();let a=!0;for(let t=s.length-1;t>=0&&(s[t]&&(a=!!s[t](e)),a);t--);return!!a&&void 0}function a(){t.addEventListener(e,s)}return a(),{subscribe:function(e,t){return(e=e.toLowerCase()).replace(/\s/,""),void 0===n[e]&&(n[e]=[]),n[e].push(t),{unsubscribe:()=>{const r=n[e].indexOf(t);n[e].splice(r,1)}}},setMonitor:function(e=null){r=!0===e?wB:e},startListening:a,stopListening:function(){t.removeEventListener(e,s)},setKeyboardTriggerFunction:function(e){i=e}}};class EB extends F.PureComponent{constructor(e){super(e),this.subs=[],this.keyboardListener=IB(e.eventName,this.props.element),this.props.onKeyboardTrigger&&this.keyboardListener.setKeyboardTriggerFunction(this.props.onKeyboardTrigger)}componentDidMount(){const{bindings:e,monitor:t}=this.props;Object.keys(e).forEach(t=>{const n=e[t],r=this.keyboardListener.subscribe(t,n);this.subs.push(r)}),t&&this.keyboardListener.setMonitor(t)}componentWillUnmount(){this.subs.forEach(e=>{e.unsubscribe()})}render(){return null}}EB.defaultProps={eventName:"keydown",bindings:{},monitor:null};const OB=EB;class CB extends F.PureComponent{constructor(){super(...arguments),this.onKeyboardTrigger=e=>{e.key.includes("-manual")||BI().appBuilderSync.letBuilderResponseToKeyboard(e)},this.isMac=()=>{var e,t;return"macOS"===(null===(t=null===(e=window.jimuUA)||void 0===e?void 0:e.os)||void 0===t?void 0:t.name)}}render(){return this.isMac()?(0,sg.jsx)(OB,{onKeyboardTrigger:this.onKeyboardTrigger,bindings:{"command+keys":()=>!1}}):(0,sg.jsx)(OB,{onKeyboardTrigger:this.onKeyboardTrigger,bindings:{"ctrl+keys":()=>!1}})}}const TB=["widgetQueries","sourceVersion","gdbVersion","needRefresh","status"],xB=["dataSource","useDataSource","widgetId","localId","query","queryScope","queryAll","queryCount","queryAllSignal","queryAllProgress"];class AB extends F.PureComponent{componentDidMount(){var e,t,n,r;if(this.createDataSource(),this.props.dataSource&&this.props.onDataSourceCreated&&this.props.onDataSourceCreated(this.props.dataSource),(null===(e=this.props.dataSource)||void 0===e?void 0:e.isDataSourceSet())&&this.props.onAllChildDataSourcesCreated&&this.props.dataSource.childDataSourcesReady().then(()=>{this.props.onAllChildDataSourcesCreated(this.props.dataSource)}),this.props.dataSourceInfo&&this.props.onDataSourceInfoChange&&this.props.onDataSourceInfoChange(this.props.dataSourceInfo),this.props.dataSourceInfo&&this.props.onQueryRequired){const e=this.getChangedQueryRequiredInfos(this.props.dataSourceInfo,null,this.props.belongToDataSourceInfo,null,this.props.belongToBelongToDataSourceInfo,null);(e.queryRequiredInfo||e.prevQueryRequiredInfo)&&this.props.onQueryRequired(e.queryRequiredInfo)}(null===(n=null===(t=this.props.dataSourceInfo)||void 0===t?void 0:t.selectedIds)||void 0===n?void 0:n.length)>0&&this.props.onSelectionChange&&this.props.onSelectionChange(this.props.dataSourceInfo.selectedIds),(null===(r=this.props.dataSourceInfo)||void 0===r?void 0:r.status)&&this.props.onDataSourceStatusChange&&this.props.onDataSourceStatusChange(this.props.dataSourceInfo.status),this.doQuery()}componentDidUpdate(e){var t,n,r,i,o,s,a,l,u;this.createDataSource();const c=e.dataSourceInfo!==this.props.dataSourceInfo||e.belongToDataSourceInfo!==this.props.belongToDataSourceInfo||e.belongToBelongToDataSourceInfo!==this.props.belongToBelongToDataSourceInfo;if((!e.dataSource&&this.props.dataSource||e.dataSource&&this.props.dataSource&&e.dataSource.id!==this.props.dataSource.id)&&(this.props.onDataSourceCreated&&this.props.onDataSourceCreated(this.props.dataSource),this.props.onAllChildDataSourcesCreated&&this.props.dataSource.isDataSourceSet()&&this.props.dataSource.childDataSourcesReady().then(()=>{this.props.onAllChildDataSourcesCreated(this.props.dataSource)})),this.props.onDataSourceInfoChange&&e.dataSourceInfo!==this.props.dataSourceInfo&&this.props.onDataSourceInfoChange(this.props.dataSourceInfo,e.dataSourceInfo),this.props.onQueryRequired&&c){const t=this.getChangedQueryRequiredInfos(this.props.dataSourceInfo,e.dataSourceInfo,this.props.belongToDataSourceInfo,e.belongToDataSourceInfo,this.props.belongToBelongToDataSourceInfo,e.belongToBelongToDataSourceInfo);(t.queryRequiredInfo||t.prevQueryRequiredInfo)&&this.props.onQueryRequired(t.queryRequiredInfo,t.prevQueryRequiredInfo)}this.props.onDataSourceSchemaChange&&e.dataSourceSchema!==this.props.dataSourceSchema&&this.props.onDataSourceSchemaChange(this.props.dataSourceSchema,e.dataSourceSchema),this.props.onSelectionChange&&!this.areSelectedIdsSame(null===(t=e.dataSourceInfo)||void 0===t?void 0:t.selectedIds,null===(n=this.props.dataSourceInfo)||void 0===n?void 0:n.selectedIds)&&this.props.onSelectionChange(null===(r=this.props.dataSourceInfo)||void 0===r?void 0:r.selectedIds,null===(i=e.dataSourceInfo)||void 0===i?void 0:i.selectedIds),this.props.onDataSourceStatusChange&&(null===(o=e.dataSourceInfo)||void 0===o?void 0:o.status)!==(null===(s=this.props.dataSourceInfo)||void 0===s?void 0:s.status)&&this.props.onDataSourceStatusChange(null===(a=this.props.dataSourceInfo)||void 0===a?void 0:a.status,null===(l=e.dataSourceInfo)||void 0===l?void 0:l.status),e.forceRefreshVersion!==this.props.forceRefreshVersion&&"number"==typeof this.props.forceRefreshVersion&&(null===(u=this.props.dataSource)||void 0===u||u.addSourceVersion()),(this.areQueryRequiredPropsChanged(this.props,e)||c&&this.areQueryRequiredInfosChanged(this.props.dataSourceInfo,e.dataSourceInfo,this.props.belongToDataSourceInfo,e.belongToDataSourceInfo,this.props.belongToBelongToDataSourceInfo,e.belongToBelongToDataSourceInfo))&&this.doQuery(),this.handleAutoRefresh()}areSelectedIdsSame(e,t){const n=e=>!e||0===e.length;return n(e)&&n(t)||e===t}render(){const{useDataSource:e,dataSource:t,dataSourceInfo:n,children:r,query:i,errorString:o}=this.props;return e&&n?n.instanceStatus===Ya.CreateError?null!=o?o:null:t&&r?"function"==typeof r?r(t,n,i):r:null:null}doQuery(){if(!this.props.dataSource)return;const{dataSource:e,query:t,queryCount:n,queryAll:r,widgetId:i,localId:o,queryScope:s,queryAllSignal:a,queryAllProgress:l}=this.props,u=e;if(!u.load||!u.query)return;if(!t)return;const c={widgetId:i||o,scope:s};if(r?u.loadAll(t,a,l,c):u.load(t,c),n){const e=Object.assign({},t);u.loadCount(e,c)}}handleAutoRefresh(){if(!this.props.dataSource)return;const e=this.props.dataSource;e.stopAutoRefresh&&e.startAutoRefresh&&((window.jimuConfig.isBuilder||window.jimuConfig.isInBuilder)&&this.props.appMode===ka.Design?e.stopAutoRefresh():e.startAutoRefresh())}createDataSource(){var e;this.props.useDataSource&&(null===(e=this.props.dataSource)||void 0===e?void 0:e.id)!==this.props.useDataSource.dataSourceId&&this.props.dataSourceManager.createDataSourceByUseDataSource(this.props.useDataSource,this.props.localId).then(e=>null).catch(e=>{var t,n;if(!this.props.dataSource)if(e.dataSourceId===this.props.useDataSource.dataSourceId||e.dataSourceId===this.props.useDataSource.rootDataSourceId||e.dataSourceId===this.props.useDataSource.mainDataSourceId)this.props.onCreateDataSourceFailed&&this.props.onCreateDataSourceFailed(e);else{const r=null===(t=e.dataSourceId)||void 0===t?void 0:t.split("-"),i=null===(n=this.props.useDataSource.dataSourceId)||void 0===n?void 0:n.split("-");(null==r?void 0:r.every((e,t)=>(null==i?void 0:i[t])===e))&&this.props.onCreateDataSourceFailed&&this.props.onCreateDataSourceFailed(e)}})}getChangedQueryRequiredInfos(e,t,n,r,i,o){const s=this.getQueryRequiredInfoChangeKeysForBelongToDs(),a=this.getChangedInfo(e,t,TB),l=this.getChangedInfo(n,r,s),u=this.getChangedInfo(i,o,s),c={queryRequiredInfo:null,prevQueryRequiredInfo:null},d=this.getDsAndBelongToDsIds();return this.setChangedInfoToResult(d.dsId,a.info,!1,c),this.setChangedInfoToResult(d.belongToDsId,l.info,!1,c),this.setChangedInfoToResult(d.belongToBelongToDsId,u.info,!1,c),this.setChangedInfoToResult(d.dsId,a.prevInfo,!0,c),this.setChangedInfoToResult(d.belongToDsId,l.prevInfo,!0,c),this.setChangedInfoToResult(d.belongToBelongToDsId,u.prevInfo,!0,c),c}areQueryRequiredInfosChanged(e,t,n,r,i,o){const s=this.getQueryRequiredInfoChangeKeysForBelongToDs();return this.areInfosOrPropsChanged(e,t,TB)||this.areInfosOrPropsChanged(n,r,s)||this.areInfosOrPropsChanged(i,o,s)}areQueryRequiredPropsChanged(e,t){return this.areInfosOrPropsChanged(e,t,xB)}getQueryRequiredInfoChangeKeysForBelongToDs(){return TB.filter(e=>"needRefresh"!==e&&"status"!==e)}setChangedInfoToResult(e,t,n,r){if(e&&t){const i=n?"prevQueryRequiredInfo":"queryRequiredInfo";r[i]||(r[i]={}),r[i][e]=t}}getChangedInfo(e,t,n){const r={};return null==n||n.forEach(n=>{(null==e?void 0:e[n])!==(null==t?void 0:t[n])&&("status"!==n||(null==e?void 0:e[n])===Ya.Unloaded&&(null==t?void 0:t[n])===Ya.NotReady)&&(r.info=r.info?r.info.set(n,null==e?void 0:e[n]):Ye({[n]:null==e?void 0:e[n]}),r.prevInfo=r.prevInfo?r.prevInfo.set(n,null==t?void 0:t[n]):Ye({[n]:null==t?void 0:t[n]}))}),r}areInfosOrPropsChanged(e,t,n){return null==n?void 0:n.some(n=>"status"===n?(null==e?void 0:e[n])===Ya.Unloaded:(null==e?void 0:e[n])!==(null==t?void 0:t[n]))}getDsAndBelongToDsIds(){var e,t,n,r,i,o;return{dsId:null===(e=this.props.dataSource)||void 0===e?void 0:e.id,belongToDsId:null===(n=null===(t=this.props.dataSource)||void 0===t?void 0:t.belongToDataSource)||void 0===n?void 0:n.id,belongToBelongToDsId:null===(o=null===(i=null===(r=this.props.dataSource)||void 0===r?void 0:r.belongToDataSource)||void 0===i?void 0:i.belongToDataSource)||void 0===o?void 0:o.id}}}const DB=Ue((e,t)=>{var n,r,i;const o=mA.getInstance(),s=window.jimuConfig.isBuilder?e.appStateInBuilder:e;if(!s||!t.useDataSource&&!t.dataSource)return{dataSourceInfo:null,dataSourceJson:null,dataSourceSchema:null,rootDataSourceJson:null,dataSource:null,dataSourceManager:o,belongToDataSourceInfo:null,appMode:null};const a=t.dataSource?MT(t.dataSource):t.useDataSource,l=_T(a,t.localId),u=o.getDataSource(a.rootDataSourceId);let c=o.getDataSource(l);return a.rootDataSourceId&&!u&&(c=null),{dataSourceInfo:s.dataSourcesInfo[l],dataSourceJson:(null===(n=null==c?void 0:c.getMainDataSource())||void 0===n?void 0:n.getDataSourceJson())||s.appConfig.dataSources[a.mainDataSourceId],dataSourceSchema:(null==c?void 0:c.getSchema())||(null===(r=s.appConfig.dataSources[a.mainDataSourceId])||void 0===r?void 0:r.schema),rootDataSourceJson:(null==u?void 0:u.getDataSourceJson())||s.appConfig.dataSources[a.rootDataSourceId],dataSource:c,dataSourceManager:o,belongToDataSourceInfo:(null==c?void 0:c.isDataView)||(null==c?void 0:c.isLocal)?s.dataSourcesInfo[c.belongToDataSource.id]:null,belongToBelongToDataSourceInfo:(null==c?void 0:c.isLocal)&&(null===(i=c.belongToDataSource)||void 0===i?void 0:i.isDataView)?s.dataSourcesInfo[c.belongToDataSource.belongToDataSource.id]:null,appMode:s.appRuntimeInfo.appMode}})(AB),RB=DB;var PB=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function jB(e){var t,n;let r="";const i="system",o=function(){const e=TE().getState();return window.jimuConfig.isBuilder?null==e?void 0:e.appStateInBuilder:e}(),s=null===(n=null===(t=null==o?void 0:o.appConfig)||void 0===t?void 0:t.attributes)||void 0===n?void 0:n.timezone;if(s){if(s.type===eg.Device)r=i;else if(s.type===eg.Specific)r=s.value;else if(s.type===eg.Data){const t=[];e.forEach(e=>{if(e&&e.getTimezone){let n=e.getTimezone();n&&("device"===n&&(n=i),t.includes(n)||t.push(n))}}),r=1===t.length?t[0]:i}}else r=i;return r||(r=i),r}function LB(e,t){return PB(this,void 0,void 0,function*(){let n=null,r=null;yield kB(0);const i=null==t?void 0:t.dataSourceId,o=mA.getInstance().getDataSource(i),s=null==t?void 0:t.record,a=yield function(e,t,n){return PB(this,void 0,void 0,function*(){let r=null;if(n&&!n.fake){const e=null==n?void 0:n.feature;if("esri.Graphic"===(null==e?void 0:e.declaredClass))r=e;else{const e=yield gO([n]);(null==e?void 0:e.length)>0&&(r=e[0])}}else if(e){const e={},n=null==t?void 0:t.getSchema(),i=null==n?void 0:n.fields;i&&Object.keys(i).forEach(t=>{e[t]=null});r=new(yield Bg("esri/Graphic"))({geometry:null,attributes:e})}return r})}(e,o,s);n=yield function(e,t,n){return PB(this,void 0,void 0,function*(){const r={name:"$feature",type:"feature"},i={variables:[r]};if(e){let e=null==n?void 0:n.layer;if(e||t&&(t.layer?e=t.layer:t.createJSAPILayerByDataSource&&(e=yield t.createJSAPILayerByDataSource())),e){e.load&&!e.loaded&&(yield e.load());const t=r;t.description="The feature passed to the script during execution.",t.definition=e}else i.variables=[];i.bundles=["core"]}return i})}(e,o,a),r=function(e){return{$feature:e}}(a);const l=jB([o]);return{type:eP.FeatureProfile,profile:n,profileVariableInstances:r,timeZone:l}})}function _B(e){return{name:e,type:"dictionary",properties:[{name:"layer",type:"featureSet"},{name:"queryParams",type:"dictionary",properties:[{name:"where",type:"text"},{name:"outFields",type:"array",elementType:{type:"text"}},{name:"orderByFields",type:"array",elementType:{type:"text"}},{name:"objectIds",type:"array",elementType:{type:"text"}},{name:"geometry",type:"geometry"},{name:"spatialRelationship",type:"text"},{name:"distance",type:"number"},{name:"units",type:"text"},{name:"returnGeometry",type:"boolean"},{name:"geometryPrecision",type:"number"},{name:"outStatistics",type:"array",elementType:{type:"dictionary",properties:[{name:"statisticType",type:"text"},{name:"onStatisticField",type:"text"},{name:"outStatisticFieldName",type:"text"},{name:"statisticParameters",type:"dictionary",properties:[{name:"value",type:"number"},{name:"orderBy",type:"text"}]}]}},{name:"groupByFieldsForStatistics",type:"array",elementType:{type:"text"}},{name:"returnZ",type:"boolean"},{name:"returnM",type:"boolean"},{name:"gdbVersion",type:"text"},{name:"sqlFormat",type:"text"},{name:"returnDistinctValues",type:"boolean"},{name:"timeExtent",type:"dictionary",properties:[{name:"start",type:"date"},{name:"end",type:"date"}]}]},{name:"selectedFeatures",type:"featureSet"},{name:"loadedFeatures",type:"featureSet"},{name:"loadedFields",type:"array",elementType:{type:"text"}}]}}function MB(e){return PB(this,void 0,void 0,function*(){const t={layer:null,queryParams:{},selectedFeatures:null,loadedFeatures:null,loadedFields:[]};try{yield kB(0);const n=e.getAllUsedFields(),r="*"===n?["*"]:n,i=e.getSelectedRecords(),o=e.getAllLoadedRecords(),s=!1,a=e.createJSAPILayerByDataSource(e,s),l=NB(e,i),u=NB(e,o),c=function(e){return PB(this,void 0,void 0,function*(){let t=e.getCurrentQueryParams()||{};t=Object.assign({},t);const n=Ye(t);let r=null;const i=yield EO(e,n);if("esri.rest.support.Query"===i.declaredClass)r=i;else{r=new(yield Bg("esri/rest/support/Query"))(i)}const o=r.geometry||null,s=r.toJSON()||{};r.spatialRelationship&&(s.spatialRelationship=r.spatialRelationship),delete s.outSpatialReference,o&&(s.geometry=o),s.where=function(e){let t=e=e||"";t=t.trim();for(;t.startsWith("(")&&t.endsWith(")");)t=t.slice(1,-1).trim();return t&&"1=1"!==t?e:""}(s.where);const a=s.timeExtent;a&&("number"==typeof a.start&&(a.start=new Date(a.start)),"number"==typeof a.end&&(a.end=new Date(a.end)));const l=s.objectIds;Array.isArray(l)&&(null==l?void 0:l.length)>0&&l.forEach((e,t)=>{"number"==typeof e&&(l[t]=e.toString())});const u=_B(e.id).properties.find(e=>"queryParams"===e.name).properties.map(e=>e.name);return Object.keys(s).forEach(e=>{u.includes(e)||delete s[e]}),s})}(e),[d,p,f,h]=yield Promise.all([a,l,u,c]);t.layer=d,t.queryParams=h,t.selectedFeatures=p,t.loadedFeatures=f,t.loadedFields=r}catch(e){console.error("createSingleDataSourceProfileVariableInstances error",e)}return t})}function NB(e,t){return PB(this,void 0,void 0,function*(){var n,r;let i=null;try{t||(t=[]);let o=null;if((null==t?void 0:t.length)>0){const e=t[0],i=null===(r=null===(n=null==e?void 0:e.feature)||void 0===n?void 0:n.geometry)||void 0===r?void 0:r.spatialReference;if(i){const e=i;o=e.declaredClass&&e.toJSON?e.toJSON():i}}const s=yield dO(e,t);i=null==s?void 0:s.layer,i&&!i.spatialReference&&o&&(i.spatialReference=o)}catch(e){console.error("createJSAPIFeatureLayerByRecords error",e)}return i})}function kB(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}const UB=[Xa.FeatureLayer,Xa.OrientedImageryLayer,Xa.SubtypeGroupLayer,Xa.SubtypeSublayer];function FB(e){if(e){const t=e.type;return UB.includes(t)}return!1}function BB(e){const t=mA.getInstance().getDataSource(e);return t&&FB(t)?t:null}var $B=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class VB{static getInstance(){var e,t;if(null===(e=window.jimuConfig)||void 0===e?void 0:e.isBuilder){const e=null===(t=window._appWindow)||void 0===t?void 0:t._arcadeProfileVariableManager;return e||(console.error("builder can not get ArcadeProfileVariableManager from app window"),null)}return VB.instance||(VB.instance=new VB,window._arcadeProfileVariableManager=VB.instance),VB.instance}constructor(){this.componentInfoMap={},this.dataSourceInfoMap={}}setArcadeProfileVariableManagerComponent(e){this.arcadeProfileVariableManagerComponent=e,this.arcadeProfileVariableManagerComponent&&this.updateUseDataSourcesForArcadeGlobalDataSourcesComponent()}updateUseDataSourcesForArcadeGlobalDataSourcesComponent(){if(this.arcadeProfileVariableManagerComponent){const e=Object.values(this.dataSourceInfoMap).map(e=>e.useDataSource);this.arcadeProfileVariableManagerComponent.setUseDataSources(e)}}registerResolverComponent(e,t,n,r){t||(t=[]);const i=(t=(t=t.filter(e=>!!(null==e?void 0:e.dataSourceId))).map(e=>{const t=Object.assign({},e);return delete t.fields,delete t.useFieldsInPopupInfo,delete t.useFieldsInSymbol,t})).map(e=>e.dataSourceId),o=this.componentInfoMap[e];($w(!0,(null==o?void 0:o.dataSourceIds)||[],i).deleted||[]).forEach(t=>{this.resolverComponentRemoveDataSourceId(e,t)}),t.forEach(t=>{this.resolverComponentAddDataSource(e,t,n,r)}),this.updateUseDataSourcesForArcadeGlobalDataSourcesComponent()}unregisterResolverComponent(e){const t=this.componentInfoMap[e];if(t){const n=t.dataSourceIds;(null==n?void 0:n.length)>0&&n.forEach(t=>{this.resolverComponentRemoveDataSourceId(e,t)}),delete this.componentInfoMap[e]}this.updateUseDataSourcesForArcadeGlobalDataSourcesComponent()}resolverComponentAddDataSource(e,t,n,r){const i=t.dataSourceId;let o=this.componentInfoMap[e];if(o||(o={componentId:e,dataSourceIds:[],callback:n,dirtyCallback:r},this.componentInfoMap[e]=o),o.callback=n,o.dirtyCallback=r,o.dataSourceIds||(o.dataSourceIds=[]),o.dataSourceIds.includes(i))return;o.dataSourceIds.push(i);const s=this.dataSourceInfoMap[i];if(s)s.componentIds||(s.componentIds=[]),s.componentIds.push(e),this.triggerCallbackWhenDataChanged(s,e);else{const n={dataSourceId:i,useDataSource:Ye(t),componentIds:[e],debounceCreateSingleDataSourceProfileVariableInstances:GB(MB,300),latestVersion:0,dataVersion:0,data:null};this.dataSourceInfoMap[i]=n;BB(i)&&this.debounceCreateSingleDataSourceProfileVariableInstances(i)}}resolverComponentRemoveDataSourceId(e,t){var n,r;const i=this.componentInfoMap[e];i&&((null===(n=i.dataSourceIds)||void 0===n?void 0:n.includes(t))&&(i.dataSourceIds=i.dataSourceIds.filter(e=>e!==t)),i.dataSourceIds&&0!==i.dataSourceIds.length||delete this.componentInfoMap[e]);const o=this.dataSourceInfoMap[t];o&&((null===(r=o.componentIds)||void 0===r?void 0:r.includes(e))&&(o.componentIds=o.componentIds.filter(t=>t!==e)),o.componentIds&&0!==o.componentIds.length||delete this.dataSourceInfoMap[t])}onDataSourceCreated(e){this.debounceCreateSingleDataSourceProfileVariableInstances(null==e?void 0:e.id)}onCreateDataSourceFailed(e,t){console.error("Arcade create data source failed",e,t);const n=null==e?void 0:e.dataSourceId;if(!n)return;const r=this.dataSourceInfoMap[n];r&&(this.increaseLatestVersion(r),r.dataVersion=r.latestVersion,r.data=null,this.triggerCallbackWhenDataChanged(r))}onQueryRequired(e){this.triggerDirtyCallback(e),this.debounceCreateSingleDataSourceProfileVariableInstances(null==e?void 0:e.dataSourceId)}onSelectionChange(e){this.triggerDirtyCallback(e),this.debounceCreateSingleDataSourceProfileVariableInstances(null==e?void 0:e.dataSourceId)}onDataSourceStatusChange(e,t,n){t===Ya.Loaded&&n===Ya.Loading&&(this.triggerDirtyCallback(e),this.debounceCreateSingleDataSourceProfileVariableInstances(null==e?void 0:e.dataSourceId))}increaseLatestVersion(e){e&&("number"==typeof e.latestVersion&&e.latestVersion>=1?e.latestVersion++:e.latestVersion=1)}triggerDirtyCallback(e){const t=null==e?void 0:e.dataSourceId;if(!t)return;const n=this.dataSourceInfoMap[t];if(!n)return;if(BB(t)&&n){const{dataSourceId:e,componentIds:t,dataVersion:r}=n;e&&(null==t?void 0:t.length)>0&&r>0&&t.forEach(t=>{const n=this.componentInfoMap[t];if(n){const{dataSourceIds:t,dirtyCallback:r}=n;if((null==t?void 0:t.length)>0&&t.includes(e)&&r)try{r(e)}catch(e){console.error("ArcadeProfileVariableManager dirtyCallback error",e)}}})}}debounceCreateSingleDataSourceProfileVariableInstances(e){if(!e)return;const t=this.dataSourceInfoMap[e];if(!t)return;const n=BB(e);if(!n)return;this.increaseLatestVersion(t);const r=t.latestVersion,i=e=>{this.isDataSourceInfoRefresh(t)&&r===t.latestVersion&&(t.data=e,t.dataVersion=r,this.triggerCallbackWhenDataChanged(t))};t.debounceCreateSingleDataSourceProfileVariableInstances(n).then(e=>{i(e)}).catch(e=>{console.error("debounceCreateSingleDataSourceProfileVariableInstances error",e),i(null)})}isDataSourceInfoRefresh(e){if(!e)return!1;const t=e.dataSourceId;return this.dataSourceInfoMap[t]===e}triggerCallbackWhenDataChanged(e,t){if(e){const{dataSourceId:n,componentIds:r,dataVersion:i,data:o}=e,s=t&&(null==r?void 0:r.includes(t))?[t]:r;n&&(null==s?void 0:s.length)>0&&i>0&&s.forEach(e=>{const t=this.componentInfoMap[e];if(t){const{dataSourceIds:e,callback:r}=t;if((null==e?void 0:e.length)>0&&e.includes(n)&&r)try{r(n,o)}catch(e){console.error("triggerCallbackWhenDataChanged callback error",e)}}})}}destroy(){this.componentInfoMap={},this.dataSourceInfoMap={}}}function GB(e,t){let n=[];const r=BE((...t)=>$B(this,void 0,void 0,function*(){try{const r=yield e(...t);n.forEach(({resolve:e})=>{e(r)})}catch(e){n.forEach(({reject:t})=>{t(e)})}finally{n=[]}}),t);return function(...e){return new Promise((t,i)=>{n.push({resolve:t,reject:i}),r(...e)})}}class WB extends F.PureComponent{constructor(e){super(e),this.state={useDataSources:[]}}componentDidMount(){this.arcadeManager=VB.getInstance(),this.arcadeManager&&this.arcadeManager.setArcadeProfileVariableManagerComponent(this)}componentWillUnmount(){this.arcadeManager&&this.arcadeManager.setArcadeProfileVariableManagerComponent(null)}setUseDataSources(e){const t=[],n={};e.forEach(e=>{const r=e.dataSourceId;n[r]||(n[r]=e,t.push(e))}),t.sort((e,t)=>e.dataSourceId.localeCompare(t.dataSourceId));t.map(e=>e.dataSourceId).join(",")!==this.state.useDataSources.map(e=>e.dataSourceId).join(",")&&this.setState({useDataSources:t})}render(){var e;if(null===(e=window.jimuConfig)||void 0===e?void 0:e.isBuilder)return null;const t=this.state.useDataSources||[];return(0,sg.jsx)("div",{className:"arcade-global-datasources-component d-none",children:t.map(e=>(0,sg.jsx)(RB,{useDataSource:e,onDataSourceCreated:e=>{var t;null===(t=this.arcadeManager)||void 0===t||t.onDataSourceCreated(e)},onCreateDataSourceFailed:t=>{var n;null===(n=this.arcadeManager)||void 0===n||n.onCreateDataSourceFailed(e,t)},onQueryRequired:()=>{var t;null===(t=this.arcadeManager)||void 0===t||t.onQueryRequired(e)},onSelectionChange:()=>{var t;null===(t=this.arcadeManager)||void 0===t||t.onSelectionChange(e)},onDataSourceStatusChange:(t,n)=>{var r;null===(r=this.arcadeManager)||void 0===r||r.onDataSourceStatusChange(e,t,n)}},e.dataSourceId))})}}function HB(){const e=Je(e=>{var t;return null===(t=e.appInfo)||void 0===t?void 0:t.name}),t=Je(e=>{var t;const n=null===(t=e.appConfig)||void 0===t?void 0:t.pages[e.appRuntimeInfo.currentPageId];return n?n.isDefault?null:n.label:null});return(0,F.useEffect)(()=>{if(e){const n=t?`${t} | ${e}`:e;document.title=n}},[e,t]),null}function zB(e){const t=Je(e=>{var t,n;return null===(n=null===(t=e.appConfig)||void 0===t?void 0:t.attributes)||void 0===n?void 0:n.favicon});return(0,F.useEffect)(()=>{var n,r,i;const o=document.querySelector('link[rel="shortcut icon"]');if(o)if(null===(n=null==t?void 0:t.properties)||void 0===n?void 0:n.isUploaded)o.href=ty(null===(r=null==t?void 0:t.properties)||void 0===r?void 0:r.path);else{let n=null==t?void 0:t.svg;if(!n)return;let r=null===(i=null==t?void 0:t.properties)||void 0===i?void 0:i.color;const{isCSSVariable:s,colorUtils:a}=Mw();if(s(r)&&(r=a.parseThemeVariable(r,e.themeVariables)),r){const e=(new DOMParser).parseFromString(n,"image/svg+xml");e.querySelectorAll("svg,path").forEach(e=>{e.setAttribute("fill",r)});n=(new XMLSerializer).serializeToString(e)}const l=new Blob([n],{type:"image/svg+xml"});o.href=window.URL.createObjectURL(l)}},[t,e.themeVariables]),null}function qB(e){const t=window.jimuConfig.isBuilder||window.jimuConfig.isSite?"#232323":"#f0f0f0",n=window.jimuConfig.isBuilder||window.jimuConfig.isSite?"#f0f0f0":"#232323";return sg.css`
    width: 100vw;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 16px;
    color: ${n};
    background: ${t};
    .error-content {
      margin: 0 20px;
    }
    .message {
      margin-bottom: 20px;
    }
    .error-page-button {
      min-width: 240px;
      color: #fff;
      border-radius: 2px;
      background: #007f94;
      font-size: 14px;
    }
    .error-page-button: hover {
      background: #007f94;
      text-decoration-line: unset
    }
    .error-page-operation {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
    }
  `}function JB(e){const{systemError:t,intl:n,queryObject:r}=e,i=t.code;let o;const s=dI(),a=TI({id:null==s?void 0:s.appId,type:"app",isDraft:"true"===r.draft}),{Button:l}=MI("jimu-ui");return i===cl.AppNotPublished?o=n.formatMessage({id:"notPublishError",defaultMessage:Xg.notPublishError}):i===cl.AppNotExisted?o=n.formatMessage({id:"invalidResourceItem",defaultMessage:Xg.invalidResourceItem}):i===cl.AppPage404&&(o=n.formatMessage({id:"page404Error",defaultMessage:Xg.page404Error},{br:"<br />"})),(0,sg.jsxs)("div",{id:"loadAppConfigError",className:"error-content load-app-config-error",children:[(0,sg.jsx)("div",{className:"message",dangerouslySetInnerHTML:{__html:o}}),(0,sg.jsx)("div",{className:"operation",children:l&&i===cl.AppPage404&&(0,sg.jsx)(l,{className:"error-page-button go-home",size:"lg",href:a,children:n.formatMessage({id:"goToHomePage",defaultMessage:Xg.goToHomePage})})})]})}function KB(e){var t,n,r;const{systemError:i,intl:o,queryObject:s}=e,{Button:a}=MI("jimu-ui"),l=window.jimuConfig;document.getElementById("app").style.zIndex="800";const u=l.isBuilder?Km.Builder:l.isSite?Km.AppList:Km.Experience,c=i.message?i.message:nv(u,i.code),d=i.code===cl.PrivilegeInvalidMainSession,p=Cv.getInstance().getMainSession(),f=null===(t=TE().getState())||void 0===t?void 0:t.portalUrl,h=null===(r=null===(n=TE().getState())||void 0===n?void 0:n.appRuntimeInfo)||void 0===r?void 0:r.noPermissionPages,g=dI(),m=g.pageId,v=TI({id:null==g?void 0:g.appId,type:"app",isDraft:"true"===s.draft}),y=(0,F.useCallback)(()=>{Cv.getInstance().switchAccount({popup:!1})},[]),S=(0,F.useCallback)(()=>{var e;Cv.getInstance().signIn({fromUrl:null===(e=window.location)||void 0===e?void 0:e.href,popup:!1,desUrl:f,forceLogin:!0})},[f]),b=(0,F.useMemo)(()=>{var e;if(i.code===cl.PrivilegeInvalidPagePermission&&m){return!(null===(e=null==h?void 0:h.find(e=>e.id===m))||void 0===e?void 0:e.isDefault)}return!1},[m,h,i.code]);return(0,sg.jsxs)("div",{id:"privilegeError",className:"privilege-error error-content",children:[(0,sg.jsx)("div",{className:"message",dangerouslySetInnerHTML:{__html:c}}),(0,sg.jsxs)("div",{className:"error-page-operation",children:[b&&a&&(0,sg.jsx)(a,{size:"lg",className:"error-page-button",href:v,children:o.formatMessage({id:"goToHomePage",defaultMessage:Xg.goToHomePage})}),!window.jimuConfig.isInPortal&&!d&&p&&a&&(0,sg.jsx)(a,{className:"error-page-button",size:"lg",onClick:y,children:o.formatMessage({id:"switchAccountBtn",defaultMessage:Xg.switchAccountBtn})}),a&&(d||!p)&&(0,sg.jsx)(a,{size:"lg",className:"error-page-button",onClick:S,children:o.formatMessage({id:"signIn",defaultMessage:"Sign in"})})]})]})}function YB(e){const{systemError:t,fromUrl:n,intl:r}=e,i=(0,F.useCallback)(()=>{var e,t;Cv.getInstance().signIn({fromUrl:n||(null===(e=window.location)||void 0===e?void 0:e.href),popup:!1,desUrl:null===(t=TE().getState())||void 0===t?void 0:t.portalUrl})},[n]),{Button:o}=MI("jimu-ui");let s="";switch(t.code){case cl.OAuthPublicUserLimit:s=r.formatMessage({id:"publicUserError",defaultMessage:Xg.publicUserError});break;case cl.OAuthAppLicenceLimit:s=r.formatMessage({id:"essentialAppsLicenseErrorForBuilder",defaultMessage:Xg.essentialAppsLicenseErrorForBuilder});break;default:s=r.formatMessage({id:"signInErrorDefault",defaultMessage:Xg.signInErrorDefault})}return(0,sg.jsxs)("div",{id:"oauthError",className:"error-content oauth-error-page",children:[(0,sg.jsx)("div",{className:"message",dangerouslySetInnerHTML:{__html:s}}),(0,sg.jsx)("div",{className:"operation",children:o&&(0,sg.jsx)(o,{className:"error-page-button sign-in-btn",size:"lg",onClick:i,children:r.formatMessage({id:"signIn",defaultMessage:"Sign in"})})})]})}function XB(e){const{systemError:t,intl:n,theme:r,queryObject:i}=e;return(0,sg.jsxs)("div",{className:"system-error-page",css:qB(),children:[t.type===ul.AppError&&(0,sg.jsx)(JB,{systemError:t,theme:r,intl:n,queryObject:i}),t.type===ul.PrivilegeError&&(0,sg.jsx)(KB,{systemError:t,theme:r,intl:n,queryObject:i}),t.type===ul.OAuthError&&(0,sg.jsx)(YB,{systemError:t,fromUrl:null==i?void 0:i.fromUrl,theme:r,intl:n})]})}"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},writable:!0,configurable:!0});const QB={w3c:{title:"title",description:"snippet",keywords:"typeKeywords",image_src:"thumbnail"},twitter:{title:"title",description:"snippet",image:"thumbnail"},og:{title:"title",description:"snippet",url:"itemUrl",image:"thumbnail"}};function ZB(e){if(e){if(!window.URL||"function"!=typeof window.URL)return function(e){let t=e.split("?");if(1===t.length||0===t[1].length)return e;let n=t[1].split("#");n[1]&&n[1].length?(t[1]=n[0],n=n[1]):n="";const r=t[1].split("&"),i=r.map(e=>{const t=e.split("=");return"token"==t[0]?[]:t}).reduce((e,t)=>(e.length&&(e+="&"),t.length&&(e+=t.join("=")),e),"");let o=t[0];i&&i.length&&(o+="?"+i);n&&n.length&&(o+="#"+n);return o}(e);try{const t=new URL(e);return t.searchParams.has("token")&&t.searchParams.delete("token"),t.toString()}catch(t){return console.log(`can not parse ${e} into a valid URL`),""}}}function e$(e){const t=document.createElement("meta");for(const n in e)if(e.hasOwnProperty(n)){const r=e[n];t.setAttribute(n,r)}document.head.appendChild(t)}const t$=function({profiles:e="w3c,twitter,og",mapping:t,item:n,imageSrc:r,noindex:i}){if(n&&i&&"function"==typeof i&&i(n))return void e$({name:"robots",content:"noindex"});e=e.toLowerCase().split(",").map(e=>e.trim());const o=function(e){return Object.keys(e).reduce((t,n)=>(t[n]=Object.assign({},e[n]),t),{})}(QB);if(r&&(o.w3c.image_src=r,o.twitter.image=r,o.og.image=r),t)for(const e in t)if(t.hasOwnProperty(e)){const n=t[e];o[e]?Object.assign(o[e],n):o[e]=n}e.forEach(e=>{"w3c"==e?function(e,t){if(["title","description","keywords"].forEach(n=>{const r=t[n];let i=e[r];Array.isArray(i)&&(i=i.join(",")),void 0!==i&&e$({name:n,content:i})}),null!=e[t.image_src]){const n=ZB(e[t.image_src]);if(""!=n){const e=document.createElement("link");e.setAttribute("rel","image_src"),e.setAttribute("href",n),document.head.appendChild(e)}}}(n,o[e]):"twitter"==e?function(e,t){e$({name:"twitter:card",content:"summary"}),e$({name:"twitter:site",content:"@arcgisonline"});for(const n in t)if(t.hasOwnProperty(n)){const r=t[n];let i="image"==n?ZB(e[r]):e[r];Array.isArray(i)&&(i=i.join(",")),void 0!==i&&""!==i&&e$({name:`twitter:${n}`,content:i})}}(n,o[e]):"og"==e?function(e,t){for(const n in t)if(t.hasOwnProperty(n)){const r=t[n];let i="image"==n?ZB(e[r]):e[r];Array.isArray(i)&&(i=i.join(",")),void 0!==i&&""!==i&&e$({property:`og:${n}`,content:i})}}(n,o[e]):o[e]&&o[e].insert&&"function"==typeof o[e].insert&&o[e].insert(n,o[e])})};function n$(){const e=Je(e=>e.appInfo),t=xg(Je(e=>e.portalUrl)),n=Je(e=>{var t;const n=null===(t=e.appConfig)||void 0===t?void 0:t.pages[e.appRuntimeInfo.currentPageId];return n?n.isDefault?null:n.label:null});return(0,F.useEffect)(()=>{if(!e||!e.name)return;const r=n?`${n} | ${e.name}`:e.name;let i=e.set("title",r);i=window.jimuConfig.isOutOfExb?i.set("thumbnail",`${OI()}${i.thumbnail}`):window.jimuConfig.isDevEdition?i.set("thumbnail",`${location.origin}${window.jimuConfig.mountPath}apps/${e.id}/${i.thumbnail}`):i.set("thumbnail",`${t}/sharing/rest/content/items/${e.id}/info/${e.thumbnail}`),t$({item:i})}),null}var r$=a(986),i$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class o${static getInstance(){return o$.instance||(o$.instance=new o$),o$.instance}constructor(){this.initialize=e=>i$(this,void 0,void 0,function*(){var t;if(e&&e.enable){console.log("Start to init the tracking instance");const n={plugins:[]},{Telemetry:r,GoogleAnalytics:i}=yield NI("jimu-core/telemetry"),o=null===(t=null==e?void 0:e.google)||void 0===t?void 0:t.measurementId;if(o){const e=new i({measurementIds:[o]});n.plugins.push(e)}this.telemetry=new r(n);try{return(0,r$.isAllowedToTrack)()||this.telemetry.disableTracker("googleAnalytics"),yield this.telemetry.init(),console.log("Tracking instance initialization finished"),this}catch(e){console.error("Tracking instance initialization failed",e)}}}),xE(this.onAnalyticChange.bind(this),["appConfig","analytics"]),xE(this.onCookieConsentModeChange.bind(this),["appConfig","cookieBanner","consentMode"])}onAnalyticChange(e=Ye({}),t=Ye({})){t.enable!==e.enable&&t.enable&&this.initialize(t)}onCookieConsentModeChange(e,t){(0,r$.isAllowedToTrack)()?this.telemetry&&this.telemetry.enableTracker("googleAnalytics"):this.telemetry&&this.telemetry.disableTracker("googleAnalytics")}logPageView(){this.telemetry.logPageView(window.location.pathname)}}function s$(){const e=Je(e=>e.appId),t=Je(e=>e.appRuntimeInfo.currentPageId),n=Je(e=>{var t;return(null===(t=e.appInfo)||void 0===t?void 0:t.type)===dl.Template});return(0,F.useEffect)(()=>{if(window.jimuConfig.isBuilder||window.jimuConfig.isSite)return;let r="";const i=`${window.location.protocol}//${window.location.host}`;let o;e?o=`${i}${TI({id:e,type:n?"template":"app"})}`:(o=`${i}${window.jimuConfig.mountPath}`,o.endsWith("/")&&(o=o.slice(0,-1))),r=t?xI(o,t):o;const s=document.querySelector("head title");if(!s||!s.nextSibling)return;let a=document.querySelector('link[rel="canonical"]');a||(a=document.createElement("link"),a.setAttribute("rel","canonical"),document.head.insertBefore(a,s.nextSibling)),a.setAttribute("href",r)},[e,t,n]),null}var a$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function l$(e){const{portalInfo:t,intl:n,theme:r}=e,{portalUrl:i}=t,[o,s]=(0,F.useState)(!1),a=(0,F.useRef)(null),l=Cv.getInstance(),u=(0,F.useCallback)(()=>a$(this,void 0,void 0,function*(){const e=a.current.value,t=yield(e=>Pr(ag(e),{httpMethod:"GET"}).then(e=>Number(null==e?void 0:e.currentVersion)).catch(e=>(console.warn(e),null)))(i);wy(i,e,t),TE().dispatch(JD(i)),l.onClientIdDialogFinished(i,e)}),[i,l]),c=(0,F.useCallback)(()=>{MI("jimu-for-builder").builderAppSync.publishSetClientIdAlertIsCancelled(i),TE().dispatch(JD(i)),l.onClientIdDialogFinished(i,null,new Error("setting clientId is cancelled."))},[i,l]),d=(0,F.useCallback)(()=>{const e=a.current.value;return Uv(i,e).then(e=>(s(e),{valid:e}))},[i]),{AlertPopup:p,TextInput:f}=MI("jimu-ui"),h=n.formatMessage({id:"setClientIdMessage1",defaultMessage:Xg.setClientIdMessage1},{register:n.formatMessage({id:"registerText",defaultMessage:Xg.registerText})});return(0,sg.jsx)("div",{children:(0,sg.jsx)(p,{isOpen:!0,title:"",disableOK:!o,onClickOk:u,onClickClose:c,children:(0,sg.jsxs)("div",{style:{color:r.ref.palette.black,fontSize:nn(16)},children:[(0,sg.jsx)("p",{children:h}),(0,sg.jsx)("p",{children:(0,sg.jsx)(Lj,{id:"arcgisEnterpriseText",defaultMessage:Xg.arcgisEnterpriseText})}),(0,sg.jsx)("p",{style:{color:r.ref.palette.neutral[900]},children:i}),(0,sg.jsx)("p",{children:(0,sg.jsx)(Lj,{id:"setClientIdMessage2",defaultMessage:Xg.setClientIdMessage2})}),(0,sg.jsx)(f,{css:sg.css`.input-wrapper {background-color: var(--ref-palette-neutral-400)}`,checkValidityOnAccept:d,ref:a})]})})})}var u$=a(5737),c$=a.n(u$),d$=a(3001),p$=a.n(d$);function f$(e){return sg.css`
    .permission-banner-list {
      width: auto;
      align-items: stretch;
      flex-direction: column;
      font-size: 13px;
      .banner-list-panel {
        color: ${e.sys.color.surface.paperText};
      }
      .warning-icon {
        position: absolute;
        left: 10px;
        width: 24px;
        height: 24px;
      }
      .banner-list-item {
      }
      .banner-list-item-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1px;
        position: relative;
        .item-info {
          flex-grow: 2;
          .fold-btn {
            position: absolute;
            left: -26px;
            top: 0;
            .directional {
              width: 8px;
              height: 8px;
            }
          }
        }
        .item-link {
          display: block;
          color: var(--sys-color-action-link);
          max-width: 140px;
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden;
        }
        .item-link.sub-item-link {
          max-width: 315px;
        }
        .item-operation {
          display: flex;
          align-items: center;
        }

        .button-separator {
          height: 18px;
          margin: 0 8px;
          border-right-width: 1px;
          border-right-style: solid;
          border-right-color: var(--sys-color-divider-secondary)
        }
      }
      .user-name {
        max-width: 315px;
        font-size: 12px;
        font-style: italic;
        color: var(--sys-color-surface-paperHint)
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .ignore-all-btn {
        width: 100%;
        height: 26px;
        margin-top: 10px;
      }
      .left-part {
        display: block !important
      }
    }`}function h$(e){const[t,n]=(0,F.useState)({}),r=(0,F.useCallback)((e,r)=>{const i=Object.assign({},t);i[r]=e,n(i)},[t]),{theme:i,intl:o,allowIgnore:s,allowLogout:a}=e,l=(0,F.useMemo)(()=>{const t={},n=Cv.getInstance();return Object.entries(e.noPermissionResourceInfoList).forEach(e=>{const r=e[0],i=e[1];let o;o=!!n.getServerKeyFromUrl(r)?i.owningSystemUrl?hg(i.owningSystemUrl):Jg(r):hg(r),t[o]||(t[o]=[]),o!==r&&t[o].push(r)}),t},[e.noPermissionResourceInfoList]);return(0,sg.jsx)("div",{children:Object.entries(l).map((n,l)=>{const u=n[0],c=n[1];return(0,sg.jsxs)("div",{className:"permission-list",children:[(0,sg.jsx)(v$,{url:u,resourceUrl:c[0],theme:i,intl:o,hasSubItems:c.length>0,isUnFold:t[u],foldBtnClick:r,allowIgnore:s,allowLogout:a,disableOperation:e.disableOperation},l),t[u]&&c.map((t,n)=>(0,sg.jsx)(y$,{url:t,theme:i,intl:o,disableOperation:e.disableOperation},n))]},l)})})}function g$(e){const t=Je(e=>({noPermissionResourceChangedFlag:e.noPermissionResourceChangedFlag})),n=(0,F.useMemo)(()=>{const e={};return t.noPermissionResourceChangedFlag&&Object.entries(Cv.getInstance().getNoPermissionResourceInfoList()).forEach(t=>{t[1].ignored||(e[t[0]]=t[1])}),e},[t.noPermissionResourceChangedFlag]),r=(0,F.useCallback)(()=>{Cv.getInstance().ignoreFromNoPermissionResourceInfoList()},[]),{Button:i}=MI("jimu-ui"),{theme:o,intl:s}=e;return(0,sg.jsx)("div",{css:f$(o),children:(0,sg.jsx)("div",{className:"permission-banner-list",children:(0,sg.jsxs)("div",{className:"banner-list-panel",children:[(0,sg.jsx)(Lj,{id:"signInBannerListWarning",defaultMessage:Xg.signInBannerListWarning}),(0,sg.jsx)("div",{className:"mt-4",children:(0,sg.jsx)(h$,Object.assign({},e,{noPermissionResourceChangedFlag:t.noPermissionResourceChangedFlag,noPermissionResourceInfoList:n}))}),i&&(0,sg.jsx)(i,{className:"ignore-all-btn",variant:"outlined",size:"sm",onClick:r,disabled:e.disableOperation,children:s.formatMessage({id:"signInBannerIgnoreAll",defaultMessage:Xg.signInBannerIgnoreAll})})]})})})}function m$(e){var t;const[n,r]=(0,F.useState)(null),{enqueueNotification:i,closeNotification:o}=MI("jimu-ui"),s=(0,F.useMemo)(()=>{const t={};return e.noPermissionResourceChangedFlag&&Object.entries(Cv.getInstance().getNoPermissionResourceInfoList()).forEach(e=>{e[1].ignored||(t[e[0]]=e[1])}),t},[e.noPermissionResourceChangedFlag]),a=(0,F.useId)(),l=Object.keys(s).length,u=!window.jimuConfig.isBuilder&&!window.jimuConfig.isInBuilder&&!(null===(t=TE().getState().appConfig.permission)||void 0===t?void 0:t.blockPermissionBanner)&&e.theme&&l>0&&!n;return(0,F.useEffect)(()=>{u?(i({id:a,severity:"warning",message:e.intl.formatMessage({id:"signInBannerTitle",defaultMessage:Xg.signInBannerTitle}),closable:!1,placement:"bottom-right",autoHideDuration:0,pausable:!0,description:(0,sg.jsx)(g$,Object.assign({},e))}),r(a)):n&&l<=0&&(o(n),r(null))},[i,o,u,a,n,l,e]),(0,sg.jsx)(F.Fragment,{})}function v$(e){var t,n;const{url:r,resourceUrl:i,theme:o,intl:s,hasSubItems:a,isUnFold:l,foldBtnClick:u,allowIgnore:c,allowLogout:d}=e,p=(0,F.useCallback)(()=>{const e=Cv.getInstance();let t;t=zg(i)&&Jg(i)===r?i:r,e.switchAccountByResourceUrl(t)},[r,i]),f=(0,F.useCallback)(()=>{Cv.getInstance().ignoreFromNoPermissionResourceInfoList(r)},[r]),h=(0,F.useCallback)(()=>{const e=Cv.getInstance();let t;t=zg(i)&&Jg(i)===r?i:r,e.signOutByResourceUrl(t)},[r,i]),g=(0,F.useCallback)(()=>{u(!l,r)},[r,l,u]),{Button:m,Icon:v}=MI("jimu-ui"),y=(null===(t=Cv.getInstance().getSessionByUrl(r))||void 0===t?void 0:t.username)||(null===(n=Cv.getInstance().getSessionByUrl(`${r}/rest/services`))||void 0===n?void 0:n.username),S=s.formatMessage({id:"currentData",defaultMessage:"current"}),b=y?s.formatMessage({id:"switch",defaultMessage:"Switch"}):s.formatMessage({id:"signIn",defaultMessage:"Sign in"}),w=s.formatMessage({id:"signInBannerIgnore",defaultMessage:Xg.signInBannerIgnore}),I=s.formatMessage({id:"signOut",defaultMessage:"Sign out"});return(0,sg.jsxs)("div",{className:"banner-list-item",children:[(0,sg.jsxs)("div",{className:"banner-list-item-content",css:f$(o),children:[(0,sg.jsxs)("div",{className:"item-info",children:[a&&m&&(0,sg.jsx)(m,{className:"fold-btn",size:"sm",type:"tertiary",icon:!0,onClick:g,children:l?(0,sg.jsx)(v,{className:"directional",icon:c$()}):(0,sg.jsx)(v,{className:"directional",autoFlip:!0,icon:p$()})}),(0,sg.jsx)("a",{className:"item-link",href:r,target:"_blank",rel:"noopener noreferrer",title:r,children:r})]}),(0,sg.jsxs)("div",{className:"item-operation",children:[(0,sg.jsx)(m,{className:"item-operation-btn",size:"sm",type:"tertiary",title:b,onClick:p,disabled:e.disableOperation,children:(0,sg.jsx)("div",{className:"text-truncate",children:b})}),c&&(0,sg.jsx)("div",{className:"button-separator",style:{}}),c&&(0,sg.jsx)(m,{className:"item-operation-btn",size:"sm",type:"tertiary",title:w,onClick:f,disabled:e.disableOperation,children:(0,sg.jsx)("div",{className:"text-truncate",children:w})}),d&&y&&(0,sg.jsx)("div",{className:"button-separator",style:{}}),d&&y&&(0,sg.jsx)(m,{className:"item-operation-btn",size:"sm",type:"tertiary",title:I,onClick:h,disabled:e.disableOperation,children:(0,sg.jsx)("div",{className:"text-truncate",children:I})})]})]}),y&&(0,sg.jsx)("div",{className:"d-flex user-name-content",children:(0,sg.jsx)("div",{className:"user-name text-truncate",children:`${S}:${y}`})})]})}function y$(e){const{url:t,theme:n}=e;return(0,sg.jsx)("div",{className:"banner-list-item-content",css:f$(n),children:(0,sg.jsx)("a",{className:"item-link sub-item-link",href:t,target:"_blank",rel:"noopener noreferrer",title:t,children:t})})}const S$=F.memo(()=>{const{Button:e,enqueueNotification:t,closeNotification:n}=MI("jimu-ui"),r=r_(Xg),i=F.useCallback(()=>{window.jimuConfig.isInBuilder||(qS.getInstance().restoreLocalState(),n("app-state-restore"))},[n]),o=F.useCallback(()=>{window.jimuConfig.isInBuilder||(n("app-state-restore"),KS())},[n]),s=F.useCallback(()=>{const n=(0,sg.jsxs)("div",{className:"experience-state-restore-buttons",children:[(0,sg.jsx)(e,{variant:"contained",color:"primary",size:"sm",className:"mr-2",onClick:i,children:r("restoreStateAccept")}),(0,sg.jsx)(e,{variant:"outlined",size:"sm",onClick:o,children:r("signInBannerIgnore")})]});t({id:"app-state-restore",severity:"info",closable:!1,message:r("restoreState"),description:r("restoreStateTips"),placement:"bottom-right",autoHideDuration:1e4,pausable:!0,action:n})},[e,t,o,i,r]);return F.useEffect(()=>{var e;!!(null===(e=TE().getState().appConfig.appStateConfig)||void 0===e?void 0:e.allowRestoreState)&&qS.isSupportLocalState()&&qS.getInstance().init().then(e=>{e.registerRestoreFunction(YS);e.existLocalState()&&s()})},[s]),null});var b$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const w$=a(2528).exbVersion;class I$ extends F.PureComponent{constructor(e){var t;super(e),this.getKeyboardComponent=()=>{if(window.jimuConfig.isBuilder){const e=MI("jimu-for-builder").BuilderKeyboardComponent;return(0,sg.jsx)(e,{})}return window.jimuConfig.isInBuilder?(0,sg.jsx)(CB,{}):null},this.renderCookieBanner=e=>{if(window.jimuConfig.isBuilder||window.jimuConfig.isSite)return null;const{CookieBanner:t}=this.getJimuUI();return t?(0,sg.jsx)(t,{theme:e}):null},this.renderVersionRemind=()=>{const{isVersionAlertOpened:e}=this.state,{appConfigVersion:t}=this.props,{Alert:n}=this.getJimuUI(),r=TE().getState(),i=null==r?void 0:r.appInfo,o=lt.lt(w$,t);if(window.jimuConfig.isBuilder||!o||!e)return null;const s="Web Experience Template"===(null==i?void 0:i.type);return(0,sg.jsx)(n,{className:"w-100 position-absolute version-remind",open:e,onClose:this.onVersionRemindClose,closable:!0,style:{zIndex:2},children:s?this.props.intl.formatMessage({id:"templateVersionRemind",defaultMessage:Xg.templateVersionRemind}):this.props.intl.formatMessage({id:"experienceVersionRemind",defaultMessage:Xg.experienceVersionRemind})})},this.renderGuideRenderer=()=>{var e;const t=null===(e=MI("jimu-ui/basic/guide"))||void 0===e?void 0:e.GuideRenderer;return t?(0,sg.jsx)(t,{}):null},this.renderArcadeProfileVariableManagerComponent=()=>{var e;return(null===(e=window.jimuConfig)||void 0===e?void 0:e.isBuilder)?null:(0,sg.jsx)(WB,{})},this.onVersionRemindClose=()=>{this.setState({isVersionAlertOpened:!1})},this.reload=()=>{window.location.reload()};const n={},r=this.getPageId();n.pageStatus=Ye(r?{[r]:!0}:{}),n.preloadWidgetsLoaded=!1,n.isVersionAlertOpened=!0,this.state=n,this.reload=this.reload.bind(this),mA.getInstance();(null===(t=window.jimuConfig)||void 0===t?void 0:t.isBuilder)||VB.getInstance()}getLayoutEntryPath(){let e;return e=window.jimuConfig.isInBuilder?"jimu-layouts/layout-builder":"jimu-layouts/layout-runtime",e}getA11ySkip(){if(!this.props.enableA11yForWidgetSettings||window.jimuConfig.isInBuilder||window.jimuConfig.isBuilder||window.jimuConfig.isSite)return null;if(MI("jimu-layouts/layout-runtime")){const e=MI("jimu-layouts/layout-runtime").A11ySkip;return(0,sg.jsx)(e,{})}return console.error("Please init jimu-layouts."),null}getPageRenderClass(){return MI(this.getLayoutEntryPath())?MI(this.getLayoutEntryPath()).PageRenderer:(console.error("Please init jimu-layouts."),null)}getJimuUI(){return MI("jimu-ui")?MI("jimu-ui"):(console.error("Please init jimu-ui."),null)}componentDidMount(){if(eL.getInstance({intl:this.props.intl}).loadAppConfig().then(e=>(this.props.dispatch(yA(e)),window.jimuConfig.isInBuilder&&MI("jimu-for-builder").appBuilderSync.publishAppStateChangeToBuilder(),e)).then(e=>{const t=cI(this.props.queryObject,e);return Object.keys(t).forEach(e=>{this.props.dispatch(UD(e,t[e]))}),this.props.dispatch(ID(this.getPageId())),this.addA11yKeyboardEvent(e,this.props.queryObject),e}).then(e=>(this.loadPreloadWidgets(e).then(()=>{bw(),window.jimuConfig.isInBuilder&&(window.parent.isExpressBuilder&&this.selectMapWidget(e),mA.getInstance().createAllDataSourcesByTime())}).catch(e=>{console.error("Initializing theme manager failed.",e),this.props.dispatch(HD({type:ul.AppError,message:(null==e?void 0:e.message)||"",name:"ArcGISAuthError"===(null==e?void 0:e.name)?e.name:"CommonError",code:null==e?void 0:e.message}))}),e)).then(e=>{var t,n;const r="true"===(null===(t=this.props.queryObject)||void 0===t?void 0:t.draft)||"1"===(null===(n=this.props.queryObject)||void 0===n?void 0:n.draft);return!window.jimuConfig.isInBuilder&&e.analytics&&e.analytics.enable&&!r&&o$.getInstance().initialize(null==e?void 0:e.analytics).then(e=>{e.logPageView()}),e}).catch(e=>{console.error("Load app config error.",e),TE().getState().user&&(null==e?void 0:e.message)===cl.AppNotExisted||this.props.dispatch(HD({type:ul.AppError,message:(null==e?void 0:e.message)||"",name:"ArcGISAuthError"===(null==e?void 0:e.name)?e.name:"CommonError",code:null==e?void 0:e.message}))}),this.props.queryObject.oauth_error_code){let e;switch(this.props.queryObject.oauth_error_code){case"OAUTH_0020":e=cl.OAuthPublicUserLimit;break;case"OAUTH_0033":e=cl.OAuthAppLicenceLimit;break;default:e=cl.OAuthOthers}this.props.dispatch(HD({type:ul.OAuthError,code:e}))}}componentWillUnmount(){const e=document.getElementById("jimu-base-style");e&&e.remove()}selectMapWidget(e){const t=this.getPageId();if(!e.pages[t])return;const n=MI("jimu-layouts/layout-runtime"),r=n.searchUtils.getMapWidgets(e,e.mainSizeMode,Vh.Page,t);if(0===r.length||0===r[0].maps.length)return;const i=r[0].maps[0];if(!e.widgets[i])return;const o=n.searchUtils.getLayoutInfosHoldContent(e,$v.Widget,i,e.mainSizeMode);0!==o.length&&this.props.dispatch(CD(o[0]))}loadPreloadWidgets(e){return b$(this,void 0,void 0,function*(){var t;const n=[],r=(null===(t=e.preloadWidgets)||void 0===t?void 0:t.asMutable())||[];return Object.keys(e.widgets).forEach(t=>{const i=e.widgets[t];n.includes(i.uri)&&!r.includes(i.uri)&&r.push(i.uri)}),0===r.length?(this.setState({preloadWidgetsLoaded:!0}),Promise.resolve()):Promise.all(r.map(e=>b$(this,void 0,void 0,function*(){return yield vb.getInstance().loadWidgetClassByUri(e)}))).then(()=>{this.setState({preloadWidgetsLoaded:!0})})})}componentDidUpdate(){var e,t,n,r;const i=this.getPageId();let o=this.state.pageStatus;i&&!o[i]&&(Object.keys(o).forEach(e=>{o=o.set(e,!1)}),this.setState({pageStatus:o.set(i,!0)})),!this.props.appConfigLoaded||i||this.props.systemError?this.props.appConfigLoaded&&i&&(null===(e=this.props.systemError)||void 0===e?void 0:e.code)===cl.AppPage404&&this.props.dispatch(zD(ul.AppError)):(this.props.dispatch(HD({type:ul.AppError,code:cl.AppPage404})),console.error("No page to render, display 404 page.")),this.props.appConfigLoaded&&(null===(t=this.props.noPermissionPages)||void 0===t?void 0:t.some(e=>e.id===i))&&!this.props.systemError?(this.props.dispatch(HD({type:ul.PrivilegeError,code:cl.PrivilegeInvalidPagePermission,message:this.props.intl.formatMessage({id:"pageRestrictionError",defaultMessage:Xg.pageRestrictionError})})),console.error("no permission to access this page.")):this.props.appConfigLoaded&&!(null===(n=this.props.noPermissionPages)||void 0===n?void 0:n.some(e=>e.id===i))&&(null===(r=this.props.systemError)||void 0===r?void 0:r.code)===cl.PrivilegeInvalidPagePermission&&this.props.dispatch(zD(ul.PrivilegeError))}addA11yKeyboardEvent(e,t){if(window.jimuConfig.isInBuilder){const e=document.body;e.setAttribute("tabindex","0"),e.style.outlineOffset="-2px",e.addEventListener("keydown",e=>{if(("BODY"===e.target.tagName||e.target.classList.contains("app-dialog-modal"))&&"Tab"===e.key&&!e.shiftKey&&TE().getState().appRuntimeInfo.appMode===ka.Design){e.preventDefault();k_(window.parent.document.querySelector("div.builder-dynamic-setting .jimu-btn"),!0)}})}else{const n=Vw();if(!window.jimuConfig.isBuilder&&window.location!==(null==n?void 0:n.location)&&"true"===(null==t?void 0:t.disable_window_focus)&&e.dialogs){const e=document.body;e.setAttribute("tabindex","0"),e.addEventListener("focus",t=>{if("BODY"===t.target.tagName){e.setAttribute("tabindex","-1");const n=document.querySelectorAll(".app-dialog-modal");n.length&&(t.preventDefault(),k_(n[n.length-1],!0))}})}}}getPageId(){var e,t,n;if(!this.props.pages)return null;const r=dI();if(r.pageId&&this.props.pages[r.pageId])return r.pageId;if(r.pageId&&(null===(e=this.props.noPermissionPages)||void 0===e?void 0:e.some(e=>e.id===r.pageId)))return r.pageId;if(r.pageId)return null;return Object.keys(this.props.pages).find(e=>this.props.pages[e].isDefault)||(null===(n=null===(t=this.props.noPermissionPages)||void 0===t?void 0:t.find(e=>e.isDefault))||void 0===n?void 0:n.id)}getDialogId(){return this.props.dialogJson&&(window.jimuConfig.isInBuilder||this.props.dialogJson.mode!==Kh.Anchored)?window.jimuConfig.isInBuilder&&this.props.dialogJson.mode===Kh.Anchored&&this.props.currentDialogId&&this.props.currentDialogId!==gI(this.props.queryObject.dlg,TE().getState().appConfig)?null:this.props.dialogJson.id:null}render(){const{pageStatus:e}=this.state,t=this.getPageRenderClass(),n=this.getJimuUI();if(this.props.systemError)return bw(),this.renderSystemError();if(!this.props.appConfigLoaded||!t||!this.state.preloadWidgetsLoaded||wd(this.props.themeVariables,{}))return null;const r=this.getPageId();if(!r)return console.error("No page to render."),null;if(!this.props.pages[r])return console.error("Invalid page id.",r),null;if(this.props.pages[r].type===qh.Folder)return console.error("This is a folder."),null;if(this.props.pages[r].linkUrl)return LI(this.props.pages[r].linkUrl),null;const i=n.Loading;return(0,sg.jsxs)(F.Fragment,{children:[(0,sg.jsx)(HB,{}),(0,sg.jsx)(zB,{themeVariables:this.props.themeVariables}),(0,sg.jsx)(n$,{}),(0,sg.jsx)(s$,{}),this.renderSetClientIdAlert(this.props.themeVariables),this.renderVersionRemind(),(0,sg.jsx)(m$,{noPermissionResourceChangedFlag:this.props.noPermissionResourceChangedFlag,theme:this.props.themeVariables,intl:this.props.intl,allowIgnore:!0}),qS.isSupportLocalState()&&(0,sg.jsx)(S$,{}),this.renderGuideRenderer(),this.getA11ySkip(),(0,sg.jsx)(t,{pageStatus:e,dialogId:this.getDialogId()}),(0,sg.jsx)("div",{id:"jimu-overlays-container"}),this.getKeyboardComponent(),i&&this.props.isBusy&&(0,sg.jsx)(i,{type:this.props.loadingType,text:this.props.loadingText}),this.renderCookieBanner(this.props.themeVariables),this.renderArcadeProfileVariableManagerComponent()]})}renderSystemError(){return(0,sg.jsx)(XB,{systemError:this.props.systemError,queryObject:this.props.queryObject,theme:this.props.themeVariables,intl:this.props.intl})}renderSetClientIdAlert(e){const t=this.props.portalsNeedToRegisterClientId&&this.props.portalsNeedToRegisterClientId[0];return window.jimuConfig.isBuilder&&(null==t?void 0:t.portalUrl)&&(0,sg.jsx)(l$,{portalInfo:t,theme:e,intl:this.props.intl})}}const E$=Ly(Ue(e=>{var t,n,r;return e.appConfig?{appConfigLoaded:!0,customTheme:e.appConfig.customTheme,pages:e.appConfig.pages,appPath:e.appPath,queryObject:e.queryObject,isRTL:e.appContext.isRTL,isBusy:e.appRuntimeInfo.isBusy,loadingType:e.appRuntimeInfo.loadingType,loadingText:e.appRuntimeInfo.loadingText,dialogJson:e.appConfig.dialogs?e.appConfig.dialogs[gI(e.queryObject.dlg,e.appConfig)]:null,currentDialogId:e.appRuntimeInfo.currentDialogId,portalsNeedToRegisterClientId:e.portalsNeedToRegisterClientId,noPermissionResourceChangedFlag:e.noPermissionResourceChangedFlag,systemError:e.systemError,appConfigVersion:null===(t=e.appConfig)||void 0===t?void 0:t.exbVersion,noPermissionPages:e.appRuntimeInfo.noPermissionPages,enableA11yForWidgetSettings:null!==(r=null===(n=e.appConfig.attributes)||void 0===n?void 0:n.enableA11yForWidgetSettings)&&void 0!==r&&r}:{appConfigLoaded:!1,customTheme:null,pages:null,appPath:e.appPath,queryObject:e.queryObject,isRTL:e.appContext.isRTL,loadingType:null,loadingText:null,isBusy:e.appRuntimeInfo.isBusy,dialogJson:null,currentDialogId:null,portalsNeedToRegisterClientId:e.portalsNeedToRegisterClientId,noPermissionResourceChangedFlag:e.noPermissionResourceChangedFlag,systemError:e.systemError,appConfigVersion:null,noPermissionPages:Ye([]),enableA11yForWidgetSettings:!1}})(e=>{var t,n;const r=null===(n=null===(t=Mw())||void 0===t?void 0:t.useTheme)||void 0===n?void 0:n.call(t,!1);return(0,sg.jsx)(I$,Object.assign({},e,{themeVariables:r}))}));class O$ extends F.Component{constructor(e){super(e),this.state={error:null}}componentDidCatch(e,t){this.setState({error:e})}render(){return this.state.error?this.props.fallback?this.props.fallback:(0,sg.jsx)("h1",{children:this.state.error.message}):this.props.children}}const C$=Ue(e=>({locale:e.appContext.locale,defaultLocale:e.appContext.locale,messages:e.appI18nMessages}))(Ny);function T$(){const e=F.useMemo(()=>{var e;return null===(e=Mw())||void 0===e?void 0:e.ThemeManager},[]),t=F.useMemo(()=>{var e;return null===(e=Nw())||void 0===e?void 0:e.NotificationProvider},[]);return(0,sg.jsx)(Fe,{store:TE(),children:(0,sg.jsx)(O$,{children:(0,sg.jsx)(QS,{children:(0,sg.jsx)(C$,{children:(0,sg.jsx)(e,{children:(0,sg.jsx)(U_,{children:(0,sg.jsx)(t,{maxNotification:10,children:(0,sg.jsx)(rM,{features:vB,children:(0,sg.jsx)(E$,{})})})})})})})})})}class x$ extends F.PureComponent{constructor(){super(...arguments),this.handleDataSourceCreated=()=>{const{onDataSourceCreated:e=()=>null}=this.props;e(this.getDataSources())},this.handleDataSourceInfoChange=()=>{const{onDataSourceInfoChange:e=()=>null}=this.props;e(this.getDataSourcesInfo())},this.getDataSources=()=>{const{useDataSources:e=[]}=this.props,t={},n=mA.getInstance();return e.forEach(e=>{t[e.dataSourceId]=n.getDataSource(e.dataSourceId)}),t},this.getDataSourcesInfo=()=>{const{useDataSources:e=[]}=this.props,t={};return e.forEach(e=>{t[e.dataSourceId]=this.props[e.dataSourceId]}),t},this.MemoDataSourceComponents=F.memo(({useDataSources:e,queries:t,widgetId:n,localId:r})=>e?(0,sg.jsx)(sg.Fragment,{children:e.asMutable().map((e,i)=>(0,sg.jsx)(RB,{useDataSource:e,query:null==t?void 0:t[e.dataSourceId],widgetId:n,localId:r,onDataSourceCreated:this.handleDataSourceCreated,onDataSourceInfoChange:this.handleDataSourceInfoChange},i))}):null)}render(){const{useDataSources:e,queries:t,widgetId:n,localId:r,children:i}=this.props,o=this.MemoDataSourceComponents,s=(0,sg.jsx)(o,{useDataSources:e,queries:t,widgetId:n,localId:r});return i?(0,sg.jsxs)(sg.Fragment,{children:[s,"function"==typeof i?i(this.getDataSources(),this.getDataSourcesInfo()):i]}):s}}const A$=Ue((e,t)=>{const n={},r=window.jimuConfig.isBuilder?e.appStateInBuilder:e;return t.useDataSources&&t.useDataSources.forEach(e=>{var i,o;const s=_T(e,t.localId);[Ya.CreateError,Ya.Created].includes(null===(o=null===(i=r.dataSourcesInfo)||void 0===i?void 0:i[s])||void 0===o?void 0:o.instanceStatus)&&(n[s]=r.dataSourcesInfo[s])}),n})(x$);const D$=Ly(function(e){const t=e.usedForArcadeEditor,n=e.onProfileContextChange,r=e.repeatedDataSource,[i,o]=F.useState(null),s=F.useRef(0);return F.useEffect(()=>{var e;if(n){const t=null===(e=null==i?void 0:i.profileVariableInstances)||void 0===e?void 0:e.$feature;n(i,!!t)}},[i,n]),F.useEffect(()=>{s.current++;const e=s.current;LB(t,r).then(t=>{e===s.current&&o(t)}).catch(e=>{console.error("createFeatureProfileContext error",e)})},[t,r]),(0,sg.jsx)("div",{className:"feature-profile-context-provider d-none"})});let R$=0;const P$=Ly(Vy(function(e){var t;const n=e.usedForArcadeEditor,r=e.onProfileContextChange,i=e.widgetId,o=e.useDataSources,s=F.useMemo(()=>{const e=[];return o&&o.length>0&&o.forEach(t=>{e.push(t)}),e},[o]),a=F.useMemo(()=>{const e=[];return s.forEach(t=>{const n=null==t?void 0:t.dataSourceId;n&&e.push(n)}),e},[s]),l=F.useRef(null);l.current=a;const u=F.useRef(null);u.current=e.onDirty;const c=F.useRef(null);if(!c.current){R$++;const e=(null===(t=window.jimuConfig)||void 0===t?void 0:t.isBuilder)?"builder":"app",n=Math.random().toString().slice(2);c.current=`${e}_${i}_ds_profile_context_provider_${R$}_${n}`}const[d,p]=F.useState({}),f=F.useMemo(()=>{if(!s.every(e=>{const t=null==e?void 0:e.dataSourceId;return!t||t in d}))return null;const e={};Object.keys(d).forEach(t=>{const n=d[t],r=null==n?void 0:n.profileVariableInstances;r&&(e[t]=r)});const t=Object.keys(e),r=function(e,t){const n={variables:[{name:"$dataSources",type:"dictionary",properties:t.map(e=>_B(e))}]};return e&&(n.bundles=["core","data-access"]),n}(n,t),i=gA.getInstance(),o=jB(t.map(e=>i.getDataSource(e)));return{type:eP.DataSourcesProfile,profile:r,profileVariableInstances:{$dataSources:e},timeZone:o}},[d,s,n]);F.useEffect(()=>{var e;if(r){let t=!1;const n=l.current||[];if(n.length>0){const r=null===(e=null==f?void 0:f.profileVariableInstances)||void 0===e?void 0:e.$dataSources;r&&(t=n.every(e=>e in r))}else t=!0;r(f,t)}},[r,f]);const h=F.useCallback((e,t)=>{p(n=>Object.assign({},n,{[e]:t}))},[]),g=F.useCallback((e,t)=>{const n=gA.getInstance().getDataSource(e);let r=null;n&&FB(n)&&(r={dataSource:n,profileVariableInstances:t}),h(e,r)},[h]),m=F.useRef(null);m.current=g,F.useEffect(()=>{const e=c.current,t=[],n=[];o&&o.length>0&&o.forEach(e=>{var r;const i=null===(r=null==e?void 0:e.asMutable)||void 0===r?void 0:r.call(e,{deep:!0});if(i){t.push(i);const e=i.dataSourceId;e&&n.push(e)}});const r=VB.getInstance(),i=(e,t)=>{m.current(e,t)},s=e=>{u.current&&u.current()};p(o=>{let a=o||{};const l=Object.keys(o).filter(e=>!n.includes(e));return l.length>0&&(a=Object.assign({},o),l.forEach(e=>{delete a[e]})),setTimeout(()=>{r.registerResolverComponent(e,t,i,s)},100),a})},[o]),c_(()=>{const e=c.current;VB.getInstance().unregisterResolverComponent(e)});const v=F.useMemo(()=>s.map(e=>(0,sg.jsx)(DB,{widgetId:i,useDataSource:e},null==e?void 0:e.dataSourceId)),[s,i]);return(0,sg.jsx)("div",{className:"datasources-profile-context-provider d-none",children:v})}));const j$=Ly(Vy(function(e){const t=e.usedForArcadeEditor,n=e.onProfileContextChange,r=e.onDirty,i=e.widgetId,o=e.useDataSources,s=F.useMemo(()=>o||Xe()([]),[o]),a=e.repeatedDataSource,l=F.useMemo(()=>{var e;const n=!!(null===(e=window.jimuConfig)||void 0===e?void 0:e.isBuilder);return t&&n&&nP(i)},[t,i]),u=F.useMemo(()=>{let e="";if(a)e=a.dataSourceId;else if(l){const t=rP(i);t&&(e=t.dataSourceId)}return e||(e=""),e},[l,a,i]),[c,d]=F.useState();F.useEffect(()=>{if(l&&u){const e=mA.getInstance().getDataSource(u);(null==e?void 0:e.query)&&e.query({page:1,pageSize:1,outFields:["*"],returnGeometry:!0}).then(e=>{var t;if((null===(t=null==e?void 0:e.records)||void 0===t?void 0:t.length)>0){const t=null==e?void 0:e.records[0];d(t)}else d(null)}).catch(e=>{console.error("ds.query() error in ArcadeProfileContextProvider",e),d(null)})}},[u,l]);const p=F.useMemo(()=>{let e=null;if(a)e=a;else if(l){e={widgetId:i,dataSourceId:u,recordIndex:1,record:c||{fake:!0}}}return e},[u,c,l,a,i]),f=p?eP.FeatureProfile:eP.DataSourcesProfile,h=f===eP.FeatureProfile,g=f===eP.DataSourcesProfile,m=F.useCallback((e,t)=>{n&&n(e,t)},[n]);return(0,sg.jsxs)("div",{className:"arcade-profile-context-provider d-none",children:[h&&(0,sg.jsx)(D$,{usedForArcadeEditor:t,repeatedDataSource:p,onProfileContextChange:m}),g&&(0,sg.jsx)(P$,{usedForArcadeEditor:t,widgetId:i,useDataSources:s,onProfileContextChange:m,onDirty:r})]})}));var L$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const _$={};let M$=0;const N$={};function k$(e){if(!e)return!1;if("object"!=typeof e||null===e)return!1;if(e.declaredClass)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}function U$(e){return null==e||"string"==typeof e||"number"==typeof e||e instanceof Date}const F$=Ly(Vy(function(e){const t=e.onChange,n=e.onLoading,r=e.onLoaded,i=F.useRef(null);i.current=r;const o=F.useRef(null);o.current=t;const s=e.capabilities,a=F.useMemo(()=>{let e=(null==s?void 0:s.length)>0?s.slice():[JR.Value,JR.Style];const t=e.join()||"null",n=N$[t];return n?e=n:N$[t]=e,e},[s]),l=e.widgetId,u=e.useDataSources,c=F.useMemo(()=>u||Xe()([]),[u]),d=e.config,[p,f]=F.useState(d),h=F.useRef(null);h.current=p,F.useEffect(()=>{var e,t,n;const r=(null===(t=null===(e=h.current)||void 0===e?void 0:e.asMutable)||void 0===t?void 0:t.call(e,{deep:!0}))||null,i=(null===(n=null==d?void 0:d.asMutable)||void 0===n?void 0:n.call(d,{deep:!0}))||null;if(i!==r){wd(r,i)||f(d)}},[d]);const g=F.useRef(null);g.current||(M$++,g.current=`${l}_${M$}`);const[m,v]=F.useState(null),y=F.useRef(!1),S=F.useRef(null),b=F.useRef(0),w=F.useRef("initial");c_(()=>{const e=g.current;e&&delete _$[e]});const I=F.useCallback(()=>{n&&"loading"!==w.current&&n(),w.current="loading"},[n]),E=F.useRef(null);E.current=I;const O=F.useCallback((e,t)=>{y.current=t,v(e)},[]);return F.useEffect(()=>{b.current++;const e=b.current;E.current&&E.current(),function(e,t,n,r){return L$(this,void 0,void 0,function*(){let i=null,o=!0;try{const o=null==r?void 0:r.scriptContent,s=null==r?void 0:r.icons,a=null==t?void 0:t.profile,l=null==t?void 0:t.profileVariableInstances,u=(null==t?void 0:t.timeZone)||"system";if(o&&a){const t=yield function(e,t,n){return L$(this,void 0,void 0,function*(){if(!t||!n)return null;const r=_$[e];if(r){const e=r.arcadeScript,i=r.profile;if(e&&i){const o=t===e,s=n===i||wd(n,i);if(o&&s)return r.promise}}const i={arcadeScript:t,profile:n,promise:null};return _$[e]=i,i.promise=function(e,t){return L$(this,void 0,void 0,function*(){const n=yield Bg("esri/arcade");return yield n.createArcadeExecutor(e,t)})}(t,n),i.promise})}(e,o,a);if(t&&l){const e={timeZone:u};i=function(e,t,n){let r=null;const i=t.includes(JR.Value),o=t.includes(JR.Style);if(null==e)r=null;else if(k$(e)){const t=e.value;delete e.value;const s=o?QR:[],a=pP(e,(i?XR:[]).concat(s)).validValue;if(r=a||{},i){(U$(t)?t:null)&&(r.value=t)}if(k$(r.background)){const e=function(e,t){var n;let r=null;if(e){r={},e.color&&(r.color=e.color),e.fillType&&(r.fillType=e.fillType);const i=e.image;if(i){let e="";const o=i.toLocaleLowerCase();if(0===o.indexOf("http://")||0===o.indexOf("https://"))e=i;else if((null==t?void 0:t.length)>0){const r=t.find(e=>(null==e?void 0:e.name)===i);e=null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.svg}e&&(r.image={url:e,originalUrl:e})}0===Object.keys(r).length&&(r=null)}return r}(a.background,n);r.background=e}if(k$(r.icon)){const e=function(e,t){let n=null;if(e){n={},e.position&&(n.position=e.position),e.color&&(n.color=e.color),"number"==typeof e.size&&(n.size=e.size);const r=e.name;if(r&&(null==t?void 0:t.length)>0){const e=t.find(e=>(null==e?void 0:e.name)===r);e&&e.data&&(n.data=e.data)}0===Object.keys(n).length&&(n=null)}return n}(a.icon,n);r.icon=e}if(k$(r.text)){const e=function(e){let t=null;if(e){t=e;const n=e.size;"number"==typeof n?t.size=`${n}px`:delete t.size}return t}(a.text);r.text=e}if(k$(r.border)){const e=function(e){function t(e){e&&k$(e)&&"number"==typeof e.width&&(e.width=`${e.width}px`)}if(e){const{border:n,borderLeft:r,borderRight:i,borderTop:o,borderBottom:s}=e;n&&t(n),r&&t(r),i&&t(i),o&&t(o),s&&t(s)}return e}(r.border);r.border=e}}else r=i&&U$(e)?{value:e}:null;r||(r={});return r}(yield t.executeAsync(l,e),n,s)}}}catch(e){o=!1,console.warn("resolveArcadeContent error",e)}i||(i={});return{success:o,arcadeContent:Xe()(i)}})}(g.current,m,a,p).then(t=>{var n,r,s;w.current="loaded";const a=t.success,l=t.arcadeContent;if(e===b.current){const e=null!==(r=null===(n=S.current)||void 0===n?void 0:n.asMutable({deep:!0}))&&void 0!==r?r:null,u=null!==(s=null==l?void 0:l.asMutable({deep:!0}))&&void 0!==s?s:null;S.current=l;wd(e,u)||o.current&&o.current(l),i.current&&(a||y.current)&&i.current(t)}}).catch(e=>{w.current="loaded",console.warn("resolveArcadeContent error",e)})},[a,p,m]),(0,sg.jsx)("div",{className:"arcade-content-resolver-component d-none",children:(0,sg.jsx)(j$,{usedForArcadeEditor:!1,widgetId:l,useDataSources:c,onProfileContextChange:O,onDirty:I})})}));var B$,$$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};!function(e){e.Failed="RESOLVE_FAILED",e.NotMatched="DATA_SOURCES_IN_EXPRESSION_CANNOT_MATCH_DATA_SOURCES_IN_USE"}(B$||(B$={}));class V$ extends F.PureComponent{constructor(e){super(e),this.__unmount=!1,this.__resolveCount=1,this.getWhetherExpressionsAreSame=(e,t)=>wd(e,t),this.getWhetherDsInfosAreSame=(e,t,n)=>{if(!n)return!0;if(e||t){if(e&&t){if(Object.keys(e).length!==Object.keys(t).length)return!1;{const r=this.getUseSelectionDsIdsFromExpression(n).map(e=>{var t;return null===(t=mA.getInstance().getDataSource(e))||void 0===t?void 0:t.getMainDataSource()});return!Object.keys(e).some(n=>{var i,o;const s=mA.getInstance().getDataSource(n);return!(s&&r.some(e=>(null==e?void 0:e.id)===s.getMainDataSource().id)?wd(e[n],t[n]):wd(null===(i=e[n])||void 0===i?void 0:i.without("selectedIds"),null===(o=t[n])||void 0===o?void 0:o.without("selectedIds")))})}}return!1}return!0},this.getUseSelectionDsIdsFromExpression=e=>{const t=this.getWhetherIsMultipleExpression(e);let n=[];if(!e)return n;if(t){const t=e;Object.keys(t).forEach(e=>{n=n.concat(this.getUseSelectionDsIdsFromSingleExpression(t[e]))})}else n=n.concat(this.getUseSelectionDsIdsFromSingleExpression(e));return Array.from(new Set(n))},this.getUseSelectionDsIdsFromSingleExpression=e=>{let t=[];return e&&e.parts?(e.parts.forEach(e=>{YT(null==e?void 0:e.dataSourceId)&&(t=t.concat(e.dataSourceId))}),Array.from(new Set(t))):t},this.getWhetherUseDssAreSame=(e,t)=>!e&&!t||!(!e||!t)&&(e.length===t.length&&!e.some((n,r)=>{var i,o;return!wd(null===(i=e[r])||void 0===i?void 0:i.without("fields"),null===(o=t[r])||void 0===o?void 0:o.without("fields"))})),this.getWhetherIsMultipleExpression=e=>!!e&&!(Object.keys(e).includes("name")&&Object.keys(e).includes("parts")&&Array.isArray(e.parts)),this.resolveExpressions=(e,t,n,r,i)=>{var o,s;if(!e)return Promise.resolve("");null===(s=(o=this.props).onLoading)||void 0===s||s.call(o);if(this.getWhetherIsMultipleExpression(e)){const o=e;Object.keys(o).forEach(e=>{this.resolveSingleExpression(o[e],t,n,i).then(t=>{if(!this.__unmount&&r===this.__resolveCount)if(i){const n=this.resultsCache;this.resultsCache=Object.assign(Object.assign({},n),{[e]:{isSuccessful:!0,value:t}}),this.setState({results:this.resultsCache})}else{const n=this.originResultsCache;this.originResultsCache=Object.assign(Object.assign({},n),{[e]:{isSuccessful:!0,value:t}}),this.setState({originResults:this.originResultsCache})}}).catch(t=>{const n=i?this.resultsCache:this.originResultsCache;this.__unmount||r!==this.__resolveCount||(i?(this.resultsCache=Object.assign(Object.assign({},n),{[e]:{isSuccessful:!1,value:"string"==typeof t?t:null==t?void 0:t.message}}),this.setState({results:this.resultsCache})):(this.originResultsCache=Object.assign(Object.assign({},n),{[e]:{isSuccessful:!1,value:"string"==typeof t?t:null==t?void 0:t.message}}),this.setState({originResults:this.originResultsCache})))})})}else this.resolveSingleExpression(e,t,n,i).then(e=>{this.__unmount||r!==this.__resolveCount||(i?(this.resultsCache={isSuccessful:!0,value:e},this.setState({results:this.resultsCache})):(this.originResultsCache={isSuccessful:!0,value:e},this.setState({originResults:this.originResultsCache})))}).catch(e=>{this.__unmount||r!==this.__resolveCount||(i?(this.resultsCache={isSuccessful:!1,value:"string"==typeof e?e:null==e?void 0:e.message},this.setState({results:this.resultsCache})):(this.originResultsCache={isSuccessful:!1,value:"string"==typeof e?e:null==e?void 0:e.message},this.setState({originResults:this.originResultsCache})))})},this.resolveSingleExpression=(e,t,n,r)=>{const i=this.getWhetherExpressionDssInUseDss(e,t),o=n&&this.getWhetherExpressionDssInRecords(e,n);return i||o?YR(e,n,this.props.repeatedDataSource,r).catch(e=>$$(this,void 0,void 0,function*(){return yield Promise.reject(new Error(B$.Failed))})):Promise.reject(new Error(B$.NotMatched))},this.onDataSourceCreated=e=>{if(e){const t={};Object.keys(e).forEach(n=>{n&&e[n]&&(t[n]=e[n].getInfo())}),this.setState({infos:t})}},this.onDataSourceInfoChange=e=>{this.getWhetherDsInfosAreSame(e,this.state.infos,this.props.expression)||this.setState({infos:e})},this.getWhetherExpressionDssInUseDss=(e,t)=>!e||!e.parts||!e.parts.some(e=>e&&e.dataSourceId&&!this.getWhetherDsIdInUseDss(e.dataSourceId,t)),this.getWhetherDsIdInUseDss=(e,t)=>{if(!e)return!1;if(e.split("-").reverse()[0]===Ad){const n=e.replace(/-dataView_\d{1,}/,"").replace(`-${Ad}`,"");return null==t?void 0:t.some(e=>e.mainDataSourceId===n)}return null==t?void 0:t.some(t=>t.dataSourceId===e)},this.getWhetherExpressionDssInRecords=(e,t)=>!e||!e.parts||!e.parts.some(e=>(null==e?void 0:e.dataSourceId)&&!(null==t?void 0:t[e.dataSourceId])),this.getLocalDataSources=e=>{let t=Ye([]);return e&&0!==e.length?(e.forEach(e=>{const n=mA.getInstance().getDataSource(e.dataSourceId);n&&n.getAllDerivedDataSources().forEach(e=>{var r;if((null==e?void 0:e.isLocal)&&(null===(r=null==e?void 0:e.id)||void 0===r?void 0:r.includes(`${n.id}-${ER}`))){const n=e.getRootDataSource(),r=e.getMainDataSource();t=t.concat({dataSourceId:e.id,rootDataSourceId:n&&n.id,mainDataSourceId:r&&r.id,dataViewId:e.dataViewId})}})}),t):t},this.getQueries=(e,t)=>{const n={};if(!e||!t)return n;const r=this.getWhetherIsMultipleExpression(t)?Object.values(t):[t];let i=[];r.forEach(e=>{var t;(null===(t=null==e?void 0:e.parts)||void 0===t?void 0:t.length)>0&&(i=i.concat(GR(e.parts)))});return e.filter(e=>!!e).filter(e=>e.dataViewId!==Ad&&i.some(t=>t.dataSourceId===e.dataSourceId&&t.type===yR.Field&&!t.isFromRepeatedDataSourceContext)).forEach(e=>{n[e.dataSourceId]={}}),n},this.onArcadeResolveValueChange=e=>{if(null!=(null==e?void 0:e.value))if(this.props.onOriginResolveValueChange)this.setState({originResults:{isSuccessful:!0,value:e.value.asMutable?e.value.asMutable():e.value}});else{const t=typeof e.value,n="string"===t?e.value:"number"===t?e.value+"":this.props.intl.formatDate(e.value,{dateStyle:"short",timeStyle:"short"});this.setState({results:{isSuccessful:!0,value:n}})}else this.props.onOriginResolveValueChange?this.setState({originResults:{isSuccessful:!1,value:B$.Failed}}):this.setState({results:{isSuccessful:!1,value:B$.Failed}})};const t=DP(e.expression);this.state={results:null,originResults:null,infos:null,isArcade:t,allUseDataSources:this.props.useDataSources&&!t?this.getAllUseDataSources(this.props.useDataSources,this.props.expression):this.props.useDataSources,queries:this.props.useDataSources&&!t?this.getQueries(this.props.useDataSources,this.props.expression):null,arcadeConfig:t?UP(this.props.expression):null}}componentDidMount(){this.__unmount=!1,this.state.isArcade||this.resolveExpressions(this.props.expression,this.props.useDataSources,this.props.records,this.__resolveCount,!this.props.onOriginResolveValueChange)}componentWillUnmount(){this.__unmount=!0}componentDidUpdate(e,t){var n,r,i;const o=this.getWhetherExpressionsAreSame(this.props.expression,e.expression);if(!o){const e=DP(this.props.expression);this.setState({isArcade:e,arcadeConfig:e?UP(this.props.expression):null})}if(this.props.onChange&&t.results!==this.state.results&&null!==this.state.results){this.props.onChange(this.state.results);const e=null===(r=(null===(n=null===window||void 0===window?void 0:window.jimuConfig)||void 0===n?void 0:n.isBuilder)?TE().getState().appStateInBuilder:TE().getState())||void 0===r?void 0:r.dataSourcesInfo;if(this.props.onLoaded&&!(null===(i=this.state.allUseDataSources)||void 0===i?void 0:i.some(t=>{var n,r;return![Ya.Created,Ya.CreateError].includes(null===(n=null==e?void 0:e[t.dataSourceId])||void 0===n?void 0:n.instanceStatus)&&![Ya.CreateError].includes(null===(r=null==e?void 0:e[t.mainDataSourceId])||void 0===r?void 0:r.instanceStatus)}))){const e=this.getWhetherIsMultipleExpression(this.props.expression)?!Object.keys(this.props.expression).some(e=>!this.state.results[e]):!!this.state.results;e&&this.props.onLoaded()}}if(this.props.onOriginResolveValueChange&&t.originResults!==this.state.originResults&&null!==this.state.originResults&&this.props.onOriginResolveValueChange(this.state.originResults),!this.state.isArcade&&(this.state.infos===t.infos&&this.props.records===e.records&&o&&this.props.repeatedDataSource===e.repeatedDataSource&&this.getWhetherUseDssAreSame(this.props.useDataSources,e.useDataSources)||(this.__resolveCount++,this.resolveExpressions(this.props.expression,this.props.useDataSources,this.props.records,this.__resolveCount,!this.props.onOriginResolveValueChange)),this.props.useDataSources)){(this.getWhetherNewLocalDssCreated(this.props.onOriginResolveValueChange?t.originResults:t.results,this.props.onOriginResolveValueChange?this.state.originResults:this.state.results)||e.useDataSources!==this.props.useDataSources||e.expression!==this.props.expression)&&this.setState({allUseDataSources:this.getAllUseDataSources(this.props.useDataSources,this.props.expression)}),e.useDataSources===this.props.useDataSources&&e.expression===this.props.expression||this.setState({queries:this.getQueries(this.props.useDataSources,this.props.expression)})}}getWhetherNewLocalDssCreated(e,t){if(this.getWhetherIsMultipleExpression(this.props.expression)){const n=!e||Object.values(e).some(e=>"object"==typeof e&&!(null==e?void 0:e.isSuccessful)),r=t&&!Object.values(t).some(e=>"object"==typeof e&&!(null==e?void 0:e.isSuccessful));return n&&r}{const n=!e||!e.isSuccessful,r=t&&t.isSuccessful;return n&&r}}getAllUseDataSources(e,t){const n=this.getLocalDataSources(e);let r=n.length>0?e.concat(n):e;if(this.getWhetherIsMultipleExpression(t)){const e=t;Object.keys(e).forEach(t=>{r=this.updateUseDssByExpression(r,e[t])})}else r=this.updateUseDssByExpression(r,t);return r}updateUseDssByExpression(e,t){var n;if(!e||!t)return e;let r=e;return null===(n=t.parts)||void 0===n||n.forEach((e,n)=>{var i,o;if(YT(e.dataSourceId)&&!r.some(t=>t.dataSourceId===e.dataSourceId)){const t=r.find(t=>t.mainDataSourceId===e.dataSourceId.replace(new RegExp(`-${Ad}$`),""));t&&(r=r.concat(Ye(t).merge({dataSourceId:e.dataSourceId,dataViewId:Ad}).without("fields")))}if(e.type===yR.Function){const e=null===(i=t.parts[n+2])||void 0===i?void 0:i.dataSourceId,s=mA.getInstance().getDataSource(e),a=null==s?void 0:s.getMainDataSource(),l=a&&r.some(e=>e.dataSourceId===a.id);a&&!l&&(r=r.concat(Ye({dataSourceId:a.id,mainDataSourceId:a.id,rootDataSourceId:null===(o=a.getRootDataSource())||void 0===o?void 0:o.id})))}}),r}getLocalLoadId(){return"EXPRESSION_RESOLVER"}render(){if(!this.props.expression||!this.props.useDataSources&&!this.props.records)return null;const e=()=>"function"==typeof this.props.children?this.props.children(this.state.results):this.props.children;return this.props.records?(0,sg.jsx)("div",{children:e()}):(0,sg.jsxs)(sg.Fragment,{children:[(0,sg.jsx)(A$,{useDataSources:this.state.allUseDataSources,onDataSourceCreated:this.state.isArcade?void 0:this.onDataSourceCreated,onDataSourceInfoChange:this.state.isArcade?void 0:this.onDataSourceInfoChange,queries:this.state.queries,widgetId:this.getLocalLoadId(),children:e}),this.state.isArcade&&(0,sg.jsx)(F$,{widgetId:this.props.widgetId,useDataSources:this.props.useDataSources,capabilities:[JR.Value],config:this.state.arcadeConfig,onChange:this.onArcadeResolveValueChange,onLoading:this.props.onLoading,onLoaded:this.props.onLoaded})]})}}const G$=Ly(Vy(V$));var W$,H$;function z$(e){if(e){if(e===zP.UserInput||e===zP.Unique)return W$.ClauseValuePair;if(e===zP.Field||e===zP.Statistics)return W$.Expression}return null}!function(e){e.ClauseValuePair="ClauseValuePair",e.Expression="Expression"}(W$||(W$={})),function(e){e.Normal="Normal",e.Preview="Preview",e.None="None"}(H$||(H$={}));const q$="refValue";function J$(e){return!!(e&&e.expression&&e.expressionReturnType)}function K$(e){return`condition_${e}`}function Y$(e,t,n){var r;let i=null;const o=null==t?void 0:t.condition,s=z$(null==o?void 0:o.sourceType);if(o)if(s===W$.ClauseValuePair)i=null===(r=null==o?void 0:o.valueOptions)||void 0===r?void 0:r.value;else if(s===W$.Expression){const r=X$(e,n,K$(t.id));if(null!=r){const e=[{value:r,label:String(r)}];i=Ye(e)}}return i}function X$(e,t,n){let r=null;if(t&&n){const i=t[n];if(i&&i.isSuccessful){const t=i.value;"string"==typeof t&&e===_a.String?r=t:"number"==typeof t&&e===_a.Number&&(isNaN(t)||(r=t))}}return r}function Q$(e,t,n){var r,i;const o=Z$(e),s=e,a=t.operator,l=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.value,u=Z$(l),c=l,d=null===(i=null==n?void 0:n[1])||void 0===i?void 0:i.value;if(![HP.StringOperatorIsBlank,HP.StringOperatorIsNotBlank].includes(a)&&eV(n))return!1;let p=!1;return a===HP.StringOperatorIs?p=o===u:a===HP.StringOperatorIsNot?p=o!==u:a===HP.StringOperatorContains?p="string"==typeof o&&o.includes(u):a===HP.StringOperatorIsBlank?p=eV(o):a===HP.StringOperatorIsNotBlank?p=!eV(o):a===HP.NumberOperatorIs?p=s===c:a===HP.NumberOperatorIsNot?p=s!==c:a===HP.NumberOperatorIsGreaterThan?p=s>c:a===HP.NumberOperatorIsLessThan?p=s<c:a===HP.NumberOperatorIsBetween&&(p=s>=c&&s<=d),p}function Z$(e){return"string"==typeof e?e.toLowerCase():e}function eV(e){return null==e||""===e}const tV=Ly(Vy(function(e){const t=e.widgetId,n=e.useDataSources,r=e.repeatedDataSource,i=e.conditionStyleConfig,o=e.onChange,s=F.useRef(null);s.current=o;const a=null==i?void 0:i.refValueInfo,l=null==a?void 0:a.expression,u=null==i?void 0:i.items,c=F.useMemo(()=>{const e=[];return(null==u?void 0:u.length)>0&&u.forEach(t=>{const n=null==t?void 0:t.condition;if(n){aj(l,n)&&e.push(t)}}),Ye(e)},[u,l]),d=F.useMemo(()=>{const e={arcadeExpression:null,expressionMap:null},t={};return J$(a)&&(ZP(a.expression)?e.arcadeExpression=a.expression:t[q$]=a.expression),(null==c?void 0:c.length)>0&&c.forEach(e=>{var n;const r=null==e?void 0:e.condition;if(r){if(z$(null==r?void 0:r.sourceType)===W$.Expression){const i=null===(n=null==r?void 0:r.valueOptions)||void 0===n?void 0:n.expression;if(i){const n=K$(e.id);t[n]=i}}}}),Object.keys(t).length>=1?e.expressionMap=Ye(t):e.expressionMap=null,e},[a,c]),[p,f]=F.useState(),[h,g]=F.useState(),m=F.useCallback(e=>{f(e)},[]),v=F.useCallback(e=>{g(e)},[]),y=Je(e=>{var n;const i=(null===(n=window.jimuConfig)||void 0===n?void 0:n.isBuilder)?null==e?void 0:e.appStateInBuilder:e,o=function(e,t,n){var r,i,o,s;if(e){const a=null===(i=null===(r=e.previewConditionInfo)||void 0===r?void 0:r[t])||void 0===i?void 0:i.conditionId;if("number"==typeof a){if(!n)return{parseMode:H$.Preview,conditionId:a};{const t=n.widgetId;if(t){const r=null===(s=null===(o=e.previewRepeatedRecordInfo)||void 0===o?void 0:o[t])||void 0===s?void 0:s.recordIndex;if("number"==typeof r&&r>=0)return n.recordIndex===r?{parseMode:H$.Preview,conditionId:a}:{parseMode:H$.None,conditionId:a}}}}}return{parseMode:H$.Normal,conditionId:null}}(null==i?void 0:i.dynamicStyleState,t,r)||{parseMode:H$.Normal,conditionId:null},{parseMode:s,conditionId:a}=o;return`${s},${a}`}),S=!!((null==n?void 0:n.length)>0&&i&&d.arcadeExpression),b=!!((null==n?void 0:n.length)>0&&i&&d.expressionMap);return F.useEffect(()=>{const e={};b&&h&&Object.assign(e,h),S&&(e[q$]=p);let t=H$.Normal,n=null;if(y){const e=y.split(",");2===e.length&&(t=e[0],n=parseInt(e[1]))}const r=function(e,t,n,r,i,o){if(i===H$.Normal){const t=null==e?void 0:e.expressionReturnType;if(J$(e)&&t&&(null==n?void 0:n.length)>0){const e=function(e,t){const n=X$(e,t,q$);return n}(t,r);if(null==e)return null;for(let i=0;i<n.length;i++){const o=n[i];if(o){if(Q$(e,o.condition,Y$(t,o,r)))return o.style}}}}else if(i===H$.Preview){if((null==t?void 0:t.length)>0)for(let e=0;e<t.length;e++){const n=t[e];if(n){const e=n.id;if(!eV(e)&&e===o)return n.style}}}else if(i===H$.None)return null;return null}(a,u,c,e,t,n)||null;s.current&&s.current(r)},[u,p,h,y,a,S,b,c]),(0,sg.jsxs)("div",{className:"condition-style-resolver-component d-none",children:[S&&(0,sg.jsx)(G$,{widgetId:t,useDataSources:n,expression:d.arcadeExpression,onOriginResolveValueChange:m}),b&&(0,sg.jsx)(G$,{widgetId:t,useDataSources:n,expression:d.expressionMap,onOriginResolveValueChange:v})]})}));function nV(e){if(e&&"object"==typeof e)if(Array.isArray(e))e.forEach&&e.forEach(e=>{nV(e)});else{Object.keys(e).forEach(t=>{const n=e[t];""===n||null==n?delete e[t]:nV(n)})}}const rV=Ly(Vy(function(e){const t=e.widgetId,n=e.useDataSources,r=e.dynamicStyleConfig,i=e.onChange,o=(null==r?void 0:r.sourceType)===KP.Arcade,s=null==r?void 0:r.conditionConfig,a=null==r?void 0:r.arcadeConfig,l=F.useRef(null),u=F.useCallback(e=>{e?e.asMutable||(e=Ye(e)):e=Ye({});const t=e.asMutable({deep:!0});nV(t),e=Ye(t);const n=l.current||null;if(l.current=e,i){const r=(null==n?void 0:n.asMutable({deep:!0}))||null;wd(r,t)||i(e)}},[i]),c=F.useRef(null);c.current=u;const d=F.useCallback(e=>{u(e)},[u]),p=F.useCallback(e=>{u(e)},[u]),f=(null==n?void 0:n.length)>0&&!!r;return F.useEffect(()=>{if(c.current){const e=Ye({});c.current(e)}},[f]),(0,sg.jsxs)("div",{className:"dynamic-style-resolver d-none",children:[f&&o&&(0,sg.jsx)(F$,{capabilities:[JR.Style],widgetId:t,useDataSources:n,config:a,onChange:d}),f&&!o&&(0,sg.jsx)(tV,{widgetId:t,useDataSources:n,conditionStyleConfig:s,onChange:p})]})}));const iV=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n};const oV=function(e){return function(t){return null==e?void 0:e[t]}}({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"});var sV=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,aV=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");const lV=function(e){return(e=Uu(e))&&e.replace(sV,oV).replace(aV,"")};var uV=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;const cV=function(e){return e.match(uV)||[]};var dV=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;const pV=function(e){return dV.test(e)};var fV="\\ud800-\\udfff",hV="\\u2700-\\u27bf",gV="a-z\\xdf-\\xf6\\xf8-\\xff",mV="A-Z\\xc0-\\xd6\\xd8-\\xde",vV="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",yV="["+vV+"]",SV="\\d+",bV="["+hV+"]",wV="["+gV+"]",IV="[^"+fV+vV+SV+hV+gV+mV+"]",EV="(?:\\ud83c[\\udde6-\\uddff]){2}",OV="[\\ud800-\\udbff][\\udc00-\\udfff]",CV="["+mV+"]",TV="(?:"+wV+"|"+IV+")",xV="(?:"+CV+"|"+IV+")",AV="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",DV="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",RV="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",PV="[\\ufe0e\\ufe0f]?",jV=PV+RV+("(?:\\u200d(?:"+["[^"+fV+"]",EV,OV].join("|")+")"+PV+RV+")*"),LV="(?:"+[bV,EV,OV].join("|")+")"+jV,_V=RegExp([CV+"?"+wV+"+"+AV+"(?="+[yV,CV,"$"].join("|")+")",xV+"+"+DV+"(?="+[yV,CV+TV,"$"].join("|")+")",CV+"?"+TV+"+"+AV,CV+"+"+DV,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",SV,LV].join("|"),"g");const MV=function(e){return e.match(_V)||[]};const NV=function(e,t,n){return e=Uu(e),void 0===(t=n?void 0:t)?pV(e)?MV(e):cV(e):e.match(t)||[]};var kV=RegExp("['\u2019]","g");const UV=function(e){return function(t){return iV(NV(lV(t).replace(kV,"")),e,"")}};const FV=UV(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()});const BV=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};const $V=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:BV(e,t,n)};var VV=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");const GV=function(e){return VV.test(e)};const WV=function(e){return e.split("")};var HV="\\ud800-\\udfff",zV="["+HV+"]",qV="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",JV="\\ud83c[\\udffb-\\udfff]",KV="[^"+HV+"]",YV="(?:\\ud83c[\\udde6-\\uddff]){2}",XV="[\\ud800-\\udbff][\\udc00-\\udfff]",QV="(?:"+qV+"|"+JV+")"+"?",ZV="[\\ufe0e\\ufe0f]?",eG=ZV+QV+("(?:\\u200d(?:"+[KV,YV,XV].join("|")+")"+ZV+QV+")*"),tG="(?:"+[KV+qV+"?",qV,YV,XV,zV].join("|")+")",nG=RegExp(JV+"(?="+JV+")|"+tG+eG,"g");const rG=function(e){return e.match(nG)||[]};const iG=function(e){return GV(e)?rG(e):WV(e)};const oG=function(e){return function(t){t=Uu(t);var n=GV(t)?iG(t):void 0,r=n?n[0]:t.charAt(0),i=n?$V(n,1).join(""):t.slice(1);return r[e]()+i}}("toUpperCase");const sG=function(e){return oG(Uu(e).toLowerCase())};const aG=UV(function(e,t,n){return t=t.toLowerCase(),e+(n?sG(t):t)});const lG=function(e){return qm(e,4)};var uG=QE(function(e,t,n){return VE(e,kE(t)||0,n)});const cG=uG;const dG=function(e,t,n){(void 0!==n&&!uu(e[t],n)||void 0===n&&!(t in e))&&tm(e,t,n)};const pG=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===n(o[l],l,o))break}return t}}();const fG=function(e){return Rl(e)&&Jc(e)};var hG=Function.prototype,gG=Object.prototype,mG=hG.toString,vG=gG.hasOwnProperty,yG=mG.call(Object);const SG=function(e){if(!Rl(e)||"[object Object]"!=Dl(e))return!1;var t=ym(e);if(null===t)return!0;var n=vG.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&mG.call(n)==yG};const bG=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};const wG=function(e){return im(e,um(e))};const IG=function(e,t,n,r,i,o,s){var a=bG(e,n),l=bG(t,n),u=s.get(l);if(u)dG(e,n,u);else{var c=o?o(a,l,n+"",e,t,s):void 0,d=void 0===c;if(d){var p=ml(l),f=!p&&xc(l),h=!p&&!f&&Fc(l);c=l,p||f||h?ml(a)?c=a:fG(a)?c=mm(a):f?(d=!1,c=gm(l,!0)):h?(d=!1,c=Pm(l,!0)):c=[]:SG(l)||Ic(l)?(c=a,Ic(a)?c=wG(a):Ml(a)&&!Nl(a)||(c=Nm(l))):d=!1}d&&(s.set(l,c),i(c,l,r,o,s),s.delete(l)),dG(e,n,c)}};const EG=function e(t,n,r,i,o){t!==n&&pG(n,function(s,a){if(o||(o=new Ku),Ml(s))IG(t,n,a,r,e,i,o);else{var l=i?i(bG(t,a),s,a+"",t,n,o):void 0;void 0===l&&(l=s),dG(t,a,l)}},um)};const OG=JL(function(e,t,n){EG(e,t,n)});var CG,TG,xG,AG,DG;!function(e){e.Display1="display1",e.Display2="display2",e.Display3="display3",e.Display4="display4",e.Display5="display5",e.Display6="display6",e.Body1="body1",e.Body2="body2",e.Caption1="caption1",e.Caption2="caption2"}(CG||(CG={})),function(e){e.White="white",e.Black="black",e.Transparent="transparent"}(TG||(TG={})),function(e){e.Success="success",e.Info="info",e.Warning="warning",e.Danger="danger"}(xG||(xG={})),function(e){e.Primary="primary",e.Secondary="secondary",e.Light="light",e.Dark="dark"}(AG||(AG={})),function(e){e.Primary="primary",e.Secondary="secondary",e.Light="light",e.Dark="dark",e.Success="success",e.Info="info",e.Warning="warning",e.Danger="danger"}(DG||(DG={}));const RG="exb_user_settings";var PG;!function(e){e.Urlinfo="URLINFO"}(PG||(PG={}));var jG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class LG extends uL{isSupported(e,t){return jG(this,void 0,void 0,function*(){if(!e.length)return!1;for(const n of e){if(yield this.isDataSetSupportExportItem(n,t))return!0}return!1})}isDataSetSupportExportItem(e,t){return jG(this,void 0,void 0,function*(){var n,r;if(null==e.dataSource||e.dataSource.getStatus()===Ya.NotReady||t===rL.DataSource&&"function"!=typeof e.dataSource.query||t===rL.Records&&!(null===(n=e.records)||void 0===n?void 0:n.length)||!Object.keys(e.dataSource.getSchema()||{}).length)return!1;const i=e.dataSource,o=e.dataSource.itemId&&!this.isFeatureCollectionDataSource(e.dataSource),s=i.url||o,a=t===rL.DataSource&&s,l=!!i.allowToExportData&&(yield i.allowToExportData()),u=yield this.checkRenderPrivilege(),c=null===(r=i.getExportOptions)||void 0===r?void 0:r.call(i);let d=!0;return c&&(d=null==c.formats||c.formats.includes(Qh.Item)),!a&&l&&u&&d})}addItem(e,t){return jG(this,arguments,void 0,function*(e,t,n={},r){return r?Ti(Object.assign(Object.assign({},n),{item:e,folderId:r,authentication:t})):xi(Object.assign(Object.assign({},n),{item:e,authentication:t}))})}createItem(e,t){return jG(this,void 0,void 0,function*(){try{const n=Cv.getInstance(),r=TE().getState().portalUrl,i=n.getSessionByUrl(r);return(yield this.addItem(e,i,null,t)).id}catch(e){console.error(e)}return null})}createServiceItem(e,t,n){return jG(this,void 0,void 0,function*(){const{dataSource:r}=e,i={title:t,type:"Feature Service",url:r.url};if("function"==typeof r.getLayerDefinition){const e=r.getLayerDefinition(),t=e.extent;e.spatialReference&&(i.spatialReference=e.spatialReference),e.extent&&(i.extent=[[t.xmin,t.ymin],[t.xmax,t.ymax]])}return this.createItem(i,n)})}getFieldDomain(e,t,n){if(e.domain)return e.domain;const r=null==t?void 0:t.getFieldCodedValueList(null==e?void 0:e.name);if(!(null==r?void 0:r.length))return;const i=n.map(t=>t.getFieldValue(e.jimuName||e.name));return{codedValues:r.filter(e=>i.includes(e.value)).map(e=>({code:e.value,name:e.label})),type:"codedValue"}}getFieldForLayerDefinition(e,t,n){return{name:e.name,type:e.esriType,alias:e.alias,format:e.format,domain:this.getFieldDomain(e,t,n)}}getLayerForFeatureCollection(e,t,n,r){return jG(this,arguments,void 0,function*(e,t,n,r,i=!0){var o,s,a,l,u,c,d,p,f,h,g,m;const{dataSource:v,fields:y}=e;let S;S=t===rL.Records?e.records:yield this.getAllFeatureCollection(v,y,i);const b=v.getSchema(),w=(null==y?void 0:y.length)?y:Object.keys(null==b?void 0:b.fields)||[],I=v.getGeometryType(),E=null===(s=(o=v).getLayerDefinition)||void 0===s?void 0:s.call(o),O={name:b.label||v.getLabel(),type:I?"Feature Layer":"Table",geometryType:I,fields:w.map(e=>{var t,n,r;const i=Object.assign(Object.assign({},(null===(t=b.fields[e])||void 0===t?void 0:t.asMutable({deep:!0}))||{}),(null===(r=null===(n=null==E?void 0:E.fields)||void 0===n?void 0:n.find)||void 0===r?void 0:r.call(n,t=>t.name===e))||{});return this.getFieldForLayerDefinition(i,v,S)}),objectIdField:b.idField};let C=!1;const T=null===(l=null===(a=v.layer)||void 0===a?void 0:a.renderer)||void 0===l?void 0:l.toJSON(),x=null==E?void 0:E.drawingInfo,A=T?{renderer:T}:x||null;if(A){const e=Jm(A);if(e.renderer){const t=[];switch(e.renderer.type){case"classBreaks":case"class-breaks":case"heatmap":e.renderer.field&&t.push(e.renderer.field);break;case"uniqueValue":case"unique-value":e.renderer.field1&&t.push(e.renderer.field1),e.renderer.field2&&t.push(e.renderer.field2),e.renderer.field3&&t.push(e.renderer.field3)}const n=[];if(t.forEach(e=>{var t;const r=null===(t=b.fields[e])||void 0===t?void 0:t.asMutable({deep:!0});O.fields.find(t=>t.name===e)||(n.push(r.name),O.fields.push(this.getFieldForLayerDefinition(r,v,S)))}),n.length)try{const e={outFields:n,returnGeometry:i};yield v.load(e,{widgetId:`${r}_export_to_item_data_action`,refresh:!0}),C=!0}catch(e){console.log(e)}}(null===(c=null===(u=null==e?void 0:e.renderer)||void 0===u?void 0:u.visualVariables)||void 0===c?void 0:c.length)&&(e.renderer.visualVariables=e.renderer.visualVariables.filter(e=>"sizeInfo"!==e.type)),O.drawingInfo=e}const D=yield n.convertDataRecordSetToFeatureSet({name:e.name,dataSource:v,records:C?S.map(e=>{var t;const n=e.getId();return n&&null!==(t=v.getRecordById(n))&&void 0!==t?t:e}):S,fields:O.fields.map(e=>e.name)});O.spatialReference=D.spatialReference;const R=null===(p=(d=v).getCurrentQueryParams)||void 0===p?void 0:p.call(d);(null==R?void 0:R.where)&&(O.definitionExpression=R.where,O.defaultVisibility=!0);const P=null===(h=(f=v).getPopupInfo)||void 0===h?void 0:h.call(f);return(null===(g=null==P?void 0:P.fieldInfos)||void 0===g?void 0:g.length)&&(null===(m=O.fields)||void 0===m?void 0:m.length)&&(P.fieldInfos=P.fieldInfos.filter(e=>O.fields.find(t=>t.name===e.fieldName))),{popupInfo:P,layerDefinition:O,featureSet:D.toJSON()}})}createFeatureCollectionItem(e,t,n,r,i){return jG(this,arguments,void 0,function*(e,t,n,r,i,o=!0){const s=yield Promise.allSettled(e.map(e=>this.isDataSetSupportExportItem(e,t))),a=e.filter((e,t)=>!("fulfilled"!==s[t].status||!s[t].value)),{featureUtils:l}=yield NI("jimu-arcgis"),u=(yield Promise.allSettled(a.map(e=>this.getLayerForFeatureCollection(e,t,l,i,o)))).map(e=>"fulfilled"===e.status?e.value:null).filter(e=>!!e),c={layers:u},d=u.length>1?["Feature Collection"]:["Feature Collection","Singlelayer"];u.every(e=>{var t;return"Table"===(null===(t=null==e?void 0:e.layerDefinition)||void 0===t?void 0:t.type)})&&d.push("Table");const p={title:n,type:"Feature Collection",typeKeywords:d,text:JSON.stringify(c)};return this.createItem(p,r)})}checkPrivilegeAsync(){return jG(this,void 0,void 0,function*(){const e=Cv.getInstance();if(!(yield e.getUserInfo()))try{yield e.signIn()}catch(e){return!1}const t=yield cv(),n=yield dv();return t&&n})}checkRenderPrivilege(){return jG(this,void 0,void 0,function*(){const e=Cv.getInstance();if(!(yield e.getUserInfo()))return!0;const t=yield cv(),n=yield dv();return t&&n})}getAllFeatureCollection(e,t){return jG(this,arguments,void 0,function*(e,t,n=!0){const r=e;if("function"==typeof r.queryCount){const e=(yield r.queryCount({})).count;return yield this.query(r,e,t,n)}return[]})}query(e,t){return jG(this,arguments,void 0,function*(e,t,n=null,r=!0){const i=Math.ceil(t/1e3);let o=[];for(let t=1;t<=i;t++){const i={page:t,pageSize:1e3,returnGeometry:r};null!=n&&(i.outFields=n);const s=yield e.query(i);o=o.concat(s.records)}return o})}}var _G=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class MG extends LG{constructor(e){super(e),this.icon=aL()}onExecute(e,t,n){return _G(this,void 0,void 0,function*(){if(!(yield this.checkPrivilegeAsync()))return!1;const{AddItemDialog:r}=yield NI("jimu-ui"),i=1===e.length?`${e[0].dataSource.getLabel()}`:"Feature collection",o=document.querySelector(".active-data-action-item");return(0,sg.jsx)(r,{defaultName:i,keepOpenAfterConfirm:!0,reference:o,onConfirm:(r,i)=>this.handleConfirm(e,t,r,i,n)})})}getItemUrl(e){let t=TE().getState().portalUrl;return t=hg(t),`${t}/home/item.html?id=${e}`}handleConfirm(e,t,n,r,i){return _G(this,void 0,void 0,function*(){const{enqueueNotification:o,closeNotification:s,Typography:a,Link:l,ExportLoadingIndicator:u}=yield NI("jimu-ui"),c=Tb();let d=o({message:c.formatMessage({id:"export"}),severity:"info",description:(0,sg.jsx)(u,{message:c.formatMessage({id:"exportingData"},{name:n})}),autoHideDuration:0});try{const u=yield this.createFeatureCollectionItem(e,t,n,r,i);if(s(d),d=null,u){const e=this.getItemUrl(u);o({message:c.formatMessage({id:"export"}),severity:"success",closable:!0,description:(0,sg.jsxs)("div",{className:"d-flex justify-content-start",children:[(0,sg.jsx)(a,{className:"flex-shrink-0",color:"paperText",variant:"title2",children:c.formatMessage({id:"viewItem"})}),(0,sg.jsx)(l,{className:"ml-2 p-0 text-truncate flex-grow-1 flex-shrink-1",type:"link",title:n,to:e,target:"_blank",children:n})]}),autoHideDuration:0})}}catch(e){d&&s(d),o({message:c.formatMessage({id:"failedToExport"},{name:n}),severity:"error",closable:!0,autoHideDuration:0}),console.error(e)}})}}var NG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function kG(e,t){return NG(this,void 0,void 0,function*(){const{enqueueNotification:n,closeNotification:r,ExportLoadingIndicator:i}=yield NI("jimu-ui"),o=Tb(),s=n({message:o.formatMessage({id:"export"}),severity:"info",description:(0,sg.jsx)(i,{message:o.formatMessage({id:"exportingData"},{name:t})}),autoHideDuration:0});e.then(e=>{window.open(e,"_blank"),r(s)}).catch(e=>{r(s),n({message:o.formatMessage({id:"failedToExport"},{name:t}),severity:"error",closable:!0,autoHideDuration:3e3})})})}var UG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class FG extends LG{constructor(e){super(e),this.icon=aL()}isSupported(e,t){const n=Object.create(null,{isSupported:{get:()=>super.isSupported}});return UG(this,void 0,void 0,function*(){if(e.length>1)return!1;const r=e[0].dataSource;if(!(!!r.allowToExportData&&(yield r.allowToExportData()))||!r.getExportOptions||null==r.getGeometryType())return!1;const i=r.getExportOptions();if(i&&null!=i.formats&&!i.formats.includes(Qh.Shapefile))return!1;const o=yield r.supportReplica();return!(t!==rL.Records||!o)||(t===rL.Records||t===rL.DataSource&&this.isFeatureCollectionDataSource(r)?n.isSupported.call(this,e,t):r.supportReplica())})}onExecute(e,t,n){return UG(this,void 0,void 0,function*(){var r;const{dataSource:i}=e[0];if(t===rL.DataSource&&!this.isFeatureCollectionDataSource(i)){return kG(this.tryCreateReplica(i,"shapefile",void 0,!0),this.getExportFileName(i)),!0}if(!(yield this.checkPrivilegeAsync()))return!1;if(yield i.supportReplica()){return kG(this.tryCreateReplicaUsingRecords(e[0],"shapefile",!0),this.getExportFileName(i)),!0}const{ExportDataDialog:o}=yield NI("jimu-ui"),s=1===e.length?`${e[0].dataSource.getLabel()}`:"Feature collection",a=document.querySelector(".active-data-action-item"),l=this.getLocalRecrods(e[0]),u=l.length>0?this.getSpatialReferenceFromRecord(l[0]):null,c=null===(r=i.getMainDataSource())||void 0===r?void 0:r.getLayerDefinition(),d=(null==c?void 0:c.sourceSpatialReference)||(null==c?void 0:c.spatialReference);return(0,sg.jsx)(o,{defaultName:s,format:"Shapefile",reference:a,sourceWkid:null==u?void 0:u.wkid,targetWkid:null==d?void 0:d.wkid,keepOpenAfterConfirm:!0,onConfirm:(r,i)=>this.handleConfirm(e,t,r,i,n)})})}handleConfirm(e,t,n,r,i){return UG(this,void 0,void 0,function*(){try{const o=yield this.createFeatureCollectionItem(e,t,n,r,i);if(o)return o}catch(e){console.error(e)}return""})}}var BG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class $G extends LG{constructor(e){super(e),this.icon=aL()}isSupported(e,t){const n=Object.create(null,{isSupported:{get:()=>super.isSupported}});return BG(this,void 0,void 0,function*(){if(e.length>1)return!1;const r=e[0].dataSource;if(!(!!r.allowToExportData&&(yield r.allowToExportData()))||!r.getExportOptions)return!1;const i=r.getExportOptions();if(i&&null!=i.formats&&!i.formats.includes(Qh.FileGDB))return!1;const o=yield r.supportReplica();return!(t!==rL.Records||!o)||(t===rL.Records||t===rL.DataSource&&this.isFeatureCollectionDataSource(r)?n.isSupported.call(this,e,t):r.supportReplica())})}onExecute(e,t,n){return BG(this,void 0,void 0,function*(){var r;const{dataSource:i,fields:o}=e[0];if(t===rL.DataSource&&!this.isFeatureCollectionDataSource(i)){return kG(this.tryCreateReplica(i,"filegdb",o),this.getExportFileName(i)),!0}if(!(yield this.checkPrivilegeAsync()))return!1;if(yield i.supportReplica()){return kG(this.tryCreateReplicaUsingRecords(e[0],"filegdb",!0),this.getExportFileName(i)),!0}const{ExportDataDialog:s}=yield NI("jimu-ui"),a=1===e.length?`${e[0].dataSource.getLabel()}`:"Feature collection",l=document.querySelector(".active-data-action-item"),u=this.getLocalRecrods(e[0]),c=u.length>0?this.getSpatialReferenceFromRecord(u[0]):null,d=null===(r=i.getMainDataSource())||void 0===r?void 0:r.getLayerDefinition(),p=(null==d?void 0:d.sourceSpatialReference)||(null==d?void 0:d.spatialReference);return(0,sg.jsx)(s,{defaultName:a,format:"File Geodatabase",reference:l,sourceWkid:null==c?void 0:c.wkid,targetWkid:null==p?void 0:p.wkid,keepOpenAfterConfirm:!0,onConfirm:(r,i)=>this.handleConfirm(e,t,r,i,n)})})}handleConfirm(e,t,n,r,i){return BG(this,void 0,void 0,function*(){try{const o=yield this.createFeatureCollectionItem(e,t,n,r,i);if(o)return o}catch(e){console.error(e)}return""})}}var VG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class GG extends LG{constructor(e){super(e),this.icon=aL()}isSupported(e,t){const n=Object.create(null,{isSupported:{get:()=>super.isSupported}});return VG(this,void 0,void 0,function*(){if(e.length>1)return!1;const r=e[0].dataSource;if(!(!!r.allowToExportData&&(yield r.allowToExportData()))||!r.getExportOptions||null==r.getGeometryType())return!1;const i=r.getExportOptions();if(i&&null!=i.formats&&!i.formats.includes(Qh.KML))return!1;const o=yield r.supportReplica();return!(t!==rL.Records||!o)||(t===rL.Records||t===rL.DataSource&&this.isFeatureCollectionDataSource(r)?n.isSupported.call(this,e,t):r.supportReplica())})}onExecute(e,t,n){return VG(this,void 0,void 0,function*(){var r;const{dataSource:i,fields:o}=e[0];if(t===rL.DataSource&&!this.isFeatureCollectionDataSource(i)){return kG(this.tryCreateReplica(i,"kml",o,!0),this.getExportFileName(i)),!0}if(!(yield this.checkPrivilegeAsync()))return!1;if(yield i.supportReplica()){return kG(this.tryCreateReplicaUsingRecords(e[0],"kml",!0),this.getExportFileName(i)),!0}const{ExportDataDialog:s}=yield NI("jimu-ui"),a=1===e.length?`${e[0].dataSource.getLabel()}`:"Feature collection",l=document.querySelector(".active-data-action-item"),u=this.getLocalRecrods(e[0]),c=u.length>0?this.getSpatialReferenceFromRecord(u[0]):null,d=null===(r=i.getMainDataSource())||void 0===r?void 0:r.getLayerDefinition(),p=(null==d?void 0:d.sourceSpatialReference)||(null==d?void 0:d.spatialReference);return(0,sg.jsx)(s,{defaultName:a,format:"KML",reference:l,sourceWkid:null==c?void 0:c.wkid,targetWkid:null==p?void 0:p.wkid,keepOpenAfterConfirm:!0,onConfirm:(r,i)=>this.handleConfirm(e,t,r,i,n)})})}handleConfirm(e,t,n,r,i){return VG(this,void 0,void 0,function*(){try{const o=yield this.createFeatureCollectionItem(e,t,n,r,i);if(o)return o}catch(e){console.error(e)}return""})}}var WG=a(4747),HG=a.n(WG),zG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const qG=["count","countEmpty","sum","min","max","avg","stddev"],JG=["count","sum","min","max","avg","stddev"],KG=e=>{const t=e.length;if(t<=1)return 0;let n=0;e.forEach(function(e){n+=e});const r=n/t;let i=0;return e.forEach(function(e){i+=Math.pow(e-r,2)}),Math.sqrt(1/(t-1)*i)},YG=e=>{var t,n;const r=Object.values((null===(t=e.dataSource.getSchema())||void 0===t?void 0:t.fields)||{});let i=r.filter(e=>e.esriType!==Ma.OID&&e.type===_a.Number).map(e=>e.name),o=e.fields||[];if(1===o.length){(null===(n=r.find(e=>e.name===o[0]))||void 0===n?void 0:n.esriType)===Ma.OID&&(o=[])}return o.length>0&&(i=i.filter(e=>o.includes(e))),i};var XG=a(4682),QG=a.n(XG),ZG=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class eW extends iL{constructor(e){super(e),this.dataStatisticsPopperRef={},this.isWatchingDataSetsChange=!0,this.icon=HG()}loadModules(){return ZG(this,void 0,void 0,function*(){const{FloatingPanel:e,Label:t,Loading:n,LoadingType:r,Icon:i}=yield NI("jimu-ui");this._modules={FloatingPanel:e,Label:t,Loading:n,LoadingType:r,Icon:i}})}isSupported(e,t){return ZG(this,void 0,void 0,function*(){const n=1===e.length&&sW(e[0],t);return n&&!this._modules&&(yield this.loadModules()),n})}onExecute(e,t,n,r){this._version||(this._version=0);const i=Object.assign({version:this._version++,iconRef:document.querySelector(".active-data-action-item")||{getBoundingClientRect:()=>({width:0,height:0,left:document.body.clientWidth/2,top:document.body.clientHeight/2-nW.height/2}),isVirtualElement:!0},dataSet:e[0],dataLevel:t},this._modules);return this.dataStatisticsPopperRef[n]=F.createRef(),Promise.resolve((0,sg.jsx)(iW,Object.assign({ref:this.dataStatisticsPopperRef[n]},i)))}onDataSetsChange(e,t){var n,r,i;const o=null===(n=this.dataStatisticsPopperRef[t])||void 0===n?void 0:n.current;1===e.length&&o&&(null===(i=(r=this.dataStatisticsPopperRef[t].current).updateDataSet)||void 0===i||i.call(r,e[0]))}}const tW={width:335,height:300},nW={width:350,height:320},rW=sg.css`
  .component-field-selector {
    .ds-name {
      padding: 0 !important;
      margin-bottom: 8px;
      .option-label {
        display: none;
      }
      .mt-2 {
        display: none;
      }
    }
  }
`,iW=F.forwardRef((e,t)=>{const{FloatingPanel:n,Label:r,Loading:i,LoadingType:o,Icon:s,version:a,iconRef:l,dataSet:u,dataLevel:c}=e,[d,p]=F.useState(u),f=F.useCallback(e=>{d.records.map(e=>e.getId()).join(",")!==e.records.map(e=>e.getId()).join(",")&&p(e)},[d.records]);F.useImperativeHandle(t,()=>({updateDataSet:f,dataLevel:c}),[c,f]);const h=r_(Xg),g=F.useRef(null),[m,v]=F.useState(!1);F.useEffect(()=>{y()},[]);const y=()=>ZG(void 0,void 0,void 0,function*(){const{FieldSelector:e}=yield NI("jimu-ui/basic/runtime-components");g.current=e,v(!0)}),[S,b]=F.useState(nW),[w,I]=F.useState(!0);F.useEffect(()=>{I(!0)},[a]);const E=()=>{I(!1)},O=[d.dataSource],C=Xe()([_a.Number]),[T,x]=F.useState(Xe()([])),[A,D]=F.useState({}),[R,P]=F.useState(!1),j=Ij(),L=F.useCallback((e,t)=>ZG(void 0,void 0,void 0,function*(){P(!0);try{let n;c===rL.DataSource?n=yield((e,t)=>zG(void 0,void 0,void 0,function*(){var n,r;const i=JG.map(e=>({statisticType:e,onStatisticField:t,outStatisticFieldName:e})),o=e.getRealQueryParams({},"query"),s=e.query({outStatistics:i,where:o.where}),a=e.queryCount({where:o.where}),[l,u]=yield Promise.all([s,a]),c=null==l?void 0:l.records,d=(null===(r=null===(n=null==c?void 0:c[0])||void 0===n?void 0:n.feature)||void 0===r?void 0:r.attributes)||{count:0};return d.count<u.count&&(d.countEmpty=u.count-d.count),d}))(e.dataSource,t):c===rL.Records&&(n=((e,t)=>{const n={count:0,countEmpty:null,sum:0,min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,avg:0,stddev:0},r=[];return e.forEach(function(e){const i=e.getFieldValue(t);"number"==typeof i?(n.count++,n.sum+=i,n.min>i&&(n.min=i),n.max<i&&(n.max=i),r.push(i)):n.countEmpty=(n.countEmpty||0)+1}),0===n.count?(n.sum=null,n.min=null,n.max=null,n.avg=null,n.stddev=null):(n.avg=n.sum/n.count,n.stddev=KG(r)),n})(e.records,t));const r={};qG.forEach(e=>{const t=n[e];"number"==typeof t&&(r[e]=j.formatNumber(t))}),D(r)}catch(e){D(null)}finally{P(!1)}}),[c,j]),_=F.useCallback((e,t)=>{var n;const r=null===(n=null==e?void 0:e[0])||void 0===n?void 0:n.name;x(Xe()([r]))},[]),M=F.useMemo(()=>{var e;const t=YG(d),n=Object.values((null===(e=d.dataSource.getSchema())||void 0===e?void 0:e.fields)||{}).map(e=>e.name).filter(e=>!t.includes(e));return Xe()(n)},[d]),N=g.current;return F.useEffect(()=>{const e=T[0];d&&e&&L(d,e)},[d,L,T]),(0,sg.jsx)(n,{version:a,open:w,headerTitle:h("dataAction_DataStatistics"),onHeaderClose:E,minSize:tW,onResize:e=>{b(e)},dragBounds:"body",defaultSize:S,reference:l,toggle:(e,t)=>{"clickOutside"!==t&&E()},className:"data-statistics-popper",css:rW,children:(0,sg.jsx)("div",{className:"h-100 p-4 position-relative overflow-auto",children:m?(0,sg.jsxs)(F.Fragment,{children:[(0,sg.jsx)(r,{css:sg.css`
            width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
          `,title:O[0].getLabel(),"aria-label":O[0].getLabel(),children:O[0].getLabel()}),(0,sg.jsx)(N,{dataSources:O,types:C,selectedFields:T,hiddenFields:M,useDropdown:!0,isDataSourceDropDownHidden:1===O.length,placeholder:h("pleaseSelectAField"),className:"h-auto mb-4",onChange:_}),A&&!R&&(0,sg.jsx)("div",{children:Object.keys(A).map(e=>(0,sg.jsxs)(r,{className:"d-flex justify-content-between",children:[(0,sg.jsx)("span",{css:sg.css`
              width: ${nn(150)};
              flex-shrink: 0;
              overflow: hidden;
              text-overflow: ellipsis;
              white-space: nowrap;
            `,children:h(`${e}Label`)}),(0,sg.jsx)("span",{css:sg.css`
              overflow: hidden;
              text-overflow: ellipsis;
              white-space: nowrap;
            `,title:A[e],children:A[e]})]},e))}),!A&&!R&&(0,sg.jsxs)(r,{children:[(0,sg.jsx)(s,{icon:QG(),color:"var(--sys-color-error-main)"}),(0,sg.jsx)("span",{className:"ml-2",children:h("error")})]}),R&&(0,sg.jsx)(i,{type:o.Secondary})]}):(0,sg.jsx)(i,{type:o.Secondary})})})}),oW=[Xa.FeatureLayer,Xa.SceneLayer,Xa.BuildingComponentSubLayer,Xa.OrientedImageryLayer,Xa.ImageryLayer,Xa.SubtypeGroupLayer,Xa.SubtypeSublayer],sW=(e,t)=>{const n=YG(e);let r=oW.includes(e.dataSource.type)&&n.length>0&&e.dataSource.getStatus()!==Ya.NotReady;if(!r)return r;let i=!1;if(t===rL.DataSource&&"getCapabilities"in e.dataSource){i=e.dataSource.getCapabilities().getQueryCapabilities().supportsStatistics}return(t===rL.Records&&0===e.records.length||t===rL.DataSource&&!i)&&(r=!1),r};var aW=a(7332),lW=a.n(aW),uW=a(2943),cW=a.n(uW);const dW=sg.css`
&.ds-item {
  height: 32px;
  .ds-item-label-container {
    max-width: calc(100% - 20px);
    .ds-item-label {
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      margin-bottom: 0;
    }
    .record-count {
      border-radius: 4px;
      color: var(--sys-color-action-text);
      background: var(--sys-color-action-hover);
      padding: 1px 4px 0px 4px;
      line-height: 16px;
      font-size: 12px;
    }
  }
}
`;function pW(e){const{label:t,count:n,onSelect:r,uiComponents:i}=e,{Label:o,Button:s,Icon:a}=i;return(0,sg.jsxs)("div",{className:"ds-item w-100 d-flex justify-content-between align-items-center",css:dW,children:[(0,sg.jsxs)("div",{className:"ds-item-label-container d-flex align-items-center",children:[(0,sg.jsx)(o,{className:"ds-item-label ml-2",title:t,children:t}),(0,sg.jsx)("div",{className:"record-count ml-2",children:null!=n?n:"..."})]}),(0,sg.jsx)(s,{variant:"text",color:"inherit",size:"sm",icon:!0,disabled:!n,onClick:r,children:(0,sg.jsx)(a,{icon:cW(),size:16})})]})}var fW=a(6300),hW=a.n(fW);const gW=sg.css`
  border: none;
  .jimu-btn.expanded {
    align-self: flex-start;
  }
  .esri-feature.esri-widget {
    background-color: transparent;
  }
  .esri-feature__title {
    font-size: 14px !important;
    height: 16px;
    font-weight: 500;
    margin: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .esri-feature__content-element {
    padding: 0;
    margin-bottom: 0;
    margin-top: var(--sys-spacing-1);
  }
  .esri-feature__loading-container {
    display: none;
  }
  .feature-info-widget {
    max-width: calc(100% - 20px);
    .esri-widget, .esri-widget__table {
      color: var(--sys-color-surface-overlay-text);
    }
  }
`;function mW(e){const{graphic:t,popupTemplate:n,uiComponents:r}=e,[i,o]=F.default.useState(!1),s=F.default.useRef(null),a=F.default.useRef(null);u_(()=>{Fg(["esri/widgets/Feature"]).then(e=>{var r;const[i]=e,o=document&&document.createElement("div");o.className="jimu-widget",null===(r=a.current)||void 0===r||r.appendChild(o);const l=s.current;l&&!l.destroyed&&l.destroy(),t.popupTemplate=n,s.current=new i({container:o,defaultPopupTemplateEnabled:!0,graphic:t,visibleElements:{title:!0,content:{fields:!1},lastEditedInfo:!1}})})}),F.default.useEffect(()=>{s.current&&(s.current.visibleElements={title:!0,content:{fields:i},lastEditedInfo:!1})},[i]);const l=F.default.useCallback(e=>{e.stopPropagation(),o(e=>!e)},[]),{Button:u,jimuUIMessages:c,Icon:d}=r,p=r_(c);return(0,sg.jsxs)("div",{className:"feature-info-component d-flex align-items-center p-2",css:gW,children:[(0,sg.jsx)(u,{"aria-label":p(i?"collapse":"expand"),className:Ze()("p-0 jimu-outline-inside",{expanded:i}),variant:"text",color:"inherit",icon:!0,size:"sm",onClick:l,children:i?(0,sg.jsx)(d,{icon:c$(),size:"s"}):(0,sg.jsx)(d,{icon:p$(),size:"s",autoFlip:!0})}),(0,sg.jsx)("div",{className:"feature-info-widget flex-grow-1",ref:a})]})}var vW,yW=a(597),SW=a.n(yW),bW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};!function(e){e.Single="SINGLE",e.Multiple="MULTIPLE"}(vW||(vW={}));const wW=sg.css`
  .related-records-header {
    height: 32px;
    .related-records-title {
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .related-record-select {
      .jimu-dropdown-button {
        .related-record-select-icon {
          display: block !important;
          margin-right: 0;
        }
        .related-record-select-text {
          display: none;
        }
      }
      .jimu-dropdown-menu {
        max-width: 100vw !important;
      }
    }
  }
  .related-records-container {
    gap: var(--sys-spacing-2);
    .related-record {
      border: 1px solid var(--sys-color-divider-primary);
    }
    .related-record-selected {
      border-color: var(--sys-color-primary-main);
    }
  }
`;function IW(e){var t,n;const{widgetId:r,relatedDs:i,relatedIds:o,version:s,dataViewInfo:a,showBack:l,onBack:u,uiComponents:c}=e,[d,p]=F.default.useState(!1),[f,h]=F.default.useState(vW.Single),g=F.default.useCallback(e=>{h(e.target.value)},[]),[m,v]=F.default.useState(null);F.default.useEffect(()=>{if(!o||0===o.length)return;const e=`related_popper_${s}`,t=i.getLocalDataSource(e);function n(e){const t=i.getIdField();e.updateQueryParams({where:`${t} in (${o.join(",")})`},"related-records"),v(e),a[s]||(a[s]=[]),a[s].push(e)}t?n(t):mA.getInstance().createDataSource(Xe()({id:i.id}),null,e).then(e=>{n(e)})},[i,r,o,a,s]);const[y,S]=F.default.useState(null),b=Je(e=>{var t,n,r;return null===(r=null===(n=null===(t=e.dataSourcesInfo)||void 0===t?void 0:t[null==m?void 0:m.id])||void 0===n?void 0:n.widgetQueries)||void 0===r?void 0:r[`setFilter-${null==m?void 0:m.id}`]});F.default.useEffect(()=>{var e;if(b&&"1=1"!==b.where){const t=null==m?void 0:m.getRealQueryParams({returnIdsOnly:!0},"query");p(!0),null===(e=null==m?void 0:m.query(t))||void 0===e||e.then(e=>{var t,n;S(null===(n=null===(t=null==e?void 0:e.records)||void 0===t?void 0:t.map)||void 0===n?void 0:n.call(t,e=>e.getId()))}).catch(e=>{console.error(e),S(null)}).finally(()=>{p(!1)})}else S(null)},[b,m]);const[w,I]=F.default.useState([]),E=F.default.useMemo(()=>[],[]),O=(null===(n=null===(t=Je(e=>{var t,n,r;return(null===(r=null===(n=null===(t=e.dataSourcesInfo)||void 0===t?void 0:t[null==m?void 0:m.id])||void 0===n?void 0:n.selectedIds)||void 0===r?void 0:r.join(","))||""}))||void 0===t?void 0:t.split)||void 0===n?void 0:n.call(t,","))||E,C=i.getLabel(),T=F.default.useMemo(()=>{const e=i.getAllUsedFields(),t=i.getLayerDefinition().fields.map(e=>e.name);return"*"===e?t:e},[i]),x=F.default.useMemo(()=>{if(!m)return[];const e=Array.isArray(y)?w.filter(e=>y.includes(e.getId())):w,t=e.filter(e=>O.includes(e.getId()));return[{dataSource:m,type:t.length>0?"selected":"loaded",records:t.length>0?t:e,name:C,fields:T}]},[m,y,w,C,T,O]),A=F.default.useCallback((e,...t)=>bW(this,[e,...t],void 0,function*(e,t=!1){if(m&&o){p(!0);try{const n=m.getRecords(),r=n.map(e=>e.getId()),s=new Set(r),a=o.filter(e=>!s.has(e)&&(!y||y.includes(e))).slice(0,e);let l,u;if(a.length>0){const e={where:`${i.getIdField()} in (${a.join(",")})`,outFields:T,returnGeometry:!0},t=yield m.query(e);l=(null==t?void 0:t.records)||[]}else l=[];u=t?n.filter(e=>o.includes(e.getId())).concat(l):n.concat(l),m.setRecords(u),I(m.getRecords())}catch(e){console.error(e)}finally{p(!1)}}}),[y,m,i,o,T]),D=BE(e=>{if(w.length>=o.length||y&&w.length>y.length)return;const t=e.target;t.scrollHeight===t.clientHeight+t.scrollTop&&A(20)},100);F.default.useEffect(()=>{A(20,!0)},[A]);const R=Array.isArray(y)?w.filter(e=>y.includes(e.getId())):w,P=F.default.useCallback(e=>{const t=e.getId();let n=O;f===vW.Single?n=1===O.length&&O.includes(t)?[]:[t]:f===vW.Multiple&&(O.includes(t)?n=n.filter(e=>e!==t):n.push(t));const i=w.filter(e=>n.includes(e.getId()));m.selectRecords({widgetId:r,records:i})},[w,m,O,f,r]),j=F.default.useMemo(()=>{var e;const t=Object.values(i.getSchema().fields),n=t.map(e=>e.name),r=i.getPopupInfo();let o=((null==r?void 0:r.fieldInfos)||[]).filter(e=>e.visible&&n.includes(e.fieldName)).map(e=>({fieldName:e.fieldName,label:e.label}));0===o.length&&(o=t.filter(e=>T.includes(e.name)).map(e=>({fieldName:e.name,label:e.alias})));const s=null===(e=i.getLayerDefinition())||void 0===e?void 0:e.displayField,a=i.getIdField(),l=T.find(e=>e===s||/(name|title|label|id)/i.test(e)||e===a);return{title:`${l}: {${l}}`,content:[{type:"fields"}],fieldInfos:o}},[i,T]),{Loading:L,LoadingType:_,Button:M,Select:N,Icon:k,DataActionList:U,DataActionListStyle:B}=c,$=r_(Xg);return(0,sg.jsxs)("div",{className:"related-records h-100 d-flex flex-column",css:wW,children:[d&&(0,sg.jsx)(L,{type:_.Secondary}),(0,sg.jsxs)("div",{className:"related-records-header flex-shrink-0 d-flex justify-content-between align-items-center",children:[(0,sg.jsxs)("div",{className:"related-records-title flex-grow-1",children:[l&&(0,sg.jsx)(M,{className:"p-0 mr-2",size:"sm",variant:"text",color:"inherit",icon:!0,onClick:u,children:(0,sg.jsx)(k,{icon:hW(),autoFlip:!0})}),C]}),(0,sg.jsxs)("div",{className:"d-flex align-items-center",children:[(0,sg.jsxs)(N,{className:"related-record-select",value:f,size:"sm",appendToBody:!1,onChange:g,title:$("selectionMode"),children:[(0,sg.jsxs)("option",{value:vW.Single,children:[(0,sg.jsx)(k,{className:"related-record-select-icon d-none",size:12,icon:SW()}),(0,sg.jsx)("span",{className:"related-record-select-text",children:$("selectionModeSingle")})]},vW.Single),(0,sg.jsxs)("option",{value:vW.Multiple,children:[(0,sg.jsx)(k,{className:"related-record-select-icon d-none",size:12,icon:SW()}),(0,sg.jsx)("span",{className:"related-record-select-text",children:$("selectionModeMultiple")})]},vW.Multiple)]}),(0,sg.jsx)(U,{widgetId:r,dataSets:x,listStyle:B.Dropdown,buttonSize:"sm",buttonType:"tertiary"})]})]}),(0,sg.jsx)("div",{className:"related-records-container d-flex flex-column flex-grow-1 overflow-auto p-1",role:"listbox",onScroll:D,children:R.map(e=>{const t=e.getId(),n=(O||[]).includes(t);return(0,sg.jsx)("div",{className:Ze()("related-record",{"related-record-selected":n}),onClick:()=>{P(e)},children:(0,sg.jsx)(mW,{graphic:e.feature,popupTemplate:j,uiComponents:c})},t)})})]})}function EW(e){const{widgetId:t,dataSource:n,records:r,version:i,dataViewInfo:o,uiComponents:s}=e,[a,l]=F.default.useState(!1),[u,c]=F.default.useState([]),[d,p]=F.default.useState(Ye({})),[f,h]=F.default.useState(null),g=F.default.useMemo(()=>Cx(n),[n]);F.default.useEffect(()=>{l(!0),g.createRelatedDataSources().then(e=>{c(e)}).catch(()=>{c([])}).finally(()=>{l(!1)})},[g]),F.default.useEffect(()=>{const e=r.map(e=>e.getId());for(const t of u)p(e=>e.set(t.id,null)),null==n||n.queryRelatedRecords(t,e,{outFields:[n.getIdField()],returnGeometry:!1}).then(e=>{const n=e.reduce((e,t)=>{const n=t.relatedRecords.map(e=>e.getId()).filter(t=>!e.includes(t));return e.concat(n)},[]);p(e=>e.set(t.id,n))})},[n,r,u]),F.default.useEffect(()=>{var e;1===u.length&&(null===(e=d[u[0].id])||void 0===e?void 0:e.length)>0&&h(u[0])},[u,d]);const m=F.default.useCallback(e=>{h(e)},[]),v=F.default.useCallback(()=>{h(null)},[]),{Loading:y,LoadingType:S}=s;return(0,sg.jsxs)(F.default.Fragment,{children:[(0,sg.jsx)(y,{type:S.Secondary,className:Ze()({"d-none":!a})}),(0,sg.jsx)("div",{className:Ze()({"d-none":!!f||a}),children:u.map(e=>{var t;return(0,sg.jsx)(pW,{label:e.getLabel(),count:null===(t=d[e.id])||void 0===t?void 0:t.length,onSelect:()=>{m(e)},uiComponents:s},e.id)})}),f&&(0,sg.jsx)(IW,{widgetId:t,relatedDs:f,relatedIds:d[f.id],version:i,dataViewInfo:o,showBack:u.length>1,onBack:v,uiComponents:s})]})}var OW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class CW extends iL{constructor(e){super(e),this.relatedDataPopperRef={},this.isWatchingDataSetsChange=!0,this.icon=lW()}loadModules(){return OW(this,void 0,void 0,function*(){const{FloatingPanel:e,Loading:t,LoadingType:n,Label:r,Button:i,Select:o,Icon:s,DataActionList:a,DataActionListStyle:l,CollapsablePanel:u,defaultMessages:c}=yield NI("jimu-ui");this._modules={FloatingPanel:e,Loading:t,LoadingType:n,Label:r,Button:i,Select:o,Icon:s,DataActionList:a,DataActionListStyle:l,CollapsablePanel:u,jimuUIMessages:c}})}isSupported(e,t){return OW(this,void 0,void 0,function*(){const n=e.some(e=>RW(e,t))&&1===e.length;return n&&!this._modules&&(yield this.loadModules()),n})}onExecute(e,t,n,r){var i,o;this._version||(this._version=0);const s={version:this._version++,dataViewInfo:CW.dataViewInfo,iconRef:document.querySelector(".active-data-action-item")||{getBoundingClientRect:()=>({width:0,height:0,left:document.body.clientWidth/2,top:document.body.clientHeight/2-AW.height/2})},dataSet:e[0],widgetId:n,uiComponents:this._modules},a=null===(o=null===(i=e[0])||void 0===i?void 0:i.dataSource)||void 0===o?void 0:o.id,l=F.createRef();return this.relatedDataPopperRef[`${n}-${a}`]=l,Promise.resolve((0,sg.jsx)(DW,Object.assign({ref:l},s)))}onDataSetsChange(e,t){var n,r,i,o;const s=null===(r=null===(n=e[0])||void 0===n?void 0:n.dataSource)||void 0===r?void 0:r.id,a=null===(i=this.relatedDataPopperRef[`${t}-${s}`])||void 0===i?void 0:i.current;1===e.length&&a&&(null===(o=a.updateDataSet)||void 0===o||o.call(a,e[0]))}}CW.dataViewInfo={};const TW=CW,xW={width:350,height:350},AW={width:350,height:450},DW=F.forwardRef((e,t)=>{const{uiComponents:n,version:r,dataViewInfo:i,iconRef:o,widgetId:s,dataSet:a}=e,[l,u]=F.useState(a),c=F.useCallback(e=>{l.records.map(e=>e.getId()).join(",")!==e.records.map(e=>e.getId()).join(",")&&u(e)},[l.records]);F.useImperativeHandle(t,()=>({updateDataSet:c}),[c]);const{FloatingPanel:d}=n,[p,f]=F.useState(AW),[h,g]=F.useState(!0);F.useEffect(()=>{g(!0)},[r]);const m=F.useCallback(()=>{(i[r]||[]).forEach(e=>{mA.getInstance().destroyDataSource(e.id)}),delete i[r]},[i,r]);F.useEffect(()=>m,[m]);const v=()=>{g(!1),m()},y=r_(Xg);return(0,sg.jsx)(d,{version:r,open:h,headerTitle:y("dataAction_RelatedData"),onHeaderClose:v,minSize:xW,onResize:e=>{f(e)},dragBounds:"body",defaultSize:p,reference:o,toggle:(e,t)=>{"clickOutside"!==t&&v()},className:"related-data-popper",children:(0,sg.jsx)("div",{className:"h-100 p-4 position-relative overflow-auto",children:(0,sg.jsx)(EW,{widgetId:s,dataSource:l.dataSource,records:l.records,version:r,dataViewInfo:i,uiComponents:n})})})}),RW=(e,t)=>{var n,r,i;const o=Cx(e.dataSource),s=[Xa.FeatureLayer].includes(o.type),a=[Xa.FeatureService,Xa.WebMap,Xa.WebScene].includes(null===(n=o.getRootDataSource())||void 0===n?void 0:n.type),l=((null===(i=null===(r=null==o?void 0:o.getLayerDefinition)||void 0===r?void 0:r.call(o))||void 0===i?void 0:i.relationships)||[]).length>0,u=o.getStatus()!==Ya.NotReady,c=t===rL.Records,d=o.getDataSourceJson(),p=d.isOutputFromWidget&&!d.schema,f=!d.isOutputFromWidget;return s&&a&&l&&u&&c&&(f||p)};var PW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class jW extends oS{constructor(){super(...arguments),this.name="filter data record action",this.actionQuerySQLExpression={},this.concatQuerySqlExpressionOfSameAction=(e,t)=>{var n;let r=null;const i=e.widgetId,o=mA.getInstance().getDataSource(t),s=(null===(n=this.actionQuerySQLExpression)||void 0===n?void 0:n[t])||{};return Object.keys(s).forEach(e=>{const t=s[e];e!==i&&s&&(r=r?rC([r,t],o,tO.And):t)}),r},this.getQuerySqlExpressionWidthOtherQuery=(e,t,n,r)=>{const i=mA.getInstance().getDataSource(t),o=this.concatQuerySqlExpressionOfSameAction(e,t);return r?o:(o&&(n=n?rC([n,o],i,tO.And):o),n)},this.getQueryWhenUseDataRelationShip=(e,t,n)=>PW(this,void 0,void 0,function*(){var r;const i=mA.getInstance().getDataSource(t.messageUseDataSource.mainDataSourceId),o=t.actionUseDataSource.dataSourceId;let s,a=!1,l=!1,u=null,c=null;if(t.messageUseDataSource.mainDataSourceId===t.actionUseDataSource.mainDataSourceId){const e=i.getSchema(),t=i.getIdField();u=null===(r=null==e?void 0:e.fields)||void 0===r?void 0:r[t],c=u}else{let e,r;if(t.connectionType===Wj.UseLayersRelationship){const t=Tx(i,n);t&&(e=t.keyField,r=t.relatedKeyField)}else e=t.messageUseDataSource.fields[0],r=t.actionUseDataSource.fields[0];u=i.getSchema().fields[e],c=n.getSchema().fields[r]}if(u&&c){const r=u.jimuName,o=u.type,d=c.type,p=e;let f=[];if(t.connectionType===Wj.UseLayersRelationship)f=(yield null==i?void 0:i.queryRelatedFieldValues(p.records||[],n,c.name))||[],f=f.map(e=>BP(e,d)),0===f.length&&p.records.length>0&&(f=["-1"],c=n.getSchema().fields[n.getIdField()]);else for(let e=0;e<p.records.length;e++){const t=BP(p.records[e].getData()[r],d);f.includes(`${t}`)||f.push(t)}o!==_a.Number&&d===_a.Number&&p.records.length>0&&0===f.length&&(a=!0),f.length>0?s=$P(f,c,n):l=!0}if(e.records.length>0){const e=t.sqlExprObj?NO(t.sqlExprObj,n).sqlExpression:null;e&&(s=s?rC([s,e],n,tO.And):e)}else l=!0;return $Y.setValue(this.actionQuerySQLExpression,`${o}.${e.widgetId}`,s),s=this.getQuerySqlExpressionWidthOtherQuery(e,o,s,l),{where:a?"1 = 2":null==s?void 0:s.sql,returnGeometry:!0,sqlExpression:a?null:s}}),this.getQueryWhenNotUseDataRelationShip=(e,t,n)=>{const r=t.actionUseDataSource.dataSourceId;let i=null,o=!1;if(e.records.length>0){const e=t.sqlExprObj?NO(t.sqlExprObj,n).sqlExpression:null;e&&(i=e)}else o=!0;return $Y.setValue(this.actionQuerySQLExpression,`${r}.${e.widgetId}`,i),i=this.getQuerySqlExpressionWidthOtherQuery(e,r,i,o),{where:null==i?void 0:i.sql,returnGeometry:!0,sqlExpression:i}}}filterMessageDescription(e){return TE().getState().appRuntimeInfo.appMode===ka.Express?e.messageType===Gy.ExtentChange:e.messageType===Gy.DataRecordsSelectionChange||e.messageType===Gy.SelectDataRecord||e.messageType===Gy.ExtentChange}filterMessage(e){return!0}getSettingComponentUri(e,t){return"filter-data-record-action"}onRemoveListen(e,t){if(this.lastMessage&&this.lastMessage.type===e&&this.lastMessage.widgetId===t){if(this.lastActionConfig&&this.lastActionConfig.actionUseDataSource&&this.lastActionConfig.actionUseDataSource.dataSourceId){const e=mA.getInstance().getDataSource(this.lastActionConfig.actionUseDataSource.dataSourceId);e&&this.lastMessage.type===Gy.DataRecordsSelectionChange&&e.updateQueryParams(null,this.id),e&&this.lastMessage.type===Gy.ExtentChange&&this.lastMessage.stationary&&e.updateQueryParams(null,this.id),this.lastActionConfig=null}this.lastMessage=null}}onExecuteWithActionConfigItem(e,t){return PW(this,void 0,void 0,function*(){switch(this.lastMessage=e,this.lastActionConfig=t,e.type){case Gy.DataRecordsSelectionChange:let n=null;if(t&&t.messageUseDataSource&&t.actionUseDataSource){if(e.records.length>0&&e.records[0].dataSource.getMainDataSource().id!==t.messageUseDataSource.mainDataSourceId)return yield Promise.resolve(!0);const r=mA.getInstance(),i=r.getDataSource(t.messageUseDataSource.mainDataSourceId),o=t.actionUseDataSource.dataSourceId;let s=r.getDataSource(o);s||(s=yield r.createDataSourceByUseDataSource(t.actionUseDataSource)),i&&s&&(n=t.enabledDataRelationShip?yield this.getQueryWhenUseDataRelationShip(e,t,s):this.getQueryWhenNotUseDataRelationShip(e,t,s),s.updateQueryParams(n,this.id))}return Promise.resolve(!0);case Gy.ExtentChange:if(t&&e.stationary&&t.actionUseDataSource){const n=mA.getInstance(),r=t.actionUseDataSource.dataSourceId;let i=n.getDataSource(r);i||(i=yield n.createDataSourceByUseDataSource(t.actionUseDataSource));let o=null;if(i){const n=null==e?void 0:e.extent;let s=null,a=!1;const l=t.sqlExprObj?NO(t.sqlExprObj,i).sqlExpression:null;l?s=l:a=!0;const u=t.enableQueryWithCurrentExtent?n.toJSON():{};$Y.setValue(this.actionQuerySQLExpression,`${r}.${e.widgetId}`,s),s=this.getQuerySqlExpressionWidthOtherQuery(e,r,s,a),o={geometry:u,where:null==s?void 0:s.sql,returnGeometry:!0,sqlExpression:s},i.updateQueryParams(o,this.id)}}return Promise.resolve(!0)}})}onExecute(e,t){return PW(this,void 0,void 0,function*(){if(Array.isArray(t)){const n=t.map(t=>this.onExecuteWithActionConfigItem(e,t)),r=yield Promise.all(n);let i=!0;return r.forEach(e=>{i=i&&e}),Promise.resolve(i)}return this.onExecuteWithActionConfigItem(e,t)})}}var LW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};class _W extends oS{constructor(){super(...arguments),this.name="select data record action"}filterMessageDescription(e){return TE().getState().appRuntimeInfo.appMode!==ka.Express&&(e.messageType===Gy.DataRecordsSelectionChange||e.messageType===Gy.SelectDataRecord)}filterMessage(e){return!0}getSettingComponentUri(e,t){return"select-data-record-action"}onExecute(e,t){return LW(this,void 0,void 0,function*(){var n;const r=mA.getInstance(),i=r.getDataSource(null===(n=null==t?void 0:t.actionUseDataSource)||void 0===n?void 0:n.dataSourceId),o=i?i.getAllUsedFields():[];if(e.type===Gy.DataRecordsSelectionChange){let n=null;if(t&&t.messageUseDataSource&&t.actionUseDataSource){if(t.messageUseDataSource.mainDataSourceId===t.actionUseDataSource.mainDataSourceId)return!0;if(e.records.length>0&&e.records[0].dataSource.getMainDataSource().id!==t.messageUseDataSource.mainDataSourceId)return yield Promise.resolve(!0);const i=r.getDataSource(t.messageUseDataSource.mainDataSourceId);let s=!1,a=r.getDataSource(t.actionUseDataSource.mainDataSourceId);if(a||(yield r.createDataSourceByUseDataSource(t.actionUseDataSource),a=r.getDataSource(t.actionUseDataSource.mainDataSourceId)),0===e.records.length)return a&&a.selectRecordsByIds([]),yield Promise.resolve(!0);if(i&&a){if(t.enabledDataRelationShip){let r,l=null,u=null;if(t.messageUseDataSource.mainDataSourceId===t.actionUseDataSource.mainDataSourceId){const e=i.getSchema(),t=e&&e.fields&&Object.keys(e.fields).find(t=>"esriFieldTypeOID"===e.fields[t].esriType);l=e&&e.fields&&e.fields[t],u=l}else{let e,n;if(t.connectionType===Wj.UseLayersRelationship){const t=Tx(i,a);t&&(e=t.keyField,n=t.relatedKeyField)}else e=t.messageUseDataSource.fields[0],n=t.actionUseDataSource.fields[0];l=i.getSchema().fields[e],u=a.getSchema().fields[n]}let c=!1;if(l&&u){const n=l.name,o=l.type,d=u.type,p=e;let f=[];if(t.connectionType===Wj.UseLayersRelationship)f=(yield null==i?void 0:i.queryRelatedFieldValues(p.records||[],a,u.name))||[],f=f.map(e=>BP(e,d)),0===f.length&&(f=["-1"],u=a.getSchema().fields[a.getIdField()]);else for(let e=0;e<p.records.length;e++){const t=BP(p.records[e].getData()[n],d);f.includes(`${t}`)||f.push(t)}o!==_a.Number&&d===_a.Number&&0===f.length&&(s=!0),f.length>0?r=$P(f,u,a):c=!0}if(e.records.length>0){const e=t.sqlExprObj?NO(t.sqlExprObj,a).sqlExpression:null;e&&(r=r?rC([r,e],a,tO.And):e)}else c=!0;n={outFields:o,where:c?"":null==r?void 0:r.sql,returnGeometry:!0,sqlExpression:c?null:r}}else{let r=null,i=!1;if(e.records.length>0){const e=t.sqlExprObj?NO(t.sqlExprObj,a).sqlExpression:null;e&&(r=e)}else i=!0;n={outFields:o,where:i?"":null==r?void 0:r.sql,returnGeometry:!0,sqlExpression:i?null:r}}if(s)return a.clearSelection(),!0;a.selectRecords({widgetId:this.id,queryParams:n})}}return Promise.resolve(!0)}})}}class MW{constructor(){this.id="jimu-core-ds-factory"}getFactoryUri(e){if(Object.keys(Xa).map(e=>Xa[e]).includes(e))return"jimu-data-source"}}var NW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const kW=CE();function UW(){return NW(this,void 0,void 0,function*(){const{queryObject:e,urlHashObject:t}=nL.getInstance().init(kW);return function(){const e=Tv.getInstance(),t=self.fetch;if(self.rawFetch=t,!t)return void console.warn("browser does not support fetch");function n(e){const t=e.resource;return t instanceof Request?t.url:t instanceof URL?t.href:e.resource}function r(e,t){const n=e.resource;if(n instanceof Request){const r=new Request(t,n);e.resource=r}else n instanceof URL?e.resource=new URL(t):e.resource=t;return e}function i(e){if(Mx()){const t=n(e),i=Nx(t);i&&i!==t&&(e=r(e,i))}return e}function o(t){return NW(this,void 0,void 0,function*(){t.options||(t.options={});let i=n(t);const{portalUrl:o,isWebTier:s}=TE().getState();if(s&&pg(i,o))t.options.credentials="include";else if(e.isTrustedServer(i)){const n=new URLSearchParams(i).get("token"),r=e.getSessionByUrl(i);if(!n)if(r&&r.token)i=oI(i,"token",r.token);else if("include"!==t.options.credentials){const t=yield e.getSessionFromWebTierServer(i);t&&t.token&&(i=oI(i,"token",t.token))}t.options.credentials="include"}return r(t,i)})}self.fetch=function(e,n){return NW(this,void 0,void 0,function*(){let r={resource:e,options:n};return r=i(r),r=yield o(r),r.options||(r.options={}),t(r.resource,r.options)})}}(),kW.subscribe(()=>{window._appState=TE().getState()}),window._am=()=>{const e=TE().getState().asMutable({deep:!0});return window._appState=e,e},window.addEventListener&&(window.addEventListener("online",()=>kW.dispatch(wD(!1))),window.addEventListener("offline",()=>kW.dispatch(wD(!0))),window.addEventListener("resize",BE(VW,100)),VW()),window.runtimeInfo={widgets:{},animationPlayId:0},Promise.allSettled||function(){function e(e){return NW(this,void 0,void 0,function*(){const t=e.map(e=>NW(this,void 0,void 0,function*(){return yield e.then(e=>({status:"fulfilled",value:e})).catch(e=>({status:"rejected",reason:e}))}));return Promise.all(t)})}Promise.allSettled=e}(),Fy.getInstance(),window.jimuConfig.isBuilder||(fA.getInstance(),Lx.getInstance()),function(){return NW(this,void 0,void 0,function*(){if(window.jimuConfig.isInBuilder){yield NI("jimu-layouts/layout-builder");const e=yield NI("jimu-for-builder");yield NI("jimu-for-builder/templates");const t=e.appBuilderSync;t.listenBuilderEvents(),t.publishAppIsLoadedToBuilder();const n=BE(t.publishAppStateChangeToBuilder,200);return xE((e,t)=>{e&&t&&n()}),Promise.resolve()}return Promise.resolve()})}().then($W).then(FW).then(t=>{var n;const r=null===(n=function(e,t){const n=e.locale||t||bb(window.navigator);return n}(e,t))||void 0===n?void 0:n.toLowerCase(),i=wb(r,Gd)||"en";return window.locale=r,_b(r),function(e,t){const n={isInPortal:window.jimuConfig.isInPortal,isInBuilder:window.jimuConfig.isInBuilder,isBuilder:window.jimuConfig.isBuilder,isSite:window.jimuConfig.isSite,locale:e,translatedLocale:t,isRTL:Ob(e),isTouchDevice:ew(),jimuConfig:window.jimuConfig};kW.dispatch(MA(n))}(r,i),function(){NW(this,void 0,void 0,function*(){const{appId:e}=dI();return!window.jimuConfig.isInBuilder&&e?yield Nv(e).then(e=>(TE().dispatch(wA(e)),e)):Promise.resolve({})})}(),i}).then(n=>NW(this,void 0,void 0,function*(){kW.dispatch(wD(!(window.navigator&&window.navigator.onLine))),function(e){const{appId:t}=dI();t?kW.dispatch(IA(t)):e.config&&kW.dispatch(IA(e.config));kW.dispatch(AD({appMode:ka.Run,activePagePart:Ha.Body,isPrintPreview:"true"===e.print_preview||"1"===e.print_preview}))}(e),function(e,t){const n=aI(e,t);Object.keys(n).forEach(e=>{const t=n[e];t.filter&&TE().dispatch(eD(e,"_filterInUrl",t.filter)),t.gdbVersion&&TE().dispatch(JA(e,t.gdbVersion))})}(e,t),yield function(e){return NW(this,void 0,void 0,function*(){return"en"===e?yield Promise.resolve(Xg):(e=Sb(e,Gd))?yield Eb("jimu-core/lib/translations",e).then(e=>e):Promise.resolve(Xg)})}(n).then(e=>NW(this,void 0,void 0,function*(){return e&&kW.dispatch(NA("jimu-core",e)),function(e){hb.getInstance().registerAction({id:"export-json",name:"export",label:BW({id:"dataAction_ExportJson",defaultMessage:Xg.dataAction_ExportJson},e),ActionClass:dL}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"export-csv",name:"export",label:BW({id:"dataAction_ExportCSV",defaultMessage:Xg.dataAction_ExportCSV},e),ActionClass:vL}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"export-geojson",name:"export",label:BW({id:"dataAction_ExportGeoJson",defaultMessage:Xg.dataAction_ExportGeoJson},e),ActionClass:DL}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"export-item",name:"export",label:BW({id:"dataAction_ExportItem",defaultMessage:Xg.dataAction_ExportItem},e),ActionClass:MG}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"export-shp",name:"export",label:BW({id:"dataAction_ExportShp",defaultMessage:Xg.dataAction_ExportShp},e),ActionClass:FG}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"export-gdb",name:"export",label:BW({id:"dataAction_ExportGDB",defaultMessage:Xg.dataAction_ExportGDB},e),ActionClass:$G}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"export-kml",name:"export",label:BW({id:"dataAction_ExportKML",defaultMessage:Xg.dataAction_ExportKML},e),ActionClass:GG}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"set-filter",name:"setFilter",label:BW({id:"dataAction_SetFilter",defaultMessage:Xg.dataAction_SetFilter},e),ActionClass:V_}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"data-statistics",name:"dataStatistics",label:BW({id:"dataAction_DataStatistics",defaultMessage:Xg.dataAction_DataStatistics},e),ActionClass:eW}).catch(e=>{console.error(e)}),hb.getInstance().registerAction({id:"related-data",name:"relatedData",label:BW({id:"dataAction_RelatedData",defaultMessage:Xg.dataAction_RelatedData},e),ActionClass:TW}).catch(e=>{console.error(e)})}(e),function(e){db.getInstance().registerAction({id:"filter-data-record-action",label:BW({id:"messageAction_FilterDataRecord",defaultMessage:Xg.messageAction_FilterDataRecord},e),ActionClass:jW}).catch(e=>{console.error(e)}),db.getInstance().registerAction({id:"select-data-record-action",label:BW({id:"messageAction_SelectDataRecord",defaultMessage:Xg.messageAction_SelectDataRecord},e),ActionClass:_W}).catch(e=>{console.error(e)})}(e),GI.getInstance().registerExtension({epName:rg.DataSourceFactoryUri,extension:new MW}),window.jimuConfig.isInBuilder?(window.parent.isExpressBuilder?TE().dispatch(BA(ka.Express)):TE().dispatch(BA(ka.Design)),yield MI("jimu-for-builder").loadI18nMessage(),yield MI("jimu-for-builder/templates").init(),Promise.resolve()):Promise.resolve()}))}))})}function FW(){return NW(this,void 0,void 0,function*(){return kW.getState().user?(Ow(_d)!==kW.getState().user.culture&&Cw(_d,kW.getState().user.culture),yield Promise.resolve(kW.getState().user.culture)):Tv.getInstance().getMainSession()?null!==Ow(_d)?"null"===Ow(_d)?Promise.resolve(""):(Tv.getInstance().getUserInfo(),yield Promise.resolve(Ow(_d))):yield Tv.getInstance().getUserInfo().then(e=>e.culture):null})}function BW(e,t){return t&&t[e.id]?t[e.id]:e.defaultMessage}function $W(){return NW(this,void 0,void 0,function*(){return yield function(){return NW(this,void 0,void 0,function*(){let e;if(window.jimuConfig.isInPortal)return e=ug(),Promise.resolve({portalUrl:e,clientId:"experienceBuilder"});if(window.jimuConfig.isOutOfExb)return yield Promise.resolve(null);const t=window.jimuConfig.hostEnv||"dev";if(!window.jimuConfig.isDevEdition){const e="arcgis.com";let n;switch(t){case"prod":n="www";break;case"dev":n="devext";break;case"qa":n="qaext"}return Promise.resolve({portalUrl:`https://${n}.${e}`,clientId:"experienceBuilder"})}const n=`${EI()}builder/setting.json`;return yield window.fetch(n).then(e=>NW(this,void 0,void 0,function*(){return yield e.json()})).then(e=>{const n=e.devEnv[t];return n&&(n.portalUrl=Cg(n.portalUrl)),n},e=>NW(this,void 0,void 0,function*(){return console.error("Get setting.json error.",e),yield Promise.resolve(null)}))})}().then(e=>NW(this,void 0,void 0,function*(){return e?window.jimuConfig.isInBuilder?yield Promise.resolve(null):(TE().dispatch(pD({portalUrl:e.portalUrl,clientId:e.clientId,isWebTier:e.isWebTier})),void(yield Tv.getInstance().initSession())):(console.warn("No portal info."),yield Promise.resolve(null))}))})}function VW(){if("undefined"==typeof document)return;const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=nw({width:e,height:t});TE().getState().browserSizeMode!==n&&TE().dispatch(vD(n));const r=.01*t,i=.01*e;document.documentElement.style.setProperty("--vh",`${r}px`),document.documentElement.style.setProperty("--vw",`${i}px`)}function GW(e){return e.error?(0,sg.jsxs)("div",{children:["Error! ",(0,sg.jsx)("button",{onClick:e.retry,children:"Retry"})]}):e.pastDelay?(0,sg.jsx)("div",{children:"Loading..."}):null}var WW=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};function HW(e){e(CD(null))}function zW(){return WW(this,void 0,void 0,function*(){return window.jimuConfig.isInBuilder?yield NI("jimu-layouts/layout-builder"):yield NI("jimu-layouts/layout-runtime")})}function qW(e,t){return t.toFixed("px"===e?0:1)+e}const JW="var(--sys-color-action-selected)";function KW(e){let t="unset";if(e&&e.image){switch(e.fillType){case"fit":t="contain";break;case"fill":t="cover";break;case"stretch":t="100% 100%";break;default:t="auto"}return t}return t}function YW(e){return e&&e.color&&e.width?`${t=e.width,"object"==typeof t?`${t.distance}${t.unit}`:t} ${e.type} ${e.color}`:"none";var t}function XW(e,t){var n;const{dialogBackground:r,textColor:i,border:o,borderTop:s,borderBottom:a,borderLeft:l,borderRight:u,borderRadius:c}=e;let d="unset",p="unset";if(c){const e=c.number[0],t=void 0!==c.number[1]?c.number[1]:e,n=void 0!==c.number[2]?c.number[2]:e,r=void 0!==c.number[3]?c.number[3]:e;d=`${e}${c.unit} ${t}${c.unit}`,p=`${n}${c.unit} ${r}${c.unit}`}const f=ty(null===(n=null==r?void 0:r.image)||void 0===n?void 0:n.url);return{textColor:i||"var(--sys-color-surface-overlay-text)",backgroundColor:r&&r.color?r.color:"transparent",backgroundImage:f?`url(${f})`:"unset",backgroundRepeat:r&&r.image&&"tile"===r.fillType?"repeat":"no-repeat",backgroundSize:KW(r),borderStyle:YW(o),borderTopStyle:YW(s),borderBottomStyle:YW(a),borderLeftStyle:YW(l),borderRightStyle:YW(u),borderRadiusTopStyle:d,borderRadiusBottomStyle:p,borderRadiusStyle:c?`${d} ${p}`:"unset",boxShadowStyle:t}}function QW(e,t,n,r,i){const{borderRadius:o,interactionType:s}=e,a=XW(e,n),l=e.overlayColor||(e.isOpenerDlg?"#000000":"transparent"),u=`app-dialog-wrap-${e.id}`,c=o&&s?`${a.borderRadiusTopStyle} 0 0`:a.borderRadiusStyle,d=o?`0 0 ${a.borderRadiusBottomStyle}`:"unset";return sg.css`
    body {

      @keyframes aBlink {
        from { background-color: ${JW}; }
        50% { background-color: ${JW}; }
        51%{background-color: transparent;}
        to { background-color: transparent; }
      }

      .app-dialog-wrap{
        &.${u}{
          /** hide it until animation plays. */
          display: ${t?"inherit":"none"};
          &.no-backdrop {
            pointer-events: none;
            .modal-content {
              pointer-events: auto;
            }
          }
          .app-dialog {
            margin: 0!important;
            max-width: 100vw;
            max-height: 100vh;

            .app-dialog-content {
              border: none;
              box-shadow: unset;
              background-color: transparent;
              border-radius:  ${a.borderRadiusStyle};

              &.overflow-visible{
                overflow: visible;
              }

              .app-dialog-animation-container {
                &.animation-end {
                  clip-path: unset !important;
                }
                .app-dialog-animation-content {
                  border-radius:  ${a.borderRadiusStyle};
                }
              }

              .app-dialog-animation-content > .animate-wrapper {
                flex-direction: column; /** the animation uses flex(row) for inside unique DOM, but fixed has two when Interaction is set. */
                flex-shrink: 0;
                border-top: ${a.borderTopStyle};
                border-bottom: ${a.borderBottomStyle};
                border-left: ${a.borderLeftStyle};
                border-right: ${a.borderRightStyle};
                border: ${"none"===a.borderStyle?null:a.borderStyle};
                border-radius:  ${a.borderRadiusStyle};
                color: ${a.textColor};
                background-color: ${a.backgroundColor};
                background-image: ${a.backgroundImage};
                background-position: center center;
                background-repeat: ${a.backgroundRepeat};
                background-size: ${a.backgroundSize};

                &.custom-shadow {
                  box-shadow: ${a.boxShadowStyle};
                }

                .dialog-content{
                  padding: 0;
                  border-radius:  ${c};
                }

                .dialog-footer{
                  overflow-x: auto;
                  border-radius:  ${d};
                  user-select: none;
                  &.has-mask {
                    pointer-events: none;
                    user-select: none;
                    .btn {
                      pointer-events: none;
                    }
                  }

                  .cbx-animation{
                    margin-right: 0.5rem;
                    width: 16px;
                    height: 16px;
                    border: ${"2px solid var(--sys-color-divider-switch)"};
                    animation: aBlink 500ms infinite;
                  }
                  .btn {
                    min-width: 6.25rem;
                  }
                }
              }
            }
          }
          .app-dialog-backdrop{
            background-color: ${l};
          }
        }
      }
    }
  `}function ZW(e,t,n){let r=null;if("CUSTOM"===e.heightMode){const n="%"===(e.height.includes("%")?"%":"px")?t*parseFloat(e.height.split("%")[0])/100+"px":e.height;parseFloat(n)>t&&(r=n)}if(n){r=`calc(100% - ${n===Yh.ButtonBlock?95:n===Yh.ButtonInline?64:59}px)`}return sg.css`
    &.app-dialog{
      .app-dialog-content { /** modal-content */
        max-width: 100vw;
        max-height: 100vh;
        ${function(e){let t,n,r;switch(null==e?void 0:e.position){case Xh.TopLeft:t=sg.css`top: 0; left: 0; bottom: auto; right: auto;`;break;case Xh.TopRight:t=sg.css`top: 0; left: auto; bottom: auto; right: 0;`;break;case Xh.BottomLeft:t=sg.css`top: auto; left: 0; bottom: 0; right: auto;`;break;case Xh.BottomRight:t=sg.css`top: auto; left: auto; bottom: 0; right: 0;`;break;case Xh.TopCenter:t=sg.css`top: 0; left: 50%; bottom: auto; right: auto;`;break;case Xh.BottomCenter:t=sg.css`top: auto; left: 50%; bottom: 0; right: auto;`;break;case Xh.MiddleLeft:t=sg.css`top: 50%; left: 0; bottom: auto; right: auto;`;break;case Xh.MiddleRight:t=sg.css`top: 50%; left: auto; bottom: auto; right: 0;`;break;case Xh.MiddleCenter:t=sg.css`top: 50%; left: 50%; bottom: auto; right: auto;`;break;default:t=sg.css`top: 0; left: 0; bottom: auto; right: auto;`}"STRETCH"===e.widthMode&&(n=sg.css`width:auto;left:${e.left};right:${e.right};`);"STRETCH"===e.heightMode&&(r=sg.css`height:auto;top:${e.top};bottom:${e.bottom};`);return sg.css`
    position: fixed;
    ${t}
    width: ${null==e?void 0:e.width};
    height: ${null==e?void 0:e.height};
    ${n};
    ${r}
    overflow: visible;
    z-index: 2;
  `}(e)}
        height: ${"CUSTOM"===e.heightMode&&e.height};
        /* transition: height 0.3s ease-in-out; */
        transform: ${function(e){if(null==e)return null;const{position:t,offsetX:n=0,offsetY:r=0}=e;let i;"STRETCH"!==e.widthMode&&(0!==n&&(i=`translateX(${n}px)`),t!==Xh.TopCenter&&t!==Xh.MiddleCenter&&t!==Xh.BottomCenter||(i=null!=i?`${i} translateX(-50%)`:"translateX(-50%)"));"STRETCH"!==e.heightMode&&(0!==r&&(i=null!=i?`${i} translateY(${r}px)`:`translateY(${r}px)`),t!==Xh.MiddleLeft&&t!==Xh.MiddleCenter&&t!==Xh.MiddleRight||(i=null!=i?`${i} translateY(-50%)`:"translateY(-50%)"));return i}(e)};
        .app-dialog-resize-container {
          width: 100%;
          height: 100%;

          .app-dialog-animation-content > .animate-wrapper {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            .modal-body { /** dialog-content, it might have scrolling-bar in height */
              width: 100%;
              height: 100%;
              height: ${r};
            }
          }
        }
      }
    }
  `}function eH(e,t,n){var r;const i=XW(e,n),o="transparent"===i.backgroundColor?"var(--sys-color-surface-overlay)":i.backgroundColor,s=null===(r=e.boxShadow)||void 0===r?void 0:r.color,a=e.border&&e.border.width&&e.border.color,l=e.borderTop&&e.borderTop.width&&e.borderTop.color,u=e.borderBottom&&e.borderBottom.width&&e.borderBottom.color,c=e.borderLeft&&e.borderLeft.width&&e.borderLeft.color,d=e.borderRight&&e.borderRight.width&&e.borderRight.color,p="12px";let f=t.height,h=null,g=null;a&&(h=e.border.color,g=e.border.width,f=`calc(${f} - ${g} - ${g})`);return sg.css`
    &.app-dialog{
      /* margin: 0.5rem !important; */
      margin: 0 !important;
      background-color: transparent;
      border: none;
      box-shadow: unset;

      &.dialog-animation-playing{
        .jimu-popper--arrow{
          visibility: hidden !important;
        }

        .popper-box{
          overflow: visible !important; /*for animation is playing*/
        }
      }
      &.dialog-animation-end{
        .app-dialog-animation-content {
          border-radius: ${i.borderRadiusStyle};
        }

        &[data-popper-placement^="top"] .jimu-popper--arrow{
          &::before{
            border-top-color: ${h};
          }
          &::after{
            border-top-color: ${o};
            bottom: ${g};
          }
        }

        &[data-popper-placement^="bottom"] .jimu-popper--arrow{
          &::before{
            border-bottom-color: ${h};
          }
          &::after{
            border-bottom-color: ${o};
            top: ${g};
          }
        }

        &[data-popper-placement^="left"] .jimu-popper--arrow{
          &::before{
            border-left-color: ${h};
          }
          &::after{
            border-left-color: ${o};
            right: ${g};
          }
        }

        &[data-popper-placement^="right"] .jimu-popper--arrow{
          &::before{
            border-right-color: ${h};
          }
          &::after{
            border-right-color: ${o};
            left: ${g};
          }
        }
      }

      .popper-box{
        max-width: calc(100vw - ${p});
        max-height: calc(100vh - ${p});
        width: ${t.width};
        height: ${t.height};
        border-radius:  ${i.borderRadiusStyle};
      }

      .app-dialog-animation-content > .animate-wrapper {
        &.custom-shadow {
          box-shadow: ${i.boxShadowStyle};
        }
      }

      .app-dialog-animation-content{
        height: 100%;

        .app-dialog-container{
          overflow-y: auto;
          max-width: calc(100vw - ${p});
          max-height: calc(100vh - ${p});
          width: 100%;
          border-top: ${l?i.borderTopStyle:"none"};
          border-bottom: ${u?i.borderBottomStyle:"none"};
          border-left: ${c?i.borderLeftStyle:"none"};
          border-right: ${d?i.borderRightStyle:"none"};
          border: ${a?i.borderStyle:null};
          outline: ${s&&!a?"1px solid var(--sys-color-divider-secondary)":"unset"};
          border-radius:  ${i.borderRadiusStyle};

          .app-dialog-content{
            width: 100%;
            height: ${f};
            border-radius:  ${i.borderRadiusStyle};
            color: ${i.textColor};
            background-color: ${o} ;
            background-image: ${i.backgroundImage};
            background-position: center center;
            background-repeat: ${i.backgroundRepeat};
            background-size: ${i.backgroundSize};
          }
        }
      }

    }
  `}function tH(e){return sg.css`
    .app-dialog-resize-handlers{
      .resize-handler{
        width: 100%;
        height: 100%;
        position: absolute;
        z-index: 1;
        .resize-handler-icon {
          position: absolute;
          background-color: var(--ref-palette-black);
          border: 1px solid var(--ref-palette-white);
        }
        &.dialog-resize-top, &.dialog-resize-bottom {
          height: ${"4px"};
          cursor: ns-resize;
          .resize-handler-icon{
            left: min(50%, 50vw);
            width: ${38}px;
            margin-left: ${-19}px;
          }
        }
        &.dialog-resize-top{
          top: 0;
        }
        &.dialog-resize-bottom{
          bottom: 0;
        }
        &.dialog-resize-left, &.dialog-resize-right{
          width: ${"4px"};
          top: 0;
          cursor: ew-resize;
          .resize-handler-icon{
            top: 50%;
            height: ${38}px;
            margin-top: ${-19}px;
          }
        }
        &.dialog-resize-left{
          left: 0;
        }
        &.dialog-resize-right{
          right: 0;
        }

        &.dialog-resize-top-left, &.dialog-resize-top-right, &.dialog-resize-bottom-left, &.dialog-resize-bottom-right {
          width: 16px;
          height: 16px;
          margin: 1px;
        }
        &.dialog-resize-top-left {
          cursor: ${e?"nesw-resize":"nwse-resize"};
        }
        &.dialog-resize-top-right {
          cursor: ${e?"nwse-resize":"nesw-resize"};
        }
        &.dialog-resize-bottom-left {
          cursor: ${e?"nwse-resize":"nesw-resize"};
          top: unset;
        }
        &.dialog-resize-bottom-right {
          cursor: ${e?"nesw-resize":"nwse-resize"};
          top: unset;
        }
      }
    }
  `}const nH=(0,F.createContext)({}),rH=(0,F.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),iH=(0,F.createContext)({});function oH(e){const{initial:t,animate:n}=function(e,t){if(JF(e)){const{initial:t,animate:n}=e;return{initial:!1===t||NU(t)?t:void 0,animate:NU(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,F.useContext)(iH));return(0,F.useMemo)(()=>({initial:t,animate:n}),[sH(t),sH(n)])}function sH(e){return Array.isArray(e)?e.join(" "):e}const aH=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function lH(e,t,n){for(const r in t)LM(t[r])||oB(r,n)||(e[r]=t[r])}function uH(e,t){const n={};return lH(n,e.style||{},e),Object.assign(n,function({transformTemplate:e},t){return(0,F.useMemo)(()=>{const n=aH();return nB(n,t,e),Object.assign({},n.vars,n.style)},[t])}(e,t)),n}function cH(e,t){const n={},r=uH(e,t);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const dH=()=>({...aH(),attrs:{}});function pH(e,t,n,r){const i=(0,F.useMemo)(()=>{const n=dH();return cB(n,t,pB(r),e.transformTemplate,e.style),{...n.attrs,style:{...n.style}}},[t]);if(e.style){const t={};lH(t,e.style,e),i.style={...t,...i.style}}return i}const fH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hH(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||fH.has(e)}let gH=e=>!hH(e);try{"function"==typeof(mH=require("@emotion/is-prop-valid").default)&&(gH=e=>e.startsWith("on")?!hH(e):mH(e))}catch{}var mH;function vH(e,t,n,{latestValues:r},i,o=!1){const s=(mB(e)?pH:cH)(t,r,i,e),a=function(e,t,n){const r={};for(const i in e)"values"===i&&"object"==typeof e.values||(gH(i)||!0===n&&hH(i)||!t&&!hH(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}(t,"string"==typeof e,o),l=e!==F.Fragment?{...a,...s,ref:n}:{},{children:u}=t,c=(0,F.useMemo)(()=>LM(u)?u.get():u,[u]);return(0,F.createElement)(e,{...l,children:c})}const yH=(0,F.createContext)(null);function SH(e){return LM(e)?e.get():e}function bH(e,t,n,r){const i={},o=r(e,{});for(const e in o)i[e]=SH(o[e]);let{initial:s,animate:a}=e;const l=JF(e),u=KF(e);t&&u&&!l&&!1!==e.inherit&&(void 0===s&&(s=t.initial),void 0===a&&(a=t.animate));let c=!!n&&!1===n.initial;c=c||!1===s;const d=c?a:s;if(d&&"boolean"!=typeof d&&!oM(d)){const t=Array.isArray(d)?d:[d];for(let n=0;n<t.length;n++){const r=aM(e,t[n]);if(r){const{transitionEnd:e,transition:t,...n}=r;for(const e in n){let t=n[e];if(Array.isArray(t)){t=t[c?t.length-1:0]}null!==t&&(i[e]=t)}for(const t in e)i[t]=e[t]}}}return i}const wH=e=>(t,n)=>{const r=(0,F.useContext)(iH),i=(0,F.useContext)(yH),o=()=>function({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,i){return{latestValues:bH(n,r,i,e),renderState:t()}}(e,t,r,i);return n?o():function(e){const t=(0,F.useRef)(null);return null===t.current&&(t.current=e()),t.current}(o)},IH=wH({scrapeMotionValuesFromProps:sB,createRenderState:aH}),EH=wH({scrapeMotionValuesFromProps:fB,createRenderState:dH}),OH=Symbol.for("motionComponentSymbol");function CH(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function TH(e,t,n){return(0,F.useCallback)(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&("function"==typeof n?n(r):CH(n)&&(n.current=r))},[t])}const xH=(0,F.createContext)({}),AH=WF?F.useLayoutEffect:F.useEffect;function DH(e,t,n,r,i){const{visualElement:o}=(0,F.useContext)(iH),s=(0,F.useContext)(Z_),a=(0,F.useContext)(yH),l=(0,F.useContext)(rH).reducedMotion,u=(0,F.useRef)(null);r=r||s.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:o,props:n,presenceContext:a,blockInitialAnimation:!!a&&!1===a.initial,reducedMotionConfig:l}));const c=u.current,d=(0,F.useContext)(xH);!c||c.projection||!i||"html"!==c.type&&"svg"!==c.type||function(e,t,n,r){const{layoutId:i,layout:o,drag:s,dragConstraints:a,layoutScroll:l,layoutRoot:u,layoutCrossfade:c}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:RH(e.parent)),e.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:Boolean(s)||a&&CH(a),visualElement:e,animationType:"string"==typeof o?o:"both",initialPromotionConfig:r,crossfade:c,layoutScroll:l,layoutRoot:u})}(u.current,n,i,d);const p=(0,F.useRef)(!1);(0,F.useInsertionEffect)(()=>{c&&p.current&&c.update(n,a)});const f=n[NM],h=(0,F.useRef)(Boolean(f)&&!window.MotionHandoffIsComplete?.(f)&&window.MotionHasOptimisedAnimation?.(f));return AH(()=>{c&&(p.current=!0,window.MotionIsMounted=!0,c.updateFeatures(),c.scheduleRenderMicrotask(),h.current&&c.animationState&&c.animationState.animateChanges())}),(0,F.useEffect)(()=>{c&&(!h.current&&c.animationState&&c.animationState.animateChanges(),h.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(f)}),h.current=!1),c.enteringChildren=void 0)}),c}function RH(e){if(e)return!1!==e.options.allowProjection?e.projection:RH(e.parent)}function PH(e,{forwardMotionProps:t=!1}={},n,r){n&&nM(n);const i=mB(e)?EH:IH;function o(n,o){let s;const a={...(0,F.useContext)(rH),...n,layoutId:jH(n)},{isStatic:l}=a,u=oH(n),c=i(n,l);if(!l&&WF){!function(){(0,F.useContext)(Z_).strict;0}();const t=function(e){const{drag:t,layout:n}=tM;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}(a);s=t.MeasureLayout,u.visualElement=DH(e,c,a,r,t.ProjectionNode)}return(0,Q_.jsxs)(iH.Provider,{value:u,children:[s&&u.visualElement?(0,Q_.jsx)(s,{visualElement:u.visualElement,...a}):null,vH(e,n,TH(c,u.visualElement,o),c,l,t)]})}o.displayName=`motion.${"string"==typeof e?e:`create(${e.displayName??e.name??""})`}`;const s=(0,F.forwardRef)(o);return s[OH]=e,s}function jH({layoutId:e}){const t=(0,F.useContext)(nH).id;return t&&void 0!==e?t+"-"+e:e}function LH(e,t){return PH(e,t)}const _H=LH("a"),MH=LH("abbr"),NH=LH("address"),kH=LH("area"),UH=LH("article"),FH=LH("aside"),BH=LH("audio"),$H=LH("b"),VH=LH("base"),GH=LH("bdi"),WH=LH("bdo"),HH=LH("big"),zH=LH("blockquote"),qH=LH("body"),JH=LH("button"),KH=LH("canvas"),YH=LH("caption"),XH=LH("cite"),QH=LH("code"),ZH=LH("col"),ez=LH("colgroup"),tz=LH("data"),nz=LH("datalist"),rz=LH("dd"),iz=LH("del"),oz=LH("details"),sz=LH("dfn"),az=LH("dialog"),lz=LH("div"),uz=LH("dl"),cz=LH("dt"),dz=LH("em"),pz=LH("embed"),fz=LH("fieldset"),hz=LH("figcaption"),gz=LH("figure"),mz=LH("footer"),vz=LH("form"),yz=LH("h1"),Sz=LH("h2"),bz=LH("h3"),wz=LH("h4"),Iz=LH("h5"),Ez=LH("h6"),Oz=LH("head"),Cz=LH("header"),Tz=LH("hgroup"),xz=LH("hr"),Az=LH("html"),Dz=LH("i"),Rz=LH("iframe"),Pz=LH("img"),jz=LH("input"),Lz=LH("ins"),_z=LH("kbd"),Mz=LH("keygen"),Nz=LH("label"),kz=LH("legend"),Uz=LH("li"),Fz=LH("link"),Bz=LH("main"),$z=LH("map"),Vz=LH("mark"),Gz=LH("menu"),Wz=LH("menuitem"),Hz=LH("meter"),zz=LH("nav"),qz=LH("object"),Jz=LH("ol"),Kz=LH("optgroup"),Yz=LH("option"),Xz=LH("output"),Qz=LH("p"),Zz=LH("param"),eq=LH("picture"),tq=LH("pre"),nq=LH("progress"),rq=LH("q"),iq=LH("rp"),oq=LH("rt"),sq=LH("ruby"),aq=LH("s"),lq=LH("samp"),uq=LH("script"),cq=LH("section"),dq=LH("select"),pq=LH("small"),fq=LH("source"),hq=LH("span"),gq=LH("strong"),mq=LH("style"),vq=LH("sub"),yq=LH("summary"),Sq=LH("sup"),bq=LH("table"),wq=LH("tbody"),Iq=LH("td"),Eq=LH("textarea"),Oq=LH("tfoot"),Cq=LH("th"),Tq=LH("thead"),xq=LH("time"),Aq=LH("title"),Dq=LH("tr"),Rq=LH("track"),Pq=LH("u"),jq=LH("ul"),Lq=LH("video"),_q=LH("wbr"),Mq=LH("webview"),Nq=LH("animate"),kq=LH("circle"),Uq=LH("defs"),Fq=LH("desc"),Bq=LH("ellipse"),$q=LH("g"),Vq=LH("image"),Gq=LH("line"),Wq=LH("filter"),Hq=LH("marker"),zq=LH("mask"),qq=LH("metadata"),Jq=LH("path"),Kq=LH("pattern"),Yq=LH("polygon"),Xq=LH("polyline"),Qq=LH("rect"),Zq=LH("stop"),eJ=LH("svg"),tJ=LH("symbol"),nJ=LH("text"),rJ=LH("tspan"),iJ=LH("use"),oJ=LH("view"),sJ=LH("clipPath"),aJ=LH("feBlend"),lJ=LH("feColorMatrix"),uJ=LH("feComponentTransfer"),cJ=LH("feComposite"),dJ=LH("feConvolveMatrix"),pJ=LH("feDiffuseLighting"),fJ=LH("feDisplacementMap"),hJ=LH("feDistantLight"),gJ=LH("feDropShadow"),mJ=LH("feFlood"),vJ=LH("feFuncA"),yJ=LH("feFuncB"),SJ=LH("feFuncG"),bJ=LH("feFuncR"),wJ=LH("feGaussianBlur"),IJ=LH("feImage"),EJ=LH("feMerge"),OJ=LH("feMergeNode"),CJ=LH("feMorphology"),TJ=LH("feOffset"),xJ=LH("fePointLight"),AJ=LH("feSpecularLighting"),DJ=LH("feSpotLight"),RJ=LH("feTile"),PJ=LH("feTurbulence"),jJ=LH("foreignObject"),LJ=LH("linearGradient"),_J=LH("radialGradient"),MJ=LH("textPath");var NJ,kJ,UJ,FJ,BJ,$J,VJ;function GJ(){var e,t,n,r;if(window.jimuConfig.isBuilder){if((null===(t=null===(e=window._appWindow)||void 0===e?void 0:e.runtimeInfo)||void 0===t?void 0:t.animationPlayId)>=0)return window._appWindow.runtimeInfo.animationPlayId+=1,window._appWindow.runtimeInfo.animationPlayId;null!=(null===(n=window._appWindow)||void 0===n?void 0:n.runtimeInfo)&&(window._appWindow.runtimeInfo.animationPlayId=0)}else{if((null===(r=window.runtimeInfo)||void 0===r?void 0:r.animationPlayId)>=0)return window.runtimeInfo.animationPlayId+=1,window.runtimeInfo.animationPlayId;null!=window.runtimeInfo&&(window.runtimeInfo.animationPlayId=0)}return 0}!function(e){e.ScrollIntoView="SCROLL_IN",e.Manual="MANUAL"}(NJ||(NJ={})),function(e){e.None="NONE",e.Pulse="PULSE",e.RubberBand="RUBBER_BAND",e.FadeIn="FADE_IN",e.FadeOut="FADE_OUT",e.FlyIn="FLY_IN",e.ZoomIn="ZOOM_IN",e.WipeIn="WIPE_IN",e.SpinIn="SPIN_IN",e.FloatIn="FLOAT_IN"}(kJ||(kJ={})),function(e){e.Default="DEFAULT",e.Gentle="GENTLE",e.Wobbly="WOBBLY",e.Stiff="STIFF",e.Slow="SLOW",e.Molasses="MOLASSES"}(UJ||(UJ={})),function(e){e.Top="TOP",e.Bottom="BOTTOM",e.Left="LEFT",e.Right="RIGHT"}(FJ||(FJ={})),function(e){e.AsOne="AS_ONE",e.OneByOne="ONE_BY_ONE"}(BJ||(BJ={})),function(e){e.WithPrevious="WITH_PREVIOUS",e.AfterPrevious="AFTER_PREVIOUS"}($J||($J={})),function(e){e.OneByOne="ONE_BY_ONE",e.AllAtOnce="ALL_AT_ONCE"}(VJ||(VJ={}));const WJ={x:0,y:0,rotateZ:0,scale:1,clipPath:"inset(0% 0% 0% 0%)",opacity:0,transition:{type:"tween",duration:0}},HJ={x:[0,0],y:[0,0],rotateZ:[0,0],scale:[1,1],clipPath:["inset(0% 0% 0% 0%)","inset(0% 0% 0% 0%)"]},zJ={show:{opacity:1,transition:{type:"tween",duration:0}},hide:{opacity:1,transition:{type:"tween",duration:0}}};function qJ(e,t,n){let r;if(null!=e&&e!==kJ.None){r=function(e,t){switch(e){case kJ.FadeIn:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{opacity:[0,1]})};case kJ.FlyIn:switch(t){case FJ.Bottom:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{y:[window.innerHeight,0],opacity:[0,1]})};case FJ.Left:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{x:[-window.innerWidth,0],opacity:[0,1]})};case FJ.Right:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{x:[window.innerWidth,0],opacity:[0,1]})};default:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{y:[-window.innerHeight,0],opacity:[0,1]})}}case kJ.ZoomIn:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{scale:[.1,1],opacity:[0,1]})};case kJ.WipeIn:switch(t){case FJ.Bottom:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{opacity:1,clipPath:["inset(100% 0% 0% 0%)","inset(0% 0% 0% 0%)"]})};case FJ.Left:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{opacity:1,clipPath:["inset(0% 100% 0% 0%)","inset(0% 0% 0% 0%)"]})};case FJ.Right:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{opacity:1,clipPath:["inset(0% 0% 0% 100%)","inset(0% 0% 0% 0%)"]})};default:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{opacity:1,clipPath:["inset(0% 0% 100% 0%)","inset(0% 0% 0% 0%)"]})}}case kJ.SpinIn:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{rotateZ:[1080,0],opacity:[0,1]})};case kJ.FloatIn:switch(t){case FJ.Bottom:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{y:[100,0],opacity:[0,1]})};case FJ.Left:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{x:[-100,0],opacity:[0,1]})};case FJ.Right:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{x:[100,0],opacity:[0,1]})};default:return{hide:WJ,show:Object.assign(Object.assign({},HJ),{y:[-100,0],opacity:[0,1]})}}default:return null}}(e,t);const i=function(e){switch(e){case UJ.Gentle:return{dampling:14,stiffness:120};case UJ.Wobbly:return{dampling:12,stiffness:180};case UJ.Stiff:return{dampling:20,stiffness:210};case UJ.Slow:return{dampling:60,stiffness:280};case UJ.Molasses:return{dampling:120,stiffness:280};default:return{dampling:26,stiffness:170}}}(n);r&&(r.show.transition={type:"spring",damping:i.dampling,stiffness:i.stiffness})}return r}function JJ(e,t,n,r,i,o){const s=null==r?void 0:r.type;let a;if(null!=s&&s!==kJ.None){const{option:t={}}=r,{direction:o=FJ.Top,configType:l=UJ.Default}=t;a=qJ(s,o,l),a&&(a[`${e}_show`]=a.show,a[`${e}_hide`]=a.hide),n&&null!=i&&i!==zJ&&(a[`${n}_show`]=a.show,a[`${n}_hide`]=a.hide),a.visible={opacity:1,transition:{type:"tween",duration:0}}}else null!=i&&i!==zJ&&(a=Object.assign({},i),n&&(a[`${n}_show`]=a.show,a[`${n}_hide`]=a.hide),a.visible={opacity:1,transition:{type:"tween",duration:0}});const l=null==o?void 0:o.type;if(null!=l&&l!==kJ.None){a||(a={show:{opacity:1,transition:{type:"tween",duration:0}},hide:{opacity:1,transition:{type:"tween",duration:0}}});const e=KJ(o);e&&(a.show.transition||(a.show.transition={}),a.show.transition.when=e.when,a.show.transition.staggerChildren=e.staggerChildren),t&&(a[`${t}_show`]={opacity:1,transition:Object.assign(Object.assign({},a.show.transition),{type:"tween",duration:0})},a[`${t}_hide`]={opacity:1,transition:a.hide.transition})}return a}function KJ(e){const t=null==e?void 0:e.type;if(null!=t&&t!==kJ.None){const{option:t={}}=e,{start:n=$J.WithPrevious,parentMode:r=VJ.OneByOne}=t;return{when:n===$J.AfterPrevious&&"beforeChildren",staggerChildren:r===VJ.OneByOne?.3:0}}}function YJ(e){const t=null==e?void 0:e.type;if(null!=t&&t!==kJ.None){const{option:n={}}=e,{direction:r=FJ.Top,configType:i=UJ.Default}=n;return qJ(t,r,i)}return null}const XJ=F.createContext({delay:0,setting:null,playId:null,revert:!1,oid:""});function QJ(e,t,n){const r=F.useRef(Number.NEGATIVE_INFINITY),i=F.useRef(0),o=F.useRef(null);u_(()=>{const s=(e,t,o)=>{i.current=e.intersectionRatio,r.current=e.boundingClientRect.top;let s=e.isIntersecting;if(!s){const t=e.boundingClientRect,n=e.rootBounds;t.top<n.top&&(s=!0)}n(s,t,o)};if("function"==typeof IntersectionObserver&&e&&t&&t.current){const n=e=>{(e=>{const t=e.boundingClientRect,n=e.intersectionRect;if(r.current>t.top&&i.current<e.intersectionRatio){if(e.intersectionRatio>=.5||n.height>300||t.top+1<n.top)return void s(e,!0,!1)}else if(r.current<t.top&&i.current>e.intersectionRatio&&e.intersectionRatio<=.1)return void s(e,!1,!0);s(e,!1,!1)})(e[0])};o.current=new IntersectionObserver(n,{threshold:[0,.05,.1,.5,.9,.95,1],root:"body"===t.current.tagName.toLowerCase()?void 0:t.current}),o.current.observe(e.current)}return()=>{var e;null===(e=o.current)||void 0===e||e.disconnect()}})}var ZJ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const eK=sg.css`
  &.not-intersect {
    opacity: 0 !important;
  }
  &.animation-end > .animate-wrapper {
    clip-path: unset !important;
  }
  & > div.animate-wrapper {
    position: relative;
  }
`,tK=F.forwardRef((e,t)=>{var n;const{parentId:r,isSection:i=!1,parentRef:o,playId:s,playMode:a,animationSetting:l,oneByOneSetting:u,innerLayoutId:c,children:d,wrapperClassName:p}=e,f=ZJ(e,["parentId","isSection","parentRef","playId","playMode","animationSetting","oneByOneSetting","innerLayoutId","children","wrapperClassName"]),h=F.useId(),g=F.useRef(void 0),m=t||g,v=v_(s),[y,S]=F.useState(null),[b,w]=F.useState(),I=F.useRef(void 0),E=F.useContext(Wv),O=F.useContext(Gv),C=null!==(n=null==O?void 0:O.isInView)&&void 0!==n&&n,T=Je(e=>{var t;return(null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.appMode)===ka.Design}),x=F.useRef(T),A=F.useContext(XJ);let D;((null==A?void 0:A.oid)===r||Array.isArray(null==A?void 0:A.oid)&&A.oid.includes(r))&&(D=null==A?void 0:A.variants);const R=F.useMemo(()=>{const e=JJ(h,c,r,l,D,u);return e&&a!==BJ.AsOne&&a!==BJ.OneByOne&&!i&&e[`${h}_show`]&&e[`${c}_show`]&&(e[`${c}_hide`]=e[`${h}_hide`],e[`${c}_show`]=e[`${h}_show`]),e&&C&&(e.section_show=e.show,e.section_hide=e.hide,delete e.show,delete e.hide),I.current=e,e},[h,a,c,r,l,D,u,C,i]),P=F.useMemo(()=>YJ(u),[u]),j=F.useCallback(()=>m.current.classList.contains("not-intersect"),[m]),L=F.useCallback(()=>{m.current.classList.contains("not-intersect")||m.current.classList.add("not-intersect")},[m]),_=F.useCallback(()=>{m.current.classList.contains("not-intersect")&&m.current.classList.remove("not-intersect")},[m]);QJ(m,o,(e,t,n)=>{I.current&&(m&&o&&!x.current&&(n&&L(),t&&j()&&(_(),S("show"))),w(e))});const M=F.useCallback(()=>{R&&S(`${h}_hide`)},[R,h]),N=F.useCallback(()=>{P&&S(`${c}_hide`)},[c,P]),k=F.useCallback(()=>{const e=null==l?void 0:l.type,t=null!=e&&e!==kJ.None;!i&&P?S(`${c}_hide`):t&&S(`${h}_hide`)},[l,h,c,P,i]);F.useEffect(()=>{m&&o&&I.current&&x.current!==T&&(T?_():!b&&E&&L()),x.current=T},[T,b,m,o,E,L,_]),F.useEffect(()=>{s>0&&s!==v&&(a===BJ.AsOne?M():a===BJ.OneByOne?N():k())},[s,v,M,N,k,a]);return(0,sg.jsx)(O$,{children:(0,sg.jsx)("div",Object.assign({ref:m,css:eK},f,{children:(0,sg.jsx)(lz,{className:`d-flex w-100 h-100 animate-wrapper ${p}`,animate:y,onAnimationStart:()=>{m.current.classList.remove("animation-end")},onAnimationComplete:()=>{if(null==y?void 0:y.endsWith("_hide")){const e=y.replace("_hide","_show");return void S(e)}(null==y?void 0:y.endsWith("_show"))&&S(null),m.current.classList.add("animation-end")},variants:R||zJ,children:(0,sg.jsx)(XJ.Provider,{value:{variants:P||zJ,oid:c},children:d})})}))})});var nK=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const rK=sg.css`
  &.not-intersect {
    opacity: 0 !important;
  }
  &.animation-end > .animate-wrapper {
    clip-path: unset !important;
  }
`,iK=F.forwardRef((e,t)=>{var n;const{parentId:r,parentRef:i,animationSetting:o,oneByOneSetting:s,innerLayoutId:a,children:l,wrapperClassName:u=""}=e,c=nK(e,["parentId","parentRef","animationSetting","oneByOneSetting","innerLayoutId","children","wrapperClassName"]),d=F.useRef(void 0),p=t||d,[f,h]=F.useState(null),g=F.useContext(Gv),m=F.useRef(void 0),v=F.useId(),y=null!==(n=null==g?void 0:g.isInView)&&void 0!==n&&n,S=F.useContext(XJ);let b;((null==S?void 0:S.oid)===r||Array.isArray(null==S?void 0:S.oid)&&S.oid.includes(r))&&(b=null==S?void 0:S.variants);const w=F.useMemo(()=>{const e=JJ(v,a,r,o,b,s);return e&&y&&(e.section_show=e.show,e.section_hide=e.hide,delete e.show,delete e.hide),e},[v,a,r,o,b,s,y]);QJ(null!=w?p:null,i,(e,t,n)=>{p&&i&&(n&&p.current.classList.add("not-intersect"),t&&p.current.classList.contains("not-intersect")&&(p.current.classList.remove("not-intersect"),h("show"))),m.current=e});const I=F.useMemo(()=>YJ(s),[s]);return(0,sg.jsx)(O$,{children:(0,sg.jsx)("div",Object.assign({ref:p,css:rK},c,{children:(0,sg.jsx)(lz,{className:`d-flex w-100 animate-wrapper ${u}`,animate:f,onAnimationStart:()=>{p.current.classList.remove("animation-end")},onAnimationComplete:e=>{(null==f?void 0:f.endsWith("show"))&&h("visible"),"show"===e&&!m.current&&p&&i&&w&&p.current.classList.add("not-intersect"),p.current.classList.add("animation-end")},variants:w||zJ,children:(0,sg.jsx)(XJ.Provider,{value:{variants:I||zJ,oid:a},children:l})})}))})}),oK=e=>{const{className:t,playId:n,innerLayoutId:r,parentId:i,animationSetting:o,oneByOneSetting:s,children:a,wrapperClassName:l}=e,[u,c]=F.useState(),[d,p]=F.useState(!1),f=F.useRef(null);F.useEffect(()=>{n?c("show"):p(!1)},[n]);return(0,sg.jsx)(lz,{className:"app-dialog-animation-container w-100 h-100",initial:window.jimuConfig.isInBuilder?null:"hide",animate:u,onAnimationStart:()=>{f.current.classList.remove("animation-end")},onAnimationComplete:()=>{c("visible"),p(!0),f.current.classList.add("animation-end")},variants:zJ,ref:f,children:window.jimuConfig.isInBuilder?(0,sg.jsx)(tK,Object.assign({},e,{wrapperClassName:l,children:a})):(0,sg.jsx)(iK,{className:t,parentId:i,innerLayoutId:r,animationSetting:o,oneByOneSetting:s,wrapperClassName:l,style:{visibility:"show"===u||d?"visible":"hidden"},children:a})})};const sK=function({dialogJson:e,isOpen:t,jimuUI:n,jimuLayout:r,version:i,messages:o,cbxAnimation:s,isChecked:a,setCbxState:l,closeDialog:u}){var c,d;const p=Je(e=>e.appRuntimeInfo.appMode===ka.Design),f=Je(t=>e.layout[t.browserSizeMode]||e.layout[t.appConfig.mainSizeMode]),[h,g]=F.useState(0);F.useEffect(()=>{t&&!p?g(GJ()):t||g(0)},[t,p]);const m=Je(t=>{var n;return(null===(n=t.appRuntimeInfo.animationPreview)||void 0===n?void 0:n.dialogId)===e.id?t.appRuntimeInfo.animationPreview:null},ye),v=He(),{ModalBody:y,ModalFooter:S}=n,{LayoutEntry:b}=r,w=e.mode===Kh.Fixed?"shadow-none shadow-0":"shadow-lg shadow-3",I=(null===(c=e.boxShadow)||void 0===c?void 0:c.color)?"custom-shadow":(null===(d=e.boxShadow)||void 0===d?void 0:d.presetStyle)||w;return(0,sg.jsxs)(oK,{parentId:null,innerLayoutId:f,animationSetting:e.effect,oneByOneSetting:e.oneByOneEffect,playId:h>(null==m?void 0:m.id)||!(null==m?void 0:m.id)?h:null==m?void 0:m.id,playMode:h>(null==m?void 0:m.id)||!(null==m?void 0:m.id)||null==m?void 0:m.playMode,className:"app-dialog-animation-content h-100",wrapperClassName:I,children:[e.mode===Kh.Fixed&&(0,sg.jsx)(y,{className:"dialog-content",children:(0,sg.jsx)(b,{layouts:e.layout,className:"w-100 h-100"})}),e.mode===Kh.Fixed&&e.interactionType&&(0,sg.jsxs)(S,{onClick:()=>{HW(v)},className:Ze()("dialog-footer",{"d-block":e.interactionType===Yh.ButtonBlock,"has-mask":p}),children:[(0,sg.jsx)("div",{className:"d-flex flex-grow-1 overflow-hidden text-nowrap",children:(0,sg.jsxs)(n.Label,{centric:!0,check:!0,className:"overflow-hidden mb-1",style:{fontSize:e.interactionStyles.textSize,textOverflow:"ellipsis",cursor:p?"inherit":"pointer"},children:[s?(0,sg.jsx)("div",{className:"cbx-animation"}):(0,sg.jsx)(n.Checkbox,{className:"mr-2",style:{cursor:"pointer"},onChange:e=>{l(e.target.checked)},checked:a}),(0,sg.jsx)("span",{className:"text-break overflow-hidden",style:{textOverflow:"ellipsis",width:"calc(100% - 16px)"},children:e.interactionStyles.text||o(e.confirmBeforeClose?"dialogConfirmationDefaultText":"dialogPreventDisplayAgainDefaultText")})]})}),e.interactionType!==Yh.NoButton&&(0,sg.jsx)("div",{className:"d-flex flex-row-reverse",children:(0,sg.jsx)(n.Button,{type:"primary",style:{fontSize:e.interactionStyles.buttonTextSize,lineHeight:1},disabled:e.interactionType&&e.confirmBeforeClose&&!a,onClick:e=>{u()},children:(0,sg.jsx)("span",{className:"d-flex align-items-center",style:{minHeight:"22px"},children:e.interactionStyles.buttonText||o("ok")})})})]}),e.mode===Kh.Anchored&&(0,sg.jsx)("div",{className:"app-dialog-container",children:(0,sg.jsx)("div",{className:"app-dialog-content",children:(0,sg.jsx)(b,{layouts:e.layout,className:"w-100 h-100"})})})]})};const aK=16,lK=sg.css`
  width: ${aK}px;
  height: ${aK}px;
  background: transparent;
  position: absolute;
`;function uK(e){const{pos:t,isRTL:n}=e,r=F.useRef(void 0);return u_(()=>{var e;const i=null!==(e=window.devicePixelRatio)&&void 0!==e?e:1;r.current.width=aK*i,r.current.height=aK*i;const o=r.current.getContext("2d");o&&(o.scale(i,i),o.strokeStyle="#fff",o.fillStyle="#000",o.lineWidth=2,n?("tl"===t&&(o.translate(aK,0),o.rotate(Math.PI/2)),"br"===t&&(o.translate(0,aK),o.rotate(-Math.PI/2)),"bl"===t&&(o.translate(aK,aK),o.rotate(Math.PI))):("tr"===t&&(o.translate(aK,0),o.rotate(Math.PI/2)),"br"===t&&(o.translate(aK,aK),o.rotate(Math.PI)),"bl"===t&&(o.translate(0,aK),o.rotate(-Math.PI/2))),o.beginPath(),o.moveTo(1,1),o.lineTo(15,1),o.lineTo(15,3),o.lineTo(3,3),o.lineTo(3,15),o.lineTo(1,15),o.closePath(),o.stroke(),o.fill())}),(0,sg.jsx)("canvas",{css:lK,ref:r})}function cK(e){const{dialogSizeMode:t,isDesignMode:n,isRTL:r}=e,{position:i,widthMode:o,heightMode:s}=t||{},{top:a,right:l,bottom:u,left:c,topLeft:d,topRight:p,bottomRight:f,bottomLeft:h}=function(e,t,n){const r={top:!1,bottom:!1,left:!1,right:!1,topLeft:!1,topRight:!1,bottomLeft:!1,bottomRight:!1};return(null==e?void 0:e.includes("TOP"))&&"STRETCH"!==n||(r.top=!0),(null==e?void 0:e.includes("BOTTOM"))&&"STRETCH"!==n||(r.bottom=!0),(null==e?void 0:e.includes("LEFT"))&&"STRETCH"!==t||(r.left=!0),(null==e?void 0:e.includes("RIGHT"))&&"STRETCH"!==t||(r.right=!0),((null==e?void 0:e.includes("TOP"))||(null==e?void 0:e.includes("LEFT")))&&"STRETCH"!==n||(r.topLeft=!0),((null==e?void 0:e.includes("TOP"))||(null==e?void 0:e.includes("RIGHT")))&&"STRETCH"!==n||(r.topRight=!0),((null==e?void 0:e.includes("BOTTOM"))||(null==e?void 0:e.includes("LEFT")))&&"STRETCH"!==n||(r.bottomLeft=!0),((null==e?void 0:e.includes("BOTTOM"))||(null==e?void 0:e.includes("RIGHT")))&&"STRETCH"!==n||(r.bottomRight=!0),r}(i,o,s);return(0,sg.jsx)("div",{className:Ze()("app-dialog-resize-handlers"),children:n&&(0,sg.jsxs)(F.Fragment,{children:[a&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-top",children:(0,sg.jsx)("div",{className:"resize-handler-icon h-100"})},"1"),u&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-bottom",children:(0,sg.jsx)("div",{className:"resize-handler-icon h-100"})},"2"),c&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-left",children:(0,sg.jsx)("div",{className:"resize-handler-icon w-100"})},"3"),l&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-right",children:(0,sg.jsx)("div",{className:"resize-handler-icon w-100"})},"4"),d&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-top-left dialog-resize-top dialog-resize-left",children:(0,sg.jsx)(uK,{pos:"tl",isRTL:r})},"5"),p&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-top-right dialog-resize-top dialog-resize-right",children:(0,sg.jsx)(uK,{pos:"tr",isRTL:r})},"6"),h&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-bottom-left dialog-resize-bottom dialog-resize-left",children:(0,sg.jsx)(uK,{pos:"bl",isRTL:r})},"7"),f&&(0,sg.jsx)("span",{className:"resize-handler dialog-resize-bottom-right dialog-resize-bottom dialog-resize-right",children:(0,sg.jsx)(uK,{pos:"br",isRTL:r})},"8")]})})}var dK=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})},pK=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const{useEffect:fK,useState:hK,useRef:gK}=F;let mK=null;const vK=()=>{const e=Ij();return F.useCallback((t,n)=>e.formatMessage({id:t,defaultMessage:Xg[t]},n),[e])};function yK(e){var t,n;const{currentPageId:r,dialogProps:i,runtimeMode:o,timestamp:s,dialogInfos:a,dispatch:l,urlDlgId:u}=e,{dialogJson:c,isOpenByPage:d,runtime:p}=i;let f=!1;if(u===c.id&&!c.isSplash&&!d&&!c.confirmBeforeClose)return f;if(c.isSplash||d){const e=c.isSplash?c.id:`${r}-${c.id}`;if(p&&c.interactionType&&(c.confirmBeforeClose&&!c.alwaysShowConfirmation||!c.confirmBeforeClose)){const n=bK(e,o,s);f="true"===Ow(n.newKey)||"true"===Ow(n.oldKey),f&&SK(a,e,l),c.confirmBeforeClose||f||(f=null===(t=null==a?void 0:a[e])||void 0===t?void 0:t.isClosed)}else f=null===(n=null==a?void 0:a[e])||void 0===n?void 0:n.isClosed}return f}function SK(e,t,n){var r;(null===(r=null==e?void 0:e[t])||void 0===r?void 0:r.isClosed)||n(OD(e=(e||Ye({})).setIn([t,"isClosed"],!0)))}const bK=(e,t,n)=>{const r=hw();return{oldKey:`${r}-${"draft"===t?"draft":"release"}-${e}-${n}`,newKey:`${r}-${t}-${n}-${e}`}};function wK(){return dK(this,void 0,void 0,function*(){return yield NI("jimu-ui")})}const IK=function(e){var t,{dialogJson:n}=e,r=pK(e,["dialogJson"]);const[i,o]=hK(null),[s,a]=hK(null),[l,u]=hK(null),[c,d]=hK(null),[p,f]=hK(0),h=gK(null),g=Je(e=>e.appContext.isRTL),m=Je(e=>e.queryObject.disable_window_focus);null===mK&&(mK=m||"false");const v=Je(e=>e.queryObject.draft)?"draft":"published",y=Je(e=>e.appConfig.timestamp),S=Je(e=>e.appRuntimeInfo.currentPageId),b=Je(e=>{var t;return null===(t=e.appConfig.pages[S])||void 0===t?void 0:t.mode}),w=Je(e=>{var t;return null===(t=e.appConfig.pages[S])||void 0===t?void 0:t.autoOpenDialogId}),I=Je(e=>e.appRuntimeInfo.currentDialogId),E=Je(e=>e.appRuntimeInfo.appMode!==ka.Run),O=Je(e=>e.appRuntimeInfo.appMode===ka.Express),C=Je(e=>{var t,n;return null===(n=null===(t=e.appConfig)||void 0===t?void 0:t.forBuilderAttributes)||void 0===n?void 0:n.lockLayout}),T=Je(e=>e.browserSizeMode),x=Je(e=>{var t,n,r;return null===(r=null===(n=null===(t=e.appConfig)||void 0===t?void 0:t.forBuilderAttributes)||void 0===n?void 0:n.viewPortSize)||void 0===r?void 0:r[T]})||Td[T][1],[A,D]=hK(window.innerHeight),R=window.jimuConfig.isInBuilder?x.height:A,P=He(),j=vK(),L=Je(e=>gI(e.queryObject.dlg,e.appConfig)),_=Je(e=>e.appRuntimeInfo.dialogInfos),M=Je(e=>{var t;return n.isSplash?n.id:e.appConfig.dialogs&&(null===(t=e.appConfig.dialogs[Object.keys(e.appConfig.dialogs).find(t=>e.appConfig.dialogs[t].isSplash)])||void 0===t?void 0:t.id)},ye),[N,k]=hK(r.isOpenByPage&&I===M||n.id===L&&I!==L||I===n.id),U=r.isOpenByPage?S+"-"+n.id:n.id,[B,$]=hK(!(!_||!_[U])&&_[U].checked),V=n.sizeMode[T]||n.sizeMode[La.Large],G=V.position===Xh.MiddleCenter,W=gK(null),[H,z]=hK(null),[q,J]=hK(!0),[K,Y]=hK(!1),X=e=>{var t;return null===(t=null==_?void 0:_[e])||void 0===t?void 0:t.isClosed},Q=()=>E&&(O||!C)&&window.jimuConfig.isInBuilder,Z=()=>{D(window.innerHeight)};fK(()=>{if(Q()&&l&&c){const e=BE(()=>{if(H&&H.unset(),W.current){const e=n.sizeMode[T]?T:La.Large;z(function(e,t,n,r,i){let o,s,a,l,u,c;const d=n.sizeMode[r],p=TE().getState().appContext.isRTL,f=document.querySelector(`div[id="${n.id}"] .app-dialog-content`),h=f.querySelector("div.app-dialog-resize-handlers"),g=h.querySelector("span.dialog-resize-left"),m=h.querySelector("span.dialog-resize-right"),v=h.querySelector("span.dialog-resize-top"),y=h.querySelector("span.dialog-resize-bottom"),S={};g&&(S.left=".dialog-resize-left"),m&&(S.right=".dialog-resize-right"),v&&(S.top=".dialog-resize-top"),y&&(S.bottom=".dialog-resize-bottom");const b="CUSTOM"===d.widthMode&&parseFloat(d.width.includes("%")?d.width.split("%")[0]:d.width.split("px")[0]),w="CUSTOM"===d.heightMode&&parseFloat(d.height.includes("%")?d.height.split("%")[0]:d.height.split("px")[0]);return e(t).resizable({edges:S}).on("resizestart",e=>{e.stopPropagation(),o=0,s=0;const n=t.getBoundingClientRect();u=n.width,c=n.height,t.style.minWidth="0px",t.style.minHeight="0px"}).on("resizemove",(e,n)=>{e.stopPropagation();const r=e.deltaRect;o+=r.width*(p?-1:1),s+=r.height,a=o,l=s;const i=b&&`${u+o}px`,h=w&&`${c+s}px`;if(t.style.width=i,t.style.height=h,"CUSTOM"===d.widthMode)f.style.width=i;else{const t=e.edges.left?"left":"right",n=d[t].includes("px");let r=parseFloat(d[t].split("px")[0]);r=n?Math.max(0,r-o)+"px":Math.max(0,r-o/document.body.clientWidth*100)+"%",f.style[t]=r}if("CUSTOM"===d.heightMode)f.style.height=h;else{const t=e.edges.top?"top":"bottom",n=d[t].includes("px");let r=parseFloat(d[t].split("px")[0]);r=n?Math.max(0,r-s)+"px":Math.max(0,r-s/document.body.clientHeight*100)+"%",f.style[t]=r}v&&(v.style.width=i),y&&(y.style.width=i),g&&(g.style.height=h),m&&(m.style.height=h)}).on("resizeend",e=>{e.stopPropagation();let n=TE().getState().appConfig.dialogs[TE().getState().appRuntimeInfo.currentDialogId];if(t.style.width=null,t.style.minWidth=null,t.style.height=null,t.style.minHeight=null,"CUSTOM"===d.widthMode){f.style.width=null;const e=qW(d.width.includes("px")?"px":"%",b*(u+a)/u);n=n.setIn(["sizeMode",r,"width"],e)}else{const t=e.edges.left?"left":"right";n=n.setIn(["sizeMode",r,t],f.style[t]),f.style[t]=null}if("CUSTOM"===d.heightMode){f.style.height=null;const e=qW(d.height.includes("px")?"px":"%",w*(c+l)/c);n=n.setIn(["sizeMode",r,"height"],e)}else{const t=e.edges.top?"top":"bottom";n=n.setIn(["sizeMode",r,t],f.style[t]),f.style[t]=null}v&&(v.style.width=null),y&&(y.style.width=null,y.style.top=null),g&&(g.style.height=null),m&&(m.style.height=null),i().editDialog(n).exec()})}(c,W.current,n,e,l))}},W.current?0:1e3);e()}},[E,C,I,n.sizeMode[T],V.position,V.width,V.height,l,c]),fK(()=>{$(!1)},[I]);const ee=F.useCallback(e=>{if("Tab"!==e.key)return;const t=i.getFocusableElements(e.currentTarget);if(!t||0===t.length)return void e.preventDefault();const n=t[0],r=t[t.length-1];e.shiftKey&&e.target===n?(e.preventDefault(),k_(r,!0)):e.shiftKey||e.target!==r||(e.preventDefault(),k_(n,!0))},[i]);fK(()=>{var e,t;if(n.isSplash||r.isOpenByPage)return;const i=null===(e=W.current)||void 0===e?void 0:e.parentNode.parentNode.parentNode.parentNode;return r.isCurrentDialog?(h.current&&P(LD(h.current)),"BUTTON"!==document.activeElement.tagName&&"A"!==document.activeElement.tagName||(window.openedDialogElement=document.activeElement,null==i||i.addEventListener("keydown",ee)),f(Math.ceil(1e3*Math.random()))):(null===(t=window.openedDialogElement)||void 0===t||t.focus(),P(_D(h.current))),()=>{null==i||i.removeEventListener("keydown",ee)}},[r.isCurrentDialog,n.isSplash,r.isOpenByPage,ee,P]),fK(()=>{var e;if(p&&I&&!n.isSplash&&!r.isOpenByPage){const t=null===(e=document.getElementById(I))||void 0===e?void 0:e.parentNode;t&&k_(t)}},[p,I,n.isSplash,r.isOpenByPage]),fK(()=>{var e;Promise.all([wK(),zW()]).then(e=>{o(e[0]),a(e[1])}),window.jimuConfig.isInBuilder?(l||NI("jimu-for-builder").then(e=>{u(()=>e.getAppConfigAction)}),c||NI("jimu-core/dnd").then(e=>{d(()=>e.interact)})):window.jimuConfig.isBuilder||(null===(e=V.height)||void 0===e?void 0:e.includes("%"))&&window.addEventListener("resize",Z);const t=bK(M,v,y),i="true"===Ow(t.newKey)||"true"===Ow(t.oldKey);return(n.isSplash&&!X(M)&&(window.jimuConfig.isInBuilder||!i)||r.isOpenByPage&&(M&&(X(M)||window.jimuConfig.isInBuilder||i)||!M))&&!yK({currentPageId:S,dialogProps:{dialogJson:n,runtime:r.runtime,isOpenByPage:r.isOpenByPage},runtimeMode:v,timestamp:y,dialogInfos:_,dispatch:P})&&n.id!==L&&n.id!==I&&(P(ED(n.id)),P(PD(null))),()=>{var e;E&&H&&H.unset(),!window.jimuConfig.isBuilder&&(null===(e=V.height)||void 0===e?void 0:e.includes("%"))&&window.removeEventListener("resize",Z);const t=TE().getState(),n=t.appRuntimeInfo.dialogInfos;if(n){const e=n[re()];(null==e?void 0:e.canClose)&&ne(t)}}},[]);const te=null===(t=null==_?void 0:_[I])||void 0===t?void 0:t.alertVersion;fK(()=>{if(te>=1){Y(!0);BE(()=>{Y(!1)},800)()}},[te]),fK(()=>{if(Ow("exb-link-dialog"))return;let e=!1;if(n.isSplash||r.isOpenByPage||I){e=!yK({currentPageId:S,dialogProps:{dialogJson:n,runtime:r.runtime,isOpenByPage:r.isOpenByPage},runtimeMode:v,timestamp:y,dialogInfos:_,dispatch:P,urlDlgId:L})}e!==N&&k(e)});const ne=e=>{var t,i,o;if(mK="false",n.isSplash||r.isOpenByPage){!function(e){var t;const{currentPageId:n,dialogProps:r,runtimeMode:i,timestamp:o,dialogInfos:s,dispatch:a}=e,{dialogJson:l,runtime:u}=r,c=l.isSplash?l.id:`${n}-${l.id}`;u&&l.interactionType&&(l.confirmBeforeClose&&!l.alwaysShowConfirmation||!l.confirmBeforeClose&&(null===(t=null==s?void 0:s[c])||void 0===t?void 0:t.checked))&&Cw(bK(c,i,o).newKey,"true");SK(s,c,a)}({currentPageId:S,dialogProps:{dialogJson:n,runtime:r.runtime},runtimeMode:v,timestamp:y,dialogInfos:(null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.dialogInfos)||_,dispatch:P});const o=ie(e);if(P(ED(o)),k(!1),o){k_(null===(i=document.getElementById(o))||void 0===i?void 0:i.parentNode)}else ob(null),P(PD(Ha.Body))}else SK((null===(o=null==e?void 0:e.appRuntimeInfo)||void 0===o?void 0:o.dialogInfos)||_,n.id,P),ob(null),P(PD(Ha.Body))},re=()=>r.isOpenByPage?S+"-"+n.id:n.id,ie=e=>{var t,i,o,s,a,l,u;let c=L,d=I;if((n.isSplash||r.isOpenByPage)&&(c=gI(null==e?void 0:e.queryObject.dlg,null==e?void 0:e.appConfig),d=null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.currentDialogId,window.jimuConfig.isInBuilder)){if(n.isSplash){if(w&&!(null===(s=null===(o=e?null===(i=e.appRuntimeInfo)||void 0===i?void 0:i.dialogInfos:_)||void 0===o?void 0:o[S+"-"+w])||void 0===s?void 0:s.isClosed))return w;if(n.isSplash&&c===n.id&&(null===(u=null===(l=null===(a=null==e?void 0:e.appRuntimeInfo)||void 0===a?void 0:a.dialogInfos)||void 0===l?void 0:l[n.id])||void 0===u?void 0:u.isClosed))return null}return c}let p=n.isSplash&&(w||c)||r.isOpenByPage&&d!==c&&c||null;return d===p&&(p=null),p},oe=!r.isCurrentDialog&&!n.isSplash&&!r.isOpenByPage,se=n.mode===Kh.Fixed,ae=se&&n.blockPage,le=n.isSplash,ue=r.isOpenByPage;if(fK(()=>{if(b!==Jh.AutoScroll||!se||le||ue)return;const e=document.getElementsByTagName("html")[0],t=document.body;ae?(oe?(e.style.overflow="auto",document.body.style.paddingRight=null):e.style.overflow="hidden",t.style.removeProperty("overflow")):oe||setTimeout(()=>{e.style.overflow="auto",t.style.removeProperty("overflow"),document.body.style.paddingRight=null},100)},[oe,b,se,ae,le,ue]),!i||!s)return null;const{Modal:ce}=i,de=Mw().Global,pe=n.blockPage||n.isOpenerDlg;return(0,sg.jsxs)(ce,{"aria-label":n.label,autoFocus:"true"!==mK,disableActivateOverlay:!0,centered:G,css:ZW(V,R,n.interactionType),id:n.id,isOpen:!n.isSplash&&!r.isOpenByPage||N,toggle:()=>{var e,t;if(!E||O){if(n.interactionType&&n.confirmBeforeClose&&!B){const n=(_||Ye({})).set(re(),{canClose:!1,checked:!1,alertVersion:(null!==(t=null===(e=null==_?void 0:_[re()])||void 0===e?void 0:e.alertVersion)&&void 0!==t?t:0)+1,isClosed:!1});return void P(OD(n))}if(N&&n.closeWhenClickOverlay){const e=n.isSplash||r.isOpenByPage?TE().getState():null;ne(e)}else HW(P)}else HW(P)},fade:!1,wrapClassName:Ze()(`app-dialog-wrap app-dialog-wrap-${n.id}${!0===pe?"":" no-backdrop"}`,{"d-none":oe}),modalClassName:"app-dialog-modal",className:"app-dialog w-100 h-100",backdropClassName:"app-dialog-backdrop",backdrop:!0===pe,"aria-modal":pe||!1,contentClassName:"app-dialog-content",onOpened:()=>{J(!1)},overlayIdRef:h,children:[(0,sg.jsx)(de,{styles:QW(n,N,i.styleUtils.toCSSBoxshadow(n.boxShadow))}),(0,sg.jsxs)("div",{className:"app-dialog-resize-container",css:tH(g),ref:e=>{W.current=e},children:[(0,sg.jsx)("div",{className:"w-100 h-100",children:!q&&(0,sg.jsx)(sK,{dialogJson:n,isOpen:N,jimuUI:i,jimuLayout:s,cbxAnimation:K,messages:j,isChecked:B,setCbxState:e=>{$(e);const t=!n.interactionType||!n.confirmBeforeClose||e,r=(_||Ye({})).set(re(),{canClose:t,checked:e,isClosed:!1});P(OD(r))},closeDialog:ne,version:p})}),Q()&&(0,sg.jsx)(cK,{dialogSizeMode:V,isDesignMode:E,isRTL:g})]})]})};var EK=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const{useEffect:OK,useState:CK,useRef:TK}=F,xK={crossAxis:!0,padding:6},AK={boundary:document.body,fallbackPlacements:["top","right","left"]};function DK(){return EK(this,void 0,void 0,function*(){return yield NI("jimu-ui")})}const RK=function({dialogJson:e,opener:t,isCurrentDialog:n,toggle:r}){const[i,o]=CK(null),[s,a]=CK(null),l=TK(0),[u,c]=CK(!0),d=TK(!1),[p,f]=CK(e.effect&&e.effect.type!==kJ.None),h=Je(e=>e.appRuntimeInfo.appMode===ka.Design),g=Je(e=>e.appRuntimeInfo.currentDialogId),m=Je(e=>e.browserSizeMode),v=e.sizeMode[m]||e.sizeMode[La.Large];if(OK(()=>{Promise.all([DK(),zW()]).then(e=>{o(e[0]),a(e[1])})},[]),OK(()=>{h&&g===e.id&&r(null,"pageOrSizeMode")},[h]),OK(()=>{var r;n&&d.current!==n?(l.current=100,c(!0),e.effect&&e.effect.type!==kJ.None?(f(!0),setTimeout(()=>{f(!1)},200)):f(!1)):(l.current=0,f(!0),c(!1),null===(r=document.getElementById(t))||void 0===r||r.focus()),d.current=n},[n,e.effect,t]),!i||!s)return null;const{Popper:y}=i;return(0,sg.jsx)(y,{open:!0,arrowOptions:!!t,arrowAfterContent:!0,toggle:r,reference:t,shiftOptions:xK,flipOptions:AK,css:eH(e,v,i.styleUtils.toCSSBoxshadow(e.boxShadow)),disableActivateOverlay:e.closeWhenClickOverlay,autoFocus:u,version:l.current,className:Ze()("app-dialog",{"dialog-animation-playing":p,"dialog-animation-end":!p,"d-none":!n}),children:(0,sg.jsx)(sK,{jimuUI:i,jimuLayout:s,isOpen:u,dialogJson:e,version:l.current})})},{useEffect:PK}=F;function jK(e){const t=Je(e=>e.queryObject.draft)?"draft":"published",n=Je(e=>e.appConfig.timestamp),r=Je(e=>e.appRuntimeInfo.currentPageId),i=Je(e=>e.appRuntimeInfo.appMode===ka.Design),o=Je(e=>e.browserSizeMode),s=e.dialogJson.sizeMode[o]?o:La.Large,a=He();if(PK(()=>{e.runtime&&function(e,t){const n=TE().getState().appConfig.dialogs,r=Object.keys(n).filter(e=>n[e]),i=hw();Ew().forEach(n=>{!n.includes(t)&&r.forEach(t=>{n.includes(t)&&("draft"===e?n.includes(`${i}-draft`):n.includes(`${i}-release`)||n.includes(`${i}-published`))&&Rw(n)})})}(t,n)},[e.runtime,t,n]),PK(()=>{a(CD(null))},[i,e.dialogJson.id,r]),e.dialogJson.mode===Kh.Fixed)return(0,sg.jsx)(IK,Object.assign({},e));if(window.jimuConfig.isInBuilder&&!e.opener){const t=e.dialogJson.set("mode",Kh.Fixed).set("isOpenerDlg",!0).setIn(["sizeMode",s,"position"],Xh.MiddleCenter).setIn(["sizeMode",s,"widthMode"],"CUSTOM").setIn(["sizeMode",s,"heightMode"],"CUSTOM");return(0,sg.jsx)(IK,{dialogJson:t,opener:e.opener,isOpenByPage:e.isOpenByPage,isCurrentDialog:!0})}return(0,sg.jsx)(RK,Object.assign({},e))}var LK;!function(e){e.None="NONE",e.Skew="SKEW",e.Grow="GROW",e.Shrink="SHRINK",e.Float="FLOAT",e.Sink="SINK",e.Rotate="ROTATE",e.Spin="SPIN",e.Forward="FORWARD",e.Backward="BACKWARD",e.Opacity="OPACITY",e.Custom="CUSTOM"}(LK||(LK={}));const _K={translateX:"0%",translateY:"0%",scaleX:1,scaleY:1,rotate:"0deg",skewX:"0deg",skewY:"0deg",opacity:1};class MK{constructor(e,t){this.type=e,this.option=t}generateProps(e){return Object.assign({},_K,e)}}class NK extends MK{constructor(e){super(LK.Skew),this.x=(null==e?void 0:e.skewX)||0,this.y=(null==e?void 0:e.skewY)||0,0===this.x&&0===this.y&&(this.x=-20)}animateProps(){return{from:this.generateProps({skewX:"0deg",skewY:"0deg",transform:"perspective(1px) translateZ(0)",transformOrigin:"0% 100%"}),to:this.generateProps({skewX:`${this.x}deg`,skewY:`${this.y}deg`}),loop:{skewX:"0deg",skewY:"0deg",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;
      transform-origin: 0 100%;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) skew(${this.x}deg, ${this.y}deg);
      }
    `}}class kK extends MK{constructor(e){super(LK.Grow),this.x=(null==e?void 0:e.scaleX)||110,this.y=(null==e?void 0:e.scaleY)||110}animateProps(){return{from:this.generateProps({scaleX:1,scaleY:1,transform:"perspective(1px) translateZ(0)",transformOrigin:"50% 50%"}),to:this.generateProps({scaleX:this.x/100,scaleY:this.y/100}),loop:{scaleX:1,scaleY:1,reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) scale(${this.x/100}, ${this.y/100});
      }
    `}}class UK extends MK{constructor(e){super(LK.Shrink),this.x=(null==e?void 0:e.scaleX)||90,this.y=(null==e?void 0:e.scaleY)||90}animateProps(){return{from:this.generateProps({scaleX:1,scaleY:1,transform:"perspective(1px) translateZ(0)",transformOrigin:"50% 50%"}),to:this.generateProps({scaleX:this.x/100,scaleY:this.y/100}),loop:{scaleX:1,scaleY:1,reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) scale(${this.x/100}, ${this.y/100});
      }
    `}}class FK extends MK{constructor(e){super(LK.Float),this.x=(null==e?void 0:e.offsetX)||0,this.y=(null==e?void 0:e.offsetY)||10}animateProps(){return{from:this.generateProps({translateX:"0%",translateY:"0%",transform:"perspective(1px) translateZ(0)"}),to:this.generateProps({translateX:`${this.x}%`,translateY:-this.y+"%"}),loop:{translateX:"0%",translateY:"0%",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;
      transition-timing-function: ease-out;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) translate(${this.x}%, ${-this.y}%);
      }
    `}}class BK extends MK{constructor(e){super(LK.Sink),this.x=(null==e?void 0:e.offsetX)||0,this.y=(null==e?void 0:e.offsetY)||-10}animateProps(){return{from:this.generateProps({translateX:"0%",translateY:"0%",transform:"perspective(1px) translateZ(0)"}),to:this.generateProps({translateX:`${this.x}%`,translateY:-this.y+"%"}),loop:{translateX:"0%",translateY:"0%",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;
      transition-timing-function: ease-out;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) translate(${this.x}%, ${-this.y}%);
      }
    `}}class $K extends MK{constructor(e){super(LK.Rotate),this.rotate=(null==e?void 0:e.rotate)||3}animateProps(){return{from:this.generateProps({rotate:"0deg",transform:"perspective(1px) translateZ(0)",transformOrigin:"50% 50%"}),to:this.generateProps({rotate:`${this.rotate}deg`}),loop:{rotate:"0deg",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) rotate(${this.rotate}deg);
      }
    `}}class VK extends MK{constructor(e){super(LK.Spin),this.rotate=(null==e?void 0:e.rotate)||-720}animateProps(){return{from:this.generateProps({rotate:"0deg",transform:"perspective(1px) translateZ(0)",transformOrigin:"50% 50%"}),to:this.generateProps({rotate:`${this.rotate}deg`}),loop:{rotate:"0deg",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) rotate(${this.rotate}deg);
      }
    `}}class GK extends MK{constructor(e){super(LK.Forward),this.x=(null==e?void 0:e.offsetX)||10,this.y=(null==e?void 0:e.offsetY)||0}animateProps(){return{from:this.generateProps({translateX:"0%",translateY:"0%",transform:"perspective(1px) translateZ(0)"}),to:this.generateProps({translateX:`${this.x}%`,translateY:`${this.y}%`}),loop:{translateX:"0%",translateY:"0%",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;
      transition-timing-function: ease-out;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) translate(${this.x}%, ${this.y}%);
      }
    `}}class WK extends MK{constructor(e){super(LK.Backward),this.x=(null==e?void 0:e.offsetX)||-10,this.y=(null==e?void 0:e.offsetY)||0}animateProps(){return{from:this.generateProps({translateX:"0%",translateY:"0%",transform:"perspective(1px) translateZ(0)"}),to:this.generateProps({translateX:`${this.x}%`,translateY:`${this.y}%`}),loop:{translateX:"0%",translateY:"0%",reverse:!0}}}cssProps(){return sg.css`
      display: inline-block;
      vertical-align: middle;
      box-shadow: 0 0 1px rgba(0, 0, 0, 0);
      transition-duration: 0.3s;
      transition-property: transform;

      &:hover, &:focus, &:active {
        transform: perspective(1px) translateZ(0) translate(${this.x}%, ${this.y}%);
      }
    `}}class HK extends MK{constructor(e){super(LK.Opacity),this.opacity=(null==e?void 0:e.opacity)||50}animateProps(){return{from:this.generateProps({opacity:1}),to:this.generateProps({opacity:this.opacity/100}),loop:{opacity:1,reverse:!0}}}cssProps(){return sg.css`
      transition-duration: 0.3s;
      transition-property: opacity;
      opacity: 1;

      &:hover, &:focus, &:active {
        opacity: ${this.opacity/100};
      }
    `}}function zK(e,t){switch(e){case LK.Skew:return new NK(t);case LK.Grow:return new kK(t);case LK.Shrink:return new UK(t);case LK.Float:return new FK(t);case LK.Sink:return new BK(t);case LK.Rotate:return new $K(t);case LK.Spin:return new VK(t);case LK.Forward:return new GK(t);case LK.Backward:return new WK(t);case LK.Opacity:return new HK(t);default:return null}}function qK(e,t){const n=zK(e,t);return null==n?void 0:n.cssProps()}var JK,KK;!function(e){e.Horizontal="H",e.Vertical="V"}(JK||(JK={})),function(e){e.Cube="CUBE",e.Cover="COVER",e.Fade="FADE",e.Push="PUSH",e.Box="BOX",e.None="None"}(KK||(KK={}));const YK={type:"tween",duration:.5,ease:"easeOut"},XK={type:"tween",duration:0},QK={type:"tween"};class ZK{constructor(e=!1,t=JK.Horizontal){this.isRTL=e,this.direction=t}getVariants(){const e=this.direction===JK.Horizontal&&this.isRTL?-1:1;return{hideView:{zIndex:0,opacity:0},showView:{zIndex:1,opacity:1,x:0,y:0,rotateX:0,rotateY:0,transition:XK},toPrevious:Object.assign({x:0,y:0,rotateX:this.direction===JK.Horizontal?0:-90,rotateY:this.direction===JK.Horizontal?90*e:0,opacity:1,transformPerspective:1e3,transition:YK},this.getDiscreteOrigin(1,2,1,!1)),toNext:Object.assign({x:0,y:0,rotateX:this.direction===JK.Horizontal?0:90,rotateY:this.direction===JK.Horizontal?-90*e:0,opacity:1,transformPerspective:1e3,transition:YK},this.getDiscreteOrigin(2,1,2,!1)),fromPrevious:Object.assign({x:[0,0],y:[0,0],rotateX:[this.direction===JK.Horizontal?0:-90*e,0],rotateY:[this.direction===JK.Horizontal?90*e:0,0],opacity:[1,1],transformPerspective:1e3,transition:YK},this.getDiscreteOrigin(1,1,2,!1)),fromNext:Object.assign({x:[0,0],y:[0,0],rotateX:[this.direction===JK.Horizontal?0:90*e,0],rotateY:[this.direction===JK.Horizontal?-90*e:0,0],opacity:[0,1],transformPerspective:1e3,transition:YK},this.getDiscreteOrigin(2,2,1,!1))}}getTransitionProps(e,t,n,r=1){const i=e===t||e===n,o=this.getContinuousOrigin(e,t,n);if(i){let i,s=r-n;return t===n&&(s=1),i=this.direction===JK.Vertical||this.isRTL?e===t?90*(1-s):-90*s:e===t?-90*(1-s):90*s,Object.assign({rotateX:this.direction===JK.Horizontal?0:i,rotateY:this.direction===JK.Horizontal?i:0,opacity:1,x:0,y:0,transformPerspective:1e3,transition:QK},o)}const s=this.isRTL?-1:1;return e>t?Object.assign({rotateX:this.direction===JK.Horizontal?0:90*s,rotateY:this.direction===JK.Horizontal?-90*s:0,opacity:0,x:0,y:0,transition:QK,transformPerspective:1e3},o):Object.assign({rotateX:this.direction===JK.Horizontal?0:-90*s,rotateY:this.direction===JK.Horizontal?90*s:0,opacity:0,x:0,y:0,transition:QK,transformPerspective:1e3},o)}getContinuousOrigin(e,t,n){const r={originX:0,originY:"50%"},i={originX:"100%",originY:"50%"},o={originY:0,originX:"50%"},s={originY:"100%",originX:"50%"};return e===t?this.direction===JK.Vertical?t>n?s:o:this.isRTL?t>n?r:i:t>n?i:r:this.direction===JK.Vertical?e>t?s:o:this.isRTL?e>t?r:i:e>t?i:r}getDiscreteOrigin(e,t,n,r){if(this.direction===JK.Vertical){const i={originY:[0,0],originX:["50%","50%"]},o={originY:["100%","100%"],originX:["50%","50%"]};if(e===t)return t>n||r?o:i;if(e===n)return t>n||r?i:o}const i={originX:[0,0],originY:["50%","50%"]},o={originX:["100%","100%"],originY:["50%","50%"]};if(this.isRTL){if(e===t)return t>n||r?i:o;if(e===n)return t>n||r?o:i}else{if(e===t)return t>n||r?o:i;if(e===n)return t>n||r?i:o}return{}}}class eY{constructor(e=!1,t=JK.Horizontal){this.isRTL=e,this.direction=t}initOffset(e,t,n,r){if(t!==n)return 0;let i=e-r;return n===r&&(i=1),this.direction===JK.Horizontal&&this.isRTL?100*(i-1):100*(1-i)}getVariants(){const e=this.direction===JK.Horizontal&&this.isRTL?-1:1;return{hideView:{zIndex:0,opacity:0},showView:{zIndex:1,opacity:1,x:0,y:0,rotateX:0,rotateY:0,transition:XK},toPrevious:null,toNext:null,fromPrevious:{rotateX:[0,0],rotateY:[0,0],x:[this.direction===JK.Horizontal?-100*e+"%":0,0],y:[this.direction===JK.Horizontal?0:-100*e+"%",0],transition:YK,zIndex:1},fromNext:{rotateX:[0,0],rotateY:[0,0],x:[this.direction===JK.Horizontal?100*e+"%":0,0],y:[this.direction===JK.Horizontal?0:100*e+"%",0],transition:YK,zIndex:1}}}getTransitionProps(e,t,n,r=1){let i;return i=e===t||e===n?this.initOffset(r,e,t,n):e>t?this.direction===JK.Horizontal&&this.isRTL?-100:100:0,{x:this.direction===JK.Horizontal?`${i}%`:"0",y:this.direction===JK.Horizontal?"0":`${i}%`,opacity:1,transition:QK}}}class tY{getTransitionProps(e,t,n,r=1){let i;if(e===t||e===n){let o=r-n;t===n&&(o=1),i=e===t?o:1-o}else i=0;return{x:0,y:0,rotateX:0,rotateY:0,transition:QK,opacity:i}}getVariants(){return{hideView:{zIndex:0,opacity:0},showView:{zIndex:1,opacity:1,x:0,y:0,rotateX:0,rotateY:0,transition:XK},toPrevious:{opacity:0,x:0,y:0,rotateX:0,rotateY:0,transition:YK,zIndex:0},toNext:{opacity:0,x:0,y:0,rotateX:0,rotateY:0,transition:YK,zIndex:0},fromPrevious:{rotateX:[0,0],rotateY:[0,0],x:[0,0],y:[0,0],opacity:[0,1],transition:YK,zIndex:1},fromNext:{rotateX:[0,0],rotateY:[0,0],x:[0,0],y:[0,0],opacity:[0,1],transition:YK,zIndex:1}}}}class nY{constructor(e=!1,t=JK.Horizontal){this.isRTL=e,this.direction=t}initOffset(e,t,n,r){let i=e-r;return n===r&&(i=1),t===n?this.direction===JK.Horizontal&&this.isRTL?100*(i-1):100*(1-i):this.direction===JK.Horizontal&&this.isRTL?100*i:-100*i}getVariants(){const e=this.direction===JK.Horizontal&&this.isRTL?-1:1;return{hideView:{zIndex:0,opacity:0},showView:{zIndex:1,opacity:1,x:0,y:0,rotateX:0,rotateY:0,transition:XK},toPrevious:{x:this.direction===JK.Horizontal?-100*e+"%":0,y:this.direction===JK.Horizontal?0:-100*e+"%",rotateX:0,rotateY:0,opacity:1,transition:YK},toNext:{x:this.direction===JK.Horizontal?100*e+"%":0,y:this.direction===JK.Horizontal?0:100*e+"%",rotateX:0,rotateY:0,opacity:1,transition:YK},fromPrevious:{rotateX:[0,0],rotateY:[0,0],x:[this.direction===JK.Horizontal?-100*e+"%":0,0],y:[this.direction===JK.Horizontal?0:-100*e+"%",0],transition:YK,zIndex:1},fromNext:{rotateX:[0,0],rotateY:[0,0],x:[this.direction===JK.Horizontal?100*e+"%":0,0],y:[this.direction===JK.Horizontal?0:100*e+"%",0],transition:YK,zIndex:1}}}getTransitionProps(e,t,n,r=1){let i;return i=e===t||e===n?this.initOffset(r,e,t,n):e>t?this.direction===JK.Horizontal&&this.isRTL?-100:100:this.direction===JK.Horizontal&&this.isRTL?100:-100,{x:this.direction===JK.Horizontal?`${i}%`:"0",y:this.direction===JK.Horizontal?"0":`${i}%`,transition:QK,opacity:1}}}const rY=60;class iY{constructor(e=!1,t=JK.Horizontal){this.isRTL=e,this.direction=t}initState(e,t,n,r){let i=e-r;return n===r&&(i=1),t===n?[100*(1-i),(1-i)*rY]:[-100*i,-60*i]}getContinuousOrigin(e,t,n){const r={originX:0,originY:"50%"},i={originX:"100%",originY:"50%"},o={originY:0,originX:"50%"},s={originY:"100%",originX:"50%"};return e===t?this.direction===JK.Vertical?t<n?s:o:this.isRTL?t<n?r:i:t<n?i:r:this.direction===JK.Vertical?e<t?s:o:this.isRTL?e<t?r:i:e<t?i:r}getVariants(){const e=this.isRTL?-1:1;return{hideView:{zIndex:0,opacity:0},showView:{zIndex:1,opacity:1,x:0,y:0,rotateX:0,rotateY:0,transition:XK},toPrevious:Object.assign({rotateX:this.direction===JK.Horizontal?0:rY,rotateY:this.direction===JK.Horizontal?-60*e:0,x:this.direction===JK.Horizontal?-100*e+"%":0,y:this.direction===JK.Horizontal?0:"-100%",opacity:0,transformPerspective:1e3,zIndex:0,transition:YK},this.getDiscreteOrigin(1,2,1,!1)),toNext:Object.assign({rotateX:this.direction===JK.Horizontal?0:-60,rotateY:this.direction===JK.Horizontal?rY*e:0,x:this.direction===JK.Horizontal?100*e+"%":0,y:this.direction===JK.Horizontal?0:"100%",opacity:0,transformPerspective:1e3,zIndex:0,transition:YK},this.getDiscreteOrigin(2,1,2,!1)),fromPrevious:Object.assign({rotateX:[this.direction===JK.Horizontal?0:rY,0],rotateY:[this.direction===JK.Horizontal?-60*e:0,0],x:[this.direction===JK.Horizontal?-100*e+"%":0,0],y:[this.direction===JK.Horizontal?0:"-100%",0],opacity:[0,1],transformPerspective:1e3,zIndex:1,transition:YK},this.getDiscreteOrigin(1,1,2,!1)),fromNext:Object.assign({rotateX:[this.direction===JK.Horizontal?0:-60,0],rotateY:[this.direction===JK.Horizontal?rY*e:0,0],x:[this.direction===JK.Horizontal?100*e+"%":0,0],y:[this.direction===JK.Horizontal?0:"100%",0],opacity:[0,1],transformPerspective:1e3,zIndex:1,transition:YK},this.getDiscreteOrigin(2,2,1,!1))}}getDiscreteOrigin(e,t,n,r){if(this.direction===JK.Vertical)return e===t?t>n||r?{originY:[0,0],originX:["50%","50%"]}:{originY:["100%","100%"],originX:["50%","50%"]}:e<t||r?{originY:["100%","100%"],originX:["50%","50%"]}:{originY:[0,0],originX:["50%","50%"]};const i={originX:[0,0],originY:["50%","50%"]},o={originX:["100%","100%"],originY:["50%","50%"]};return this.isRTL?e===t?t>n||r?o:i:e<t||r?i:o:e===t?t>n||r?i:o:e<t||r?o:i}getTransitionProps(e,t,n,r=1){const i=e===t||e===n,o=this.isRTL?-1:1,s=this.getContinuousOrigin(e,t,n);if(i){const[i,a]=this.initState(r,e,t,n);let l=r-n;return t===n&&(l=1),e===t?Object.assign({rotateX:this.direction===JK.Horizontal?0:-a,rotateY:this.direction===JK.Horizontal?a*o:0,x:this.direction===JK.Horizontal?i*o+"%":0,y:this.direction===JK.Horizontal?0:`${i}%`,opacity:l,transformPerspective:1e3,transition:QK},s):Object.assign({rotateX:this.direction===JK.Horizontal?0:-a,rotateY:this.direction===JK.Horizontal?a*o:0,x:this.direction===JK.Horizontal?i*o+"%":0,y:this.direction===JK.Horizontal?0:`${i}%`,opacity:1-l,transformPerspective:1e3,transition:QK},s)}return e>t?Object.assign({rotateX:this.direction===JK.Horizontal?0:-60,rotateY:this.direction===JK.Horizontal?rY*o:0,x:this.direction===JK.Horizontal?100*o+"%":0,y:this.direction===JK.Horizontal?0:"100%",opacity:0,transformPerspective:1e3,transition:QK},s):Object.assign({rotateX:this.direction===JK.Horizontal?0:rY,rotateY:this.direction===JK.Horizontal?-60*o:0,x:this.direction===JK.Horizontal?-100*o+"%":0,y:this.direction===JK.Horizontal?0:"-100%",opacity:0,transformPerspective:1e3,transition:QK},s)}}function oY(){var e,t;return null!==(t=null===(e=TE().getState().appContext)||void 0===e?void 0:e.isRTL)&&void 0!==t&&t}function sY(e){return Math.abs(e-Math.round(e))<1e-7}function aY(e,t){let n,r;const i=lY(e,0,1)*(t-1),o=Math.floor(i);return r=o,r=sY(i)?Math.round(i)-1:o,n=r+1,n=lY(n,0,t-1),r=lY(r,0,t-1),{previousIndex:r,progress:i,currentIndex:n}}function lY(e,t,n){return Math.max(t,Math.min(e,n))}function uY(e,t=JK.Horizontal){switch(e){case KK.Cover:return new eY(oY(),t);case KK.Cube:return new iY(oY(),t);case KK.Fade:return new tY;case KK.Push:return new nY(oY(),t);case KK.Box:return new ZK(oY(),t);default:return null}}function cY(e,t,n,r,i,o){const s={};return r!==ka.Design||i?(t>n||o?(s[`${t}`]=`${e}_fromNext`,s[`${n}`]=`${e}_toPrevious`):(s[`${t}`]=`${e}_fromPrevious`,s[`${n}`]=`${e}_toNext`),s):(s[`${t}`]=`${e}_showView`,s)}function dY(e){const{useProgress:t=!1,progress:n,currentIndex:r,previousIndex:i,direction:o,transitionType:s,children:a,playId:l,withOneByOne:u,previewId:c,previewMode:d,loop:p,oneByOneSetting:f}=e,h=F.useId(),g=v_(l),m=v_(c),[v,y]=F.useState(),[S,b]=F.useState(),w=F.Children.count(a),I=Je(e=>{var t;return null===(t=e.appRuntimeInfo)||void 0===t?void 0:t.appMode}),[E,O]=F.useMemo(()=>{const e=null==f?void 0:f[NJ.ScrollIntoView];if(e){return[YJ(e),KJ(e)]}return[null,null]},[f]),C=F.useMemo(()=>uY(s,o),[s,o]),T=F.useMemo(()=>{if(C){const e=C.getVariants();if(e){const t={};return Object.keys(e).forEach(n=>{t[`${h}_${n}`]=e[n]}),t}}},[C,h]),[x,A,D]=F.useMemo(()=>{if(t){const e=aY(n,w);return[e.progress,e.currentIndex,e.previousIndex]}return[0,r,i]},[t,n,w,r,i]),R=v_(A),P=F.useCallback(()=>{u||I===ka.Run?"beforeChildren"===(null==O?void 0:O.when)?(y(cY(h,A,D,I,!0,p)),b("wait")):(y(cY(h,A,D,I,!0,p)),b("show")):(y(cY(h,A,D,I,!0,p)),b(null))},[u,null==O?void 0:O.when,I,h,p,A,D]);F.useEffect(()=>{c>0&&(!m||c>m)&&d===BJ.OneByOne&&b("hide")},[c,d,m]),F.useEffect(()=>{l>0&&(!g||l>g)&&P()},[l,g,P]),F.useEffect(()=>{!t&&R>=0&&A!==R&&(I===ka.Run?P():I===ka.Design&&(y(cY(h,A,D,I,!1,p)),b(null)))},[t,I,A,R,P,h,p,D]);return(0,sg.jsx)(sg.Fragment,{children:F.Children.map(a,(e,n)=>{var r,i;let o;const s=n===A,a=null==e?void 0:e.props,l=null!==(i=null!==(r=null==a?void 0:a.oid)&&void 0!==r?r:function(e){var t;const n=TE().getState(),r=n.appConfig.views[e];if(r)return null!==(t=r.layout[n.browserSizeMode])&&void 0!==t?t:r.layout[n.appConfig.mainSizeMode]}(null==a?void 0:a.viewId))&&void 0!==i?i:`${h}_${n}`;t?o=null==C?void 0:C.getTransitionProps(n,A,D,x):(o=null==v?void 0:v[n],!o&&v&&(o=A>n||p?`${h}_toPrevious`:`${h}_toNext`));const c={show:{opacity:1},hide:{opacity:1,transition:{type:"tween",duration:0}}};O&&(c.show.transition=O),c[`${l}_hide`]=c.hide,c[`${l}_show`]=c.show,c.section_show=c.show;let d="none";(n===A||o&&I!==ka.Design&&n===D)&&(d="block");const f=I!==ka.Design?"section":l;return(0,sg.jsx)(lz,{className:"w-100 h-100 view-content",animate:o,onAnimationComplete:()=>{(e=>{e&&(y(null),!u&&I!==ka.Run||"beforeChildren"!==(null==O?void 0:O.when)||b("show"))})(s)},variants:t?void 0:T,style:{display:d,position:"absolute",zIndex:s?1:0},children:(0,sg.jsx)(lz,{className:"w-100 h-100",animate:s&&null!=S&&!t?`${f}_${"wait"===S?"hide":S}`:void 0,onAnimationComplete:()=>{(e=>{e&&("hide"===S?b("show"):window.jimuConfig.isInBuilder&&"show"===S&&b(null))})(s)},variants:c,children:(0,sg.jsx)(XJ.Provider,{value:{variants:E,oid:l},children:e})})},n)})})}function pY(e){switch(e){case KK.Cover:case KK.Cube:case KK.Push:case KK.Box:return!0;default:return!1}}var fY=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((r=r.apply(e,t||[])).next())})};const{loadModules:hY,resolveModuleFullPath:gY}=w,{getPortalProxyUrl:mY,getStandardPortalUrl:vY,isAGOLDomain:yY,isSamePortalUrl:SY}=u,{normalize:bY,getFolder:wY}=b;let IY,EY,OY,CY,TY;class xY{constructor(){this.id="arcgis-dependency-define"}getDependencyKey(){return"jimu-arcgis"}getResources(){var e,t;if(!this.themeLoadObserver){const t=null===(e=MI("jimu-theme"))||void 0===e?void 0:e.ThemeStore;this.themeLoadObserver=null==t?void 0:t.subscribe(this.onCurrentThemeLoad.bind(this))}let n=window.jimuConfig.arcgisJsApiUrl;/\/$/.test(n)||(n+="/"),window.jimuConfig.arcgisJsApiUrl=n;const r=[{url:`${n}init.js`}],i=null===(t=MI("jimu-theme"))||void 0===t?void 0:t.getTheme;return(null==i?void 0:i())&&("dark"===i().sys.color.mode?(document.body.classList.add("calcite-mode-dark"),r.push({url:this.getAPIThemeUrl(n,!0)})):(document.body.classList.add("calcite-mode-light"),r.push({url:this.getAPIThemeUrl(n,!1)}))),window.esriConfig={has:{"esri-deprecation-warnings":!1}},[{url:"jimu-arcgis",dependencies:r}]}postInit(){return fY(this,void 0,void 0,function*(){var e,t,n;yield this.initModules(),this.initToRegisterOAuthForMainPortalAndAGOL(),OY.applicationName="ArcGIS Experience Builder";const r=TE().getState().portalUrl;CY.setLocale(TE().getState().appContext.locale),OY.request.proxyUrl=mY(r),this.initInterceptor(),OY.portalUrl=r;const i=null===(n=null===(t=null===(e=TE().getState().portalSelf)||void 0===e?void 0:e.helperServices)||void 0===t?void 0:t.geometry)||void 0===n?void 0:n.url;i&&(OY.geometryServiceUrl=i),this.addToTrustedServers(),this.replaceGetCredential()})}initModules(){return fY(this,void 0,void 0,function*(){[EY,IY,OY,CY,TY]=yield hY(["esri/identity/IdentityManager","esri/identity/OAuthInfo","esri/config","esri/intl","esri/core/Error"])})}initInterceptor(){var e;oA(AY),oA(DY),oA(RY),null===(e=OY.request.interceptors)||void 0===e||e.push({before:e=>{var t,n,r;if(Mx()){const t=e.url;if("string"==typeof t){const n=Nx(t);n&&n!==t&&(e.url=n)}}if(!dA(e.url,null===(t=e.requestOptions)||void 0===t?void 0:t.query))return;const i=sA(e.url,null===(n=e.requestOptions)||void 0===n?void 0:n.query);if(i)return i.promise;{const t=new Qg;aA(e.url,null===(r=e.requestOptions)||void 0===r?void 0:r.query,t)}},after:e=>{var t,n,r,i,o,s;if(!e||!e.url)return;if(e.url.indexOf("/rest/info")&&(null===(t=e.data)||void 0===t?void 0:t.owningSystemUrl)&&this.registerOAuthInfo(e.data.owningSystemUrl),!dA(e.url,null===(n=e.requestOptions)||void 0===n?void 0:n.query))return;const a=sA(e.url,null===(r=e.requestOptions)||void 0===r?void 0:r.query);if(a&&(a.resolve(e.data),null===(i=e.data)||void 0===i?void 0:i.editingInfo)){const t=mA.getInstance().getDataSources(),n=Object.keys(t).filter(n=>t[n].url===e.url).map(e=>t[e]);n.length>0?n.find(e=>e.getAutoRefreshInterval&&e.getAutoRefreshInterval()>0)&&lA(e.url,null===(o=e.requestOptions)||void 0===o?void 0:o.query):lA(e.url,null===(s=e.requestOptions)||void 0===s?void 0:s.query)}},error:e=>{var t,n,r,i,o,s;const a=sA(null===(t=null==e?void 0:e.details)||void 0===t?void 0:t.url,null===(r=null===(n=null==e?void 0:e.details)||void 0===n?void 0:n.requestOptions)||void 0===r?void 0:r.query);a&&(a.reject(e),lA(null===(i=null==e?void 0:e.details)||void 0===i?void 0:i.url,null===(s=null===(o=null==e?void 0:e.details)||void 0===o?void 0:o.requestOptions)||void 0===s?void 0:s.query))}})}replaceGetCredential(){const e=Tv.getInstance(),t=EY.getCredential.bind(EY);let n;EY.getCredential=(r,i)=>{try{const o=!!e.getServerKeyFromUrl(r),s=Tv.getInstance().getClientIdByUrl(r),a=e.getNoPermissionResourceInfoByUrl(r),l=e.isSignInPromptBlocked(),u=r.includes("_exbForceLogin=true");if(a){return EY.findCredential(r)?t.call(EY,r,i):Promise.reject(new TY("identity-manager:user-aborted","ABORTED"))}l&&!u&&(null==i?void 0:i.prompt)&&(i.prompt=!1);let c=null;if(!(null==i?void 0:i.prompt)||EY.findCredential(r)||e.getSessionByUrl(r)||(c=e.tryToPendingSignInDialog(r)),c)n=c.promise.then(()=>t.call(EY,r,i));else if(o||s||!(null==i?void 0:i.prompt)||EY.findCredential(r)||EY.findOAuthInfo(r))n=t.call(EY,r,i);else{const o=vY(r);n=e.useDialogToSetClientIdToConnectionsOfAppConfig(o).then(e=>(this.registerOAuthInfo(o,e),t.call(EY,r,i))).catch(()=>t.call(EY,r,i))}return n.then(e=>(this.checkSessionPermissionForUrl(r,e),e)).catch(t=>{if((null==i?void 0:i.prompt)&&e.releasePendingSignIn(r,t),"identity-manager:user-aborted"===t.name||"identity-manager:not-authorized"===t.name)this.addToNoPermissionResourceInfoList(r);else if("identity-manager:not-authenticated"===t.name){EY.findCredential(r)?e.handleInvalidToken(r):l&&this.addToNoPermissionResourceInfoList(r)}return Promise.reject(t)})}catch(e){return console.warn('replaced "getCredential" method error',e),t.call(EY,r,i)}}}checkSessionPermissionForUrl(e,t){const n=Tv.getInstance(),r=(null==e?void 0:e.indexOf("/sharing/rest/portals/self"))>0,i="/sharing"===(null==e?void 0:e.slice(-8));r||i||(n.getServerKeyFromUrl(e)?fA.getInstance().fetchArcGISServerInfo(e).then(r=>{n.checkSessionPermissionForUrl(e,t.token,t.userId,null==r?void 0:r.owningSystemUrl)}):n.checkSessionPermissionForUrl(e,t.token,t.userId,""))}addToNoPermissionResourceInfoList(e){const t=Tv.getInstance();t.getServerKeyFromUrl(e)?fA.getInstance().fetchArcGISServerInfo(e).then(n=>{t.addToNoPermissionResourceInfoList(e,"",yv.SignInCanceled,!1,null==n?void 0:n.owningSystemUrl)}):t.addToNoPermissionResourceInfoList(e,"",yv.SignInCanceled,!1)}initToRegisterOAuthForMainPortalAndAGOL(){const e=Tv.getInstance(),{portalUrl:t,isWebTier:n}=TE().getState();n||this.registerOAuthInfo(t),this.registerOAuthInfo("https://devext.arcgis.com"),this.registerOAuthInfo("https://qaext.arcgis.com"),this.registerOAuthInfo("https://www.arcgis.com"),this.syncToArcgisJSAPI(e.getSessions()),e.addSessionChangeListener(this.onSessionChangedCallback.bind(this)),this.listeningJsApiSignIn()}registerOAuthInfo(e,t){var n,r;let i=EY.findOAuthInfo(e);if(t=t||Tv.getInstance().getClientIdByUrl(e),!i&&t){const o=bY(`${window.location.origin}${wY(gY("jimu-arcgis"))}/oauth-callback.html`);i=new IY({appId:t,expiration:20159,portalUrl:e,authNamespace:"/",popup:!0,flowType:"auto",locale:null===(r=null===(n=TE().getState())||void 0===n?void 0:n.appContext)||void 0===r?void 0:r.locale,popupCallbackUrl:o}),EY.registerOAuthInfos([i])}}getFlowTypeForRegisteringOAuthInfo(e){var t;let n;if(yY(e))return"authorization-code";if(SY(e,TE().getState().portalUrl))n=null===(t=TE().getState().portalSelf)||void 0===t?void 0:t.currentVersion;else{const t=by(e);n=null==t?void 0:t.portalVersion}return n&&Number(n)>=8.4?"authorization-code":"auto"}removePortalAndItsServerCredentials(e,t,n){const r=EY.findCredential(e,t),i=[];let o;o="portal"===(null==r?void 0:r.scope)?r.server:n,EY.credentials.forEach(e=>{if("server"===e.scope){const t=EY.serverInfos.find(t=>t.server===e.server);o===(null==t?void 0:t.owningSystemUrl)&&i.push(e)}else o===e.server&&i.push(e)}),i.forEach(e=>(null==e?void 0:e.server)&&e.destroy())}addCredentialToSessionManger(e){const t=Tv.getInstance();if("server"===e.scope&&e.server)return fA.getInstance().fetchArcGISServerInfo(e.server).then(n=>t.addFromCredential(e,Sv.ArcGISJSAPISync,n).then(()=>e));{const n=EY.findOAuthInfo(e.server||"");return t.addFromCredential(e,Sv.ArcGISJSAPISync,null,n).then(()=>e)}}listeningJsApiSignIn(){EY.on("credential-create",({credential:e})=>{this.addCredentialToSessionManger(e).then(e=>{var t;let n;n="server"===e.scope?(null===(t=e.resources)||void 0===t?void 0:t.length)>0?e.resources[0]:`${e.server}/rest/services`:e.server,Tv.getInstance().releasePendingSignIn(n)}),e.on("token-change",()=>{this.addCredentialToSessionManger(e)})})}syncToArcgisJSAPI(e){var t;const n=Tv.getInstance();e&&e.forEach(e=>{var t;const r=e.server?`${e.server}/rest/services`:e.portal,i=EY.findCredential(r),o=!i||e.username!==i.userId||e.token!==i.token,s=n.getSessionType(e);o&&s!==bv.ServerSessionFederated&&s!==bv.ServerSessionStandAloneWebTier&&EY.registerToken({server:r,token:e.token,expires:null===(t=e.tokenExpires)||void 0===t?void 0:t.getTime(),ssl:e.ssl,userId:e.username})});const r=[];null===(t=EY.credentials)||void 0===t||t.forEach(t=>{const i="server"===t.scope?`${t.server}/rest/services`:t.server,o=n.getSessionKeyFromUrl(i);e.find(e=>{const n=Tv.getInstance().getSessionKeyFromSession(e);return o===n&&t.userId===e.username})||r.push(t)}),r.forEach(e=>e.destroy())}onSessionChangedCallback(e,t){t!==Sv.ArcGISJSAPISync&&this.syncToArcgisJSAPI(e)}addToTrustedServers(){const{portalUrl:e,isWebTier:t}=TE().getState(),n=Tv.getInstance().getTrustedServers();t&&OY.request.trustedServers.push(e),n.forEach(e=>{OY.request.trustedServers.includes(e)||OY.request.trustedServers.push(e)})}onCurrentThemeLoad(e,t){var n;if(!e||t)return;if(this.checkAPITheme(this.getAPIThemeUrl(window.jimuConfig.arcgisJsApiUrl,"dark"===e.theme.sys.color.mode)))return;this.removeApiThemeStyle(this.getAPIThemeUrl(window.jimuConfig.arcgisJsApiUrl,"dark"!==e.theme.sys.color.mode)),NI(this.getAPIThemeUrl(window.jimuConfig.arcgisJsApiUrl,"dark"===e.theme.sys.color.mode)),"dark"!==e.theme.sys.color.mode||document.body.classList.contains("calcite-mode-dark")?(document.body.classList.remove("calcite-mode-dark"),document.body.classList.add("calcite-mode-light")):(document.body.classList.remove("calcite-mode-light"),document.body.classList.add("calcite-mode-dark"));const r=null===(n=MI("jimu-arcgis"))||void 0===n?void 0:n.MapViewManager;null==r||r.getInstance().getAllJimuMapViewIds().forEach(t=>{var n,i;const o=null===(n=r.getInstance().getJimuMapViewById(t).view)||void 0===n?void 0:n.ui.container;o&&("dark"!==(null===(i=e.theme)||void 0===i?void 0:i.sys.color.mode)||o.classList.contains("calcite-mode-dark")?(o.classList.remove("calcite-mode-dark"),o.classList.add("calcite-theme-light")):(o.classList.remove("calcite-theme-light"),o.classList.add("calcite-mode-dark")))})}removeApiThemeStyle(e){var t;$I(e),null===(t=document.querySelector(`link[href="${e}"]`))||void 0===t||t.remove()}getAPIThemeUrl(e,t){return Jw(e)||(e=window.location.origin+e),t?`${e}esri/themes/dark/main.css`:`${e}esri/css/main.css`}checkAPITheme(e){return!!document.querySelector(`link[href="${e}"]`)}}function AY(e,t){return/rest\/services\/(.+)\/(MapServer|FeatureServer|ImageServer)\/(\d+)\/?$/.test(e)}function DY(e,t){return/sharing\/rest\/community\/self\/?$/.test(e)}function RY(e,t){const n="sharing/rest/content/items/",r=e.indexOf(n);if(r>-1){const t=e.substring(r+27).split("/");if(t.length>0&&(1===t.length||"data"===t[t.length-1]))return!0}return!1}function PY(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var jY=e=>Array.isArray(e)?e:[e];function LY(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(e=>"function"==typeof e)){const n=e.map(e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var _Y="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function MY(){return{s:0,v:void 0,o:null,p:null}}function NY(e,t={}){let n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let i,o=0;function s(){let t=n;const{length:s}=arguments;for(let e=0,n=s;e<n;e++){const n=arguments[e];if("function"==typeof n||"object"==typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=MY(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=MY(),e.set(n,t)):t=r}}const a=t;let l;if(1===t.s)l=t.v;else if(l=e.apply(null,arguments),o++,r){const e=i?.deref?.()??i;null!=e&&r(e,l)&&(l=e,0!==o&&o--);i="object"==typeof l&&null!==l||"function"==typeof l?new _Y(l):l}return a.s=1,a.v=l,l}return s.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},s.resetResultsCount()},s.resultsCount=()=>o,s.resetResultsCount=()=>{o=0},s}function kY(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,i=0,o={},s=e.pop();"object"==typeof s&&(o=s,s=e.pop()),PY(s,`createSelector expects an output function after the inputs, but received: [${typeof s}]`);const a={...n,...o},{memoize:l,memoizeOptions:u=[],argsMemoize:c=NY,argsMemoizeOptions:d=[],devModeChecks:p={}}=a,f=jY(u),h=jY(d),g=LY(e),m=l(function(){return r++,s.apply(null,arguments)},...f);const v=c(function(){i++;const e=function(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}(g,arguments);return t=m.apply(null,e),t},...h);return Object.assign(v,{resultFunc:s,memoizedResultFunc:m,dependencies:g,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:l,argsMemoize:c})};return Object.assign(r,{withTypes:()=>r}),r}var UY=kY(NY),FY=Object.assign((e,t=UY)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e);return t(n.map(t=>e[t]),(...e)=>e.reduce((e,t,r)=>(e[n[r]]=t,e),{}))},{withTypes:()=>FY});const BY=a(2528).exbVersion,$Y={assign:YL,defer:ZE,debounce:BE,setValue:Uy,getValue:Vu,isDeepEqual:wd,throttle:$E,kebabCase:FV,camelCase:aG,cloneDeep:Jm,clone:lG,delay:cG,merge:OG},VY={restFeatureService:i,restPortal:r,restRequest:n,Sanitizer:Ga},GY={rgba:Tn,parseToRgb:mn,rem:nn,readableColor:function(e,t,n,r){void 0===t&&(t=Fn),void 0===n&&(n=Bn),void 0===r&&(r=!0);var i=Ln(e)>.179,o=i?t:n;return!r||_n(e,o)>=4.5?o:i?Fn:Bn},lighten:Nn,darken:jn,ellipsis:function(e,t){void 0===t&&(t=1);var n={display:"inline-block",maxWidth:e||"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"normal"};return t>1?Mt({},n,{WebkitBoxOrient:"vertical",WebkitLineClamp:t,display:"-webkit-box",whiteSpace:"normal"}):n},mix:Un,stripUnit:Qt,math:Jt,borderRadius:Hn,getValueAndUnit:tn,parseToHsl:vn,shade:Vn,tint:Wn},WY=Gd;window._jimuHistory=v})(),l})())}}});