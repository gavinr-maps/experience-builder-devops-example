System.register(["jimu-core","jimu-for-builder/templates"],(function(e,t){var i={},n={};return{setters:[function(e){i.Immutable=e.Immutable,i.SessionManager=e.SessionManager,i.USER_SETTING_FILE_KEY=e.USER_SETTING_FILE_KEY,i.appConfigUtils=e.appConfigUtils,i.esri=e.esri,i.getAppStore=e.getAppStore,i.i18n=e.i18n,i.moduleLoader=e.moduleLoader,i.portalUrlUtils=e.portalUrlUtils,i.sharedThemeUtils=e.sharedThemeUtils,i.urlUtils=e.urlUtils,i.utils=e.utils,i.version=e.version},function(e){n.TemplateType=e.TemplateType,n.getTemplateConfig=e.getTemplateConfig}],execute:function(){e((()=>{var e={9593:e=>{const t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,i="undefined"!=typeof AbortController?AbortController:Object.assign(class{constructor(){this.signal=new i.AbortSignal}abort(){this.signal.aborted=!0}},{AbortSignal:class{constructor(){this.aborted=!1}}}),n=new Set,r=(e,t)=>{const i=`LRU_CACHE_OPTION_${e}`;a(i)&&l(i,`${e} option`,`options.${t}`,p)},o=(e,t)=>{const i=`LRU_CACHE_METHOD_${e}`;if(a(i)){const{prototype:n}=p,{get:r}=Object.getOwnPropertyDescriptor(n,e);l(i,`${e} method`,`cache.${t}()`,r)}},s=(...e)=>{"object"==typeof process&&process&&"function"==typeof process.emitWarning?process.emitWarning(...e):console.error(...e)},a=e=>!n.has(e),l=(e,t,i,r)=>{n.add(e),s(`The ${t} is deprecated. Please use ${i} instead.`,"DeprecationWarning",e,r)},c=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),u=e=>c(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?d:null:null;class d extends Array{constructor(e){super(e),this.fill(0)}}class h{constructor(e){if(0===e)return[];const t=u(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class p{constructor(e={}){const{max:t=0,ttl:i,ttlResolution:o=1,ttlAutopurge:l,updateAgeOnGet:d,updateAgeOnHas:f,allowStale:v,dispose:m,disposeAfter:g,noDisposeOnSet:y,noUpdateTTL:E,maxSize:S=0,sizeCalculation:w,fetchMethod:I}=e,{length:$,maxAge:T,stale:A}=e instanceof p?{}:e;if(0!==t&&!c(t))throw new TypeError("max option must be a nonnegative integer");const O=t?u(t):Array;if(!O)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=S,this.sizeCalculation=w||$,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=I||null,this.fetchMethod&&"function"!=typeof this.fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new O(t),this.prev=new O(t),this.head=0,this.tail=0,this.free=new h(t),this.initialFill=1,this.size=0,"function"==typeof m&&(this.dispose=m),"function"==typeof g?(this.disposeAfter=g,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!y,this.noUpdateTTL=!!E,0!==this.maxSize){if(!c(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!v||!!A,this.updateAgeOnGet=!!d,this.updateAgeOnHas=!!f,this.ttlResolution=c(o)||0===o?o:1,this.ttlAutopurge=!!l,this.ttl=i||T||0,this.ttl){if(!c(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(0===this.max&&0===this.ttl&&0===this.maxSize)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const e="LRU_CACHE_UNBOUNDED";a(e)&&(n.add(e),s("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",e,p))}A&&r("stale","allowStale"),T&&r("maxAge","ttl"),$&&r("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new d(this.max),this.starts=new d(this.max),this.setItemTTL=(e,i)=>{if(this.starts[e]=0!==i?t.now():0,this.ttls[e]=i,0!==i&&this.ttlAutopurge){const t=setTimeout((()=>{this.isStale(e)&&this.delete(this.keyList[e])}),i+1);t.unref&&t.unref()}},this.updateItemAge=e=>{this.starts[e]=0!==this.ttls[e]?t.now():0};let e=0;const i=()=>{const i=t.now();if(this.ttlResolution>0){e=i;const t=setTimeout((()=>e=0),this.ttlResolution);t.unref&&t.unref()}return i};this.getRemainingTTL=t=>{const n=this.keyMap.get(t);return void 0===n?0:0===this.ttls[n]||0===this.starts[n]?1/0:this.starts[n]+this.ttls[n]-(e||i())},this.isStale=t=>0!==this.ttls[t]&&0!==this.starts[t]&&(e||i())-this.starts[t]>this.ttls[t]}updateItemAge(e){}setItemTTL(e,t){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new d(this.max),this.removeItemSize=e=>this.calculatedSize-=this.sizes[e],this.requireSize=(e,t,i,n)=>{if(!c(i)){if(!n)throw new TypeError("invalid size value (must be positive integer)");if("function"!=typeof n)throw new TypeError("sizeCalculation must be a function");if(i=n(t,e),!c(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return i},this.addItemSize=(e,t,i,n)=>{this.sizes[e]=n;const r=this.maxSize-this.sizes[e];for(;this.calculatedSize>r;)this.evict(!0);this.calculatedSize+=this.sizes[e]},this.delete=e=>{if(0!==this.size){const t=this.keyMap.get(e);void 0!==t&&(this.calculatedSize-=this.sizes[t])}return p.prototype.delete.call(this,e)}}removeItemSize(e){}addItemSize(e,t,i,n){}requireSize(e,t,i,n){if(i||n)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.head);)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;this.isValidIndex(t)&&(!e&&this.isStale(t)||(yield t),t!==this.tail);)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(const e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(const e of this.indexes())yield this.keyList[e]}*rkeys(){for(const e of this.rindexes())yield this.keyList[e]}*values(){for(const e of this.indexes())yield this.valList[e]}*rvalues(){for(const e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const i of this.indexes())if(e(this.valList[i],this.keyList[i],this))return this.get(this.keyList[i],t)}forEach(e,t=this){for(const i of this.indexes())e.call(t,this.valList[i],this.keyList[i],this)}rforEach(e,t=this){for(const i of this.rindexes())e.call(t,this.valList[i],this.keyList[i],this)}get prune(){return o("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const t of this.indexes()){const i=this.keyList[t],n={value:this.valList[t]};this.ttls&&(n.ttl=this.ttls[t]),this.sizes&&(n.size=this.sizes[t]),e.unshift([i,n])}return e}load(e){this.clear();for(const[t,i]of e)this.set(t,i.value,i)}dispose(e,t,i){}set(e,t,{ttl:i=this.ttl,noDisposeOnSet:n=this.noDisposeOnSet,size:r=0,sizeCalculation:o=this.sizeCalculation,noUpdateTTL:s=this.noUpdateTTL}={}){r=this.requireSize(e,t,r,o);let a=0===this.size?void 0:this.keyMap.get(e);if(void 0===a)a=this.newIndex(),this.keyList[a]=e,this.valList[a]=t,this.keyMap.set(e,a),this.next[this.tail]=a,this.prev[a]=this.tail,this.tail=a,this.size++,this.addItemSize(a,t,e,r),s=!1;else{const i=this.valList[a];t!==i&&(this.isBackgroundFetch(i)?i.__abortController.abort():n||(this.dispose(i,e,"set"),this.disposeAfter&&this.disposed.push([i,e,"set"])),this.removeItemSize(a),this.valList[a]=t,this.addItemSize(a,t,e,r)),this.moveToTail(a)}if(0===i||0!==this.ttl||this.ttls||this.initializeTTLTracking(),s||this.setItemTTL(a,i),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return 0===this.size?this.tail:this.size===this.max&&0!==this.max?this.evict(!1):0!==this.free.length?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,i=this.keyList[t],n=this.valList[t];return this.isBackgroundFetch(n)?n.__abortController.abort():(this.dispose(n,i,"evict"),this.disposeAfter&&this.disposed.push([n,i,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(i),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const i=this.keyMap.get(e);return void 0!==i&&!this.isStale(i)&&(t&&this.updateItemAge(i),!0)}peek(e,{allowStale:t=this.allowStale}={}){const i=this.keyMap.get(e);if(void 0!==i&&(t||!this.isStale(i)))return this.valList[i]}backgroundFetch(e,t,n){const r=void 0===t?void 0:this.valList[t];if(this.isBackgroundFetch(r))return r;const o=new i,s={signal:o.signal,options:n},a=Promise.resolve(this.fetchMethod(e,r,s)).then((t=>(o.signal.aborted||this.set(e,t,s.options),t)));return a.__abortController=o,a.__staleWhileFetching=r,void 0===t?(this.set(e,a,s.options),t=this.keyMap.get(e)):this.valList[t]=a,a}isBackgroundFetch(e){return e&&"object"==typeof e&&"function"==typeof e.then&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,ttl:n=this.ttl,noDisposeOnSet:r=this.noDisposeOnSet,size:o=0,sizeCalculation:s=this.sizeCalculation,noUpdateTTL:a=this.noUpdateTTL}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:i});const l={allowStale:t,updateAgeOnGet:i,ttl:n,noDisposeOnSet:r,size:o,sizeCalculation:s,noUpdateTTL:a};let c=this.keyMap.get(e);if(void 0===c)return this.backgroundFetch(e,c,l);{const n=this.valList[c];if(this.isBackgroundFetch(n))return t&&void 0!==n.__staleWhileFetching?n.__staleWhileFetching:n;if(!this.isStale(c))return this.moveToTail(c),i&&this.updateItemAge(c),n;const r=this.backgroundFetch(e,c,l);return t&&void 0!==r.__staleWhileFetching?r.__staleWhileFetching:r}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet}={}){const n=this.keyMap.get(e);if(void 0!==n){const r=this.valList[n],o=this.isBackgroundFetch(r);if(this.isStale(n))return o?t?r.__staleWhileFetching:void 0:(this.delete(e),t?r:void 0);if(o)return;return this.moveToTail(n),i&&this.updateItemAge(n),r}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return o("del","delete"),this.delete}delete(e){let t=!1;if(0!==this.size){const i=this.keyMap.get(e);if(void 0!==i)if(t=!0,1===this.size)this.clear();else{this.removeItemSize(i);const t=this.valList[i];this.isBackgroundFetch(t)?t.__abortController.abort():(this.dispose(t,e,"delete"),this.disposeAfter&&this.disposed.push([t,e,"delete"])),this.keyMap.delete(e),this.keyList[i]=null,this.valList[i]=null,i===this.tail?this.tail=this.prev[i]:i===this.head?this.head=this.next[i]:(this.next[this.prev[i]]=this.next[i],this.prev[this.next[i]]=this.prev[i]),this.size--,this.free.push(i)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort();else{const i=this.keyList[e];this.dispose(t,i,"delete"),this.disposeAfter&&this.disposed.push([t,i,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return o("reset","clear"),this.clear}get length(){return((e,t)=>{const i="LRU_CACHE_PROPERTY_length";if(a(i)){const{prototype:t}=p,{get:n}=Object.getOwnPropertyDescriptor(t,e);l(i,"length property","cache.size",n)}})("length"),this.size}}e.exports=p},2257:(e,t,i)=>{const n=Symbol("SemVer ANY");class r{static get ANY(){return n}constructor(e,t){if(t=o(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],i=e.match(t);if(!i)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new u(i[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new d(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new d(this.value,t).test(e.semver);const i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=l(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=l(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||n||o&&s||a||c}}e.exports=r;const o=i(2893),{re:s,t:a}=i(5765),l=i(7539),c=i(4225),u=i(6376),d=i(6902)},6902:(e,t,i)=>{class n{constructor(e,t){if(t=o(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!f(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=r.get(t);if(i)return i;const n=this.options.loose,o=n?c[u.HYPHENRANGELOOSE]:c[u.HYPHENRANGE];e=e.replace(o,P(this.options.includePrerelease)),a("hyphen replace",e),e=e.replace(c[u.COMPARATORTRIM],d),a("comparator trim",e);let l=(e=(e=(e=e.replace(c[u.TILDETRIM],h)).replace(c[u.CARETTRIM],p)).split(/\s+/).join(" ")).split(" ").map((e=>g(e,this.options))).join(" ").split(/\s+/).map((e=>O(e,this.options)));n&&(l=l.filter((e=>(a("loose invalid filter",e,this.options),!!e.match(c[u.COMPARATORLOOSE]))))),a("range list",l);const v=new Map,m=l.map((e=>new s(e,this.options)));for(const e of m){if(f(e))return[e];v.set(e.value,e)}v.size>1&&v.has("")&&v.delete("");const y=[...v.values()];return r.set(t,y),y}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some((i=>m(i,t)&&e.set.some((e=>m(e,t)&&i.every((i=>e.every((e=>i.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(R(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const r=new(i(9593))({max:1e3}),o=i(2893),s=i(2257),a=i(4225),l=i(6376),{re:c,t:u,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:p}=i(5765),f=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,m=(e,t)=>{let i=!0;const n=e.slice();let r=n.pop();for(;i&&n.length;)i=n.every((e=>r.intersects(e,t))),r=n.pop();return i},g=(e,t)=>(a("comp",e,t),e=w(e,t),a("caret",e),e=E(e,t),a("tildes",e),e=$(e,t),a("xrange",e),e=A(e,t),a("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{const i=t.loose?c[u.TILDELOOSE]:c[u.TILDE];return e.replace(i,((t,i,n,r,o)=>{let s;return a("tilde",e,t,i,n,r,o),y(i)?s="":y(n)?s=`>=${i}.0.0 <${+i+1}.0.0-0`:y(r)?s=`>=${i}.${n}.0 <${i}.${+n+1}.0-0`:o?(a("replaceTilde pr",o),s=`>=${i}.${n}.${r}-${o} <${i}.${+n+1}.0-0`):s=`>=${i}.${n}.${r} <${i}.${+n+1}.0-0`,a("tilde return",s),s}))},w=(e,t)=>e.trim().split(/\s+/).map((e=>I(e,t))).join(" "),I=(e,t)=>{a("caret",e,t);const i=t.loose?c[u.CARETLOOSE]:c[u.CARET],n=t.includePrerelease?"-0":"";return e.replace(i,((t,i,r,o,s)=>{let l;return a("caret",e,t,i,r,o,s),y(i)?l="":y(r)?l=`>=${i}.0.0${n} <${+i+1}.0.0-0`:y(o)?l="0"===i?`>=${i}.${r}.0${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.0${n} <${+i+1}.0.0-0`:s?(a("replaceCaret pr",s),l="0"===i?"0"===r?`>=${i}.${r}.${o}-${s} <${i}.${r}.${+o+1}-0`:`>=${i}.${r}.${o}-${s} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${o}-${s} <${+i+1}.0.0-0`):(a("no pr"),l="0"===i?"0"===r?`>=${i}.${r}.${o}${n} <${i}.${r}.${+o+1}-0`:`>=${i}.${r}.${o}${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${o} <${+i+1}.0.0-0`),a("caret return",l),l}))},$=(e,t)=>(a("replaceXRanges",e,t),e.split(/\s+/).map((e=>T(e,t))).join(" ")),T=(e,t)=>{e=e.trim();const i=t.loose?c[u.XRANGELOOSE]:c[u.XRANGE];return e.replace(i,((i,n,r,o,s,l)=>{a("xRange",e,i,n,r,o,s,l);const c=y(r),u=c||y(o),d=u||y(s),h=d;return"="===n&&h&&(n=""),l=t.includePrerelease?"-0":"",c?i=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(u&&(o=0),s=0,">"===n?(n=">=",u?(r=+r+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",u?r=+r+1:o=+o+1),"<"===n&&(l="-0"),i=`${n+r}.${o}.${s}${l}`):u?i=`>=${r}.0.0${l} <${+r+1}.0.0-0`:d&&(i=`>=${r}.${o}.0${l} <${r}.${+o+1}.0-0`),a("xRange return",i),i}))},A=(e,t)=>(a("replaceStars",e,t),e.trim().replace(c[u.STAR],"")),O=(e,t)=>(a("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),P=e=>(t,i,n,r,o,s,a,l,c,u,d,h,p)=>`${i=y(n)?"":y(r)?`>=${n}.0.0${e?"-0":""}`:y(o)?`>=${n}.${r}.0${e?"-0":""}`:s?`>=${i}`:`>=${i}${e?"-0":""}`} ${l=y(c)?"":y(u)?`<${+c+1}.0.0-0`:y(d)?`<${c}.${+u+1}.0-0`:h?`<=${c}.${u}.${d}-${h}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),R=(e,t,i)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(let i=0;i<e.length;i++)if(a(e[i].semver),e[i].semver!==s.ANY&&e[i].semver.prerelease.length>0){const n=e[i].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},6376:(e,t,i)=>{const n=i(4225),{MAX_LENGTH:r,MAX_SAFE_INTEGER:o}=i(3295),{re:s,t:a}=i(5765),l=i(2893),{compareIdentifiers:c}=i(6742);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>r)throw new TypeError(`version is longer than ${r} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!i)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],r=e.prerelease[t];if(n("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return c(i,r)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const i=this.build[t],r=e.build[t];if(n("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return c(i,r)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=u},3507:(e,t,i)=>{const n=i(3959);e.exports=(e,t)=>{const i=n(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null}},7539:(e,t,i)=>{const n=i(8718),r=i(1194),o=i(1312),s=i(5903),a=i(1544),l=i(2056);e.exports=(e,t,i,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e===i;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e!==i;case"":case"=":case"==":return n(e,i,c);case"!=":return r(e,i,c);case">":return o(e,i,c);case">=":return s(e,i,c);case"<":return a(e,i,c);case"<=":return l(e,i,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},9038:(e,t,i)=>{const n=i(6376),r=i(3959),{re:o,t:s}=i(5765);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let i=null;if((t=t||{}).rtl){let t;for(;(t=o[s.COERCERTL].exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&t.index+t[0].length===i.index+i[0].length||(i=t),o[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[s.COERCERTL].lastIndex=-1}else i=e.match(o[s.COERCE]);return null===i?null:r(`${i[2]}.${i[3]||"0"}.${i[4]||"0"}`,t)}},8880:(e,t,i)=>{const n=i(6376);e.exports=(e,t,i)=>{const r=new n(e,i),o=new n(t,i);return r.compare(o)||r.compareBuild(o)}},7880:(e,t,i)=>{const n=i(6269);e.exports=(e,t)=>n(e,t,!0)},6269:(e,t,i)=>{const n=i(6376);e.exports=(e,t,i)=>new n(e,i).compare(new n(t,i))},2378:(e,t,i)=>{const n=i(3959),r=i(8718);e.exports=(e,t)=>{if(r(e,t))return null;{const i=n(e),r=n(t),o=i.prerelease.length||r.prerelease.length,s=o?"pre":"",a=o?"prerelease":"";for(const e in i)if(("major"===e||"minor"===e||"patch"===e)&&i[e]!==r[e])return s+e;return a}}},8718:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>0===n(e,t,i)},1312:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>n(e,t,i)>0},5903:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>n(e,t,i)>=0},253:(e,t,i)=>{const n=i(6376);e.exports=(e,t,i,r)=>{"string"==typeof i&&(r=i,i=void 0);try{return new n(e,i).inc(t,r).version}catch(e){return null}}},1544:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>n(e,t,i)<0},2056:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>n(e,t,i)<=0},8679:(e,t,i)=>{const n=i(6376);e.exports=(e,t)=>new n(e,t).major},7789:(e,t,i)=>{const n=i(6376);e.exports=(e,t)=>new n(e,t).minor},1194:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>0!==n(e,t,i)},3959:(e,t,i)=>{const{MAX_LENGTH:n}=i(3295),{re:r,t:o}=i(5765),s=i(6376),a=i(2893);e.exports=(e,t)=>{if(t=a(t),e instanceof s)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?r[o.LOOSE]:r[o.FULL]).test(e))return null;try{return new s(e,t)}catch(e){return null}}},2358:(e,t,i)=>{const n=i(6376);e.exports=(e,t)=>new n(e,t).patch},7559:(e,t,i)=>{const n=i(3959);e.exports=(e,t)=>{const i=n(e,t);return i&&i.prerelease.length?i.prerelease:null}},9795:(e,t,i)=>{const n=i(6269);e.exports=(e,t,i)=>n(t,e,i)},3657:(e,t,i)=>{const n=i(8880);e.exports=(e,t)=>e.sort(((e,i)=>n(i,e,t)))},5712:(e,t,i)=>{const n=i(6902);e.exports=(e,t,i)=>{try{t=new n(t,i)}catch(e){return!1}return t.test(e)}},1100:(e,t,i)=>{const n=i(8880);e.exports=(e,t)=>e.sort(((e,i)=>n(e,i,t)))},6397:(e,t,i)=>{const n=i(3959);e.exports=(e,t)=>{const i=n(e,t);return i?i.version:null}},1249:(e,t,i)=>{const n=i(5765);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:i(3295).SEMVER_SPEC_VERSION,SemVer:i(6376),compareIdentifiers:i(6742).compareIdentifiers,rcompareIdentifiers:i(6742).rcompareIdentifiers,parse:i(3959),valid:i(6397),clean:i(3507),inc:i(253),diff:i(2378),major:i(8679),minor:i(7789),patch:i(2358),prerelease:i(7559),compare:i(6269),rcompare:i(9795),compareLoose:i(7880),compareBuild:i(8880),sort:i(1100),rsort:i(3657),gt:i(1312),lt:i(1544),eq:i(8718),neq:i(1194),gte:i(5903),lte:i(2056),cmp:i(7539),coerce:i(9038),Comparator:i(2257),Range:i(6902),satisfies:i(5712),toComparators:i(1042),maxSatisfying:i(5775),minSatisfying:i(1657),minVersion:i(5316),validRange:i(9042),outside:i(6826),gtr:i(7606),ltr:i(32),intersects:i(2937),simplifyRange:i(7908),subset:i(799)}},3295:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},4225:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},6742:e=>{const t=/^[0-9]+$/,i=(e,i)=>{const n=t.test(e),r=t.test(i);return n&&r&&(e=+e,i=+i),e===i?0:n&&!r?-1:r&&!n?1:e<i?-1:1};e.exports={compareIdentifiers:i,rcompareIdentifiers:(e,t)=>i(t,e)}},2893:e=>{const t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},5765:(e,t,i)=>{const{MAX_SAFE_COMPONENT_LENGTH:n}=i(3295),r=i(4225),o=(t=e.exports={}).re=[],s=t.src=[],a=t.t={};let l=0;const c=(e,t,i)=>{const n=l++;r(e,n,t),a[e]=n,s[n]=t,o[n]=new RegExp(t,i?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),c("FULL",`^${s[a.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),c("LOOSE",`^${s[a.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),c("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),c("COERCERTL",s[a.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7606:(e,t,i)=>{const n=i(6826);e.exports=(e,t,i)=>n(e,t,">",i)},2937:(e,t,i)=>{const n=i(6902);e.exports=(e,t,i)=>(e=new n(e,i),t=new n(t,i),e.intersects(t))},32:(e,t,i)=>{const n=i(6826);e.exports=(e,t,i)=>n(e,t,"<",i)},5775:(e,t,i)=>{const n=i(6376),r=i(6902);e.exports=(e,t,i)=>{let o=null,s=null,a=null;try{a=new r(t,i)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&-1!==s.compare(e)||(o=e,s=new n(o,i)))})),o}},1657:(e,t,i)=>{const n=i(6376),r=i(6902);e.exports=(e,t,i)=>{let o=null,s=null,a=null;try{a=new r(t,i)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&1!==s.compare(e)||(o=e,s=new n(o,i)))})),o}},5316:(e,t,i)=>{const n=i(6376),r=i(6902),o=i(1312);e.exports=(e,t)=>{e=new r(e,t);let i=new n("0.0.0");if(e.test(i))return i;if(i=new n("0.0.0-0"),e.test(i))return i;i=null;for(let t=0;t<e.set.length;++t){const r=e.set[t];let s=null;r.forEach((e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!o(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||i&&!o(i,s)||(i=s)}return i&&e.test(i)?i:null}},6826:(e,t,i)=>{const n=i(6376),r=i(2257),{ANY:o}=r,s=i(6902),a=i(5712),l=i(1312),c=i(1544),u=i(2056),d=i(5903);e.exports=(e,t,i,h)=>{let p,f,v,m,g;switch(e=new n(e,h),t=new s(t,h),i){case">":p=l,f=u,v=c,m=">",g=">=";break;case"<":p=c,f=d,v=l,m="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,h))return!1;for(let i=0;i<t.set.length;++i){const n=t.set[i];let s=null,a=null;if(n.forEach((e=>{e.semver===o&&(e=new r(">=0.0.0")),s=s||e,a=a||e,p(e.semver,s.semver,h)?s=e:v(e.semver,a.semver,h)&&(a=e)})),s.operator===m||s.operator===g)return!1;if((!a.operator||a.operator===m)&&f(e,a.semver))return!1;if(a.operator===g&&v(e,a.semver))return!1}return!0}},7908:(e,t,i)=>{const n=i(5712),r=i(6269);e.exports=(e,t,i)=>{const o=[];let s=null,a=null;const l=e.sort(((e,t)=>r(e,t,i)));for(const e of l)n(e,t,i)?(a=e,s||(s=e)):(a&&o.push([s,a]),a=null,s=null);s&&o.push([s,null]);const c=[];for(const[e,t]of o)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},799:(e,t,i)=>{const n=i(6902),r=i(2257),{ANY:o}=r,s=i(5712),a=i(6269),l=(e,t,i)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=i.includePrerelease?[new r(">=0.0.0-0")]:[new r(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(i.includePrerelease)return!0;t=[new r(">=0.0.0")]}const n=new Set;let l,d,h,p,f,v,m;for(const t of e)">"===t.operator||">="===t.operator?l=c(l,t,i):"<"===t.operator||"<="===t.operator?d=u(d,t,i):n.add(t.semver);if(n.size>1)return null;if(l&&d){if(h=a(l.semver,d.semver,i),h>0)return null;if(0===h&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of n){if(l&&!s(e,String(l),i))return null;if(d&&!s(e,String(d),i))return null;for(const n of t)if(!s(e,String(n),i))return!1;return!0}let g=!(!d||i.includePrerelease||!d.semver.prerelease.length)&&d.semver,y=!(!l||i.includePrerelease||!l.semver.prerelease.length)&&l.semver;g&&1===g.prerelease.length&&"<"===d.operator&&0===g.prerelease[0]&&(g=!1);for(const e of t){if(m=m||">"===e.operator||">="===e.operator,v=v||"<"===e.operator||"<="===e.operator,l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(p=c(l,e,i),p===e&&p!==l)return!1}else if(">="===l.operator&&!s(l.semver,String(e),i))return!1;if(d)if(g&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===g.major&&e.semver.minor===g.minor&&e.semver.patch===g.patch&&(g=!1),"<"===e.operator||"<="===e.operator){if(f=u(d,e,i),f===e&&f!==d)return!1}else if("<="===d.operator&&!s(d.semver,String(e),i))return!1;if(!e.operator&&(d||l)&&0!==h)return!1}return!(l&&v&&!d&&0!==h||d&&m&&!l&&0!==h||y||g)},c=(e,t,i)=>{if(!e)return t;const n=a(e.semver,t.semver,i);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},u=(e,t,i)=>{if(!e)return t;const n=a(e.semver,t.semver,i);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,i={})=>{if(e===t)return!0;e=new n(e,i),t=new n(t,i);let r=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,i);if(r=r||null!==t,t)continue e}if(r)return!1}return!0}},1042:(e,t,i)=>{const n=i(6902);e.exports=(e,t)=>new n(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},9042:(e,t,i)=>{const n=i(6902);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},8891:e=>{"use strict";e.exports=i},6262:e=>{"use strict";e.exports=n}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";r.r(o),r.d(o,{AppType:()=>s,PublishStatus:()=>a,SearchType:()=>n,appServices:()=>t,getResourceOrigin:()=>oe,userServices:()=>i});var e={};r.r(e),r.d(e,{addItemResource:()=>k,createItem:()=>I,getItem:()=>O,getItemData:()=>A,getItemResource:()=>R,getItemResources:()=>P,getOriginUrl:()=>m,getRequestMethod:()=>E,getUserContentUrl:()=>g,getUserName:()=>y,importItem:()=>$,removeItem:()=>x,removeItemResource:()=>j,request:()=>f,searchItems:()=>d,updateItem:()=>U,updateItemResource:()=>M});var t={};r.r(t),r.d(t,{addAppResource:()=>Je,addToFavorites:()=>Be,changeAppFolder:()=>He,createAppByDefaultTemplate:()=>Re,createAppByItemTemplate:()=>Oe,createAppByTemplateId:()=>Pe,createTemplateByApp:()=>be,deleteApp:()=>_e,duplicateApp:()=>je,getAppConfig:()=>Ue,getAppGroups:()=>qe,getAppInfo:()=>ke,getAppResource:()=>Ze,getAppResources:()=>Qe,getDefaultTemplateConfig:()=>Ye,getFolders:()=>ze,getUserTags:()=>Ve,importAppFromPortal:()=>xe,importItem:()=>Le,publishApp:()=>Fe,removeAppResource:()=>Ke,removeFromFavorites:()=>Xe,saveApp:()=>Ge,saveAsApp:()=>Ne,searchApp:()=>Me,searchGroups:()=>We,updateAppInfo:()=>Ce,updateAppResource:()=>et,updateAppThumbnail:()=>De});var i={};r.r(i),r.d(i,{addUserResource:()=>at,getUserResource:()=>lt,getUserResources:()=>ct,initUserResource:()=>ht,removeUserResource:()=>ut,updateUserResource:()=>dt});var n,s,a,l=r(1249),c=r(8891);!function(e){e.AGOL="AGOL",e.Portal="Portal",e.Other="Other"}(n||(n={})),function(e){e.TemplateType="Web Experience Template",e.ExperienceType="Web Experience"}(s||(s={})),function(e){e.Published="Published",e.Draft="Draft",e.Changed="Changed"}(a||(a={}));var u=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function d(e,t=n.Other){return u(this,void 0,void 0,(function*(){return yield h(e,"item",t)}))}function h(e,t,i=n.Other){return u(this,void 0,void 0,(function*(){let r,o;return r=`${i===n.AGOL?"https://www.arcgis.com":window.location.origin}/sharing/rest/search`,o="string"==typeof e||e instanceof c.esri.restPortal.SearchQueryBuilder?{params:{q:e}}:c.esri.restRequest.appendCustomParams(Object.assign(Object.assign({},e),{f:"json"}),["q","num","start","sortField","sortOrder","portalUrl","f"]),yield f(r,o,"GET").then((i=>(i.nextStart&&-1!==i.nextStart&&(i.nextPage=function(){return u(this,void 0,void 0,(function*(){let n;return"string"==typeof e||e instanceof c.esri.restPortal.SearchQueryBuilder?n={q:e,start:i.nextStart}:(n=e,n.start=i.nextStart),yield h(n,t)}))}),i)))}))}var p=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function f(e,t={params:{f:"json"}},i="POST"){return p(this,void 0,void 0,(function*(){if("GET"===i){const i=e+function(e){if(!e)return"";const t=Object.keys(e);return t.length?"?"+t.map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&"):""}(t.params);return yield fetch(i,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>p(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>p(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}return"POST"===i?t.params&&"FormData"===t.params.constructor.name?yield fetch(e,{method:"POST",body:t.params}).then((e=>p(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>p(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.params)}).then((e=>p(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>p(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield Promise.reject(null)}))}const v=c.esri.restRequest.request;function m(e=!1){return e?c.urlUtils.getArcgisOnlineUrl():window.location.origin}function g(e=!1){return e?"/sharing/rest/content/":"/sharing/rest/content/users/"}function y(){var e;return null===(e=(0,c.getAppStore)().getState().user)||void 0===e?void 0:e.username}function E(e=!1){return e?v:f}function S(e){const t=JSON.parse(JSON.stringify(e));return t.data&&("undefined"!=typeof Blob&&e.data instanceof Blob||"ReadStream"===e.data.constructor.name?t.file=e.data:t.text=e.data,delete t.data),t}var w=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function I(e){return w(this,void 0,void 0,(function*(){const t=Object.assign({folderId:null},e);return yield function(e){var t,i;return w(this,void 0,void 0,(function*(){if(e.file&&!e.multipart)return yield Promise.reject(new Error("The request must be a multipart request for file uploading."));if(e.multipart&&!e.filename)return yield Promise.reject(new Error("The file name is required for a multipart request."));const n=y(),r=`${m()}${g()}addItem`;e.params=Object.assign(Object.assign(Object.assign({},e.params),S(e.item)),{portalUrl:null===(i=null===(t=(0,c.getAppStore)())||void 0===t?void 0:t.getState())||void 0===i?void 0:i.portalUrl});const o=c.esri.restRequest.appendCustomParams(e,["owner","folderId","file","dataUrl","text","async","multipart","filename","overwrite"],{params:Object.assign({},e.params)});return o.params.username=n,yield f(r,o)}))}(t)}))}function $(e,t){return w(this,void 0,void 0,(function*(){const i=`${m()}${g()}importItem`;if(!(null==e?void 0:e.appZip))return Promise.reject("No app files");t.params=Object.assign(Object.assign({},t.params),e);const n=Object.keys(t.params),r=new FormData;for(let e=0;e<n.length;e++)r.append(n[e],t.params[n[e]]);return t.params=r,yield f(i,t)}))}var T=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function A(e,t,i=!1){return T(this,void 0,void 0,(function*(){const n=`${m(i)}${g(i)}items/${e}/data`,r=Object.assign({params:{}},t);r.file&&(r.params.f=null),i&&!b()&&delete r.authentication;const o=E(i);return yield o(n,r).catch((e=>{if(!/Unexpected end of (JSON input|data at line 1 column 1)/i.test(e.message))throw e}))}))}function O(e,t,i=!1){return T(this,void 0,void 0,(function*(){const n=`${m(i)}${g(i)}items/${e}`,r=Object.assign({},t);i&&!b()&&delete r.authentication;const o=E(i);return yield o(n,r)}))}function P(e,t,i=!1){return T(this,void 0,void 0,(function*(){const n=`${m(i)}${g(i)}items/${e}/resources`;t.params=Object.assign(Object.assign({},t.params),{num:1e3}),i&&!b()&&delete t.authentication;const r=E(i);return yield r(n,t,"GET")}))}function R(e,t,i=!1){return T(this,void 0,void 0,(function*(){const n=t.fileName,r=`${m(i)}${g(i)}items/${e}/resources/${n}`;i&&!b()&&delete t.authentication;const o=E(i);return yield o(r,t,"GET")}))}function b(){const e=(0,c.getAppStore)().getState().portalUrl;return c.portalUrlUtils.isAGOLDomain(e)}var L=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function x(e){return L(this,void 0,void 0,(function*(){const t=y(),i=m();e.userName=t;const n=`${i}${g()}items/${e.id}/delete`;return yield f(n,e)}))}function j(e){return L(this,void 0,void 0,(function*(){const t=`${m()}${g()}items/${e.id}/removeResources`;return e.params=Object.assign(Object.assign({},e.params),{resource:e.resource}),yield f(t,e)}))}var N=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function U(e){return N(this,void 0,void 0,(function*(){const t=y(),i=m();e.userName=t;const n=`${i}${g()}items/${e.item.id}/update`;if(e.params=Object.assign(Object.assign({},e.params),S(e.item)),e.item.thumbnail&&"string"!=typeof e.item.thumbnail){e.params=Object.assign(Object.assign({},e.params),e.item);const t=Object.keys(e.params),i=new FormData;for(let n=0;n<t.length;n++)i.append(t[n],e.params[t[n]]);e.params=i}return yield f(n,e)}))}function M(e){return N(this,void 0,void 0,(function*(){const t=`${m()}${g()}items/${e.id}/updateResources`;e.params=Object.assign(Object.assign({fileName:e.name,text:e.content},e.params),{file:e.resource}),delete e.params.file,e.params.file=e.resource,void 0!==e.private&&(e.params.access=e.private?"private":"inherit");const i=Object.keys(e.params),n=new FormData;for(let t=0;t<i.length;t++)n.append(i[t],e.params[i[t]]);return e.params=n,yield f(t,e)}))}function k(e){return t=this,i=void 0,r=function*(){const t=`${m()}${g()}items/${e.id}/addResources`;e.params=Object.assign(Object.assign({fileName:e.name,text:e.content,access:e.private?"private":"inherit"},e.params),{file:e.resource}),delete e.params.file,e.params.file=e.resource;const i=Object.keys(e.params),n=new FormData;for(let t=0;t<i.length;t++)n.append(i[t],e.params[i[t]]);return e.params=n,yield f(t,e)},new((n=void 0)||(n=Promise))((function(e,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}l((r=r.apply(t,i||[])).next())}));var t,i,n,r}var C=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const D=c.SessionManager.getInstance().isTrustedServer((0,c.getAppStore)().getState().portalUrl);function _(e,t={f:"json"},i="POST"){return C(this,void 0,void 0,(function*(){if("GET"===i){const i=e+function(e){if(!e)return"";const t=Object.keys(e);return t.length?"?"+t.map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&"):""}(t);return yield fetch(i,{credentials:D?"include":"same-origin",method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>C(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>C(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}return"POST"===i?t&&"FormData"===t.constructor.name?yield fetch(e,{credentials:D?"include":"same-origin",method:"POST",body:t}).then((e=>C(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>C(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield fetch(e,{credentials:D?"include":"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>C(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>C(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield Promise.reject(null)}))}const G={frameworkAction_TriggerLayer:"Trigger data",frameworkAction_SetData:"Select data",frameworkAction_ActionLayer:"Action data",frameworkAction_Conditions:"Conditions",frameworkAction_RelateMessage:"Trigger / action connection",frameworkAction_TriggerLayerField:"Select a trigger field",frameworkAction_None:"none",frameworkAction_Equals:"equals",frameworkAction_ActionLayerField:"Select an action field",frameworkAction_MoreConditions:"More conditions",frameworkAction_SetExpression:"Please set your expression first.",frameworkAction_ChooseLayer:"Select data",frameworkAction_AutoBind:"Auto bound.",frameworkAction_NoLayer:"No data.",frameworkAction_QueryByExtent:"Query by current extent",defaultTextPlaceholder:"Double click to edit text",titlePlaceholder:"Here is the title",subTitlePlaceholder:"Here is the subtitle",shortTitlePlaceholder:"Title",shortSubTitlePlaceholder:"Subtitle",copyrightPlaceholder:"Copyright info",cardTitle:"Card title",bookmark:"Bookmark",number:"Number",appItemCopy:"Copy"};var F=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const z=c.esri.restRequest.request;function B(e){var t,i;if(!(null==e?void 0:e.portalUrl))return!window.jimuConfig.isDevEdition;const n=(null==e?void 0:e.portalUrl)||"",r=(null===(i=null===(t=(0,c.getAppStore)())||void 0===t?void 0:t.getState())||void 0===i?void 0:i.portalUrl)||"",o=(null==r?void 0:r.includes(n))||(null==n?void 0:n.includes(r));return(c.portalUrlUtils.isAGOLDomain(n)&&c.portalUrlUtils.isAGOLDomain(r)||o)&&!q(e)}function X(e){if(!(null==e?void 0:e.portalUrl))return!1;const t=(null==e?void 0:e.portalUrl)||"",i=c.portalUrlUtils.isAGOLDomain(t),n=!B(e),r=!q(e);return n&&r&&i}function q(e){return!!((null==e?void 0:e.portalUrl)||"").endsWith("localhost:")||e.isLocalApp}function H(e){if(q(e))return{};const t=c.SessionManager.getInstance().getMainSession();return B(e)?t:{}}function V(e,t=!1,i=""){return F(this,void 0,void 0,(function*(){const r=c.SessionManager.getInstance().getMainSession();let o=null;const a=(null==i?void 0:i.includes("Template"))?s.TemplateType:s.ExperienceType;return yield Me({q:`type: "${a}" AND owner:${null==r?void 0:r.username} AND  title:"${e}"`,sortField:"modified",sortOrder:"desc"},n.Other).then((i=>F(this,void 0,void 0,(function*(){const n=i.results;if(n&&n.length>0){const i=function(e,t){const i=[],n=/^[\d]+$/;return e.forEach((e=>{var r,o;const s=null===(o=null===(r=e.title)||void 0===r?void 0:r.split(`${t} `)[1])||void 0===o?void 0:o.split(" ")[0];n.test(s)&&i.push(Number(s))})),i.sort((function(e,t){return e<t?1:-1})),i[0]||1}(n,e);return o=ne(e,n,i,t),yield Promise.resolve(o)}return o=t?e:`${e} 1`,yield Promise.resolve(o)})))).catch((e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))}function W(e,t,i=!1){return F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession();return yield ve({item:{id:e,owner:null==t?void 0:t.username,text:"",data:{__not_publish:!0}},authentication:c.SessionManager.getInstance().getMainSession()}).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!0)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))}(e).then((n=>F(this,void 0,void 0,(function*(){return n?i?yield function(e,t){return F(this,void 0,void 0,(function*(){return yield function(e,t){return F(this,void 0,void 0,(function*(){return yield Ue(t).then((i=>F(this,void 0,void 0,(function*(){const n=Q(i,t);n.template=null==t?void 0:t.id,delete n.appProxies,delete n.historyLabels;const r=H({portalUrl:window.jimuConfig.isDevEdition?"localhost:":(0,c.getAppStore)().getState().portalUrl});if(null==i?void 0:i.__not_publish)return yield Promise.reject("This item is not published");const o=new Blob([JSON.stringify(n)],{type:"application/json"});return yield Ee({id:e,resource:o,name:"config.json",params:{resourcesPrefix:"config"},authentication:r}).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!0)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Resource does not exist or is inaccessible")}))))}))}(e,t).then((i=>F(this,void 0,void 0,(function*(){return yield Y(e,t,!0).then((e=>F(this,void 0,void 0,(function*(){return e?yield Promise.resolve(!0):yield Promise.reject("Resource does not exist or is inaccessible")}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))))}))}(e,t):yield function(e,t){return F(this,void 0,void 0,(function*(){return yield Y(e,t).then((e=>F(this,void 0,void 0,(function*(){return e?yield Promise.resolve(!0):yield Promise.reject("Resource does not exist or is inaccessible")}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}(e,t):yield Promise.reject(null)}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function Y(e,t,i=!1){return F(this,void 0,void 0,(function*(){const n=H(t);return yield ye(t,{authentication:n}).then((n=>F(this,void 0,void 0,(function*(){const r=[],o=n&&n.resources;let s=!1;if(o)for(let n=0;n<o.length;n++){const a="config/config.json"===o[n].resource;i&&a||(a&&(s=!0),r.push(J(e,t,o[n])))}return s||i?yield Promise.all(r):yield Promise.resolve(null)}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(null)}))))}))}function K(e,t,i){return F(this,void 0,void 0,(function*(){const n=H({portalUrl:window.jimuConfig.isDevEdition?"localhost:":(0,c.getAppStore)().getState().portalUrl}),r=H(t);if(i){const o=`${oe(t)}${t.id}/info/${i}?token=${null==r?void 0:r.token}`,s=`${oe(t)}${t.id}/${i}`,a=B(t)?o:s;return yield new Promise((function(t,i){const r=new XMLHttpRequest;r.open("GET",a,!0),r.responseType="blob",r.onload=function(r){if(200===this.status){const r=this.response;return De({id:e,thumbnail:r,f:"json",token:null==n?void 0:n.token}).then((()=>t(!0)),(()=>i(!1)))}return i(!1)},r.onerror=function(e){return i()},r.send()}))}return Promise.resolve(!0)}))}function J(e,t,i){return F(this,void 0,void 0,(function*(){const n=H(t),r=B(t)?`?token=${null==n?void 0:n.token}`:"",o=`${oe(t)}${t.id}/resources/`,s=H({portalUrl:window.jimuConfig.isDevEdition?"localhost:":(0,c.getAppStore)().getState().portalUrl});if("config/config.json"===i.resource||"images/image-resources-list.json"===i.resource){const n=o+i.resource+r;return yield fetch(n,{cache:"no-cache"}).then((e=>F(this,void 0,void 0,(function*(){return yield e.json()})))).then((n=>F(this,void 0,void 0,(function*(){const r="config/config.json"===i.resource?Q(n,t):n;return yield function(e,t,i){return F(this,void 0,void 0,(function*(){const n=oe(t)+t+"/resources/",r=new RegExp("^"+n);const o={matcher:function(e){return r.test(e)},handler:function(i){return i.replace("/"+t+"/","/"+e+"/")}};return Promise.resolve(c.utils.replaceStringInObject(i,o))}))}(e,t.id,r).then((t=>F(this,void 0,void 0,(function*(){delete t.appProxies,delete t.historyLabels;const n=new Blob([JSON.stringify(t)],{type:"application/json"});return yield Ee({id:e,resource:n,name:i.resource.split("/")[i.resource.split("/").length-1],params:{resourcesPrefix:i.resource.split("/").slice(0,i.resource.split("/").length-1).join("/")},authentication:s}).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!0)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))))})))).catch((e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}{const t=o+i.resource+r;return yield new Promise((function(n,r){const o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="blob",o.onload=function(t){if(200===this.status){const t=this.response;return Ee({id:e,resource:t,name:i.resource.split("/")[i.resource.split("/").length-1],params:{resourcesPrefix:i.resource.split("/").slice(0,i.resource.split("/").length-1).join("/")},authentication:s}).then((()=>n(!0)),(()=>n(!1)))}return n(!1)},o.onerror=function(e){return n(!1)},o.send()}))}}))}function Q(e,t){var i;const n=(0,c.getAppStore)().getState().portalUrl;e.attributes&&(e.attributes.portalUrl=n);const r=null==e?void 0:e.dataSources;if(r&&X(t))for(const e in r)Z(null===(i=r[e])||void 0===i?void 0:i.portalUrl)&&(r[e].portalUrl=n);return e}function Z(e){let t=!1;const i=(0,c.getAppStore)().getState().portalUrl;return(ee(i,e,"mapsdevext.arcgis.com")||ee(i,e,"mapsqa.arcgis.com")||ee(i,e,"maps.arcgis.com"))&&(t=!0),t}function ee(e,t,i){return((null==e?void 0:e.endsWith(i))||(null==e?void 0:e.endsWith(`${i}/`)))&&((null==t?void 0:t.endsWith(i))||(null==t?void 0:t.endsWith(`${i}/`)))}function te(e,t,i){return F(this,void 0,void 0,(function*(){return yield ke(e).then((n=>F(this,void 0,void 0,(function*(){if(n){const r=t?s.TemplateType:s.ExperienceType;return yield V(n.title).then((o=>F(this,void 0,void 0,(function*(){if(o){const s={name:o,tags:n.tags,thumbnail:n.thumbnail,type:r};return yield re(s,i).then((i=>F(this,void 0,void 0,(function*(){return i?yield W(i.id,e,!t).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(i.id)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),_e(i.id),yield Promise.reject(e)})))):yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}))}function ie(e){const t=`version:${c.version}`;if(!e||0===e.length)return["EXB Experience","Ready To Use","JavaScript","status: Draft",t];let i=!1,n=!1;const r=e.map((e=>(e.includes("version:")&&(n=!0),e.includes("status:")?(i=!0,"status: Draft"):e)));return!i&&r.push("status: Draft"),!n&&r.push(t),r}function ne(e,t,i=1,n=!1){const r=1===i&&n?e:`${e} ${i}`;return function(e,t){let i=!1;return t.forEach((t=>{e===t.title&&(i=!0)})),i}(r,t)?ne(e,t,i+1):r}function re(e,t){return F(this,void 0,void 0,(function*(){const i={title:e.name,type:e.type||"Web Experience",typeKeywords:ie(null==e?void 0:e.typeKeywords),snippet:(null==e?void 0:e.snippet)||"",description:(null==e?void 0:e.description)||"",tags:e.tags,thumbnail:e.thumbnail};return yield se(i,t)}))}function oe(e){const t=X(e)?c.urlUtils.getArcgisOnlineUrl():(0,c.getAppStore)().getState().portalUrl;return(null==e?void 0:e.isLocalApp)?m()+"/apps/":c.portalUrlUtils.getPlatformUrlByOrgUrl(t)+"/sharing/rest/content/items/"}function se(e,t){return F(this,void 0,void 0,(function*(){return t?yield(i={item:e,folderId:t,authentication:c.SessionManager.getInstance().getMainSession()},c.esri.restPortal.createItemInFolder(i)):yield function(e){return he(this,void 0,void 0,(function*(){return fe("createItem")(e)}))}({item:e,authentication:c.SessionManager.getInstance().getMainSession()});var i}))}function ae(e){const t={};return Object.keys(e).forEach((i=>{t[i]=Object.assign({},e[i])})),t}function le(e,t){const i=e.historyLabels;Object.keys(i[t]||{}).forEach((n=>{var r;(null===(r=e[t])||void 0===r?void 0:r[n])||delete i[t][n]}))}function ce(e,t,i){const n=e[i],r=t[i];n&&r&&Object.keys(n).forEach((o=>{var s,a;const l=(null===(a=null===(s=t.historyLabels)||void 0===s?void 0:s[i])||void 0===a?void 0:a[o])||[];r[o]&&n[o].label!==r[o].label&&(l.includes(r[o].label)||l.push(r[o].label)),l.length>0&&(e.historyLabels?e.historyLabels[i]?e.historyLabels[i][o]=l:e.historyLabels[i]={[o]:l}:e.historyLabels={[i]:{[o]:l}})}))}const ue=/<[^>]*>/gm,de=e=>{if(!e)return!0;if("<p></p>"===e||"<p><br></p>"===e)return!0;let t="";return t=e.includes("<")?e.replace(ue,""):e,t=null==t?void 0:t.trim(),!t};var he=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const{importItem:pe}=e;function fe(t,i,n){const r=n?e[n]:e[t],o=c.esri.restPortal[t];return i?B(i)?o:r:window.jimuConfig.isDevEdition?r:o}function ve(e){return he(this,void 0,void 0,(function*(){return fe("updateItem")(e)}))}function me(e){return he(this,void 0,void 0,(function*(){return window.jimuConfig.isDevEdition?yield U(e):yield function(e){return t=this,i=void 0,r=function*(){const t=c.SessionManager.getInstance().getMainSession(),i=e.owner?e.owner:null==t?void 0:t.username,n=`${(0,c.getAppStore)().getState().portalUrl}/sharing/rest/content/users/${i}/items/${e.item.id}/update`;e.params=Object.assign(Object.assign({},e.params),e.item);const r=Object.keys(e.params),o=new FormData;for(let t=0;t<r.length;t++)o.append(r[t],e.params[r[t]]);return e.params=o,yield _(n,o)},new((n=void 0)||(n=Promise))((function(e,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}l((r=r.apply(t,i||[])).next())}));var t,i,n,r}(e)}))}function ge(e,t){return he(this,void 0,void 0,(function*(){return fe("getItem",e)(e.id,t,X(e))}))}function ye(e,t){return he(this,void 0,void 0,(function*(){return fe("getItemResources",e)(e.id,t,X(e))}))}function Ee(e){return he(this,void 0,void 0,(function*(){return fe("addItemResource")(e)}))}function Se(e){return he(this,void 0,void 0,(function*(){return yield function(e){return t=this,i=void 0,r=function*(){const t=c.SessionManager.getInstance().getMainSession(),i=`${(0,c.getAppStore)().getState().portalUrl}/sharing/rest/content/items/${e.items}/share`;e=Object.assign(Object.assign({},e),{f:"json",token:null==t?void 0:t.token});const n=Object.keys(e),r=new FormData;for(let t=0;t<n.length;t++)r.append(n[t],e[n[t]]);return e=r,yield _(i,e)},new((n=void 0)||(n=Promise))((function(e,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}l((r=r.apply(t,i||[])).next())}));var t,i,n,r}(e)}))}function we(e){return he(this,void 0,void 0,(function*(){return yield function(e){return t=this,i=void 0,r=function*(){const t=c.SessionManager.getInstance().getMainSession(),i=`${(0,c.getAppStore)().getState().portalUrl}/sharing/rest/content/items/${e.items}/unshare`;e=Object.assign(Object.assign({},e),{f:"json",token:null==t?void 0:t.token});const n=Object.keys(e),r=new FormData;for(let t=0;t<n.length;t++)r.append(n[t],e[n[t]]);return e=r,yield _(i,e)},new((n=void 0)||(n=Promise))((function(e,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}l((r=r.apply(t,i||[])).next())}));var t,i,n,r}(e)}))}function Ie(e){return he(this,void 0,void 0,(function*(){return yield function(e){return t=this,i=void 0,r=function*(){const t=c.SessionManager.getInstance().getMainSession(),i=`${(0,c.getAppStore)().getState().portalUrl}/sharing/rest/content/itemsgroups`,n={params:e,httpMethod:"GET",authentication:t};return yield c.esri.restRequest.request(i,n)},new((n=void 0)||(n=Promise))((function(e,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}l((r=r.apply(t,i||[])).next())}));var t,i,n,r}(e)}))}function $e(e){return function(e){return t=this,i=void 0,r=function*(){const t=c.SessionManager.getInstance().getMainSession(),i=`${(0,c.getAppStore)().getState().portalUrl}/sharing/rest/content/users/${null==t?void 0:t.username}`,n=Object.assign(Object.assign({},e.params),{f:"json",token:null==t?void 0:t.token});return yield _(i,n,"GET")},new((n=void 0)||(n=Promise))((function(e,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(s,a)}l((r=r.apply(t,i||[])).next())}));var t,i,n,r}(e)}var Te=r(6262),Ae=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};function Oe(e,t){return Ae(this,void 0,void 0,(function*(){return yield te(e,!1,t)}))}function Pe(e){return Ae(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){const t=(0,c.getAppStore)().getState().portalUrl,i={id:e,portalUrl:t,isLocalApp:!1};return yield ke(i).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(i)})))).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Item does not exist or is inaccessible.")}))))}))}(e).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))).catch((t=>F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){const t=(0,c.getAppStore)().getState().portalUrl;if(c.portalUrlUtils.isAGOLDomain(t))return yield Promise.reject(!1);const i={id:e,portalUrl:"https://maps.arcgis.com",isLocalApp:!1};return yield ke(i).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(i)})))).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Item does not exist or is inaccessible.")}))))}))}(e).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))).catch((t=>F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){if(window.jimuConfig.isDevEdition){const t=(0,c.getAppStore)().getState().portalUrl,i={id:e,portalUrl:t,isLocalApp:!0};return yield ke(i).then((e=>F(this,void 0,void 0,(function*(){return(null==e?void 0:e.success)?yield Promise.resolve(i):yield Promise.reject("Item does not exist or is inaccessible.")})))).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Item does not exist or is inaccessible.")}))))}return yield Promise.reject("Item does not exist or is inaccessible.")}))}(e)}))))}))))}))}(e).then((e=>Ae(this,void 0,void 0,(function*(){return yield Oe(e)}))))}))}function Re(e,t,i,n,r){return Ae(this,void 0,void 0,(function*(){return yield V(e).then((e=>Ae(this,void 0,void 0,(function*(){if(e){const o={template:t,name:e,description:"",type:s.ExperienceType};return yield Promise.all([Ye(o)]).then((function(e){var t,s;return Ae(this,void 0,void 0,(function*(){const a=e[0];a.template=o.template,a.attributes?a.attributes.portalUrl=(0,c.getAppStore)().getState().portalUrl:a.attributes={portalUrl:(0,c.getAppStore)().getState().portalUrl};const l=null===(s=null===(t=(0,c.getAppStore)().getState().portalSelf)||void 0===t?void 0:t.portalProperties)||void 0===s?void 0:s.sharedTheme;return a.sharedThemeVariables=c.sharedThemeUtils.createSharedThemeVariables(l),yield function(e,t){return F(this,void 0,void 0,(function*(){const i={title:e.name,type:e.type||"Web Experience",typeKeywords:["EXB Experience","Ready To Use","JavaScript","status: Draft",`version:${c.version}`],snippet:(null==e?void 0:e.snippet)||"",description:(null==e?void 0:e.description)||"",tags:e.tags,data:{__not_publish:!0}};return yield(()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!1)})))().then((function(e){return F(this,void 0,void 0,(function*(){return e?yield Promise.reject("app existed."):yield se(i,t)}))}))}))}(o,i).then((e=>Ae(this,void 0,void 0,(function*(){return yield function(e,t,i,n){return F(this,void 0,void 0,(function*(){const r=c.moduleLoader.getModuleSync("jimu-for-builder").AppResourceManager.getInstance(),o=t.id;let s=c.utils.replaceI18nPlaceholdersInObject(e,c.i18n.getIntl(),G);return(a=s).attributes||(a.attributes={}),a.widgets||(a.widgets={}),a.widgetsManifest||(a.widgetsManifest={}),a.views||(a.views={}),a.sections||(a.sections={}),a.dialogs||(a.dialogs={}),a.pages||(a.pages={}),a.layouts||(a.layouts={}),a.dataSources||(a.dataSources={}),a.messageConfigs||(a.messageConfigs={}),s=a,c.appConfigUtils.addWebmapOrWebsceneToAppConfig(s,i,n),r.upLoadAppConfig(o.toString(),s).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(t)}))));var a}))}(a,e,n,r)}))))}))})).catch((e=>Ae(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}return yield Promise.reject(null)}))))}))}function be(e,t){return Ae(this,void 0,void 0,(function*(){return yield te(e,!0,t)}))}function Le(e){return Ae(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession();return yield function(e,t){return he(this,void 0,void 0,(function*(){return pe(e,t)}))}(e,{authentication:t})}))}function xe(e){return Ae(this,void 0,void 0,(function*(){return function(e){return F(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance(),i=(new Date).getTime();return yield z(`${c.portalUrlUtils.getPortalRestUrl((0,c.getAppStore)().getState().portalUrl)}/content/items/${e}/resources/config/config.json`,{authentication:t.getSessionByUrl((0,c.getAppStore)().getState().portalUrl),httpMethod:"GET",params:{timestamp:i}}).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(null)}))))}))}(null==e?void 0:e.id).then((t=>{const i=null==t?void 0:t.exbVersion;return l.gt(i,c.version)?Promise.reject({errMsg:`Failed to import the app ${e.title} . This app is created by a newer version ${i} of ArcGIS Experience Builder.`,errCode:"001",portalAppversion:i}):je(e,null,!0)}),(e=>{Promise.reject({errMsg:"Invalid app",errCode:"001"})}))}))}function je(e,t,i){return Ae(this,void 0,void 0,(function*(){return yield ke(e).then((n=>Ae(this,void 0,void 0,(function*(){if(n){const r=c.i18n.getIntl().formatMessage({id:"copy"})||"copy",o=i?n.title:`${n.title} ${r}`;return yield V(o,!0,e.type).then((i=>Ae(this,void 0,void 0,(function*(){if(i){const r={name:i,description:(null==n?void 0:n.description)||"",snippet:(null==n?void 0:n.snippet)||"",typeKeywords:(null==n?void 0:n.typeKeywords)||[],tags:n.tags,thumbnail:n.thumbnail,type:e.type||n.type};return yield re(r,t).then((t=>Ae(this,void 0,void 0,(function*(){return t?yield K(t.id,e,n.thumbnail).then((()=>Ae(this,void 0,void 0,(function*(){return yield W(t.id,e,!1).then((()=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(t.id)}))),(e=>Ae(this,void 0,void 0,(function*(){return console.error(e),_e(t.id),yield Promise.reject(e)}))))})))):yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}))}function Ne(e,t,i,n){return Ae(this,void 0,void 0,(function*(){return yield V(`${t.title}`,!0,t.type).then((r=>Ae(this,void 0,void 0,(function*(){if(r){const r={name:t.title,description:(null==t?void 0:t.description)||"",snippet:(null==t?void 0:t.snippet)||"",typeKeywords:(null==t?void 0:t.typeKeywords)||[],tags:t.tags,thumbnail:t.thumbnail,type:e.type||e.type};return yield re(r,i).then((i=>Ae(this,void 0,void 0,(function*(){return i?(t.id=i.id,yield function(e,t,i){return F(this,void 0,void 0,(function*(){if(i){const e=c.SessionManager.getInstance().getMainSession(),n={id:t.id,f:"json",token:null==e?void 0:e.token,thumbnail:i};return yield De(n,t.owner)}return yield K(t.id,e,e.thumbnail)}))}(e,t,n).then((()=>Ae(this,void 0,void 0,(function*(){return yield W(i.id,e,!1).then((()=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(i.id)}))),(e=>Ae(this,void 0,void 0,(function*(){return console.error(e),_e(i.id),yield Promise.reject(e)}))))}))))):yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}))}function Ue(e){return Ae(this,void 0,void 0,(function*(){const t=H(e);return yield function(e,t){return he(this,void 0,void 0,(function*(){return fe("getItemData",e)(e.id,t,X(e))}))}(e,{authentication:t}).then((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))),(e=>Ae(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function Me(e,t){return Ae(this,void 0,void 0,(function*(){const i=function(e){let t;const i=(0,c.getAppStore)().getState().portalUrl,r=c.SessionManager.getInstance().getMainSession(),o=c.portalUrlUtils.isAGOLDomain(i);switch(e){case n.Portal:t=r;break;case n.AGOL:t=o?r:{};break;case n.Other:t=window.jimuConfig.isDevEdition?{}:r}return t}(t);return yield function(e,t){return he(this,void 0,void 0,(function*(){return function(e){let t;const i=(0,c.getAppStore)().getState().portalUrl,r=c.portalUrlUtils.isAGOLDomain(i);switch(e){case n.Portal:t=c.esri.restPortal.searchItems;break;case n.AGOL:t=r?c.esri.restPortal.searchItems:d;break;case n.Other:t=window.jimuConfig.isDevEdition?d:c.esri.restPortal.searchItems}return t}(t)(e,t)}))}(Object.assign(Object.assign({},e),{authentication:i}),t).then((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function ke(e){return Ae(this,void 0,void 0,(function*(){const t=H(e);return yield ge(e,{authentication:t}).then((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function Ce(e){return Ae(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession(),i=window.jimuConfig.isDevEdition?"localhost:":(0,c.getAppStore)().getState().portalUrl,n={id:e.id,portalUrl:i};return yield ge(n,{authentication:t}).then((i=>Ae(this,void 0,void 0,(function*(){return yield ve({item:e,owner:i.owner,authentication:t}).then((()=>null))}))))}))}function De(e,t=""){return Ae(this,void 0,void 0,(function*(){const i=c.SessionManager.getInstance().getMainSession();return yield me({item:e,authentication:i,owner:t}).then((()=>null))}))}function _e(e){return Ae(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession();return yield ge({id:e},{authentication:t}).then((t=>Ae(this,void 0,void 0,(function*(){return yield function(e){return he(this,void 0,void 0,(function*(){return fe("removeItem")(e)}))}({id:e,owner:t.owner,authentication:c.SessionManager.getInstance().getMainSession()})}))))}))}function Ge(e,t){return Ae(this,void 0,void 0,(function*(){const i=c.SessionManager.getInstance().getMainSession(),n=c.moduleLoader.getModuleSync("jimu-for-builder").AppResourceManager,r=c.moduleLoader.getModuleSync("jimu-for-builder").appConfigUtils,o=(null==e?void 0:e.owner)||i.username,s=Object.assign({},r.getCleanAppConfig(t)),a=n.getInstance();return s?yield a.upLoadAppConfig(e.id,s,o).then((()=>{const{imageResources:e,iconResources:t}=a.getResourcesInDraft();e&&a.upLoadImageResourceList(ae(e)),t&&a.upLoadIconResourceList(ae(t))})).catch((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.reject(e)})))):yield Promise.reject()}))}function Fe(e){return Ae(this,void 0,void 0,(function*(){const t=yield function(e){return F(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance(),i=(new Date).getTime();return window.jimuConfig.isDevEdition?yield window.fetch(`/apps/${e}/resources/config/config.json`).then((e=>F(this,void 0,void 0,(function*(){return yield e.json()})))):yield z(`${c.portalUrlUtils.getPortalRestUrl((0,c.getAppStore)().getState().portalUrl)}/content/items/${e}/resources/config/config.json`,{authentication:t.getSessionByUrl((0,c.getAppStore)().getState().portalUrl),httpMethod:"GET",params:{timestamp:i}}).catch((e=>F(this,void 0,void 0,(function*(){return yield this._handleAuthError(e)}))))}))}(e.id),i=yield Ue(e),n=c.SessionManager.getInstance().getMainSession();if(t&&i){const r=function(e){let t=!1;const i=e.map((e=>e.includes("status:")?(t=!0,`status: ${a.Published}`):e));if(!t){const e=`status: ${a.Published}`;i.push(e)}return i}(null==e?void 0:e.typeKeywords);return c.moduleLoader.getModuleSync("jimu-for-builder").AppResourceManager.getInstance().upLoadLocalResource(t).then((t=>Ae(this,void 0,void 0,(function*(){if(!t)return yield Promise.reject();t=function(e,t){return t.__not_publish||(e.historyLabels&&(le(e,"pages"),le(e,"views"),le(e,"dialogs")),ce(e,t,"pages"),ce(e,t,"views"),ce(e,t,"dialogs")),e}(t=function(e,t){return Object.values(e.widgets).forEach((e=>{"widgets/common/text/"===e.uri&&function(e,t){if(t.type===s.TemplateType)return e;de(null==e?void 0:e.text)||delete e.placeholder}(e.config,t)})),e}(t,e),i);const o=function(e){const{type:t,id:i}=e,{isDevEdition:n,isInPortal:r,hostEnv:o}=window.jimuConfig,a=t===s.TemplateType,l=!n&&!r;if(n)return null;let u=c.urlUtils.getAppUrl({appId:i,isTemplate:a});if(l)switch(o){case"prod":u=`https://experience.arcgis.com${u}`;break;case"dev":u=`https://experiencedev.arcgis.com${u}`;break;case"qa":u=`https://experienceqa.arcgis.com${u}`}return r&&(u=`${window.location.origin}${u}`),u}(e);return yield ve({item:{id:e.id,owner:e.owner||(null==n?void 0:n.username),data:t,typeKeywords:r,url:o},authentication:c.SessionManager.getInstance().getMainSession()}).then((()=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve()}))),(()=>Ae(this,void 0,void 0,(function*(){return yield Promise.reject()}))))}))),(()=>Ae(this,void 0,void 0,(function*(){return yield Promise.reject()})))).catch((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}return yield Promise.reject()}))}function ze(e){return Ae(this,void 0,void 0,(function*(){return $e(e).then((e=>Ae(this,void 0,void 0,(function*(){const t=(null==e?void 0:e.folders)||[];return yield Promise.resolve(t)}))),(e=>Ae(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function Be(e){return Ae(this,void 0,void 0,(function*(){return yield Se(e).then((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function Xe(e){return Ae(this,void 0,void 0,(function*(){return yield we(e).then((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function qe(e){return Ae(this,void 0,void 0,(function*(){return yield Ie(e).then((e=>Ae(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function He(e){return Ae(this,void 0,void 0,(function*(){return yield function(e){return he(this,void 0,void 0,(function*(){return yield c.esri.restPortal.moveItem(e)}))}(Object.assign(Object.assign({},e),{authentication:c.SessionManager.getInstance().getMainSession()}))}))}function Ve(e){return Ae(this,void 0,void 0,(function*(){return yield function(e){return he(this,void 0,void 0,(function*(){return yield c.esri.restPortal.getUserTags(e)}))}({username:e,authentication:c.SessionManager.getInstance().getMainSession()})}))}function We(e){return Ae(this,void 0,void 0,(function*(){return yield function(e){return he(this,void 0,void 0,(function*(){return yield c.esri.restPortal.searchGroups(e)}))}(e)}))}function Ye(e){return Ae(this,void 0,void 0,(function*(){return(0,Te.getTemplateConfig)(Te.TemplateType.App,e.template)}))}function Ke(e){return Ae(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession();return yield function(e){return he(this,void 0,void 0,(function*(){return fe("removeItemResource")(e)}))}(Object.assign(Object.assign({},e),{authentication:t}))}))}function Je(e){return Ae(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession();return yield Ee(Object.assign(Object.assign({},e),{authentication:t}))}))}function Qe(e,t){return Ae(this,void 0,void 0,(function*(){const i=c.SessionManager.getInstance().getMainSession();return yield ye(e,Object.assign({authentication:i},t))}))}function Ze(e,t){return Ae(this,void 0,void 0,(function*(){const i=c.SessionManager.getInstance().getMainSession();return yield function(e,t){return he(this,void 0,void 0,(function*(){return fe("getItemResource",e)(e.id,t,X(e))}))}(e,Object.assign({authentication:i},t))}))}function et(e){return Ae(this,void 0,void 0,(function*(){const t=c.SessionManager.getInstance().getMainSession();return yield function(e){return he(this,void 0,void 0,(function*(){return fe("updateItemResource")(e)}))}(Object.assign(Object.assign({},e),{authentication:t}))}))}var tt=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))};const it=c.esri.restRequest.request;var nt;let rt,ot;function st(e,t){return tt(this,void 0,void 0,(function*(){const i=c.SessionManager.getInstance().getMainSession(),{username:n}=i,r=(0,c.getAppStore)().getState().portalUrl,o=c.portalUrlUtils.getBaseUserUrl(r),s=yield ft.getInstance().getToken();let a;switch(t=null!=t?t:pt(),e){case nt.Add:a=o+"/"+n+"/addResource/?token="+s;break;case nt.Remove:a=o+"/"+n+"/removeResource/?token="+s;break;case nt.Get:a=o+"/"+n+"/resources/"+t+"?token="+s;break;case nt.GetAll:a=o+"/"+n+"/resources/?token="+s}return yield Promise.resolve(a)}))}function at(e,t){return tt(this,void 0,void 0,(function*(){t=null!=t?t:pt();const i={httpMethod:"POST",params:Object.assign(Object.assign({},e),{key:t,access:"UserPrivateAllApps"})};return yield st(nt.Add).then((e=>tt(this,void 0,void 0,(function*(){return yield it(e,i).then((e=>tt(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed adding user resource:"+e.message))}))))}))}function lt(e){return tt(this,void 0,void 0,(function*(){return e=null!=e?e:pt(),yield st(nt.Get,e).then((e=>tt(this,void 0,void 0,(function*(){return yield it(e,{params:{f:"json"}}).then((e=>tt(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed retrieving user resource:"+e.message))}))))}))}function ct(){return tt(this,void 0,void 0,(function*(){return yield st(nt.GetAll).then((e=>tt(this,void 0,void 0,(function*(){return yield it(e,{params:{f:"json"}}).then((e=>tt(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed retrieving user resource list:"+e.message))}))))}))}function ut(e){return tt(this,void 0,void 0,(function*(){return e=null!=e?e:pt(),yield st(nt.Remove).then((t=>tt(this,void 0,void 0,(function*(){const i={params:{key:e}};return yield it(t,i).then((e=>tt(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed removing user resource:"+e.message))}))))}))}function dt(e){return tt(this,void 0,void 0,(function*(){return yield lt().then((t=>tt(this,void 0,void 0,(function*(){const i=(0,c.Immutable)(null!=t?t:{}).merge(e,{deep:!0});return yield at({text:JSON.stringify(Object.assign({},i))})})))).then((e=>tt(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed updating user resource:"+e.message))}))))}))}function ht(){return tt(this,void 0,void 0,(function*(){return rt||(rt=ct().then((e=>tt(this,void 0,void 0,(function*(){if(0===e.total)return yield at({text:"{}"});{const t=e.userResources[0],i=pt();return t.key===i?yield Promise.resolve({success:!0}):yield lt(t.key).catch((e=>null)).then((e=>tt(this,void 0,void 0,(function*(){return e&&(e.showGuides||0===Object.keys(e).length)?yield ut(t.key).then((()=>tt(this,void 0,void 0,(function*(){return yield at({text:JSON.stringify(Object.assign({},e))})})))):yield at({text:"{}"})}))))}})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed initializing user resource:"+e.message))}))))),rt}))}function pt(){if(!ot){const e=c.SessionManager.getInstance().getMainSession();ot=`${c.USER_SETTING_FILE_KEY}${(null==e?void 0:e.clientId)?`_${e.clientId}`:""}.json`}return ot}!function(e){e.Add="ADD",e.Remove="REMOVE",e.Get="GET",e.GetAll="GETALL"}(nt||(nt={}));class ft{constructor(){this.session=c.SessionManager.getInstance().getMainSession()}static getInstance(){return ft.instance||(ft.instance=new ft),ft.instance}_shouldExchangeToken(){return tt(this,void 0,void 0,(function*(){if(!this.exchangedToken||this.session.tokenExpires<new Date){if(!this.portalSelfPromise){const e=(0,c.getAppStore)().getState().portalUrl;this.portalSelfPromise=it(`${e}/sharing/rest/community/self?token=${this.session.token}`).then((({appInfo:e})=>tt(this,void 0,void 0,(function*(){return yield Promise.resolve("experienceBuilder"!==(null==e?void 0:e.appId))})))).catch((e=>tt(this,void 0,void 0,(function*(){return yield Promise.reject(new Error(e.message))}))))}return yield this.portalSelfPromise}return yield Promise.resolve(!1)}))}_exchangeToken(){return tt(this,void 0,void 0,(function*(){const e=(0,c.getAppStore)().getState().portalUrl+"/sharing/rest/oauth2/exchangeToken",t={params:{client_id:this.session.clientId,token:this.session.token}};return yield it(e,t)}))}getToken(){var e;return tt(this,void 0,void 0,(function*(){return(yield this._shouldExchangeToken())?yield this._exchangeToken().catch((e=>(console.warn("Failed exchanging token. Using default token from user sesion."),{token:this.session.token}))).then((e=>tt(this,void 0,void 0,(function*(){return this.exchangedToken=null==e?void 0:e.token,yield Promise.resolve(this.exchangedToken)})))):yield Promise.resolve(null!==(e=this.exchangedToken)&&void 0!==e?e:this.session.token)}))}}})(),o})())}}}));